var cs=Object.defineProperty;var us=(lr,or,ar)=>or in lr?cs(lr,or,{enumerable:!0,configurable:!0,writable:!0,value:ar}):lr[or]=ar;var bi=(lr,or,ar)=>(us(lr,typeof or!="symbol"?or+"":or,ar),ar),Ki=(lr,or,ar)=>{if(!or.has(lr))throw TypeError("Cannot "+ar)};var Ci=(lr,or,ar)=>(Ki(lr,or,"read from private field"),ar?ar.call(lr):or.get(lr)),Fi=(lr,or,ar)=>{if(or.has(lr))throw TypeError("Cannot add the same private member more than once");or instanceof WeakSet?or.add(lr):or.set(lr,ar)},Ri=(lr,or,ar,cr)=>(Ki(lr,or,"write to private field"),cr?cr.call(lr,ar):or.set(lr,ar),ar);var zi=(lr,or,ar)=>(Ki(lr,or,"access private method"),ar);(function(){const or=document.createElement("link").relList;if(or&&or.supports&&or.supports("modulepreload"))return;for(const ur of document.querySelectorAll('link[rel="modulepreload"]'))cr(ur);new MutationObserver(ur=>{for(const hr of ur)if(hr.type==="childList")for(const fr of hr.addedNodes)fr.tagName==="LINK"&&fr.rel==="modulepreload"&&cr(fr)}).observe(document,{childList:!0,subtree:!0});function ar(ur){const hr={};return ur.integrity&&(hr.integrity=ur.integrity),ur.referrerPolicy&&(hr.referrerPolicy=ur.referrerPolicy),ur.crossOrigin==="use-credentials"?hr.credentials="include":ur.crossOrigin==="anonymous"?hr.credentials="omit":hr.credentials="same-origin",hr}function cr(ur){if(ur.ep)return;ur.ep=!0;const hr=ar(ur);fetch(ur.href,hr)}})();const fontelloEmbedded="",index="";function noop$2(){}const identity=lr=>lr;function assign(lr,or){for(const ar in or)lr[ar]=or[ar];return lr}function is_promise(lr){return!!lr&&(typeof lr=="object"||typeof lr=="function")&&typeof lr.then=="function"}function run(lr){return lr()}function blank_object(){return Object.create(null)}function run_all(lr){lr.forEach(run)}function is_function(lr){return typeof lr=="function"}function safe_not_equal(lr,or){return lr!=lr?or==or:lr!==or||lr&&typeof lr=="object"||typeof lr=="function"}let src_url_equal_anchor;function src_url_equal(lr,or){return lr===or?!0:(src_url_equal_anchor||(src_url_equal_anchor=document.createElement("a")),src_url_equal_anchor.href=or,lr===src_url_equal_anchor.href)}function is_empty(lr){return Object.keys(lr).length===0}function subscribe(lr,...or){if(lr==null){for(const cr of or)cr(void 0);return noop$2}const ar=lr.subscribe(...or);return ar.unsubscribe?()=>ar.unsubscribe():ar}function get_store_value(lr){let or;return subscribe(lr,ar=>or=ar)(),or}function component_subscribe(lr,or,ar){lr.$$.on_destroy.push(subscribe(or,ar))}function null_to_empty(lr){return lr??""}function set_store_value(lr,or,ar){return lr.set(ar),or}function split_css_unit(lr){const or=typeof lr=="string"&&lr.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return or?[parseFloat(or[1]),or[2]||"px"]:[lr,"px"]}const is_client=typeof window<"u";let now=is_client?()=>window.performance.now():()=>Date.now(),raf=is_client?lr=>requestAnimationFrame(lr):noop$2;const tasks=new Set;function run_tasks(lr){tasks.forEach(or=>{or.c(lr)||(tasks.delete(or),or.f())}),tasks.size!==0&&raf(run_tasks)}function loop(lr){let or;return tasks.size===0&&raf(run_tasks),{promise:new Promise(ar=>{tasks.add(or={c:lr,f:ar})}),abort(){tasks.delete(or)}}}const globals=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function append(lr,or){lr.appendChild(or)}function get_root_for_style(lr){if(!lr)return document;const or=lr.getRootNode?lr.getRootNode():lr.ownerDocument;return or&&or.host?or:lr.ownerDocument}function append_empty_stylesheet(lr){const or=element$1("style");return or.textContent="/* empty */",append_stylesheet(get_root_for_style(lr),or),or.sheet}function append_stylesheet(lr,or){return append(lr.head||lr,or),or.sheet}function insert$1(lr,or,ar){lr.insertBefore(or,ar||null)}function detach(lr){lr.parentNode&&lr.parentNode.removeChild(lr)}function destroy_each(lr,or){for(let ar=0;ar<lr.length;ar+=1)lr[ar]&&lr[ar].d(or)}function element$1(lr){return document.createElement(lr)}function svg_element(lr){return document.createElementNS("http://www.w3.org/2000/svg",lr)}function text(lr){return document.createTextNode(lr)}function space$3(){return text(" ")}function empty$1(){return text("")}function listen(lr,or,ar,cr){return lr.addEventListener(or,ar,cr),()=>lr.removeEventListener(or,ar,cr)}function prevent_default(lr){return function(or){return or.preventDefault(),lr.call(this,or)}}function stop_propagation(lr){return function(or){return or.stopPropagation(),lr.call(this,or)}}function self$1(lr){return function(or){or.target===this&&lr.call(this,or)}}function attr(lr,or,ar){ar==null?lr.removeAttribute(or):lr.getAttribute(or)!==ar&&lr.setAttribute(or,ar)}function to_number(lr){return lr===""?null:+lr}function children(lr){return Array.from(lr.childNodes)}function set_data(lr,or){or=""+or,lr.data!==or&&(lr.data=or)}function set_input_value(lr,or){lr.value=or??""}function set_style(lr,or,ar,cr){ar==null?lr.style.removeProperty(or):lr.style.setProperty(or,ar,cr?"important":"")}function select_option(lr,or,ar){for(let cr=0;cr<lr.options.length;cr+=1){const ur=lr.options[cr];if(ur.__value===or){ur.selected=!0;return}}(!ar||or!==void 0)&&(lr.selectedIndex=-1)}function select_value(lr){const or=lr.querySelector(":checked");return or&&or.__value}function toggle_class(lr,or,ar){lr.classList.toggle(or,!!ar)}function custom_event(lr,or,{bubbles:ar=!1,cancelable:cr=!1}={}){return new CustomEvent(lr,{detail:or,bubbles:ar,cancelable:cr})}class HtmlTag{constructor(or=!1){bi(this,"is_svg",!1);bi(this,"e");bi(this,"n");bi(this,"t");bi(this,"a");this.is_svg=or,this.e=this.n=null}c(or){this.h(or)}m(or,ar,cr=null){this.e||(this.is_svg?this.e=svg_element(ar.nodeName):this.e=element$1(ar.nodeType===11?"TEMPLATE":ar.nodeName),this.t=ar.tagName!=="TEMPLATE"?ar:ar.content,this.c(or)),this.i(cr)}h(or){this.e.innerHTML=or,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(or){for(let ar=0;ar<this.n.length;ar+=1)insert$1(this.t,this.n[ar],or)}p(or){this.d(),this.h(or),this.i(this.a)}d(){this.n.forEach(detach)}}function construct_svelte_component(lr,or){return new lr(or)}const managed_styles=new Map;let active=0;function hash$1(lr){let or=5381,ar=lr.length;for(;ar--;)or=(or<<5)-or^lr.charCodeAt(ar);return or>>>0}function create_style_information(lr,or){const ar={stylesheet:append_empty_stylesheet(or),rules:{}};return managed_styles.set(lr,ar),ar}function create_rule(lr,or,ar,cr,ur,hr,fr,dr=0){const pr=16.666/cr;let mr=`{
`;for(let xr=0;xr<=1;xr+=pr){const wr=or+(ar-or)*hr(xr);mr+=xr*100+`%{${fr(wr,1-wr)}}
`}const gr=mr+`100% {${fr(ar,1-ar)}}
}`,yr=`__svelte_${hash$1(gr)}_${dr}`,br=get_root_for_style(lr),{stylesheet:Or,rules:_r}=managed_styles.get(br)||create_style_information(br,lr);_r[yr]||(_r[yr]=!0,Or.insertRule(`@keyframes ${yr} ${gr}`,Or.cssRules.length));const vr=lr.style.animation||"";return lr.style.animation=`${vr?`${vr}, `:""}${yr} ${cr}ms linear ${ur}ms 1 both`,active+=1,yr}function delete_rule(lr,or){const ar=(lr.style.animation||"").split(", "),cr=ar.filter(or?hr=>hr.indexOf(or)<0:hr=>hr.indexOf("__svelte")===-1),ur=ar.length-cr.length;ur&&(lr.style.animation=cr.join(", "),active-=ur,active||clear_rules())}function clear_rules(){raf(()=>{active||(managed_styles.forEach(lr=>{const{ownerNode:or}=lr.stylesheet;or&&detach(or)}),managed_styles.clear())})}function create_animation(lr,or,ar,cr){if(!or)return noop$2;const ur=lr.getBoundingClientRect();if(or.left===ur.left&&or.right===ur.right&&or.top===ur.top&&or.bottom===ur.bottom)return noop$2;const{delay:hr=0,duration:fr=300,easing:dr=identity,start:pr=now()+hr,end:mr=pr+fr,tick:gr=noop$2,css:yr}=ar(lr,{from:or,to:ur},cr);let br=!0,Or=!1,_r;function vr(){yr&&(_r=create_rule(lr,0,1,fr,hr,dr,yr)),hr||(Or=!0)}function xr(){yr&&delete_rule(lr,_r),br=!1}return loop(wr=>{if(!Or&&wr>=pr&&(Or=!0),Or&&wr>=mr&&(gr(1,0),xr()),!br)return!1;if(Or){const kr=wr-pr,Cr=0+1*dr(kr/fr);gr(Cr,1-Cr)}return!0}),vr(),gr(0,1),xr}function fix_position(lr){const or=getComputedStyle(lr);if(or.position!=="absolute"&&or.position!=="fixed"){const{width:ar,height:cr}=or,ur=lr.getBoundingClientRect();lr.style.position="absolute",lr.style.width=ar,lr.style.height=cr,add_transform(lr,ur)}}function add_transform(lr,or){const ar=lr.getBoundingClientRect();if(or.left!==ar.left||or.top!==ar.top){const cr=getComputedStyle(lr),ur=cr.transform==="none"?"":cr.transform;lr.style.transform=`${ur} translate(${or.left-ar.left}px, ${or.top-ar.top}px)`}}let current_component;function set_current_component(lr){current_component=lr}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(lr){get_current_component().$$.on_mount.push(lr)}function onDestroy(lr){get_current_component().$$.on_destroy.push(lr)}function bubble(lr,or){const ar=lr.$$.callbacks[or.type];ar&&ar.slice().forEach(cr=>cr.call(this,or))}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush$1))}function tick(){return schedule_update(),resolved_promise}function add_render_callback(lr){render_callbacks.push(lr)}function add_flush_callback(lr){flush_callbacks.push(lr)}const seen_callbacks=new Set;let flushidx=0;function flush$1(){if(flushidx!==0)return;const lr=current_component;do{try{for(;flushidx<dirty_components.length;){const or=dirty_components[flushidx];flushidx++,set_current_component(or),update$2(or.$$)}}catch(or){throw dirty_components.length=0,flushidx=0,or}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let or=0;or<render_callbacks.length;or+=1){const ar=render_callbacks[or];seen_callbacks.has(ar)||(seen_callbacks.add(ar),ar())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(lr)}function update$2(lr){if(lr.fragment!==null){lr.update(),run_all(lr.before_update);const or=lr.dirty;lr.dirty=[-1],lr.fragment&&lr.fragment.p(lr.ctx,or),lr.after_update.forEach(add_render_callback)}}function flush_render_callbacks(lr){const or=[],ar=[];render_callbacks.forEach(cr=>lr.indexOf(cr)===-1?or.push(cr):ar.push(cr)),ar.forEach(cr=>cr()),render_callbacks=or}let promise;function wait$1(){return promise||(promise=Promise.resolve(),promise.then(()=>{promise=null})),promise}function dispatch(lr,or,ar){lr.dispatchEvent(custom_event(`${or?"intro":"outro"}${ar}`))}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(lr,or){lr&&lr.i&&(outroing.delete(lr),lr.i(or))}function transition_out(lr,or,ar,cr){if(lr&&lr.o){if(outroing.has(lr))return;outroing.add(lr),outros.c.push(()=>{outroing.delete(lr),cr&&(ar&&lr.d(1),cr())}),lr.o(or)}else cr&&cr()}const null_transition={duration:0};function create_in_transition(lr,or,ar){const cr={direction:"in"};let ur=or(lr,ar,cr),hr=!1,fr,dr,pr=0;function mr(){fr&&delete_rule(lr,fr)}function gr(){const{delay:br=0,duration:Or=300,easing:_r=identity,tick:vr=noop$2,css:xr}=ur||null_transition;xr&&(fr=create_rule(lr,0,1,Or,br,_r,xr,pr++)),vr(0,1);const wr=now()+br,kr=wr+Or;dr&&dr.abort(),hr=!0,add_render_callback(()=>dispatch(lr,!0,"start")),dr=loop(Cr=>{if(hr){if(Cr>=kr)return vr(1,0),dispatch(lr,!0,"end"),mr(),hr=!1;if(Cr>=wr){const $r=_r((Cr-wr)/Or);vr($r,1-$r)}}return hr})}let yr=!1;return{start(){yr||(yr=!0,delete_rule(lr),is_function(ur)?(ur=ur(cr),wait$1().then(gr)):gr())},invalidate(){yr=!1},end(){hr&&(mr(),hr=!1)}}}function create_out_transition(lr,or,ar){const cr={direction:"out"};let ur=or(lr,ar,cr),hr=!0,fr;const dr=outros;dr.r+=1;let pr;function mr(){const{delay:gr=0,duration:yr=300,easing:br=identity,tick:Or=noop$2,css:_r}=ur||null_transition;_r&&(fr=create_rule(lr,1,0,yr,gr,br,_r));const vr=now()+gr,xr=vr+yr;add_render_callback(()=>dispatch(lr,!1,"start")),"inert"in lr&&(pr=lr.inert,lr.inert=!0),loop(wr=>{if(hr){if(wr>=xr)return Or(0,1),dispatch(lr,!1,"end"),--dr.r||run_all(dr.c),!1;if(wr>=vr){const kr=br((wr-vr)/yr);Or(1-kr,kr)}}return hr})}return is_function(ur)?wait$1().then(()=>{ur=ur(cr),mr()}):mr(),{end(gr){gr&&"inert"in lr&&(lr.inert=pr),gr&&ur.tick&&ur.tick(1,0),hr&&(fr&&delete_rule(lr,fr),hr=!1)}}}function handle_promise(lr,or){const ar=or.token={};function cr(ur,hr,fr,dr){if(or.token!==ar)return;or.resolved=dr;let pr=or.ctx;fr!==void 0&&(pr=pr.slice(),pr[fr]=dr);const mr=ur&&(or.current=ur)(pr);let gr=!1;or.block&&(or.blocks?or.blocks.forEach((yr,br)=>{br!==hr&&yr&&(group_outros(),transition_out(yr,1,1,()=>{or.blocks[br]===yr&&(or.blocks[br]=null)}),check_outros())}):or.block.d(1),mr.c(),transition_in(mr,1),mr.m(or.mount(),or.anchor),gr=!0),or.block=mr,or.blocks&&(or.blocks[hr]=mr),gr&&flush$1()}if(is_promise(lr)){const ur=get_current_component();if(lr.then(hr=>{set_current_component(ur),cr(or.then,1,or.value,hr),set_current_component(null)},hr=>{if(set_current_component(ur),cr(or.catch,2,or.error,hr),set_current_component(null),!or.hasCatch)throw hr}),or.current!==or.pending)return cr(or.pending,0),!0}else{if(or.current!==or.then)return cr(or.then,1,or.value,lr),!0;or.resolved=lr}}function update_await_block_branch(lr,or,ar){const cr=or.slice(),{resolved:ur}=lr;lr.current===lr.then&&(cr[lr.value]=ur),lr.current===lr.catch&&(cr[lr.error]=ur),lr.block.p(cr,ar)}function ensure_array_like(lr){return(lr==null?void 0:lr.length)!==void 0?lr:Array.from(lr)}function outro_and_destroy_block(lr,or){transition_out(lr,1,1,()=>{or.delete(lr.key)})}function fix_and_outro_and_destroy_block(lr,or){lr.f(),outro_and_destroy_block(lr,or)}function update_keyed_each(lr,or,ar,cr,ur,hr,fr,dr,pr,mr,gr,yr){let br=lr.length,Or=hr.length,_r=br;const vr={};for(;_r--;)vr[lr[_r].key]=_r;const xr=[],wr=new Map,kr=new Map,Cr=[];for(_r=Or;_r--;){const Fr=yr(ur,hr,_r),Vr=ar(Fr);let Rr=fr.get(Vr);Rr?cr&&Cr.push(()=>Rr.p(Fr,or)):(Rr=mr(Vr,Fr),Rr.c()),wr.set(Vr,xr[_r]=Rr),Vr in vr&&kr.set(Vr,Math.abs(_r-vr[Vr]))}const $r=new Set,Nr=new Set;function Br(Fr){transition_in(Fr,1),Fr.m(dr,gr),fr.set(Fr.key,Fr),gr=Fr.first,Or--}for(;br&&Or;){const Fr=xr[Or-1],Vr=lr[br-1],Rr=Fr.key,Gr=Vr.key;Fr===Vr?(gr=Fr.first,br--,Or--):wr.has(Gr)?!fr.has(Rr)||$r.has(Rr)?Br(Fr):Nr.has(Gr)?br--:kr.get(Rr)>kr.get(Gr)?(Nr.add(Rr),Br(Fr)):($r.add(Gr),br--):(pr(Vr,fr),br--)}for(;br--;){const Fr=lr[br];wr.has(Fr.key)||pr(Fr,fr)}for(;Or;)Br(xr[Or-1]);return run_all(Cr),xr}function get_spread_update(lr,or){const ar={},cr={},ur={$$scope:1};let hr=lr.length;for(;hr--;){const fr=lr[hr],dr=or[hr];if(dr){for(const pr in fr)pr in dr||(cr[pr]=1);for(const pr in dr)ur[pr]||(ar[pr]=dr[pr],ur[pr]=1);lr[hr]=dr}else for(const pr in fr)ur[pr]=1}for(const fr in cr)fr in ar||(ar[fr]=void 0);return ar}function get_spread_object(lr){return typeof lr=="object"&&lr!==null?lr:{}}function bind(lr,or,ar){const cr=lr.$$.props[or];cr!==void 0&&(lr.$$.bound[cr]=ar,ar(lr.$$.ctx[cr]))}function create_component(lr){lr&&lr.c()}function mount_component(lr,or,ar){const{fragment:cr,after_update:ur}=lr.$$;cr&&cr.m(or,ar),add_render_callback(()=>{const hr=lr.$$.on_mount.map(run).filter(is_function);lr.$$.on_destroy?lr.$$.on_destroy.push(...hr):run_all(hr),lr.$$.on_mount=[]}),ur.forEach(add_render_callback)}function destroy_component(lr,or){const ar=lr.$$;ar.fragment!==null&&(flush_render_callbacks(ar.after_update),run_all(ar.on_destroy),ar.fragment&&ar.fragment.d(or),ar.on_destroy=ar.fragment=null,ar.ctx=[])}function make_dirty(lr,or){lr.$$.dirty[0]===-1&&(dirty_components.push(lr),schedule_update(),lr.$$.dirty.fill(0)),lr.$$.dirty[or/31|0]|=1<<or%31}function init$1(lr,or,ar,cr,ur,hr,fr,dr=[-1]){const pr=current_component;set_current_component(lr);const mr=lr.$$={fragment:null,ctx:[],props:hr,update:noop$2,not_equal:ur,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(or.context||(pr?pr.$$.context:[])),callbacks:blank_object(),dirty:dr,skip_bound:!1,root:or.target||pr.$$.root};fr&&fr(mr.root);let gr=!1;if(mr.ctx=ar?ar(lr,or.props||{},(yr,br,...Or)=>{const _r=Or.length?Or[0]:br;return mr.ctx&&ur(mr.ctx[yr],mr.ctx[yr]=_r)&&(!mr.skip_bound&&mr.bound[yr]&&mr.bound[yr](_r),gr&&make_dirty(lr,yr)),br}):[],mr.update(),gr=!0,run_all(mr.before_update),mr.fragment=cr?cr(mr.ctx):!1,or.target){if(or.hydrate){const yr=children(or.target);mr.fragment&&mr.fragment.l(yr),yr.forEach(detach)}else mr.fragment&&mr.fragment.c();or.intro&&transition_in(lr.$$.fragment),mount_component(lr,or.target,or.anchor),flush$1()}set_current_component(pr)}class SvelteComponent{constructor(){bi(this,"$$");bi(this,"$$set")}$destroy(){destroy_component(this,1),this.$destroy=noop$2}$on(or,ar){if(!is_function(ar))return noop$2;const cr=this.$$.callbacks[or]||(this.$$.callbacks[or]=[]);return cr.push(ar),()=>{const ur=cr.indexOf(ar);ur!==-1&&cr.splice(ur,1)}}$set(or){this.$$set&&!is_empty(or)&&(this.$$.skip_bound=!0,this.$$set(or),this.$$.skip_bound=!1)}}const PUBLIC_VERSION="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(PUBLIC_VERSION);const subscriber_queue=[];function readable(lr,or){return{subscribe:writable(lr,or).subscribe}}function writable(lr,or=noop$2){let ar;const cr=new Set;function ur(dr){if(safe_not_equal(lr,dr)&&(lr=dr,ar)){const pr=!subscriber_queue.length;for(const mr of cr)mr[1](),subscriber_queue.push(mr,lr);if(pr){for(let mr=0;mr<subscriber_queue.length;mr+=2)subscriber_queue[mr][0](subscriber_queue[mr+1]);subscriber_queue.length=0}}}function hr(dr){ur(dr(lr))}function fr(dr,pr=noop$2){const mr=[dr,pr];return cr.add(mr),cr.size===1&&(ar=or(ur,hr)||noop$2),dr(lr),()=>{cr.delete(mr),cr.size===0&&ar&&(ar(),ar=null)}}return{set:ur,update:hr,subscribe:fr}}function derived(lr,or,ar){const cr=!Array.isArray(lr),ur=cr?[lr]:lr;if(!ur.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const hr=or.length<2;return readable(ar,(fr,dr)=>{let pr=!1;const mr=[];let gr=0,yr=noop$2;const br=()=>{if(gr)return;yr();const _r=or(cr?mr[0]:mr,fr,dr);hr?fr(_r):yr=is_function(_r)?_r:noop$2},Or=ur.map((_r,vr)=>subscribe(_r,xr=>{mr[vr]=xr,gr&=~(1<<vr),pr&&br()},()=>{gr|=1<<vr}));return pr=!0,br(),function(){run_all(Or),yr(),pr=!1}})}var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(lr){return lr&&lr.__esModule&&Object.prototype.hasOwnProperty.call(lr,"default")?lr.default:lr}var isMergeableObject=function(or){return isNonNullObject(or)&&!isSpecial(or)};function isNonNullObject(lr){return!!lr&&typeof lr=="object"}function isSpecial(lr){var or=Object.prototype.toString.call(lr);return or==="[object RegExp]"||or==="[object Date]"||isReactElement(lr)}var canUseSymbol=typeof Symbol=="function"&&Symbol.for,REACT_ELEMENT_TYPE=canUseSymbol?Symbol.for("react.element"):60103;function isReactElement(lr){return lr.$$typeof===REACT_ELEMENT_TYPE}function emptyTarget(lr){return Array.isArray(lr)?[]:{}}function cloneUnlessOtherwiseSpecified(lr,or){return or.clone!==!1&&or.isMergeableObject(lr)?deepmerge(emptyTarget(lr),lr,or):lr}function defaultArrayMerge(lr,or,ar){return lr.concat(or).map(function(cr){return cloneUnlessOtherwiseSpecified(cr,ar)})}function getMergeFunction(lr,or){if(!or.customMerge)return deepmerge;var ar=or.customMerge(lr);return typeof ar=="function"?ar:deepmerge}function getEnumerableOwnPropertySymbols(lr){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(lr).filter(function(or){return Object.propertyIsEnumerable.call(lr,or)}):[]}function getKeys(lr){return Object.keys(lr).concat(getEnumerableOwnPropertySymbols(lr))}function propertyIsOnObject(lr,or){try{return or in lr}catch{return!1}}function propertyIsUnsafe(lr,or){return propertyIsOnObject(lr,or)&&!(Object.hasOwnProperty.call(lr,or)&&Object.propertyIsEnumerable.call(lr,or))}function mergeObject(lr,or,ar){var cr={};return ar.isMergeableObject(lr)&&getKeys(lr).forEach(function(ur){cr[ur]=cloneUnlessOtherwiseSpecified(lr[ur],ar)}),getKeys(or).forEach(function(ur){propertyIsUnsafe(lr,ur)||(propertyIsOnObject(lr,ur)&&ar.isMergeableObject(or[ur])?cr[ur]=getMergeFunction(ur,ar)(lr[ur],or[ur],ar):cr[ur]=cloneUnlessOtherwiseSpecified(or[ur],ar))}),cr}function deepmerge(lr,or,ar){ar=ar||{},ar.arrayMerge=ar.arrayMerge||defaultArrayMerge,ar.isMergeableObject=ar.isMergeableObject||isMergeableObject,ar.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var cr=Array.isArray(or),ur=Array.isArray(lr),hr=cr===ur;return hr?cr?ar.arrayMerge(lr,or,ar):mergeObject(lr,or,ar):cloneUnlessOtherwiseSpecified(or,ar)}deepmerge.all=function(or,ar){if(!Array.isArray(or))throw new Error("first argument should be an array");return or.reduce(function(cr,ur){return deepmerge(cr,ur,ar)},{})};var deepmerge_1=deepmerge,cjs=deepmerge_1;const deepmerge$1=getDefaultExportFromCjs$1(cjs);var extendStatics=function(lr,or){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ar,cr){ar.__proto__=cr}||function(ar,cr){for(var ur in cr)Object.prototype.hasOwnProperty.call(cr,ur)&&(ar[ur]=cr[ur])},extendStatics(lr,or)};function __extends(lr,or){if(typeof or!="function"&&or!==null)throw new TypeError("Class extends value "+String(or)+" is not a constructor or null");extendStatics(lr,or);function ar(){this.constructor=lr}lr.prototype=or===null?Object.create(or):(ar.prototype=or.prototype,new ar)}var __assign=function(){return __assign=Object.assign||function(or){for(var ar,cr=1,ur=arguments.length;cr<ur;cr++){ar=arguments[cr];for(var hr in ar)Object.prototype.hasOwnProperty.call(ar,hr)&&(or[hr]=ar[hr])}return or},__assign.apply(this,arguments)};function __spreadArray(lr,or,ar){if(ar||arguments.length===2)for(var cr=0,ur=or.length,hr;cr<ur;cr++)(hr||!(cr in or))&&(hr||(hr=Array.prototype.slice.call(or,0,cr)),hr[cr]=or[cr]);return lr.concat(hr||Array.prototype.slice.call(or))}typeof SuppressedError=="function"&&SuppressedError;var ErrorKind;(function(lr){lr[lr.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",lr[lr.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",lr[lr.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",lr[lr.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",lr[lr.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",lr[lr.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",lr[lr.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",lr[lr.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",lr[lr.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",lr[lr.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",lr[lr.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",lr[lr.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",lr[lr.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",lr[lr.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",lr[lr.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",lr[lr.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",lr[lr.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",lr[lr.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",lr[lr.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",lr[lr.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",lr[lr.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",lr[lr.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",lr[lr.INVALID_TAG=23]="INVALID_TAG",lr[lr.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",lr[lr.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",lr[lr.UNCLOSED_TAG=27]="UNCLOSED_TAG"})(ErrorKind||(ErrorKind={}));var TYPE;(function(lr){lr[lr.literal=0]="literal",lr[lr.argument=1]="argument",lr[lr.number=2]="number",lr[lr.date=3]="date",lr[lr.time=4]="time",lr[lr.select=5]="select",lr[lr.plural=6]="plural",lr[lr.pound=7]="pound",lr[lr.tag=8]="tag"})(TYPE||(TYPE={}));var SKELETON_TYPE;(function(lr){lr[lr.number=0]="number",lr[lr.dateTime=1]="dateTime"})(SKELETON_TYPE||(SKELETON_TYPE={}));function isLiteralElement(lr){return lr.type===TYPE.literal}function isArgumentElement(lr){return lr.type===TYPE.argument}function isNumberElement(lr){return lr.type===TYPE.number}function isDateElement(lr){return lr.type===TYPE.date}function isTimeElement(lr){return lr.type===TYPE.time}function isSelectElement(lr){return lr.type===TYPE.select}function isPluralElement(lr){return lr.type===TYPE.plural}function isPoundElement(lr){return lr.type===TYPE.pound}function isTagElement(lr){return lr.type===TYPE.tag}function isNumberSkeleton(lr){return!!(lr&&typeof lr=="object"&&lr.type===SKELETON_TYPE.number)}function isDateTimeSkeleton(lr){return!!(lr&&typeof lr=="object"&&lr.type===SKELETON_TYPE.dateTime)}var SPACE_SEPARATOR_REGEX=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,DATE_TIME_REGEX=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function parseDateTimeSkeleton(lr){var or={};return lr.replace(DATE_TIME_REGEX,function(ar){var cr=ar.length;switch(ar[0]){case"G":or.era=cr===4?"long":cr===5?"narrow":"short";break;case"y":or.year=cr===2?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":or.month=["numeric","2-digit","short","long","narrow"][cr-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":or.day=["numeric","2-digit"][cr-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":or.weekday=cr===4?"short":cr===5?"narrow":"short";break;case"e":if(cr<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");or.weekday=["short","long","narrow","short"][cr-4];break;case"c":if(cr<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");or.weekday=["short","long","narrow","short"][cr-4];break;case"a":or.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":or.hourCycle="h12",or.hour=["numeric","2-digit"][cr-1];break;case"H":or.hourCycle="h23",or.hour=["numeric","2-digit"][cr-1];break;case"K":or.hourCycle="h11",or.hour=["numeric","2-digit"][cr-1];break;case"k":or.hourCycle="h24",or.hour=["numeric","2-digit"][cr-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":or.minute=["numeric","2-digit"][cr-1];break;case"s":or.second=["numeric","2-digit"][cr-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":or.timeZoneName=cr<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""}),or}var WHITE_SPACE_REGEX=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;function parseNumberSkeletonFromString(lr){if(lr.length===0)throw new Error("Number skeleton cannot be empty");for(var or=lr.split(WHITE_SPACE_REGEX).filter(function(br){return br.length>0}),ar=[],cr=0,ur=or;cr<ur.length;cr++){var hr=ur[cr],fr=hr.split("/");if(fr.length===0)throw new Error("Invalid number skeleton");for(var dr=fr[0],pr=fr.slice(1),mr=0,gr=pr;mr<gr.length;mr++){var yr=gr[mr];if(yr.length===0)throw new Error("Invalid number skeleton")}ar.push({stem:dr,options:pr})}return ar}function icuUnitToEcma(lr){return lr.replace(/^(.*?)-/,"")}var FRACTION_PRECISION_REGEX=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,SIGNIFICANT_PRECISION_REGEX=/^(@+)?(\+|#+)?[rs]?$/g,INTEGER_WIDTH_REGEX=/(\*)(0+)|(#+)(0+)|(0+)/g,CONCISE_INTEGER_WIDTH_REGEX=/^(0+)$/;function parseSignificantPrecision(lr){var or={};return lr[lr.length-1]==="r"?or.roundingPriority="morePrecision":lr[lr.length-1]==="s"&&(or.roundingPriority="lessPrecision"),lr.replace(SIGNIFICANT_PRECISION_REGEX,function(ar,cr,ur){return typeof ur!="string"?(or.minimumSignificantDigits=cr.length,or.maximumSignificantDigits=cr.length):ur==="+"?or.minimumSignificantDigits=cr.length:cr[0]==="#"?or.maximumSignificantDigits=cr.length:(or.minimumSignificantDigits=cr.length,or.maximumSignificantDigits=cr.length+(typeof ur=="string"?ur.length:0)),""}),or}function parseSign(lr){switch(lr){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function parseConciseScientificAndEngineeringStem(lr){var or;if(lr[0]==="E"&&lr[1]==="E"?(or={notation:"engineering"},lr=lr.slice(2)):lr[0]==="E"&&(or={notation:"scientific"},lr=lr.slice(1)),or){var ar=lr.slice(0,2);if(ar==="+!"?(or.signDisplay="always",lr=lr.slice(2)):ar==="+?"&&(or.signDisplay="exceptZero",lr=lr.slice(2)),!CONCISE_INTEGER_WIDTH_REGEX.test(lr))throw new Error("Malformed concise eng/scientific notation");or.minimumIntegerDigits=lr.length}return or}function parseNotationOptions(lr){var or={},ar=parseSign(lr);return ar||or}function parseNumberSkeleton(lr){for(var or={},ar=0,cr=lr;ar<cr.length;ar++){var ur=cr[ar];switch(ur.stem){case"percent":case"%":or.style="percent";continue;case"%x100":or.style="percent",or.scale=100;continue;case"currency":or.style="currency",or.currency=ur.options[0];continue;case"group-off":case",_":or.useGrouping=!1;continue;case"precision-integer":case".":or.maximumFractionDigits=0;continue;case"measure-unit":case"unit":or.style="unit",or.unit=icuUnitToEcma(ur.options[0]);continue;case"compact-short":case"K":or.notation="compact",or.compactDisplay="short";continue;case"compact-long":case"KK":or.notation="compact",or.compactDisplay="long";continue;case"scientific":or=__assign(__assign(__assign({},or),{notation:"scientific"}),ur.options.reduce(function(pr,mr){return __assign(__assign({},pr),parseNotationOptions(mr))},{}));continue;case"engineering":or=__assign(__assign(__assign({},or),{notation:"engineering"}),ur.options.reduce(function(pr,mr){return __assign(__assign({},pr),parseNotationOptions(mr))},{}));continue;case"notation-simple":or.notation="standard";continue;case"unit-width-narrow":or.currencyDisplay="narrowSymbol",or.unitDisplay="narrow";continue;case"unit-width-short":or.currencyDisplay="code",or.unitDisplay="short";continue;case"unit-width-full-name":or.currencyDisplay="name",or.unitDisplay="long";continue;case"unit-width-iso-code":or.currencyDisplay="symbol";continue;case"scale":or.scale=parseFloat(ur.options[0]);continue;case"integer-width":if(ur.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");ur.options[0].replace(INTEGER_WIDTH_REGEX,function(pr,mr,gr,yr,br,Or){if(mr)or.minimumIntegerDigits=gr.length;else{if(yr&&br)throw new Error("We currently do not support maximum integer digits");if(Or)throw new Error("We currently do not support exact integer digits")}return""});continue}if(CONCISE_INTEGER_WIDTH_REGEX.test(ur.stem)){or.minimumIntegerDigits=ur.stem.length;continue}if(FRACTION_PRECISION_REGEX.test(ur.stem)){if(ur.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");ur.stem.replace(FRACTION_PRECISION_REGEX,function(pr,mr,gr,yr,br,Or){return gr==="*"?or.minimumFractionDigits=mr.length:yr&&yr[0]==="#"?or.maximumFractionDigits=yr.length:br&&Or?(or.minimumFractionDigits=br.length,or.maximumFractionDigits=br.length+Or.length):(or.minimumFractionDigits=mr.length,or.maximumFractionDigits=mr.length),""});var hr=ur.options[0];hr==="w"?or=__assign(__assign({},or),{trailingZeroDisplay:"stripIfInteger"}):hr&&(or=__assign(__assign({},or),parseSignificantPrecision(hr)));continue}if(SIGNIFICANT_PRECISION_REGEX.test(ur.stem)){or=__assign(__assign({},or),parseSignificantPrecision(ur.stem));continue}var fr=parseSign(ur.stem);fr&&(or=__assign(__assign({},or),fr));var dr=parseConciseScientificAndEngineeringStem(ur.stem);dr&&(or=__assign(__assign({},or),dr))}return or}var timeData={AX:["H"],BQ:["H"],CP:["H"],CZ:["H"],DK:["H"],FI:["H"],ID:["H"],IS:["H"],ML:["H"],NE:["H"],RU:["H"],SE:["H"],SJ:["H"],SK:["H"],AS:["h","H"],BT:["h","H"],DJ:["h","H"],ER:["h","H"],GH:["h","H"],IN:["h","H"],LS:["h","H"],PG:["h","H"],PW:["h","H"],SO:["h","H"],TO:["h","H"],VU:["h","H"],WS:["h","H"],"001":["H","h"],AL:["h","H","hB"],TD:["h","H","hB"],"ca-ES":["H","h","hB"],CF:["H","h","hB"],CM:["H","h","hB"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],LU:["H","h","hB"],NP:["H","h","hB"],PF:["H","h","hB"],SC:["H","h","hB"],SM:["H","h","hB"],SN:["H","h","hB"],TF:["H","h","hB"],VA:["H","h","hB"],CY:["h","H","hb","hB"],GR:["h","H","hb","hB"],CO:["h","H","hB","hb"],DO:["h","H","hB","hb"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],NA:["h","H","hB","hb"],PA:["h","H","hB","hb"],PR:["h","H","hB","hb"],VE:["h","H","hB","hb"],AC:["H","h","hb","hB"],AI:["H","h","hb","hB"],BW:["H","h","hb","hB"],BZ:["H","h","hb","hB"],CC:["H","h","hb","hB"],CK:["H","h","hb","hB"],CX:["H","h","hb","hB"],DG:["H","h","hb","hB"],FK:["H","h","hb","hB"],GB:["H","h","hb","hB"],GG:["H","h","hb","hB"],GI:["H","h","hb","hB"],IE:["H","h","hb","hB"],IM:["H","h","hb","hB"],IO:["H","h","hb","hB"],JE:["H","h","hb","hB"],LT:["H","h","hb","hB"],MK:["H","h","hb","hB"],MN:["H","h","hb","hB"],MS:["H","h","hb","hB"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],PN:["H","h","hb","hB"],SH:["H","h","hb","hB"],SX:["H","h","hb","hB"],TA:["H","h","hb","hB"],ZA:["H","h","hb","hB"],"af-ZA":["H","h","hB","hb"],AR:["H","h","hB","hb"],CL:["H","h","hB","hb"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],EA:["H","h","hB","hb"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],GT:["H","h","hB","hb"],HN:["H","h","hB","hb"],IC:["H","h","hB","hb"],KG:["H","h","hB","hb"],KM:["H","h","hB","hb"],LK:["H","h","hB","hb"],MA:["H","h","hB","hb"],MX:["H","h","hB","hb"],NI:["H","h","hB","hb"],PY:["H","h","hB","hb"],SV:["H","h","hB","hb"],UY:["H","h","hB","hb"],JP:["H","h","K"],AD:["H","hB"],AM:["H","hB"],AO:["H","hB"],AT:["H","hB"],AW:["H","hB"],BE:["H","hB"],BF:["H","hB"],BJ:["H","hB"],BL:["H","hB"],BR:["H","hB"],CG:["H","hB"],CI:["H","hB"],CV:["H","hB"],DE:["H","hB"],EE:["H","hB"],FR:["H","hB"],GA:["H","hB"],GF:["H","hB"],GN:["H","hB"],GP:["H","hB"],GW:["H","hB"],HR:["H","hB"],IL:["H","hB"],IT:["H","hB"],KZ:["H","hB"],MC:["H","hB"],MD:["H","hB"],MF:["H","hB"],MQ:["H","hB"],MZ:["H","hB"],NC:["H","hB"],NL:["H","hB"],PM:["H","hB"],PT:["H","hB"],RE:["H","hB"],RO:["H","hB"],SI:["H","hB"],SR:["H","hB"],ST:["H","hB"],TG:["H","hB"],TR:["H","hB"],WF:["H","hB"],YT:["H","hB"],BD:["h","hB","H"],PK:["h","hB","H"],AZ:["H","hB","h"],BA:["H","hB","h"],BG:["H","hB","h"],CH:["H","hB","h"],GE:["H","hB","h"],LI:["H","hB","h"],ME:["H","hB","h"],RS:["H","hB","h"],UA:["H","hB","h"],UZ:["H","hB","h"],XK:["H","hB","h"],AG:["h","hb","H","hB"],AU:["h","hb","H","hB"],BB:["h","hb","H","hB"],BM:["h","hb","H","hB"],BS:["h","hb","H","hB"],CA:["h","hb","H","hB"],DM:["h","hb","H","hB"],"en-001":["h","hb","H","hB"],FJ:["h","hb","H","hB"],FM:["h","hb","H","hB"],GD:["h","hb","H","hB"],GM:["h","hb","H","hB"],GU:["h","hb","H","hB"],GY:["h","hb","H","hB"],JM:["h","hb","H","hB"],KI:["h","hb","H","hB"],KN:["h","hb","H","hB"],KY:["h","hb","H","hB"],LC:["h","hb","H","hB"],LR:["h","hb","H","hB"],MH:["h","hb","H","hB"],MP:["h","hb","H","hB"],MW:["h","hb","H","hB"],NZ:["h","hb","H","hB"],SB:["h","hb","H","hB"],SG:["h","hb","H","hB"],SL:["h","hb","H","hB"],SS:["h","hb","H","hB"],SZ:["h","hb","H","hB"],TC:["h","hb","H","hB"],TT:["h","hb","H","hB"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],VC:["h","hb","H","hB"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],ZM:["h","hb","H","hB"],BO:["H","hB","h","hb"],EC:["H","hB","h","hb"],ES:["H","hB","h","hb"],GQ:["H","hB","h","hb"],PE:["H","hB","h","hb"],AE:["h","hB","hb","H"],"ar-001":["h","hB","hb","H"],BH:["h","hB","hb","H"],DZ:["h","hB","hb","H"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],HK:["h","hB","hb","H"],IQ:["h","hB","hb","H"],JO:["h","hB","hb","H"],KW:["h","hB","hb","H"],LB:["h","hB","hb","H"],LY:["h","hB","hb","H"],MO:["h","hB","hb","H"],MR:["h","hB","hb","H"],OM:["h","hB","hb","H"],PH:["h","hB","hb","H"],PS:["h","hB","hb","H"],QA:["h","hB","hb","H"],SA:["h","hB","hb","H"],SD:["h","hB","hb","H"],SY:["h","hB","hb","H"],TN:["h","hB","hb","H"],YE:["h","hB","hb","H"],AF:["H","hb","hB","h"],LA:["H","hb","hB","h"],CN:["H","hB","hb","h"],LV:["H","hB","hb","h"],TL:["H","hB","hb","h"],"zu-ZA":["H","hB","hb","h"],CD:["hB","H"],IR:["hB","H"],"hi-IN":["hB","h","H"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"te-IN":["hB","h","H"],KH:["hB","h","H","hb"],"ta-IN":["hB","h","hb","H"],BN:["hb","hB","h","H"],MY:["hb","hB","h","H"],ET:["hB","hb","h","H"],"gu-IN":["hB","hb","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],TW:["hB","hb","h","H"],KE:["hB","hb","H","h"],MM:["hB","hb","H","h"],TZ:["hB","hb","H","h"],UG:["hB","hb","H","h"]};function getBestPattern(lr,or){for(var ar="",cr=0;cr<lr.length;cr++){var ur=lr.charAt(cr);if(ur==="j"){for(var hr=0;cr+1<lr.length&&lr.charAt(cr+1)===ur;)hr++,cr++;var fr=1+(hr&1),dr=hr<2?1:3+(hr>>1),pr="a",mr=getDefaultHourSymbolFromLocale(or);for((mr=="H"||mr=="k")&&(dr=0);dr-- >0;)ar+=pr;for(;fr-- >0;)ar=mr+ar}else ur==="J"?ar+="H":ar+=ur}return ar}function getDefaultHourSymbolFromLocale(lr){var or=lr.hourCycle;if(or===void 0&&lr.hourCycles&&lr.hourCycles.length&&(or=lr.hourCycles[0]),or)switch(or){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var ar=lr.language,cr;ar!=="root"&&(cr=lr.maximize().region);var ur=timeData[cr||""]||timeData[ar||""]||timeData["".concat(ar,"-001")]||timeData["001"];return ur[0]}var _a$1,SPACE_SEPARATOR_START_REGEX=new RegExp("^".concat(SPACE_SEPARATOR_REGEX.source,"*")),SPACE_SEPARATOR_END_REGEX=new RegExp("".concat(SPACE_SEPARATOR_REGEX.source,"*$"));function createLocation(lr,or){return{start:lr,end:or}}var hasNativeStartsWith=!!String.prototype.startsWith,hasNativeFromCodePoint=!!String.fromCodePoint,hasNativeFromEntries=!!Object.fromEntries,hasNativeCodePointAt=!!String.prototype.codePointAt,hasTrimStart=!!String.prototype.trimStart,hasTrimEnd=!!String.prototype.trimEnd,hasNativeIsSafeInteger=!!Number.isSafeInteger,isSafeInteger=hasNativeIsSafeInteger?Number.isSafeInteger:function(lr){return typeof lr=="number"&&isFinite(lr)&&Math.floor(lr)===lr&&Math.abs(lr)<=9007199254740991},REGEX_SUPPORTS_U_AND_Y=!0;try{var re$2=RE("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");REGEX_SUPPORTS_U_AND_Y=((_a$1=re$2.exec("a"))===null||_a$1===void 0?void 0:_a$1[0])==="a"}catch{REGEX_SUPPORTS_U_AND_Y=!1}var startsWith=hasNativeStartsWith?function(or,ar,cr){return or.startsWith(ar,cr)}:function(or,ar,cr){return or.slice(cr,cr+ar.length)===ar},fromCodePoint$1=hasNativeFromCodePoint?String.fromCodePoint:function(){for(var or=[],ar=0;ar<arguments.length;ar++)or[ar]=arguments[ar];for(var cr="",ur=or.length,hr=0,fr;ur>hr;){if(fr=or[hr++],fr>1114111)throw RangeError(fr+" is not a valid code point");cr+=fr<65536?String.fromCharCode(fr):String.fromCharCode(((fr-=65536)>>10)+55296,fr%1024+56320)}return cr},fromEntries=hasNativeFromEntries?Object.fromEntries:function(or){for(var ar={},cr=0,ur=or;cr<ur.length;cr++){var hr=ur[cr],fr=hr[0],dr=hr[1];ar[fr]=dr}return ar},codePointAt$1=hasNativeCodePointAt?function(or,ar){return or.codePointAt(ar)}:function(or,ar){var cr=or.length;if(!(ar<0||ar>=cr)){var ur=or.charCodeAt(ar),hr;return ur<55296||ur>56319||ar+1===cr||(hr=or.charCodeAt(ar+1))<56320||hr>57343?ur:(ur-55296<<10)+(hr-56320)+65536}},trimStart=hasTrimStart?function(or){return or.trimStart()}:function(or){return or.replace(SPACE_SEPARATOR_START_REGEX,"")},trimEnd=hasTrimEnd?function(or){return or.trimEnd()}:function(or){return or.replace(SPACE_SEPARATOR_END_REGEX,"")};function RE(lr,or){return new RegExp(lr,or)}var matchIdentifierAtIndex;if(REGEX_SUPPORTS_U_AND_Y){var IDENTIFIER_PREFIX_RE_1=RE("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");matchIdentifierAtIndex=function(or,ar){var cr;IDENTIFIER_PREFIX_RE_1.lastIndex=ar;var ur=IDENTIFIER_PREFIX_RE_1.exec(or);return(cr=ur[1])!==null&&cr!==void 0?cr:""}}else matchIdentifierAtIndex=function(or,ar){for(var cr=[];;){var ur=codePointAt$1(or,ar);if(ur===void 0||_isWhiteSpace(ur)||_isPatternSyntax(ur))break;cr.push(ur),ar+=ur>=65536?2:1}return fromCodePoint$1.apply(void 0,cr)};var Parser$1=function(){function lr(or,ar){ar===void 0&&(ar={}),this.message=or,this.position={offset:0,line:1,column:1},this.ignoreTag=!!ar.ignoreTag,this.locale=ar.locale,this.requiresOtherClause=!!ar.requiresOtherClause,this.shouldParseSkeletons=!!ar.shouldParseSkeletons}return lr.prototype.parse=function(){if(this.offset()!==0)throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},lr.prototype.parseMessage=function(or,ar,cr){for(var ur=[];!this.isEOF();){var hr=this.char();if(hr===123){var fr=this.parseArgument(or,cr);if(fr.err)return fr;ur.push(fr.val)}else{if(hr===125&&or>0)break;if(hr===35&&(ar==="plural"||ar==="selectordinal")){var dr=this.clonePosition();this.bump(),ur.push({type:TYPE.pound,location:createLocation(dr,this.clonePosition())})}else if(hr===60&&!this.ignoreTag&&this.peek()===47){if(cr)break;return this.error(ErrorKind.UNMATCHED_CLOSING_TAG,createLocation(this.clonePosition(),this.clonePosition()))}else if(hr===60&&!this.ignoreTag&&_isAlpha(this.peek()||0)){var fr=this.parseTag(or,ar);if(fr.err)return fr;ur.push(fr.val)}else{var fr=this.parseLiteral(or,ar);if(fr.err)return fr;ur.push(fr.val)}}}return{val:ur,err:null}},lr.prototype.parseTag=function(or,ar){var cr=this.clonePosition();this.bump();var ur=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:TYPE.literal,value:"<".concat(ur,"/>"),location:createLocation(cr,this.clonePosition())},err:null};if(this.bumpIf(">")){var hr=this.parseMessage(or+1,ar,!0);if(hr.err)return hr;var fr=hr.val,dr=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!_isAlpha(this.char()))return this.error(ErrorKind.INVALID_TAG,createLocation(dr,this.clonePosition()));var pr=this.clonePosition(),mr=this.parseTagName();return ur!==mr?this.error(ErrorKind.UNMATCHED_CLOSING_TAG,createLocation(pr,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:TYPE.tag,value:ur,children:fr,location:createLocation(cr,this.clonePosition())},err:null}:this.error(ErrorKind.INVALID_TAG,createLocation(dr,this.clonePosition())))}else return this.error(ErrorKind.UNCLOSED_TAG,createLocation(cr,this.clonePosition()))}else return this.error(ErrorKind.INVALID_TAG,createLocation(cr,this.clonePosition()))},lr.prototype.parseTagName=function(){var or=this.offset();for(this.bump();!this.isEOF()&&_isPotentialElementNameChar(this.char());)this.bump();return this.message.slice(or,this.offset())},lr.prototype.parseLiteral=function(or,ar){for(var cr=this.clonePosition(),ur="";;){var hr=this.tryParseQuote(ar);if(hr){ur+=hr;continue}var fr=this.tryParseUnquoted(or,ar);if(fr){ur+=fr;continue}var dr=this.tryParseLeftAngleBracket();if(dr){ur+=dr;continue}break}var pr=createLocation(cr,this.clonePosition());return{val:{type:TYPE.literal,value:ur,location:pr},err:null}},lr.prototype.tryParseLeftAngleBracket=function(){return!this.isEOF()&&this.char()===60&&(this.ignoreTag||!_isAlphaOrSlash(this.peek()||0))?(this.bump(),"<"):null},lr.prototype.tryParseQuote=function(or){if(this.isEOF()||this.char()!==39)return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if(or==="plural"||or==="selectordinal")break;return null;default:return null}this.bump();var ar=[this.char()];for(this.bump();!this.isEOF();){var cr=this.char();if(cr===39)if(this.peek()===39)ar.push(39),this.bump();else{this.bump();break}else ar.push(cr);this.bump()}return fromCodePoint$1.apply(void 0,ar)},lr.prototype.tryParseUnquoted=function(or,ar){if(this.isEOF())return null;var cr=this.char();return cr===60||cr===123||cr===35&&(ar==="plural"||ar==="selectordinal")||cr===125&&or>0?null:(this.bump(),fromCodePoint$1(cr))},lr.prototype.parseArgument=function(or,ar){var cr=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE,createLocation(cr,this.clonePosition()));if(this.char()===125)return this.bump(),this.error(ErrorKind.EMPTY_ARGUMENT,createLocation(cr,this.clonePosition()));var ur=this.parseIdentifierIfPossible().value;if(!ur)return this.error(ErrorKind.MALFORMED_ARGUMENT,createLocation(cr,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE,createLocation(cr,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:TYPE.argument,value:ur,location:createLocation(cr,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE,createLocation(cr,this.clonePosition())):this.parseArgumentOptions(or,ar,ur,cr);default:return this.error(ErrorKind.MALFORMED_ARGUMENT,createLocation(cr,this.clonePosition()))}},lr.prototype.parseIdentifierIfPossible=function(){var or=this.clonePosition(),ar=this.offset(),cr=matchIdentifierAtIndex(this.message,ar),ur=ar+cr.length;this.bumpTo(ur);var hr=this.clonePosition(),fr=createLocation(or,hr);return{value:cr,location:fr}},lr.prototype.parseArgumentOptions=function(or,ar,cr,ur){var hr,fr=this.clonePosition(),dr=this.parseIdentifierIfPossible().value,pr=this.clonePosition();switch(dr){case"":return this.error(ErrorKind.EXPECT_ARGUMENT_TYPE,createLocation(fr,pr));case"number":case"date":case"time":{this.bumpSpace();var mr=null;if(this.bumpIf(",")){this.bumpSpace();var gr=this.clonePosition(),yr=this.parseSimpleArgStyleIfPossible();if(yr.err)return yr;var br=trimEnd(yr.val);if(br.length===0)return this.error(ErrorKind.EXPECT_ARGUMENT_STYLE,createLocation(this.clonePosition(),this.clonePosition()));var Or=createLocation(gr,this.clonePosition());mr={style:br,styleLocation:Or}}var _r=this.tryParseArgumentClose(ur);if(_r.err)return _r;var vr=createLocation(ur,this.clonePosition());if(mr&&startsWith(mr==null?void 0:mr.style,"::",0)){var xr=trimStart(mr.style.slice(2));if(dr==="number"){var yr=this.parseNumberSkeletonFromString(xr,mr.styleLocation);return yr.err?yr:{val:{type:TYPE.number,value:cr,location:vr,style:yr.val},err:null}}else{if(xr.length===0)return this.error(ErrorKind.EXPECT_DATE_TIME_SKELETON,vr);var wr=xr;this.locale&&(wr=getBestPattern(xr,this.locale));var br={type:SKELETON_TYPE.dateTime,pattern:wr,location:mr.styleLocation,parsedOptions:this.shouldParseSkeletons?parseDateTimeSkeleton(wr):{}},kr=dr==="date"?TYPE.date:TYPE.time;return{val:{type:kr,value:cr,location:vr,style:br},err:null}}}return{val:{type:dr==="number"?TYPE.number:dr==="date"?TYPE.date:TYPE.time,value:cr,location:vr,style:(hr=mr==null?void 0:mr.style)!==null&&hr!==void 0?hr:null},err:null}}case"plural":case"selectordinal":case"select":{var Cr=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(ErrorKind.EXPECT_SELECT_ARGUMENT_OPTIONS,createLocation(Cr,__assign({},Cr)));this.bumpSpace();var $r=this.parseIdentifierIfPossible(),Nr=0;if(dr!=="select"&&$r.value==="offset"){if(!this.bumpIf(":"))return this.error(ErrorKind.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,createLocation(this.clonePosition(),this.clonePosition()));this.bumpSpace();var yr=this.tryParseDecimalInteger(ErrorKind.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,ErrorKind.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);if(yr.err)return yr;this.bumpSpace(),$r=this.parseIdentifierIfPossible(),Nr=yr.val}var Br=this.tryParsePluralOrSelectOptions(or,dr,ar,$r);if(Br.err)return Br;var _r=this.tryParseArgumentClose(ur);if(_r.err)return _r;var Fr=createLocation(ur,this.clonePosition());return dr==="select"?{val:{type:TYPE.select,value:cr,options:fromEntries(Br.val),location:Fr},err:null}:{val:{type:TYPE.plural,value:cr,options:fromEntries(Br.val),offset:Nr,pluralType:dr==="plural"?"cardinal":"ordinal",location:Fr},err:null}}default:return this.error(ErrorKind.INVALID_ARGUMENT_TYPE,createLocation(fr,pr))}},lr.prototype.tryParseArgumentClose=function(or){return this.isEOF()||this.char()!==125?this.error(ErrorKind.EXPECT_ARGUMENT_CLOSING_BRACE,createLocation(or,this.clonePosition())):(this.bump(),{val:!0,err:null})},lr.prototype.parseSimpleArgStyleIfPossible=function(){for(var or=0,ar=this.clonePosition();!this.isEOF();){var cr=this.char();switch(cr){case 39:{this.bump();var ur=this.clonePosition();if(!this.bumpUntil("'"))return this.error(ErrorKind.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,createLocation(ur,this.clonePosition()));this.bump();break}case 123:{or+=1,this.bump();break}case 125:{if(or>0)or-=1;else return{val:this.message.slice(ar.offset,this.offset()),err:null};break}default:this.bump();break}}return{val:this.message.slice(ar.offset,this.offset()),err:null}},lr.prototype.parseNumberSkeletonFromString=function(or,ar){var cr=[];try{cr=parseNumberSkeletonFromString(or)}catch{return this.error(ErrorKind.INVALID_NUMBER_SKELETON,ar)}return{val:{type:SKELETON_TYPE.number,tokens:cr,location:ar,parsedOptions:this.shouldParseSkeletons?parseNumberSkeleton(cr):{}},err:null}},lr.prototype.tryParsePluralOrSelectOptions=function(or,ar,cr,ur){for(var hr,fr=!1,dr=[],pr=new Set,mr=ur.value,gr=ur.location;;){if(mr.length===0){var yr=this.clonePosition();if(ar!=="select"&&this.bumpIf("=")){var br=this.tryParseDecimalInteger(ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR,ErrorKind.INVALID_PLURAL_ARGUMENT_SELECTOR);if(br.err)return br;gr=createLocation(yr,this.clonePosition()),mr=this.message.slice(yr.offset,this.offset())}else break}if(pr.has(mr))return this.error(ar==="select"?ErrorKind.DUPLICATE_SELECT_ARGUMENT_SELECTOR:ErrorKind.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,gr);mr==="other"&&(fr=!0),this.bumpSpace();var Or=this.clonePosition();if(!this.bumpIf("{"))return this.error(ar==="select"?ErrorKind.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,createLocation(this.clonePosition(),this.clonePosition()));var _r=this.parseMessage(or+1,ar,cr);if(_r.err)return _r;var vr=this.tryParseArgumentClose(Or);if(vr.err)return vr;dr.push([mr,{value:_r.val,location:createLocation(Or,this.clonePosition())}]),pr.add(mr),this.bumpSpace(),hr=this.parseIdentifierIfPossible(),mr=hr.value,gr=hr.location}return dr.length===0?this.error(ar==="select"?ErrorKind.EXPECT_SELECT_ARGUMENT_SELECTOR:ErrorKind.EXPECT_PLURAL_ARGUMENT_SELECTOR,createLocation(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!fr?this.error(ErrorKind.MISSING_OTHER_CLAUSE,createLocation(this.clonePosition(),this.clonePosition())):{val:dr,err:null}},lr.prototype.tryParseDecimalInteger=function(or,ar){var cr=1,ur=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(cr=-1);for(var hr=!1,fr=0;!this.isEOF();){var dr=this.char();if(dr>=48&&dr<=57)hr=!0,fr=fr*10+(dr-48),this.bump();else break}var pr=createLocation(ur,this.clonePosition());return hr?(fr*=cr,isSafeInteger(fr)?{val:fr,err:null}:this.error(ar,pr)):this.error(or,pr)},lr.prototype.offset=function(){return this.position.offset},lr.prototype.isEOF=function(){return this.offset()===this.message.length},lr.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},lr.prototype.char=function(){var or=this.position.offset;if(or>=this.message.length)throw Error("out of bound");var ar=codePointAt$1(this.message,or);if(ar===void 0)throw Error("Offset ".concat(or," is at invalid UTF-16 code unit boundary"));return ar},lr.prototype.error=function(or,ar){return{val:null,err:{kind:or,message:this.message,location:ar}}},lr.prototype.bump=function(){if(!this.isEOF()){var or=this.char();or===10?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=or<65536?1:2)}},lr.prototype.bumpIf=function(or){if(startsWith(this.message,or,this.offset())){for(var ar=0;ar<or.length;ar++)this.bump();return!0}return!1},lr.prototype.bumpUntil=function(or){var ar=this.offset(),cr=this.message.indexOf(or,ar);return cr>=0?(this.bumpTo(cr),!0):(this.bumpTo(this.message.length),!1)},lr.prototype.bumpTo=function(or){if(this.offset()>or)throw Error("targetOffset ".concat(or," must be greater than or equal to the current offset ").concat(this.offset()));for(or=Math.min(or,this.message.length);;){var ar=this.offset();if(ar===or)break;if(ar>or)throw Error("targetOffset ".concat(or," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},lr.prototype.bumpSpace=function(){for(;!this.isEOF()&&_isWhiteSpace(this.char());)this.bump()},lr.prototype.peek=function(){if(this.isEOF())return null;var or=this.char(),ar=this.offset(),cr=this.message.charCodeAt(ar+(or>=65536?2:1));return cr??null},lr}();function _isAlpha(lr){return lr>=97&&lr<=122||lr>=65&&lr<=90}function _isAlphaOrSlash(lr){return _isAlpha(lr)||lr===47}function _isPotentialElementNameChar(lr){return lr===45||lr===46||lr>=48&&lr<=57||lr===95||lr>=97&&lr<=122||lr>=65&&lr<=90||lr==183||lr>=192&&lr<=214||lr>=216&&lr<=246||lr>=248&&lr<=893||lr>=895&&lr<=8191||lr>=8204&&lr<=8205||lr>=8255&&lr<=8256||lr>=8304&&lr<=8591||lr>=11264&&lr<=12271||lr>=12289&&lr<=55295||lr>=63744&&lr<=64975||lr>=65008&&lr<=65533||lr>=65536&&lr<=983039}function _isWhiteSpace(lr){return lr>=9&&lr<=13||lr===32||lr===133||lr>=8206&&lr<=8207||lr===8232||lr===8233}function _isPatternSyntax(lr){return lr>=33&&lr<=35||lr===36||lr>=37&&lr<=39||lr===40||lr===41||lr===42||lr===43||lr===44||lr===45||lr>=46&&lr<=47||lr>=58&&lr<=59||lr>=60&&lr<=62||lr>=63&&lr<=64||lr===91||lr===92||lr===93||lr===94||lr===96||lr===123||lr===124||lr===125||lr===126||lr===161||lr>=162&&lr<=165||lr===166||lr===167||lr===169||lr===171||lr===172||lr===174||lr===176||lr===177||lr===182||lr===187||lr===191||lr===215||lr===247||lr>=8208&&lr<=8213||lr>=8214&&lr<=8215||lr===8216||lr===8217||lr===8218||lr>=8219&&lr<=8220||lr===8221||lr===8222||lr===8223||lr>=8224&&lr<=8231||lr>=8240&&lr<=8248||lr===8249||lr===8250||lr>=8251&&lr<=8254||lr>=8257&&lr<=8259||lr===8260||lr===8261||lr===8262||lr>=8263&&lr<=8273||lr===8274||lr===8275||lr>=8277&&lr<=8286||lr>=8592&&lr<=8596||lr>=8597&&lr<=8601||lr>=8602&&lr<=8603||lr>=8604&&lr<=8607||lr===8608||lr>=8609&&lr<=8610||lr===8611||lr>=8612&&lr<=8613||lr===8614||lr>=8615&&lr<=8621||lr===8622||lr>=8623&&lr<=8653||lr>=8654&&lr<=8655||lr>=8656&&lr<=8657||lr===8658||lr===8659||lr===8660||lr>=8661&&lr<=8691||lr>=8692&&lr<=8959||lr>=8960&&lr<=8967||lr===8968||lr===8969||lr===8970||lr===8971||lr>=8972&&lr<=8991||lr>=8992&&lr<=8993||lr>=8994&&lr<=9e3||lr===9001||lr===9002||lr>=9003&&lr<=9083||lr===9084||lr>=9085&&lr<=9114||lr>=9115&&lr<=9139||lr>=9140&&lr<=9179||lr>=9180&&lr<=9185||lr>=9186&&lr<=9254||lr>=9255&&lr<=9279||lr>=9280&&lr<=9290||lr>=9291&&lr<=9311||lr>=9472&&lr<=9654||lr===9655||lr>=9656&&lr<=9664||lr===9665||lr>=9666&&lr<=9719||lr>=9720&&lr<=9727||lr>=9728&&lr<=9838||lr===9839||lr>=9840&&lr<=10087||lr===10088||lr===10089||lr===10090||lr===10091||lr===10092||lr===10093||lr===10094||lr===10095||lr===10096||lr===10097||lr===10098||lr===10099||lr===10100||lr===10101||lr>=10132&&lr<=10175||lr>=10176&&lr<=10180||lr===10181||lr===10182||lr>=10183&&lr<=10213||lr===10214||lr===10215||lr===10216||lr===10217||lr===10218||lr===10219||lr===10220||lr===10221||lr===10222||lr===10223||lr>=10224&&lr<=10239||lr>=10240&&lr<=10495||lr>=10496&&lr<=10626||lr===10627||lr===10628||lr===10629||lr===10630||lr===10631||lr===10632||lr===10633||lr===10634||lr===10635||lr===10636||lr===10637||lr===10638||lr===10639||lr===10640||lr===10641||lr===10642||lr===10643||lr===10644||lr===10645||lr===10646||lr===10647||lr===10648||lr>=10649&&lr<=10711||lr===10712||lr===10713||lr===10714||lr===10715||lr>=10716&&lr<=10747||lr===10748||lr===10749||lr>=10750&&lr<=11007||lr>=11008&&lr<=11055||lr>=11056&&lr<=11076||lr>=11077&&lr<=11078||lr>=11079&&lr<=11084||lr>=11085&&lr<=11123||lr>=11124&&lr<=11125||lr>=11126&&lr<=11157||lr===11158||lr>=11159&&lr<=11263||lr>=11776&&lr<=11777||lr===11778||lr===11779||lr===11780||lr===11781||lr>=11782&&lr<=11784||lr===11785||lr===11786||lr===11787||lr===11788||lr===11789||lr>=11790&&lr<=11798||lr===11799||lr>=11800&&lr<=11801||lr===11802||lr===11803||lr===11804||lr===11805||lr>=11806&&lr<=11807||lr===11808||lr===11809||lr===11810||lr===11811||lr===11812||lr===11813||lr===11814||lr===11815||lr===11816||lr===11817||lr>=11818&&lr<=11822||lr===11823||lr>=11824&&lr<=11833||lr>=11834&&lr<=11835||lr>=11836&&lr<=11839||lr===11840||lr===11841||lr===11842||lr>=11843&&lr<=11855||lr>=11856&&lr<=11857||lr===11858||lr>=11859&&lr<=11903||lr>=12289&&lr<=12291||lr===12296||lr===12297||lr===12298||lr===12299||lr===12300||lr===12301||lr===12302||lr===12303||lr===12304||lr===12305||lr>=12306&&lr<=12307||lr===12308||lr===12309||lr===12310||lr===12311||lr===12312||lr===12313||lr===12314||lr===12315||lr===12316||lr===12317||lr>=12318&&lr<=12319||lr===12320||lr===12336||lr===64830||lr===64831||lr>=65093&&lr<=65094}function pruneLocation(lr){lr.forEach(function(or){if(delete or.location,isSelectElement(or)||isPluralElement(or))for(var ar in or.options)delete or.options[ar].location,pruneLocation(or.options[ar].value);else isNumberElement(or)&&isNumberSkeleton(or.style)||(isDateElement(or)||isTimeElement(or))&&isDateTimeSkeleton(or.style)?delete or.style.location:isTagElement(or)&&pruneLocation(or.children)})}function parse$1(lr,or){or===void 0&&(or={}),or=__assign({shouldParseSkeletons:!0,requiresOtherClause:!0},or);var ar=new Parser$1(lr,or).parse();if(ar.err){var cr=SyntaxError(ErrorKind[ar.err.kind]);throw cr.location=ar.err.location,cr.originalMessage=ar.err.message,cr}return or!=null&&or.captureLocation||pruneLocation(ar.val),ar.val}function memoize(lr,or){var ar=or&&or.cache?or.cache:cacheDefault,cr=or&&or.serializer?or.serializer:serializerDefault,ur=or&&or.strategy?or.strategy:strategyDefault;return ur(lr,{cache:ar,serializer:cr})}function isPrimitive(lr){return lr==null||typeof lr=="number"||typeof lr=="boolean"}function monadic(lr,or,ar,cr){var ur=isPrimitive(cr)?cr:ar(cr),hr=or.get(ur);return typeof hr>"u"&&(hr=lr.call(this,cr),or.set(ur,hr)),hr}function variadic(lr,or,ar){var cr=Array.prototype.slice.call(arguments,3),ur=ar(cr),hr=or.get(ur);return typeof hr>"u"&&(hr=lr.apply(this,cr),or.set(ur,hr)),hr}function assemble(lr,or,ar,cr,ur){return ar.bind(or,lr,cr,ur)}function strategyDefault(lr,or){var ar=lr.length===1?monadic:variadic;return assemble(lr,this,ar,or.cache.create(),or.serializer)}function strategyVariadic(lr,or){return assemble(lr,this,variadic,or.cache.create(),or.serializer)}function strategyMonadic(lr,or){return assemble(lr,this,monadic,or.cache.create(),or.serializer)}var serializerDefault=function(){return JSON.stringify(arguments)};function ObjectWithoutPrototypeCache(){this.cache=Object.create(null)}ObjectWithoutPrototypeCache.prototype.get=function(lr){return this.cache[lr]};ObjectWithoutPrototypeCache.prototype.set=function(lr,or){this.cache[lr]=or};var cacheDefault={create:function(){return new ObjectWithoutPrototypeCache}},strategies={variadic:strategyVariadic,monadic:strategyMonadic},ErrorCode;(function(lr){lr.MISSING_VALUE="MISSING_VALUE",lr.INVALID_VALUE="INVALID_VALUE",lr.MISSING_INTL_API="MISSING_INTL_API"})(ErrorCode||(ErrorCode={}));var FormatError=function(lr){__extends(or,lr);function or(ar,cr,ur){var hr=lr.call(this,ar)||this;return hr.code=cr,hr.originalMessage=ur,hr}return or.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},or}(Error),InvalidValueError=function(lr){__extends(or,lr);function or(ar,cr,ur,hr){return lr.call(this,'Invalid values for "'.concat(ar,'": "').concat(cr,'". Options are "').concat(Object.keys(ur).join('", "'),'"'),ErrorCode.INVALID_VALUE,hr)||this}return or}(FormatError),InvalidValueTypeError=function(lr){__extends(or,lr);function or(ar,cr,ur){return lr.call(this,'Value for "'.concat(ar,'" must be of type ').concat(cr),ErrorCode.INVALID_VALUE,ur)||this}return or}(FormatError),MissingValueError=function(lr){__extends(or,lr);function or(ar,cr){return lr.call(this,'The intl string context variable "'.concat(ar,'" was not provided to the string "').concat(cr,'"'),ErrorCode.MISSING_VALUE,cr)||this}return or}(FormatError),PART_TYPE;(function(lr){lr[lr.literal=0]="literal",lr[lr.object=1]="object"})(PART_TYPE||(PART_TYPE={}));function mergeLiteral(lr){return lr.length<2?lr:lr.reduce(function(or,ar){var cr=or[or.length-1];return!cr||cr.type!==PART_TYPE.literal||ar.type!==PART_TYPE.literal?or.push(ar):cr.value+=ar.value,or},[])}function isFormatXMLElementFn(lr){return typeof lr=="function"}function formatToParts(lr,or,ar,cr,ur,hr,fr){if(lr.length===1&&isLiteralElement(lr[0]))return[{type:PART_TYPE.literal,value:lr[0].value}];for(var dr=[],pr=0,mr=lr;pr<mr.length;pr++){var gr=mr[pr];if(isLiteralElement(gr)){dr.push({type:PART_TYPE.literal,value:gr.value});continue}if(isPoundElement(gr)){typeof hr=="number"&&dr.push({type:PART_TYPE.literal,value:ar.getNumberFormat(or).format(hr)});continue}var yr=gr.value;if(!(ur&&yr in ur))throw new MissingValueError(yr,fr);var br=ur[yr];if(isArgumentElement(gr)){(!br||typeof br=="string"||typeof br=="number")&&(br=typeof br=="string"||typeof br=="number"?String(br):""),dr.push({type:typeof br=="string"?PART_TYPE.literal:PART_TYPE.object,value:br});continue}if(isDateElement(gr)){var Or=typeof gr.style=="string"?cr.date[gr.style]:isDateTimeSkeleton(gr.style)?gr.style.parsedOptions:void 0;dr.push({type:PART_TYPE.literal,value:ar.getDateTimeFormat(or,Or).format(br)});continue}if(isTimeElement(gr)){var Or=typeof gr.style=="string"?cr.time[gr.style]:isDateTimeSkeleton(gr.style)?gr.style.parsedOptions:cr.time.medium;dr.push({type:PART_TYPE.literal,value:ar.getDateTimeFormat(or,Or).format(br)});continue}if(isNumberElement(gr)){var Or=typeof gr.style=="string"?cr.number[gr.style]:isNumberSkeleton(gr.style)?gr.style.parsedOptions:void 0;Or&&Or.scale&&(br=br*(Or.scale||1)),dr.push({type:PART_TYPE.literal,value:ar.getNumberFormat(or,Or).format(br)});continue}if(isTagElement(gr)){var _r=gr.children,vr=gr.value,xr=ur[vr];if(!isFormatXMLElementFn(xr))throw new InvalidValueTypeError(vr,"function",fr);var wr=formatToParts(_r,or,ar,cr,ur,hr),kr=xr(wr.map(function(Nr){return Nr.value}));Array.isArray(kr)||(kr=[kr]),dr.push.apply(dr,kr.map(function(Nr){return{type:typeof Nr=="string"?PART_TYPE.literal:PART_TYPE.object,value:Nr}}))}if(isSelectElement(gr)){var Cr=gr.options[br]||gr.options.other;if(!Cr)throw new InvalidValueError(gr.value,br,Object.keys(gr.options),fr);dr.push.apply(dr,formatToParts(Cr.value,or,ar,cr,ur));continue}if(isPluralElement(gr)){var Cr=gr.options["=".concat(br)];if(!Cr){if(!Intl.PluralRules)throw new FormatError(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,ErrorCode.MISSING_INTL_API,fr);var $r=ar.getPluralRules(or,{type:gr.pluralType}).select(br-(gr.offset||0));Cr=gr.options[$r]||gr.options.other}if(!Cr)throw new InvalidValueError(gr.value,br,Object.keys(gr.options),fr);dr.push.apply(dr,formatToParts(Cr.value,or,ar,cr,ur,br-(gr.offset||0)));continue}}return mergeLiteral(dr)}function mergeConfig(lr,or){return or?__assign(__assign(__assign({},lr||{}),or||{}),Object.keys(lr).reduce(function(ar,cr){return ar[cr]=__assign(__assign({},lr[cr]),or[cr]||{}),ar},{})):lr}function mergeConfigs(lr,or){return or?Object.keys(lr).reduce(function(ar,cr){return ar[cr]=mergeConfig(lr[cr],or[cr]),ar},__assign({},lr)):lr}function createFastMemoizeCache(lr){return{create:function(){return{get:function(or){return lr[or]},set:function(or,ar){lr[or]=ar}}}}}function createDefaultFormatters(lr){return lr===void 0&&(lr={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:memoize(function(){for(var or,ar=[],cr=0;cr<arguments.length;cr++)ar[cr]=arguments[cr];return new((or=Intl.NumberFormat).bind.apply(or,__spreadArray([void 0],ar,!1)))},{cache:createFastMemoizeCache(lr.number),strategy:strategies.variadic}),getDateTimeFormat:memoize(function(){for(var or,ar=[],cr=0;cr<arguments.length;cr++)ar[cr]=arguments[cr];return new((or=Intl.DateTimeFormat).bind.apply(or,__spreadArray([void 0],ar,!1)))},{cache:createFastMemoizeCache(lr.dateTime),strategy:strategies.variadic}),getPluralRules:memoize(function(){for(var or,ar=[],cr=0;cr<arguments.length;cr++)ar[cr]=arguments[cr];return new((or=Intl.PluralRules).bind.apply(or,__spreadArray([void 0],ar,!1)))},{cache:createFastMemoizeCache(lr.pluralRules),strategy:strategies.variadic})}}var IntlMessageFormat=function(){function lr(or,ar,cr,ur){var hr=this;if(ar===void 0&&(ar=lr.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(fr){var dr=hr.formatToParts(fr);if(dr.length===1)return dr[0].value;var pr=dr.reduce(function(mr,gr){return!mr.length||gr.type!==PART_TYPE.literal||typeof mr[mr.length-1]!="string"?mr.push(gr.value):mr[mr.length-1]+=gr.value,mr},[]);return pr.length<=1?pr[0]||"":pr},this.formatToParts=function(fr){return formatToParts(hr.ast,hr.locales,hr.formatters,hr.formats,fr,void 0,hr.message)},this.resolvedOptions=function(){return{locale:hr.resolvedLocale.toString()}},this.getAst=function(){return hr.ast},this.locales=ar,this.resolvedLocale=lr.resolveLocale(ar),typeof or=="string"){if(this.message=or,!lr.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=lr.__parse(or,{ignoreTag:ur==null?void 0:ur.ignoreTag,locale:this.resolvedLocale})}else this.ast=or;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=mergeConfigs(lr.formats,cr),this.formatters=ur&&ur.formatters||createDefaultFormatters(this.formatterCache)}return Object.defineProperty(lr,"defaultLocale",{get:function(){return lr.memoizedDefaultLocale||(lr.memoizedDefaultLocale=new Intl.NumberFormat().resolvedOptions().locale),lr.memoizedDefaultLocale},enumerable:!1,configurable:!0}),lr.memoizedDefaultLocale=null,lr.resolveLocale=function(or){var ar=Intl.NumberFormat.supportedLocalesOf(or);return ar.length>0?new Intl.Locale(ar[0]):new Intl.Locale(typeof or=="string"?or:or[0])},lr.__parse=parse$1,lr.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},lr}();function delve(lr,or){if(or==null)return;if(or in lr)return lr[or];const ar=or.split(".");let cr=lr;for(let ur=0;ur<ar.length;ur++)if(typeof cr=="object"){if(ur>0){const hr=ar.slice(ur,ar.length).join(".");if(hr in cr){cr=cr[hr];break}}cr=cr[ar[ur]]}else cr=void 0;return cr}const lookupCache={},addToCache=(lr,or,ar)=>ar&&(or in lookupCache||(lookupCache[or]={}),lr in lookupCache[or]||(lookupCache[or][lr]=ar),ar),lookup=(lr,or)=>{if(or==null)return;if(or in lookupCache&&lr in lookupCache[or])return lookupCache[or][lr];const ar=getPossibleLocales(or);for(let cr=0;cr<ar.length;cr++){const ur=ar[cr],hr=getMessageFromDictionary(ur,lr);if(hr)return addToCache(lr,or,hr)}};let dictionary;const $dictionary=writable({});function getLocaleDictionary(lr){return dictionary[lr]||null}function hasLocaleDictionary(lr){return lr in dictionary}function getMessageFromDictionary(lr,or){if(!hasLocaleDictionary(lr))return null;const ar=getLocaleDictionary(lr);return delve(ar,or)}function getClosestAvailableLocale(lr){if(lr==null)return;const or=getPossibleLocales(lr);for(let ar=0;ar<or.length;ar++){const cr=or[ar];if(hasLocaleDictionary(cr))return cr}}function addMessages(lr,...or){delete lookupCache[lr],$dictionary.update(ar=>(ar[lr]=deepmerge$1.all([ar[lr]||{},...or]),ar))}derived([$dictionary],([lr])=>Object.keys(lr));$dictionary.subscribe(lr=>dictionary=lr);const queue$1={};function removeLoaderFromQueue(lr,or){queue$1[lr].delete(or),queue$1[lr].size===0&&delete queue$1[lr]}function getLocaleQueue(lr){return queue$1[lr]}function getLocalesQueues(lr){return getPossibleLocales(lr).map(or=>{const ar=getLocaleQueue(or);return[or,ar?[...ar]:[]]}).filter(([,or])=>or.length>0)}function hasLocaleQueue(lr){return lr==null?!1:getPossibleLocales(lr).some(or=>{var ar;return(ar=getLocaleQueue(or))==null?void 0:ar.size})}function loadLocaleQueue(lr,or){return Promise.all(or.map(cr=>(removeLoaderFromQueue(lr,cr),cr().then(ur=>ur.default||ur)))).then(cr=>addMessages(lr,...cr))}const activeFlushes={};function flush(lr){if(!hasLocaleQueue(lr))return lr in activeFlushes?activeFlushes[lr]:Promise.resolve();const or=getLocalesQueues(lr);return activeFlushes[lr]=Promise.all(or.map(([ar,cr])=>loadLocaleQueue(ar,cr))).then(()=>{if(hasLocaleQueue(lr))return flush(lr);delete activeFlushes[lr]}),activeFlushes[lr]}var __getOwnPropSymbols$2=Object.getOwnPropertySymbols,__hasOwnProp$2=Object.prototype.hasOwnProperty,__propIsEnum$2=Object.prototype.propertyIsEnumerable,__objRest$1=(lr,or)=>{var ar={};for(var cr in lr)__hasOwnProp$2.call(lr,cr)&&or.indexOf(cr)<0&&(ar[cr]=lr[cr]);if(lr!=null&&__getOwnPropSymbols$2)for(var cr of __getOwnPropSymbols$2(lr))or.indexOf(cr)<0&&__propIsEnum$2.call(lr,cr)&&(ar[cr]=lr[cr]);return ar};const defaultFormats$1={number:{scientific:{notation:"scientific"},engineering:{notation:"engineering"},compactLong:{notation:"compact",compactDisplay:"long"},compactShort:{notation:"compact",compactDisplay:"short"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}};function defaultMissingKeyHandler({locale:lr,id:or}){console.warn(`[svelte-i18n] The message "${or}" was not found in "${getPossibleLocales(lr).join('", "')}".${hasLocaleQueue(getCurrentLocale())?`

Note: there are at least one loader still registered to this locale that wasn't executed.`:""}`)}const defaultOptions={fallbackLocale:null,loadingDelay:200,formats:defaultFormats$1,warnOnMissingMessages:!0,handleMissingMessage:void 0,ignoreTag:!0},options$1=defaultOptions;function getOptions(){return options$1}function init(lr){const or=lr,{formats:ar}=or,cr=__objRest$1(or,["formats"]);let ur=lr.fallbackLocale;if(lr.initialLocale)try{IntlMessageFormat.resolveLocale(lr.initialLocale)&&(ur=lr.initialLocale)}catch{console.warn(`[svelte-i18n] The initial locale "${lr.initialLocale}" is not a valid locale.`)}return cr.warnOnMissingMessages&&(delete cr.warnOnMissingMessages,cr.handleMissingMessage==null?cr.handleMissingMessage=defaultMissingKeyHandler:console.warn('[svelte-i18n] The "warnOnMissingMessages" option is deprecated. Please use the "handleMissingMessage" option instead.')),Object.assign(options$1,cr,{initialLocale:ur}),ar&&("number"in ar&&Object.assign(options$1.formats.number,ar.number),"date"in ar&&Object.assign(options$1.formats.date,ar.date),"time"in ar&&Object.assign(options$1.formats.time,ar.time)),$locale.set(ur)}const $isLoading=writable(!1);var __defProp$1=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1=Object.getOwnPropertySymbols,__hasOwnProp$1=Object.prototype.hasOwnProperty,__propIsEnum$1=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(lr,or,ar)=>or in lr?__defProp$1(lr,or,{enumerable:!0,configurable:!0,writable:!0,value:ar}):lr[or]=ar,__spreadValues$1=(lr,or)=>{for(var ar in or||(or={}))__hasOwnProp$1.call(or,ar)&&__defNormalProp$1(lr,ar,or[ar]);if(__getOwnPropSymbols$1)for(var ar of __getOwnPropSymbols$1(or))__propIsEnum$1.call(or,ar)&&__defNormalProp$1(lr,ar,or[ar]);return lr},__spreadProps=(lr,or)=>__defProps(lr,__getOwnPropDescs(or));let current;const internalLocale=writable(null);function getSubLocales(lr){return lr.split("-").map((or,ar,cr)=>cr.slice(0,ar+1).join("-")).reverse()}function getPossibleLocales(lr,or=getOptions().fallbackLocale){const ar=getSubLocales(lr);return or?[...new Set([...ar,...getSubLocales(or)])]:ar}function getCurrentLocale(){return current??void 0}internalLocale.subscribe(lr=>{current=lr??void 0,typeof window<"u"&&lr!=null&&document.documentElement.setAttribute("lang",lr)});const set$1=lr=>{if(lr&&getClosestAvailableLocale(lr)&&hasLocaleQueue(lr)){const{loadingDelay:or}=getOptions();let ar;return typeof window<"u"&&getCurrentLocale()!=null&&or?ar=window.setTimeout(()=>$isLoading.set(!0),or):$isLoading.set(!0),flush(lr).then(()=>{internalLocale.set(lr)}).finally(()=>{clearTimeout(ar),$isLoading.set(!1)})}return internalLocale.set(lr)},$locale=__spreadProps(__spreadValues$1({},internalLocale),{set:set$1}),getLocaleFromNavigator=()=>typeof window>"u"?null:window.navigator.language||window.navigator.languages[0],monadicMemoize=lr=>{const or=Object.create(null);return cr=>{const ur=JSON.stringify(cr);return ur in or?or[ur]:or[ur]=lr(cr)}};var __defProp$2=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$2=(lr,or,ar)=>or in lr?__defProp$2(lr,or,{enumerable:!0,configurable:!0,writable:!0,value:ar}):lr[or]=ar,__spreadValues=(lr,or)=>{for(var ar in or||(or={}))__hasOwnProp.call(or,ar)&&__defNormalProp$2(lr,ar,or[ar]);if(__getOwnPropSymbols)for(var ar of __getOwnPropSymbols(or))__propIsEnum.call(or,ar)&&__defNormalProp$2(lr,ar,or[ar]);return lr},__objRest=(lr,or)=>{var ar={};for(var cr in lr)__hasOwnProp.call(lr,cr)&&or.indexOf(cr)<0&&(ar[cr]=lr[cr]);if(lr!=null&&__getOwnPropSymbols)for(var cr of __getOwnPropSymbols(lr))or.indexOf(cr)<0&&__propIsEnum.call(lr,cr)&&(ar[cr]=lr[cr]);return ar};const getIntlFormatterOptions=(lr,or)=>{const{formats:ar}=getOptions();if(lr in ar&&or in ar[lr])return ar[lr][or];throw new Error(`[svelte-i18n] Unknown "${or}" ${lr} format.`)},createNumberFormatter=monadicMemoize(lr=>{var or=lr,{locale:ar,format:cr}=or,ur=__objRest(or,["locale","format"]);if(ar==null)throw new Error('[svelte-i18n] A "locale" must be set to format numbers');return cr&&(ur=getIntlFormatterOptions("number",cr)),new Intl.NumberFormat(ar,ur)}),createDateFormatter=monadicMemoize(lr=>{var or=lr,{locale:ar,format:cr}=or,ur=__objRest(or,["locale","format"]);if(ar==null)throw new Error('[svelte-i18n] A "locale" must be set to format dates');return cr?ur=getIntlFormatterOptions("date",cr):Object.keys(ur).length===0&&(ur=getIntlFormatterOptions("date","short")),new Intl.DateTimeFormat(ar,ur)}),createTimeFormatter=monadicMemoize(lr=>{var or=lr,{locale:ar,format:cr}=or,ur=__objRest(or,["locale","format"]);if(ar==null)throw new Error('[svelte-i18n] A "locale" must be set to format time values');return cr?ur=getIntlFormatterOptions("time",cr):Object.keys(ur).length===0&&(ur=getIntlFormatterOptions("time","short")),new Intl.DateTimeFormat(ar,ur)}),getNumberFormatter=(lr={})=>{var or=lr,{locale:ar=getCurrentLocale()}=or,cr=__objRest(or,["locale"]);return createNumberFormatter(__spreadValues({locale:ar},cr))},getDateFormatter=(lr={})=>{var or=lr,{locale:ar=getCurrentLocale()}=or,cr=__objRest(or,["locale"]);return createDateFormatter(__spreadValues({locale:ar},cr))},getTimeFormatter=(lr={})=>{var or=lr,{locale:ar=getCurrentLocale()}=or,cr=__objRest(or,["locale"]);return createTimeFormatter(__spreadValues({locale:ar},cr))},getMessageFormatter=monadicMemoize((lr,or=getCurrentLocale())=>new IntlMessageFormat(lr,or,getOptions().formats,{ignoreTag:getOptions().ignoreTag})),formatMessage=(lr,or={})=>{var ar,cr,ur,hr;let fr=or;typeof lr=="object"&&(fr=lr,lr=fr.id);const{values:dr,locale:pr=getCurrentLocale(),default:mr}=fr;if(pr==null)throw new Error("[svelte-i18n] Cannot format a message without first setting the initial locale.");let gr=lookup(lr,pr);if(!gr)gr=(hr=(ur=(cr=(ar=getOptions()).handleMissingMessage)==null?void 0:cr.call(ar,{locale:pr,id:lr,defaultValue:mr}))!=null?ur:mr)!=null?hr:lr;else if(typeof gr!="string")return console.warn(`[svelte-i18n] Message with id "${lr}" must be of type "string", found: "${typeof gr}". Gettin its value through the "$format" method is deprecated; use the "json" method instead.`),gr;if(!dr)return gr;let yr=gr;try{yr=getMessageFormatter(gr,pr).format(dr)}catch(br){br instanceof Error&&console.warn(`[svelte-i18n] Message "${lr}" has syntax error:`,br.message)}return yr},formatTime=(lr,or)=>getTimeFormatter(or).format(lr),formatDate=(lr,or)=>getDateFormatter(or).format(lr),formatNumber=(lr,or)=>getNumberFormatter(or).format(lr),getJSON=(lr,or=getCurrentLocale())=>lookup(lr,or),$format=derived([$locale,$dictionary],()=>formatMessage);derived([$locale],()=>formatTime);derived([$locale],()=>formatDate);derived([$locale],()=>formatNumber);derived([$locale,$dictionary],()=>getJSON);function cubicOut(lr){const or=lr-1;return or*or*or+1}function fade(lr,{delay:or=0,duration:ar=400,easing:cr=identity}={}){const ur=+getComputedStyle(lr).opacity;return{delay:or,duration:ar,easing:cr,css:hr=>`opacity: ${hr*ur}`}}function fly(lr,{delay:or=0,duration:ar=400,easing:cr=cubicOut,x:ur=0,y:hr=0,opacity:fr=0}={}){const dr=getComputedStyle(lr),pr=+dr.opacity,mr=dr.transform==="none"?"":dr.transform,gr=pr*(1-fr),[yr,br]=split_css_unit(ur),[Or,_r]=split_css_unit(hr);return{delay:or,duration:ar,easing:cr,css:(vr,xr)=>`
			transform: ${mr} translate(${(1-vr)*yr}${br}, ${(1-vr)*Or}${_r});
			opacity: ${pr-gr*xr}`}}function flip(lr,{from:or,to:ar},cr={}){const ur=getComputedStyle(lr),hr=ur.transform==="none"?"":ur.transform,[fr,dr]=ur.transformOrigin.split(" ").map(parseFloat),pr=or.left+or.width*fr/ar.width-(ar.left+fr),mr=or.top+or.height*dr/ar.height-(ar.top+dr),{delay:gr=0,duration:yr=Or=>Math.sqrt(Or)*120,easing:br=cubicOut}=cr;return{delay:gr,duration:is_function(yr)?yr(Math.sqrt(pr*pr+mr*mr)):yr,easing:br,css:(Or,_r)=>{const vr=_r*pr,xr=_r*mr,wr=Or+_r*or.width/ar.width,kr=Or+_r*or.height/ar.height;return`transform: ${hr} translate(${vr}px, ${xr}px) scale(${wr}, ${kr});`}}}const defaults={duration:4e3,initial:1,next:0,pausable:!1,dismissable:!0,reversed:!1,intro:{x:256}};function createToast(){const{subscribe:lr,update:or}=writable(new Array),ar={};let cr=0;function ur(mr){return mr instanceof Object}function hr(mr="default",gr={}){return ar[mr]=gr,ar}function fr(mr,gr){const yr={target:"default",...ur(mr)?mr:{...gr,msg:mr}},br=ar[yr.target]||{},Or={...defaults,...br,...yr,theme:{...br.theme,...yr.theme},classes:[...br.classes||[],...yr.classes||[]],id:++cr};return or(_r=>Or.reversed?[..._r,Or]:[Or,..._r]),cr}function dr(mr){or(gr=>{if(!gr.length||mr===0)return[];if(typeof mr=="function")return gr.filter(br=>mr(br));if(ur(mr))return gr.filter(br=>br.target!==mr.target);const yr=mr||Math.max(...gr.map(br=>br.id));return gr.filter(br=>br.id!==yr)})}function pr(mr,gr){const yr=ur(mr)?mr:{...gr,id:mr};or(br=>{const Or=br.findIndex(_r=>_r.id===yr.id);return Or>-1&&(br[Or]={...br[Or],...yr}),br})}return{subscribe:lr,push:fr,pop:dr,set:pr,_init:hr}}const toast=createToast();function is_date(lr){return Object.prototype.toString.call(lr)==="[object Date]"}function get_interpolator(lr,or){if(lr===or||lr!==lr)return()=>lr;const ar=typeof lr;if(ar!==typeof or||Array.isArray(lr)!==Array.isArray(or))throw new Error("Cannot interpolate values of different type");if(Array.isArray(lr)){const cr=or.map((ur,hr)=>get_interpolator(lr[hr],ur));return ur=>cr.map(hr=>hr(ur))}if(ar==="object"){if(!lr||!or)throw new Error("Object cannot be null");if(is_date(lr)&&is_date(or)){lr=lr.getTime(),or=or.getTime();const hr=or-lr;return fr=>new Date(lr+fr*hr)}const cr=Object.keys(or),ur={};return cr.forEach(hr=>{ur[hr]=get_interpolator(lr[hr],or[hr])}),hr=>{const fr={};return cr.forEach(dr=>{fr[dr]=ur[dr](hr)}),fr}}if(ar==="number"){const cr=or-lr;return ur=>lr+ur*cr}throw new Error(`Cannot interpolate ${ar} values`)}function tweened(lr,or={}){const ar=writable(lr);let cr,ur=lr;function hr(fr,dr){if(lr==null)return ar.set(lr=fr),Promise.resolve();ur=fr;let pr=cr,mr=!1,{delay:gr=0,duration:yr=400,easing:br=identity,interpolate:Or=get_interpolator}=assign(assign({},or),dr);if(yr===0)return pr&&(pr.abort(),pr=null),ar.set(lr=ur),Promise.resolve();const _r=now()+gr;let vr;return cr=loop(xr=>{if(xr<_r)return!0;mr||(vr=Or(lr,fr),typeof yr=="function"&&(yr=yr(lr,fr)),mr=!0),pr&&(pr.abort(),pr=null);const wr=xr-_r;return wr>yr?(ar.set(lr=fr),!1):(ar.set(lr=vr(br(wr/yr))),!0)}),cr.promise}return{set:hr,update:(fr,dr)=>hr(fr(ur,lr),dr),subscribe:ar.subscribe}}const ToastItem_svelte_svelte_type_style_lang="";function create_else_block$3(lr){let or,ar=lr[0].msg+"",cr;return{c(){or=new HtmlTag(!1),cr=empty$1(),or.a=cr},m(ur,hr){or.m(ar,ur,hr),insert$1(ur,cr,hr)},p(ur,hr){hr&1&&ar!==(ar=ur[0].msg+"")&&or.p(ar)},i:noop$2,o:noop$2,d(ur){ur&&(detach(cr),or.d())}}}function create_if_block_1$7(lr){let or,ar,cr;const ur=[lr[2]];var hr=lr[0].component.src;function fr(dr,pr){let mr={};if(pr!==void 0&&pr&4)mr=get_spread_update(ur,[get_spread_object(dr[2])]);else for(let gr=0;gr<ur.length;gr+=1)mr=assign(mr,ur[gr]);return{props:mr}}return hr&&(or=construct_svelte_component(hr,fr(lr))),{c(){or&&create_component(or.$$.fragment),ar=empty$1()},m(dr,pr){or&&mount_component(or,dr,pr),insert$1(dr,ar,pr),cr=!0},p(dr,pr){if(pr&1&&hr!==(hr=dr[0].component.src)){if(or){group_outros();const mr=or;transition_out(mr.$$.fragment,1,0,()=>{destroy_component(mr,1)}),check_outros()}hr?(or=construct_svelte_component(hr,fr(dr,pr)),create_component(or.$$.fragment),transition_in(or.$$.fragment,1),mount_component(or,ar.parentNode,ar)):or=null}else if(hr){const mr=pr&4?get_spread_update(ur,[get_spread_object(dr[2])]):{};or.$set(mr)}},i(dr){cr||(or&&transition_in(or.$$.fragment,dr),cr=!0)},o(dr){or&&transition_out(or.$$.fragment,dr),cr=!1},d(dr){dr&&detach(ar),or&&destroy_component(or,dr)}}}function create_if_block$e(lr){let or,ar,cr;return{c(){or=element$1("div"),attr(or,"class","_toastBtn pe svelte-95rq8t"),attr(or,"role","button"),attr(or,"tabindex","0")},m(ur,hr){insert$1(ur,or,hr),ar||(cr=[listen(or,"click",lr[4]),listen(or,"keydown",lr[8])],ar=!0)},p:noop$2,d(ur){ur&&detach(or),ar=!1,run_all(cr)}}}function create_fragment$l(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr;const yr=[create_if_block_1$7,create_else_block$3],br=[];function Or(vr,xr){return vr[0].component?0:1}cr=Or(lr),ur=br[cr]=yr[cr](lr);let _r=lr[0].dismissable&&create_if_block$e(lr);return{c(){or=element$1("div"),ar=element$1("div"),ur.c(),hr=space$3(),_r&&_r.c(),fr=space$3(),dr=element$1("progress"),attr(ar,"class","_toastMsg svelte-95rq8t"),toggle_class(ar,"pe",lr[0].component),attr(dr,"class","_toastBar svelte-95rq8t"),dr.value=lr[1],attr(or,"role","status"),attr(or,"class","_toastItem svelte-95rq8t"),toggle_class(or,"pe",lr[0].pausable)},m(vr,xr){insert$1(vr,or,xr),append(or,ar),br[cr].m(ar,null),append(or,hr),_r&&_r.m(or,null),append(or,fr),append(or,dr),pr=!0,mr||(gr=[listen(or,"mouseenter",lr[9]),listen(or,"mouseleave",lr[6])],mr=!0)},p(vr,[xr]){let wr=cr;cr=Or(vr),cr===wr?br[cr].p(vr,xr):(group_outros(),transition_out(br[wr],1,1,()=>{br[wr]=null}),check_outros(),ur=br[cr],ur?ur.p(vr,xr):(ur=br[cr]=yr[cr](vr),ur.c()),transition_in(ur,1),ur.m(ar,null)),(!pr||xr&1)&&toggle_class(ar,"pe",vr[0].component),vr[0].dismissable?_r?_r.p(vr,xr):(_r=create_if_block$e(vr),_r.c(),_r.m(or,fr)):_r&&(_r.d(1),_r=null),(!pr||xr&2)&&(dr.value=vr[1]),(!pr||xr&1)&&toggle_class(or,"pe",vr[0].pausable)},i(vr){pr||(transition_in(ur),pr=!0)},o(vr){transition_out(ur),pr=!1},d(vr){vr&&detach(or),br[cr].d(),_r&&_r.d(),mr=!1,run_all(gr)}}}function check(lr,or="undefined"){return typeof lr===or}function instance$l(lr,or,ar){let cr,{item:ur}=or,hr=ur.initial,fr=hr,dr=!1,pr={},mr;const gr=tweened(ur.initial,{duration:ur.duration,easing:identity});component_subscribe(lr,gr,kr=>ar(1,cr=kr));function yr(){toast.pop(ur.id)}function br(){(cr===1||cr===0)&&yr()}function Or(){!dr&&cr!==hr&&(gr.set(cr,{duration:0}),dr=!0)}function _r(){if(dr){const kr=ur.duration,Cr=kr-kr*((cr-fr)/(hr-fr));gr.set(hr,{duration:Cr}).then(br),dr=!1}}function vr(kr=document){if(check(kr.hidden))return;const Cr=()=>kr.hidden?Or():_r(),$r="visibilitychange";kr.addEventListener($r,Cr),mr=()=>kr.removeEventListener($r,Cr),Cr()}onMount(vr),onDestroy(()=>{check(ur.onpop,"function")&&ur.onpop(ur.id),mr&&mr()});const xr=kr=>{kr instanceof KeyboardEvent&&["Enter"," "].includes(kr.key)&&yr()},wr=()=>{ur.pausable&&Or()};return lr.$$set=kr=>{"item"in kr&&ar(0,ur=kr.item)},lr.$$.update=()=>{if(lr.$$.dirty&1&&(check(ur.progress)||ar(0,ur.next=ur.progress,ur)),lr.$$.dirty&131&&hr!==ur.next&&(ar(7,hr=ur.next),fr=cr,dr=!1,gr.set(hr).then(br)),lr.$$.dirty&1&&ur.component){const{props:kr={},sendIdTo:Cr}=ur.component;ar(2,pr={...kr,...Cr&&{[Cr]:ur.id}})}},[ur,cr,pr,gr,yr,Or,_r,hr,xr,wr]}class ToastItem extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$l,create_fragment$l,safe_not_equal,{item:0})}}const SvelteToast_svelte_svelte_type_style_lang="";function get_each_context$6(lr,or,ar){const cr=lr.slice();return cr[4]=or[ar],cr}function create_each_block$6(lr,or){let ar,cr,ur,hr,fr,dr,pr,mr,gr=noop$2,yr;return cr=new ToastItem({props:{item:or[4]}}),{key:lr,first:null,c(){var br;ar=element$1("li"),create_component(cr.$$.fragment),ur=space$3(),attr(ar,"class",hr=null_to_empty((br=or[4].classes)==null?void 0:br.join(" "))+" svelte-1u812xz"),attr(ar,"style",fr=getCss(or[4].theme)),this.first=ar},m(br,Or){insert$1(br,ar,Or),mount_component(cr,ar,null),append(ar,ur),yr=!0},p(br,Or){var vr;or=br;const _r={};Or&1&&(_r.item=or[4]),cr.$set(_r),(!yr||Or&1&&hr!==(hr=null_to_empty((vr=or[4].classes)==null?void 0:vr.join(" "))+" svelte-1u812xz"))&&attr(ar,"class",hr),(!yr||Or&1&&fr!==(fr=getCss(or[4].theme)))&&attr(ar,"style",fr)},r(){mr=ar.getBoundingClientRect()},f(){fix_position(ar),gr(),add_transform(ar,mr)},a(){gr(),gr=create_animation(ar,mr,flip,{duration:200})},i(br){yr||(transition_in(cr.$$.fragment,br),br&&add_render_callback(()=>{yr&&(pr&&pr.end(1),dr=create_in_transition(ar,fly,or[4].intro),dr.start())}),yr=!0)},o(br){transition_out(cr.$$.fragment,br),dr&&dr.invalidate(),br&&(pr=create_out_transition(ar,fade,{})),yr=!1},d(br){br&&detach(ar),destroy_component(cr),br&&pr&&pr.end()}}}function create_fragment$k(lr){let or,ar=[],cr=new Map,ur,hr=ensure_array_like(lr[0]);const fr=dr=>dr[4].id;for(let dr=0;dr<hr.length;dr+=1){let pr=get_each_context$6(lr,hr,dr),mr=fr(pr);cr.set(mr,ar[dr]=create_each_block$6(mr,pr))}return{c(){or=element$1("ul");for(let dr=0;dr<ar.length;dr+=1)ar[dr].c();attr(or,"class","_toastContainer svelte-1u812xz")},m(dr,pr){insert$1(dr,or,pr);for(let mr=0;mr<ar.length;mr+=1)ar[mr]&&ar[mr].m(or,null);ur=!0},p(dr,[pr]){if(pr&1){hr=ensure_array_like(dr[0]),group_outros();for(let mr=0;mr<ar.length;mr+=1)ar[mr].r();ar=update_keyed_each(ar,pr,fr,1,dr,hr,cr,or,fix_and_outro_and_destroy_block,create_each_block$6,null,get_each_context$6);for(let mr=0;mr<ar.length;mr+=1)ar[mr].a();check_outros()}},i(dr){if(!ur){for(let pr=0;pr<hr.length;pr+=1)transition_in(ar[pr]);ur=!0}},o(dr){for(let pr=0;pr<ar.length;pr+=1)transition_out(ar[pr]);ur=!1},d(dr){dr&&detach(or);for(let pr=0;pr<ar.length;pr+=1)ar[pr].d()}}}function getCss(lr){return lr?Object.keys(lr).reduce((or,ar)=>`${or}${ar}:${lr[ar]};`,""):void 0}function instance$k(lr,or,ar){let cr;component_subscribe(lr,toast,dr=>ar(3,cr=dr));let{options:ur={}}=or,{target:hr="default"}=or,fr=[];return lr.$$set=dr=>{"options"in dr&&ar(1,ur=dr.options),"target"in dr&&ar(2,hr=dr.target)},lr.$$.update=()=>{lr.$$.dirty&6&&toast._init(hr,ur),lr.$$.dirty&12&&ar(0,fr=cr.filter(dr=>dr.target===hr))},[fr,ur,hr,cr]}class SvelteToast extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$k,create_fragment$k,safe_not_equal,{options:1,target:2})}}const token="%[a-f0-9]{2}",singleMatcher=new RegExp("("+token+")|([^%]+?)","gi"),multiMatcher=new RegExp("("+token+")+","gi");function decodeComponents(lr,or){try{return[decodeURIComponent(lr.join(""))]}catch{}if(lr.length===1)return lr;or=or||1;const ar=lr.slice(0,or),cr=lr.slice(or);return Array.prototype.concat.call([],decodeComponents(ar),decodeComponents(cr))}function decode$6(lr){try{return decodeURIComponent(lr)}catch{let or=lr.match(singleMatcher)||[];for(let ar=1;ar<or.length;ar++)lr=decodeComponents(or,ar).join(""),or=lr.match(singleMatcher)||[];return lr}}function customDecodeURIComponent(lr){const or={"%FE%FF":"��","%FF%FE":"��"};let ar=multiMatcher.exec(lr);for(;ar;){try{or[ar[0]]=decodeURIComponent(ar[0])}catch{const ur=decode$6(ar[0]);ur!==ar[0]&&(or[ar[0]]=ur)}ar=multiMatcher.exec(lr)}or["%C2"]="�";const cr=Object.keys(or);for(const ur of cr)lr=lr.replace(new RegExp(ur,"g"),or[ur]);return lr}function decodeUriComponent(lr){if(typeof lr!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof lr+"`");try{return decodeURIComponent(lr)}catch{return customDecodeURIComponent(lr)}}function splitOnFirst(lr,or){if(!(typeof lr=="string"&&typeof or=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(lr===""||or==="")return[];const ar=lr.indexOf(or);return ar===-1?[]:[lr.slice(0,ar),lr.slice(ar+or.length)]}function includeKeys(lr,or){const ar={};if(Array.isArray(or))for(const cr of or){const ur=Object.getOwnPropertyDescriptor(lr,cr);ur!=null&&ur.enumerable&&Object.defineProperty(ar,cr,ur)}else for(const cr of Reflect.ownKeys(lr)){const ur=Object.getOwnPropertyDescriptor(lr,cr);if(ur.enumerable){const hr=lr[cr];or(cr,hr,lr)&&Object.defineProperty(ar,cr,ur)}}return ar}const isNullOrUndefined=lr=>lr==null,strictUriEncode=lr=>encodeURIComponent(lr).replace(/[!'()*]/g,or=>`%${or.charCodeAt(0).toString(16).toUpperCase()}`),encodeFragmentIdentifier=Symbol("encodeFragmentIdentifier");function encoderForArrayFormat(lr){switch(lr.arrayFormat){case"index":return or=>(ar,cr)=>{const ur=ar.length;return cr===void 0||lr.skipNull&&cr===null||lr.skipEmptyString&&cr===""?ar:cr===null?[...ar,[encode$7(or,lr),"[",ur,"]"].join("")]:[...ar,[encode$7(or,lr),"[",encode$7(ur,lr),"]=",encode$7(cr,lr)].join("")]};case"bracket":return or=>(ar,cr)=>cr===void 0||lr.skipNull&&cr===null||lr.skipEmptyString&&cr===""?ar:cr===null?[...ar,[encode$7(or,lr),"[]"].join("")]:[...ar,[encode$7(or,lr),"[]=",encode$7(cr,lr)].join("")];case"colon-list-separator":return or=>(ar,cr)=>cr===void 0||lr.skipNull&&cr===null||lr.skipEmptyString&&cr===""?ar:cr===null?[...ar,[encode$7(or,lr),":list="].join("")]:[...ar,[encode$7(or,lr),":list=",encode$7(cr,lr)].join("")];case"comma":case"separator":case"bracket-separator":{const or=lr.arrayFormat==="bracket-separator"?"[]=":"=";return ar=>(cr,ur)=>ur===void 0||lr.skipNull&&ur===null||lr.skipEmptyString&&ur===""?cr:(ur=ur===null?"":ur,cr.length===0?[[encode$7(ar,lr),or,encode$7(ur,lr)].join("")]:[[cr,encode$7(ur,lr)].join(lr.arrayFormatSeparator)])}default:return or=>(ar,cr)=>cr===void 0||lr.skipNull&&cr===null||lr.skipEmptyString&&cr===""?ar:cr===null?[...ar,encode$7(or,lr)]:[...ar,[encode$7(or,lr),"=",encode$7(cr,lr)].join("")]}}function parserForArrayFormat(lr){let or;switch(lr.arrayFormat){case"index":return(ar,cr,ur)=>{if(or=/\[(\d*)]$/.exec(ar),ar=ar.replace(/\[\d*]$/,""),!or){ur[ar]=cr;return}ur[ar]===void 0&&(ur[ar]={}),ur[ar][or[1]]=cr};case"bracket":return(ar,cr,ur)=>{if(or=/(\[])$/.exec(ar),ar=ar.replace(/\[]$/,""),!or){ur[ar]=cr;return}if(ur[ar]===void 0){ur[ar]=[cr];return}ur[ar]=[...ur[ar],cr]};case"colon-list-separator":return(ar,cr,ur)=>{if(or=/(:list)$/.exec(ar),ar=ar.replace(/:list$/,""),!or){ur[ar]=cr;return}if(ur[ar]===void 0){ur[ar]=[cr];return}ur[ar]=[...ur[ar],cr]};case"comma":case"separator":return(ar,cr,ur)=>{const hr=typeof cr=="string"&&cr.includes(lr.arrayFormatSeparator),fr=typeof cr=="string"&&!hr&&decode$5(cr,lr).includes(lr.arrayFormatSeparator);cr=fr?decode$5(cr,lr):cr;const dr=hr||fr?cr.split(lr.arrayFormatSeparator).map(pr=>decode$5(pr,lr)):cr===null?cr:decode$5(cr,lr);ur[ar]=dr};case"bracket-separator":return(ar,cr,ur)=>{const hr=/(\[])$/.test(ar);if(ar=ar.replace(/\[]$/,""),!hr){ur[ar]=cr&&decode$5(cr,lr);return}const fr=cr===null?[]:cr.split(lr.arrayFormatSeparator).map(dr=>decode$5(dr,lr));if(ur[ar]===void 0){ur[ar]=fr;return}ur[ar]=[...ur[ar],...fr]};default:return(ar,cr,ur)=>{if(ur[ar]===void 0){ur[ar]=cr;return}ur[ar]=[...[ur[ar]].flat(),cr]}}}function validateArrayFormatSeparator(lr){if(typeof lr!="string"||lr.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function encode$7(lr,or){return or.encode?or.strict?strictUriEncode(lr):encodeURIComponent(lr):lr}function decode$5(lr,or){return or.decode?decodeUriComponent(lr):lr}function keysSorter(lr){return Array.isArray(lr)?lr.sort():typeof lr=="object"?keysSorter(Object.keys(lr)).sort((or,ar)=>Number(or)-Number(ar)).map(or=>lr[or]):lr}function removeHash(lr){const or=lr.indexOf("#");return or!==-1&&(lr=lr.slice(0,or)),lr}function getHash(lr){let or="";const ar=lr.indexOf("#");return ar!==-1&&(or=lr.slice(ar)),or}function parseValue(lr,or){return or.parseNumbers&&!Number.isNaN(Number(lr))&&typeof lr=="string"&&lr.trim()!==""?lr=Number(lr):or.parseBooleans&&lr!==null&&(lr.toLowerCase()==="true"||lr.toLowerCase()==="false")&&(lr=lr.toLowerCase()==="true"),lr}function extract(lr){lr=removeHash(lr);const or=lr.indexOf("?");return or===-1?"":lr.slice(or+1)}function parse(lr,or){or={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...or},validateArrayFormatSeparator(or.arrayFormatSeparator);const ar=parserForArrayFormat(or),cr=Object.create(null);if(typeof lr!="string"||(lr=lr.trim().replace(/^[?#&]/,""),!lr))return cr;for(const ur of lr.split("&")){if(ur==="")continue;const hr=or.decode?ur.replace(/\+/g," "):ur;let[fr,dr]=splitOnFirst(hr,"=");fr===void 0&&(fr=hr),dr=dr===void 0?null:["comma","separator","bracket-separator"].includes(or.arrayFormat)?dr:decode$5(dr,or),ar(decode$5(fr,or),dr,cr)}for(const[ur,hr]of Object.entries(cr))if(typeof hr=="object"&&hr!==null)for(const[fr,dr]of Object.entries(hr))hr[fr]=parseValue(dr,or);else cr[ur]=parseValue(hr,or);return or.sort===!1?cr:(or.sort===!0?Object.keys(cr).sort():Object.keys(cr).sort(or.sort)).reduce((ur,hr)=>{const fr=cr[hr];return fr&&typeof fr=="object"&&!Array.isArray(fr)?ur[hr]=keysSorter(fr):ur[hr]=fr,ur},Object.create(null))}function stringify$1(lr,or){if(!lr)return"";or={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...or},validateArrayFormatSeparator(or.arrayFormatSeparator);const ar=fr=>or.skipNull&&isNullOrUndefined(lr[fr])||or.skipEmptyString&&lr[fr]==="",cr=encoderForArrayFormat(or),ur={};for(const[fr,dr]of Object.entries(lr))ar(fr)||(ur[fr]=dr);const hr=Object.keys(ur);return or.sort!==!1&&hr.sort(or.sort),hr.map(fr=>{const dr=lr[fr];return dr===void 0?"":dr===null?encode$7(fr,or):Array.isArray(dr)?dr.length===0&&or.arrayFormat==="bracket-separator"?encode$7(fr,or)+"[]":dr.reduce(cr(fr),[]).join("&"):encode$7(fr,or)+"="+encode$7(dr,or)}).filter(fr=>fr.length>0).join("&")}function parseUrl(lr,or){var ur;or={decode:!0,...or};let[ar,cr]=splitOnFirst(lr,"#");return ar===void 0&&(ar=lr),{url:((ur=ar==null?void 0:ar.split("?"))==null?void 0:ur[0])??"",query:parse(extract(lr),or),...or&&or.parseFragmentIdentifier&&cr?{fragmentIdentifier:decode$5(cr,or)}:{}}}function stringifyUrl(lr,or){or={encode:!0,strict:!0,[encodeFragmentIdentifier]:!0,...or};const ar=removeHash(lr.url).split("?")[0]||"",cr=extract(lr.url),ur={...parse(cr,{sort:!1}),...lr.query};let hr=stringify$1(ur,or);hr&&(hr=`?${hr}`);let fr=getHash(lr.url);if(lr.fragmentIdentifier){const dr=new URL(ar);dr.hash=lr.fragmentIdentifier,fr=or[encodeFragmentIdentifier]?dr.hash:`#${lr.fragmentIdentifier}`}return`${ar}${hr}${fr}`}function pick(lr,or,ar){ar={parseFragmentIdentifier:!0,[encodeFragmentIdentifier]:!1,...ar};const{url:cr,query:ur,fragmentIdentifier:hr}=parseUrl(lr,ar);return stringifyUrl({url:cr,query:includeKeys(ur,or),fragmentIdentifier:hr},ar)}function exclude(lr,or,ar){const cr=Array.isArray(or)?ur=>!or.includes(ur):(ur,hr)=>!or(ur,hr);return pick(lr,cr,ar)}const queryString=Object.freeze(Object.defineProperty({__proto__:null,exclude,extract,parse,parseUrl,pick,stringify:stringify$1,stringifyUrl},Symbol.toStringTag,{value:"Module"})),fixed="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTEyLTI2VDE4OjMzOjU1KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMy0wMS0xOFQwODo0NTo0MyswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMy0wMS0xOFQwODo0NTo0MyswMTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2YjE2OTIzNi1mODkyLWY4NGEtODg2Zi03Y2Y1YjNhZjhkZWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NmIxNjkyMzYtZjg5Mi1mODRhLTg4NmYtN2NmNWIzYWY4ZGVmIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NmIxNjkyMzYtZjg5Mi1mODRhLTg4NmYtN2NmNWIzYWY4ZGVmIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo2YjE2OTIzNi1mODkyLWY4NGEtODg2Zi03Y2Y1YjNhZjhkZWYiIHN0RXZ0OndoZW49IjIwMjItMTItMjZUMTg6MzM6NTUrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4wIChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4zy2/AAAAEqUlEQVQ4jU2UT28bVRfGf+fOnfHEdhzbWCVRKKbEUAQlCCH0viq8ogsWiAUCVggisWKN+Ab9CHwFpIoF7ECITZFAgsIC8UcpahuES0nLmzSq7SYee2Y8cw+LGdtc6c7VSM99zjnP88zIxYsXWSxVjHNy3Gpp7+rV+huXLr1yKk13Mmv/55xrAxhjBibLvv07CC59vrPzZf/cuXFjOBRnjCKyoPIuvPQSqJKLmFxEVyYTnvr55/XnfvjhzVPD4Xu+6rOec01PNfdUnXEuBB7wVHtrw6Hzk+T/x43GSVypFHWdU0SwiIBzklQqBHFM948/Wi98/fWbD41GHwC9xNpkGoZXZpXK7wBBkjwWxvF/6ln24rmbN9ebw2HgRD7+7ZlnhkkYUo0iUVW1qoqKGDUmb4zH/tbe3n9b4/FbKtLLjTnonznz2V+nT3+RhOENAcI4Pru5v/9qr99/zXeu1xqP39ra2+vf6XYvH62vz5wxnhHJLaoiIlKNItqHh832YHB+JcueVkjutttffn/+/Ic3H320X4uiHCCq1f480+//vjYa2Y2jo3fCLHu6fe/eCxv9/o/TSuUoq1YLr7w8xzinNstMfTpttSaT0wKN49XVG79ub39yq9u9dtxsJvebzfx+s5kfN5vJX93utd3t7U+P6/UbBhrt8fjh1mjUDuPYqIiqKnbm+5JbS3M4dKeOjlw1jusCkgbBrWh19drqyQkrcWxsmnoAa0GQ+7OZi1ZXr8+C4JbAdjVJamtR5KxzLrNW/DwXm4ShcZ6n6wcH9Pb22l6abgBSjyL75PXrT6xGkUkqlUoQxxWANAyTSpIkp/f3z9YmEx8QyfONjYODduv+fQ43NwURtUGa5pXJRLv9/rPrd+++7ak+PhMhiOOzW/3++5t37tzLjbGohgCIxJ5zWZgkHTubPT4TwXPusc3Dw3ce6ffTvx988Je0VlPrZ5lWx2OvcXz8vO/c6wodJ+IC1YdsmnYraZqVmffLc1aeViHPjHG+asdm2Wtro9HuShTtzqrVzDpjcJ7n59Y+oNBxoAZyBTIQRPzCjmIJWBURVDFAiRWFTu77bfU8X0Uyu/iYRVIgBmoAWpCAqqq1aL1eIMdjJMuUgoxlPWKFVMrP2gogIiqqmUAmMO9ODagD5cIF9N13C4aPPlIuX8YUxdWBCKhAJqq5qqoAFkBURcADPC3GFykuGK3VVF9+mcrOjgeQ3r6dc+UKMpkIJVaLjj0ptlBIVLRMMUPxMEbmAJpNJAiWM/s+NJvz+aXEMi8yl8KUeqoWsiqAOMdcZwYD2N1dEOvVqzAYsDCzxLLkKDSeKy+lslL6pXP/plOYTpcdT6cicUxpns41LSVlHqB5x+jyJ63OGClToWqtaq+36ES3tlQ9T+cmO2NkPpyKoKUWZo7/1wZZJkk6HQjDpRQrK9DpLN+X2H+lbymFEQiAQEHEOaFMiIljcV99RToYqADmp58wcTxn8cQ5tDA9KLcsiBWcwhgYKzRQzQUyIJDRCPPNN8p33xVaZZmWhRFIRdVqMfkYOKG4tyBOFfaB2wIbiOQCJwJVBcQ5lTTVEruIpcIEkYYUPHcc7DtIAf4BE0xwSbkoFUkAAAAASUVORK5CYII=",noexport="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVQ4ja3UvaqDMBgG4FdxcBAc7eAq6O4VHXoTbToavZHSOyhnzVDr4i4iPZNDD3QVHMR0qsR/Lb4gEvR7/BI1EuccW0XeTAKgiAMa0EVtkuNJagbizDjnzeH5Hp/L7X7jnu9xDoB36r+aJjmeJOp7vVmsxhhj+EBdUBkqyLIMlmUNYvufPQzDQBiFYIyNdybLMpIkwfX3ChrQHkQDivPljDzPBx/Uwuq6huM4KIqiKRYhACjLEqZpzmOfkANpISIqXluEjRVNQZPYNxnFxl7Aaqy7Rt01XIQpioI4jqGqagOJKADouo40TQex1kdbVRVc14WmabBtu3czORA8/5/YGTu8otc0BgBhFLbOQ3n8PeY7A9D7RdZE2nKnfQNqmKSitctnJwAAAABJRU5ErkJggg==",final="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wENEA4tJ8wnvAAAArNJREFUOMvVlM1rVFcYxn/n3pu5MTMTM0nGdFI1IfGD+lEioSWrdllUEIrgUhBcdBORIOgfIIgiXVQoolvdFLtIiSKClW7b9MMYP5oMRieZyTidzGQy986dO3fufV1Mp02joNaNvpvznsP7/Hg4nOfAu16q2dR+bZ/Or0ihaJFOdLm7It2HToW2Xbn+MlEwd3C/Vfj+7GJev9cZ4cPu9cTULn/3f4D1TPTJwqJ/rH+48kP5pvHtut3DX0jPB39KzdIpAFkgA1ghX7Vmt1fV1Hj0S38sdZcDGxN8o22gH8BoAt0Odb8voQYAzEgs58n8gJS3DmDdghUHHBAPcMHXQe8by8DXbPqYAcdhusn5B+hY9V/a1pkjYBOYUm1tN8DoBdeAENAGRAEBPwzPskn3b+lIxWayydGaTfGJPxGUtCEn2ac8384RuCA+YEIA+DTWALy6wbPZH3OlqW4Nu2VPKcXEC8Ctn7qTxRlnvsUJHQkk8gDfAiVAGKThDL9x6xVHUTc7HkXN1iOlpJcaHH6JQ4C5n2un/VzpuLK73KBWzYMNKv4vzGsoimUjvT7a7qnS8vHUJKdXM/TVm8s3gqeHdla3xPXIPom5WT3WsZ16G9hJqABlcEWRKcRvDHbVPkvN5u9+9BWXVjO0tW/s4YycmJtJe9osn+DNgB5ujHkggWK+GKYn5I0U05lg9hEn1ur1tQfXfhc+H5QJVQl2xDfZQ6o7DpVlsB3SS2HKVgjNLYxPP5ajey/gv1GMfjpnjNYXEhVZ6hX3jilTFzort8+0jL5VNmu/qZNBVpPCRU3mL6nRtw67pIjJHEvVm6TzfxB+1bzxSqJJCIVhbsYwewkB9v9394B++YtrUkYkg8gyVyXJ5tf6vl6A3dl4mI6F84T1dqpYFIEcEXx/mbbEMXVg8Tvey3oOImsv73TtdGkAAAAASUVORK5CYII=",death="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAC4jAAAuIwF4pT92AAAEgElEQVR4nH2Ua0xbZRjHS7lEkw6kAzcGjkmE4UKcCWxTMz9tGnDzi26SOMMI2cYAuRU4lF7OpTdKS1kLE1qG2zRsTpCFNZT7daW0XAuswGQf5OJHY9Qvgpy+j29LuwBznuSf8573vM/v/J/nec/LoWmas1cMTQf5x023Gk+bTA1ZjSZjlslkPO+fF4slXIZhuHtjX4CRJBnouRuN9e92Wsx3HfbRXx12G3I4bGAfs/5uHRns/qnlwWc7YgJeCsQw78sO88NMq3Xoj8kJO0xPTcLcnBPNzznB6ZwCx/gYjNut0N1lvqdSKcP3Qp/DKGobZm5vFQwP9KBR6xCamhzfXHA9cS8v/wzPni3D4uICcs5MbdlGR9iRoT7oMLcNKpWKMIlUuhtIUZR34pubhve7Le0w0Nftxum5Z53T8PTpElpdW0Pr6+seKJqbm4UJhw0ND/Zt9nSZoa31fp0nVkqS3J0OvQ8/3Lt7s7+nAw30d3lcwMz0BMJAWFlZgdXVNfA4dTqn0ZjNCkMDPWxnR7u741HrukGvO+BP3e/Q2whtlby3vq4aDeLFE+NjyDU/C64n87C0tORxCgsLLlhadMHszCSMjQ677zffBkZKbFSqFKd8HK4XSPrsCgpzBssFOWB51MJ+21gPt5uMMNjfBbOzMzCP4X29nVBVKQOaEkOTqQ41GfVbedcuA0WKz/uNbQN9DjGwv6w4Fz5J/YgNfy0MIiL4QJQKYGrSAZ6Oq1Ry2M/nQ3BwEMTERANRUrAhJvKRRCz80gskySB/yl6HlLj0ccZX6XDoUDQbzg8HPn8/XLzwOdgeD8H0pB2uZV+FNw4fhqioKIiMfB2lp19kVbIKEAnL0nzGuL6mbG9mBVPxo6i8CJKTU7YSExMhIeEo5H+dC9oqhSctqFTKIDklBZKSkuCd48fdImEp6FTS38Si8rd8Dp83xetQyYhK6murWEpazmZlZkBJUT76/o4Jg+MhJCQETA0G0OvUICQEqFJBuW+ZDKxey/wiY8gjXmN4+/mA29tGp6YtBp0ccLH/lpOEW0aWAUNWoNjYWIiOjob8vGxUX6tBhCAXGuq0WzdvqDZvaGlQyKhzXg7tawpNb29stZJOMdapl+tq5CAszQMlXY4qCAGkpJzwlAEK83OgVqeE4vwrSEETgNeCXku3yGXUK/TOP2WnEuLjIk5/cPJjjVLs0qlJVK2mWEmFAEmEAqjRMKiminbXVFGorCjbcDQ+7sPr2VeDd8bvgoWGhgZxOJwwzzjj0gWLXkOzarnoH0M1g2qrZUijFLEyaQlbrZL+dSQ25oQXwOEEvRSILx4u/smAgIDUc2lnH9RoaKAlJcBISlklU8HKcF3xB6Ag74prH4/3KZfLPYVjIvh8/ounjR8YGBiYhO9nQkP3fZF5+VLzd3dMf/b3WqCtpRks5ocb5URx78GDB67jNWexkvHHI3g83n8DsTsuXvQqViTWm1ixx94+9h5BEEVFhQXi1NS0M3guzvcuCsN4/5vyTuF0uDggBAfsOuY9c1ieWu86qf36FzbTCQMGhUSbAAAAAElFTkSuQmCC",genericFlag=""+new URL("generic-c4d9cb0c.png",import.meta.url).href,flagsURLs={fixed,noexport,final,death},trimmedFlag=lr=>lr.substring(0,lr.indexOf(":")!==-1?lr.indexOf(":"):1/0),flagURL=(lr,or)=>(lr=trimmedFlag(lr),flagsURLs[lr]??or.index.properties["flag-"+lr]??genericFlag),urlOfChapterKey=lr=>location.href+"&c="+encodeURIComponent(lr),getLast=lr=>lr===null?null:Array.isArray(lr)&&lr.length>0?lr[lr.length-1]:lr,urlParams=(()=>{let lr=queryString.parse(location.hash);const{set:or,subscribe:ar}=writable(lr);return window.addEventListener("hashchange",()=>{lr=queryString.parse(location.hash),or(lr)}),{get:ur=>getLast(lr[ur]),get value(){return lr},set(ur){location.hash="#"+queryString.stringify(ur)},update(ur){const hr=ur(queryString.parse(location.hash));location.hash="#"+queryString.stringify(hr)},subscribe:ar,change:ur=>ar(hr=>{lr!==hr&&ur(hr)})}})(),urlParam=lr=>{let or=getLast(queryString.parse(location.hash)[lr]);const{set:ar,subscribe:cr}=writable(or);urlParams.subscribe(dr=>{const pr=getLast(dr[lr]);pr!==or&&ar(pr)});const ur=dr=>{or!==dr&&(or=dr,urlParams.update(pr=>(pr[lr]=dr,pr)))};return{get:()=>or,get value(){return or},set:ur,update:dr=>{const pr=dr(or);return ur(pr),pr},subscribe:cr,change:dr=>cr(pr=>{or!==pr&&dr(pr)})}},storable=(lr,or)=>{const ar={},cr=[];for(const[ur,hr]of Object.entries({...or,...JSON.parse(localStorage["mageai-settings"]||"{}")})){const fr=writable(hr);ar[ur]=fr,cr.push(derived([fr],([dr])=>[ur,dr]))}return derived(cr,ur=>{const hr={};for(const[fr,dr]of ur)hr[fr]=dr;return JSON.stringify(hr)}).subscribe(ur=>localStorage[lr]=ur),ar},mergeable=()=>{const lr=[],{subscribe:or,set:ar}=writable({}),cr=()=>{const hr={};for(const fr of lr)Object.assign(hr,get_store_value(fr));ar(hr)};return{subscribe:or,extend:(hr={})=>{const fr=writable(hr);return lr.push(fr),cr(),fr.subscribe(()=>cr()),fr}}},arrayable=()=>{const lr=[],{subscribe:or,set:ar}=writable([]),cr=()=>{let hr=[];for(const fr of lr){const dr=get_store_value(fr);Array.isArray(dr)?hr=[...hr,...dr]:hr=[...hr,dr]}ar(hr)};return{subscribe:or,extend:(hr=[])=>{const fr=writable(hr);return lr.push(fr),cr(),fr.subscribe(()=>cr()),fr}}},debouncable=(lr,or)=>{let ar,cr=or;const{subscribe:ur,set:hr}=writable(or),fr=()=>(clearTimeout(ar),hr(cr),cr);return{subscribe:ur,flush:fr,get:fr,set:dr=>{cr=dr,fr()},lazySet:dr=>{cr=dr,clearTimeout(ar),ar=setTimeout(()=>{hr(cr)},lr)}}};function create_fragment$j(lr){let or,ar,cr,ur,hr,fr,dr;return{c(){or=element$1("tr"),ar=element$1("th"),ar.textContent="templateplugin-settingExample:",cr=space$3(),ur=element$1("td"),hr=element$1("input"),attr(hr,"type","text"),attr(hr,"class","flex-grow")},m(pr,mr){insert$1(pr,or,mr),append(or,ar),append(or,cr),append(or,ur),append(ur,hr),set_input_value(hr,lr[0]),fr||(dr=listen(hr,"input",lr[3]),fr=!0)},p(pr,[mr]){mr&1&&hr.value!==pr[0]&&set_input_value(hr,pr[0])},i:noop$2,o:noop$2,d(pr){pr&&detach(or),fr=!1,dr()}}}const key$2="extensions-plugin-settings",{settingExample}=storable(key$2,{settingExample:"change me in the settings"});function instance$j(lr,or,ar){let cr,ur,hr=noop$2;component_subscribe(lr,settingExample,pr=>ar(2,ur=pr)),lr.$$.on_destroy.push(()=>hr());let{callback:fr=(pr=!1)=>{pr&&cr!=ur&&set_store_value(settingExample,ur=cr,ur)}}=or;function dr(){cr=this.value,ar(0,cr),ar(2,ur)}return lr.$$set=pr=>{"callback"in pr&&ar(1,fr=pr.callback)},lr.$$.update=()=>{lr.$$.dirty&4&&ar(0,cr=ur)},[cr,fr,ur,dr]}let Settings$2=class extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$j,create_fragment$j,safe_not_equal,{callback:1})}};const randomString=(lr,or="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")=>{let ar="";const cr=or.length;for(let ur=0;ur<lr;ur++)ar+=or.charAt(Math.floor(Math.random()*cr));return ar},shuffleArray=lr=>{for(let or=lr.length-1;or>0;or--){let ar=Math.floor(Math.random()*(or+1));[lr[or],lr[ar]]=[lr[ar],lr[or]]}},isNatNumber=lr=>(lr>0||String(lr)==="0")&&Math.floor(lr)===+lr,wait=lr=>new Promise(or=>setTimeout(or,lr)),asAny=lr=>lr,defaultBookProperties=mergeable(),pluginPanel=arrayable(),settingsDialog=arrayable(),bookFormats=mergeable(),sanitizeKey=lr=>lr.replace(/[^a-z0-9]/gi,""),atLinePosition=(lr,or,ar=!0)=>{},indexBook=(lr,or=null)=>{const ar=lr.split(`
`),cr={title:"",lines:{titlePageEnd:-1,end:ar.length-1},lineStarts:[0],properties:{...or??get_store_value(defaultBookProperties)},chapters:[],keys:{},chaptersWith:{key:{},group:{},flag:{}}};let ur=null,hr,fr=!1,dr=0,pr=0;ar.forEach((mr,gr)=>{pr+=mr.length+1,cr.lineStarts.push(pr);const yr=mr.trim();if(fr&&(dr=gr),fr=yr!=="",ur===null&&!yr.startsWith("### ")){if(yr.startsWith("# ")){cr.title=yr.replaceAll("#","").trim();return}const wr=yr.indexOf(":");wr!==-1&&(cr.properties[yr.substring(0,wr).trim()]=yr.substring(wr+1).trim());return}if(yr.startsWith("### ")){ur===null&&(cr.lines.titlePageEnd=gr-1),ur!==null&&(hr.lines.textEnd=dr-1,hr.lines.end=gr-1,hr.group&&(cr.chaptersWith.group[hr.group]||(cr.chaptersWith.group[hr.group]=[]),cr.chaptersWith.group[hr.group].push(cr.chapters.length)),cr.chapters.push(hr)),ur=yr.substring(4).trim();let wr="";const kr=ur.indexOf("{#");kr!=-1&&(wr=ur.substring(0,kr-1).trim(),ur=ur.substring(kr+2,ur.lastIndexOf("}")).trim()),hr={key:ur,title:wr,group:"",flags:[],lines:{start:dr,textStart:gr,textEnd:gr,end:gr},links:[],linkedFrom:[]},cr.chaptersWith.key[ur]||(cr.chaptersWith.key[ur]=[]),cr.chaptersWith.key[ur].push(cr.chapters.length);return}let br=["![flag-","![][flag-"];if(br.some(wr=>yr.includes(wr))){for(const wr of br){let kr=0;for(;(kr=yr.indexOf(wr,kr))!=-1;){kr+=wr.length;const Cr=yr.indexOf("]",kr);if(Cr==-1)break;const $r=yr.substring(kr,Cr).trim();hr.flags.includes($r)||(hr.flags.push($r),cr.chaptersWith.flag[$r]==null&&(cr.chaptersWith.flag[$r]=[]),cr.chaptersWith.flag[$r].push(cr.chapters.length))}}return}const Or=yr.indexOf('[group]:<> ("');if(Or!=-1){hr.group=yr.substring(Or+13,yr.lastIndexOf('")'));return}let _r=new RegExp("\\[([^\\[]*)\\]\\(\\s*\\#([^\\)]+)\\s*\\)","g"),vr=_r.exec(mr);for(;vr!=null;){const wr=vr[2].trim();hr.links.includes(wr)||hr.links.push(wr),vr=_r.exec(mr)}if(cr.properties.disableShortLinks==="true")return;let xr=new RegExp("\\[([^\\[]*)\\](?!\\()","g");for(vr=xr.exec(mr);vr!=null;){const wr=vr[1].trim();hr.links.includes(wr)||hr.links.push(wr),vr=xr.exec(mr)}}),ur!==null&&(hr.lines.end=ar.length-1,hr.lines.textEnd=fr?hr.lines.end:dr-1,hr.group&&(cr.chaptersWith.group[hr.group]||(cr.chaptersWith.group[hr.group]=[]),cr.chaptersWith.group[hr.group].push(cr.chapters.length)),cr.chapters.push(hr));for(const mr of Object.keys(cr.chaptersWith.key))cr.keys[mr]=cr.chaptersWith.key[mr][0];for(const[mr,gr]of cr.chapters.entries())for(const yr of gr.links)for(const br of cr.chaptersWith.key[yr]??[])cr.chapters[br].linkedFrom.push(mr);return cr.chapters.length===0&&(cr.lines.titlePageEnd=cr.lines.end),cr},contentBook=(lr,or)=>{or||(or=indexBook(lr));const ar={text:lr,index:or},cr=ar.text.split(`
`);return{titlePage:cr.slice(0,ar.index.lines.titlePageEnd+1).join(`
`),chapters:ar.index.chapters.map((ur,hr)=>({text:cr.slice(ur.lines.textStart,ur.lines.textEnd+1).join(`
`),content:cr.slice(ur.lines.textStart,ur.lines.textEnd+1).filter(fr=>{const dr=fr.trim();return!(dr.startsWith("###")||dr.includes("[group]:")||dr.includes("![][flag-")||dr.includes("![flag-"))}).join(`
`)}))}},stringBook=(lr="")=>{var or,ar,cr,ur;return new(ur=class{constructor(){Fi(this,or,void 0);Fi(this,ar,void 0);Fi(this,cr,lr);bi(this,"steps",[])}set(hr){this.steps.push({type:"s",newText:hr}),Ri(this,cr,hr),Ri(this,or,void 0),Ri(this,ar,void 0)}get text(){return Ci(this,cr)}get index(){return Ci(this,or)===void 0&&Ri(this,or,indexBook(Ci(this,cr))),Ci(this,or)}get content(){return Ci(this,ar)===void 0&&Ri(this,ar,contentBook(Ci(this,cr),Ci(this,or))),Ci(this,ar)}replace(hr,fr,dr){this.steps.push({type:"r",from:hr,to:fr,newText:dr}),Ri(this,cr,Ci(this,cr).substring(0,hr)+dr+Ci(this,cr).substring(fr,Ci(this,cr).length)),Ri(this,or,void 0),Ri(this,ar,void 0)}apply(hr){hr(this)}},or=new WeakMap,ar=new WeakMap,cr=new WeakMap,ur)},bookify=lr=>typeof lr!="string"?lr:stringBook(lr),chaptersOf=lr=>{const or=bookify(lr);return or.index.chapters.map((ar,cr)=>[ar,or.content.chapters[cr]])},firstAvaiableKey=lr=>{const or=bookify(lr);let ar=1;for(;;){if(or.index.keys[String(ar)]===void 0)return String(ar);ar+=1}},findNewKeyIndex=(lr,or,ar=-1)=>{const cr=bookify(lr);if(!isNatNumber(or))return ar===-1?cr.index.chapters.length:ar+1;const ur=parseInt(or),hr=Math.max(0,ur-1e3);for(let mr=ur;mr>=hr;mr--){const gr=cr.index.keys[String(mr)];if(gr)return gr+1}const fr=Object.keys(cr.index.keys).filter(mr=>isNatNumber(mr)).map(mr=>parseInt(mr)).sort((mr,gr)=>mr-gr);if(fr.length===0)return ar===-1?cr.index.chapters.length:ar+1;if(fr[0]>ur)return cr.index.keys[String(fr[0])];let dr=fr[0];for(const mr of fr){if(mr>ur)break;dr=mr}return cr.index.keys[String(dr)]+1},chapterText=({key:lr,title:or="",flags:ar=[],group:cr="",content:ur="",beforeSpaceLines:hr=2,afterSpaceLines:fr=0})=>{let dr=`
`.repeat(hr);return dr+=or?`### ${or} {#${lr}}`:`### ${lr}`,ar&&ar.length>0&&(dr+=`
`+ar.map(pr=>`![][flag-${pr}]`).join(" ")),cr&&(dr+=`
[group]:<> ("${cr}")`),ur&&(dr+=`
${ur}`),dr+`
`.repeat(fr)},addChapter=(lr,{key:or=null,title:ar="",flags:cr=[],group:ur="",content:hr=""},fr=-1)=>{or==null&&(or=firstAvaiableKey(lr));const dr=findNewKeyIndex(lr,or,fr),pr=chapterText({key:or,title:ar,flags:cr,group:ur,content:hr,beforeSpaceLines:dr>0?2:0,afterSpaceLines:dr>0?0:2}),mr=dr===0?lr.index.lineStarts[lr.index.lines.titlePageEnd+1]-1:lr.index.lineStarts[lr.index.chapters[dr-1].lines.textEnd+1]-1;return lr.replace(mr,mr,pr),[dr,pr]},deleteChapter=(lr,or)=>{const{start:ar,end:cr,textStart:ur,textEnd:hr}=lr.index.chapters[or].lines,{lineStarts:fr}=lr.index;if(or===0&&lr.index.chapters.length>1){console.log("www",ur,cr);const mr=fr[ur]-1,gr=fr[cr+1]-1;lr.replace(mr,gr,"");return}const dr=fr[ar]-1,pr=fr[hr+1]-1;lr.replace(dr,pr,"")},editChapter=(lr,or,{key:ar="",title:cr="",flags:ur=[],group:hr="",content:fr=""},dr=-1)=>{const pr=lr.index.chapters[or];if(fr=lr.content.chapters[or].content,ar==pr.key&&cr==pr.title&&hr==pr.group&&ur.length===pr.flags.length&&ur.every((yr,br)=>yr===pr.flags[br]))return;const{textStart:mr,textEnd:gr}=pr.lines;hr==pr.group&&ur.length===pr.flags.length&&ur.every((yr,br)=>yr===pr.flags[br])?lr.replace(lr.index.lineStarts[mr],lr.index.lineStarts[mr+1]-1,chapterHeading(ar,cr)):lr.replace(lr.index.lineStarts[mr],lr.index.lineStarts[gr+1]-1,chapterText({key:ar,title:cr,flags:ur,group:hr,content:lr.content.chapters[or].content,beforeSpaceLines:0,afterSpaceLines:0})),ar!==pr.key&&lr.set(remapLinks(lr.text,{[pr.key]:ar}))},chapterHeading=(lr,or="")=>or===""?`### ${lr}`:`### ${or} {#${lr}}`,remapLinks=(lr,or,ar=!1)=>(lr=lr.replace(/\[([^\[]*)\](\(\s*#(\w+)\s*\))/g,(...cr)=>`[${cr[1]}](#${cr[3]in or?or[cr[3]]:cr[3]})`),ar||(lr=lr.replace(/\[([^\[]*)\]/g,(...cr)=>`[${cr[1]in or?or[cr[1]]:cr[1]}]`)),lr),remapMoveChapters=(lr,or)=>{const ar=bookify(lr),cr={},ur={};for(const[fr,dr]of Object.entries(or)){const pr=parseInt(fr);cr[dr]=pr,ur[ar.index.chapters[pr].key]=ar.index.chapters[dr].key}const hr=[];for(const[fr,[dr,{text:pr}]]of chaptersOf(ar).entries())if(fr in cr){const mr=ar.content.chapters[cr[fr]].text,gr=mr.indexOf(`
`);hr.push(chapterHeading(dr.key,dr.title)+(gr===-1?"":mr.substring(gr)))}else hr.push(pr);return ar.content.titlePage+`
`+remapLinks(hr.join(`

`),ur)},filteredChapterIndexes=(lr,{selectedFlags:or=[],groupsFilter:ar=[],onlyNumbers:cr=!0})=>{const ur=[];for(const[hr,{key:fr,group:dr,flags:pr}]of lr.index.chapters.entries())cr&&!isNatNumber(fr)||ar.length>0&&!ar.includes(dr)||pr.some(mr=>or.includes(mr))||ur.push(hr);return ur},shuffleBook=(lr,or={})=>{const ar=bookify(lr),cr=filteredChapterIndexes(ar,or),ur=JSON.parse(JSON.stringify(cr));shuffleArray(ur);const hr={};for(const[fr,dr]of cr.entries())hr[dr]=ur[fr];return remapMoveChapters(ar,hr)},compactBook=(lr,or={})=>{const ar=bookify(lr);or={...or,onlyNumbers:!0};const cr=filteredChapterIndexes(ar,or).sort((mr,gr)=>parseInt(ar.index.chapters[mr].key)-parseInt(ar.index.chapters[gr].key)),ur=cr.map(mr=>parseInt(ar.index.chapters[mr].key)),hr=Object.keys(ar.index.keys).filter(mr=>ur.includes(mr)).map(mr=>parseInt(mr)),fr={};let dr=ar.text,pr=1;for(const mr of cr){for(;hr.includes(pr);)pr+=1;const gr=String(pr),{key:yr,title:br,lines:{textStart:Or}}=ar.index.chapters[mr];fr[yr]=gr;const _r=ar.index.lineStarts[Or],vr=ar.index.lineStarts[Or+1]-1;dr=dr.substring(0,_r)+chapterHeading(gr,br)+dr.substring(vr),pr+=1}return ar.content.titlePage+remapLinks(dr.substring(ar.content.titlePage.length),fr)},sortBook=(lr,or={})=>{const ar=bookify(lr);or={...or,onlyNumbers:!0};const cr=filteredChapterIndexes(ar,or).sort((fr,dr)=>parseInt(ar.index.chapters[fr].key)-parseInt(ar.index.chapters[dr].key)),ur=[];let hr=0;for(const[fr,[dr,{text:pr}]]of chaptersOf(ar).entries())cr.includes(fr)?(ur.push(ar.content.chapters[cr[hr]].text),hr+=1):ur.push(pr);return ar.content.titlePage+`
`+ur.join(`

`)},bookUtils=Object.freeze(Object.defineProperty({__proto__:null,addChapter,atLinePosition,bookify,chapterHeading,chapterText,chaptersOf,compactBook,contentBook,deleteChapter,editChapter,findNewKeyIndex,firstAvaiableKey,indexBook,remapLinks,remapMoveChapters,sanitizeKey,shuffleBook,sortBook,stringBook},Symbol.toStringTag,{value:"Module"}));let Text$2=class ss{lineAt(or){if(or<0||or>this.length)throw new RangeError(`Invalid position ${or} in document of length ${this.length}`);return this.lineInner(or,!1,1,0)}line(or){if(or<1||or>this.lines)throw new RangeError(`Invalid line number ${or} in ${this.lines}-line document`);return this.lineInner(or,!0,1,0)}replace(or,ar,cr){let ur=[];return this.decompose(0,or,ur,2),cr.length&&cr.decompose(0,cr.length,ur,3),this.decompose(ar,this.length,ur,1),TextNode.from(ur,this.length-(ar-or)+cr.length)}append(or){return this.replace(this.length,this.length,or)}slice(or,ar=this.length){let cr=[];return this.decompose(or,ar,cr,0),TextNode.from(cr,ar-or)}eq(or){if(or==this)return!0;if(or.length!=this.length||or.lines!=this.lines)return!1;let ar=this.scanIdentical(or,1),cr=this.length-this.scanIdentical(or,-1),ur=new RawTextCursor(this),hr=new RawTextCursor(or);for(let fr=ar,dr=ar;;){if(ur.next(fr),hr.next(fr),fr=0,ur.lineBreak!=hr.lineBreak||ur.done!=hr.done||ur.value!=hr.value)return!1;if(dr+=ur.value.length,ur.done||dr>=cr)return!0}}iter(or=1){return new RawTextCursor(this,or)}iterRange(or,ar=this.length){return new PartialTextCursor(this,or,ar)}iterLines(or,ar){let cr;if(or==null)cr=this.iter();else{ar==null&&(ar=this.lines+1);let ur=this.line(or).from;cr=this.iterRange(ur,Math.max(ur,ar==this.lines+1?this.length:ar<=1?0:this.line(ar-1).to))}return new LineCursor(cr)}toString(){return this.sliceString(0)}toJSON(){let or=[];return this.flatten(or),or}constructor(){}static of(or){if(or.length==0)throw new RangeError("A document must have at least one line");return or.length==1&&!or[0]?ss.empty:or.length<=32?new TextLeaf(or):TextNode.from(TextLeaf.split(or,[]))}};class TextLeaf extends Text$2{constructor(or,ar=textLength(or)){super(),this.text=or,this.length=ar}get lines(){return this.text.length}get children(){return null}lineInner(or,ar,cr,ur){for(let hr=0;;hr++){let fr=this.text[hr],dr=ur+fr.length;if((ar?cr:dr)>=or)return new Line$2(ur,dr,cr,fr);ur=dr+1,cr++}}decompose(or,ar,cr,ur){let hr=or<=0&&ar>=this.length?this:new TextLeaf(sliceText(this.text,or,ar),Math.min(ar,this.length)-Math.max(0,or));if(ur&1){let fr=cr.pop(),dr=appendText(hr.text,fr.text.slice(),0,hr.length);if(dr.length<=32)cr.push(new TextLeaf(dr,fr.length+hr.length));else{let pr=dr.length>>1;cr.push(new TextLeaf(dr.slice(0,pr)),new TextLeaf(dr.slice(pr)))}}else cr.push(hr)}replace(or,ar,cr){if(!(cr instanceof TextLeaf))return super.replace(or,ar,cr);let ur=appendText(this.text,appendText(cr.text,sliceText(this.text,0,or)),ar),hr=this.length+cr.length-(ar-or);return ur.length<=32?new TextLeaf(ur,hr):TextNode.from(TextLeaf.split(ur,[]),hr)}sliceString(or,ar=this.length,cr=`
`){let ur="";for(let hr=0,fr=0;hr<=ar&&fr<this.text.length;fr++){let dr=this.text[fr],pr=hr+dr.length;hr>or&&fr&&(ur+=cr),or<pr&&ar>hr&&(ur+=dr.slice(Math.max(0,or-hr),ar-hr)),hr=pr+1}return ur}flatten(or){for(let ar of this.text)or.push(ar)}scanIdentical(){return 0}static split(or,ar){let cr=[],ur=-1;for(let hr of or)cr.push(hr),ur+=hr.length+1,cr.length==32&&(ar.push(new TextLeaf(cr,ur)),cr=[],ur=-1);return ur>-1&&ar.push(new TextLeaf(cr,ur)),ar}}class TextNode extends Text$2{constructor(or,ar){super(),this.children=or,this.length=ar,this.lines=0;for(let cr of or)this.lines+=cr.lines}lineInner(or,ar,cr,ur){for(let hr=0;;hr++){let fr=this.children[hr],dr=ur+fr.length,pr=cr+fr.lines-1;if((ar?pr:dr)>=or)return fr.lineInner(or,ar,cr,ur);ur=dr+1,cr=pr+1}}decompose(or,ar,cr,ur){for(let hr=0,fr=0;fr<=ar&&hr<this.children.length;hr++){let dr=this.children[hr],pr=fr+dr.length;if(or<=pr&&ar>=fr){let mr=ur&((fr<=or?1:0)|(pr>=ar?2:0));fr>=or&&pr<=ar&&!mr?cr.push(dr):dr.decompose(or-fr,ar-fr,cr,mr)}fr=pr+1}}replace(or,ar,cr){if(cr.lines<this.lines)for(let ur=0,hr=0;ur<this.children.length;ur++){let fr=this.children[ur],dr=hr+fr.length;if(or>=hr&&ar<=dr){let pr=fr.replace(or-hr,ar-hr,cr),mr=this.lines-fr.lines+pr.lines;if(pr.lines<mr>>5-1&&pr.lines>mr>>5+1){let gr=this.children.slice();return gr[ur]=pr,new TextNode(gr,this.length-(ar-or)+cr.length)}return super.replace(hr,dr,pr)}hr=dr+1}return super.replace(or,ar,cr)}sliceString(or,ar=this.length,cr=`
`){let ur="";for(let hr=0,fr=0;hr<this.children.length&&fr<=ar;hr++){let dr=this.children[hr],pr=fr+dr.length;fr>or&&hr&&(ur+=cr),or<pr&&ar>fr&&(ur+=dr.sliceString(or-fr,ar-fr,cr)),fr=pr+1}return ur}flatten(or){for(let ar of this.children)ar.flatten(or)}scanIdentical(or,ar){if(!(or instanceof TextNode))return 0;let cr=0,[ur,hr,fr,dr]=ar>0?[0,0,this.children.length,or.children.length]:[this.children.length-1,or.children.length-1,-1,-1];for(;;ur+=ar,hr+=ar){if(ur==fr||hr==dr)return cr;let pr=this.children[ur],mr=or.children[hr];if(pr!=mr)return cr+pr.scanIdentical(mr,ar);cr+=pr.length+1}}static from(or,ar=or.reduce((cr,ur)=>cr+ur.length+1,-1)){let cr=0;for(let Or of or)cr+=Or.lines;if(cr<32){let Or=[];for(let _r of or)_r.flatten(Or);return new TextLeaf(Or,ar)}let ur=Math.max(32,cr>>5),hr=ur<<1,fr=ur>>1,dr=[],pr=0,mr=-1,gr=[];function yr(Or){let _r;if(Or.lines>hr&&Or instanceof TextNode)for(let vr of Or.children)yr(vr);else Or.lines>fr&&(pr>fr||!pr)?(br(),dr.push(Or)):Or instanceof TextLeaf&&pr&&(_r=gr[gr.length-1])instanceof TextLeaf&&Or.lines+_r.lines<=32?(pr+=Or.lines,mr+=Or.length+1,gr[gr.length-1]=new TextLeaf(_r.text.concat(Or.text),_r.length+1+Or.length)):(pr+Or.lines>ur&&br(),pr+=Or.lines,mr+=Or.length+1,gr.push(Or))}function br(){pr!=0&&(dr.push(gr.length==1?gr[0]:TextNode.from(gr,mr)),mr=-1,pr=gr.length=0)}for(let Or of or)yr(Or);return br(),dr.length==1?dr[0]:new TextNode(dr,ar)}}Text$2.empty=new TextLeaf([""],0);function textLength(lr){let or=-1;for(let ar of lr)or+=ar.length+1;return or}function appendText(lr,or,ar=0,cr=1e9){for(let ur=0,hr=0,fr=!0;hr<lr.length&&ur<=cr;hr++){let dr=lr[hr],pr=ur+dr.length;pr>=ar&&(pr>cr&&(dr=dr.slice(0,cr-ur)),ur<ar&&(dr=dr.slice(ar-ur)),fr?(or[or.length-1]+=dr,fr=!1):or.push(dr)),ur=pr+1}return or}function sliceText(lr,or,ar){return appendText(lr,[""],or,ar)}class RawTextCursor{constructor(or,ar=1){this.dir=ar,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[or],this.offsets=[ar>0?1:(or instanceof TextLeaf?or.text.length:or.children.length)<<1]}nextInner(or,ar){for(this.done=this.lineBreak=!1;;){let cr=this.nodes.length-1,ur=this.nodes[cr],hr=this.offsets[cr],fr=hr>>1,dr=ur instanceof TextLeaf?ur.text.length:ur.children.length;if(fr==(ar>0?dr:0)){if(cr==0)return this.done=!0,this.value="",this;ar>0&&this.offsets[cr-1]++,this.nodes.pop(),this.offsets.pop()}else if((hr&1)==(ar>0?0:1)){if(this.offsets[cr]+=ar,or==0)return this.lineBreak=!0,this.value=`
`,this;or--}else if(ur instanceof TextLeaf){let pr=ur.text[fr+(ar<0?-1:0)];if(this.offsets[cr]+=ar,pr.length>Math.max(0,or))return this.value=or==0?pr:ar>0?pr.slice(or):pr.slice(0,pr.length-or),this;or-=pr.length}else{let pr=ur.children[fr+(ar<0?-1:0)];or>pr.length?(or-=pr.length,this.offsets[cr]+=ar):(ar<0&&this.offsets[cr]--,this.nodes.push(pr),this.offsets.push(ar>0?1:(pr instanceof TextLeaf?pr.text.length:pr.children.length)<<1))}}}next(or=0){return or<0&&(this.nextInner(-or,-this.dir),or=this.value.length),this.nextInner(or,this.dir)}}class PartialTextCursor{constructor(or,ar,cr){this.value="",this.done=!1,this.cursor=new RawTextCursor(or,ar>cr?-1:1),this.pos=ar>cr?or.length:0,this.from=Math.min(ar,cr),this.to=Math.max(ar,cr)}nextInner(or,ar){if(ar<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;or+=Math.max(0,ar<0?this.pos-this.to:this.from-this.pos);let cr=ar<0?this.pos-this.from:this.to-this.pos;or>cr&&(or=cr),cr-=or;let{value:ur}=this.cursor.next(or);return this.pos+=(ur.length+or)*ar,this.value=ur.length<=cr?ur:ar<0?ur.slice(ur.length-cr):ur.slice(0,cr),this.done=!this.value,this}next(or=0){return or<0?or=Math.max(or,this.from-this.pos):or>0&&(or=Math.min(or,this.to-this.pos)),this.nextInner(or,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class LineCursor{constructor(or){this.inner=or,this.afterBreak=!0,this.value="",this.done=!1}next(or=0){let{done:ar,lineBreak:cr,value:ur}=this.inner.next(or);return ar?(this.done=!0,this.value=""):cr?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=ur,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Text$2.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});let Line$2=class{constructor(or,ar,cr,ur){this.from=or,this.to=ar,this.number=cr,this.text=ur}get length(){return this.to-this.from}},extend="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(lr=>lr?parseInt(lr,36):1);for(let lr=1;lr<extend.length;lr++)extend[lr]+=extend[lr-1];function isExtendingChar(lr){for(let or=1;or<extend.length;or+=2)if(extend[or]>lr)return extend[or-1]<=lr;return!1}function isRegionalIndicator(lr){return lr>=127462&&lr<=127487}const ZWJ=8205;function findClusterBreak(lr,or,ar=!0,cr=!0){return(ar?nextClusterBreak:prevClusterBreak)(lr,or,cr)}function nextClusterBreak(lr,or,ar){if(or==lr.length)return or;or&&surrogateLow(lr.charCodeAt(or))&&surrogateHigh(lr.charCodeAt(or-1))&&or--;let cr=codePointAt(lr,or);for(or+=codePointSize(cr);or<lr.length;){let ur=codePointAt(lr,or);if(cr==ZWJ||ur==ZWJ||ar&&isExtendingChar(ur))or+=codePointSize(ur),cr=ur;else if(isRegionalIndicator(ur)){let hr=0,fr=or-2;for(;fr>=0&&isRegionalIndicator(codePointAt(lr,fr));)hr++,fr-=2;if(hr%2==0)break;or+=2}else break}return or}function prevClusterBreak(lr,or,ar){for(;or>0;){let cr=nextClusterBreak(lr,or-2,ar);if(cr<or)return cr;or--}return 0}function surrogateLow(lr){return lr>=56320&&lr<57344}function surrogateHigh(lr){return lr>=55296&&lr<56320}function codePointAt(lr,or){let ar=lr.charCodeAt(or);if(!surrogateHigh(ar)||or+1==lr.length)return ar;let cr=lr.charCodeAt(or+1);return surrogateLow(cr)?(ar-55296<<10)+(cr-56320)+65536:ar}function fromCodePoint(lr){return lr<=65535?String.fromCharCode(lr):(lr-=65536,String.fromCharCode((lr>>10)+55296,(lr&1023)+56320))}function codePointSize(lr){return lr<65536?1:2}const DefaultSplit=/\r\n?|\n/;var MapMode=function(lr){return lr[lr.Simple=0]="Simple",lr[lr.TrackDel=1]="TrackDel",lr[lr.TrackBefore=2]="TrackBefore",lr[lr.TrackAfter=3]="TrackAfter",lr}(MapMode||(MapMode={}));class ChangeDesc{constructor(or){this.sections=or}get length(){let or=0;for(let ar=0;ar<this.sections.length;ar+=2)or+=this.sections[ar];return or}get newLength(){let or=0;for(let ar=0;ar<this.sections.length;ar+=2){let cr=this.sections[ar+1];or+=cr<0?this.sections[ar]:cr}return or}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(or){for(let ar=0,cr=0,ur=0;ar<this.sections.length;){let hr=this.sections[ar++],fr=this.sections[ar++];fr<0?(or(cr,ur,hr),ur+=hr):ur+=fr,cr+=hr}}iterChangedRanges(or,ar=!1){iterChanges(this,or,ar)}get invertedDesc(){let or=[];for(let ar=0;ar<this.sections.length;){let cr=this.sections[ar++],ur=this.sections[ar++];ur<0?or.push(cr,ur):or.push(ur,cr)}return new ChangeDesc(or)}composeDesc(or){return this.empty?or:or.empty?this:composeSets(this,or)}mapDesc(or,ar=!1){return or.empty?this:mapSet(this,or,ar)}mapPos(or,ar=-1,cr=MapMode.Simple){let ur=0,hr=0;for(let fr=0;fr<this.sections.length;){let dr=this.sections[fr++],pr=this.sections[fr++],mr=ur+dr;if(pr<0){if(mr>or)return hr+(or-ur);hr+=dr}else{if(cr!=MapMode.Simple&&mr>=or&&(cr==MapMode.TrackDel&&ur<or&&mr>or||cr==MapMode.TrackBefore&&ur<or||cr==MapMode.TrackAfter&&mr>or))return null;if(mr>or||mr==or&&ar<0&&!dr)return or==ur||ar<0?hr:hr+pr;hr+=pr}ur=mr}if(or>ur)throw new RangeError(`Position ${or} is out of range for changeset of length ${ur}`);return hr}touchesRange(or,ar=or){for(let cr=0,ur=0;cr<this.sections.length&&ur<=ar;){let hr=this.sections[cr++],fr=this.sections[cr++],dr=ur+hr;if(fr>=0&&ur<=ar&&dr>=or)return ur<or&&dr>ar?"cover":!0;ur=dr}return!1}toString(){let or="";for(let ar=0;ar<this.sections.length;){let cr=this.sections[ar++],ur=this.sections[ar++];or+=(or?" ":"")+cr+(ur>=0?":"+ur:"")}return or}toJSON(){return this.sections}static fromJSON(or){if(!Array.isArray(or)||or.length%2||or.some(ar=>typeof ar!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(or)}static create(or){return new ChangeDesc(or)}}class ChangeSet extends ChangeDesc{constructor(or,ar){super(or),this.inserted=ar}apply(or){if(this.length!=or.length)throw new RangeError("Applying change set to a document with the wrong length");return iterChanges(this,(ar,cr,ur,hr,fr)=>or=or.replace(ur,ur+(cr-ar),fr),!1),or}mapDesc(or,ar=!1){return mapSet(this,or,ar,!0)}invert(or){let ar=this.sections.slice(),cr=[];for(let ur=0,hr=0;ur<ar.length;ur+=2){let fr=ar[ur],dr=ar[ur+1];if(dr>=0){ar[ur]=dr,ar[ur+1]=fr;let pr=ur>>1;for(;cr.length<pr;)cr.push(Text$2.empty);cr.push(fr?or.slice(hr,hr+fr):Text$2.empty)}hr+=fr}return new ChangeSet(ar,cr)}compose(or){return this.empty?or:or.empty?this:composeSets(this,or,!0)}map(or,ar=!1){return or.empty?this:mapSet(this,or,ar,!0)}iterChanges(or,ar=!1){iterChanges(this,or,ar)}get desc(){return ChangeDesc.create(this.sections)}filter(or){let ar=[],cr=[],ur=[],hr=new SectionIter(this);e:for(let fr=0,dr=0;;){let pr=fr==or.length?1e9:or[fr++];for(;dr<pr||dr==pr&&hr.len==0;){if(hr.done)break e;let gr=Math.min(hr.len,pr-dr);addSection(ur,gr,-1);let yr=hr.ins==-1?-1:hr.off==0?hr.ins:0;addSection(ar,gr,yr),yr>0&&addInsert(cr,ar,hr.text),hr.forward(gr),dr+=gr}let mr=or[fr++];for(;dr<mr;){if(hr.done)break e;let gr=Math.min(hr.len,mr-dr);addSection(ar,gr,-1),addSection(ur,gr,hr.ins==-1?-1:hr.off==0?hr.ins:0),hr.forward(gr),dr+=gr}}return{changes:new ChangeSet(ar,cr),filtered:ChangeDesc.create(ur)}}toJSON(){let or=[];for(let ar=0;ar<this.sections.length;ar+=2){let cr=this.sections[ar],ur=this.sections[ar+1];ur<0?or.push(cr):ur==0?or.push([cr]):or.push([cr].concat(this.inserted[ar>>1].toJSON()))}return or}static of(or,ar,cr){let ur=[],hr=[],fr=0,dr=null;function pr(gr=!1){if(!gr&&!ur.length)return;fr<ar&&addSection(ur,ar-fr,-1);let yr=new ChangeSet(ur,hr);dr=dr?dr.compose(yr.map(dr)):yr,ur=[],hr=[],fr=0}function mr(gr){if(Array.isArray(gr))for(let yr of gr)mr(yr);else if(gr instanceof ChangeSet){if(gr.length!=ar)throw new RangeError(`Mismatched change set length (got ${gr.length}, expected ${ar})`);pr(),dr=dr?dr.compose(gr.map(dr)):gr}else{let{from:yr,to:br=yr,insert:Or}=gr;if(yr>br||yr<0||br>ar)throw new RangeError(`Invalid change range ${yr} to ${br} (in doc of length ${ar})`);let _r=Or?typeof Or=="string"?Text$2.of(Or.split(cr||DefaultSplit)):Or:Text$2.empty,vr=_r.length;if(yr==br&&vr==0)return;yr<fr&&pr(),yr>fr&&addSection(ur,yr-fr,-1),addSection(ur,br-yr,vr),addInsert(hr,ur,_r),fr=br}}return mr(or),pr(!dr),dr}static empty(or){return new ChangeSet(or?[or,-1]:[],[])}static fromJSON(or){if(!Array.isArray(or))throw new RangeError("Invalid JSON representation of ChangeSet");let ar=[],cr=[];for(let ur=0;ur<or.length;ur++){let hr=or[ur];if(typeof hr=="number")ar.push(hr,-1);else{if(!Array.isArray(hr)||typeof hr[0]!="number"||hr.some((fr,dr)=>dr&&typeof fr!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(hr.length==1)ar.push(hr[0],0);else{for(;cr.length<ur;)cr.push(Text$2.empty);cr[ur]=Text$2.of(hr.slice(1)),ar.push(hr[0],cr[ur].length)}}}return new ChangeSet(ar,cr)}static createSet(or,ar){return new ChangeSet(or,ar)}}function addSection(lr,or,ar,cr=!1){if(or==0&&ar<=0)return;let ur=lr.length-2;ur>=0&&ar<=0&&ar==lr[ur+1]?lr[ur]+=or:or==0&&lr[ur]==0?lr[ur+1]+=ar:cr?(lr[ur]+=or,lr[ur+1]+=ar):lr.push(or,ar)}function addInsert(lr,or,ar){if(ar.length==0)return;let cr=or.length-2>>1;if(cr<lr.length)lr[lr.length-1]=lr[lr.length-1].append(ar);else{for(;lr.length<cr;)lr.push(Text$2.empty);lr.push(ar)}}function iterChanges(lr,or,ar){let cr=lr.inserted;for(let ur=0,hr=0,fr=0;fr<lr.sections.length;){let dr=lr.sections[fr++],pr=lr.sections[fr++];if(pr<0)ur+=dr,hr+=dr;else{let mr=ur,gr=hr,yr=Text$2.empty;for(;mr+=dr,gr+=pr,pr&&cr&&(yr=yr.append(cr[fr-2>>1])),!(ar||fr==lr.sections.length||lr.sections[fr+1]<0);)dr=lr.sections[fr++],pr=lr.sections[fr++];or(ur,mr,hr,gr,yr),ur=mr,hr=gr}}}function mapSet(lr,or,ar,cr=!1){let ur=[],hr=cr?[]:null,fr=new SectionIter(lr),dr=new SectionIter(or);for(let pr=-1;;)if(fr.ins==-1&&dr.ins==-1){let mr=Math.min(fr.len,dr.len);addSection(ur,mr,-1),fr.forward(mr),dr.forward(mr)}else if(dr.ins>=0&&(fr.ins<0||pr==fr.i||fr.off==0&&(dr.len<fr.len||dr.len==fr.len&&!ar))){let mr=dr.len;for(addSection(ur,dr.ins,-1);mr;){let gr=Math.min(fr.len,mr);fr.ins>=0&&pr<fr.i&&fr.len<=gr&&(addSection(ur,0,fr.ins),hr&&addInsert(hr,ur,fr.text),pr=fr.i),fr.forward(gr),mr-=gr}dr.next()}else if(fr.ins>=0){let mr=0,gr=fr.len;for(;gr;)if(dr.ins==-1){let yr=Math.min(gr,dr.len);mr+=yr,gr-=yr,dr.forward(yr)}else if(dr.ins==0&&dr.len<gr)gr-=dr.len,dr.next();else break;addSection(ur,mr,pr<fr.i?fr.ins:0),hr&&pr<fr.i&&addInsert(hr,ur,fr.text),pr=fr.i,fr.forward(fr.len-gr)}else{if(fr.done&&dr.done)return hr?ChangeSet.createSet(ur,hr):ChangeDesc.create(ur);throw new Error("Mismatched change set lengths")}}function composeSets(lr,or,ar=!1){let cr=[],ur=ar?[]:null,hr=new SectionIter(lr),fr=new SectionIter(or);for(let dr=!1;;){if(hr.done&&fr.done)return ur?ChangeSet.createSet(cr,ur):ChangeDesc.create(cr);if(hr.ins==0)addSection(cr,hr.len,0,dr),hr.next();else if(fr.len==0&&!fr.done)addSection(cr,0,fr.ins,dr),ur&&addInsert(ur,cr,fr.text),fr.next();else{if(hr.done||fr.done)throw new Error("Mismatched change set lengths");{let pr=Math.min(hr.len2,fr.len),mr=cr.length;if(hr.ins==-1){let gr=fr.ins==-1?-1:fr.off?0:fr.ins;addSection(cr,pr,gr,dr),ur&&gr&&addInsert(ur,cr,fr.text)}else fr.ins==-1?(addSection(cr,hr.off?0:hr.len,pr,dr),ur&&addInsert(ur,cr,hr.textBit(pr))):(addSection(cr,hr.off?0:hr.len,fr.off?0:fr.ins,dr),ur&&!fr.off&&addInsert(ur,cr,fr.text));dr=(hr.ins>pr||fr.ins>=0&&fr.len>pr)&&(dr||cr.length>mr),hr.forward2(pr),fr.forward(pr)}}}}class SectionIter{constructor(or){this.set=or,this.i=0,this.next()}next(){let{sections:or}=this.set;this.i<or.length?(this.len=or[this.i++],this.ins=or[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:or}=this.set,ar=this.i-2>>1;return ar>=or.length?Text$2.empty:or[ar]}textBit(or){let{inserted:ar}=this.set,cr=this.i-2>>1;return cr>=ar.length&&!or?Text$2.empty:ar[cr].slice(this.off,or==null?void 0:this.off+or)}forward(or){or==this.len?this.next():(this.len-=or,this.off+=or)}forward2(or){this.ins==-1?this.forward(or):or==this.ins?this.next():(this.ins-=or,this.off+=or)}}class SelectionRange{constructor(or,ar,cr){this.from=or,this.to=ar,this.flags=cr}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let or=this.flags&3;return or==3?null:or}get goalColumn(){let or=this.flags>>5;return or==33554431?void 0:or}map(or,ar=-1){let cr,ur;return this.empty?cr=ur=or.mapPos(this.from,ar):(cr=or.mapPos(this.from,1),ur=or.mapPos(this.to,-1)),cr==this.from&&ur==this.to?this:new SelectionRange(cr,ur,this.flags)}extend(or,ar=or){if(or<=this.anchor&&ar>=this.anchor)return EditorSelection.range(or,ar);let cr=Math.abs(or-this.anchor)>Math.abs(ar-this.anchor)?or:ar;return EditorSelection.range(this.anchor,cr)}eq(or){return this.anchor==or.anchor&&this.head==or.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(or){if(!or||typeof or.anchor!="number"||typeof or.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(or.anchor,or.head)}static create(or,ar,cr){return new SelectionRange(or,ar,cr)}}class EditorSelection{constructor(or,ar){this.ranges=or,this.mainIndex=ar}map(or,ar=-1){return or.empty?this:EditorSelection.create(this.ranges.map(cr=>cr.map(or,ar)),this.mainIndex)}eq(or){if(this.ranges.length!=or.ranges.length||this.mainIndex!=or.mainIndex)return!1;for(let ar=0;ar<this.ranges.length;ar++)if(!this.ranges[ar].eq(or.ranges[ar]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new EditorSelection([this.main],0)}addRange(or,ar=!0){return EditorSelection.create([or].concat(this.ranges),ar?0:this.mainIndex+1)}replaceRange(or,ar=this.mainIndex){let cr=this.ranges.slice();return cr[ar]=or,EditorSelection.create(cr,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(or=>or.toJSON()),main:this.mainIndex}}static fromJSON(or){if(!or||!Array.isArray(or.ranges)||typeof or.main!="number"||or.main>=or.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(or.ranges.map(ar=>SelectionRange.fromJSON(ar)),or.main)}static single(or,ar=or){return new EditorSelection([EditorSelection.range(or,ar)],0)}static create(or,ar=0){if(or.length==0)throw new RangeError("A selection needs at least one range");for(let cr=0,ur=0;ur<or.length;ur++){let hr=or[ur];if(hr.empty?hr.from<=cr:hr.from<cr)return EditorSelection.normalized(or.slice(),ar);cr=hr.to}return new EditorSelection(or,ar)}static cursor(or,ar=0,cr,ur){return SelectionRange.create(or,or,(ar==0?0:ar<0?4:8)|(cr==null?3:Math.min(2,cr))|(ur??33554431)<<5)}static range(or,ar,cr,ur){let hr=(cr??33554431)<<5|(ur==null?3:Math.min(2,ur));return ar<or?SelectionRange.create(ar,or,24|hr):SelectionRange.create(or,ar,(ar>or?4:0)|hr)}static normalized(or,ar=0){let cr=or[ar];or.sort((ur,hr)=>ur.from-hr.from),ar=or.indexOf(cr);for(let ur=1;ur<or.length;ur++){let hr=or[ur],fr=or[ur-1];if(hr.empty?hr.from<=fr.to:hr.from<fr.to){let dr=fr.from,pr=Math.max(hr.to,fr.to);ur<=ar&&ar--,or.splice(--ur,2,hr.anchor>hr.head?EditorSelection.range(pr,dr):EditorSelection.range(dr,pr))}}return new EditorSelection(or,ar)}}function checkSelection(lr,or){for(let ar of lr.ranges)if(ar.to>or)throw new RangeError("Selection points outside of document")}let nextID=0;class Facet{constructor(or,ar,cr,ur,hr){this.combine=or,this.compareInput=ar,this.compare=cr,this.isStatic=ur,this.id=nextID++,this.default=or([]),this.extensions=typeof hr=="function"?hr(this):hr}static define(or={}){return new Facet(or.combine||(ar=>ar),or.compareInput||((ar,cr)=>ar===cr),or.compare||(or.combine?(ar,cr)=>ar===cr:sameArray$1),!!or.static,or.enables)}of(or){return new FacetProvider([],this,0,or)}compute(or,ar){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(or,this,1,ar)}computeN(or,ar){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(or,this,2,ar)}from(or,ar){return ar||(ar=cr=>cr),this.compute([or],cr=>ar(cr.field(or)))}}function sameArray$1(lr,or){return lr==or||lr.length==or.length&&lr.every((ar,cr)=>ar===or[cr])}class FacetProvider{constructor(or,ar,cr,ur){this.dependencies=or,this.facet=ar,this.type=cr,this.value=ur,this.id=nextID++}dynamicSlot(or){var ar;let cr=this.value,ur=this.facet.compareInput,hr=this.id,fr=or[hr]>>1,dr=this.type==2,pr=!1,mr=!1,gr=[];for(let yr of this.dependencies)yr=="doc"?pr=!0:yr=="selection"?mr=!0:((ar=or[yr.id])!==null&&ar!==void 0?ar:1)&1||gr.push(or[yr.id]);return{create(yr){return yr.values[fr]=cr(yr),1},update(yr,br){if(pr&&br.docChanged||mr&&(br.docChanged||br.selection)||ensureAll(yr,gr)){let Or=cr(yr);if(dr?!compareArray(Or,yr.values[fr],ur):!ur(Or,yr.values[fr]))return yr.values[fr]=Or,1}return 0},reconfigure:(yr,br)=>{let Or,_r=br.config.address[hr];if(_r!=null){let vr=getAddr(br,_r);if(this.dependencies.every(xr=>xr instanceof Facet?br.facet(xr)===yr.facet(xr):xr instanceof StateField?br.field(xr,!1)==yr.field(xr,!1):!0)||(dr?compareArray(Or=cr(yr),vr,ur):ur(Or=cr(yr),vr)))return yr.values[fr]=vr,0}else Or=cr(yr);return yr.values[fr]=Or,1}}}}function compareArray(lr,or,ar){if(lr.length!=or.length)return!1;for(let cr=0;cr<lr.length;cr++)if(!ar(lr[cr],or[cr]))return!1;return!0}function ensureAll(lr,or){let ar=!1;for(let cr of or)ensureAddr(lr,cr)&1&&(ar=!0);return ar}function dynamicFacetSlot(lr,or,ar){let cr=ar.map(pr=>lr[pr.id]),ur=ar.map(pr=>pr.type),hr=cr.filter(pr=>!(pr&1)),fr=lr[or.id]>>1;function dr(pr){let mr=[];for(let gr=0;gr<cr.length;gr++){let yr=getAddr(pr,cr[gr]);if(ur[gr]==2)for(let br of yr)mr.push(br);else mr.push(yr)}return or.combine(mr)}return{create(pr){for(let mr of cr)ensureAddr(pr,mr);return pr.values[fr]=dr(pr),1},update(pr,mr){if(!ensureAll(pr,hr))return 0;let gr=dr(pr);return or.compare(gr,pr.values[fr])?0:(pr.values[fr]=gr,1)},reconfigure(pr,mr){let gr=ensureAll(pr,cr),yr=mr.config.facets[or.id],br=mr.facet(or);if(yr&&!gr&&sameArray$1(ar,yr))return pr.values[fr]=br,0;let Or=dr(pr);return or.compare(Or,br)?(pr.values[fr]=br,0):(pr.values[fr]=Or,1)}}}const initField=Facet.define({static:!0});class StateField{constructor(or,ar,cr,ur,hr){this.id=or,this.createF=ar,this.updateF=cr,this.compareF=ur,this.spec=hr,this.provides=void 0}static define(or){let ar=new StateField(nextID++,or.create,or.update,or.compare||((cr,ur)=>cr===ur),or);return or.provide&&(ar.provides=or.provide(ar)),ar}create(or){let ar=or.facet(initField).find(cr=>cr.field==this);return((ar==null?void 0:ar.create)||this.createF)(or)}slot(or){let ar=or[this.id]>>1;return{create:cr=>(cr.values[ar]=this.create(cr),1),update:(cr,ur)=>{let hr=cr.values[ar],fr=this.updateF(hr,ur);return this.compareF(hr,fr)?0:(cr.values[ar]=fr,1)},reconfigure:(cr,ur)=>ur.config.address[this.id]!=null?(cr.values[ar]=ur.field(this),0):(cr.values[ar]=this.create(cr),1)}}init(or){return[this,initField.of({field:this,create:or})]}get extension(){return this}}const Prec_={lowest:4,low:3,default:2,high:1,highest:0};function prec(lr){return or=>new PrecExtension(or,lr)}const Prec={highest:prec(Prec_.highest),high:prec(Prec_.high),default:prec(Prec_.default),low:prec(Prec_.low),lowest:prec(Prec_.lowest)};class PrecExtension{constructor(or,ar){this.inner=or,this.prec=ar}}class Compartment{of(or){return new CompartmentInstance(this,or)}reconfigure(or){return Compartment.reconfigure.of({compartment:this,extension:or})}get(or){return or.config.compartments.get(this)}}class CompartmentInstance{constructor(or,ar){this.compartment=or,this.inner=ar}}class Configuration{constructor(or,ar,cr,ur,hr,fr){for(this.base=or,this.compartments=ar,this.dynamicSlots=cr,this.address=ur,this.staticValues=hr,this.facets=fr,this.statusTemplate=[];this.statusTemplate.length<cr.length;)this.statusTemplate.push(0)}staticFacet(or){let ar=this.address[or.id];return ar==null?or.default:this.staticValues[ar>>1]}static resolve(or,ar,cr){let ur=[],hr=Object.create(null),fr=new Map;for(let br of flatten(or,ar,fr))br instanceof StateField?ur.push(br):(hr[br.facet.id]||(hr[br.facet.id]=[])).push(br);let dr=Object.create(null),pr=[],mr=[];for(let br of ur)dr[br.id]=mr.length<<1,mr.push(Or=>br.slot(Or));let gr=cr==null?void 0:cr.config.facets;for(let br in hr){let Or=hr[br],_r=Or[0].facet,vr=gr&&gr[br]||[];if(Or.every(xr=>xr.type==0))if(dr[_r.id]=pr.length<<1|1,sameArray$1(vr,Or))pr.push(cr.facet(_r));else{let xr=_r.combine(Or.map(wr=>wr.value));pr.push(cr&&_r.compare(xr,cr.facet(_r))?cr.facet(_r):xr)}else{for(let xr of Or)xr.type==0?(dr[xr.id]=pr.length<<1|1,pr.push(xr.value)):(dr[xr.id]=mr.length<<1,mr.push(wr=>xr.dynamicSlot(wr)));dr[_r.id]=mr.length<<1,mr.push(xr=>dynamicFacetSlot(xr,_r,Or))}}let yr=mr.map(br=>br(dr));return new Configuration(or,fr,yr,dr,pr,hr)}}function flatten(lr,or,ar){let cr=[[],[],[],[],[]],ur=new Map;function hr(fr,dr){let pr=ur.get(fr);if(pr!=null){if(pr<=dr)return;let mr=cr[pr].indexOf(fr);mr>-1&&cr[pr].splice(mr,1),fr instanceof CompartmentInstance&&ar.delete(fr.compartment)}if(ur.set(fr,dr),Array.isArray(fr))for(let mr of fr)hr(mr,dr);else if(fr instanceof CompartmentInstance){if(ar.has(fr.compartment))throw new RangeError("Duplicate use of compartment in extensions");let mr=or.get(fr.compartment)||fr.inner;ar.set(fr.compartment,mr),hr(mr,dr)}else if(fr instanceof PrecExtension)hr(fr.inner,fr.prec);else if(fr instanceof StateField)cr[dr].push(fr),fr.provides&&hr(fr.provides,dr);else if(fr instanceof FacetProvider)cr[dr].push(fr),fr.facet.extensions&&hr(fr.facet.extensions,Prec_.default);else{let mr=fr.extension;if(!mr)throw new Error(`Unrecognized extension value in extension set (${fr}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);hr(mr,dr)}}return hr(lr,Prec_.default),cr.reduce((fr,dr)=>fr.concat(dr))}function ensureAddr(lr,or){if(or&1)return 2;let ar=or>>1,cr=lr.status[ar];if(cr==4)throw new Error("Cyclic dependency between fields and/or facets");if(cr&2)return cr;lr.status[ar]=4;let ur=lr.computeSlot(lr,lr.config.dynamicSlots[ar]);return lr.status[ar]=2|ur}function getAddr(lr,or){return or&1?lr.config.staticValues[or>>1]:lr.values[or>>1]}const languageData=Facet.define(),allowMultipleSelections=Facet.define({combine:lr=>lr.some(or=>or),static:!0}),lineSeparator=Facet.define({combine:lr=>lr.length?lr[0]:void 0,static:!0}),changeFilter=Facet.define(),transactionFilter=Facet.define(),transactionExtender=Facet.define(),readOnly=Facet.define({combine:lr=>lr.length?lr[0]:!1});class Annotation{constructor(or,ar){this.type=or,this.value=ar}static define(){return new AnnotationType}}class AnnotationType{of(or){return new Annotation(this,or)}}class StateEffectType{constructor(or){this.map=or}of(or){return new StateEffect(this,or)}}class StateEffect{constructor(or,ar){this.type=or,this.value=ar}map(or){let ar=this.type.map(this.value,or);return ar===void 0?void 0:ar==this.value?this:new StateEffect(this.type,ar)}is(or){return this.type==or}static define(or={}){return new StateEffectType(or.map||(ar=>ar))}static mapEffects(or,ar){if(!or.length)return or;let cr=[];for(let ur of or){let hr=ur.map(ar);hr&&cr.push(hr)}return cr}}StateEffect.reconfigure=StateEffect.define();StateEffect.appendConfig=StateEffect.define();class Transaction{constructor(or,ar,cr,ur,hr,fr){this.startState=or,this.changes=ar,this.selection=cr,this.effects=ur,this.annotations=hr,this.scrollIntoView=fr,this._doc=null,this._state=null,cr&&checkSelection(cr,ar.newLength),hr.some(dr=>dr.type==Transaction.time)||(this.annotations=hr.concat(Transaction.time.of(Date.now())))}static create(or,ar,cr,ur,hr,fr){return new Transaction(or,ar,cr,ur,hr,fr)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(or){for(let ar of this.annotations)if(ar.type==or)return ar.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(or){let ar=this.annotation(Transaction.userEvent);return!!(ar&&(ar==or||ar.length>or.length&&ar.slice(0,or.length)==or&&ar[or.length]=="."))}}Transaction.time=Annotation.define();Transaction.userEvent=Annotation.define();Transaction.addToHistory=Annotation.define();Transaction.remote=Annotation.define();function joinRanges(lr,or){let ar=[];for(let cr=0,ur=0;;){let hr,fr;if(cr<lr.length&&(ur==or.length||or[ur]>=lr[cr]))hr=lr[cr++],fr=lr[cr++];else if(ur<or.length)hr=or[ur++],fr=or[ur++];else return ar;!ar.length||ar[ar.length-1]<hr?ar.push(hr,fr):ar[ar.length-1]<fr&&(ar[ar.length-1]=fr)}}function mergeTransaction(lr,or,ar){var cr;let ur,hr,fr;return ar?(ur=or.changes,hr=ChangeSet.empty(or.changes.length),fr=lr.changes.compose(or.changes)):(ur=or.changes.map(lr.changes),hr=lr.changes.mapDesc(or.changes,!0),fr=lr.changes.compose(ur)),{changes:fr,selection:or.selection?or.selection.map(hr):(cr=lr.selection)===null||cr===void 0?void 0:cr.map(ur),effects:StateEffect.mapEffects(lr.effects,ur).concat(StateEffect.mapEffects(or.effects,hr)),annotations:lr.annotations.length?lr.annotations.concat(or.annotations):or.annotations,scrollIntoView:lr.scrollIntoView||or.scrollIntoView}}function resolveTransactionInner(lr,or,ar){let cr=or.selection,ur=asArray(or.annotations);return or.userEvent&&(ur=ur.concat(Transaction.userEvent.of(or.userEvent))),{changes:or.changes instanceof ChangeSet?or.changes:ChangeSet.of(or.changes||[],ar,lr.facet(lineSeparator)),selection:cr&&(cr instanceof EditorSelection?cr:EditorSelection.single(cr.anchor,cr.head)),effects:asArray(or.effects),annotations:ur,scrollIntoView:!!or.scrollIntoView}}function resolveTransaction(lr,or,ar){let cr=resolveTransactionInner(lr,or.length?or[0]:{},lr.doc.length);or.length&&or[0].filter===!1&&(ar=!1);for(let hr=1;hr<or.length;hr++){or[hr].filter===!1&&(ar=!1);let fr=!!or[hr].sequential;cr=mergeTransaction(cr,resolveTransactionInner(lr,or[hr],fr?cr.changes.newLength:lr.doc.length),fr)}let ur=Transaction.create(lr,cr.changes,cr.selection,cr.effects,cr.annotations,cr.scrollIntoView);return extendTransaction(ar?filterTransaction(ur):ur)}function filterTransaction(lr){let or=lr.startState,ar=!0;for(let ur of or.facet(changeFilter)){let hr=ur(lr);if(hr===!1){ar=!1;break}Array.isArray(hr)&&(ar=ar===!0?hr:joinRanges(ar,hr))}if(ar!==!0){let ur,hr;if(ar===!1)hr=lr.changes.invertedDesc,ur=ChangeSet.empty(or.doc.length);else{let fr=lr.changes.filter(ar);ur=fr.changes,hr=fr.filtered.mapDesc(fr.changes).invertedDesc}lr=Transaction.create(or,ur,lr.selection&&lr.selection.map(hr),StateEffect.mapEffects(lr.effects,hr),lr.annotations,lr.scrollIntoView)}let cr=or.facet(transactionFilter);for(let ur=cr.length-1;ur>=0;ur--){let hr=cr[ur](lr);hr instanceof Transaction?lr=hr:Array.isArray(hr)&&hr.length==1&&hr[0]instanceof Transaction?lr=hr[0]:lr=resolveTransaction(or,asArray(hr),!1)}return lr}function extendTransaction(lr){let or=lr.startState,ar=or.facet(transactionExtender),cr=lr;for(let ur=ar.length-1;ur>=0;ur--){let hr=ar[ur](lr);hr&&Object.keys(hr).length&&(cr=mergeTransaction(cr,resolveTransactionInner(or,hr,lr.changes.newLength),!0))}return cr==lr?lr:Transaction.create(or,lr.changes,lr.selection,cr.effects,cr.annotations,cr.scrollIntoView)}const none$2=[];function asArray(lr){return lr==null?none$2:Array.isArray(lr)?lr:[lr]}var CharCategory=function(lr){return lr[lr.Word=0]="Word",lr[lr.Space=1]="Space",lr[lr.Other=2]="Other",lr}(CharCategory||(CharCategory={}));const nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function hasWordChar(lr){if(wordChar)return wordChar.test(lr);for(let or=0;or<lr.length;or++){let ar=lr[or];if(/\w/.test(ar)||ar>""&&(ar.toUpperCase()!=ar.toLowerCase()||nonASCIISingleCaseWordChar.test(ar)))return!0}return!1}function makeCategorizer(lr){return or=>{if(!/\S/.test(or))return CharCategory.Space;if(hasWordChar(or))return CharCategory.Word;for(let ar=0;ar<lr.length;ar++)if(or.indexOf(lr[ar])>-1)return CharCategory.Word;return CharCategory.Other}}class EditorState{constructor(or,ar,cr,ur,hr,fr){this.config=or,this.doc=ar,this.selection=cr,this.values=ur,this.status=or.statusTemplate.slice(),this.computeSlot=hr,fr&&(fr._state=this);for(let dr=0;dr<this.config.dynamicSlots.length;dr++)ensureAddr(this,dr<<1);this.computeSlot=null}field(or,ar=!0){let cr=this.config.address[or.id];if(cr==null){if(ar)throw new RangeError("Field is not present in this state");return}return ensureAddr(this,cr),getAddr(this,cr)}update(...or){return resolveTransaction(this,or,!0)}applyTransaction(or){let ar=this.config,{base:cr,compartments:ur}=ar;for(let fr of or.effects)fr.is(Compartment.reconfigure)?(ar&&(ur=new Map,ar.compartments.forEach((dr,pr)=>ur.set(pr,dr)),ar=null),ur.set(fr.value.compartment,fr.value.extension)):fr.is(StateEffect.reconfigure)?(ar=null,cr=fr.value):fr.is(StateEffect.appendConfig)&&(ar=null,cr=asArray(cr).concat(fr.value));let hr;ar?hr=or.startState.values.slice():(ar=Configuration.resolve(cr,ur,this),hr=new EditorState(ar,this.doc,this.selection,ar.dynamicSlots.map(()=>null),(dr,pr)=>pr.reconfigure(dr,this),null).values),new EditorState(ar,or.newDoc,or.newSelection,hr,(fr,dr)=>dr.update(fr,or),or)}replaceSelection(or){return typeof or=="string"&&(or=this.toText(or)),this.changeByRange(ar=>({changes:{from:ar.from,to:ar.to,insert:or},range:EditorSelection.cursor(ar.from+or.length)}))}changeByRange(or){let ar=this.selection,cr=or(ar.ranges[0]),ur=this.changes(cr.changes),hr=[cr.range],fr=asArray(cr.effects);for(let dr=1;dr<ar.ranges.length;dr++){let pr=or(ar.ranges[dr]),mr=this.changes(pr.changes),gr=mr.map(ur);for(let br=0;br<dr;br++)hr[br]=hr[br].map(gr);let yr=ur.mapDesc(mr,!0);hr.push(pr.range.map(yr)),ur=ur.compose(gr),fr=StateEffect.mapEffects(fr,gr).concat(StateEffect.mapEffects(asArray(pr.effects),yr))}return{changes:ur,selection:EditorSelection.create(hr,ar.mainIndex),effects:fr}}changes(or=[]){return or instanceof ChangeSet?or:ChangeSet.of(or,this.doc.length,this.facet(EditorState.lineSeparator))}toText(or){return Text$2.of(or.split(this.facet(EditorState.lineSeparator)||DefaultSplit))}sliceDoc(or=0,ar=this.doc.length){return this.doc.sliceString(or,ar,this.lineBreak)}facet(or){let ar=this.config.address[or.id];return ar==null?or.default:(ensureAddr(this,ar),getAddr(this,ar))}toJSON(or){let ar={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(or)for(let cr in or){let ur=or[cr];ur instanceof StateField&&this.config.address[ur.id]!=null&&(ar[cr]=ur.spec.toJSON(this.field(or[cr]),this))}return ar}static fromJSON(or,ar={},cr){if(!or||typeof or.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let ur=[];if(cr){for(let hr in cr)if(Object.prototype.hasOwnProperty.call(or,hr)){let fr=cr[hr],dr=or[hr];ur.push(fr.init(pr=>fr.spec.fromJSON(dr,pr)))}}return EditorState.create({doc:or.doc,selection:EditorSelection.fromJSON(or.selection),extensions:ar.extensions?ur.concat([ar.extensions]):ur})}static create(or={}){let ar=Configuration.resolve(or.extensions||[],new Map),cr=or.doc instanceof Text$2?or.doc:Text$2.of((or.doc||"").split(ar.staticFacet(EditorState.lineSeparator)||DefaultSplit)),ur=or.selection?or.selection instanceof EditorSelection?or.selection:EditorSelection.single(or.selection.anchor,or.selection.head):EditorSelection.single(0);return checkSelection(ur,cr.length),ar.staticFacet(allowMultipleSelections)||(ur=ur.asSingle()),new EditorState(ar,cr,ur,ar.dynamicSlots.map(()=>null),(hr,fr)=>fr.create(hr),null)}get tabSize(){return this.facet(EditorState.tabSize)}get lineBreak(){return this.facet(EditorState.lineSeparator)||`
`}get readOnly(){return this.facet(readOnly)}phrase(or,...ar){for(let cr of this.facet(EditorState.phrases))if(Object.prototype.hasOwnProperty.call(cr,or)){or=cr[or];break}return ar.length&&(or=or.replace(/\$(\$|\d*)/g,(cr,ur)=>{if(ur=="$")return"$";let hr=+(ur||1);return!hr||hr>ar.length?cr:ar[hr-1]})),or}languageDataAt(or,ar,cr=-1){let ur=[];for(let hr of this.facet(languageData))for(let fr of hr(this,ar,cr))Object.prototype.hasOwnProperty.call(fr,or)&&ur.push(fr[or]);return ur}charCategorizer(or){return makeCategorizer(this.languageDataAt("wordChars",or).join(""))}wordAt(or){let{text:ar,from:cr,length:ur}=this.doc.lineAt(or),hr=this.charCategorizer(or),fr=or-cr,dr=or-cr;for(;fr>0;){let pr=findClusterBreak(ar,fr,!1);if(hr(ar.slice(pr,fr))!=CharCategory.Word)break;fr=pr}for(;dr<ur;){let pr=findClusterBreak(ar,dr);if(hr(ar.slice(dr,pr))!=CharCategory.Word)break;dr=pr}return fr==dr?null:EditorSelection.range(fr+cr,dr+cr)}}EditorState.allowMultipleSelections=allowMultipleSelections;EditorState.tabSize=Facet.define({combine:lr=>lr.length?lr[0]:4});EditorState.lineSeparator=lineSeparator;EditorState.readOnly=readOnly;EditorState.phrases=Facet.define({compare(lr,or){let ar=Object.keys(lr),cr=Object.keys(or);return ar.length==cr.length&&ar.every(ur=>lr[ur]==or[ur])}});EditorState.languageData=languageData;EditorState.changeFilter=changeFilter;EditorState.transactionFilter=transactionFilter;EditorState.transactionExtender=transactionExtender;Compartment.reconfigure=StateEffect.define();function combineConfig(lr,or,ar={}){let cr={};for(let ur of lr)for(let hr of Object.keys(ur)){let fr=ur[hr],dr=cr[hr];if(dr===void 0)cr[hr]=fr;else if(!(dr===fr||fr===void 0))if(Object.hasOwnProperty.call(ar,hr))cr[hr]=ar[hr](dr,fr);else throw new Error("Config merge conflict for field "+hr)}for(let ur in or)cr[ur]===void 0&&(cr[ur]=or[ur]);return cr}class RangeValue{eq(or){return this==or}range(or,ar=or){return Range$1.create(or,ar,this)}}RangeValue.prototype.startSide=RangeValue.prototype.endSide=0;RangeValue.prototype.point=!1;RangeValue.prototype.mapMode=MapMode.TrackDel;let Range$1=class os{constructor(or,ar,cr){this.from=or,this.to=ar,this.value=cr}static create(or,ar,cr){return new os(or,ar,cr)}};function cmpRange(lr,or){return lr.from-or.from||lr.value.startSide-or.value.startSide}class Chunk{constructor(or,ar,cr,ur){this.from=or,this.to=ar,this.value=cr,this.maxPoint=ur}get length(){return this.to[this.to.length-1]}findIndex(or,ar,cr,ur=0){let hr=cr?this.to:this.from;for(let fr=ur,dr=hr.length;;){if(fr==dr)return fr;let pr=fr+dr>>1,mr=hr[pr]-or||(cr?this.value[pr].endSide:this.value[pr].startSide)-ar;if(pr==fr)return mr>=0?fr:dr;mr>=0?dr=pr:fr=pr+1}}between(or,ar,cr,ur){for(let hr=this.findIndex(ar,-1e9,!0),fr=this.findIndex(cr,1e9,!1,hr);hr<fr;hr++)if(ur(this.from[hr]+or,this.to[hr]+or,this.value[hr])===!1)return!1}map(or,ar){let cr=[],ur=[],hr=[],fr=-1,dr=-1;for(let pr=0;pr<this.value.length;pr++){let mr=this.value[pr],gr=this.from[pr]+or,yr=this.to[pr]+or,br,Or;if(gr==yr){let _r=ar.mapPos(gr,mr.startSide,mr.mapMode);if(_r==null||(br=Or=_r,mr.startSide!=mr.endSide&&(Or=ar.mapPos(gr,mr.endSide),Or<br)))continue}else if(br=ar.mapPos(gr,mr.startSide),Or=ar.mapPos(yr,mr.endSide),br>Or||br==Or&&mr.startSide>0&&mr.endSide<=0)continue;(Or-br||mr.endSide-mr.startSide)<0||(fr<0&&(fr=br),mr.point&&(dr=Math.max(dr,Or-br)),cr.push(mr),ur.push(br-fr),hr.push(Or-fr))}return{mapped:cr.length?new Chunk(ur,hr,cr,dr):null,pos:fr}}}class RangeSet{constructor(or,ar,cr,ur){this.chunkPos=or,this.chunk=ar,this.nextLayer=cr,this.maxPoint=ur}static create(or,ar,cr,ur){return new RangeSet(or,ar,cr,ur)}get length(){let or=this.chunk.length-1;return or<0?0:Math.max(this.chunkEnd(or),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let or=this.nextLayer.size;for(let ar of this.chunk)or+=ar.value.length;return or}chunkEnd(or){return this.chunkPos[or]+this.chunk[or].length}update(or){let{add:ar=[],sort:cr=!1,filterFrom:ur=0,filterTo:hr=this.length}=or,fr=or.filter;if(ar.length==0&&!fr)return this;if(cr&&(ar=ar.slice().sort(cmpRange)),this.isEmpty)return ar.length?RangeSet.of(ar):this;let dr=new LayerCursor(this,null,-1).goto(0),pr=0,mr=[],gr=new RangeSetBuilder;for(;dr.value||pr<ar.length;)if(pr<ar.length&&(dr.from-ar[pr].from||dr.startSide-ar[pr].value.startSide)>=0){let yr=ar[pr++];gr.addInner(yr.from,yr.to,yr.value)||mr.push(yr)}else dr.rangeIndex==1&&dr.chunkIndex<this.chunk.length&&(pr==ar.length||this.chunkEnd(dr.chunkIndex)<ar[pr].from)&&(!fr||ur>this.chunkEnd(dr.chunkIndex)||hr<this.chunkPos[dr.chunkIndex])&&gr.addChunk(this.chunkPos[dr.chunkIndex],this.chunk[dr.chunkIndex])?dr.nextChunk():((!fr||ur>dr.to||hr<dr.from||fr(dr.from,dr.to,dr.value))&&(gr.addInner(dr.from,dr.to,dr.value)||mr.push(Range$1.create(dr.from,dr.to,dr.value))),dr.next());return gr.finishInner(this.nextLayer.isEmpty&&!mr.length?RangeSet.empty:this.nextLayer.update({add:mr,filter:fr,filterFrom:ur,filterTo:hr}))}map(or){if(or.empty||this.isEmpty)return this;let ar=[],cr=[],ur=-1;for(let fr=0;fr<this.chunk.length;fr++){let dr=this.chunkPos[fr],pr=this.chunk[fr],mr=or.touchesRange(dr,dr+pr.length);if(mr===!1)ur=Math.max(ur,pr.maxPoint),ar.push(pr),cr.push(or.mapPos(dr));else if(mr===!0){let{mapped:gr,pos:yr}=pr.map(dr,or);gr&&(ur=Math.max(ur,gr.maxPoint),ar.push(gr),cr.push(yr))}}let hr=this.nextLayer.map(or);return ar.length==0?hr:new RangeSet(cr,ar,hr||RangeSet.empty,ur)}between(or,ar,cr){if(!this.isEmpty){for(let ur=0;ur<this.chunk.length;ur++){let hr=this.chunkPos[ur],fr=this.chunk[ur];if(ar>=hr&&or<=hr+fr.length&&fr.between(hr,or-hr,ar-hr,cr)===!1)return}this.nextLayer.between(or,ar,cr)}}iter(or=0){return HeapCursor.from([this]).goto(or)}get isEmpty(){return this.nextLayer==this}static iter(or,ar=0){return HeapCursor.from(or).goto(ar)}static compare(or,ar,cr,ur,hr=-1){let fr=or.filter(yr=>yr.maxPoint>0||!yr.isEmpty&&yr.maxPoint>=hr),dr=ar.filter(yr=>yr.maxPoint>0||!yr.isEmpty&&yr.maxPoint>=hr),pr=findSharedChunks(fr,dr,cr),mr=new SpanCursor(fr,pr,hr),gr=new SpanCursor(dr,pr,hr);cr.iterGaps((yr,br,Or)=>compare(mr,yr,gr,br,Or,ur)),cr.empty&&cr.length==0&&compare(mr,0,gr,0,0,ur)}static eq(or,ar,cr=0,ur){ur==null&&(ur=1e9-1);let hr=or.filter(gr=>!gr.isEmpty&&ar.indexOf(gr)<0),fr=ar.filter(gr=>!gr.isEmpty&&or.indexOf(gr)<0);if(hr.length!=fr.length)return!1;if(!hr.length)return!0;let dr=findSharedChunks(hr,fr),pr=new SpanCursor(hr,dr,0).goto(cr),mr=new SpanCursor(fr,dr,0).goto(cr);for(;;){if(pr.to!=mr.to||!sameValues(pr.active,mr.active)||pr.point&&(!mr.point||!pr.point.eq(mr.point)))return!1;if(pr.to>ur)return!0;pr.next(),mr.next()}}static spans(or,ar,cr,ur,hr=-1){let fr=new SpanCursor(or,null,hr).goto(ar),dr=ar,pr=fr.openStart;for(;;){let mr=Math.min(fr.to,cr);if(fr.point){let gr=fr.activeForPoint(fr.to),yr=fr.pointFrom<ar?gr.length+1:Math.min(gr.length,pr);ur.point(dr,mr,fr.point,gr,yr,fr.pointRank),pr=Math.min(fr.openEnd(mr),gr.length)}else mr>dr&&(ur.span(dr,mr,fr.active,pr),pr=fr.openEnd(mr));if(fr.to>cr)return pr+(fr.point&&fr.to>cr?1:0);dr=fr.to,fr.next()}}static of(or,ar=!1){let cr=new RangeSetBuilder;for(let ur of or instanceof Range$1?[or]:ar?lazySort(or):or)cr.add(ur.from,ur.to,ur.value);return cr.finish()}}RangeSet.empty=new RangeSet([],[],null,-1);function lazySort(lr){if(lr.length>1)for(let or=lr[0],ar=1;ar<lr.length;ar++){let cr=lr[ar];if(cmpRange(or,cr)>0)return lr.slice().sort(cmpRange);or=cr}return lr}RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{finishChunk(or){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,or&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(or,ar,cr){this.addInner(or,ar,cr)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(or,ar,cr)}addInner(or,ar,cr){let ur=or-this.lastTo||cr.startSide-this.last.endSide;if(ur<=0&&(or-this.lastFrom||cr.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return ur<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=or),this.from.push(or-this.chunkStart),this.to.push(ar-this.chunkStart),this.last=cr,this.lastFrom=or,this.lastTo=ar,this.value.push(cr),cr.point&&(this.maxPoint=Math.max(this.maxPoint,ar-or)),!0)}addChunk(or,ar){if((or-this.lastTo||ar.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,ar.maxPoint),this.chunks.push(ar),this.chunkPos.push(or);let cr=ar.value.length-1;return this.last=ar.value[cr],this.lastFrom=ar.from[cr]+or,this.lastTo=ar.to[cr]+or,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(or){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return or;let ar=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(or):or,this.setMaxPoint);return this.from=null,ar}}function findSharedChunks(lr,or,ar){let cr=new Map;for(let hr of lr)for(let fr=0;fr<hr.chunk.length;fr++)hr.chunk[fr].maxPoint<=0&&cr.set(hr.chunk[fr],hr.chunkPos[fr]);let ur=new Set;for(let hr of or)for(let fr=0;fr<hr.chunk.length;fr++){let dr=cr.get(hr.chunk[fr]);dr!=null&&(ar?ar.mapPos(dr):dr)==hr.chunkPos[fr]&&!(ar!=null&&ar.touchesRange(dr,dr+hr.chunk[fr].length))&&ur.add(hr.chunk[fr])}return ur}class LayerCursor{constructor(or,ar,cr,ur=0){this.layer=or,this.skip=ar,this.minPoint=cr,this.rank=ur}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(or,ar=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(or,ar,!1),this}gotoInner(or,ar,cr){for(;this.chunkIndex<this.layer.chunk.length;){let ur=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(ur)||this.layer.chunkEnd(this.chunkIndex)<or||ur.maxPoint<this.minPoint))break;this.chunkIndex++,cr=!1}if(this.chunkIndex<this.layer.chunk.length){let ur=this.layer.chunk[this.chunkIndex].findIndex(or-this.layer.chunkPos[this.chunkIndex],ar,!0);(!cr||this.rangeIndex<ur)&&this.setRangeIndex(ur)}this.next()}forward(or,ar){(this.to-or||this.endSide-ar)<0&&this.gotoInner(or,ar,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let or=this.layer.chunkPos[this.chunkIndex],ar=this.layer.chunk[this.chunkIndex],cr=or+ar.from[this.rangeIndex];if(this.from=cr,this.to=or+ar.to[this.rangeIndex],this.value=ar.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(or){if(or==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=or}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(or){return this.from-or.from||this.startSide-or.startSide||this.rank-or.rank||this.to-or.to||this.endSide-or.endSide}}class HeapCursor{constructor(or){this.heap=or}static from(or,ar=null,cr=-1){let ur=[];for(let hr=0;hr<or.length;hr++)for(let fr=or[hr];!fr.isEmpty;fr=fr.nextLayer)fr.maxPoint>=cr&&ur.push(new LayerCursor(fr,ar,cr,hr));return ur.length==1?ur[0]:new HeapCursor(ur)}get startSide(){return this.value?this.value.startSide:0}goto(or,ar=-1e9){for(let cr of this.heap)cr.goto(or,ar);for(let cr=this.heap.length>>1;cr>=0;cr--)heapBubble(this.heap,cr);return this.next(),this}forward(or,ar){for(let cr of this.heap)cr.forward(or,ar);for(let cr=this.heap.length>>1;cr>=0;cr--)heapBubble(this.heap,cr);(this.to-or||this.value.endSide-ar)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let or=this.heap[0];this.from=or.from,this.to=or.to,this.value=or.value,this.rank=or.rank,or.value&&or.next(),heapBubble(this.heap,0)}}}function heapBubble(lr,or){for(let ar=lr[or];;){let cr=(or<<1)+1;if(cr>=lr.length)break;let ur=lr[cr];if(cr+1<lr.length&&ur.compare(lr[cr+1])>=0&&(ur=lr[cr+1],cr++),ar.compare(ur)<0)break;lr[cr]=ar,lr[or]=ur,or=cr}}class SpanCursor{constructor(or,ar,cr){this.minPoint=cr,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(or,ar,cr)}goto(or,ar=-1e9){return this.cursor.goto(or,ar),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=or,this.endSide=ar,this.openStart=-1,this.next(),this}forward(or,ar){for(;this.minActive>-1&&(this.activeTo[this.minActive]-or||this.active[this.minActive].endSide-ar)<0;)this.removeActive(this.minActive);this.cursor.forward(or,ar)}removeActive(or){remove$1(this.active,or),remove$1(this.activeTo,or),remove$1(this.activeRank,or),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(or){let ar=0,{value:cr,to:ur,rank:hr}=this.cursor;for(;ar<this.activeRank.length&&this.activeRank[ar]<=hr;)ar++;insert(this.active,ar,cr),insert(this.activeTo,ar,ur),insert(this.activeRank,ar,hr),or&&insert(or,ar,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let or=this.to,ar=this.point;this.point=null;let cr=this.openStart<0?[]:null;for(;;){let ur=this.minActive;if(ur>-1&&(this.activeTo[ur]-this.cursor.from||this.active[ur].endSide-this.cursor.startSide)<0){if(this.activeTo[ur]>or){this.to=this.activeTo[ur],this.endSide=this.active[ur].endSide;break}this.removeActive(ur),cr&&remove$1(cr,ur)}else if(this.cursor.value)if(this.cursor.from>or){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let hr=this.cursor.value;if(!hr.point)this.addActive(cr),this.cursor.next();else if(ar&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=hr,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=hr.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(cr){this.openStart=0;for(let ur=cr.length-1;ur>=0&&cr[ur]<or;ur--)this.openStart++}}activeForPoint(or){if(!this.active.length)return this.active;let ar=[];for(let cr=this.active.length-1;cr>=0&&!(this.activeRank[cr]<this.pointRank);cr--)(this.activeTo[cr]>or||this.activeTo[cr]==or&&this.active[cr].endSide>=this.point.endSide)&&ar.push(this.active[cr]);return ar.reverse()}openEnd(or){let ar=0;for(let cr=this.activeTo.length-1;cr>=0&&this.activeTo[cr]>or;cr--)ar++;return ar}}function compare(lr,or,ar,cr,ur,hr){lr.goto(or),ar.goto(cr);let fr=cr+ur,dr=cr,pr=cr-or;for(;;){let mr=lr.to+pr-ar.to||lr.endSide-ar.endSide,gr=mr<0?lr.to+pr:ar.to,yr=Math.min(gr,fr);if(lr.point||ar.point?lr.point&&ar.point&&(lr.point==ar.point||lr.point.eq(ar.point))&&sameValues(lr.activeForPoint(lr.to),ar.activeForPoint(ar.to))||hr.comparePoint(dr,yr,lr.point,ar.point):yr>dr&&!sameValues(lr.active,ar.active)&&hr.compareRange(dr,yr,lr.active,ar.active),gr>fr)break;dr=gr,mr<=0&&lr.next(),mr>=0&&ar.next()}}function sameValues(lr,or){if(lr.length!=or.length)return!1;for(let ar=0;ar<lr.length;ar++)if(lr[ar]!=or[ar]&&!lr[ar].eq(or[ar]))return!1;return!0}function remove$1(lr,or){for(let ar=or,cr=lr.length-1;ar<cr;ar++)lr[ar]=lr[ar+1];lr.pop()}function insert(lr,or,ar){for(let cr=lr.length-1;cr>=or;cr--)lr[cr+1]=lr[cr];lr[or]=ar}function findMinIndex(lr,or){let ar=-1,cr=1e9;for(let ur=0;ur<or.length;ur++)(or[ur]-cr||lr[ur].endSide-lr[ar].endSide)<0&&(ar=ur,cr=or[ur]);return ar}function countColumn(lr,or,ar=lr.length){let cr=0;for(let ur=0;ur<ar;)lr.charCodeAt(ur)==9?(cr+=or-cr%or,ur++):(cr++,ur=findClusterBreak(lr,ur));return cr}function findColumn(lr,or,ar,cr){for(let ur=0,hr=0;;){if(hr>=or)return ur;if(ur==lr.length)break;hr+=lr.charCodeAt(ur)==9?ar-hr%ar:1,ur=findClusterBreak(lr,ur)}return cr===!0?-1:lr.length}const C$1="ͼ",COUNT=typeof Symbol>"u"?"__"+C$1:Symbol.for(C$1),SET=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),top=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class StyleModule{constructor(or,ar){this.rules=[];let{finish:cr}=ar||{};function ur(fr){return/^@/.test(fr)?[fr]:fr.split(/,\s*/)}function hr(fr,dr,pr,mr){let gr=[],yr=/^@(\w+)\b/.exec(fr[0]),br=yr&&yr[1]=="keyframes";if(yr&&dr==null)return pr.push(fr[0]+";");for(let Or in dr){let _r=dr[Or];if(/&/.test(Or))hr(Or.split(/,\s*/).map(vr=>fr.map(xr=>vr.replace(/&/,xr))).reduce((vr,xr)=>vr.concat(xr)),_r,pr);else if(_r&&typeof _r=="object"){if(!yr)throw new RangeError("The value of a property ("+Or+") should be a primitive value.");hr(ur(Or),_r,gr,br)}else _r!=null&&gr.push(Or.replace(/_.*/,"").replace(/[A-Z]/g,vr=>"-"+vr.toLowerCase())+": "+_r+";")}(gr.length||br)&&pr.push((cr&&!yr&&!mr?fr.map(cr):fr).join(", ")+" {"+gr.join(" ")+"}")}for(let fr in or)hr(ur(fr),or[fr],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let or=top[COUNT]||1;return top[COUNT]=or+1,C$1+or.toString(36)}static mount(or,ar,cr){let ur=or[SET],hr=cr&&cr.nonce;ur?hr&&ur.setNonce(hr):ur=new StyleSet(or,hr),ur.mount(Array.isArray(ar)?ar:[ar])}}let adoptedSet=new Map;class StyleSet{constructor(or,ar){let cr=or.ownerDocument||or,ur=cr.defaultView;if(!or.head&&or.adoptedStyleSheets&&ur.CSSStyleSheet){let hr=adoptedSet.get(cr);if(hr)return or.adoptedStyleSheets=[hr.sheet,...or.adoptedStyleSheets],or[SET]=hr;this.sheet=new ur.CSSStyleSheet,or.adoptedStyleSheets=[this.sheet,...or.adoptedStyleSheets],adoptedSet.set(cr,this)}else{this.styleTag=cr.createElement("style"),ar&&this.styleTag.setAttribute("nonce",ar);let hr=or.head||or;hr.insertBefore(this.styleTag,hr.firstChild)}this.modules=[],or[SET]=this}mount(or){let ar=this.sheet,cr=0,ur=0;for(let hr=0;hr<or.length;hr++){let fr=or[hr],dr=this.modules.indexOf(fr);if(dr<ur&&dr>-1&&(this.modules.splice(dr,1),ur--,dr=-1),dr==-1){if(this.modules.splice(ur++,0,fr),ar)for(let pr=0;pr<fr.rules.length;pr++)ar.insertRule(fr.rules[pr],cr++)}else{for(;ur<dr;)cr+=this.modules[ur++].rules.length;cr+=fr.rules.length,ur++}}if(!ar){let hr="";for(let fr=0;fr<this.modules.length;fr++)hr+=this.modules[fr].getRules()+`
`;this.styleTag.textContent=hr}}setNonce(or){this.styleTag&&this.styleTag.getAttribute("nonce")!=or&&this.styleTag.setAttribute("nonce",or)}}var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mac=typeof navigator<"u"&&/Mac/.test(navigator.platform),ie$3=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var i$2=0;i$2<10;i$2++)base[48+i$2]=base[96+i$2]=String(i$2);for(var i$2=1;i$2<=24;i$2++)base[i$2+111]="F"+i$2;for(var i$2=65;i$2<=90;i$2++)base[i$2]=String.fromCharCode(i$2+32),shift[i$2]=String.fromCharCode(i$2);for(var code in base)shift.hasOwnProperty(code)||(shift[code]=base[code]);function keyName(lr){var or=mac&&lr.metaKey&&lr.shiftKey&&!lr.ctrlKey&&!lr.altKey||ie$3&&lr.shiftKey&&lr.key&&lr.key.length==1||lr.key=="Unidentified",ar=!or&&lr.key||(lr.shiftKey?shift:base)[lr.keyCode]||lr.key||"Unidentified";return ar=="Esc"&&(ar="Escape"),ar=="Del"&&(ar="Delete"),ar=="Left"&&(ar="ArrowLeft"),ar=="Up"&&(ar="ArrowUp"),ar=="Right"&&(ar="ArrowRight"),ar=="Down"&&(ar="ArrowDown"),ar}function getSelection(lr){let or;return lr.nodeType==11?or=lr.getSelection?lr:lr.ownerDocument:or=lr,or.getSelection()}function contains$1(lr,or){return or?lr==or||lr.contains(or.nodeType!=1?or.parentNode:or):!1}function deepActiveElement(lr){let or=lr.activeElement;for(;or&&or.shadowRoot;)or=or.shadowRoot.activeElement;return or}function hasSelection(lr,or){if(!or.anchorNode)return!1;try{return contains$1(lr,or.anchorNode)}catch{return!1}}function clientRectsFor(lr){return lr.nodeType==3?textRange(lr,0,lr.nodeValue.length).getClientRects():lr.nodeType==1?lr.getClientRects():[]}function isEquivalentPosition(lr,or,ar,cr){return ar?scanFor(lr,or,ar,cr,-1)||scanFor(lr,or,ar,cr,1):!1}function domIndex(lr){for(var or=0;;or++)if(lr=lr.previousSibling,!lr)return or}function scanFor(lr,or,ar,cr,ur){for(;;){if(lr==ar&&or==cr)return!0;if(or==(ur<0?0:maxOffset(lr))){if(lr.nodeName=="DIV")return!1;let hr=lr.parentNode;if(!hr||hr.nodeType!=1)return!1;or=domIndex(lr)+(ur<0?0:1),lr=hr}else if(lr.nodeType==1){if(lr=lr.childNodes[or+(ur<0?-1:0)],lr.nodeType==1&&lr.contentEditable=="false")return!1;or=ur<0?maxOffset(lr):0}else return!1}}function maxOffset(lr){return lr.nodeType==3?lr.nodeValue.length:lr.childNodes.length}function flattenRect(lr,or){let ar=or?lr.left:lr.right;return{left:ar,right:ar,top:lr.top,bottom:lr.bottom}}function windowRect(lr){return{left:0,right:lr.innerWidth,top:0,bottom:lr.innerHeight}}function scrollRectIntoView(lr,or,ar,cr,ur,hr,fr,dr){let pr=lr.ownerDocument,mr=pr.defaultView||window;for(let gr=lr,yr=!1;gr&&!yr;)if(gr.nodeType==1){let br,Or=gr==pr.body,_r=1,vr=1;if(Or)br=windowRect(mr);else{if(/^(fixed|sticky)$/.test(getComputedStyle(gr).position)&&(yr=!0),gr.scrollHeight<=gr.clientHeight&&gr.scrollWidth<=gr.clientWidth){gr=gr.assignedSlot||gr.parentNode;continue}let kr=gr.getBoundingClientRect();_r=kr.width/gr.offsetWidth,vr=kr.height/gr.offsetHeight,br={left:kr.left,right:kr.left+gr.clientWidth*_r,top:kr.top,bottom:kr.top+gr.clientHeight*vr}}let xr=0,wr=0;if(ur=="nearest")or.top<br.top?(wr=-(br.top-or.top+fr),ar>0&&or.bottom>br.bottom+wr&&(wr=or.bottom-br.bottom+wr+fr)):or.bottom>br.bottom&&(wr=or.bottom-br.bottom+fr,ar<0&&or.top-wr<br.top&&(wr=-(br.top+wr-or.top+fr)));else{let kr=or.bottom-or.top,Cr=br.bottom-br.top;wr=(ur=="center"&&kr<=Cr?or.top+kr/2-Cr/2:ur=="start"||ur=="center"&&ar<0?or.top-fr:or.bottom-Cr+fr)-br.top}if(cr=="nearest"?or.left<br.left?(xr=-(br.left-or.left+hr),ar>0&&or.right>br.right+xr&&(xr=or.right-br.right+xr+hr)):or.right>br.right&&(xr=or.right-br.right+hr,ar<0&&or.left<br.left+xr&&(xr=-(br.left+xr-or.left+hr))):xr=(cr=="center"?or.left+(or.right-or.left)/2-(br.right-br.left)/2:cr=="start"==dr?or.left-hr:or.right-(br.right-br.left)+hr)-br.left,xr||wr)if(Or)mr.scrollBy(xr,wr);else{let kr=0,Cr=0;if(wr){let $r=gr.scrollTop;gr.scrollTop+=wr/vr,Cr=(gr.scrollTop-$r)*vr}if(xr){let $r=gr.scrollLeft;gr.scrollLeft+=xr/_r,kr=(gr.scrollLeft-$r)*_r}or={left:or.left-kr,top:or.top-Cr,right:or.right-kr,bottom:or.bottom-Cr},kr&&Math.abs(kr-xr)<1&&(cr="nearest"),Cr&&Math.abs(Cr-wr)<1&&(ur="nearest")}if(Or)break;gr=gr.assignedSlot||gr.parentNode}else if(gr.nodeType==11)gr=gr.host;else break}function scrollableParent(lr){let or=lr.ownerDocument;for(let ar=lr.parentNode;ar&&ar!=or.body;)if(ar.nodeType==1){if(ar.scrollHeight>ar.clientHeight||ar.scrollWidth>ar.clientWidth)return ar;ar=ar.assignedSlot||ar.parentNode}else if(ar.nodeType==11)ar=ar.host;else break;return null}class DOMSelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(or){return this.anchorNode==or.anchorNode&&this.anchorOffset==or.anchorOffset&&this.focusNode==or.focusNode&&this.focusOffset==or.focusOffset}setRange(or){let{anchorNode:ar,focusNode:cr}=or;this.set(ar,Math.min(or.anchorOffset,ar?maxOffset(ar):0),cr,Math.min(or.focusOffset,cr?maxOffset(cr):0))}set(or,ar,cr,ur){this.anchorNode=or,this.anchorOffset=ar,this.focusNode=cr,this.focusOffset=ur}}let preventScrollSupported=null;function focusPreventScroll(lr){if(lr.setActive)return lr.setActive();if(preventScrollSupported)return lr.focus(preventScrollSupported);let or=[];for(let ar=lr;ar&&(or.push(ar,ar.scrollTop,ar.scrollLeft),ar!=ar.ownerDocument);ar=ar.parentNode);if(lr.focus(preventScrollSupported==null?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),!preventScrollSupported){preventScrollSupported=!1;for(let ar=0;ar<or.length;){let cr=or[ar++],ur=or[ar++],hr=or[ar++];cr.scrollTop!=ur&&(cr.scrollTop=ur),cr.scrollLeft!=hr&&(cr.scrollLeft=hr)}}}let scratchRange;function textRange(lr,or,ar=or){let cr=scratchRange||(scratchRange=document.createRange());return cr.setEnd(lr,ar),cr.setStart(lr,or),cr}function dispatchKey(lr,or,ar){let cr={key:or,code:or,keyCode:ar,which:ar,cancelable:!0},ur=new KeyboardEvent("keydown",cr);ur.synthetic=!0,lr.dispatchEvent(ur);let hr=new KeyboardEvent("keyup",cr);return hr.synthetic=!0,lr.dispatchEvent(hr),ur.defaultPrevented||hr.defaultPrevented}function getRoot(lr){for(;lr;){if(lr&&(lr.nodeType==9||lr.nodeType==11&&lr.host))return lr;lr=lr.assignedSlot||lr.parentNode}return null}function clearAttributes(lr){for(;lr.attributes.length;)lr.removeAttributeNode(lr.attributes[0])}function atElementStart(lr,or){let ar=or.focusNode,cr=or.focusOffset;if(!ar||or.anchorNode!=ar||or.anchorOffset!=cr)return!1;for(cr=Math.min(cr,maxOffset(ar));;)if(cr){if(ar.nodeType!=1)return!1;let ur=ar.childNodes[cr-1];ur.contentEditable=="false"?cr--:(ar=ur,cr=maxOffset(ar))}else{if(ar==lr)return!0;cr=domIndex(ar),ar=ar.parentNode}}function isScrolledToBottom(lr){return lr.scrollTop>Math.max(1,lr.scrollHeight-lr.clientHeight-4)}class DOMPos{constructor(or,ar,cr=!0){this.node=or,this.offset=ar,this.precise=cr}static before(or,ar){return new DOMPos(or.parentNode,domIndex(or),ar)}static after(or,ar){return new DOMPos(or.parentNode,domIndex(or)+1,ar)}}const noChildren=[];class ContentView{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(or){let ar=this.posAtStart;for(let cr of this.children){if(cr==or)return ar;ar+=cr.length+cr.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(or){return this.posBefore(or)+or.length}sync(or,ar){if(this.flags&2){let cr=this.dom,ur=null,hr;for(let fr of this.children){if(fr.flags&7){if(!fr.dom&&(hr=ur?ur.nextSibling:cr.firstChild)){let dr=ContentView.get(hr);(!dr||!dr.parent&&dr.canReuseDOM(fr))&&fr.reuseDOM(hr)}fr.sync(or,ar),fr.flags&=-8}if(hr=ur?ur.nextSibling:cr.firstChild,ar&&!ar.written&&ar.node==cr&&hr!=fr.dom&&(ar.written=!0),fr.dom.parentNode==cr)for(;hr&&hr!=fr.dom;)hr=rm$1(hr);else cr.insertBefore(fr.dom,hr);ur=fr.dom}for(hr=ur?ur.nextSibling:cr.firstChild,hr&&ar&&ar.node==cr&&(ar.written=!0);hr;)hr=rm$1(hr)}else if(this.flags&1)for(let cr of this.children)cr.flags&7&&(cr.sync(or,ar),cr.flags&=-8)}reuseDOM(or){}localPosFromDOM(or,ar){let cr;if(or==this.dom)cr=this.dom.childNodes[ar];else{let ur=maxOffset(or)==0?0:ar==0?-1:1;for(;;){let hr=or.parentNode;if(hr==this.dom)break;ur==0&&hr.firstChild!=hr.lastChild&&(or==hr.firstChild?ur=-1:ur=1),or=hr}ur<0?cr=or:cr=or.nextSibling}if(cr==this.dom.firstChild)return 0;for(;cr&&!ContentView.get(cr);)cr=cr.nextSibling;if(!cr)return this.length;for(let ur=0,hr=0;;ur++){let fr=this.children[ur];if(fr.dom==cr)return hr;hr+=fr.length+fr.breakAfter}}domBoundsAround(or,ar,cr=0){let ur=-1,hr=-1,fr=-1,dr=-1;for(let pr=0,mr=cr,gr=cr;pr<this.children.length;pr++){let yr=this.children[pr],br=mr+yr.length;if(mr<or&&br>ar)return yr.domBoundsAround(or,ar,mr);if(br>=or&&ur==-1&&(ur=pr,hr=mr),mr>ar&&yr.dom.parentNode==this.dom){fr=pr,dr=gr;break}gr=br,mr=br+yr.breakAfter}return{from:hr,to:dr<0?cr+this.length:dr,startDOM:(ur?this.children[ur-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:fr<this.children.length&&fr>=0?this.children[fr].dom:null}}markDirty(or=!1){this.flags|=2,this.markParentsDirty(or)}markParentsDirty(or){for(let ar=this.parent;ar;ar=ar.parent){if(or&&(ar.flags|=2),ar.flags&1)return;ar.flags|=1,or=!1}}setParent(or){this.parent!=or&&(this.parent=or,this.flags&7&&this.markParentsDirty(!0))}setDOM(or){this.dom&&(this.dom.cmView=null),this.dom=or,or.cmView=this}get rootView(){for(let or=this;;){let ar=or.parent;if(!ar)return or;or=ar}}replaceChildren(or,ar,cr=noChildren){this.markDirty();for(let ur=or;ur<ar;ur++){let hr=this.children[ur];hr.parent==this&&hr.destroy()}this.children.splice(or,ar-or,...cr);for(let ur=0;ur<cr.length;ur++)cr[ur].setParent(this)}ignoreMutation(or){return!1}ignoreEvent(or){return!1}childCursor(or=this.length){return new ChildCursor(this.children,or,this.children.length)}childPos(or,ar=1){return this.childCursor().findPos(or,ar)}toString(){let or=this.constructor.name.replace("View","");return or+(this.children.length?"("+this.children.join()+")":this.length?"["+(or=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(or){return or.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(or,ar,cr,ur,hr,fr){return!1}become(or){return!1}canReuseDOM(or){return or.constructor==this.constructor&&!((this.flags|or.flags)&8)}getSide(){return 0}destroy(){this.parent=null}}ContentView.prototype.breakAfter=0;function rm$1(lr){let or=lr.nextSibling;return lr.parentNode.removeChild(lr),or}class ChildCursor{constructor(or,ar,cr){this.children=or,this.pos=ar,this.i=cr,this.off=0}findPos(or,ar=1){for(;;){if(or>this.pos||or==this.pos&&(ar>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=or-this.pos,this;let cr=this.children[--this.i];this.pos-=cr.length+cr.breakAfter}}}function replaceRange(lr,or,ar,cr,ur,hr,fr,dr,pr){let{children:mr}=lr,gr=mr.length?mr[or]:null,yr=hr.length?hr[hr.length-1]:null,br=yr?yr.breakAfter:fr;if(!(or==cr&&gr&&!fr&&!br&&hr.length<2&&gr.merge(ar,ur,hr.length?yr:null,ar==0,dr,pr))){if(cr<mr.length){let Or=mr[cr];Or&&ur<Or.length?(or==cr&&(Or=Or.split(ur),ur=0),!br&&yr&&Or.merge(0,ur,yr,!0,0,pr)?hr[hr.length-1]=Or:(ur&&Or.merge(0,ur,null,!1,0,pr),hr.push(Or))):Or!=null&&Or.breakAfter&&(yr?yr.breakAfter=1:fr=1),cr++}for(gr&&(gr.breakAfter=fr,ar>0&&(!fr&&hr.length&&gr.merge(ar,gr.length,hr[0],!1,dr,0)?gr.breakAfter=hr.shift().breakAfter:(ar<gr.length||gr.children.length&&gr.children[gr.children.length-1].length==0)&&gr.merge(ar,gr.length,null,!1,dr,0),or++));or<cr&&hr.length;)if(mr[cr-1].become(hr[hr.length-1]))cr--,hr.pop(),pr=hr.length?0:dr;else if(mr[or].become(hr[0]))or++,hr.shift(),dr=hr.length?0:pr;else break;!hr.length&&or&&cr<mr.length&&!mr[or-1].breakAfter&&mr[cr].merge(0,0,mr[or-1],!1,dr,pr)&&or--,(or<cr||hr.length)&&lr.replaceChildren(or,cr,hr)}}function mergeChildrenInto(lr,or,ar,cr,ur,hr){let fr=lr.childCursor(),{i:dr,off:pr}=fr.findPos(ar,1),{i:mr,off:gr}=fr.findPos(or,-1),yr=or-ar;for(let br of cr)yr+=br.length;lr.length+=yr,replaceRange(lr,mr,gr,dr,pr,cr,0,ur,hr)}const LineBreakPlaceholder="￿";class DOMReader{constructor(or,ar){this.points=or,this.text="",this.lineSeparator=ar.facet(EditorState.lineSeparator)}append(or){this.text+=or}lineBreak(){this.text+=LineBreakPlaceholder}readRange(or,ar){if(!or)return this;let cr=or.parentNode;for(let ur=or;;){this.findPointBefore(cr,ur);let hr=this.text.length;this.readNode(ur);let fr=ur.nextSibling;if(fr==ar)break;let dr=ContentView.get(ur),pr=ContentView.get(fr);(dr&&pr?dr.breakAfter:(dr?dr.breakAfter:isBlockElement(ur))||isBlockElement(fr)&&(ur.nodeName!="BR"||ur.cmIgnore)&&this.text.length>hr)&&this.lineBreak(),ur=fr}return this.findPointBefore(cr,ar),this}readTextNode(or){let ar=or.nodeValue;for(let cr of this.points)cr.node==or&&(cr.pos=this.text.length+Math.min(cr.offset,ar.length));for(let cr=0,ur=this.lineSeparator?null:/\r\n?|\n/g;;){let hr=-1,fr=1,dr;if(this.lineSeparator?(hr=ar.indexOf(this.lineSeparator,cr),fr=this.lineSeparator.length):(dr=ur.exec(ar))&&(hr=dr.index,fr=dr[0].length),this.append(ar.slice(cr,hr<0?ar.length:hr)),hr<0)break;if(this.lineBreak(),fr>1)for(let pr of this.points)pr.node==or&&pr.pos>this.text.length&&(pr.pos-=fr-1);cr=hr+fr}}readNode(or){if(or.cmIgnore)return;let ar=ContentView.get(or),cr=ar&&ar.overrideDOMText;if(cr!=null){this.findPointInside(or,cr.length);for(let ur=cr.iter();!ur.next().done;)ur.lineBreak?this.lineBreak():this.append(ur.value)}else or.nodeType==3?this.readTextNode(or):or.nodeName=="BR"?or.nextSibling&&this.lineBreak():or.nodeType==1&&this.readRange(or.firstChild,null)}findPointBefore(or,ar){for(let cr of this.points)cr.node==or&&or.childNodes[cr.offset]==ar&&(cr.pos=this.text.length)}findPointInside(or,ar){for(let cr of this.points)(or.nodeType==3?cr.node==or:or.contains(cr.node))&&(cr.pos=this.text.length+Math.min(ar,cr.offset))}}function isBlockElement(lr){return lr.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(lr.nodeName)}class DOMPoint{constructor(or,ar){this.node=or,this.offset=ar,this.pos=-1}}let nav=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},doc=typeof document<"u"?document:{documentElement:{style:{}}};const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),ie$2=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie$2&&/gecko\/(\d+)/i.test(nav.userAgent),chrome=!ie$2&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc.documentElement.style,safari=!ie$2&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser$2={mac:ios||/Mac/.test(nav.platform),windows:/Win/.test(nav.platform),linux:/Linux|X11/.test(nav.platform),ie:ie$2,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:0,ios,android:/Android\b/.test(nav.userAgent),webkit,safari,webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const MaxJoinLen=256;class TextView extends ContentView{constructor(or){super(),this.text=or}get length(){return this.text.length}createDOM(or){this.setDOM(or||document.createTextNode(this.text))}sync(or,ar){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(ar&&ar.node==this.dom&&(ar.written=!0),this.dom.nodeValue=this.text)}reuseDOM(or){or.nodeType==3&&this.createDOM(or)}merge(or,ar,cr){return this.flags&8||cr&&(!(cr instanceof TextView)||this.length-(ar-or)+cr.length>MaxJoinLen||cr.flags&8)?!1:(this.text=this.text.slice(0,or)+(cr?cr.text:"")+this.text.slice(ar),this.markDirty(),!0)}split(or){let ar=new TextView(this.text.slice(or));return this.text=this.text.slice(0,or),this.markDirty(),ar.flags|=this.flags&8,ar}localPosFromDOM(or,ar){return or==this.dom?ar:ar?this.text.length:0}domAtPos(or){return new DOMPos(this.dom,or)}domBoundsAround(or,ar,cr){return{from:cr,to:cr+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(or,ar){return textCoords(this.dom,or,ar)}}class MarkView extends ContentView{constructor(or,ar=[],cr=0){super(),this.mark=or,this.children=ar,this.length=cr;for(let ur of ar)ur.setParent(this)}setAttrs(or){if(clearAttributes(or),this.mark.class&&(or.className=this.mark.class),this.mark.attrs)for(let ar in this.mark.attrs)or.setAttribute(ar,this.mark.attrs[ar]);return or}canReuseDOM(or){return super.canReuseDOM(or)&&!((this.flags|or.flags)&8)}reuseDOM(or){or.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(or),this.flags|=6)}sync(or,ar){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(or,ar)}merge(or,ar,cr,ur,hr,fr){return cr&&(!(cr instanceof MarkView&&cr.mark.eq(this.mark))||or&&hr<=0||ar<this.length&&fr<=0)?!1:(mergeChildrenInto(this,or,ar,cr?cr.children:[],hr-1,fr-1),this.markDirty(),!0)}split(or){let ar=[],cr=0,ur=-1,hr=0;for(let dr of this.children){let pr=cr+dr.length;pr>or&&ar.push(cr<or?dr.split(or-cr):dr),ur<0&&cr>=or&&(ur=hr),cr=pr,hr++}let fr=this.length-or;return this.length=or,ur>-1&&(this.children.length=ur,this.markDirty()),new MarkView(this.mark,ar,fr)}domAtPos(or){return inlineDOMAtPos(this,or)}coordsAt(or,ar){return coordsInChildren(this,or,ar)}}function textCoords(lr,or,ar){let cr=lr.nodeValue.length;or>cr&&(or=cr);let ur=or,hr=or,fr=0;or==0&&ar<0||or==cr&&ar>=0?browser$2.chrome||browser$2.gecko||(or?(ur--,fr=1):hr<cr&&(hr++,fr=-1)):ar<0?ur--:hr<cr&&hr++;let dr=textRange(lr,ur,hr).getClientRects();if(!dr.length)return null;let pr=dr[(fr?fr<0:ar>=0)?0:dr.length-1];return browser$2.safari&&!fr&&pr.width==0&&(pr=Array.prototype.find.call(dr,mr=>mr.width)||pr),fr?flattenRect(pr,fr<0):pr||null}class WidgetView extends ContentView{static create(or,ar,cr){return new WidgetView(or,ar,cr)}constructor(or,ar,cr){super(),this.widget=or,this.length=ar,this.side=cr,this.prevWidget=null}split(or){let ar=WidgetView.create(this.widget,this.length-or,this.side);return this.length-=or,ar}sync(or){(!this.dom||!this.widget.updateDOM(this.dom,or))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(or)),this.dom.contentEditable="false")}getSide(){return this.side}merge(or,ar,cr,ur,hr,fr){return cr&&(!(cr instanceof WidgetView)||!this.widget.compare(cr.widget)||or>0&&hr<=0||ar<this.length&&fr<=0)?!1:(this.length=or+(cr?cr.length:0)+(this.length-ar),!0)}become(or){return or instanceof WidgetView&&or.side==this.side&&this.widget.constructor==or.widget.constructor?(this.widget.compare(or.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=or.widget,this.length=or.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(or){return this.widget.ignoreEvent(or)}get overrideDOMText(){if(this.length==0)return Text$2.empty;let or=this;for(;or.parent;)or=or.parent;let{view:ar}=or,cr=ar&&ar.state.doc,ur=this.posAtStart;return cr?cr.slice(ur,ur+this.length):Text$2.empty}domAtPos(or){return(this.length?or==0:this.side>0)?DOMPos.before(this.dom):DOMPos.after(this.dom,or==this.length)}domBoundsAround(){return null}coordsAt(or,ar){let cr=this.widget.coordsAt(this.dom,or,ar);if(cr)return cr;let ur=this.dom.getClientRects(),hr=null;if(!ur.length)return null;let fr=this.side?this.side<0:or>0;for(let dr=fr?ur.length-1:0;hr=ur[dr],!(or>0?dr==0:dr==ur.length-1||hr.top<hr.bottom);dr+=fr?-1:1);return flattenRect(hr,!fr)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class WidgetBufferView extends ContentView{constructor(or){super(),this.side=or}get length(){return 0}merge(){return!1}become(or){return or instanceof WidgetBufferView&&or.side==this.side}split(){return new WidgetBufferView(this.side)}sync(){if(!this.dom){let or=document.createElement("img");or.className="cm-widgetBuffer",or.setAttribute("aria-hidden","true"),this.setDOM(or)}}getSide(){return this.side}domAtPos(or){return this.side>0?DOMPos.before(this.dom):DOMPos.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(or){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Text$2.empty}get isHidden(){return!0}}TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;function inlineDOMAtPos(lr,or){let ar=lr.dom,{children:cr}=lr,ur=0;for(let hr=0;ur<cr.length;ur++){let fr=cr[ur],dr=hr+fr.length;if(!(dr==hr&&fr.getSide()<=0)){if(or>hr&&or<dr&&fr.dom.parentNode==ar)return fr.domAtPos(or-hr);if(or<=hr)break;hr=dr}}for(let hr=ur;hr>0;hr--){let fr=cr[hr-1];if(fr.dom.parentNode==ar)return fr.domAtPos(fr.length)}for(let hr=ur;hr<cr.length;hr++){let fr=cr[hr];if(fr.dom.parentNode==ar)return fr.domAtPos(0)}return new DOMPos(ar,0)}function joinInlineInto(lr,or,ar){let cr,{children:ur}=lr;ar>0&&or instanceof MarkView&&ur.length&&(cr=ur[ur.length-1])instanceof MarkView&&cr.mark.eq(or.mark)?joinInlineInto(cr,or.children[0],ar-1):(ur.push(or),or.setParent(lr)),lr.length+=or.length}function coordsInChildren(lr,or,ar){let cr=null,ur=-1,hr=null,fr=-1;function dr(mr,gr){for(let yr=0,br=0;yr<mr.children.length&&br<=gr;yr++){let Or=mr.children[yr],_r=br+Or.length;_r>=gr&&(Or.children.length?dr(Or,gr-br):(!hr||hr.isHidden&&ar>0)&&(_r>gr||br==_r&&Or.getSide()>0)?(hr=Or,fr=gr-br):(br<gr||br==_r&&Or.getSide()<0&&!Or.isHidden)&&(cr=Or,ur=gr-br)),br=_r}}dr(lr,or);let pr=(ar<0?cr:hr)||cr||hr;return pr?pr.coordsAt(Math.max(0,pr==cr?ur:fr),ar):fallbackRect(lr)}function fallbackRect(lr){let or=lr.dom.lastChild;if(!or)return lr.dom.getBoundingClientRect();let ar=clientRectsFor(or);return ar[ar.length-1]||null}function combineAttrs(lr,or){for(let ar in lr)ar=="class"&&or.class?or.class+=" "+lr.class:ar=="style"&&or.style?or.style+=";"+lr.style:or[ar]=lr[ar];return or}const noAttrs=Object.create(null);function attrsEq(lr,or,ar){if(lr==or)return!0;lr||(lr=noAttrs),or||(or=noAttrs);let cr=Object.keys(lr),ur=Object.keys(or);if(cr.length-(ar&&cr.indexOf(ar)>-1?1:0)!=ur.length-(ar&&ur.indexOf(ar)>-1?1:0))return!1;for(let hr of cr)if(hr!=ar&&(ur.indexOf(hr)==-1||lr[hr]!==or[hr]))return!1;return!0}function updateAttrs(lr,or,ar){let cr=!1;if(or)for(let ur in or)ar&&ur in ar||(cr=!0,ur=="style"?lr.style.cssText="":lr.removeAttribute(ur));if(ar)for(let ur in ar)or&&or[ur]==ar[ur]||(cr=!0,ur=="style"?lr.style.cssText=ar[ur]:lr.setAttribute(ur,ar[ur]));return cr}function getAttrs$1(lr){let or=Object.create(null);for(let ar=0;ar<lr.attributes.length;ar++){let cr=lr.attributes[ar];or[cr.name]=cr.value}return or}class WidgetType{eq(or){return!1}updateDOM(or,ar){return!1}compare(or){return this==or||this.constructor==or.constructor&&this.eq(or)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(or){return!0}coordsAt(or,ar,cr){return null}get isHidden(){return!1}destroy(or){}}var BlockType=function(lr){return lr[lr.Text=0]="Text",lr[lr.WidgetBefore=1]="WidgetBefore",lr[lr.WidgetAfter=2]="WidgetAfter",lr[lr.WidgetRange=3]="WidgetRange",lr}(BlockType||(BlockType={}));class Decoration extends RangeValue{constructor(or,ar,cr,ur){super(),this.startSide=or,this.endSide=ar,this.widget=cr,this.spec=ur}get heightRelevant(){return!1}static mark(or){return new MarkDecoration(or)}static widget(or){let ar=Math.max(-1e4,Math.min(1e4,or.side||0)),cr=!!or.block;return ar+=cr&&!or.inlineOrder?ar>0?3e8:-4e8:ar>0?1e8:-1e8,new PointDecoration(or,ar,ar,cr,or.widget||null,!1)}static replace(or){let ar=!!or.block,cr,ur;if(or.isBlockGap)cr=-5e8,ur=4e8;else{let{start:hr,end:fr}=getInclusive(or,ar);cr=(hr?ar?-3e8:-1:5e8)-1,ur=(fr?ar?2e8:1:-6e8)+1}return new PointDecoration(or,cr,ur,ar,or.widget||null,!0)}static line(or){return new LineDecoration(or)}static set(or,ar=!1){return RangeSet.of(or,ar)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Decoration.none=RangeSet.empty;class MarkDecoration extends Decoration{constructor(or){let{start:ar,end:cr}=getInclusive(or);super(ar?-1:5e8,cr?1:-6e8,null,or),this.tagName=or.tagName||"span",this.class=or.class||"",this.attrs=or.attributes||null}eq(or){var ar,cr;return this==or||or instanceof MarkDecoration&&this.tagName==or.tagName&&(this.class||((ar=this.attrs)===null||ar===void 0?void 0:ar.class))==(or.class||((cr=or.attrs)===null||cr===void 0?void 0:cr.class))&&attrsEq(this.attrs,or.attrs,"class")}range(or,ar=or){if(or>=ar)throw new RangeError("Mark decorations may not be empty");return super.range(or,ar)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(or){super(-2e8,-2e8,null,or)}eq(or){return or instanceof LineDecoration&&this.spec.class==or.spec.class&&attrsEq(this.spec.attributes,or.spec.attributes)}range(or,ar=or){if(ar!=or)throw new RangeError("Line decoration ranges must be zero-length");return super.range(or,ar)}}LineDecoration.prototype.mapMode=MapMode.TrackBefore;LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(or,ar,cr,ur,hr,fr){super(ar,cr,hr,or),this.block=ur,this.isReplace=fr,this.mapMode=ur?ar<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide<this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(or){return or instanceof PointDecoration&&widgetsEq(this.widget,or.widget)&&this.block==or.block&&this.startSide==or.startSide&&this.endSide==or.endSide}range(or,ar=or){if(this.isReplace&&(or>ar||or==ar&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&ar!=or)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(or,ar)}}PointDecoration.prototype.point=!0;function getInclusive(lr,or=!1){let{inclusiveStart:ar,inclusiveEnd:cr}=lr;return ar==null&&(ar=lr.inclusive),cr==null&&(cr=lr.inclusive),{start:ar??or,end:cr??or}}function widgetsEq(lr,or){return lr==or||!!(lr&&or&&lr.compare(or))}function addRange(lr,or,ar,cr=0){let ur=ar.length-1;ur>=0&&ar[ur]+cr>=lr?ar[ur]=Math.max(ar[ur],or):ar.push(lr,or)}class LineView extends ContentView{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(or,ar,cr,ur,hr,fr){if(cr){if(!(cr instanceof LineView))return!1;this.dom||cr.transferDOM(this)}return ur&&this.setDeco(cr?cr.attrs:null),mergeChildrenInto(this,or,ar,cr?cr.children:[],hr,fr),!0}split(or){let ar=new LineView;if(ar.breakAfter=this.breakAfter,this.length==0)return ar;let{i:cr,off:ur}=this.childPos(or);ur&&(ar.append(this.children[cr].split(ur),0),this.children[cr].merge(ur,this.children[cr].length,null,!1,0,0),cr++);for(let hr=cr;hr<this.children.length;hr++)ar.append(this.children[hr],0);for(;cr>0&&this.children[cr-1].length==0;)this.children[--cr].destroy();return this.children.length=cr,this.markDirty(),this.length=or,ar}transferDOM(or){this.dom&&(this.markDirty(),or.setDOM(this.dom),or.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(or){attrsEq(this.attrs,or)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=or)}append(or,ar){joinInlineInto(this,or,ar)}addLineDeco(or){let ar=or.spec.attributes,cr=or.spec.class;ar&&(this.attrs=combineAttrs(ar,this.attrs||{})),cr&&(this.attrs=combineAttrs({class:cr},this.attrs||{}))}domAtPos(or){return inlineDOMAtPos(this,or)}reuseDOM(or){or.nodeName=="DIV"&&(this.setDOM(or),this.flags|=6)}sync(or,ar){var cr;this.dom?this.flags&4&&(clearAttributes(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(updateAttrs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(or,ar);let ur=this.dom.lastChild;for(;ur&&ContentView.get(ur)instanceof MarkView;)ur=ur.lastChild;if(!ur||!this.length||ur.nodeName!="BR"&&((cr=ContentView.get(ur))===null||cr===void 0?void 0:cr.isEditable)==!1&&(!browser$2.ios||!this.children.some(hr=>hr instanceof TextView))){let hr=document.createElement("BR");hr.cmIgnore=!0,this.dom.appendChild(hr)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let or=0,ar;for(let cr of this.children){if(!(cr instanceof TextView)||/[^ -~]/.test(cr.text))return null;let ur=clientRectsFor(cr.dom);if(ur.length!=1)return null;or+=ur[0].width,ar=ur[0].height}return or?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:or/this.length,textHeight:ar}:null}coordsAt(or,ar){let cr=coordsInChildren(this,or,ar);if(!this.children.length&&cr&&this.parent){let{heightOracle:ur}=this.parent.view.viewState,hr=cr.bottom-cr.top;if(Math.abs(hr-ur.lineHeight)<2&&ur.textHeight<hr){let fr=(hr-ur.textHeight)/2;return{top:cr.top+fr,bottom:cr.bottom-fr,left:cr.left,right:cr.left}}}return cr}become(or){return!1}get type(){return BlockType.Text}static find(or,ar){for(let cr=0,ur=0;cr<or.children.length;cr++){let hr=or.children[cr],fr=ur+hr.length;if(fr>=ar){if(hr instanceof LineView)return hr;if(fr>ar)break}ur=fr+hr.breakAfter}return null}}class BlockWidgetView extends ContentView{constructor(or,ar,cr){super(),this.widget=or,this.length=ar,this.type=cr,this.breakAfter=0,this.prevWidget=null}merge(or,ar,cr,ur,hr,fr){return cr&&(!(cr instanceof BlockWidgetView)||!this.widget.compare(cr.widget)||or>0&&hr<=0||ar<this.length&&fr<=0)?!1:(this.length=or+(cr?cr.length:0)+(this.length-ar),!0)}domAtPos(or){return or==0?DOMPos.before(this.dom):DOMPos.after(this.dom,or==this.length)}split(or){let ar=this.length-or;this.length=or;let cr=new BlockWidgetView(this.widget,ar,this.type);return cr.breakAfter=this.breakAfter,cr}get children(){return noChildren}sync(or){(!this.dom||!this.widget.updateDOM(this.dom,or))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(or)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text$2.empty}domBoundsAround(){return null}become(or){return or instanceof BlockWidgetView&&or.widget.constructor==this.widget.constructor?(or.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=or.widget,this.length=or.length,this.type=or.type,this.breakAfter=or.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(or){return this.widget.ignoreEvent(or)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(or,ar){return this.widget.coordsAt(this.dom,or,ar)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ContentBuilder{constructor(or,ar,cr,ur){this.doc=or,this.pos=ar,this.end=cr,this.disallowBlockEffectsFor=ur,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=or.iter(),this.skip=ar}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let or=this.content[this.content.length-1];return!or.breakAfter&&!(or instanceof BlockWidgetView&&or.type==BlockType.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new LineView),this.atCursorPos=!0),this.curLine}flushBuffer(or=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(wrapMarks(new WidgetBufferView(-1),or),or.length),this.pendingBuffer=0)}addBlockWidget(or){this.flushBuffer(),this.curLine=null,this.content.push(or)}finish(or){this.pendingBuffer&&or<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(or,ar,cr){for(;or>0;){if(this.textOff==this.text.length){let{value:hr,lineBreak:fr,done:dr}=this.cursor.next(this.skip);if(this.skip=0,dr)throw new Error("Ran out of text content when drawing inline views");if(fr){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,or--;continue}else this.text=hr,this.textOff=0}let ur=Math.min(this.text.length-this.textOff,or,512);this.flushBuffer(ar.slice(ar.length-cr)),this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+ur)),ar),cr),this.atCursorPos=!0,this.textOff+=ur,or-=ur,cr=0}}span(or,ar,cr,ur){this.buildText(ar-or,cr,ur),this.pos=ar,this.openStart<0&&(this.openStart=ur)}point(or,ar,cr,ur,hr,fr){if(this.disallowBlockEffectsFor[fr]&&cr instanceof PointDecoration){if(cr.block)throw new RangeError("Block decorations may not be specified via plugins");if(ar>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let dr=ar-or;if(cr instanceof PointDecoration)if(cr.block){let{type:pr}=cr;pr==BlockType.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new BlockWidgetView(cr.widget||new NullWidget("div"),dr,pr))}else{let pr=WidgetView.create(cr.widget||new NullWidget("span"),dr,dr?0:cr.startSide),mr=this.atCursorPos&&!pr.isEditable&&hr<=ur.length&&(or<ar||cr.startSide>0),gr=!pr.isEditable&&(or<ar||hr>ur.length||cr.startSide<=0),yr=this.getLine();this.pendingBuffer==2&&!mr&&!pr.isEditable&&(this.pendingBuffer=0),this.flushBuffer(ur),mr&&(yr.append(wrapMarks(new WidgetBufferView(1),ur),hr),hr=ur.length+Math.max(0,hr-ur.length)),yr.append(wrapMarks(pr,ur),hr),this.atCursorPos=gr,this.pendingBuffer=gr?or<ar||hr>ur.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=ur.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(cr);dr&&(this.textOff+dr<=this.text.length?this.textOff+=dr:(this.skip+=dr-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=ar),this.openStart<0&&(this.openStart=hr)}static build(or,ar,cr,ur,hr){let fr=new ContentBuilder(or,ar,cr,hr);return fr.openEnd=RangeSet.spans(ur,ar,cr,fr),fr.openStart<0&&(fr.openStart=fr.openEnd),fr.finish(fr.openEnd),fr}}function wrapMarks(lr,or){for(let ar of or)lr=new MarkView(ar,[lr],lr.length);return lr}class NullWidget extends WidgetType{constructor(or){super(),this.tag=or}eq(or){return or.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(or){return or.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const clickAddsSelectionRange=Facet.define(),dragMovesSelection$1=Facet.define(),mouseSelectionStyle=Facet.define(),exceptionSink=Facet.define(),updateListener=Facet.define(),inputHandler=Facet.define(),focusChangeEffect=Facet.define(),perLineTextDirection=Facet.define({combine:lr=>lr.some(or=>or)}),nativeSelectionHidden=Facet.define({combine:lr=>lr.some(or=>or)});class ScrollTarget{constructor(or,ar="nearest",cr="nearest",ur=5,hr=5){this.range=or,this.y=ar,this.x=cr,this.yMargin=ur,this.xMargin=hr}map(or){return or.empty?this:new ScrollTarget(this.range.map(or),this.y,this.x,this.yMargin,this.xMargin)}}const scrollIntoView=StateEffect.define({map:(lr,or)=>lr.map(or)});function logException(lr,or,ar){let cr=lr.facet(exceptionSink);cr.length?cr[0](or):window.onerror?window.onerror(String(or),ar,void 0,void 0,or):ar?console.error(ar+":",or):console.error(or)}const editable=Facet.define({combine:lr=>lr.length?lr[0]:!0});let nextPluginID=0;const viewPlugin=Facet.define();class ViewPlugin{constructor(or,ar,cr,ur){this.id=or,this.create=ar,this.domEventHandlers=cr,this.extension=ur(this)}static define(or,ar){const{eventHandlers:cr,provide:ur,decorations:hr}=ar||{};return new ViewPlugin(nextPluginID++,or,cr,fr=>{let dr=[viewPlugin.of(fr)];return hr&&dr.push(decorations.of(pr=>{let mr=pr.plugin(fr);return mr?hr(mr):Decoration.none})),ur&&dr.push(ur(fr)),dr})}static fromClass(or,ar){return ViewPlugin.define(cr=>new or(cr),ar)}}class PluginInstance{constructor(or){this.spec=or,this.mustUpdate=null,this.value=null}update(or){if(this.value){if(this.mustUpdate){let ar=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(ar)}catch(cr){if(logException(ar.state,cr,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(or)}catch(ar){logException(or.state,ar,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(or){var ar;if(!((ar=this.value)===null||ar===void 0)&&ar.destroy)try{this.value.destroy()}catch(cr){logException(or.state,cr,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const editorAttributes=Facet.define(),contentAttributes=Facet.define(),decorations=Facet.define(),atomicRanges=Facet.define(),bidiIsolatedRanges=Facet.define();function getIsolatedRanges(lr,or,ar){let cr=lr.state.facet(bidiIsolatedRanges);if(!cr.length)return cr;let ur=cr.map(fr=>fr instanceof Function?fr(lr):fr),hr=[];return RangeSet.spans(ur,or,ar,{point(){},span(fr,dr,pr,mr){let gr=hr;for(let yr=pr.length-1;yr>=0;yr--,mr--){let br=pr[yr].spec.bidiIsolate,Or;if(br!=null)if(mr>0&&gr.length&&(Or=gr[gr.length-1]).to==fr&&Or.direction==br)Or.to=dr,gr=Or.inner;else{let _r={from:fr,to:dr,direction:br,inner:[]};gr.push(_r),gr=_r.inner}}}}),hr}const scrollMargins=Facet.define();function getScrollMargins(lr){let or=0,ar=0,cr=0,ur=0;for(let hr of lr.state.facet(scrollMargins)){let fr=hr(lr);fr&&(fr.left!=null&&(or=Math.max(or,fr.left)),fr.right!=null&&(ar=Math.max(ar,fr.right)),fr.top!=null&&(cr=Math.max(cr,fr.top)),fr.bottom!=null&&(ur=Math.max(ur,fr.bottom)))}return{left:or,right:ar,top:cr,bottom:ur}}const styleModule=Facet.define();class ChangedRange{constructor(or,ar,cr,ur){this.fromA=or,this.toA=ar,this.fromB=cr,this.toB=ur}join(or){return new ChangedRange(Math.min(this.fromA,or.fromA),Math.max(this.toA,or.toA),Math.min(this.fromB,or.fromB),Math.max(this.toB,or.toB))}addToSet(or){let ar=or.length,cr=this;for(;ar>0;ar--){let ur=or[ar-1];if(!(ur.fromA>cr.toA)){if(ur.toA<cr.fromA)break;cr=cr.join(ur),or.splice(ar-1,1)}}return or.splice(ar,0,cr),or}static extendWithRanges(or,ar){if(ar.length==0)return or;let cr=[];for(let ur=0,hr=0,fr=0,dr=0;;ur++){let pr=ur==or.length?null:or[ur],mr=fr-dr,gr=pr?pr.fromB:1e9;for(;hr<ar.length&&ar[hr]<gr;){let yr=ar[hr],br=ar[hr+1],Or=Math.max(dr,yr),_r=Math.min(gr,br);if(Or<=_r&&new ChangedRange(Or+mr,_r+mr,Or,_r).addToSet(cr),br>gr)break;hr+=2}if(!pr)return cr;new ChangedRange(pr.fromA,pr.toA,pr.fromB,pr.toB).addToSet(cr),fr=pr.toA,dr=pr.toB}}}class ViewUpdate{constructor(or,ar,cr){this.view=or,this.state=ar,this.transactions=cr,this.flags=0,this.startState=or.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let hr of cr)this.changes=this.changes.compose(hr.changes);let ur=[];this.changes.iterChangedRanges((hr,fr,dr,pr)=>ur.push(new ChangedRange(hr,fr,dr,pr))),this.changedRanges=ur}static create(or,ar,cr){return new ViewUpdate(or,ar,cr)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(or=>or.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var Direction=function(lr){return lr[lr.LTR=0]="LTR",lr[lr.RTL=1]="RTL",lr}(Direction||(Direction={}));const LTR=Direction.LTR,RTL=Direction.RTL;function dec(lr){let or=[];for(let ar=0;ar<lr.length;ar++)or.push(1<<+lr[ar]);return or}const LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let lr of["()","[]","{}"]){let or=lr.charCodeAt(0),ar=lr.charCodeAt(1);Brackets[or]=ar,Brackets[ar]=-or}function charType(lr){return lr<=247?LowTypes[lr]:1424<=lr&&lr<=1524?2:1536<=lr&&lr<=1785?ArabicTypes[lr-1536]:1774<=lr&&lr<=2220?4:8192<=lr&&lr<=8203?256:64336<=lr&&lr<=65023?4:lr==8204?256:1}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BidiSpan{get dir(){return this.level%2?RTL:LTR}constructor(or,ar,cr){this.from=or,this.to=ar,this.level=cr}side(or,ar){return this.dir==ar==or?this.to:this.from}static find(or,ar,cr,ur){let hr=-1;for(let fr=0;fr<or.length;fr++){let dr=or[fr];if(dr.from<=ar&&dr.to>=ar){if(dr.level==cr)return fr;(hr<0||(ur!=0?ur<0?dr.from<ar:dr.to>ar:or[hr].level>dr.level))&&(hr=fr)}}if(hr<0)throw new RangeError("Index out of range");return hr}}function isolatesEq(lr,or){if(lr.length!=or.length)return!1;for(let ar=0;ar<lr.length;ar++){let cr=lr[ar],ur=or[ar];if(cr.from!=ur.from||cr.to!=ur.to||cr.direction!=ur.direction||!isolatesEq(cr.inner,ur.inner))return!1}return!0}const types$2=[];function computeCharTypes(lr,or,ar,cr,ur){for(let hr=0;hr<=cr.length;hr++){let fr=hr?cr[hr-1].to:or,dr=hr<cr.length?cr[hr].from:ar,pr=hr?256:ur;for(let mr=fr,gr=pr,yr=pr;mr<dr;mr++){let br=charType(lr.charCodeAt(mr));br==512?br=gr:br==8&&yr==4&&(br=16),types$2[mr]=br==4?2:br,br&7&&(yr=br),gr=br}for(let mr=fr,gr=pr,yr=pr;mr<dr;mr++){let br=types$2[mr];if(br==128)mr<dr-1&&gr==types$2[mr+1]&&gr&24?br=types$2[mr]=gr:types$2[mr]=256;else if(br==64){let Or=mr+1;for(;Or<dr&&types$2[Or]==64;)Or++;let _r=mr&&gr==8||Or<ar&&types$2[Or]==8?yr==1?1:8:256;for(let vr=mr;vr<Or;vr++)types$2[vr]=_r;mr=Or-1}else br==8&&yr==1&&(types$2[mr]=1);gr=br,br&7&&(yr=br)}}}function processBracketPairs(lr,or,ar,cr,ur){let hr=ur==1?2:1;for(let fr=0,dr=0,pr=0;fr<=cr.length;fr++){let mr=fr?cr[fr-1].to:or,gr=fr<cr.length?cr[fr].from:ar;for(let yr=mr,br,Or,_r;yr<gr;yr++)if(Or=Brackets[br=lr.charCodeAt(yr)])if(Or<0){for(let vr=dr-3;vr>=0;vr-=3)if(BracketStack[vr+1]==-Or){let xr=BracketStack[vr+2],wr=xr&2?ur:xr&4?xr&1?hr:ur:0;wr&&(types$2[yr]=types$2[BracketStack[vr]]=wr),dr=vr;break}}else{if(BracketStack.length==189)break;BracketStack[dr++]=yr,BracketStack[dr++]=br,BracketStack[dr++]=pr}else if((_r=types$2[yr])==2||_r==1){let vr=_r==ur;pr=vr?0:1;for(let xr=dr-3;xr>=0;xr-=3){let wr=BracketStack[xr+2];if(wr&2)break;if(vr)BracketStack[xr+2]|=2;else{if(wr&4)break;BracketStack[xr+2]|=4}}}}}function processNeutrals(lr,or,ar,cr){for(let ur=0,hr=cr;ur<=ar.length;ur++){let fr=ur?ar[ur-1].to:lr,dr=ur<ar.length?ar[ur].from:or;for(let pr=fr;pr<dr;){let mr=types$2[pr];if(mr==256){let gr=pr+1;for(;;)if(gr==dr){if(ur==ar.length)break;gr=ar[ur++].to,dr=ur<ar.length?ar[ur].from:or}else if(types$2[gr]==256)gr++;else break;let yr=hr==1,br=(gr<or?types$2[gr]:cr)==1,Or=yr==br?yr?1:2:cr;for(let _r=gr,vr=ur,xr=vr?ar[vr-1].to:lr;_r>pr;)_r==xr&&(_r=ar[--vr].from,xr=vr?ar[vr-1].to:lr),types$2[--_r]=Or;pr=gr}else hr=mr,pr++}}}function emitSpans(lr,or,ar,cr,ur,hr,fr){let dr=cr%2?2:1;if(cr%2==ur%2)for(let pr=or,mr=0;pr<ar;){let gr=!0,yr=!1;if(mr==hr.length||pr<hr[mr].from){let vr=types$2[pr];vr!=dr&&(gr=!1,yr=vr==16)}let br=!gr&&dr==1?[]:null,Or=gr?cr:cr+1,_r=pr;e:for(;;)if(mr<hr.length&&_r==hr[mr].from){if(yr)break e;let vr=hr[mr];if(!gr)for(let xr=vr.to,wr=mr+1;;){if(xr==ar)break e;if(wr<hr.length&&hr[wr].from==xr)xr=hr[wr++].to;else{if(types$2[xr]==dr)break e;break}}if(mr++,br)br.push(vr);else{vr.from>pr&&fr.push(new BidiSpan(pr,vr.from,Or));let xr=vr.direction==LTR!=!(Or%2);computeSectionOrder(lr,xr?cr+1:cr,ur,vr.inner,vr.from,vr.to,fr),pr=vr.to}_r=vr.to}else{if(_r==ar||(gr?types$2[_r]!=dr:types$2[_r]==dr))break;_r++}br?emitSpans(lr,pr,_r,cr+1,ur,br,fr):pr<_r&&fr.push(new BidiSpan(pr,_r,Or)),pr=_r}else for(let pr=ar,mr=hr.length;pr>or;){let gr=!0,yr=!1;if(!mr||pr>hr[mr-1].to){let vr=types$2[pr-1];vr!=dr&&(gr=!1,yr=vr==16)}let br=!gr&&dr==1?[]:null,Or=gr?cr:cr+1,_r=pr;e:for(;;)if(mr&&_r==hr[mr-1].to){if(yr)break e;let vr=hr[--mr];if(!gr)for(let xr=vr.from,wr=mr;;){if(xr==or)break e;if(wr&&hr[wr-1].to==xr)xr=hr[--wr].from;else{if(types$2[xr-1]==dr)break e;break}}if(br)br.push(vr);else{vr.to<pr&&fr.push(new BidiSpan(vr.to,pr,Or));let xr=vr.direction==LTR!=!(Or%2);computeSectionOrder(lr,xr?cr+1:cr,ur,vr.inner,vr.from,vr.to,fr),pr=vr.from}_r=vr.from}else{if(_r==or||(gr?types$2[_r-1]!=dr:types$2[_r-1]==dr))break;_r--}br?emitSpans(lr,_r,pr,cr+1,ur,br,fr):_r<pr&&fr.push(new BidiSpan(_r,pr,Or)),pr=_r}}function computeSectionOrder(lr,or,ar,cr,ur,hr,fr){let dr=or%2?2:1;computeCharTypes(lr,ur,hr,cr,dr),processBracketPairs(lr,ur,hr,cr,dr),processNeutrals(ur,hr,cr,dr),emitSpans(lr,ur,hr,or,ar,cr,fr)}function computeOrder(lr,or,ar){if(!lr)return[new BidiSpan(0,0,or==RTL?1:0)];if(or==LTR&&!ar.length&&!BidiRE.test(lr))return trivialOrder(lr.length);if(ar.length)for(;lr.length>types$2.length;)types$2[types$2.length]=256;let cr=[],ur=or==LTR?0:1;return computeSectionOrder(lr,ur,ur,ar,0,lr.length,cr),cr}function trivialOrder(lr){return[new BidiSpan(0,lr,0)]}let movedOver="";function moveVisually(lr,or,ar,cr,ur){var hr;let fr=cr.head-lr.from,dr=-1;if(fr==0){if(!ur||!lr.length)return null;or[0].level!=ar&&(fr=or[0].side(!1,ar),dr=0)}else if(fr==lr.length){if(ur)return null;let br=or[or.length-1];br.level!=ar&&(fr=br.side(!0,ar),dr=or.length-1)}dr<0&&(dr=BidiSpan.find(or,fr,(hr=cr.bidiLevel)!==null&&hr!==void 0?hr:-1,cr.assoc));let pr=or[dr];fr==pr.side(ur,ar)&&(pr=or[dr+=ur?1:-1],fr=pr.side(!ur,ar));let mr=ur==(pr.dir==ar),gr=findClusterBreak(lr.text,fr,mr);if(movedOver=lr.text.slice(Math.min(fr,gr),Math.max(fr,gr)),gr!=pr.side(ur,ar))return EditorSelection.cursor(gr+lr.from,mr?-1:1,pr.level);let yr=dr==(ur?or.length-1:0)?null:or[dr+(ur?1:-1)];return!yr&&pr.level!=ar?EditorSelection.cursor(ur?lr.to:lr.from,ur?-1:1,ar):yr&&yr.level<pr.level?EditorSelection.cursor(yr.side(!ur,ar)+lr.from,ur?1:-1,yr.level):EditorSelection.cursor(gr+lr.from,ur?-1:1,pr.level)}class DocView extends ContentView{get length(){return this.view.state.doc.length}constructor(or){super(),this.view=or,this.decorations=[],this.dynamicDecorationMap=[],this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(or.contentDOM),this.children=[new LineView],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ChangedRange(0,0,0,or.state.doc.length)],0,null)}update(or){let ar=or.changedRanges;this.minWidth>0&&ar.length&&(ar.every(({fromA:dr,toA:pr})=>pr<this.minWidthFrom||dr>this.minWidthTo)?(this.minWidthFrom=or.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=or.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let cr=this.view.inputState.composing<0?null:findCompositionRange(this.view,or.changes);if(this.hasComposition){this.markedForComposition.clear();let{from:dr,to:pr}=this.hasComposition;ar=new ChangedRange(dr,pr,or.changes.mapPos(dr,-1),or.changes.mapPos(pr,1)).addToSet(ar.slice())}this.hasComposition=cr?{from:cr.range.fromB,to:cr.range.toB}:null,(browser$2.ie||browser$2.chrome)&&!cr&&or&&or.state.doc.lines!=or.startState.doc.lines&&(this.forceSelection=!0);let ur=this.decorations,hr=this.updateDeco(),fr=findChangedDeco(ur,hr,or.changes);return ar=ChangedRange.extendWithRanges(ar,fr),!(this.flags&7)&&ar.length==0?!1:(this.updateInner(ar,or.startState.doc.length,cr),or.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(or,ar,cr){this.view.viewState.mustMeasureContent=!0,this.updateChildren(or,ar,cr);let{observer:ur}=this.view;ur.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let fr=browser$2.chrome||browser$2.ios?{node:ur.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,fr),this.flags&=-8,fr&&(fr.written||ur.selectionRange.focusNode!=fr.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(fr=>fr.flags&=-9);let hr=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let fr of this.children)fr instanceof BlockWidgetView&&fr.widget instanceof BlockGapWidget&&hr.push(fr.dom);ur.updateGaps(hr)}updateChildren(or,ar,cr){let ur=cr?cr.range.addToSet(or.slice()):or,hr=this.childCursor(ar);for(let fr=ur.length-1;;fr--){let dr=fr>=0?ur[fr]:null;if(!dr)break;let{fromA:pr,toA:mr,fromB:gr,toB:yr}=dr,br,Or,_r,vr;if(cr&&cr.range.fromB<yr&&cr.range.toB>gr){let $r=ContentBuilder.build(this.view.state.doc,gr,cr.range.fromB,this.decorations,this.dynamicDecorationMap),Nr=ContentBuilder.build(this.view.state.doc,cr.range.toB,yr,this.decorations,this.dynamicDecorationMap);Or=$r.breakAtStart,_r=$r.openStart,vr=Nr.openEnd;let Br=this.compositionView(cr);Nr.breakAtStart?Br.breakAfter=1:Nr.content.length&&Br.merge(Br.length,Br.length,Nr.content[0],!1,Nr.openStart,0)&&(Br.breakAfter=Nr.content[0].breakAfter,Nr.content.shift()),$r.content.length&&Br.merge(0,0,$r.content[$r.content.length-1],!0,0,$r.openEnd)&&$r.content.pop(),br=$r.content.concat(Br).concat(Nr.content)}else({content:br,breakAtStart:Or,openStart:_r,openEnd:vr}=ContentBuilder.build(this.view.state.doc,gr,yr,this.decorations,this.dynamicDecorationMap));let{i:xr,off:wr}=hr.findPos(mr,1),{i:kr,off:Cr}=hr.findPos(pr,-1);replaceRange(this,kr,Cr,xr,wr,br,Or,_r,vr)}cr&&this.fixCompositionDOM(cr)}compositionView(or){let ar=new TextView(or.text.nodeValue);ar.flags|=8;for(let{deco:ur}of or.marks)ar=new MarkView(ur,[ar],ar.length);let cr=new LineView;return cr.append(ar,0),cr}fixCompositionDOM(or){let ar=(hr,fr)=>{fr.flags|=8|(fr.children.some(pr=>pr.flags&7)?1:0),this.markedForComposition.add(fr);let dr=ContentView.get(hr);dr!=fr&&(dr&&(dr.dom=null),fr.setDOM(hr))},cr=this.childPos(or.range.fromB,1),ur=this.children[cr.i];ar(or.line,ur);for(let hr=or.marks.length-1;hr>=-1;hr--)cr=ur.childPos(cr.off,1),ur=ur.children[cr.i],ar(hr>=0?or.marks[hr].node:or.text,ur)}updateSelection(or=!1,ar=!1){(or||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let cr=this.view.root.activeElement,ur=cr==this.dom,hr=!ur&&hasSelection(this.dom,this.view.observer.selectionRange)&&!(cr&&this.dom.contains(cr));if(!(ur||ar||hr))return;let fr=this.forceSelection;this.forceSelection=!1;let dr=this.view.state.selection.main,pr=this.domAtPos(dr.anchor),mr=dr.empty?pr:this.domAtPos(dr.head);if(browser$2.gecko&&dr.empty&&!this.hasComposition&&betweenUneditable(pr)){let yr=document.createTextNode("");this.view.observer.ignore(()=>pr.node.insertBefore(yr,pr.node.childNodes[pr.offset]||null)),pr=mr=new DOMPos(yr,0),fr=!0}let gr=this.view.observer.selectionRange;(fr||!gr.focusNode||!isEquivalentPosition(pr.node,pr.offset,gr.anchorNode,gr.anchorOffset)||!isEquivalentPosition(mr.node,mr.offset,gr.focusNode,gr.focusOffset))&&(this.view.observer.ignore(()=>{browser$2.android&&browser$2.chrome&&this.dom.contains(gr.focusNode)&&inUneditable(gr.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let yr=getSelection(this.view.root);if(yr)if(dr.empty){if(browser$2.gecko){let br=nextToUneditable(pr.node,pr.offset);if(br&&br!=3){let Or=nearbyTextNode(pr.node,pr.offset,br==1?1:-1);Or&&(pr=new DOMPos(Or,br==1?0:Or.nodeValue.length))}}yr.collapse(pr.node,pr.offset),dr.bidiLevel!=null&&gr.caretBidiLevel!=null&&(gr.caretBidiLevel=dr.bidiLevel)}else if(yr.extend){yr.collapse(pr.node,pr.offset);try{yr.extend(mr.node,mr.offset)}catch{}}else{let br=document.createRange();dr.anchor>dr.head&&([pr,mr]=[mr,pr]),br.setEnd(mr.node,mr.offset),br.setStart(pr.node,pr.offset),yr.removeAllRanges(),yr.addRange(br)}hr&&this.view.root.activeElement==this.dom&&(this.dom.blur(),cr&&cr.focus())}),this.view.observer.setSelectionRange(pr,mr)),this.impreciseAnchor=pr.precise?null:new DOMPos(gr.anchorNode,gr.anchorOffset),this.impreciseHead=mr.precise?null:new DOMPos(gr.focusNode,gr.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:or}=this,ar=or.state.selection.main,cr=getSelection(or.root),{anchorNode:ur,anchorOffset:hr}=or.observer.selectionRange;if(!cr||!ar.empty||!ar.assoc||!cr.modify)return;let fr=LineView.find(this,ar.head);if(!fr)return;let dr=fr.posAtStart;if(ar.head==dr||ar.head==dr+fr.length)return;let pr=this.coordsAt(ar.head,-1),mr=this.coordsAt(ar.head,1);if(!pr||!mr||pr.bottom>mr.top)return;let gr=this.domAtPos(ar.head+ar.assoc);cr.collapse(gr.node,gr.offset),cr.modify("move",ar.assoc<0?"forward":"backward","lineboundary"),or.observer.readSelectionRange();let yr=or.observer.selectionRange;or.docView.posFromDOM(yr.anchorNode,yr.anchorOffset)!=ar.from&&cr.collapse(ur,hr)}nearest(or){for(let ar=or;ar;){let cr=ContentView.get(ar);if(cr&&cr.rootView==this)return cr;ar=ar.parentNode}return null}posFromDOM(or,ar){let cr=this.nearest(or);if(!cr)throw new RangeError("Trying to find position for a DOM position outside of the document");return cr.localPosFromDOM(or,ar)+cr.posAtStart}domAtPos(or){let{i:ar,off:cr}=this.childCursor().findPos(or,-1);for(;ar<this.children.length-1;){let ur=this.children[ar];if(cr<ur.length||ur instanceof LineView)break;ar++,cr=0}return this.children[ar].domAtPos(cr)}coordsAt(or,ar){for(let cr=this.length,ur=this.children.length-1;;ur--){let hr=this.children[ur],fr=cr-hr.breakAfter-hr.length;if(or>fr||or==fr&&hr.type!=BlockType.WidgetBefore&&hr.type!=BlockType.WidgetAfter&&(!ur||ar==2||this.children[ur-1].breakAfter||this.children[ur-1].type==BlockType.WidgetBefore&&ar>-2))return hr.coordsAt(or-fr,ar);cr=fr}}coordsForChar(or){let{i:ar,off:cr}=this.childPos(or,1),ur=this.children[ar];if(!(ur instanceof LineView))return null;for(;ur.children.length;){let{i:dr,off:pr}=ur.childPos(cr,1);for(;;dr++){if(dr==ur.children.length)return null;if((ur=ur.children[dr]).length)break}cr=pr}if(!(ur instanceof TextView))return null;let hr=findClusterBreak(ur.text,cr);if(hr==cr)return null;let fr=textRange(ur.dom,cr,hr).getClientRects();return!fr.length||fr[0].top>=fr[0].bottom?null:fr[0]}measureVisibleLineHeights(or){let ar=[],{from:cr,to:ur}=or,hr=this.view.contentDOM.clientWidth,fr=hr>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,dr=-1,pr=this.view.textDirection==Direction.LTR;for(let mr=0,gr=0;gr<this.children.length;gr++){let yr=this.children[gr],br=mr+yr.length;if(br>ur)break;if(mr>=cr){let Or=yr.dom.getBoundingClientRect();if(ar.push(Or.height),fr){let _r=yr.dom.lastChild,vr=_r?clientRectsFor(_r):[];if(vr.length){let xr=vr[vr.length-1],wr=pr?xr.right-Or.left:Or.right-xr.left;wr>dr&&(dr=wr,this.minWidth=hr,this.minWidthFrom=mr,this.minWidthTo=br)}}}mr=br+yr.breakAfter}return ar}textDirectionAt(or){let{i:ar}=this.childPos(or,1);return getComputedStyle(this.children[ar].dom).direction=="rtl"?Direction.RTL:Direction.LTR}measureTextSize(){for(let hr of this.children)if(hr instanceof LineView){let fr=hr.measureTextSize();if(fr)return fr}let or=document.createElement("div"),ar,cr,ur;return or.className="cm-line",or.style.width="99999px",or.style.position="absolute",or.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(or);let hr=clientRectsFor(or.firstChild)[0];ar=or.getBoundingClientRect().height,cr=hr?hr.width/27:7,ur=hr?hr.height:ar,or.remove()}),{lineHeight:ar,charWidth:cr,textHeight:ur}}childCursor(or=this.length){let ar=this.children.length;return ar&&(or-=this.children[--ar].length),new ChildCursor(this.children,or,ar)}computeBlockGapDeco(){let or=[],ar=this.view.viewState;for(let cr=0,ur=0;;ur++){let hr=ur==ar.viewports.length?null:ar.viewports[ur],fr=hr?hr.from-1:this.length;if(fr>cr){let dr=(ar.lineBlockAt(fr).bottom-ar.lineBlockAt(cr).top)/this.view.scaleY;or.push(Decoration.replace({widget:new BlockGapWidget(dr),block:!0,inclusive:!0,isBlockGap:!0}).range(cr,fr))}if(!hr)break;cr=hr.to+1}return Decoration.set(or)}updateDeco(){let or=this.view.state.facet(decorations).map((ar,cr)=>(this.dynamicDecorationMap[cr]=typeof ar=="function")?ar(this.view):ar);for(let ar=or.length;ar<or.length+3;ar++)this.dynamicDecorationMap[ar]=!1;return this.decorations=[...or,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(or){let{range:ar}=or,cr=this.coordsAt(ar.head,ar.empty?ar.assoc:ar.head>ar.anchor?-1:1),ur;if(!cr)return;!ar.empty&&(ur=this.coordsAt(ar.anchor,ar.anchor>ar.head?-1:1))&&(cr={left:Math.min(cr.left,ur.left),top:Math.min(cr.top,ur.top),right:Math.max(cr.right,ur.right),bottom:Math.max(cr.bottom,ur.bottom)});let hr=getScrollMargins(this.view),fr={left:cr.left-hr.left,top:cr.top-hr.top,right:cr.right+hr.right,bottom:cr.bottom+hr.bottom};scrollRectIntoView(this.view.scrollDOM,fr,ar.head<ar.anchor?-1:1,or.x,or.y,or.xMargin,or.yMargin,this.view.textDirection==Direction.LTR)}}function betweenUneditable(lr){return lr.node.nodeType==1&&lr.node.firstChild&&(lr.offset==0||lr.node.childNodes[lr.offset-1].contentEditable=="false")&&(lr.offset==lr.node.childNodes.length||lr.node.childNodes[lr.offset].contentEditable=="false")}class BlockGapWidget extends WidgetType{constructor(or){super(),this.height=or}toDOM(){let or=document.createElement("div");return this.updateDOM(or),or}eq(or){return or.height==this.height}updateDOM(or){return or.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function findCompositionNode(lr,or){let ar=lr.observer.selectionRange,cr=ar.focusNode&&nearbyTextNode(ar.focusNode,ar.focusOffset,0);if(!cr)return null;let ur=ContentView.get(cr),hr,fr;if(ur instanceof TextView)hr=ur.posAtStart,fr=hr+ur.length;else{let dr=Math.max(0,cr.nodeValue.length-or);e:for(let pr=0,mr=cr;;){for(let yr=mr.previousSibling,br;yr;yr=yr.previousSibling){if(br=ContentView.get(yr)){fr=br.posAtEnd+pr,hr=Math.max(0,fr-dr);break e}let Or=new DOMReader([],lr.state);if(Or.readNode(yr),Or.text.indexOf(LineBreakPlaceholder)>-1)return null;pr+=Or.text.length}if(mr=mr.parentNode,!mr)return null;let gr=ContentView.get(mr);if(gr){hr=gr.posAtStart+pr,fr=hr+dr;break}}}return{from:hr,to:fr,node:cr}}function findCompositionRange(lr,or){let ar=findCompositionNode(lr,or.newLength-or.length);if(!ar)return null;let{from:cr,to:ur,node:hr}=ar,fr=or.mapPos(cr,-1),dr=or.mapPos(ur,1),pr=hr.nodeValue;if(/[\n\r]/.test(pr))return null;if(dr-fr!=pr.length){let br=or.mapPos(cr,1),Or=or.mapPos(ur,-1);if(Or-br==pr.length)fr=br,dr=Or;else if(lr.state.doc.sliceString(dr-pr.length,dr)==pr)fr=dr-pr.length;else if(lr.state.doc.sliceString(fr,fr+pr.length)==pr)dr=fr+pr.length;else return null}let{main:mr}=lr.state.selection;if(lr.state.doc.sliceString(fr,dr)!=pr||fr>mr.head||dr<mr.head)return null;let gr=[],yr=new ChangedRange(cr,ur,fr,dr);for(let br=hr.parentNode;;br=br.parentNode){let Or=ContentView.get(br);if(Or instanceof MarkView)gr.push({node:br,deco:Or.mark});else{if(Or instanceof LineView||br.nodeName=="DIV"&&br.parentNode==lr.contentDOM)return{range:yr,text:hr,marks:gr,line:br};if(br!=lr.contentDOM)gr.push({node:br,deco:new MarkDecoration({inclusive:!0,attributes:getAttrs$1(br),tagName:br.tagName.toLowerCase()})});else return null}}}function nearbyTextNode(lr,or,ar){if(ar<=0)for(let cr=lr,ur=or;;){if(cr.nodeType==3)return cr;if(cr.nodeType==1&&ur>0)cr=cr.childNodes[ur-1],ur=maxOffset(cr);else break}if(ar>=0)for(let cr=lr,ur=or;;){if(cr.nodeType==3)return cr;if(cr.nodeType==1&&ur<cr.childNodes.length&&ar>=0)cr=cr.childNodes[ur],ur=0;else break}return null}function nextToUneditable(lr,or){return lr.nodeType!=1?0:(or&&lr.childNodes[or-1].contentEditable=="false"?1:0)|(or<lr.childNodes.length&&lr.childNodes[or].contentEditable=="false"?2:0)}let DecorationComparator$1=class{constructor(){this.changes=[]}compareRange(or,ar){addRange(or,ar,this.changes)}comparePoint(or,ar){addRange(or,ar,this.changes)}};function findChangedDeco(lr,or,ar){let cr=new DecorationComparator$1;return RangeSet.compare(lr,or,ar,cr),cr.changes}function inUneditable(lr,or){for(let ar=lr;ar&&ar!=or;ar=ar.assignedSlot||ar.parentNode)if(ar.nodeType==1&&ar.contentEditable=="false")return!0;return!1}function groupAt(lr,or,ar=1){let cr=lr.charCategorizer(or),ur=lr.doc.lineAt(or),hr=or-ur.from;if(ur.length==0)return EditorSelection.cursor(or);hr==0?ar=1:hr==ur.length&&(ar=-1);let fr=hr,dr=hr;ar<0?fr=findClusterBreak(ur.text,hr,!1):dr=findClusterBreak(ur.text,hr);let pr=cr(ur.text.slice(fr,dr));for(;fr>0;){let mr=findClusterBreak(ur.text,fr,!1);if(cr(ur.text.slice(mr,fr))!=pr)break;fr=mr}for(;dr<ur.length;){let mr=findClusterBreak(ur.text,dr);if(cr(ur.text.slice(dr,mr))!=pr)break;dr=mr}return EditorSelection.range(fr+ur.from,dr+ur.from)}function getdx(lr,or){return or.left>lr?or.left-lr:Math.max(0,lr-or.right)}function getdy(lr,or){return or.top>lr?or.top-lr:Math.max(0,lr-or.bottom)}function yOverlap(lr,or){return lr.top<or.bottom-1&&lr.bottom>or.top+1}function upTop(lr,or){return or<lr.top?{top:or,left:lr.left,right:lr.right,bottom:lr.bottom}:lr}function upBot(lr,or){return or>lr.bottom?{top:lr.top,left:lr.left,right:lr.right,bottom:or}:lr}function domPosAtCoords(lr,or,ar){let cr,ur,hr,fr,dr=!1,pr,mr,gr,yr;for(let _r=lr.firstChild;_r;_r=_r.nextSibling){let vr=clientRectsFor(_r);for(let xr=0;xr<vr.length;xr++){let wr=vr[xr];ur&&yOverlap(ur,wr)&&(wr=upTop(upBot(wr,ur.bottom),ur.top));let kr=getdx(or,wr),Cr=getdy(ar,wr);if(kr==0&&Cr==0)return _r.nodeType==3?domPosInText(_r,or,ar):domPosAtCoords(_r,or,ar);if(!cr||fr>Cr||fr==Cr&&hr>kr){cr=_r,ur=wr,hr=kr,fr=Cr;let $r=Cr?ar<wr.top?-1:1:kr?or<wr.left?-1:1:0;dr=!$r||($r>0?xr<vr.length-1:xr>0)}kr==0?ar>wr.bottom&&(!gr||gr.bottom<wr.bottom)?(pr=_r,gr=wr):ar<wr.top&&(!yr||yr.top>wr.top)&&(mr=_r,yr=wr):gr&&yOverlap(gr,wr)?gr=upBot(gr,wr.bottom):yr&&yOverlap(yr,wr)&&(yr=upTop(yr,wr.top))}}if(gr&&gr.bottom>=ar?(cr=pr,ur=gr):yr&&yr.top<=ar&&(cr=mr,ur=yr),!cr)return{node:lr,offset:0};let br=Math.max(ur.left,Math.min(ur.right,or));if(cr.nodeType==3)return domPosInText(cr,br,ar);if(dr&&cr.contentEditable!="false")return domPosAtCoords(cr,br,ar);let Or=Array.prototype.indexOf.call(lr.childNodes,cr)+(or>=(ur.left+ur.right)/2?1:0);return{node:lr,offset:Or}}function domPosInText(lr,or,ar){let cr=lr.nodeValue.length,ur=-1,hr=1e9,fr=0;for(let dr=0;dr<cr;dr++){let pr=textRange(lr,dr,dr+1).getClientRects();for(let mr=0;mr<pr.length;mr++){let gr=pr[mr];if(gr.top==gr.bottom)continue;fr||(fr=or-gr.left);let yr=(gr.top>ar?gr.top-ar:ar-gr.bottom)-1;if(gr.left-1<=or&&gr.right+1>=or&&yr<hr){let br=or>=(gr.left+gr.right)/2,Or=br;if((browser$2.chrome||browser$2.gecko)&&textRange(lr,dr).getBoundingClientRect().left==gr.right&&(Or=!br),yr<=0)return{node:lr,offset:dr+(Or?1:0)};ur=dr+(Or?1:0),hr=yr}}}return{node:lr,offset:ur>-1?ur:fr>0?lr.nodeValue.length:0}}function posAtCoords(lr,or,ar,cr=-1){var ur,hr;let fr=lr.contentDOM.getBoundingClientRect(),dr=fr.top+lr.viewState.paddingTop,pr,{docHeight:mr}=lr.viewState,{x:gr,y:yr}=or,br=yr-dr;if(br<0)return 0;if(br>mr)return lr.state.doc.length;for(let $r=lr.viewState.heightOracle.textHeight/2,Nr=!1;pr=lr.elementAtHeight(br),pr.type!=BlockType.Text;)for(;br=cr>0?pr.bottom+$r:pr.top-$r,!(br>=0&&br<=mr);){if(Nr)return ar?null:0;Nr=!0,cr=-cr}yr=dr+br;let Or=pr.from;if(Or<lr.viewport.from)return lr.viewport.from==0?0:ar?null:posAtCoordsImprecise(lr,fr,pr,gr,yr);if(Or>lr.viewport.to)return lr.viewport.to==lr.state.doc.length?lr.state.doc.length:ar?null:posAtCoordsImprecise(lr,fr,pr,gr,yr);let _r=lr.dom.ownerDocument,vr=lr.root.elementFromPoint?lr.root:_r,xr=vr.elementFromPoint(gr,yr);xr&&!lr.contentDOM.contains(xr)&&(xr=null),xr||(gr=Math.max(fr.left+1,Math.min(fr.right-1,gr)),xr=vr.elementFromPoint(gr,yr),xr&&!lr.contentDOM.contains(xr)&&(xr=null));let wr,kr=-1;if(xr&&((ur=lr.docView.nearest(xr))===null||ur===void 0?void 0:ur.isEditable)!=!1){if(_r.caretPositionFromPoint){let $r=_r.caretPositionFromPoint(gr,yr);$r&&({offsetNode:wr,offset:kr}=$r)}else if(_r.caretRangeFromPoint){let $r=_r.caretRangeFromPoint(gr,yr);$r&&({startContainer:wr,startOffset:kr}=$r,(!lr.contentDOM.contains(wr)||browser$2.safari&&isSuspiciousSafariCaretResult(wr,kr,gr)||browser$2.chrome&&isSuspiciousChromeCaretResult(wr,kr,gr))&&(wr=void 0))}}if(!wr||!lr.docView.dom.contains(wr)){let $r=LineView.find(lr.docView,Or);if(!$r)return br>pr.top+pr.height/2?pr.to:pr.from;({node:wr,offset:kr}=domPosAtCoords($r.dom,gr,yr))}let Cr=lr.docView.nearest(wr);if(!Cr)return null;if(Cr.isWidget&&((hr=Cr.dom)===null||hr===void 0?void 0:hr.nodeType)==1){let $r=Cr.dom.getBoundingClientRect();return or.y<$r.top||or.y<=$r.bottom&&or.x<=($r.left+$r.right)/2?Cr.posAtStart:Cr.posAtEnd}else return Cr.localPosFromDOM(wr,kr)+Cr.posAtStart}function posAtCoordsImprecise(lr,or,ar,cr,ur){let hr=Math.round((cr-or.left)*lr.defaultCharacterWidth);if(lr.lineWrapping&&ar.height>lr.defaultLineHeight*1.5){let dr=lr.viewState.heightOracle.textHeight,pr=Math.floor((ur-ar.top-(lr.defaultLineHeight-dr)*.5)/dr);hr+=pr*lr.viewState.heightOracle.lineLength}let fr=lr.state.sliceDoc(ar.from,ar.to);return ar.from+findColumn(fr,hr,lr.state.tabSize)}function isSuspiciousSafariCaretResult(lr,or,ar){let cr;if(lr.nodeType!=3||or!=(cr=lr.nodeValue.length))return!1;for(let ur=lr.nextSibling;ur;ur=ur.nextSibling)if(ur.nodeType!=1||ur.nodeName!="BR")return!1;return textRange(lr,cr-1,cr).getBoundingClientRect().left>ar}function isSuspiciousChromeCaretResult(lr,or,ar){if(or!=0)return!1;for(let ur=lr;;){let hr=ur.parentNode;if(!hr||hr.nodeType!=1||hr.firstChild!=ur)return!1;if(hr.classList.contains("cm-line"))break;ur=hr}let cr=lr.nodeType==1?lr.getBoundingClientRect():textRange(lr,0,Math.max(lr.nodeValue.length,1)).getBoundingClientRect();return ar-cr.left>5}function blockAt(lr,or){let ar=lr.lineBlockAt(or);if(Array.isArray(ar.type)){for(let cr of ar.type)if(cr.to>or||cr.to==or&&(cr.to==ar.to||cr.type==BlockType.Text))return cr}return ar}function moveToLineBoundary(lr,or,ar,cr){let ur=blockAt(lr,or.head),hr=!cr||ur.type!=BlockType.Text||!(lr.lineWrapping||ur.widgetLineBreaks)?null:lr.coordsAtPos(or.assoc<0&&or.head>ur.from?or.head-1:or.head);if(hr){let fr=lr.dom.getBoundingClientRect(),dr=lr.textDirectionAt(ur.from),pr=lr.posAtCoords({x:ar==(dr==Direction.LTR)?fr.right-1:fr.left+1,y:(hr.top+hr.bottom)/2});if(pr!=null)return EditorSelection.cursor(pr,ar?-1:1)}return EditorSelection.cursor(ar?ur.to:ur.from,ar?-1:1)}function moveByChar(lr,or,ar,cr){let ur=lr.state.doc.lineAt(or.head),hr=lr.bidiSpans(ur),fr=lr.textDirectionAt(ur.from);for(let dr=or,pr=null;;){let mr=moveVisually(ur,hr,fr,dr,ar),gr=movedOver;if(!mr){if(ur.number==(ar?lr.state.doc.lines:1))return dr;gr=`
`,ur=lr.state.doc.line(ur.number+(ar?1:-1)),hr=lr.bidiSpans(ur),mr=EditorSelection.cursor(ar?ur.from:ur.to)}if(pr){if(!pr(gr))return dr}else{if(!cr)return mr;pr=cr(gr)}dr=mr}}function byGroup(lr,or,ar){let cr=lr.state.charCategorizer(or),ur=cr(ar);return hr=>{let fr=cr(hr);return ur==CharCategory.Space&&(ur=fr),ur==fr}}function moveVertically(lr,or,ar,cr){let ur=or.head,hr=ar?1:-1;if(ur==(ar?lr.state.doc.length:0))return EditorSelection.cursor(ur,or.assoc);let fr=or.goalColumn,dr,pr=lr.contentDOM.getBoundingClientRect(),mr=lr.coordsAtPos(ur),gr=lr.documentTop;if(mr)fr==null&&(fr=mr.left-pr.left),dr=hr<0?mr.top:mr.bottom;else{let Or=lr.viewState.lineBlockAt(ur);fr==null&&(fr=Math.min(pr.right-pr.left,lr.defaultCharacterWidth*(ur-Or.from))),dr=(hr<0?Or.top:Or.bottom)+gr}let yr=pr.left+fr,br=cr??lr.viewState.heightOracle.textHeight>>1;for(let Or=0;;Or+=10){let _r=dr+(br+Or)*hr,vr=posAtCoords(lr,{x:yr,y:_r},!1,hr);if(_r<pr.top||_r>pr.bottom||(hr<0?vr<ur:vr>ur))return EditorSelection.cursor(vr,or.assoc,void 0,fr)}}function skipAtomicRanges(lr,or,ar){for(;;){let cr=0;for(let ur of lr)ur.between(or-1,or+1,(hr,fr,dr)=>{if(or>hr&&or<fr){let pr=cr||ar||(or-hr<fr-or?-1:1);or=pr<0?hr:fr,cr=pr}});if(!cr)return or}}function skipAtoms(lr,or,ar){let cr=skipAtomicRanges(lr.state.facet(atomicRanges).map(ur=>ur(lr)),ar.from,or.head>ar.from?-1:1);return cr==ar.from?ar:EditorSelection.cursor(cr,cr<ar.from?1:-1)}class InputState{setSelectionOrigin(or){this.lastSelectionOrigin=or,this.lastSelectionTime=Date.now()}constructor(or){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let ar=(cr,ur)=>{this.ignoreDuringComposition(ur)||ur.type=="keydown"&&this.keydown(or,ur)||(this.mustFlushObserver(ur)&&or.observer.forceFlush(),this.runCustomHandlers(ur.type,or,ur)?ur.preventDefault():cr(or,ur))};for(let cr in handlers){let ur=handlers[cr];or.contentDOM.addEventListener(cr,hr=>{eventBelongsToEditor(or,hr)&&ar(ur,hr)},handlerOptions[cr]),this.registeredEvents.push(cr)}or.scrollDOM.addEventListener("mousedown",cr=>{if(cr.target==or.scrollDOM&&cr.clientY>or.contentDOM.getBoundingClientRect().bottom&&(ar(handlers.mousedown,cr),!cr.defaultPrevented&&cr.button==2)){let ur=or.contentDOM.style.minHeight;or.contentDOM.style.minHeight="100%",setTimeout(()=>or.contentDOM.style.minHeight=ur,200)}}),or.scrollDOM.addEventListener("drop",cr=>{cr.target==or.scrollDOM&&cr.clientY>or.contentDOM.getBoundingClientRect().bottom&&ar(handlers.drop,cr)}),browser$2.chrome&&browser$2.chrome_version==102&&or.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?or.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,or.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=or.hasFocus,browser$2.safari&&or.contentDOM.addEventListener("input",()=>null),browser$2.gecko&&firefoxCopyCutHack(or.contentDOM.ownerDocument)}ensureHandlers(or,ar){var cr;let ur;this.customHandlers=[];for(let hr of ar)if(ur=(cr=hr.update(or).spec)===null||cr===void 0?void 0:cr.domEventHandlers){this.customHandlers.push({plugin:hr.value,handlers:ur});for(let fr in ur)this.registeredEvents.indexOf(fr)<0&&fr!="scroll"&&(this.registeredEvents.push(fr),or.contentDOM.addEventListener(fr,dr=>{eventBelongsToEditor(or,dr)&&this.runCustomHandlers(fr,or,dr)&&dr.preventDefault()}))}}runCustomHandlers(or,ar,cr){for(let ur of this.customHandlers){let hr=ur.handlers[or];if(hr)try{if(hr.call(ur.plugin,cr,ar)||cr.defaultPrevented)return!0}catch(fr){logException(ar.state,fr)}}return!1}runScrollHandlers(or,ar){this.lastScrollTop=or.scrollDOM.scrollTop,this.lastScrollLeft=or.scrollDOM.scrollLeft;for(let cr of this.customHandlers){let ur=cr.handlers.scroll;if(ur)try{ur.call(cr.plugin,ar,or)}catch(hr){logException(or.state,hr)}}}keydown(or,ar){if(this.lastKeyCode=ar.keyCode,this.lastKeyTime=Date.now(),ar.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(ar.keyCode!=27&&modifierCodes.indexOf(ar.keyCode)<0&&(or.inputState.lastEscPress=0),browser$2.android&&browser$2.chrome&&!ar.synthetic&&(ar.keyCode==13||ar.keyCode==8))return or.observer.delayAndroidKey(ar.key,ar.keyCode),!0;let cr;return browser$2.ios&&!ar.synthetic&&!ar.altKey&&!ar.metaKey&&((cr=PendingKeys.find(ur=>ur.keyCode==ar.keyCode))&&!ar.ctrlKey||EmacsyPendingKeys.indexOf(ar.key)>-1&&ar.ctrlKey&&!ar.shiftKey)?(this.pendingIOSKey=cr||ar,setTimeout(()=>this.flushIOSKey(or),250),!0):!1}flushIOSKey(or){let ar=this.pendingIOSKey;return ar?(this.pendingIOSKey=void 0,dispatchKey(or.contentDOM,ar.key,ar.keyCode)):!1}ignoreDuringComposition(or){return/^key/.test(or.type)?this.composing>0?!0:browser$2.safari&&!browser$2.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}mustFlushObserver(or){return or.type=="keydown"&&or.keyCode!=229}startMouseSelection(or){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=or}update(or){this.mouseSelection&&this.mouseSelection.update(or),or.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys="dthko",modifierCodes=[16,17,18,20,91,92,224,225],dragScrollMargin=6;function dragScrollSpeed(lr){return Math.max(0,lr)*.7+8}function dist(lr,or){return Math.max(Math.abs(lr.clientX-or.clientX),Math.abs(lr.clientY-or.clientY))}class MouseSelection{constructor(or,ar,cr,ur){this.view=or,this.startEvent=ar,this.style=cr,this.mustSelect=ur,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=ar,this.scrollParent=scrollableParent(or.contentDOM),this.atoms=or.state.facet(atomicRanges).map(fr=>fr(or));let hr=or.contentDOM.ownerDocument;hr.addEventListener("mousemove",this.move=this.move.bind(this)),hr.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=ar.shiftKey,this.multiple=or.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(or,ar),this.dragging=isInPrimarySelection(or,ar)&&getClickType(ar)==1?null:!1}start(or){this.dragging===!1&&(or.preventDefault(),this.select(or))}move(or){var ar;if(or.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&dist(this.startEvent,or)<10)return;this.select(this.lastEvent=or);let cr=0,ur=0,hr=((ar=this.scrollParent)===null||ar===void 0?void 0:ar.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},fr=getScrollMargins(this.view);or.clientX-fr.left<=hr.left+dragScrollMargin?cr=-dragScrollSpeed(hr.left-or.clientX):or.clientX+fr.right>=hr.right-dragScrollMargin&&(cr=dragScrollSpeed(or.clientX-hr.right)),or.clientY-fr.top<=hr.top+dragScrollMargin?ur=-dragScrollSpeed(hr.top-or.clientY):or.clientY+fr.bottom>=hr.bottom-dragScrollMargin&&(ur=dragScrollSpeed(or.clientY-hr.bottom)),this.setScrollSpeed(cr,ur)}up(or){this.dragging==null&&this.select(this.lastEvent),this.dragging||or.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let or=this.view.contentDOM.ownerDocument;or.removeEventListener("mousemove",this.move),or.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(or,ar){this.scrollSpeed={x:or,y:ar},or||ar?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(or){let ar=null;for(let cr=0;cr<or.ranges.length;cr++){let ur=or.ranges[cr],hr=null;if(ur.empty){let fr=skipAtomicRanges(this.atoms,ur.from,0);fr!=ur.from&&(hr=EditorSelection.cursor(fr,-1))}else{let fr=skipAtomicRanges(this.atoms,ur.from,-1),dr=skipAtomicRanges(this.atoms,ur.to,1);(fr!=ur.from||dr!=ur.to)&&(hr=EditorSelection.range(ur.from==ur.anchor?fr:dr,ur.from==ur.head?fr:dr))}hr&&(ar||(ar=or.ranges.slice()),ar[cr]=hr)}return ar?EditorSelection.create(ar,or.mainIndex):or}select(or){let{view:ar}=this,cr=this.skipAtoms(this.style.get(or,this.extend,this.multiple));(this.mustSelect||!cr.eq(ar.state.selection)||cr.main.assoc!=ar.state.selection.main.assoc&&this.dragging===!1)&&this.view.dispatch({selection:cr,userEvent:"select.pointer"}),this.mustSelect=!1}update(or){or.docChanged&&this.dragging&&(this.dragging=this.dragging.map(or.changes)),this.style.update(or)&&setTimeout(()=>this.select(this.lastEvent),20)}}function addsSelectionRange(lr,or){let ar=lr.state.facet(clickAddsSelectionRange);return ar.length?ar[0](or):browser$2.mac?or.metaKey:or.ctrlKey}function dragMovesSelection(lr,or){let ar=lr.state.facet(dragMovesSelection$1);return ar.length?ar[0](or):browser$2.mac?!or.altKey:!or.ctrlKey}function isInPrimarySelection(lr,or){let{main:ar}=lr.state.selection;if(ar.empty)return!1;let cr=getSelection(lr.root);if(!cr||cr.rangeCount==0)return!0;let ur=cr.getRangeAt(0).getClientRects();for(let hr=0;hr<ur.length;hr++){let fr=ur[hr];if(fr.left<=or.clientX&&fr.right>=or.clientX&&fr.top<=or.clientY&&fr.bottom>=or.clientY)return!0}return!1}function eventBelongsToEditor(lr,or){if(!or.bubbles)return!0;if(or.defaultPrevented)return!1;for(let ar=or.target,cr;ar!=lr.contentDOM;ar=ar.parentNode)if(!ar||ar.nodeType==11||(cr=ContentView.get(ar))&&cr.ignoreEvent(or))return!1;return!0}const handlers=Object.create(null),handlerOptions=Object.create(null),brokenClipboardAPI=browser$2.ie&&browser$2.ie_version<15||browser$2.ios&&browser$2.webkit_version<604;function capturePaste(lr){let or=lr.dom.parentNode;if(!or)return;let ar=or.appendChild(document.createElement("textarea"));ar.style.cssText="position: fixed; left: -10000px; top: 10px",ar.focus(),setTimeout(()=>{lr.focus(),ar.remove(),doPaste(lr,ar.value)},50)}function doPaste(lr,or){let{state:ar}=lr,cr,ur=1,hr=ar.toText(or),fr=hr.lines==ar.selection.ranges.length;if(lastLinewiseCopy!=null&&ar.selection.ranges.every(pr=>pr.empty)&&lastLinewiseCopy==hr.toString()){let pr=-1;cr=ar.changeByRange(mr=>{let gr=ar.doc.lineAt(mr.from);if(gr.from==pr)return{range:mr};pr=gr.from;let yr=ar.toText((fr?hr.line(ur++).text:or)+ar.lineBreak);return{changes:{from:gr.from,insert:yr},range:EditorSelection.cursor(mr.from+yr.length)}})}else fr?cr=ar.changeByRange(pr=>{let mr=hr.line(ur++);return{changes:{from:pr.from,to:pr.to,insert:mr.text},range:EditorSelection.cursor(pr.from+mr.length)}}):cr=ar.replaceSelection(hr);lr.dispatch(cr,{userEvent:"input.paste",scrollIntoView:!0})}handlers.keydown=(lr,or)=>{lr.inputState.setSelectionOrigin("select"),or.keyCode==27&&(lr.inputState.lastEscPress=Date.now())};handlers.touchstart=(lr,or)=>{lr.inputState.lastTouchTime=Date.now(),lr.inputState.setSelectionOrigin("select.pointer")};handlers.touchmove=lr=>{lr.inputState.setSelectionOrigin("select.pointer")};handlerOptions.touchstart=handlerOptions.touchmove={passive:!0};handlers.mousedown=(lr,or)=>{if(lr.observer.flush(),lr.inputState.lastTouchTime>Date.now()-2e3)return;let ar=null;for(let cr of lr.state.facet(mouseSelectionStyle))if(ar=cr(lr,or),ar)break;if(!ar&&or.button==0&&(ar=basicMouseSelection(lr,or)),ar){let cr=!lr.hasFocus;lr.inputState.startMouseSelection(new MouseSelection(lr,or,ar,cr)),cr&&lr.observer.ignore(()=>focusPreventScroll(lr.contentDOM)),lr.inputState.mouseSelection&&lr.inputState.mouseSelection.start(or)}};function rangeForClick(lr,or,ar,cr){if(cr==1)return EditorSelection.cursor(or,ar);if(cr==2)return groupAt(lr.state,or,ar);{let ur=LineView.find(lr.docView,or),hr=lr.state.doc.lineAt(ur?ur.posAtEnd:or),fr=ur?ur.posAtStart:hr.from,dr=ur?ur.posAtEnd:hr.to;return dr<lr.state.doc.length&&dr==hr.to&&dr++,EditorSelection.range(fr,dr)}}let insideY=(lr,or)=>lr>=or.top&&lr<=or.bottom,inside=(lr,or,ar)=>insideY(or,ar)&&lr>=ar.left&&lr<=ar.right;function findPositionSide(lr,or,ar,cr){let ur=LineView.find(lr.docView,or);if(!ur)return 1;let hr=or-ur.posAtStart;if(hr==0)return 1;if(hr==ur.length)return-1;let fr=ur.coordsAt(hr,-1);if(fr&&inside(ar,cr,fr))return-1;let dr=ur.coordsAt(hr,1);return dr&&inside(ar,cr,dr)?1:fr&&insideY(cr,fr)?-1:1}function queryPos(lr,or){let ar=lr.posAtCoords({x:or.clientX,y:or.clientY},!1);return{pos:ar,bias:findPositionSide(lr,ar,or.clientX,or.clientY)}}const BadMouseDetail=browser$2.ie&&browser$2.ie_version<=11;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(lr){if(!BadMouseDetail)return lr.detail;let or=lastMouseDown,ar=lastMouseDownTime;return lastMouseDown=lr,lastMouseDownTime=Date.now(),lastMouseDownCount=!or||ar>Date.now()-400&&Math.abs(or.clientX-lr.clientX)<2&&Math.abs(or.clientY-lr.clientY)<2?(lastMouseDownCount+1)%3:1}function basicMouseSelection(lr,or){let ar=queryPos(lr,or),cr=getClickType(or),ur=lr.state.selection;return{update(hr){hr.docChanged&&(ar.pos=hr.changes.mapPos(ar.pos),ur=ur.map(hr.changes))},get(hr,fr,dr){let pr=queryPos(lr,hr),mr,gr=rangeForClick(lr,pr.pos,pr.bias,cr);if(ar.pos!=pr.pos&&!fr){let yr=rangeForClick(lr,ar.pos,ar.bias,cr),br=Math.min(yr.from,gr.from),Or=Math.max(yr.to,gr.to);gr=br<gr.from?EditorSelection.range(br,Or):EditorSelection.range(Or,br)}return fr?ur.replaceRange(ur.main.extend(gr.from,gr.to)):dr&&cr==1&&ur.ranges.length>1&&(mr=removeRangeAround(ur,pr.pos))?mr:dr?ur.addRange(gr):EditorSelection.create([gr])}}}function removeRangeAround(lr,or){for(let ar=0;ar<lr.ranges.length;ar++){let{from:cr,to:ur}=lr.ranges[ar];if(cr<=or&&ur>=or)return EditorSelection.create(lr.ranges.slice(0,ar).concat(lr.ranges.slice(ar+1)),lr.mainIndex==ar?0:lr.mainIndex-(lr.mainIndex>ar?1:0))}return null}handlers.dragstart=(lr,or)=>{let{selection:{main:ar}}=lr.state,{mouseSelection:cr}=lr.inputState;cr&&(cr.dragging=ar),or.dataTransfer&&(or.dataTransfer.setData("Text",lr.state.sliceDoc(ar.from,ar.to)),or.dataTransfer.effectAllowed="copyMove")};function dropText(lr,or,ar,cr){if(!ar)return;let ur=lr.posAtCoords({x:or.clientX,y:or.clientY},!1);or.preventDefault();let{mouseSelection:hr}=lr.inputState,fr=cr&&hr&&hr.dragging&&dragMovesSelection(lr,or)?{from:hr.dragging.from,to:hr.dragging.to}:null,dr={from:ur,insert:ar},pr=lr.state.changes(fr?[fr,dr]:dr);lr.focus(),lr.dispatch({changes:pr,selection:{anchor:pr.mapPos(ur,-1),head:pr.mapPos(ur,1)},userEvent:fr?"move.drop":"input.drop"})}handlers.drop=(lr,or)=>{if(!or.dataTransfer)return;if(lr.state.readOnly)return or.preventDefault();let ar=or.dataTransfer.files;if(ar&&ar.length){or.preventDefault();let cr=Array(ar.length),ur=0,hr=()=>{++ur==ar.length&&dropText(lr,or,cr.filter(fr=>fr!=null).join(lr.state.lineBreak),!1)};for(let fr=0;fr<ar.length;fr++){let dr=new FileReader;dr.onerror=hr,dr.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(dr.result)||(cr[fr]=dr.result),hr()},dr.readAsText(ar[fr])}}else dropText(lr,or,or.dataTransfer.getData("Text"),!0)};handlers.paste=(lr,or)=>{if(lr.state.readOnly)return or.preventDefault();lr.observer.flush();let ar=brokenClipboardAPI?null:or.clipboardData;ar?(doPaste(lr,ar.getData("text/plain")||ar.getData("text/uri-text")),or.preventDefault()):capturePaste(lr)};function captureCopy(lr,or){let ar=lr.dom.parentNode;if(!ar)return;let cr=ar.appendChild(document.createElement("textarea"));cr.style.cssText="position: fixed; left: -10000px; top: 10px",cr.value=or,cr.focus(),cr.selectionEnd=or.length,cr.selectionStart=0,setTimeout(()=>{cr.remove(),lr.focus()},50)}function copiedRange(lr){let or=[],ar=[],cr=!1;for(let ur of lr.selection.ranges)ur.empty||(or.push(lr.sliceDoc(ur.from,ur.to)),ar.push(ur));if(!or.length){let ur=-1;for(let{from:hr}of lr.selection.ranges){let fr=lr.doc.lineAt(hr);fr.number>ur&&(or.push(fr.text),ar.push({from:fr.from,to:Math.min(lr.doc.length,fr.to+1)})),ur=fr.number}cr=!0}return{text:or.join(lr.lineBreak),ranges:ar,linewise:cr}}let lastLinewiseCopy=null;handlers.copy=handlers.cut=(lr,or)=>{let{text:ar,ranges:cr,linewise:ur}=copiedRange(lr.state);if(!ar&&!ur)return;lastLinewiseCopy=ur?ar:null;let hr=brokenClipboardAPI?null:or.clipboardData;hr?(or.preventDefault(),hr.clearData(),hr.setData("text/plain",ar)):captureCopy(lr,ar),or.type=="cut"&&!lr.state.readOnly&&lr.dispatch({changes:cr,scrollIntoView:!0,userEvent:"delete.cut"})};const isFocusChange=Annotation.define();function focusChangeTransaction(lr,or){let ar=[];for(let cr of lr.facet(focusChangeEffect)){let ur=cr(lr,or);ur&&ar.push(ur)}return ar?lr.update({effects:ar,annotations:isFocusChange.of(!0)}):null}function updateForFocusChange(lr){setTimeout(()=>{let or=lr.hasFocus;if(or!=lr.inputState.notifiedFocused){let ar=focusChangeTransaction(lr.state,or);ar?lr.dispatch(ar):lr.update([])}},10)}handlers.focus=lr=>{lr.inputState.lastFocusTime=Date.now(),!lr.scrollDOM.scrollTop&&(lr.inputState.lastScrollTop||lr.inputState.lastScrollLeft)&&(lr.scrollDOM.scrollTop=lr.inputState.lastScrollTop,lr.scrollDOM.scrollLeft=lr.inputState.lastScrollLeft),updateForFocusChange(lr)};handlers.blur=lr=>{lr.observer.clearSelectionRange(),updateForFocusChange(lr)};handlers.compositionstart=handlers.compositionupdate=lr=>{lr.inputState.compositionFirstChange==null&&(lr.inputState.compositionFirstChange=!0),lr.inputState.composing<0&&(lr.inputState.composing=0)};handlers.compositionend=lr=>{lr.inputState.composing=-1,lr.inputState.compositionEndedAt=Date.now(),lr.inputState.compositionPendingKey=!0,lr.inputState.compositionPendingChange=lr.observer.pendingRecords().length>0,lr.inputState.compositionFirstChange=null,browser$2.chrome&&browser$2.android?lr.observer.flushSoon():lr.inputState.compositionPendingChange?Promise.resolve().then(()=>lr.observer.flush()):setTimeout(()=>{lr.inputState.composing<0&&lr.docView.hasComposition&&lr.update([])},50)};handlers.contextmenu=lr=>{lr.inputState.lastContextMenu=Date.now()};handlers.beforeinput=(lr,or)=>{var ar;let cr;if(browser$2.chrome&&browser$2.android&&(cr=PendingKeys.find(ur=>ur.inputType==or.inputType))&&(lr.observer.delayAndroidKey(cr.key,cr.keyCode),cr.key=="Backspace"||cr.key=="Delete")){let ur=((ar=window.visualViewport)===null||ar===void 0?void 0:ar.height)||0;setTimeout(()=>{var hr;(((hr=window.visualViewport)===null||hr===void 0?void 0:hr.height)||0)>ur+10&&lr.hasFocus&&(lr.contentDOM.blur(),lr.focus())},100)}};const appliedFirefoxHack=new Set;function firefoxCopyCutHack(lr){appliedFirefoxHack.has(lr)||(appliedFirefoxHack.add(lr),lr.addEventListener("copy",()=>{}),lr.addEventListener("cut",()=>{}))}const wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];class HeightOracle{constructor(or){this.lineWrapping=or,this.doc=Text$2.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(or,ar){let cr=this.doc.lineAt(ar).number-this.doc.lineAt(or).number+1;return this.lineWrapping&&(cr+=Math.max(0,Math.ceil((ar-or-cr*this.lineLength*.5)/this.lineLength))),this.lineHeight*cr}heightForLine(or){return this.lineWrapping?(1+Math.max(0,Math.ceil((or-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(or){return this.doc=or,this}mustRefreshForWrapping(or){return wrappingWhiteSpace.indexOf(or)>-1!=this.lineWrapping}mustRefreshForHeights(or){let ar=!1;for(let cr=0;cr<or.length;cr++){let ur=or[cr];ur<0?cr++:this.heightSamples[Math.floor(ur*10)]||(ar=!0,this.heightSamples[Math.floor(ur*10)]=!0)}return ar}refresh(or,ar,cr,ur,hr,fr){let dr=wrappingWhiteSpace.indexOf(or)>-1,pr=Math.round(ar)!=Math.round(this.lineHeight)||this.lineWrapping!=dr;if(this.lineWrapping=dr,this.lineHeight=ar,this.charWidth=cr,this.textHeight=ur,this.lineLength=hr,pr){this.heightSamples={};for(let mr=0;mr<fr.length;mr++){let gr=fr[mr];gr<0?mr++:this.heightSamples[Math.floor(gr*10)]=!0}}return pr}}class MeasuredHeights{constructor(or,ar){this.from=or,this.heights=ar,this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(or,ar,cr,ur,hr){this.from=or,this.length=ar,this.top=cr,this.height=ur,this._content=hr}get type(){return typeof this._content=="number"?BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof PointDecoration?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(or){let ar=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(or._content)?or._content:[or]);return new BlockInfo(this.from,this.length+or.length,this.top,this.height+or.height,ar)}}var QueryType$1=function(lr){return lr[lr.ByPos=0]="ByPos",lr[lr.ByHeight=1]="ByHeight",lr[lr.ByPosNoHeight=2]="ByPosNoHeight",lr}(QueryType$1||(QueryType$1={}));const Epsilon=.001;class HeightMap{constructor(or,ar,cr=2){this.length=or,this.height=ar,this.flags=cr}get outdated(){return(this.flags&2)>0}set outdated(or){this.flags=(or?2:0)|this.flags&-3}setHeight(or,ar){this.height!=ar&&(Math.abs(this.height-ar)>Epsilon&&(or.heightChanged=!0),this.height=ar)}replace(or,ar,cr){return HeightMap.of(cr)}decomposeLeft(or,ar){ar.push(this)}decomposeRight(or,ar){ar.push(this)}applyChanges(or,ar,cr,ur){let hr=this,fr=cr.doc;for(let dr=ur.length-1;dr>=0;dr--){let{fromA:pr,toA:mr,fromB:gr,toB:yr}=ur[dr],br=hr.lineAt(pr,QueryType$1.ByPosNoHeight,cr.setDoc(ar),0,0),Or=br.to>=mr?br:hr.lineAt(mr,QueryType$1.ByPosNoHeight,cr,0,0);for(yr+=Or.to-mr,mr=Or.to;dr>0&&br.from<=ur[dr-1].toA;)pr=ur[dr-1].fromA,gr=ur[dr-1].fromB,dr--,pr<br.from&&(br=hr.lineAt(pr,QueryType$1.ByPosNoHeight,cr,0,0));gr+=br.from-pr,pr=br.from;let _r=NodeBuilder.build(cr.setDoc(fr),or,gr,yr);hr=hr.replace(pr,mr,_r)}return hr.updateHeight(cr,0)}static empty(){return new HeightMapText(0,0)}static of(or){if(or.length==1)return or[0];let ar=0,cr=or.length,ur=0,hr=0;for(;;)if(ar==cr)if(ur>hr*2){let dr=or[ar-1];dr.break?or.splice(--ar,1,dr.left,null,dr.right):or.splice(--ar,1,dr.left,dr.right),cr+=1+dr.break,ur-=dr.size}else if(hr>ur*2){let dr=or[cr];dr.break?or.splice(cr,1,dr.left,null,dr.right):or.splice(cr,1,dr.left,dr.right),cr+=2+dr.break,hr-=dr.size}else break;else if(ur<hr){let dr=or[ar++];dr&&(ur+=dr.size)}else{let dr=or[--cr];dr&&(hr+=dr.size)}let fr=0;return or[ar-1]==null?(fr=1,ar--):or[ar]==null&&(fr=1,cr++),new HeightMapBranch(HeightMap.of(or.slice(0,ar)),fr,HeightMap.of(or.slice(cr)))}}HeightMap.prototype.size=1;class HeightMapBlock extends HeightMap{constructor(or,ar,cr){super(or,ar),this.deco=cr}blockAt(or,ar,cr,ur){return new BlockInfo(ur,this.length,cr,this.height,this.deco||0)}lineAt(or,ar,cr,ur,hr){return this.blockAt(0,cr,ur,hr)}forEachLine(or,ar,cr,ur,hr,fr){or<=hr+this.length&&ar>=hr&&fr(this.blockAt(0,cr,ur,hr))}updateHeight(or,ar=0,cr=!1,ur){return ur&&ur.from<=ar&&ur.more&&this.setHeight(or,ur.heights[ur.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(or,ar){super(or,ar,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(or,ar,cr,ur){return new BlockInfo(ur,this.length,cr,this.height,this.breaks)}replace(or,ar,cr){let ur=cr[0];return cr.length==1&&(ur instanceof HeightMapText||ur instanceof HeightMapGap&&ur.flags&4)&&Math.abs(this.length-ur.length)<10?(ur instanceof HeightMapGap?ur=new HeightMapText(ur.length,this.height):ur.height=this.height,this.outdated||(ur.outdated=!1),ur):HeightMap.of(cr)}updateHeight(or,ar=0,cr=!1,ur){return ur&&ur.from<=ar&&ur.more?this.setHeight(or,ur.heights[ur.index++]):(cr||this.outdated)&&this.setHeight(or,Math.max(this.widgetHeight,or.heightForLine(this.length-this.collapsed))+this.breaks*or.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(or){super(or,0)}heightMetrics(or,ar){let cr=or.doc.lineAt(ar).number,ur=or.doc.lineAt(ar+this.length).number,hr=ur-cr+1,fr,dr=0;if(or.lineWrapping){let pr=Math.min(this.height,or.lineHeight*hr);fr=pr/hr,this.length>hr+1&&(dr=(this.height-pr)/(this.length-hr-1))}else fr=this.height/hr;return{firstLine:cr,lastLine:ur,perLine:fr,perChar:dr}}blockAt(or,ar,cr,ur){let{firstLine:hr,lastLine:fr,perLine:dr,perChar:pr}=this.heightMetrics(ar,ur);if(ar.lineWrapping){let mr=ur+Math.round(Math.max(0,Math.min(1,(or-cr)/this.height))*this.length),gr=ar.doc.lineAt(mr),yr=dr+gr.length*pr,br=Math.max(cr,or-yr/2);return new BlockInfo(gr.from,gr.length,br,yr,0)}else{let mr=Math.max(0,Math.min(fr-hr,Math.floor((or-cr)/dr))),{from:gr,length:yr}=ar.doc.line(hr+mr);return new BlockInfo(gr,yr,cr+dr*mr,dr,0)}}lineAt(or,ar,cr,ur,hr){if(ar==QueryType$1.ByHeight)return this.blockAt(or,cr,ur,hr);if(ar==QueryType$1.ByPosNoHeight){let{from:Or,to:_r}=cr.doc.lineAt(or);return new BlockInfo(Or,_r-Or,0,0,0)}let{firstLine:fr,perLine:dr,perChar:pr}=this.heightMetrics(cr,hr),mr=cr.doc.lineAt(or),gr=dr+mr.length*pr,yr=mr.number-fr,br=ur+dr*yr+pr*(mr.from-hr-yr);return new BlockInfo(mr.from,mr.length,Math.max(ur,Math.min(br,ur+this.height-gr)),gr,0)}forEachLine(or,ar,cr,ur,hr,fr){or=Math.max(or,hr),ar=Math.min(ar,hr+this.length);let{firstLine:dr,perLine:pr,perChar:mr}=this.heightMetrics(cr,hr);for(let gr=or,yr=ur;gr<=ar;){let br=cr.doc.lineAt(gr);if(gr==or){let _r=br.number-dr;yr+=pr*_r+mr*(or-hr-_r)}let Or=pr+mr*br.length;fr(new BlockInfo(br.from,br.length,yr,Or,0)),yr+=Or,gr=br.to+1}}replace(or,ar,cr){let ur=this.length-ar;if(ur>0){let hr=cr[cr.length-1];hr instanceof HeightMapGap?cr[cr.length-1]=new HeightMapGap(hr.length+ur):cr.push(null,new HeightMapGap(ur-1))}if(or>0){let hr=cr[0];hr instanceof HeightMapGap?cr[0]=new HeightMapGap(or+hr.length):cr.unshift(new HeightMapGap(or-1),null)}return HeightMap.of(cr)}decomposeLeft(or,ar){ar.push(new HeightMapGap(or-1),null)}decomposeRight(or,ar){ar.push(null,new HeightMapGap(this.length-or-1))}updateHeight(or,ar=0,cr=!1,ur){let hr=ar+this.length;if(ur&&ur.from<=ar+this.length&&ur.more){let fr=[],dr=Math.max(ar,ur.from),pr=-1;for(ur.from>ar&&fr.push(new HeightMapGap(ur.from-ar-1).updateHeight(or,ar));dr<=hr&&ur.more;){let gr=or.doc.lineAt(dr).length;fr.length&&fr.push(null);let yr=ur.heights[ur.index++];pr==-1?pr=yr:Math.abs(yr-pr)>=Epsilon&&(pr=-2);let br=new HeightMapText(gr,yr);br.outdated=!1,fr.push(br),dr+=gr+1}dr<=hr&&fr.push(null,new HeightMapGap(hr-dr).updateHeight(or,dr));let mr=HeightMap.of(fr);return(pr<0||Math.abs(mr.height-this.height)>=Epsilon||Math.abs(pr-this.heightMetrics(or,ar).perLine)>=Epsilon)&&(or.heightChanged=!0),mr}else(cr||this.outdated)&&(this.setHeight(or,or.heightForGap(ar,ar+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(or,ar,cr){super(or.length+ar+cr.length,or.height+cr.height,ar|(or.outdated||cr.outdated?2:0)),this.left=or,this.right=cr,this.size=or.size+cr.size}get break(){return this.flags&1}blockAt(or,ar,cr,ur){let hr=cr+this.left.height;return or<hr?this.left.blockAt(or,ar,cr,ur):this.right.blockAt(or,ar,hr,ur+this.left.length+this.break)}lineAt(or,ar,cr,ur,hr){let fr=ur+this.left.height,dr=hr+this.left.length+this.break,pr=ar==QueryType$1.ByHeight?or<fr:or<dr,mr=pr?this.left.lineAt(or,ar,cr,ur,hr):this.right.lineAt(or,ar,cr,fr,dr);if(this.break||(pr?mr.to<dr:mr.from>dr))return mr;let gr=ar==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;return pr?mr.join(this.right.lineAt(dr,gr,cr,fr,dr)):this.left.lineAt(dr,gr,cr,ur,hr).join(mr)}forEachLine(or,ar,cr,ur,hr,fr){let dr=ur+this.left.height,pr=hr+this.left.length+this.break;if(this.break)or<pr&&this.left.forEachLine(or,ar,cr,ur,hr,fr),ar>=pr&&this.right.forEachLine(or,ar,cr,dr,pr,fr);else{let mr=this.lineAt(pr,QueryType$1.ByPos,cr,ur,hr);or<mr.from&&this.left.forEachLine(or,mr.from-1,cr,ur,hr,fr),mr.to>=or&&mr.from<=ar&&fr(mr),ar>mr.to&&this.right.forEachLine(mr.to+1,ar,cr,dr,pr,fr)}}replace(or,ar,cr){let ur=this.left.length+this.break;if(ar<ur)return this.balanced(this.left.replace(or,ar,cr),this.right);if(or>this.left.length)return this.balanced(this.left,this.right.replace(or-ur,ar-ur,cr));let hr=[];or>0&&this.decomposeLeft(or,hr);let fr=hr.length;for(let dr of cr)hr.push(dr);if(or>0&&mergeGaps(hr,fr-1),ar<this.length){let dr=hr.length;this.decomposeRight(ar,hr),mergeGaps(hr,dr)}return HeightMap.of(hr)}decomposeLeft(or,ar){let cr=this.left.length;if(or<=cr)return this.left.decomposeLeft(or,ar);ar.push(this.left),this.break&&(cr++,or>=cr&&ar.push(null)),or>cr&&this.right.decomposeLeft(or-cr,ar)}decomposeRight(or,ar){let cr=this.left.length,ur=cr+this.break;if(or>=ur)return this.right.decomposeRight(or-ur,ar);or<cr&&this.left.decomposeRight(or,ar),this.break&&or<ur&&ar.push(null),ar.push(this.right)}balanced(or,ar){return or.size>2*ar.size||ar.size>2*or.size?HeightMap.of(this.break?[or,null,ar]:[or,ar]):(this.left=or,this.right=ar,this.height=or.height+ar.height,this.outdated=or.outdated||ar.outdated,this.size=or.size+ar.size,this.length=or.length+this.break+ar.length,this)}updateHeight(or,ar=0,cr=!1,ur){let{left:hr,right:fr}=this,dr=ar+hr.length+this.break,pr=null;return ur&&ur.from<=ar+hr.length&&ur.more?pr=hr=hr.updateHeight(or,ar,cr,ur):hr.updateHeight(or,ar,cr),ur&&ur.from<=dr+fr.length&&ur.more?pr=fr=fr.updateHeight(or,dr,cr,ur):fr.updateHeight(or,dr,cr),pr?this.balanced(hr,fr):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mergeGaps(lr,or){let ar,cr;lr[or]==null&&(ar=lr[or-1])instanceof HeightMapGap&&(cr=lr[or+1])instanceof HeightMapGap&&lr.splice(or-1,3,new HeightMapGap(ar.length+1+cr.length))}const relevantWidgetHeight=5;class NodeBuilder{constructor(or,ar){this.pos=or,this.oracle=ar,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=or}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(or,ar){if(this.lineStart>-1){let cr=Math.min(ar,this.lineEnd),ur=this.nodes[this.nodes.length-1];ur instanceof HeightMapText?ur.length+=cr-this.pos:(cr>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(cr-this.pos,-1)),this.writtenTo=cr,ar>cr&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=ar}point(or,ar,cr){if(or<ar||cr.heightRelevant){let ur=cr.widget?cr.widget.estimatedHeight:0,hr=cr.widget?cr.widget.lineBreaks:0;ur<0&&(ur=this.oracle.lineHeight);let fr=ar-or;cr.block?this.addBlock(new HeightMapBlock(fr,ur,cr)):(fr||hr||ur>=relevantWidgetHeight)&&this.addLineDeco(ur,hr,fr)}else ar>or&&this.span(or,ar);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:or,to:ar}=this.oracle.doc.lineAt(this.pos);this.lineStart=or,this.lineEnd=ar,this.writtenTo<or&&((this.writtenTo<or-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,or-1)),this.nodes.push(null)),this.pos>or&&this.nodes.push(new HeightMapText(this.pos-or,-1)),this.writtenTo=this.pos}blankContent(or,ar){let cr=new HeightMapGap(ar-or);return this.oracle.doc.lineAt(or).to==ar&&(cr.flags|=4),cr}ensureLine(){this.enterLine();let or=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(or instanceof HeightMapText)return or;let ar=new HeightMapText(0,-1);return this.nodes.push(ar),ar}addBlock(or){var ar;this.enterLine();let cr=(ar=or.deco)===null||ar===void 0?void 0:ar.type;cr==BlockType.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(or),this.writtenTo=this.pos=this.pos+or.length,cr!=BlockType.WidgetBefore&&(this.covering=or)}addLineDeco(or,ar,cr){let ur=this.ensureLine();ur.length+=cr,ur.collapsed+=cr,ur.widgetHeight=Math.max(ur.widgetHeight,or),ur.breaks+=ar,this.writtenTo=this.pos=this.pos+cr}finish(or){let ar=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(ar instanceof HeightMapText)&&!this.isCovered?this.nodes.push(new HeightMapText(0,-1)):(this.writtenTo<this.pos||ar==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let cr=or;for(let ur of this.nodes)ur instanceof HeightMapText&&ur.updateHeight(this.oracle,cr),cr+=ur?ur.length:1;return this.nodes}static build(or,ar,cr,ur){let hr=new NodeBuilder(cr,or);return RangeSet.spans(ar,cr,ur,hr,0),hr.finish(cr)}}function heightRelevantDecoChanges(lr,or,ar){let cr=new DecorationComparator;return RangeSet.compare(lr,or,ar,cr,0),cr.changes}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(or,ar,cr,ur){(or<ar||cr&&cr.heightRelevant||ur&&ur.heightRelevant)&&addRange(or,ar,this.changes,5)}}function visiblePixelRange(lr,or){let ar=lr.getBoundingClientRect(),cr=lr.ownerDocument,ur=cr.defaultView||window,hr=Math.max(0,ar.left),fr=Math.min(ur.innerWidth,ar.right),dr=Math.max(0,ar.top),pr=Math.min(ur.innerHeight,ar.bottom);for(let mr=lr.parentNode;mr&&mr!=cr.body;)if(mr.nodeType==1){let gr=mr,yr=window.getComputedStyle(gr);if((gr.scrollHeight>gr.clientHeight||gr.scrollWidth>gr.clientWidth)&&yr.overflow!="visible"){let br=gr.getBoundingClientRect();hr=Math.max(hr,br.left),fr=Math.min(fr,br.right),dr=Math.max(dr,br.top),pr=mr==lr.parentNode?br.bottom:Math.min(pr,br.bottom)}mr=yr.position=="absolute"||yr.position=="fixed"?gr.offsetParent:gr.parentNode}else if(mr.nodeType==11)mr=mr.host;else break;return{left:hr-ar.left,right:Math.max(hr,fr)-ar.left,top:dr-(ar.top+or),bottom:Math.max(dr,pr)-(ar.top+or)}}function fullPixelRange(lr,or){let ar=lr.getBoundingClientRect();return{left:0,right:ar.right-ar.left,top:or,bottom:ar.bottom-(ar.top+or)}}class LineGap{constructor(or,ar,cr){this.from=or,this.to=ar,this.size=cr}static same(or,ar){if(or.length!=ar.length)return!1;for(let cr=0;cr<or.length;cr++){let ur=or[cr],hr=ar[cr];if(ur.from!=hr.from||ur.to!=hr.to||ur.size!=hr.size)return!1}return!0}draw(or,ar){return Decoration.replace({widget:new LineGapWidget(this.size*(ar?or.scaleY:or.scaleX),ar)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(or,ar){super(),this.size=or,this.vertical=ar}eq(or){return or.size==this.size&&or.vertical==this.vertical}toDOM(){let or=document.createElement("div");return this.vertical?or.style.height=this.size+"px":(or.style.width=this.size+"px",or.style.height="2px",or.style.display="inline-block"),or}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(or){this.state=or,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IdScaler,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let ar=or.facet(contentAttributes).some(cr=>typeof cr!="function"&&cr.class=="cm-lineWrapping");this.heightOracle=new HeightOracle(ar),this.stateDeco=or.facet(decorations).filter(cr=>typeof cr!="function"),this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text$2.empty,this.heightOracle.setDoc(or.doc),[new ChangedRange(0,0,0,or.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration.set(this.lineGaps.map(cr=>cr.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let or=[this.viewport],{main:ar}=this.state.selection;for(let cr=0;cr<=1;cr++){let ur=cr?ar.head:ar.anchor;if(!or.some(({from:hr,to:fr})=>ur>=hr&&ur<=fr)){let{from:hr,to:fr}=this.lineBlockAt(ur);or.push(new Viewport(hr,fr))}}this.viewports=or.sort((cr,ur)=>cr.from-ur.from),this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,or=>{this.viewportLines.push(this.scaler.scale==1?or:scaleBlock(or,this.scaler))})}update(or,ar=null){this.state=or.state;let cr=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter(gr=>typeof gr!="function");let ur=or.changedRanges,hr=ChangedRange.extendWithRanges(ur,heightRelevantDecoChanges(cr,this.stateDeco,or?or.changes:ChangeSet.empty(this.state.doc.length))),fr=this.heightMap.height,dr=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,or.startState.doc,this.heightOracle.setDoc(this.state.doc),hr),this.heightMap.height!=fr&&(or.flags|=2),dr?(this.scrollAnchorPos=or.changes.mapPos(dr.from,-1),this.scrollAnchorHeight=dr.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let pr=hr.length?this.mapViewport(this.viewport,or.changes):this.viewport;(ar&&(ar.range.head<pr.from||ar.range.head>pr.to)||!this.viewportIsAppropriate(pr))&&(pr=this.getViewport(0,ar));let mr=!or.changes.empty||or.flags&2||pr.from!=this.viewport.from||pr.to!=this.viewport.to;this.viewport=pr,this.updateForViewport(),mr&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,or.changes))),or.flags|=this.computeVisibleRanges(),ar&&(this.scrollTarget=ar),!this.mustEnforceCursorAssoc&&or.selectionSet&&or.view.lineWrapping&&or.state.selection.main.empty&&or.state.selection.main.assoc&&!or.state.facet(nativeSelectionHidden)&&(this.mustEnforceCursorAssoc=!0)}measure(or){let ar=or.contentDOM,cr=window.getComputedStyle(ar),ur=this.heightOracle,hr=cr.whiteSpace;this.defaultTextDirection=cr.direction=="rtl"?Direction.RTL:Direction.LTR;let fr=this.heightOracle.mustRefreshForWrapping(hr),dr=ar.getBoundingClientRect(),pr=fr||this.mustMeasureContent||this.contentDOMHeight!=dr.height;this.contentDOMHeight=dr.height,this.mustMeasureContent=!1;let mr=0,gr=0;if(dr.width&&dr.height){let $r=dr.width/ar.offsetWidth,Nr=dr.height/ar.offsetHeight;$r>.995&&$r<1.005&&($r=1),Nr>.995&&Nr<1.005&&(Nr=1),(this.scaleX!=$r||this.scaleY!=Nr)&&(this.scaleX=$r,this.scaleY=Nr,mr|=8,fr=pr=!0)}let yr=(parseInt(cr.paddingTop)||0)*this.scaleY,br=(parseInt(cr.paddingBottom)||0)*this.scaleY;(this.paddingTop!=yr||this.paddingBottom!=br)&&(this.paddingTop=yr,this.paddingBottom=br,mr|=10),this.editorWidth!=or.scrollDOM.clientWidth&&(ur.lineWrapping&&(pr=!0),this.editorWidth=or.scrollDOM.clientWidth,mr|=8);let Or=or.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=Or&&(this.scrollAnchorHeight=-1,this.scrollTop=Or),this.scrolledToBottom=isScrolledToBottom(or.scrollDOM);let _r=(this.printing?fullPixelRange:visiblePixelRange)(ar,this.paddingTop),vr=_r.top-this.pixelViewport.top,xr=_r.bottom-this.pixelViewport.bottom;this.pixelViewport=_r;let wr=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(wr!=this.inView&&(this.inView=wr,wr&&(pr=!0)),!this.inView&&!this.scrollTarget)return 0;let kr=dr.width;if((this.contentDOMWidth!=kr||this.editorHeight!=or.scrollDOM.clientHeight)&&(this.contentDOMWidth=dr.width,this.editorHeight=or.scrollDOM.clientHeight,mr|=8),pr){let $r=or.docView.measureVisibleLineHeights(this.viewport);if(ur.mustRefreshForHeights($r)&&(fr=!0),fr||ur.lineWrapping&&Math.abs(kr-this.contentDOMWidth)>ur.charWidth){let{lineHeight:Nr,charWidth:Br,textHeight:Fr}=or.docView.measureTextSize();fr=Nr>0&&ur.refresh(hr,Nr,Br,Fr,kr/Br,$r),fr&&(or.docView.minWidth=0,mr|=8)}vr>0&&xr>0?gr=Math.max(vr,xr):vr<0&&xr<0&&(gr=Math.min(vr,xr)),ur.heightChanged=!1;for(let Nr of this.viewports){let Br=Nr.from==this.viewport.from?$r:or.docView.measureVisibleLineHeights(Nr);this.heightMap=(fr?HeightMap.empty().applyChanges(this.stateDeco,Text$2.empty,this.heightOracle,[new ChangedRange(0,0,0,or.state.doc.length)]):this.heightMap).updateHeight(ur,0,fr,new MeasuredHeights(Nr.from,Br))}ur.heightChanged&&(mr|=2)}let Cr=!this.viewportIsAppropriate(this.viewport,gr)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return Cr&&(this.viewport=this.getViewport(gr,this.scrollTarget)),this.updateForViewport(),(mr&2||Cr)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(fr?[]:this.lineGaps,or)),mr|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,or.docView.enforceCursorAssoc()),mr}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(or,ar){let cr=.5-Math.max(-.5,Math.min(.5,or/1e3/2)),ur=this.heightMap,hr=this.heightOracle,{visibleTop:fr,visibleBottom:dr}=this,pr=new Viewport(ur.lineAt(fr-cr*1e3,QueryType$1.ByHeight,hr,0,0).from,ur.lineAt(dr+(1-cr)*1e3,QueryType$1.ByHeight,hr,0,0).to);if(ar){let{head:mr}=ar.range;if(mr<pr.from||mr>pr.to){let gr=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),yr=ur.lineAt(mr,QueryType$1.ByPos,hr,0,0),br;ar.y=="center"?br=(yr.top+yr.bottom)/2-gr/2:ar.y=="start"||ar.y=="nearest"&&mr<pr.from?br=yr.top:br=yr.bottom-gr,pr=new Viewport(ur.lineAt(br-1e3/2,QueryType$1.ByHeight,hr,0,0).from,ur.lineAt(br+gr+1e3/2,QueryType$1.ByHeight,hr,0,0).to)}}return pr}mapViewport(or,ar){let cr=ar.mapPos(or.from,-1),ur=ar.mapPos(or.to,1);return new Viewport(this.heightMap.lineAt(cr,QueryType$1.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(ur,QueryType$1.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:or,to:ar},cr=0){if(!this.inView)return!0;let{top:ur}=this.heightMap.lineAt(or,QueryType$1.ByPos,this.heightOracle,0,0),{bottom:hr}=this.heightMap.lineAt(ar,QueryType$1.ByPos,this.heightOracle,0,0),{visibleTop:fr,visibleBottom:dr}=this;return(or==0||ur<=fr-Math.max(10,Math.min(-cr,250)))&&(ar==this.state.doc.length||hr>=dr+Math.max(10,Math.min(cr,250)))&&ur>fr-2*1e3&&hr<dr+2*1e3}mapLineGaps(or,ar){if(!or.length||ar.empty)return or;let cr=[];for(let ur of or)ar.touchesRange(ur.from,ur.to)||cr.push(new LineGap(ar.mapPos(ur.from),ar.mapPos(ur.to),ur.size));return cr}ensureLineGaps(or,ar){let cr=this.heightOracle.lineWrapping,ur=cr?1e4:2e3,hr=ur>>1,fr=ur<<1;if(this.defaultTextDirection!=Direction.LTR&&!cr)return[];let dr=[],pr=(mr,gr,yr,br)=>{if(gr-mr<hr)return;let Or=this.state.selection.main,_r=[Or.from];Or.empty||_r.push(Or.to);for(let xr of _r)if(xr>mr&&xr<gr){pr(mr,xr-10,yr,br),pr(xr+10,gr,yr,br);return}let vr=find(or,xr=>xr.from>=yr.from&&xr.to<=yr.to&&Math.abs(xr.from-mr)<hr&&Math.abs(xr.to-gr)<hr&&!_r.some(wr=>xr.from<wr&&xr.to>wr));if(!vr){if(gr<yr.to&&ar&&cr&&ar.visibleRanges.some(xr=>xr.from<=gr&&xr.to>=gr)){let xr=ar.moveToLineBoundary(EditorSelection.cursor(gr),!1,!0).head;xr>mr&&(gr=xr)}vr=new LineGap(mr,gr,this.gapSize(yr,mr,gr,br))}dr.push(vr)};for(let mr of this.viewportLines){if(mr.length<fr)continue;let gr=lineStructure(mr.from,mr.to,this.stateDeco);if(gr.total<fr)continue;let yr=this.scrollTarget?this.scrollTarget.range.head:null,br,Or;if(cr){let _r=ur/this.heightOracle.lineLength*this.heightOracle.lineHeight,vr,xr;if(yr!=null){let wr=findFraction(gr,yr),kr=((this.visibleBottom-this.visibleTop)/2+_r)/mr.height;vr=wr-kr,xr=wr+kr}else vr=(this.visibleTop-mr.top-_r)/mr.height,xr=(this.visibleBottom-mr.top+_r)/mr.height;br=findPosition(gr,vr),Or=findPosition(gr,xr)}else{let _r=gr.total*this.heightOracle.charWidth,vr=ur*this.heightOracle.charWidth,xr,wr;if(yr!=null){let kr=findFraction(gr,yr),Cr=((this.pixelViewport.right-this.pixelViewport.left)/2+vr)/_r;xr=kr-Cr,wr=kr+Cr}else xr=(this.pixelViewport.left-vr)/_r,wr=(this.pixelViewport.right+vr)/_r;br=findPosition(gr,xr),Or=findPosition(gr,wr)}br>mr.from&&pr(mr.from,br,mr,gr),Or<mr.to&&pr(Or,mr.to,mr,gr)}return dr}gapSize(or,ar,cr,ur){let hr=findFraction(ur,cr)-findFraction(ur,ar);return this.heightOracle.lineWrapping?or.height*hr:ur.total*this.heightOracle.charWidth*hr}updateLineGaps(or){LineGap.same(or,this.lineGaps)||(this.lineGaps=or,this.lineGapDeco=Decoration.set(or.map(ar=>ar.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let or=this.stateDeco;this.lineGaps.length&&(or=or.concat(this.lineGapDeco));let ar=[];RangeSet.spans(or,this.viewport.from,this.viewport.to,{span(ur,hr){ar.push({from:ur,to:hr})},point(){}},20);let cr=ar.length!=this.visibleRanges.length||this.visibleRanges.some((ur,hr)=>ur.from!=ar[hr].from||ur.to!=ar[hr].to);return this.visibleRanges=ar,cr?4:0}lineBlockAt(or){return or>=this.viewport.from&&or<=this.viewport.to&&this.viewportLines.find(ar=>ar.from<=or&&ar.to>=or)||scaleBlock(this.heightMap.lineAt(or,QueryType$1.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(or){return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(or),QueryType$1.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(or){let ar=this.lineBlockAtHeight(or+8);return ar.from>=this.viewport.from||this.viewportLines[0].top-or>200?ar:this.viewportLines[0]}elementAtHeight(or){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(or),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Viewport{constructor(or,ar){this.from=or,this.to=ar}}function lineStructure(lr,or,ar){let cr=[],ur=lr,hr=0;return RangeSet.spans(ar,lr,or,{span(){},point(fr,dr){fr>ur&&(cr.push({from:ur,to:fr}),hr+=fr-ur),ur=dr}},20),ur<or&&(cr.push({from:ur,to:or}),hr+=or-ur),{total:hr,ranges:cr}}function findPosition({total:lr,ranges:or},ar){if(ar<=0)return or[0].from;if(ar>=1)return or[or.length-1].to;let cr=Math.floor(lr*ar);for(let ur=0;;ur++){let{from:hr,to:fr}=or[ur],dr=fr-hr;if(cr<=dr)return hr+cr;cr-=dr}}function findFraction(lr,or){let ar=0;for(let{from:cr,to:ur}of lr.ranges){if(or<=ur){ar+=or-cr;break}ar+=ur-cr}return ar/lr.total}function find(lr,or){for(let ar of lr)if(or(ar))return ar}const IdScaler={toDOM(lr){return lr},fromDOM(lr){return lr},scale:1};class BigScaler{constructor(or,ar,cr){let ur=0,hr=0,fr=0;this.viewports=cr.map(({from:dr,to:pr})=>{let mr=ar.lineAt(dr,QueryType$1.ByPos,or,0,0).top,gr=ar.lineAt(pr,QueryType$1.ByPos,or,0,0).bottom;return ur+=gr-mr,{from:dr,to:pr,top:mr,bottom:gr,domTop:0,domBottom:0}}),this.scale=(7e6-ur)/(ar.height-ur);for(let dr of this.viewports)dr.domTop=fr+(dr.top-hr)*this.scale,fr=dr.domBottom=dr.domTop+(dr.bottom-dr.top),hr=dr.bottom}toDOM(or){for(let ar=0,cr=0,ur=0;;ar++){let hr=ar<this.viewports.length?this.viewports[ar]:null;if(!hr||or<hr.top)return ur+(or-cr)*this.scale;if(or<=hr.bottom)return hr.domTop+(or-hr.top);cr=hr.bottom,ur=hr.domBottom}}fromDOM(or){for(let ar=0,cr=0,ur=0;;ar++){let hr=ar<this.viewports.length?this.viewports[ar]:null;if(!hr||or<hr.domTop)return cr+(or-ur)/this.scale;if(or<=hr.domBottom)return hr.top+(or-hr.domTop);cr=hr.bottom,ur=hr.domBottom}}}function scaleBlock(lr,or){if(or.scale==1)return lr;let ar=or.toDOM(lr.top),cr=or.toDOM(lr.bottom);return new BlockInfo(lr.from,lr.length,ar,cr-ar,Array.isArray(lr._content)?lr._content.map(ur=>scaleBlock(ur,or)):lr._content)}const theme=Facet.define({combine:lr=>lr.join(" ")}),darkTheme=Facet.define({combine:lr=>lr.indexOf(!0)>-1}),baseThemeID=StyleModule.newName(),baseLightID=StyleModule.newName(),baseDarkID=StyleModule.newName(),lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(lr,or,ar){return new StyleModule(or,{finish(cr){return/&/.test(cr)?cr.replace(/&\w*/,ur=>{if(ur=="&")return lr;if(!ar||!ar[ur])throw new RangeError(`Unsupported selector: ${ur}`);return ar[ur]}):lr+" "+cr}})}const baseTheme$1$1=buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs);class DOMChange{constructor(or,ar,cr,ur){this.typeOver=ur,this.bounds=null,this.text="";let{impreciseHead:hr,impreciseAnchor:fr}=or.docView;if(or.state.readOnly&&ar>-1)this.newSel=null;else if(ar>-1&&(this.bounds=or.docView.domBoundsAround(ar,cr,0))){let dr=hr||fr?[]:selectionPoints(or),pr=new DOMReader(dr,or.state);pr.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=pr.text,this.newSel=selectionFromPoints(dr,this.bounds.from)}else{let dr=or.observer.selectionRange,pr=hr&&hr.node==dr.focusNode&&hr.offset==dr.focusOffset||!contains$1(or.contentDOM,dr.focusNode)?or.state.selection.main.head:or.docView.posFromDOM(dr.focusNode,dr.focusOffset),mr=fr&&fr.node==dr.anchorNode&&fr.offset==dr.anchorOffset||!contains$1(or.contentDOM,dr.anchorNode)?or.state.selection.main.anchor:or.docView.posFromDOM(dr.anchorNode,dr.anchorOffset);this.newSel=EditorSelection.single(mr,pr)}}}function applyDOMChange(lr,or){let ar,{newSel:cr}=or,ur=lr.state.selection.main,hr=lr.inputState.lastKeyTime>Date.now()-100?lr.inputState.lastKeyCode:-1;if(or.bounds){let{from:fr,to:dr}=or.bounds,pr=ur.from,mr=null;(hr===8||browser$2.android&&or.text.length<dr-fr)&&(pr=ur.to,mr="end");let gr=findDiff(lr.state.doc.sliceString(fr,dr,LineBreakPlaceholder),or.text,pr-fr,mr);gr&&(browser$2.chrome&&hr==13&&gr.toB==gr.from+2&&or.text.slice(gr.from,gr.toB)==LineBreakPlaceholder+LineBreakPlaceholder&&gr.toB--,ar={from:fr+gr.from,to:fr+gr.toA,insert:Text$2.of(or.text.slice(gr.from,gr.toB).split(LineBreakPlaceholder))})}else cr&&(!lr.hasFocus&&lr.state.facet(editable)||cr.main.eq(ur))&&(cr=null);if(!ar&&!cr)return!1;if(!ar&&or.typeOver&&!ur.empty&&cr&&cr.main.empty?ar={from:ur.from,to:ur.to,insert:lr.state.doc.slice(ur.from,ur.to)}:ar&&ar.from>=ur.from&&ar.to<=ur.to&&(ar.from!=ur.from||ar.to!=ur.to)&&ur.to-ur.from-(ar.to-ar.from)<=4?ar={from:ur.from,to:ur.to,insert:lr.state.doc.slice(ur.from,ar.from).append(ar.insert).append(lr.state.doc.slice(ar.to,ur.to))}:(browser$2.mac||browser$2.android)&&ar&&ar.from==ar.to&&ar.from==ur.head-1&&/^\. ?$/.test(ar.insert.toString())&&lr.contentDOM.getAttribute("autocorrect")=="off"?(cr&&ar.insert.length==2&&(cr=EditorSelection.single(cr.main.anchor-1,cr.main.head-1)),ar={from:ur.from,to:ur.to,insert:Text$2.of([" "])}):browser$2.chrome&&ar&&ar.from==ar.to&&ar.from==ur.head&&ar.insert.toString()==`
 `&&lr.lineWrapping&&(cr&&(cr=EditorSelection.single(cr.main.anchor-1,cr.main.head-1)),ar={from:ur.from,to:ur.to,insert:Text$2.of([" "])}),ar){if(browser$2.ios&&lr.inputState.flushIOSKey(lr)||browser$2.android&&(ar.from==ur.from&&ar.to==ur.to&&ar.insert.length==1&&ar.insert.lines==2&&dispatchKey(lr.contentDOM,"Enter",13)||(ar.from==ur.from-1&&ar.to==ur.to&&ar.insert.length==0||hr==8&&ar.insert.length<ar.to-ar.from&&ar.to>ur.head)&&dispatchKey(lr.contentDOM,"Backspace",8)||ar.from==ur.from&&ar.to==ur.to+1&&ar.insert.length==0&&dispatchKey(lr.contentDOM,"Delete",46)))return!0;let fr=ar.insert.toString();lr.inputState.composing>=0&&lr.inputState.composing++;let dr,pr=()=>dr||(dr=applyDefaultInsert(lr,ar,cr));return lr.state.facet(inputHandler).some(mr=>mr(lr,ar.from,ar.to,fr,pr))||lr.dispatch(pr()),!0}else if(cr&&!cr.main.eq(ur)){let fr=!1,dr="select";return lr.inputState.lastSelectionTime>Date.now()-50&&(lr.inputState.lastSelectionOrigin=="select"&&(fr=!0),dr=lr.inputState.lastSelectionOrigin),lr.dispatch({selection:cr,scrollIntoView:fr,userEvent:dr}),!0}else return!1}function applyDefaultInsert(lr,or,ar){let cr,ur=lr.state,hr=ur.selection.main;if(or.from>=hr.from&&or.to<=hr.to&&or.to-or.from>=(hr.to-hr.from)/3&&(!ar||ar.main.empty&&ar.main.from==or.from+or.insert.length)&&lr.inputState.composing<0){let dr=hr.from<or.from?ur.sliceDoc(hr.from,or.from):"",pr=hr.to>or.to?ur.sliceDoc(or.to,hr.to):"";cr=ur.replaceSelection(lr.state.toText(dr+or.insert.sliceString(0,void 0,lr.state.lineBreak)+pr))}else{let dr=ur.changes(or),pr=ar&&ar.main.to<=dr.newLength?ar.main:void 0;if(ur.selection.ranges.length>1&&lr.inputState.composing>=0&&or.to<=hr.to&&or.to>=hr.to-10){let mr=lr.state.sliceDoc(or.from,or.to),gr=findCompositionNode(lr,or.insert.length-(or.to-or.from))||lr.state.doc.lineAt(hr.head),yr=hr.to-or.to,br=hr.to-hr.from;cr=ur.changeByRange(Or=>{if(Or.from==hr.from&&Or.to==hr.to)return{changes:dr,range:pr||Or.map(dr)};let _r=Or.to-yr,vr=_r-mr.length;if(Or.to-Or.from!=br||lr.state.sliceDoc(vr,_r)!=mr||gr&&Or.to>=gr.from&&Or.from<=gr.to)return{range:Or};let xr=ur.changes({from:vr,to:_r,insert:or.insert}),wr=Or.to-hr.to;return{changes:xr,range:pr?EditorSelection.range(Math.max(0,pr.anchor+wr),Math.max(0,pr.head+wr)):Or.map(xr)}})}else cr={changes:dr,selection:pr&&ur.selection.replaceRange(pr)}}let fr="input.type";return(lr.composing||lr.inputState.compositionPendingChange&&lr.inputState.compositionEndedAt>Date.now()-50)&&(lr.inputState.compositionPendingChange=!1,fr+=".compose",lr.inputState.compositionFirstChange&&(fr+=".start",lr.inputState.compositionFirstChange=!1)),ur.update(cr,{userEvent:fr,scrollIntoView:!0})}function findDiff(lr,or,ar,cr){let ur=Math.min(lr.length,or.length),hr=0;for(;hr<ur&&lr.charCodeAt(hr)==or.charCodeAt(hr);)hr++;if(hr==ur&&lr.length==or.length)return null;let fr=lr.length,dr=or.length;for(;fr>0&&dr>0&&lr.charCodeAt(fr-1)==or.charCodeAt(dr-1);)fr--,dr--;if(cr=="end"){let pr=Math.max(0,hr-Math.min(fr,dr));ar-=fr+pr-hr}if(fr<hr&&lr.length<or.length){let pr=ar<=hr&&ar>=fr?hr-ar:0;hr-=pr,dr=hr+(dr-fr),fr=hr}else if(dr<hr){let pr=ar<=hr&&ar>=dr?hr-ar:0;hr-=pr,fr=hr+(fr-dr),dr=hr}return{from:hr,toA:fr,toB:dr}}function selectionPoints(lr){let or=[];if(lr.root.activeElement!=lr.contentDOM)return or;let{anchorNode:ar,anchorOffset:cr,focusNode:ur,focusOffset:hr}=lr.observer.selectionRange;return ar&&(or.push(new DOMPoint(ar,cr)),(ur!=ar||hr!=cr)&&or.push(new DOMPoint(ur,hr))),or}function selectionFromPoints(lr,or){if(lr.length==0)return null;let ar=lr[0].pos,cr=lr.length==2?lr[1].pos:ar;return ar>-1&&cr>-1?EditorSelection.single(ar+or,cr+or):null}const observeOptions={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData=browser$2.ie&&browser$2.ie_version<=11;class DOMObserver{constructor(or){this.view=or,this.active=!1,this.selectionRange=new DOMSelectionState,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=or.contentDOM,this.observer=new MutationObserver(ar=>{for(let cr of ar)this.queue.push(cr);(browser$2.ie&&browser$2.ie_version<=11||browser$2.ios&&or.composing)&&ar.some(cr=>cr.type=="childList"&&cr.removedNodes.length||cr.type=="characterData"&&cr.oldValue.length>cr.target.nodeValue.length)?this.flushSoon():this.flush()}),useCharData&&(this.onCharData=ar=>{this.queue.push({target:ar.target,type:"characterData",oldValue:ar.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var ar;((ar=this.view.docView)===null||ar===void 0?void 0:ar.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(or.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(or.contentDOM)),this.addWindowListeners(this.win=or.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(ar=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),ar.length>0&&ar[ar.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(ar=>{ar.length>0&&ar[ar.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(or){this.view.inputState.runScrollHandlers(this.view,or),this.intersecting&&this.view.measure()}onScroll(or){this.intersecting&&this.flush(!1),this.onScrollChanged(or)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(or){if(this.gapIntersection&&(or.length!=this.gaps.length||this.gaps.some((ar,cr)=>ar!=or[cr]))){this.gapIntersection.disconnect();for(let ar of or)this.gapIntersection.observe(ar);this.gaps=or}}onSelectionChange(or){let ar=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:cr}=this,ur=this.selectionRange;if(cr.state.facet(editable)?cr.root.activeElement!=this.dom:!hasSelection(cr.dom,ur))return;let hr=ur.anchorNode&&cr.docView.nearest(ur.anchorNode);if(hr&&hr.ignoreEvent(or)){ar||(this.selectionChanged=!1);return}(browser$2.ie&&browser$2.ie_version<=11||browser$2.android&&browser$2.chrome)&&!cr.state.selection.main.empty&&ur.focusNode&&isEquivalentPosition(ur.focusNode,ur.focusOffset,ur.anchorNode,ur.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:or}=this,ar=browser$2.safari&&or.root.nodeType==11&&deepActiveElement(this.dom.ownerDocument)==this.dom&&safariSelectionRangeHack(this.view)||getSelection(or.root);if(!ar||this.selectionRange.eq(ar))return!1;let cr=hasSelection(this.dom,ar);return cr&&!this.selectionChanged&&or.inputState.lastFocusTime>Date.now()-200&&or.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,ar)?(this.view.inputState.lastFocusTime=0,or.docView.updateSelection(),!1):(this.selectionRange.setRange(ar),cr&&(this.selectionChanged=!0),!0)}setSelectionRange(or,ar){this.selectionRange.set(or.node,or.offset,ar.node,ar.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let or=0,ar=null;for(let cr=this.dom;cr;)if(cr.nodeType==1)!ar&&or<this.scrollTargets.length&&this.scrollTargets[or]==cr?or++:ar||(ar=this.scrollTargets.slice(0,or)),ar&&ar.push(cr),cr=cr.assignedSlot||cr.parentNode;else if(cr.nodeType==11)cr=cr.host;else break;if(or<this.scrollTargets.length&&!ar&&(ar=this.scrollTargets.slice(0,or)),ar){for(let cr of this.scrollTargets)cr.removeEventListener("scroll",this.onScroll);for(let cr of this.scrollTargets=ar)cr.addEventListener("scroll",this.onScroll)}}ignore(or){if(!this.active)return or();try{return this.stop(),or()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(or,ar){var cr;if(!this.delayedAndroidKey){let ur=()=>{let hr=this.delayedAndroidKey;hr&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=hr.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&hr.force&&dispatchKey(this.dom,hr.key,hr.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(ur)}(!this.delayedAndroidKey||or=="Enter")&&(this.delayedAndroidKey={key:or,keyCode:ar,force:this.lastChange<Date.now()-50||!!(!((cr=this.delayedAndroidKey)===null||cr===void 0)&&cr.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let or of this.observer.takeRecords())this.queue.push(or);return this.queue}processRecords(){let or=this.pendingRecords();or.length&&(this.queue=[]);let ar=-1,cr=-1,ur=!1;for(let hr of or){let fr=this.readMutation(hr);fr&&(fr.typeOver&&(ur=!0),ar==-1?{from:ar,to:cr}=fr:(ar=Math.min(fr.from,ar),cr=Math.max(fr.to,cr)))}return{from:ar,to:cr,typeOver:ur}}readChange(){let{from:or,to:ar,typeOver:cr}=this.processRecords(),ur=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);return or<0&&!ur?null:(or>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new DOMChange(this.view,or,ar,cr))}flush(or=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;or&&this.readSelectionRange();let ar=this.readChange();if(!ar)return!1;let cr=this.view.state,ur=applyDOMChange(this.view,ar);return this.view.state==cr&&this.view.update([]),ur}readMutation(or){let ar=this.view.docView.nearest(or.target);if(!ar||ar.ignoreMutation(or))return null;if(ar.markDirty(or.type=="attributes"),or.type=="attributes"&&(ar.flags|=4),or.type=="childList"){let cr=findChild(ar,or.previousSibling||or.target.previousSibling,-1),ur=findChild(ar,or.nextSibling||or.target.nextSibling,1);return{from:cr?ar.posAfter(cr):ar.posAtStart,to:ur?ar.posBefore(ur):ar.posAtEnd,typeOver:!1}}else return or.type=="characterData"?{from:ar.posAtStart,to:ar.posAtEnd,typeOver:or.target.nodeValue==or.oldValue}:null}setWindow(or){or!=this.win&&(this.removeWindowListeners(this.win),this.win=or,this.addWindowListeners(this.win))}addWindowListeners(or){or.addEventListener("resize",this.onResize),or.addEventListener("beforeprint",this.onPrint),or.addEventListener("scroll",this.onScroll),or.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(or){or.removeEventListener("scroll",this.onScroll),or.removeEventListener("resize",this.onResize),or.removeEventListener("beforeprint",this.onPrint),or.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var or,ar,cr,ur;this.stop(),(or=this.intersection)===null||or===void 0||or.disconnect(),(ar=this.gapIntersection)===null||ar===void 0||ar.disconnect(),(cr=this.resizeScroll)===null||cr===void 0||cr.disconnect(),(ur=this.resizeContent)===null||ur===void 0||ur.disconnect();for(let hr of this.scrollTargets)hr.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function findChild(lr,or,ar){for(;or;){let cr=ContentView.get(or);if(cr&&cr.parent==lr)return cr;let ur=or.parentNode;or=ur!=lr.dom?ur:ar>0?or.nextSibling:or.previousSibling}return null}function safariSelectionRangeHack(lr){let or=null;function ar(pr){pr.preventDefault(),pr.stopImmediatePropagation(),or=pr.getTargetRanges()[0]}if(lr.contentDOM.addEventListener("beforeinput",ar,!0),lr.dom.ownerDocument.execCommand("indent"),lr.contentDOM.removeEventListener("beforeinput",ar,!0),!or)return null;let cr=or.startContainer,ur=or.startOffset,hr=or.endContainer,fr=or.endOffset,dr=lr.docView.domAtPos(lr.state.selection.main.anchor);return isEquivalentPosition(dr.node,dr.offset,hr,fr)&&([cr,ur,hr,fr]=[hr,fr,cr,ur]),{anchorNode:cr,anchorOffset:ur,focusNode:hr,focusOffset:fr}}class EditorView{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(or={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM);let{dispatch:ar}=or;this.dispatchTransactions=or.dispatchTransactions||ar&&(cr=>cr.forEach(ur=>ar(ur,this)))||(cr=>this.update(cr)),this.dispatch=this.dispatch.bind(this),this._root=or.root||getRoot(or.parent)||document,this.viewState=new ViewState(or.state||EditorState.create(or)),this.plugins=this.state.facet(viewPlugin).map(cr=>new PluginInstance(cr));for(let cr of this.plugins)cr.update(this);this.observer=new DOMObserver(this),this.inputState=new InputState(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new DocView(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),or.parent&&or.parent.appendChild(this.dom)}dispatch(...or){let ar=or.length==1&&or[0]instanceof Transaction?or:or.length==1&&Array.isArray(or[0])?or[0]:[this.state.update(...or)];this.dispatchTransactions(ar,this)}update(or){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let ar=!1,cr=!1,ur,hr=this.state;for(let br of or){if(br.startState!=hr)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");hr=br.state}if(this.destroyed){this.viewState.state=hr;return}let fr=this.hasFocus,dr=0,pr=null;or.some(br=>br.annotation(isFocusChange))?(this.inputState.notifiedFocused=fr,dr=1):fr!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=fr,pr=focusChangeTransaction(hr,fr),pr||(dr=1));let mr=this.observer.delayedAndroidKey,gr=null;if(mr?(this.observer.clearDelayedAndroidKey(),gr=this.observer.readChange(),(gr&&!this.state.doc.eq(hr.doc)||!this.state.selection.eq(hr.selection))&&(gr=null)):this.observer.clear(),hr.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(hr);ur=ViewUpdate.create(this,hr,or),ur.flags|=dr;let yr=this.viewState.scrollTarget;try{this.updateState=2;for(let br of or){if(yr&&(yr=yr.map(br.changes)),br.scrollIntoView){let{main:Or}=br.state.selection;yr=new ScrollTarget(Or.empty?Or:EditorSelection.cursor(Or.head,Or.head>Or.anchor?-1:1))}for(let Or of br.effects)Or.is(scrollIntoView)&&(yr=Or.value)}this.viewState.update(ur,yr),this.bidiCache=CachedOrder.update(this.bidiCache,ur.changes),ur.empty||(this.updatePlugins(ur),this.inputState.update(ur)),ar=this.docView.update(ur),this.state.facet(styleModule)!=this.styleModules&&this.mountStyles(),cr=this.updateAttrs(),this.showAnnouncements(or),this.docView.updateSelection(ar,or.some(br=>br.isUserEvent("select.pointer")))}finally{this.updateState=0}if(ur.startState.facet(theme)!=ur.state.facet(theme)&&(this.viewState.mustMeasureContent=!0),(ar||cr||yr||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!ur.empty)for(let br of this.state.facet(updateListener))br(ur);(pr||gr)&&Promise.resolve().then(()=>{pr&&this.state==pr.startState&&this.dispatch(pr),gr&&!applyDOMChange(this,gr)&&mr.force&&dispatchKey(this.contentDOM,mr.key,mr.keyCode)})}setState(or){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=or;return}this.updateState=2;let ar=this.hasFocus;try{for(let cr of this.plugins)cr.destroy(this);this.viewState=new ViewState(or),this.plugins=or.facet(viewPlugin).map(cr=>new PluginInstance(cr)),this.pluginMap.clear();for(let cr of this.plugins)cr.update(this);this.docView=new DocView(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}ar&&this.focus(),this.requestMeasure()}updatePlugins(or){let ar=or.startState.facet(viewPlugin),cr=or.state.facet(viewPlugin);if(ar!=cr){let ur=[];for(let hr of cr){let fr=ar.indexOf(hr);if(fr<0)ur.push(new PluginInstance(hr));else{let dr=this.plugins[fr];dr.mustUpdate=or,ur.push(dr)}}for(let hr of this.plugins)hr.mustUpdate!=or&&hr.destroy(this);this.plugins=ur,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let ur of this.plugins)ur.mustUpdate=or;for(let ur=0;ur<this.plugins.length;ur++)this.plugins[ur].update(this)}measure(or=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,or&&this.observer.forceFlush();let ar=null,cr=this.scrollDOM,ur=cr.scrollTop*this.scaleY,{scrollAnchorPos:hr,scrollAnchorHeight:fr}=this.viewState;Math.abs(ur-this.viewState.scrollTop)>1&&(fr=-1),this.viewState.scrollAnchorHeight=-1;try{for(let dr=0;;dr++){if(fr<0)if(isScrolledToBottom(cr))hr=-1,fr=this.viewState.heightMap.height;else{let Or=this.viewState.scrollAnchorAt(ur);hr=Or.from,fr=Or.top}this.updateState=1;let pr=this.viewState.measure(this);if(!pr&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(dr>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let mr=[];pr&4||([this.measureRequests,mr]=[mr,this.measureRequests]);let gr=mr.map(Or=>{try{return Or.read(this)}catch(_r){return logException(this.state,_r),BadMeasure}}),yr=ViewUpdate.create(this,this.state,[]),br=!1;yr.flags|=pr,ar?ar.flags|=pr:ar=yr,this.updateState=2,yr.empty||(this.updatePlugins(yr),this.inputState.update(yr),this.updateAttrs(),br=this.docView.update(yr));for(let Or=0;Or<mr.length;Or++)if(gr[Or]!=BadMeasure)try{let _r=mr[Or];_r.write&&_r.write(gr[Or],this)}catch(_r){logException(this.state,_r)}if(br&&this.docView.updateSelection(!0),!yr.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null;continue}else{let _r=(hr<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(hr).top)-fr;if(_r>1||_r<-1){ur=ur+_r,cr.scrollTop=ur/this.scaleY,fr=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(ar&&!ar.empty)for(let dr of this.state.facet(updateListener))dr(ar)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme)}updateAttrs(){let or=attrsFromFacet(this,editorAttributes,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),ar={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(editable)?"true":"false",class:"cm-content",style:`${browser$2.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(ar["aria-readonly"]="true"),attrsFromFacet(this,contentAttributes,ar);let cr=this.observer.ignore(()=>{let ur=updateAttrs(this.contentDOM,this.contentAttrs,ar),hr=updateAttrs(this.dom,this.editorAttrs,or);return ur||hr});return this.editorAttrs=or,this.contentAttrs=ar,cr}showAnnouncements(or){let ar=!0;for(let cr of or)for(let ur of cr.effects)if(ur.is(EditorView.announce)){ar&&(this.announceDOM.textContent=""),ar=!1;let hr=this.announceDOM.appendChild(document.createElement("div"));hr.textContent=ur.value}}mountStyles(){this.styleModules=this.state.facet(styleModule);let or=this.state.facet(EditorView.cspNonce);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$1).reverse(),or?{nonce:or}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(or){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),or){if(this.measureRequests.indexOf(or)>-1)return;if(or.key!=null){for(let ar=0;ar<this.measureRequests.length;ar++)if(this.measureRequests[ar].key===or.key){this.measureRequests[ar]=or;return}}this.measureRequests.push(or)}}plugin(or){let ar=this.pluginMap.get(or);return(ar===void 0||ar&&ar.spec!=or)&&this.pluginMap.set(or,ar=this.plugins.find(cr=>cr.spec==or)||null),ar&&ar.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(or){return this.readMeasured(),this.viewState.elementAtHeight(or)}lineBlockAtHeight(or){return this.readMeasured(),this.viewState.lineBlockAtHeight(or)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(or){return this.viewState.lineBlockAt(or)}get contentHeight(){return this.viewState.contentHeight}moveByChar(or,ar,cr){return skipAtoms(this,or,moveByChar(this,or,ar,cr))}moveByGroup(or,ar){return skipAtoms(this,or,moveByChar(this,or,ar,cr=>byGroup(this,or.head,cr)))}moveToLineBoundary(or,ar,cr=!0){return moveToLineBoundary(this,or,ar,cr)}moveVertically(or,ar,cr){return skipAtoms(this,or,moveVertically(this,or,ar,cr))}domAtPos(or){return this.docView.domAtPos(or)}posAtDOM(or,ar=0){return this.docView.posFromDOM(or,ar)}posAtCoords(or,ar=!0){return this.readMeasured(),posAtCoords(this,or,ar)}coordsAtPos(or,ar=1){this.readMeasured();let cr=this.docView.coordsAt(or,ar);if(!cr||cr.left==cr.right)return cr;let ur=this.state.doc.lineAt(or),hr=this.bidiSpans(ur),fr=hr[BidiSpan.find(hr,or-ur.from,-1,ar)];return flattenRect(cr,fr.dir==Direction.LTR==ar>0)}coordsForChar(or){return this.readMeasured(),this.docView.coordsForChar(or)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(or){return!this.state.facet(perLineTextDirection)||or<this.viewport.from||or>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(or))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(or){if(or.length>MaxBidiLine)return trivialOrder(or.length);let ar=this.textDirectionAt(or.from),cr;for(let hr of this.bidiCache)if(hr.from==or.from&&hr.dir==ar&&(hr.fresh||isolatesEq(hr.isolates,cr=getIsolatedRanges(this,or.from,or.to))))return hr.order;cr||(cr=getIsolatedRanges(this,or.from,or.to));let ur=computeOrder(or.text,ar,cr);return this.bidiCache.push(new CachedOrder(or.from,or.to,ar,cr,!0,ur)),ur}get hasFocus(){var or;return(this.dom.ownerDocument.hasFocus()||browser$2.safari&&((or=this.inputState)===null||or===void 0?void 0:or.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{focusPreventScroll(this.contentDOM),this.docView.updateSelection()})}setRoot(or){this._root!=or&&(this._root=or,this.observer.setWindow((or.nodeType==9?or:or.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let or of this.plugins)or.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(or,ar={}){return scrollIntoView.of(new ScrollTarget(typeof or=="number"?EditorSelection.cursor(or):or,ar.y,ar.x,ar.yMargin,ar.xMargin))}static domEventHandlers(or){return ViewPlugin.define(()=>({}),{eventHandlers:or})}static theme(or,ar){let cr=StyleModule.newName(),ur=[theme.of(cr),styleModule.of(buildTheme(`.${cr}`,or))];return ar&&ar.dark&&ur.push(darkTheme.of(!0)),ur}static baseTheme(or){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,or,lightDarkIDs)))}static findFromDOM(or){var ar;let cr=or.querySelector(".cm-content"),ur=cr&&ContentView.get(cr)||ContentView.get(or);return((ar=ur==null?void 0:ur.rootView)===null||ar===void 0?void 0:ar.view)||null}}EditorView.styleModule=styleModule;EditorView.inputHandler=inputHandler;EditorView.focusChangeEffect=focusChangeEffect;EditorView.perLineTextDirection=perLineTextDirection;EditorView.exceptionSink=exceptionSink;EditorView.updateListener=updateListener;EditorView.editable=editable;EditorView.mouseSelectionStyle=mouseSelectionStyle;EditorView.dragMovesSelection=dragMovesSelection$1;EditorView.clickAddsSelectionRange=clickAddsSelectionRange;EditorView.decorations=decorations;EditorView.atomicRanges=atomicRanges;EditorView.bidiIsolatedRanges=bidiIsolatedRanges;EditorView.scrollMargins=scrollMargins;EditorView.darkTheme=darkTheme;EditorView.cspNonce=Facet.define({combine:lr=>lr.length?lr[0]:""});EditorView.contentAttributes=contentAttributes;EditorView.editorAttributes=editorAttributes;EditorView.lineWrapping=EditorView.contentAttributes.of({class:"cm-lineWrapping"});EditorView.announce=StateEffect.define();const MaxBidiLine=4096,BadMeasure={};class CachedOrder{constructor(or,ar,cr,ur,hr,fr){this.from=or,this.to=ar,this.dir=cr,this.isolates=ur,this.fresh=hr,this.order=fr}static update(or,ar){if(ar.empty&&!or.some(hr=>hr.fresh))return or;let cr=[],ur=or.length?or[or.length-1].dir:Direction.LTR;for(let hr=Math.max(0,or.length-10);hr<or.length;hr++){let fr=or[hr];fr.dir==ur&&!ar.touchesRange(fr.from,fr.to)&&cr.push(new CachedOrder(ar.mapPos(fr.from,1),ar.mapPos(fr.to,-1),fr.dir,fr.isolates,!1,fr.order))}return cr}}function attrsFromFacet(lr,or,ar){for(let cr=lr.state.facet(or),ur=cr.length-1;ur>=0;ur--){let hr=cr[ur],fr=typeof hr=="function"?hr(lr):hr;fr&&combineAttrs(fr,ar)}return ar}const currentPlatform=browser$2.mac?"mac":browser$2.windows?"win":browser$2.linux?"linux":"key";function normalizeKeyName(lr,or){const ar=lr.split(/-(?!$)/);let cr=ar[ar.length-1];cr=="Space"&&(cr=" ");let ur,hr,fr,dr;for(let pr=0;pr<ar.length-1;++pr){const mr=ar[pr];if(/^(cmd|meta|m)$/i.test(mr))dr=!0;else if(/^a(lt)?$/i.test(mr))ur=!0;else if(/^(c|ctrl|control)$/i.test(mr))hr=!0;else if(/^s(hift)?$/i.test(mr))fr=!0;else if(/^mod$/i.test(mr))or=="mac"?dr=!0:hr=!0;else throw new Error("Unrecognized modifier name: "+mr)}return ur&&(cr="Alt-"+cr),hr&&(cr="Ctrl-"+cr),dr&&(cr="Meta-"+cr),fr&&(cr="Shift-"+cr),cr}function modifiers(lr,or,ar){return or.altKey&&(lr="Alt-"+lr),or.ctrlKey&&(lr="Ctrl-"+lr),or.metaKey&&(lr="Meta-"+lr),ar!==!1&&or.shiftKey&&(lr="Shift-"+lr),lr}const handleKeyEvents=Prec.default(EditorView.domEventHandlers({keydown(lr,or){return runHandlers(getKeymap(or.state),lr,or,"editor")}})),keymap=Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;function getKeymap(lr){let or=lr.facet(keymap),ar=Keymaps.get(or);return ar||Keymaps.set(or,ar=buildKeymap(or.reduce((cr,ur)=>cr.concat(ur),[]))),ar}function runScopeHandlers(lr,or,ar){return runHandlers(getKeymap(lr.state),or,lr,ar)}let storedPrefix=null;const PrefixTimeout=4e3;function buildKeymap(lr,or=currentPlatform){let ar=Object.create(null),cr=Object.create(null),ur=(fr,dr)=>{let pr=cr[fr];if(pr==null)cr[fr]=dr;else if(pr!=dr)throw new Error("Key binding "+fr+" is used both as a regular binding and as a multi-stroke prefix")},hr=(fr,dr,pr,mr,gr)=>{var yr,br;let Or=ar[fr]||(ar[fr]=Object.create(null)),_r=dr.split(/ (?!$)/).map(wr=>normalizeKeyName(wr,or));for(let wr=1;wr<_r.length;wr++){let kr=_r.slice(0,wr).join(" ");ur(kr,!0),Or[kr]||(Or[kr]={preventDefault:!0,stopPropagation:!1,run:[Cr=>{let $r=storedPrefix={view:Cr,prefix:kr,scope:fr};return setTimeout(()=>{storedPrefix==$r&&(storedPrefix=null)},PrefixTimeout),!0}]})}let vr=_r.join(" ");ur(vr,!1);let xr=Or[vr]||(Or[vr]={preventDefault:!1,stopPropagation:!1,run:((br=(yr=Or._any)===null||yr===void 0?void 0:yr.run)===null||br===void 0?void 0:br.slice())||[]});pr&&xr.run.push(pr),mr&&(xr.preventDefault=!0),gr&&(xr.stopPropagation=!0)};for(let fr of lr){let dr=fr.scope?fr.scope.split(" "):["editor"];if(fr.any)for(let mr of dr){let gr=ar[mr]||(ar[mr]=Object.create(null));gr._any||(gr._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let yr in gr)gr[yr].run.push(fr.any)}let pr=fr[or]||fr.key;if(pr)for(let mr of dr)hr(mr,pr,fr.run,fr.preventDefault,fr.stopPropagation),fr.shift&&hr(mr,"Shift-"+pr,fr.shift,fr.preventDefault,fr.stopPropagation)}return ar}function runHandlers(lr,or,ar,cr){let ur=keyName(or),hr=codePointAt(ur,0),fr=codePointSize(hr)==ur.length&&ur!=" ",dr="",pr=!1,mr=!1,gr=!1;storedPrefix&&storedPrefix.view==ar&&storedPrefix.scope==cr&&(dr=storedPrefix.prefix+" ",modifierCodes.indexOf(or.keyCode)<0&&(mr=!0,storedPrefix=null));let yr=new Set,br=xr=>{if(xr){for(let wr of xr.run)if(!yr.has(wr)&&(yr.add(wr),wr(ar,or)))return xr.stopPropagation&&(gr=!0),!0;xr.preventDefault&&(xr.stopPropagation&&(gr=!0),mr=!0)}return!1},Or=lr[cr],_r,vr;return Or&&(br(Or[dr+modifiers(ur,or,!fr)])?pr=!0:fr&&(or.altKey||or.metaKey||or.ctrlKey)&&!(browser$2.windows&&or.ctrlKey&&or.altKey)&&(_r=base[or.keyCode])&&_r!=ur?(br(Or[dr+modifiers(_r,or,!0)])||or.shiftKey&&(vr=shift[or.keyCode])!=ur&&vr!=_r&&br(Or[dr+modifiers(vr,or,!1)]))&&(pr=!0):fr&&or.shiftKey&&br(Or[dr+modifiers(ur,or,!0)])&&(pr=!0),!pr&&br(Or._any)&&(pr=!0)),mr&&(pr=!0),pr&&gr&&or.stopPropagation(),pr}class RectangleMarker{constructor(or,ar,cr,ur,hr){this.className=or,this.left=ar,this.top=cr,this.width=ur,this.height=hr}draw(){let or=document.createElement("div");return or.className=this.className,this.adjust(or),or}update(or,ar){return ar.className!=this.className?!1:(this.adjust(or),!0)}adjust(or){or.style.left=this.left+"px",or.style.top=this.top+"px",this.width!=null&&(or.style.width=this.width+"px"),or.style.height=this.height+"px"}eq(or){return this.left==or.left&&this.top==or.top&&this.width==or.width&&this.height==or.height&&this.className==or.className}static forRange(or,ar,cr){if(cr.empty){let ur=or.coordsAtPos(cr.head,cr.assoc||1);if(!ur)return[];let hr=getBase(or);return[new RectangleMarker(ar,ur.left-hr.left,ur.top-hr.top,null,ur.bottom-ur.top)]}else return rectanglesForRange(or,ar,cr)}}function getBase(lr){let or=lr.scrollDOM.getBoundingClientRect();return{left:(lr.textDirection==Direction.LTR?or.left:or.right-lr.scrollDOM.clientWidth*lr.scaleX)-lr.scrollDOM.scrollLeft*lr.scaleX,top:or.top-lr.scrollDOM.scrollTop*lr.scaleY}}function wrappedLine(lr,or,ar){let cr=EditorSelection.cursor(or);return{from:Math.max(ar.from,lr.moveToLineBoundary(cr,!1,!0).from),to:Math.min(ar.to,lr.moveToLineBoundary(cr,!0,!0).from),type:BlockType.Text}}function rectanglesForRange(lr,or,ar){if(ar.to<=lr.viewport.from||ar.from>=lr.viewport.to)return[];let cr=Math.max(ar.from,lr.viewport.from),ur=Math.min(ar.to,lr.viewport.to),hr=lr.textDirection==Direction.LTR,fr=lr.contentDOM,dr=fr.getBoundingClientRect(),pr=getBase(lr),mr=fr.querySelector(".cm-line"),gr=mr&&window.getComputedStyle(mr),yr=dr.left+(gr?parseInt(gr.paddingLeft)+Math.min(0,parseInt(gr.textIndent)):0),br=dr.right-(gr?parseInt(gr.paddingRight):0),Or=blockAt(lr,cr),_r=blockAt(lr,ur),vr=Or.type==BlockType.Text?Or:null,xr=_r.type==BlockType.Text?_r:null;if(vr&&(lr.lineWrapping||Or.widgetLineBreaks)&&(vr=wrappedLine(lr,cr,vr)),xr&&(lr.lineWrapping||_r.widgetLineBreaks)&&(xr=wrappedLine(lr,ur,xr)),vr&&xr&&vr.from==xr.from)return kr(Cr(ar.from,ar.to,vr));{let Nr=vr?Cr(ar.from,null,vr):$r(Or,!1),Br=xr?Cr(null,ar.to,xr):$r(_r,!0),Fr=[];return(vr||Or).to<(xr||_r).from-(vr&&xr?1:0)||Or.widgetLineBreaks>1&&Nr.bottom+lr.defaultLineHeight/2<Br.top?Fr.push(wr(yr,Nr.bottom,br,Br.top)):Nr.bottom<Br.top&&lr.elementAtHeight((Nr.bottom+Br.top)/2).type==BlockType.Text&&(Nr.bottom=Br.top=(Nr.bottom+Br.top)/2),kr(Nr).concat(Fr).concat(kr(Br))}function wr(Nr,Br,Fr,Vr){return new RectangleMarker(or,Nr-pr.left,Br-pr.top-.01,Fr-Nr,Vr-Br+.01)}function kr({top:Nr,bottom:Br,horizontal:Fr}){let Vr=[];for(let Rr=0;Rr<Fr.length;Rr+=2)Vr.push(wr(Fr[Rr],Nr,Fr[Rr+1],Br));return Vr}function Cr(Nr,Br,Fr){let Vr=1e9,Rr=-1e9,Gr=[];function qr(Dr,Jr,ai,Kr,ui){let ii=lr.coordsAtPos(Dr,Dr==Fr.to?-2:2),di=lr.coordsAtPos(ai,ai==Fr.from?2:-2);!ii||!di||(Vr=Math.min(ii.top,di.top,Vr),Rr=Math.max(ii.bottom,di.bottom,Rr),ui==Direction.LTR?Gr.push(hr&&Jr?yr:ii.left,hr&&Kr?br:di.right):Gr.push(!hr&&Kr?yr:di.left,!hr&&Jr?br:ii.right))}let Ur=Nr??Fr.from,Yr=Br??Fr.to;for(let Dr of lr.visibleRanges)if(Dr.to>Ur&&Dr.from<Yr)for(let Jr=Math.max(Dr.from,Ur),ai=Math.min(Dr.to,Yr);;){let Kr=lr.state.doc.lineAt(Jr);for(let ui of lr.bidiSpans(Kr)){let ii=ui.from+Kr.from,di=ui.to+Kr.from;if(ii>=ai)break;di>Jr&&qr(Math.max(ii,Jr),Nr==null&&ii<=Ur,Math.min(di,ai),Br==null&&di>=Yr,ui.dir)}if(Jr=Kr.to+1,Jr>=ai)break}return Gr.length==0&&qr(Ur,Nr==null,Yr,Br==null,lr.textDirection),{top:Vr,bottom:Rr,horizontal:Gr}}function $r(Nr,Br){let Fr=dr.top+(Br?Nr.top:Nr.bottom);return{top:Fr,bottom:Fr,horizontal:[]}}}function sameMarker(lr,or){return lr.constructor==or.constructor&&lr.eq(or)}class LayerView{constructor(or,ar){this.view=or,this.layer=ar,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=or.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),ar.above&&this.dom.classList.add("cm-layer-above"),ar.class&&this.dom.classList.add(ar.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(or.state),or.requestMeasure(this.measureReq),ar.mount&&ar.mount(this.dom,or)}update(or){or.startState.facet(layerOrder)!=or.state.facet(layerOrder)&&this.setOrder(or.state),(this.layer.update(or,this.dom)||or.geometryChanged)&&(this.scale(),or.view.requestMeasure(this.measureReq))}setOrder(or){let ar=0,cr=or.facet(layerOrder);for(;ar<cr.length&&cr[ar]!=this.layer;)ar++;this.dom.style.zIndex=String((this.layer.above?150:-1)-ar)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:or,scaleY:ar}=this.view;(or!=this.scaleX||ar!=this.scaleY)&&(this.scaleX=or,this.scaleY=ar,this.dom.style.transform=`scale(${1/or}, ${1/ar})`)}draw(or){if(or.length!=this.drawn.length||or.some((ar,cr)=>!sameMarker(ar,this.drawn[cr]))){let ar=this.dom.firstChild,cr=0;for(let ur of or)ur.update&&ar&&ur.constructor&&this.drawn[cr].constructor&&ur.update(ar,this.drawn[cr])?(ar=ar.nextSibling,cr++):this.dom.insertBefore(ur.draw(),ar);for(;ar;){let ur=ar.nextSibling;ar.remove(),ar=ur}this.drawn=or}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const layerOrder=Facet.define();function layer(lr){return[ViewPlugin.define(or=>new LayerView(or,lr)),layerOrder.of(lr)]}const CanHidePrimary=!browser$2.ios,selectionConfig=Facet.define({combine(lr){return combineConfig(lr,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(or,ar)=>Math.min(or,ar),drawRangeCursor:(or,ar)=>or||ar})}});function drawSelection(lr={}){return[selectionConfig.of(lr),cursorLayer,selectionLayer,hideNativeSelection,nativeSelectionHidden.of(!0)]}function configChanged(lr){return lr.startState.facet(selectionConfig)!=lr.state.facet(selectionConfig)}const cursorLayer=layer({above:!0,markers(lr){let{state:or}=lr,ar=or.facet(selectionConfig),cr=[];for(let ur of or.selection.ranges){let hr=ur==or.selection.main;if(ur.empty?!hr||CanHidePrimary:ar.drawRangeCursor){let fr=hr?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",dr=ur.empty?ur:EditorSelection.cursor(ur.head,ur.head>ur.anchor?-1:1);for(let pr of RectangleMarker.forRange(lr,fr,dr))cr.push(pr)}}return cr},update(lr,or){lr.transactions.some(cr=>cr.selection)&&(or.style.animationName=or.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let ar=configChanged(lr);return ar&&setBlinkRate(lr.state,or),lr.docChanged||lr.selectionSet||ar},mount(lr,or){setBlinkRate(or.state,lr)},class:"cm-cursorLayer"});function setBlinkRate(lr,or){or.style.animationDuration=lr.facet(selectionConfig).cursorBlinkRate+"ms"}const selectionLayer=layer({above:!1,markers(lr){return lr.state.selection.ranges.map(or=>or.empty?[]:RectangleMarker.forRange(lr,"cm-selectionBackground",or)).reduce((or,ar)=>or.concat(ar))},update(lr,or){return lr.docChanged||lr.selectionSet||lr.viewportChanged||configChanged(lr)},class:"cm-selectionLayer"}),themeSpec={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};CanHidePrimary&&(themeSpec[".cm-line"].caretColor="transparent !important");const hideNativeSelection=Prec.highest(EditorView.theme(themeSpec));function iterMatches(lr,or,ar,cr,ur){or.lastIndex=0;for(let hr=lr.iterRange(ar,cr),fr=ar,dr;!hr.next().done;fr+=hr.value.length)if(!hr.lineBreak)for(;dr=or.exec(hr.value);)ur(fr+dr.index,dr)}function matchRanges(lr,or){let ar=lr.visibleRanges;if(ar.length==1&&ar[0].from==lr.viewport.from&&ar[0].to==lr.viewport.to)return ar;let cr=[];for(let{from:ur,to:hr}of ar)ur=Math.max(lr.state.doc.lineAt(ur).from,ur-or),hr=Math.min(lr.state.doc.lineAt(hr).to,hr+or),cr.length&&cr[cr.length-1].to>=ur?cr[cr.length-1].to=hr:cr.push({from:ur,to:hr});return cr}class MatchDecorator{constructor(or){const{regexp:ar,decoration:cr,decorate:ur,boundary:hr,maxLength:fr=1e3}=or;if(!ar.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=ar,ur)this.addMatch=(dr,pr,mr,gr)=>ur(gr,mr,mr+dr[0].length,dr,pr);else if(typeof cr=="function")this.addMatch=(dr,pr,mr,gr)=>{let yr=cr(dr,pr,mr);yr&&gr(mr,mr+dr[0].length,yr)};else if(cr)this.addMatch=(dr,pr,mr,gr)=>gr(mr,mr+dr[0].length,cr);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=hr,this.maxLength=fr}createDeco(or){let ar=new RangeSetBuilder,cr=ar.add.bind(ar);for(let{from:ur,to:hr}of matchRanges(or,this.maxLength))iterMatches(or.state.doc,this.regexp,ur,hr,(fr,dr)=>this.addMatch(dr,or,fr,cr));return ar.finish()}updateDeco(or,ar){let cr=1e9,ur=-1;return or.docChanged&&or.changes.iterChanges((hr,fr,dr,pr)=>{pr>or.view.viewport.from&&dr<or.view.viewport.to&&(cr=Math.min(dr,cr),ur=Math.max(pr,ur))}),or.viewportChanged||ur-cr>1e3?this.createDeco(or.view):ur>-1?this.updateRange(or.view,ar.map(or.changes),cr,ur):ar}updateRange(or,ar,cr,ur){for(let hr of or.visibleRanges){let fr=Math.max(hr.from,cr),dr=Math.min(hr.to,ur);if(dr>fr){let pr=or.state.doc.lineAt(fr),mr=pr.to<dr?or.state.doc.lineAt(dr):pr,gr=Math.max(hr.from,pr.from),yr=Math.min(hr.to,mr.to);if(this.boundary){for(;fr>pr.from;fr--)if(this.boundary.test(pr.text[fr-1-pr.from])){gr=fr;break}for(;dr<mr.to;dr++)if(this.boundary.test(mr.text[dr-mr.from])){yr=dr;break}}let br=[],Or,_r=(vr,xr,wr)=>br.push(wr.range(vr,xr));if(pr==mr)for(this.regexp.lastIndex=gr-pr.from;(Or=this.regexp.exec(pr.text))&&Or.index<yr-pr.from;)this.addMatch(Or,or,Or.index+pr.from,_r);else iterMatches(or.state.doc,this.regexp,gr,yr,(vr,xr)=>this.addMatch(xr,or,vr,_r));ar=ar.update({filterFrom:gr,filterTo:yr,filter:(vr,xr)=>vr<gr||xr>yr,add:br})}}return ar}}const UnicodeRegexpSupport=/x/.unicode!=null?"gu":"g",Specials=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,UnicodeRegexpSupport),Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let _supportsTabSize=null;function supportsTabSize(){var lr;if(_supportsTabSize==null&&typeof document<"u"&&document.body){let or=document.body.style;_supportsTabSize=((lr=or.tabSize)!==null&&lr!==void 0?lr:or.MozTabSize)!=null}return _supportsTabSize||!1}const specialCharConfig=Facet.define({combine(lr){let or=combineConfig(lr,{render:null,specialChars:Specials,addSpecialChars:null});return(or.replaceTabs=!supportsTabSize())&&(or.specialChars=new RegExp("	|"+or.specialChars.source,UnicodeRegexpSupport)),or.addSpecialChars&&(or.specialChars=new RegExp(or.specialChars.source+"|"+or.addSpecialChars.source,UnicodeRegexpSupport)),or}});function highlightSpecialChars(lr={}){return[specialCharConfig.of(lr),specialCharPlugin()]}let _plugin=null;function specialCharPlugin(){return _plugin||(_plugin=ViewPlugin.fromClass(class{constructor(lr){this.view=lr,this.decorations=Decoration.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(lr.state.facet(specialCharConfig)),this.decorations=this.decorator.createDeco(lr)}makeDecorator(lr){return new MatchDecorator({regexp:lr.specialChars,decoration:(or,ar,cr)=>{let{doc:ur}=ar.state,hr=codePointAt(or[0],0);if(hr==9){let fr=ur.lineAt(cr),dr=ar.state.tabSize,pr=countColumn(fr.text,dr,cr-fr.from);return Decoration.replace({widget:new TabWidget((dr-pr%dr)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[hr]||(this.decorationCache[hr]=Decoration.replace({widget:new SpecialCharWidget(lr,hr)}))},boundary:lr.replaceTabs?void 0:/[^]/})}update(lr){let or=lr.state.facet(specialCharConfig);lr.startState.facet(specialCharConfig)!=or?(this.decorator=this.makeDecorator(or),this.decorations=this.decorator.createDeco(lr.view)):this.decorations=this.decorator.updateDeco(lr,this.decorations)}},{decorations:lr=>lr.decorations}))}const DefaultPlaceholder="•";function placeholder$1(lr){return lr>=32?DefaultPlaceholder:lr==10?"␤":String.fromCharCode(9216+lr)}class SpecialCharWidget extends WidgetType{constructor(or,ar){super(),this.options=or,this.code=ar}eq(or){return or.code==this.code}toDOM(or){let ar=placeholder$1(this.code),cr=or.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16)),ur=this.options.render&&this.options.render(this.code,cr,ar);if(ur)return ur;let hr=document.createElement("span");return hr.textContent=ar,hr.title=cr,hr.setAttribute("aria-label",cr),hr.className="cm-specialChar",hr}ignoreEvent(){return!1}}class TabWidget extends WidgetType{constructor(or){super(),this.width=or}eq(or){return or.width==this.width}toDOM(){let or=document.createElement("span");return or.textContent="	",or.className="cm-tab",or.style.width=this.width+"px",or}ignoreEvent(){return!1}}function highlightActiveLine(){return activeLineHighlighter}const lineDeco=Decoration.line({class:"cm-activeLine"}),activeLineHighlighter=ViewPlugin.fromClass(class{constructor(lr){this.decorations=this.getDeco(lr)}update(lr){(lr.docChanged||lr.selectionSet)&&(this.decorations=this.getDeco(lr.view))}getDeco(lr){let or=-1,ar=[];for(let cr of lr.state.selection.ranges){let ur=lr.lineBlockAt(cr.head);ur.from>or&&(ar.push(lineDeco.range(ur.from)),or=ur.from)}return Decoration.set(ar)}},{decorations:lr=>lr.decorations}),panelConfig=Facet.define({combine(lr){let or,ar;for(let cr of lr)or=or||cr.topContainer,ar=ar||cr.bottomContainer;return{topContainer:or,bottomContainer:ar}}});function getPanel(lr,or){let ar=lr.plugin(panelPlugin),cr=ar?ar.specs.indexOf(or):-1;return cr>-1?ar.panels[cr]:null}const panelPlugin=ViewPlugin.fromClass(class{constructor(lr){this.input=lr.state.facet(showPanel),this.specs=this.input.filter(ar=>ar),this.panels=this.specs.map(ar=>ar(lr));let or=lr.state.facet(panelConfig);this.top=new PanelGroup(lr,!0,or.topContainer),this.bottom=new PanelGroup(lr,!1,or.bottomContainer),this.top.sync(this.panels.filter(ar=>ar.top)),this.bottom.sync(this.panels.filter(ar=>!ar.top));for(let ar of this.panels)ar.dom.classList.add("cm-panel"),ar.mount&&ar.mount()}update(lr){let or=lr.state.facet(panelConfig);this.top.container!=or.topContainer&&(this.top.sync([]),this.top=new PanelGroup(lr.view,!0,or.topContainer)),this.bottom.container!=or.bottomContainer&&(this.bottom.sync([]),this.bottom=new PanelGroup(lr.view,!1,or.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let ar=lr.state.facet(showPanel);if(ar!=this.input){let cr=ar.filter(pr=>pr),ur=[],hr=[],fr=[],dr=[];for(let pr of cr){let mr=this.specs.indexOf(pr),gr;mr<0?(gr=pr(lr.view),dr.push(gr)):(gr=this.panels[mr],gr.update&&gr.update(lr)),ur.push(gr),(gr.top?hr:fr).push(gr)}this.specs=cr,this.panels=ur,this.top.sync(hr),this.bottom.sync(fr);for(let pr of dr)pr.dom.classList.add("cm-panel"),pr.mount&&pr.mount()}else for(let cr of this.panels)cr.update&&cr.update(lr)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:lr=>EditorView.scrollMargins.of(or=>{let ar=or.plugin(lr);return ar&&{top:ar.top.scrollMargin(),bottom:ar.bottom.scrollMargin()}})});class PanelGroup{constructor(or,ar,cr){this.view=or,this.top=ar,this.container=cr,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(or){for(let ar of this.panels)ar.destroy&&or.indexOf(ar)<0&&ar.destroy();this.panels=or,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let ar=this.container||this.view.dom;ar.insertBefore(this.dom,this.top?ar.firstChild:null)}let or=this.dom.firstChild;for(let ar of this.panels)if(ar.dom.parentNode==this.dom){for(;or!=ar.dom;)or=rm(or);or=or.nextSibling}else this.dom.insertBefore(ar.dom,or);for(;or;)or=rm(or)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let or of this.classes.split(" "))or&&this.container.classList.remove(or);for(let or of(this.classes=this.view.themeClasses).split(" "))or&&this.container.classList.add(or)}}}function rm(lr){let or=lr.nextSibling;return lr.remove(),or}const showPanel=Facet.define({enables:panelPlugin});class GutterMarker extends RangeValue{compare(or){return this==or||this.constructor==or.constructor&&this.eq(or)}eq(or){return!1}destroy(or){}}GutterMarker.prototype.elementClass="";GutterMarker.prototype.toDOM=void 0;GutterMarker.prototype.mapMode=MapMode.TrackBefore;GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1;GutterMarker.prototype.point=!0;const DefaultBufferLength=1024;let nextPropID=0;class Range{constructor(or,ar){this.from=or,this.to=ar}}class NodeProp{constructor(or={}){this.id=nextPropID++,this.perNode=!!or.perNode,this.deserialize=or.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(or){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof or!="function"&&(or=NodeType.match(or)),ar=>{let cr=or(ar);return cr===void 0?null:[this,cr]}}}NodeProp.closedBy=new NodeProp({deserialize:lr=>lr.split(" ")});NodeProp.openedBy=new NodeProp({deserialize:lr=>lr.split(" ")});NodeProp.group=new NodeProp({deserialize:lr=>lr.split(" ")});NodeProp.contextHash=new NodeProp({perNode:!0});NodeProp.lookAhead=new NodeProp({perNode:!0});NodeProp.mounted=new NodeProp({perNode:!0});class MountedTree{constructor(or,ar,cr){this.tree=or,this.overlay=ar,this.parser=cr}}const noProps=Object.create(null);class NodeType{constructor(or,ar,cr,ur=0){this.name=or,this.props=ar,this.id=cr,this.flags=ur}static define(or){let ar=or.props&&or.props.length?Object.create(null):noProps,cr=(or.top?1:0)|(or.skipped?2:0)|(or.error?4:0)|(or.name==null?8:0),ur=new NodeType(or.name||"",ar,or.id,cr);if(or.props){for(let hr of or.props)if(Array.isArray(hr)||(hr=hr(ur)),hr){if(hr[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");ar[hr[0].id]=hr[1]}}return ur}prop(or){return this.props[or.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(or){if(typeof or=="string"){if(this.name==or)return!0;let ar=this.prop(NodeProp.group);return ar?ar.indexOf(or)>-1:!1}return this.id==or}static match(or){let ar=Object.create(null);for(let cr in or)for(let ur of cr.split(" "))ar[ur]=or[cr];return cr=>{for(let ur=cr.prop(NodeProp.group),hr=-1;hr<(ur?ur.length:0);hr++){let fr=ar[hr<0?cr.name:ur[hr]];if(fr)return fr}}}}NodeType.none=new NodeType("",Object.create(null),0,8);class NodeSet{constructor(or){this.types=or;for(let ar=0;ar<or.length;ar++)if(or[ar].id!=ar)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...or){let ar=[];for(let cr of this.types){let ur=null;for(let hr of or){let fr=hr(cr);fr&&(ur||(ur=Object.assign({},cr.props)),ur[fr[0].id]=fr[1])}ar.push(ur?new NodeType(cr.name,ur,cr.id,cr.flags):cr)}return new NodeSet(ar)}}const CachedNode=new WeakMap,CachedInnerNode=new WeakMap;var IterMode;(function(lr){lr[lr.ExcludeBuffers=1]="ExcludeBuffers",lr[lr.IncludeAnonymous=2]="IncludeAnonymous",lr[lr.IgnoreMounts=4]="IgnoreMounts",lr[lr.IgnoreOverlays=8]="IgnoreOverlays"})(IterMode||(IterMode={}));let Tree$1=class Ji{constructor(or,ar,cr,ur,hr){if(this.type=or,this.children=ar,this.positions=cr,this.length=ur,this.props=null,hr&&hr.length){this.props=Object.create(null);for(let[fr,dr]of hr)this.props[typeof fr=="number"?fr:fr.id]=dr}}toString(){let or=this.prop(NodeProp.mounted);if(or&&!or.overlay)return or.tree.toString();let ar="";for(let cr of this.children){let ur=cr.toString();ur&&(ar&&(ar+=","),ar+=ur)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(ar.length?"("+ar+")":""):ar}cursor(or=0){return new TreeCursor(this.topNode,or)}cursorAt(or,ar=0,cr=0){let ur=CachedNode.get(this)||this.topNode,hr=new TreeCursor(ur);return hr.moveTo(or,ar),CachedNode.set(this,hr._tree),hr}get topNode(){return new TreeNode(this,0,0,null)}resolve(or,ar=0){let cr=resolveNode(CachedNode.get(this)||this.topNode,or,ar,!1);return CachedNode.set(this,cr),cr}resolveInner(or,ar=0){let cr=resolveNode(CachedInnerNode.get(this)||this.topNode,or,ar,!0);return CachedInnerNode.set(this,cr),cr}iterate(or){let{enter:ar,leave:cr,from:ur=0,to:hr=this.length}=or,fr=or.mode||0,dr=(fr&IterMode.IncludeAnonymous)>0;for(let pr=this.cursor(fr|IterMode.IncludeAnonymous);;){let mr=!1;if(pr.from<=hr&&pr.to>=ur&&(!dr&&pr.type.isAnonymous||ar(pr)!==!1)){if(pr.firstChild())continue;mr=!0}for(;mr&&cr&&(dr||!pr.type.isAnonymous)&&cr(pr),!pr.nextSibling();){if(!pr.parent())return;mr=!0}}}prop(or){return or.perNode?this.props?this.props[or.id]:void 0:this.type.prop(or)}get propValues(){let or=[];if(this.props)for(let ar in this.props)or.push([+ar,this.props[ar]]);return or}balance(or={}){return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,(ar,cr,ur)=>new Ji(this.type,ar,cr,ur,this.propValues),or.makeTree||((ar,cr,ur)=>new Ji(NodeType.none,ar,cr,ur)))}static build(or){return buildTree(or)}};Tree$1.empty=new Tree$1(NodeType.none,[],[],0);class FlatBufferCursor{constructor(or,ar){this.buffer=or,this.index=ar}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor(this.buffer,this.index)}}class TreeBuffer{constructor(or,ar,cr){this.buffer=or,this.length=ar,this.set=cr}get type(){return NodeType.none}toString(){let or=[];for(let ar=0;ar<this.buffer.length;)or.push(this.childString(ar)),ar=this.buffer[ar+3];return or.join(",")}childString(or){let ar=this.buffer[or],cr=this.buffer[or+3],ur=this.set.types[ar],hr=ur.name;if(/\W/.test(hr)&&!ur.isError&&(hr=JSON.stringify(hr)),or+=4,cr==or)return hr;let fr=[];for(;or<cr;)fr.push(this.childString(or)),or=this.buffer[or+3];return hr+"("+fr.join(",")+")"}findChild(or,ar,cr,ur,hr){let{buffer:fr}=this,dr=-1;for(let pr=or;pr!=ar&&!(checkSide(hr,ur,fr[pr+1],fr[pr+2])&&(dr=pr,cr>0));pr=fr[pr+3]);return dr}slice(or,ar,cr){let ur=this.buffer,hr=new Uint16Array(ar-or),fr=0;for(let dr=or,pr=0;dr<ar;){hr[pr++]=ur[dr++],hr[pr++]=ur[dr++]-cr;let mr=hr[pr++]=ur[dr++]-cr;hr[pr++]=ur[dr++]-or,fr=Math.max(fr,mr)}return new TreeBuffer(hr,fr,this.set)}}function checkSide(lr,or,ar,cr){switch(lr){case-2:return ar<or;case-1:return cr>=or&&ar<or;case 0:return ar<or&&cr>or;case 1:return ar<=or&&cr>or;case 2:return cr>or;case 4:return!0}}function enterUnfinishedNodesBefore(lr,or){let ar=lr.childBefore(or);for(;ar;){let cr=ar.lastChild;if(!cr||cr.to!=ar.to)break;cr.type.isError&&cr.from==cr.to?(lr=ar,ar=cr.prevSibling):ar=cr}return lr}function resolveNode(lr,or,ar,cr){for(var ur;lr.from==lr.to||(ar<1?lr.from>=or:lr.from>or)||(ar>-1?lr.to<=or:lr.to<or);){let fr=!cr&&lr instanceof TreeNode&&lr.index<0?null:lr.parent;if(!fr)return lr;lr=fr}let hr=cr?0:IterMode.IgnoreOverlays;if(cr)for(let fr=lr,dr=fr.parent;dr;fr=dr,dr=fr.parent)fr instanceof TreeNode&&fr.index<0&&((ur=dr.enter(or,ar,hr))===null||ur===void 0?void 0:ur.from)!=fr.from&&(lr=dr);for(;;){let fr=lr.enter(or,ar,hr);if(!fr)return lr;lr=fr}}class TreeNode{constructor(or,ar,cr,ur){this._tree=or,this.from=ar,this.index=cr,this._parent=ur}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(or,ar,cr,ur,hr=0){for(let fr=this;;){for(let{children:dr,positions:pr}=fr._tree,mr=ar>0?dr.length:-1;or!=mr;or+=ar){let gr=dr[or],yr=pr[or]+fr.from;if(checkSide(ur,cr,yr,yr+gr.length)){if(gr instanceof TreeBuffer){if(hr&IterMode.ExcludeBuffers)continue;let br=gr.findChild(0,gr.buffer.length,ar,cr-yr,ur);if(br>-1)return new BufferNode(new BufferContext(fr,gr,or,yr),null,br)}else if(hr&IterMode.IncludeAnonymous||!gr.type.isAnonymous||hasChild(gr)){let br;if(!(hr&IterMode.IgnoreMounts)&&gr.props&&(br=gr.prop(NodeProp.mounted))&&!br.overlay)return new TreeNode(br.tree,yr,or,fr);let Or=new TreeNode(gr,yr,or,fr);return hr&IterMode.IncludeAnonymous||!Or.type.isAnonymous?Or:Or.nextChild(ar<0?gr.children.length-1:0,ar,cr,ur)}}}if(hr&IterMode.IncludeAnonymous||!fr.type.isAnonymous||(fr.index>=0?or=fr.index+ar:or=ar<0?-1:fr._parent._tree.children.length,fr=fr._parent,!fr))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(or){return this.nextChild(0,1,or,2)}childBefore(or){return this.nextChild(this._tree.children.length-1,-1,or,-2)}enter(or,ar,cr=0){let ur;if(!(cr&IterMode.IgnoreOverlays)&&(ur=this._tree.prop(NodeProp.mounted))&&ur.overlay){let hr=or-this.from;for(let{from:fr,to:dr}of ur.overlay)if((ar>0?fr<=hr:fr<hr)&&(ar<0?dr>=hr:dr>hr))return new TreeNode(ur.tree,ur.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,or,ar,cr)}nextSignificantParent(){let or=this;for(;or.type.isAnonymous&&or._parent;)or=or._parent;return or}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(or=0){return new TreeCursor(this,or)}get tree(){return this._tree}toTree(){return this._tree}resolve(or,ar=0){return resolveNode(this,or,ar,!1)}resolveInner(or,ar=0){return resolveNode(this,or,ar,!0)}enterUnfinishedNodesBefore(or){return enterUnfinishedNodesBefore(this,or)}getChild(or,ar=null,cr=null){let ur=getChildren(this,or,ar,cr);return ur.length?ur[0]:null}getChildren(or,ar=null,cr=null){return getChildren(this,or,ar,cr)}toString(){return this._tree.toString()}get node(){return this}matchContext(or){return matchNodeContext(this,or)}}function getChildren(lr,or,ar,cr){let ur=lr.cursor(),hr=[];if(!ur.firstChild())return hr;if(ar!=null){for(;!ur.type.is(ar);)if(!ur.nextSibling())return hr}for(;;){if(cr!=null&&ur.type.is(cr))return hr;if(ur.type.is(or)&&hr.push(ur.node),!ur.nextSibling())return cr==null?hr:[]}}function matchNodeContext(lr,or,ar=or.length-1){for(let cr=lr.parent;ar>=0;cr=cr.parent){if(!cr)return!1;if(!cr.type.isAnonymous){if(or[ar]&&or[ar]!=cr.name)return!1;ar--}}return!0}class BufferContext{constructor(or,ar,cr,ur){this.parent=or,this.buffer=ar,this.index=cr,this.start=ur}}class BufferNode{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(or,ar,cr){this.context=or,this._parent=ar,this.index=cr,this.type=or.buffer.set.types[or.buffer.buffer[cr]]}child(or,ar,cr){let{buffer:ur}=this.context,hr=ur.findChild(this.index+4,ur.buffer[this.index+3],or,ar-this.context.start,cr);return hr<0?null:new BufferNode(this.context,this,hr)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(or){return this.child(1,or,2)}childBefore(or){return this.child(-1,or,-2)}enter(or,ar,cr=0){if(cr&IterMode.ExcludeBuffers)return null;let{buffer:ur}=this.context,hr=ur.findChild(this.index+4,ur.buffer[this.index+3],ar>0?1:-1,or-this.context.start,ar);return hr<0?null:new BufferNode(this.context,this,hr)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(or){return this._parent?null:this.context.parent.nextChild(this.context.index+or,or,0,4)}get nextSibling(){let{buffer:or}=this.context,ar=or.buffer[this.index+3];return ar<(this._parent?or.buffer[this._parent.index+3]:or.buffer.length)?new BufferNode(this.context,this._parent,ar):this.externalSibling(1)}get prevSibling(){let{buffer:or}=this.context,ar=this._parent?this._parent.index+4:0;return this.index==ar?this.externalSibling(-1):new BufferNode(this.context,this._parent,or.findChild(ar,this.index,-1,0,4))}cursor(or=0){return new TreeCursor(this,or)}get tree(){return null}toTree(){let or=[],ar=[],{buffer:cr}=this.context,ur=this.index+4,hr=cr.buffer[this.index+3];if(hr>ur){let fr=cr.buffer[this.index+1];or.push(cr.slice(ur,hr,fr)),ar.push(0)}return new Tree$1(this.type,or,ar,this.to-this.from)}resolve(or,ar=0){return resolveNode(this,or,ar,!1)}resolveInner(or,ar=0){return resolveNode(this,or,ar,!0)}enterUnfinishedNodesBefore(or){return enterUnfinishedNodesBefore(this,or)}toString(){return this.context.buffer.childString(this.index)}getChild(or,ar=null,cr=null){let ur=getChildren(this,or,ar,cr);return ur.length?ur[0]:null}getChildren(or,ar=null,cr=null){return getChildren(this,or,ar,cr)}get node(){return this}matchContext(or){return matchNodeContext(this,or)}}class TreeCursor{get name(){return this.type.name}constructor(or,ar=0){if(this.mode=ar,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,or instanceof TreeNode)this.yieldNode(or);else{this._tree=or.context.parent,this.buffer=or.context;for(let cr=or._parent;cr;cr=cr._parent)this.stack.unshift(cr.index);this.bufferNode=or,this.yieldBuf(or.index)}}yieldNode(or){return or?(this._tree=or,this.type=or.type,this.from=or.from,this.to=or.to,!0):!1}yieldBuf(or,ar){this.index=or;let{start:cr,buffer:ur}=this.buffer;return this.type=ar||ur.set.types[ur.buffer[or]],this.from=cr+ur.buffer[or+1],this.to=cr+ur.buffer[or+2],!0}yield(or){return or?or instanceof TreeNode?(this.buffer=null,this.yieldNode(or)):(this.buffer=or.context,this.yieldBuf(or.index,or.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(or,ar,cr){if(!this.buffer)return this.yield(this._tree.nextChild(or<0?this._tree._tree.children.length-1:0,or,ar,cr,this.mode));let{buffer:ur}=this.buffer,hr=ur.findChild(this.index+4,ur.buffer[this.index+3],or,ar-this.buffer.start,cr);return hr<0?!1:(this.stack.push(this.index),this.yieldBuf(hr))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(or){return this.enterChild(1,or,2)}childBefore(or){return this.enterChild(-1,or,-2)}enter(or,ar,cr=this.mode){return this.buffer?cr&IterMode.ExcludeBuffers?!1:this.enterChild(1,or,ar):this.yield(this._tree.enter(or,ar,cr))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let or=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(or)}sibling(or){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+or,or,0,4,this.mode)):!1;let{buffer:ar}=this.buffer,cr=this.stack.length-1;if(or<0){let ur=cr<0?0:this.stack[cr]+4;if(this.index!=ur)return this.yieldBuf(ar.findChild(ur,this.index,-1,0,4))}else{let ur=ar.buffer[this.index+3];if(ur<(cr<0?ar.buffer.length:ar.buffer[this.stack[cr]+3]))return this.yieldBuf(ur)}return cr<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+or,or,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(or){let ar,cr,{buffer:ur}=this;if(ur){if(or>0){if(this.index<ur.buffer.buffer.length)return!1}else for(let hr=0;hr<this.index;hr++)if(ur.buffer.buffer[hr+3]<this.index)return!1;({index:ar,parent:cr}=ur)}else({index:ar,_parent:cr}=this._tree);for(;cr;{index:ar,_parent:cr}=cr)if(ar>-1)for(let hr=ar+or,fr=or<0?-1:cr._tree.children.length;hr!=fr;hr+=or){let dr=cr._tree.children[hr];if(this.mode&IterMode.IncludeAnonymous||dr instanceof TreeBuffer||!dr.type.isAnonymous||hasChild(dr))return!1}return!0}move(or,ar){if(ar&&this.enterChild(or,0,4))return!0;for(;;){if(this.sibling(or))return!0;if(this.atLastNode(or)||!this.parent())return!1}}next(or=!0){return this.move(1,or)}prev(or=!0){return this.move(-1,or)}moveTo(or,ar=0){for(;(this.from==this.to||(ar<1?this.from>=or:this.from>or)||(ar>-1?this.to<=or:this.to<or))&&this.parent(););for(;this.enterChild(1,or,ar););return this}get node(){if(!this.buffer)return this._tree;let or=this.bufferNode,ar=null,cr=0;if(or&&or.context==this.buffer)e:for(let ur=this.index,hr=this.stack.length;hr>=0;){for(let fr=or;fr;fr=fr._parent)if(fr.index==ur){if(ur==this.index)return fr;ar=fr,cr=hr+1;break e}ur=this.stack[--hr]}for(let ur=cr;ur<this.stack.length;ur++)ar=new BufferNode(this.buffer,ar,this.stack[ur]);return this.bufferNode=new BufferNode(this.buffer,ar,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(or,ar){for(let cr=0;;){let ur=!1;if(this.type.isAnonymous||or(this)!==!1){if(this.firstChild()){cr++;continue}this.type.isAnonymous||(ur=!0)}for(;ur&&ar&&ar(this),ur=this.type.isAnonymous,!this.nextSibling();){if(!cr)return;this.parent(),cr--,ur=!0}}}matchContext(or){if(!this.buffer)return matchNodeContext(this.node,or);let{buffer:ar}=this.buffer,{types:cr}=ar.set;for(let ur=or.length-1,hr=this.stack.length-1;ur>=0;hr--){if(hr<0)return matchNodeContext(this.node,or,ur);let fr=cr[ar.buffer[this.stack[hr]]];if(!fr.isAnonymous){if(or[ur]&&or[ur]!=fr.name)return!1;ur--}}return!0}}function hasChild(lr){return lr.children.some(or=>or instanceof TreeBuffer||!or.type.isAnonymous||hasChild(or))}function buildTree(lr){var or;let{buffer:ar,nodeSet:cr,maxBufferLength:ur=DefaultBufferLength,reused:hr=[],minRepeatType:fr=cr.types.length}=lr,dr=Array.isArray(ar)?new FlatBufferCursor(ar,ar.length):ar,pr=cr.types,mr=0,gr=0;function yr($r,Nr,Br,Fr,Vr){let{id:Rr,start:Gr,end:qr,size:Ur}=dr,Yr=gr;for(;Ur<0;)if(dr.next(),Ur==-1){let ui=hr[Rr];Br.push(ui),Fr.push(Gr-$r);return}else if(Ur==-3){mr=Rr;return}else if(Ur==-4){gr=Rr;return}else throw new RangeError(`Unrecognized record size: ${Ur}`);let Dr=pr[Rr],Jr,ai,Kr=Gr-$r;if(qr-Gr<=ur&&(ai=vr(dr.pos-Nr,Vr))){let ui=new Uint16Array(ai.size-ai.skip),ii=dr.pos-ai.size,di=ui.length;for(;dr.pos>ii;)di=xr(ai.start,ui,di);Jr=new TreeBuffer(ui,qr-ai.start,cr),Kr=ai.start-$r}else{let ui=dr.pos-Ur;dr.next();let ii=[],di=[],ei=Rr>=fr?Rr:-1,Wr=0,ti=qr;for(;dr.pos>ui;)ei>=0&&dr.id==ei&&dr.size>=0?(dr.end<=ti-ur&&(Or(ii,di,Gr,Wr,dr.end,ti,ei,Yr),Wr=ii.length,ti=dr.end),dr.next()):yr(Gr,ui,ii,di,ei);if(ei>=0&&Wr>0&&Wr<ii.length&&Or(ii,di,Gr,Wr,Gr,ti,ei,Yr),ii.reverse(),di.reverse(),ei>-1&&Wr>0){let si=br(Dr);Jr=balanceRange(Dr,ii,di,0,ii.length,0,qr-Gr,si,si)}else Jr=_r(Dr,ii,di,qr-Gr,Yr-qr)}Br.push(Jr),Fr.push(Kr)}function br($r){return(Nr,Br,Fr)=>{let Vr=0,Rr=Nr.length-1,Gr,qr;if(Rr>=0&&(Gr=Nr[Rr])instanceof Tree$1){if(!Rr&&Gr.type==$r&&Gr.length==Fr)return Gr;(qr=Gr.prop(NodeProp.lookAhead))&&(Vr=Br[Rr]+Gr.length+qr)}return _r($r,Nr,Br,Fr,Vr)}}function Or($r,Nr,Br,Fr,Vr,Rr,Gr,qr){let Ur=[],Yr=[];for(;$r.length>Fr;)Ur.push($r.pop()),Yr.push(Nr.pop()+Br-Vr);$r.push(_r(cr.types[Gr],Ur,Yr,Rr-Vr,qr-Rr)),Nr.push(Vr-Br)}function _r($r,Nr,Br,Fr,Vr=0,Rr){if(mr){let Gr=[NodeProp.contextHash,mr];Rr=Rr?[Gr].concat(Rr):[Gr]}if(Vr>25){let Gr=[NodeProp.lookAhead,Vr];Rr=Rr?[Gr].concat(Rr):[Gr]}return new Tree$1($r,Nr,Br,Fr,Rr)}function vr($r,Nr){let Br=dr.fork(),Fr=0,Vr=0,Rr=0,Gr=Br.end-ur,qr={size:0,start:0,skip:0};e:for(let Ur=Br.pos-$r;Br.pos>Ur;){let Yr=Br.size;if(Br.id==Nr&&Yr>=0){qr.size=Fr,qr.start=Vr,qr.skip=Rr,Rr+=4,Fr+=4,Br.next();continue}let Dr=Br.pos-Yr;if(Yr<0||Dr<Ur||Br.start<Gr)break;let Jr=Br.id>=fr?4:0,ai=Br.start;for(Br.next();Br.pos>Dr;){if(Br.size<0)if(Br.size==-3)Jr+=4;else break e;else Br.id>=fr&&(Jr+=4);Br.next()}Vr=ai,Fr+=Yr,Rr+=Jr}return(Nr<0||Fr==$r)&&(qr.size=Fr,qr.start=Vr,qr.skip=Rr),qr.size>4?qr:void 0}function xr($r,Nr,Br){let{id:Fr,start:Vr,end:Rr,size:Gr}=dr;if(dr.next(),Gr>=0&&Fr<fr){let qr=Br;if(Gr>4){let Ur=dr.pos-(Gr-4);for(;dr.pos>Ur;)Br=xr($r,Nr,Br)}Nr[--Br]=qr,Nr[--Br]=Rr-$r,Nr[--Br]=Vr-$r,Nr[--Br]=Fr}else Gr==-3?mr=Fr:Gr==-4&&(gr=Fr);return Br}let wr=[],kr=[];for(;dr.pos>0;)yr(lr.start||0,lr.bufferStart||0,wr,kr,-1);let Cr=(or=lr.length)!==null&&or!==void 0?or:wr.length?kr[0]+wr[0].length:0;return new Tree$1(pr[lr.topID],wr.reverse(),kr.reverse(),Cr)}const nodeSizeCache=new WeakMap;function nodeSize(lr,or){if(!lr.isAnonymous||or instanceof TreeBuffer||or.type!=lr)return 1;let ar=nodeSizeCache.get(or);if(ar==null){ar=1;for(let cr of or.children){if(cr.type!=lr||!(cr instanceof Tree$1)){ar=1;break}ar+=nodeSize(lr,cr)}nodeSizeCache.set(or,ar)}return ar}function balanceRange(lr,or,ar,cr,ur,hr,fr,dr,pr){let mr=0;for(let _r=cr;_r<ur;_r++)mr+=nodeSize(lr,or[_r]);let gr=Math.ceil(mr*1.5/8),yr=[],br=[];function Or(_r,vr,xr,wr,kr){for(let Cr=xr;Cr<wr;){let $r=Cr,Nr=vr[Cr],Br=nodeSize(lr,_r[Cr]);for(Cr++;Cr<wr;Cr++){let Fr=nodeSize(lr,_r[Cr]);if(Br+Fr>=gr)break;Br+=Fr}if(Cr==$r+1){if(Br>gr){let Fr=_r[$r];Or(Fr.children,Fr.positions,0,Fr.children.length,vr[$r]+kr);continue}yr.push(_r[$r])}else{let Fr=vr[Cr-1]+_r[Cr-1].length-Nr;yr.push(balanceRange(lr,_r,vr,$r,Cr,Nr,Fr,null,pr))}br.push(Nr+kr-hr)}}return Or(or,ar,cr,ur,0),(dr||pr)(yr,br,fr)}class NodeWeakMap{constructor(){this.map=new WeakMap}setBuffer(or,ar,cr){let ur=this.map.get(or);ur||this.map.set(or,ur=new Map),ur.set(ar,cr)}getBuffer(or,ar){let cr=this.map.get(or);return cr&&cr.get(ar)}set(or,ar){or instanceof BufferNode?this.setBuffer(or.context.buffer,or.index,ar):or instanceof TreeNode&&this.map.set(or.tree,ar)}get(or){return or instanceof BufferNode?this.getBuffer(or.context.buffer,or.index):or instanceof TreeNode?this.map.get(or.tree):void 0}cursorSet(or,ar){or.buffer?this.setBuffer(or.buffer.buffer,or.index,ar):this.map.set(or.tree,ar)}cursorGet(or){return or.buffer?this.getBuffer(or.buffer.buffer,or.index):this.map.get(or.tree)}}class TreeFragment{constructor(or,ar,cr,ur,hr=!1,fr=!1){this.from=or,this.to=ar,this.tree=cr,this.offset=ur,this.open=(hr?1:0)|(fr?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(or,ar=[],cr=!1){let ur=[new TreeFragment(0,or.length,or,0,!1,cr)];for(let hr of ar)hr.to>or.length&&ur.push(hr);return ur}static applyChanges(or,ar,cr=128){if(!ar.length)return or;let ur=[],hr=1,fr=or.length?or[0]:null;for(let dr=0,pr=0,mr=0;;dr++){let gr=dr<ar.length?ar[dr]:null,yr=gr?gr.fromA:1e9;if(yr-pr>=cr)for(;fr&&fr.from<yr;){let br=fr;if(pr>=br.from||yr<=br.to||mr){let Or=Math.max(br.from,pr)-mr,_r=Math.min(br.to,yr)-mr;br=Or>=_r?null:new TreeFragment(Or,_r,br.tree,br.offset+mr,dr>0,!!gr)}if(br&&ur.push(br),fr.to>yr)break;fr=hr<or.length?or[hr++]:null}if(!gr)break;pr=gr.toA,mr=gr.toA-gr.toB}return ur}}class Parser{startParse(or,ar,cr){return typeof or=="string"&&(or=new StringInput(or)),cr=cr?cr.length?cr.map(ur=>new Range(ur.from,ur.to)):[new Range(0,0)]:[new Range(0,or.length)],this.createParse(or,ar||[],cr)}parse(or,ar,cr){let ur=this.startParse(or,ar,cr);for(;;){let hr=ur.advance();if(hr)return hr}}}class StringInput{constructor(or){this.string=or}get length(){return this.string.length}chunk(or){return this.string.slice(or)}get lineChunks(){return!1}read(or,ar){return this.string.slice(or,ar)}}function parseMixed(lr){return(or,ar,cr,ur)=>new MixedParse(or,lr,ar,cr,ur)}class InnerParse{constructor(or,ar,cr,ur,hr){if(this.parser=or,this.parse=ar,this.overlay=cr,this.target=ur,this.ranges=hr,!hr.length||hr.some(fr=>fr.from>=fr.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(hr))}}class ActiveOverlay{constructor(or,ar,cr,ur,hr,fr,dr){this.parser=or,this.predicate=ar,this.mounts=cr,this.index=ur,this.start=hr,this.target=fr,this.prev=dr,this.depth=0,this.ranges=[]}}const stoppedInner=new NodeProp({perNode:!0});class MixedParse{constructor(or,ar,cr,ur,hr){this.nest=ar,this.input=cr,this.fragments=ur,this.ranges=hr,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=or}advance(){if(this.baseParse){let cr=this.baseParse.advance();if(!cr)return null;if(this.baseParse=null,this.baseTree=cr,this.startInner(),this.stoppedAt!=null)for(let ur of this.inner)ur.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let cr=this.baseTree;return this.stoppedAt!=null&&(cr=new Tree$1(cr.type,cr.children,cr.positions,cr.length,cr.propValues.concat([[stoppedInner,this.stoppedAt]]))),cr}let or=this.inner[this.innerDone],ar=or.parse.advance();if(ar){this.innerDone++;let cr=Object.assign(Object.create(null),or.target.props);cr[NodeProp.mounted.id]=new MountedTree(ar,or.overlay,or.parser),or.target.props=cr}return null}get parsedPos(){if(this.baseParse)return 0;let or=this.input.length;for(let ar=this.innerDone;ar<this.inner.length;ar++)this.inner[ar].ranges[0].from<or&&(or=Math.min(or,this.inner[ar].parse.parsedPos));return or}stopAt(or){if(this.stoppedAt=or,this.baseParse)this.baseParse.stopAt(or);else for(let ar=this.innerDone;ar<this.inner.length;ar++)this.inner[ar].parse.stopAt(or)}startInner(){let or=new FragmentCursor$2(this.fragments),ar=null,cr=null,ur=new TreeCursor(new TreeNode(this.baseTree,this.ranges[0].from,0,null),IterMode.IncludeAnonymous|IterMode.IgnoreMounts);e:for(let hr,fr;this.stoppedAt==null||ur.from<this.stoppedAt;){let dr=!0,pr;if(or.hasNode(ur)){if(ar){let mr=ar.mounts.find(gr=>gr.frag.from<=ur.from&&gr.frag.to>=ur.to&&gr.mount.overlay);if(mr)for(let gr of mr.mount.overlay){let yr=gr.from+mr.pos,br=gr.to+mr.pos;yr>=ur.from&&br<=ur.to&&!ar.ranges.some(Or=>Or.from<br&&Or.to>yr)&&ar.ranges.push({from:yr,to:br})}}dr=!1}else if(cr&&(fr=checkCover(cr.ranges,ur.from,ur.to)))dr=fr!=2;else if(!ur.type.isAnonymous&&ur.from<ur.to&&(hr=this.nest(ur,this.input))){ur.tree||materialize(ur);let mr=or.findMounts(ur.from,hr.parser);if(typeof hr.overlay=="function")ar=new ActiveOverlay(hr.parser,hr.overlay,mr,this.inner.length,ur.from,ur.tree,ar);else{let gr=punchRanges(this.ranges,hr.overlay||[new Range(ur.from,ur.to)]);gr.length&&this.inner.push(new InnerParse(hr.parser,hr.parser.startParse(this.input,enterFragments(mr,gr),gr),hr.overlay?hr.overlay.map(yr=>new Range(yr.from-ur.from,yr.to-ur.from)):null,ur.tree,gr)),hr.overlay?gr.length&&(cr={ranges:gr,depth:0,prev:cr}):dr=!1}}else ar&&(pr=ar.predicate(ur))&&(pr===!0&&(pr=new Range(ur.from,ur.to)),pr.from<pr.to&&ar.ranges.push(pr));if(dr&&ur.firstChild())ar&&ar.depth++,cr&&cr.depth++;else for(;!ur.nextSibling();){if(!ur.parent())break e;if(ar&&!--ar.depth){let mr=punchRanges(this.ranges,ar.ranges);mr.length&&this.inner.splice(ar.index,0,new InnerParse(ar.parser,ar.parser.startParse(this.input,enterFragments(ar.mounts,mr),mr),ar.ranges.map(gr=>new Range(gr.from-ar.start,gr.to-ar.start)),ar.target,mr)),ar=ar.prev}cr&&!--cr.depth&&(cr=cr.prev)}}}}function checkCover(lr,or,ar){for(let cr of lr){if(cr.from>=ar)break;if(cr.to>or)return cr.from<=or&&cr.to>=ar?2:1}return 0}function sliceBuf(lr,or,ar,cr,ur,hr){if(or<ar){let fr=lr.buffer[or+1];cr.push(lr.slice(or,ar,fr)),ur.push(fr-hr)}}function materialize(lr){let{node:or}=lr,ar=0;do lr.parent(),ar++;while(!lr.tree);let cr=0,ur=lr.tree,hr=0;for(;hr=ur.positions[cr]+lr.from,!(hr<=or.from&&hr+ur.children[cr].length>=or.to);cr++);let fr=ur.children[cr],dr=fr.buffer;function pr(mr,gr,yr,br,Or){let _r=mr;for(;dr[_r+2]+hr<=or.from;)_r=dr[_r+3];let vr=[],xr=[];sliceBuf(fr,mr,_r,vr,xr,br);let wr=dr[_r+1],kr=dr[_r+2],Cr=wr+hr==or.from&&kr+hr==or.to&&dr[_r]==or.type.id;return vr.push(Cr?or.toTree():pr(_r+4,dr[_r+3],fr.set.types[dr[_r]],wr,kr-wr)),xr.push(wr-br),sliceBuf(fr,dr[_r+3],gr,vr,xr,br),new Tree$1(yr,vr,xr,Or)}ur.children[cr]=pr(0,dr.length,NodeType.none,0,fr.length);for(let mr=0;mr<=ar;mr++)lr.childAfter(or.from)}class StructureCursor{constructor(or,ar){this.offset=ar,this.done=!1,this.cursor=or.cursor(IterMode.IncludeAnonymous|IterMode.IgnoreMounts)}moveTo(or){let{cursor:ar}=this,cr=or-this.offset;for(;!this.done&&ar.from<cr;)ar.to>=or&&ar.enter(cr,1,IterMode.IgnoreOverlays|IterMode.ExcludeBuffers)||ar.next(!1)||(this.done=!0)}hasNode(or){if(this.moveTo(or.from),!this.done&&this.cursor.from+this.offset==or.from&&this.cursor.tree)for(let ar=this.cursor.tree;;){if(ar==or.tree)return!0;if(ar.children.length&&ar.positions[0]==0&&ar.children[0]instanceof Tree$1)ar=ar.children[0];else break}return!1}}let FragmentCursor$2=class{constructor(or){var ar;if(this.fragments=or,this.curTo=0,this.fragI=0,or.length){let cr=this.curFrag=or[0];this.curTo=(ar=cr.tree.prop(stoppedInner))!==null&&ar!==void 0?ar:cr.to,this.inner=new StructureCursor(cr.tree,-cr.offset)}else this.curFrag=this.inner=null}hasNode(or){for(;this.curFrag&&or.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=or.from&&this.curTo>=or.to&&this.inner.hasNode(or)}nextFrag(){var or;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let ar=this.curFrag=this.fragments[this.fragI];this.curTo=(or=ar.tree.prop(stoppedInner))!==null&&or!==void 0?or:ar.to,this.inner=new StructureCursor(ar.tree,-ar.offset)}}findMounts(or,ar){var cr;let ur=[];if(this.inner){this.inner.cursor.moveTo(or,1);for(let hr=this.inner.cursor.node;hr;hr=hr.parent){let fr=(cr=hr.tree)===null||cr===void 0?void 0:cr.prop(NodeProp.mounted);if(fr&&fr.parser==ar)for(let dr=this.fragI;dr<this.fragments.length;dr++){let pr=this.fragments[dr];if(pr.from>=hr.to)break;pr.tree==this.curFrag.tree&&ur.push({frag:pr,pos:hr.from-pr.offset,mount:fr})}}}return ur}};function punchRanges(lr,or){let ar=null,cr=or;for(let ur=1,hr=0;ur<lr.length;ur++){let fr=lr[ur-1].to,dr=lr[ur].from;for(;hr<cr.length;hr++){let pr=cr[hr];if(pr.from>=dr)break;pr.to<=fr||(ar||(cr=ar=or.slice()),pr.from<fr?(ar[hr]=new Range(pr.from,fr),pr.to>dr&&ar.splice(hr+1,0,new Range(dr,pr.to))):pr.to>dr?ar[hr--]=new Range(dr,pr.to):ar.splice(hr--,1))}}return cr}function findCoverChanges(lr,or,ar,cr){let ur=0,hr=0,fr=!1,dr=!1,pr=-1e9,mr=[];for(;;){let gr=ur==lr.length?1e9:fr?lr[ur].to:lr[ur].from,yr=hr==or.length?1e9:dr?or[hr].to:or[hr].from;if(fr!=dr){let br=Math.max(pr,ar),Or=Math.min(gr,yr,cr);br<Or&&mr.push(new Range(br,Or))}if(pr=Math.min(gr,yr),pr==1e9)break;gr==pr&&(fr?(fr=!1,ur++):fr=!0),yr==pr&&(dr?(dr=!1,hr++):dr=!0)}return mr}function enterFragments(lr,or){let ar=[];for(let{pos:cr,mount:ur,frag:hr}of lr){let fr=cr+(ur.overlay?ur.overlay[0].from:0),dr=fr+ur.tree.length,pr=Math.max(hr.from,fr),mr=Math.min(hr.to,dr);if(ur.overlay){let gr=ur.overlay.map(br=>new Range(br.from+cr,br.to+cr)),yr=findCoverChanges(or,gr,pr,mr);for(let br=0,Or=pr;;br++){let _r=br==yr.length,vr=_r?mr:yr[br].from;if(vr>Or&&ar.push(new TreeFragment(Or,vr,ur.tree,-fr,hr.from>=Or||hr.openStart,hr.to<=vr||hr.openEnd)),_r)break;Or=yr[br].to}}else ar.push(new TreeFragment(pr,mr,ur.tree,-fr,hr.from>=fr||hr.openStart,hr.to<=dr||hr.openEnd))}return ar}let nextTagID=0;class Tag{constructor(or,ar,cr){this.set=or,this.base=ar,this.modified=cr,this.id=nextTagID++}static define(or){if(or!=null&&or.base)throw new Error("Can not derive from a modified tag");let ar=new Tag([],null,[]);if(ar.set.push(ar),or)for(let cr of or.set)ar.set.push(cr);return ar}static defineModifier(){let or=new Modifier;return ar=>ar.modified.indexOf(or)>-1?ar:Modifier.get(ar.base||ar,ar.modified.concat(or).sort((cr,ur)=>cr.id-ur.id))}}let nextModifierID=0;class Modifier{constructor(){this.instances=[],this.id=nextModifierID++}static get(or,ar){if(!ar.length)return or;let cr=ar[0].instances.find(dr=>dr.base==or&&sameArray(ar,dr.modified));if(cr)return cr;let ur=[],hr=new Tag(ur,or,ar);for(let dr of ar)dr.instances.push(hr);let fr=powerSet(ar);for(let dr of or.set)if(!dr.modified.length)for(let pr of fr)ur.push(Modifier.get(dr,pr));return hr}}function sameArray(lr,or){return lr.length==or.length&&lr.every((ar,cr)=>ar==or[cr])}function powerSet(lr){let or=[[]];for(let ar=0;ar<lr.length;ar++)for(let cr=0,ur=or.length;cr<ur;cr++)or.push(or[cr].concat(lr[ar]));return or.sort((ar,cr)=>cr.length-ar.length)}function styleTags(lr){let or=Object.create(null);for(let ar in lr){let cr=lr[ar];Array.isArray(cr)||(cr=[cr]);for(let ur of ar.split(" "))if(ur){let hr=[],fr=2,dr=ur;for(let yr=0;;){if(dr=="..."&&yr>0&&yr+3==ur.length){fr=1;break}let br=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(dr);if(!br)throw new RangeError("Invalid path: "+ur);if(hr.push(br[0]=="*"?"":br[0][0]=='"'?JSON.parse(br[0]):br[0]),yr+=br[0].length,yr==ur.length)break;let Or=ur[yr++];if(yr==ur.length&&Or=="!"){fr=0;break}if(Or!="/")throw new RangeError("Invalid path: "+ur);dr=ur.slice(yr)}let pr=hr.length-1,mr=hr[pr];if(!mr)throw new RangeError("Invalid path: "+ur);let gr=new Rule(cr,fr,pr>0?hr.slice(0,pr):null);or[mr]=gr.sort(or[mr])}}return ruleNodeProp.add(or)}const ruleNodeProp=new NodeProp;class Rule{constructor(or,ar,cr,ur){this.tags=or,this.mode=ar,this.context=cr,this.next=ur}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(or){return!or||or.depth<this.depth?(this.next=or,this):(or.next=this.sort(or.next),or)}get depth(){return this.context?this.context.length:0}}Rule.empty=new Rule([],2,null);function tagHighlighter(lr,or){let ar=Object.create(null);for(let hr of lr)if(!Array.isArray(hr.tag))ar[hr.tag.id]=hr.class;else for(let fr of hr.tag)ar[fr.id]=hr.class;let{scope:cr,all:ur=null}=or||{};return{style:hr=>{let fr=ur;for(let dr of hr)for(let pr of dr.set){let mr=ar[pr.id];if(mr){fr=fr?fr+" "+mr:mr;break}}return fr},scope:cr}}function highlightTags(lr,or){let ar=null;for(let cr of lr){let ur=cr.style(or);ur&&(ar=ar?ar+" "+ur:ur)}return ar}function highlightTree(lr,or,ar,cr=0,ur=lr.length){let hr=new HighlightBuilder(cr,Array.isArray(or)?or:[or],ar);hr.highlightRange(lr.cursor(),cr,ur,"",hr.highlighters),hr.flush(ur)}class HighlightBuilder{constructor(or,ar,cr){this.at=or,this.highlighters=ar,this.span=cr,this.class=""}startSpan(or,ar){ar!=this.class&&(this.flush(or),or>this.at&&(this.at=or),this.class=ar)}flush(or){or>this.at&&this.class&&this.span(this.at,or,this.class)}highlightRange(or,ar,cr,ur,hr){let{type:fr,from:dr,to:pr}=or;if(dr>=cr||pr<=ar)return;fr.isTop&&(hr=this.highlighters.filter(Or=>!Or.scope||Or.scope(fr)));let mr=ur,gr=getStyleTags(or)||Rule.empty,yr=highlightTags(hr,gr.tags);if(yr&&(mr&&(mr+=" "),mr+=yr,gr.mode==1&&(ur+=(ur?" ":"")+yr)),this.startSpan(Math.max(ar,dr),mr),gr.opaque)return;let br=or.tree&&or.tree.prop(NodeProp.mounted);if(br&&br.overlay){let Or=or.node.enter(br.overlay[0].from+dr,1),_r=this.highlighters.filter(xr=>!xr.scope||xr.scope(br.tree.type)),vr=or.firstChild();for(let xr=0,wr=dr;;xr++){let kr=xr<br.overlay.length?br.overlay[xr]:null,Cr=kr?kr.from+dr:pr,$r=Math.max(ar,wr),Nr=Math.min(cr,Cr);if($r<Nr&&vr)for(;or.from<Nr&&(this.highlightRange(or,$r,Nr,ur,hr),this.startSpan(Math.min(Nr,or.to),mr),!(or.to>=Cr||!or.nextSibling())););if(!kr||Cr>cr)break;wr=kr.to+dr,wr>ar&&(this.highlightRange(Or.cursor(),Math.max(ar,kr.from+dr),Math.min(cr,wr),"",_r),this.startSpan(Math.min(cr,wr),mr))}vr&&or.parent()}else if(or.firstChild()){br&&(ur="");do if(!(or.to<=ar)){if(or.from>=cr)break;this.highlightRange(or,ar,cr,ur,hr),this.startSpan(Math.min(cr,or.to),mr)}while(or.nextSibling());or.parent()}}}function getStyleTags(lr){let or=lr.type.prop(ruleNodeProp);for(;or&&or.context&&!lr.matchContext(or.context);)or=or.next;return or||null}const t$4=Tag.define,comment=t$4(),name$q=t$4(),typeName=t$4(name$q),propertyName=t$4(name$q),literal=t$4(),string=t$4(literal),number=t$4(literal),content=t$4(),heading$1=t$4(content),keyword=t$4(),operator=t$4(),punctuation=t$4(),bracket=t$4(punctuation),meta=t$4(),tags$1={comment,lineComment:t$4(comment),blockComment:t$4(comment),docComment:t$4(comment),name:name$q,variableName:t$4(name$q),typeName,tagName:t$4(typeName),propertyName,attributeName:t$4(propertyName),className:t$4(name$q),labelName:t$4(name$q),namespace:t$4(name$q),macroName:t$4(name$q),literal,string,docString:t$4(string),character:t$4(string),attributeValue:t$4(string),number,integer:t$4(number),float:t$4(number),bool:t$4(literal),regexp:t$4(literal),escape:t$4(literal),color:t$4(literal),url:t$4(literal),keyword,self:t$4(keyword),null:t$4(keyword),atom:t$4(keyword),unit:t$4(keyword),modifier:t$4(keyword),operatorKeyword:t$4(keyword),controlKeyword:t$4(keyword),definitionKeyword:t$4(keyword),moduleKeyword:t$4(keyword),operator,derefOperator:t$4(operator),arithmeticOperator:t$4(operator),logicOperator:t$4(operator),bitwiseOperator:t$4(operator),compareOperator:t$4(operator),updateOperator:t$4(operator),definitionOperator:t$4(operator),typeOperator:t$4(operator),controlOperator:t$4(operator),punctuation,separator:t$4(punctuation),bracket,angleBracket:t$4(bracket),squareBracket:t$4(bracket),paren:t$4(bracket),brace:t$4(bracket),content,heading:heading$1,heading1:t$4(heading$1),heading2:t$4(heading$1),heading3:t$4(heading$1),heading4:t$4(heading$1),heading5:t$4(heading$1),heading6:t$4(heading$1),contentSeparator:t$4(content),list:t$4(content),quote:t$4(content),emphasis:t$4(content),strong:t$4(content),link:t$4(content),monospace:t$4(content),strikethrough:t$4(content),inserted:t$4(),deleted:t$4(),changed:t$4(),invalid:t$4(),meta,documentMeta:t$4(meta),annotation:t$4(meta),processingInstruction:t$4(meta),definition:Tag.defineModifier(),constant:Tag.defineModifier(),function:Tag.defineModifier(),standard:Tag.defineModifier(),local:Tag.defineModifier(),special:Tag.defineModifier()},classHighlighter=tagHighlighter([{tag:tags$1.link,class:"tok-link"},{tag:tags$1.heading,class:"tok-heading"},{tag:tags$1.emphasis,class:"tok-emphasis"},{tag:tags$1.strong,class:"tok-strong"},{tag:tags$1.keyword,class:"tok-keyword"},{tag:tags$1.atom,class:"tok-atom"},{tag:tags$1.bool,class:"tok-bool"},{tag:tags$1.url,class:"tok-url"},{tag:tags$1.labelName,class:"tok-labelName"},{tag:tags$1.inserted,class:"tok-inserted"},{tag:tags$1.deleted,class:"tok-deleted"},{tag:tags$1.literal,class:"tok-literal"},{tag:tags$1.string,class:"tok-string"},{tag:tags$1.number,class:"tok-number"},{tag:[tags$1.regexp,tags$1.escape,tags$1.special(tags$1.string)],class:"tok-string2"},{tag:tags$1.variableName,class:"tok-variableName"},{tag:tags$1.local(tags$1.variableName),class:"tok-variableName tok-local"},{tag:tags$1.definition(tags$1.variableName),class:"tok-variableName tok-definition"},{tag:tags$1.special(tags$1.variableName),class:"tok-variableName2"},{tag:tags$1.definition(tags$1.propertyName),class:"tok-propertyName tok-definition"},{tag:tags$1.typeName,class:"tok-typeName"},{tag:tags$1.namespace,class:"tok-namespace"},{tag:tags$1.className,class:"tok-className"},{tag:tags$1.macroName,class:"tok-macroName"},{tag:tags$1.propertyName,class:"tok-propertyName"},{tag:tags$1.operator,class:"tok-operator"},{tag:tags$1.comment,class:"tok-comment"},{tag:tags$1.meta,class:"tok-meta"},{tag:tags$1.invalid,class:"tok-invalid"},{tag:tags$1.punctuation,class:"tok-punctuation"}]);var _a;const languageDataProp=new NodeProp;function defineLanguageFacet(lr){return Facet.define({combine:lr?or=>or.concat(lr):void 0})}const sublanguageProp=new NodeProp;class Language{constructor(or,ar,cr=[],ur=""){this.data=or,this.name=ur,EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(EditorState.prototype,"tree",{get(){return syntaxTree(this)}}),this.parser=ar,this.extension=[language.of(this),EditorState.languageData.of((hr,fr,dr)=>{let pr=topNodeAt(hr,fr,dr),mr=pr.type.prop(languageDataProp);if(!mr)return[];let gr=hr.facet(mr),yr=pr.type.prop(sublanguageProp);if(yr){let br=pr.resolve(fr-pr.from,dr);for(let Or of yr)if(Or.test(br,hr)){let _r=hr.facet(Or.facet);return Or.type=="replace"?_r:_r.concat(gr)}}return gr})].concat(cr)}isActiveAt(or,ar,cr=-1){return topNodeAt(or,ar,cr).type.prop(languageDataProp)==this.data}findRegions(or){let ar=or.facet(language);if((ar==null?void 0:ar.data)==this.data)return[{from:0,to:or.doc.length}];if(!ar||!ar.allowsNesting)return[];let cr=[],ur=(hr,fr)=>{if(hr.prop(languageDataProp)==this.data){cr.push({from:fr,to:fr+hr.length});return}let dr=hr.prop(NodeProp.mounted);if(dr){if(dr.tree.prop(languageDataProp)==this.data){if(dr.overlay)for(let pr of dr.overlay)cr.push({from:pr.from+fr,to:pr.to+fr});else cr.push({from:fr,to:fr+hr.length});return}else if(dr.overlay){let pr=cr.length;if(ur(dr.tree,dr.overlay[0].from+fr),cr.length>pr)return}}for(let pr=0;pr<hr.children.length;pr++){let mr=hr.children[pr];mr instanceof Tree$1&&ur(mr,hr.positions[pr]+fr)}};return ur(syntaxTree(or),0),cr}get allowsNesting(){return!0}}Language.setState=StateEffect.define();function topNodeAt(lr,or,ar){let cr=lr.facet(language),ur=syntaxTree(lr).topNode;if(!cr||cr.allowsNesting)for(let hr=ur;hr;hr=hr.enter(or,ar,IterMode.ExcludeBuffers))hr.type.isTop&&(ur=hr);return ur}class LRLanguage extends Language{constructor(or,ar,cr){super(or,ar,[],cr),this.parser=ar}static define(or){let ar=defineLanguageFacet(or.languageData);return new LRLanguage(ar,or.parser.configure({props:[languageDataProp.add(cr=>cr.isTop?ar:void 0)]}),or.name)}configure(or,ar){return new LRLanguage(this.data,this.parser.configure(or),ar||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function syntaxTree(lr){let or=lr.field(Language.state,!1);return or?or.tree:Tree$1.empty}class DocInput{constructor(or){this.doc=or,this.cursorPos=0,this.string="",this.cursor=or.iter()}get length(){return this.doc.length}syncTo(or){return this.string=this.cursor.next(or-this.cursorPos).value,this.cursorPos=or+this.string.length,this.cursorPos-this.string.length}chunk(or){return this.syncTo(or),this.string}get lineChunks(){return!0}read(or,ar){let cr=this.cursorPos-this.string.length;return or<cr||ar>=this.cursorPos?this.doc.sliceString(or,ar):this.string.slice(or-cr,ar-cr)}}let currentContext=null;class ParseContext{constructor(or,ar,cr=[],ur,hr,fr,dr,pr){this.parser=or,this.state=ar,this.fragments=cr,this.tree=ur,this.treeLen=hr,this.viewport=fr,this.skipped=dr,this.scheduleOn=pr,this.parse=null,this.tempSkipped=[]}static create(or,ar,cr){return new ParseContext(or,ar,[],Tree$1.empty,0,cr,[],null)}startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments)}work(or,ar){return ar!=null&&ar>=this.state.doc.length&&(ar=void 0),this.tree!=Tree$1.empty&&this.isDone(ar??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var cr;if(typeof or=="number"){let ur=Date.now()+or;or=()=>Date.now()>ur}for(this.parse||(this.parse=this.startParse()),ar!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>ar)&&ar<this.state.doc.length&&this.parse.stopAt(ar);;){let ur=this.parse.advance();if(ur)if(this.fragments=this.withoutTempSkipped(TreeFragment.addTree(ur,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(cr=this.parse.stoppedAt)!==null&&cr!==void 0?cr:this.state.doc.length,this.tree=ur,this.parse=null,this.treeLen<(ar??this.state.doc.length))this.parse=this.startParse();else return!0;if(or())return!1}})}takeTree(){let or,ar;this.parse&&(or=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>or)&&this.parse.stopAt(or),this.withContext(()=>{for(;!(ar=this.parse.advance()););}),this.treeLen=or,this.tree=ar,this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(or){let ar=currentContext;currentContext=this;try{return or()}finally{currentContext=ar}}withoutTempSkipped(or){for(let ar;ar=this.tempSkipped.pop();)or=cutFragments(or,ar.from,ar.to);return or}changes(or,ar){let{fragments:cr,tree:ur,treeLen:hr,viewport:fr,skipped:dr}=this;if(this.takeTree(),!or.empty){let pr=[];if(or.iterChangedRanges((mr,gr,yr,br)=>pr.push({fromA:mr,toA:gr,fromB:yr,toB:br})),cr=TreeFragment.applyChanges(cr,pr),ur=Tree$1.empty,hr=0,fr={from:or.mapPos(fr.from,-1),to:or.mapPos(fr.to,1)},this.skipped.length){dr=[];for(let mr of this.skipped){let gr=or.mapPos(mr.from,1),yr=or.mapPos(mr.to,-1);gr<yr&&dr.push({from:gr,to:yr})}}}return new ParseContext(this.parser,ar,cr,ur,hr,fr,dr,this.scheduleOn)}updateViewport(or){if(this.viewport.from==or.from&&this.viewport.to==or.to)return!1;this.viewport=or;let ar=this.skipped.length;for(let cr=0;cr<this.skipped.length;cr++){let{from:ur,to:hr}=this.skipped[cr];ur<or.to&&hr>or.from&&(this.fragments=cutFragments(this.fragments,ur,hr),this.skipped.splice(cr--,1))}return this.skipped.length>=ar?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(or,ar){this.skipped.push({from:or,to:ar})}static getSkippingParser(or){return new class extends Parser{createParse(ar,cr,ur){let hr=ur[0].from,fr=ur[ur.length-1].to;return{parsedPos:hr,advance(){let pr=currentContext;if(pr){for(let mr of ur)pr.tempSkipped.push(mr);or&&(pr.scheduleOn=pr.scheduleOn?Promise.all([pr.scheduleOn,or]):or)}return this.parsedPos=fr,new Tree$1(NodeType.none,[],[],fr-hr)},stoppedAt:null,stopAt(){}}}}}isDone(or){or=Math.min(or,this.state.doc.length);let ar=this.fragments;return this.treeLen>=or&&ar.length&&ar[0].from==0&&ar[0].to>=or}static get(){return currentContext}}function cutFragments(lr,or,ar){return TreeFragment.applyChanges(lr,[{fromA:or,toA:ar,fromB:or,toB:ar}])}class LanguageState{constructor(or){this.context=or,this.tree=or.tree}apply(or){if(!or.docChanged&&this.tree==this.context.tree)return this;let ar=this.context.changes(or.changes,or.state),cr=this.context.treeLen==or.startState.doc.length?void 0:Math.max(or.changes.mapPos(this.context.treeLen),ar.viewport.to);return ar.work(20,cr)||ar.takeTree(),new LanguageState(ar)}static init(or){let ar=Math.min(3e3,or.doc.length),cr=ParseContext.create(or.facet(language).parser,or,{from:0,to:ar});return cr.work(20,ar)||cr.takeTree(),new LanguageState(cr)}}Language.state=StateField.define({create:LanguageState.init,update(lr,or){for(let ar of or.effects)if(ar.is(Language.setState))return ar.value;return or.startState.facet(language)!=or.state.facet(language)?LanguageState.init(or.state):lr.apply(or)}});let requestIdle=lr=>{let or=setTimeout(()=>lr(),500);return()=>clearTimeout(or)};typeof requestIdleCallback<"u"&&(requestIdle=lr=>{let or=-1,ar=setTimeout(()=>{or=requestIdleCallback(lr,{timeout:500-100})},100);return()=>or<0?clearTimeout(ar):cancelIdleCallback(or)});const isInputPending=typeof navigator<"u"&&(!((_a=navigator.scheduling)===null||_a===void 0)&&_a.isInputPending)?()=>navigator.scheduling.isInputPending():null,parseWorker=ViewPlugin.fromClass(class{constructor(or){this.view=or,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(or){let ar=this.view.state.field(Language.state).context;(ar.updateViewport(or.view.viewport)||this.view.viewport.to>ar.treeLen)&&this.scheduleWork(),or.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(ar)}scheduleWork(){if(this.working)return;let{state:or}=this.view,ar=or.field(Language.state);(ar.tree!=ar.context.tree||!ar.context.isDone(or.doc.length))&&(this.working=requestIdle(this.work))}work(or){this.working=null;let ar=Date.now();if(this.chunkEnd<ar&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=ar+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:cr,viewport:{to:ur}}=this.view,hr=cr.field(Language.state);if(hr.tree==hr.context.tree&&hr.context.isDone(ur+1e5))return;let fr=Date.now()+Math.min(this.chunkBudget,100,or&&!isInputPending?Math.max(25,or.timeRemaining()-5):1e9),dr=hr.context.treeLen<ur&&cr.doc.length>ur+1e3,pr=hr.context.work(()=>isInputPending&&isInputPending()||Date.now()>fr,ur+(dr?0:1e5));this.chunkBudget-=Date.now()-ar,(pr||this.chunkBudget<=0)&&(hr.context.takeTree(),this.view.dispatch({effects:Language.setState.of(new LanguageState(hr.context))})),this.chunkBudget>0&&!(pr&&!dr)&&this.scheduleWork(),this.checkAsyncSchedule(hr.context)}checkAsyncSchedule(or){or.scheduleOn&&(this.workScheduled++,or.scheduleOn.then(()=>this.scheduleWork()).catch(ar=>logException(this.view.state,ar)).then(()=>this.workScheduled--),or.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),language=Facet.define({combine(lr){return lr.length?lr[0]:null},enables:lr=>[Language.state,parseWorker,EditorView.contentAttributes.compute([lr],or=>{let ar=or.facet(lr);return ar&&ar.name?{"data-language":ar.name}:{}})]});class LanguageSupport{constructor(or,ar=[]){this.language=or,this.support=ar,this.extension=[or,ar]}}class LanguageDescription{constructor(or,ar,cr,ur,hr,fr=void 0){this.name=or,this.alias=ar,this.extensions=cr,this.filename=ur,this.loadFunc=hr,this.support=fr,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(or=>this.support=or,or=>{throw this.loading=null,or}))}static of(or){let{load:ar,support:cr}=or;if(!ar){if(!cr)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");ar=()=>Promise.resolve(cr)}return new LanguageDescription(or.name,(or.alias||[]).concat(or.name).map(ur=>ur.toLowerCase()),or.extensions||[],or.filename,ar,cr)}static matchFilename(or,ar){for(let ur of or)if(ur.filename&&ur.filename.test(ar))return ur;let cr=/\.([^.]+)$/.exec(ar);if(cr){for(let ur of or)if(ur.extensions.indexOf(cr[1])>-1)return ur}return null}static matchLanguageName(or,ar,cr=!0){ar=ar.toLowerCase();for(let ur of or)if(ur.alias.some(hr=>hr==ar))return ur;if(cr)for(let ur of or)for(let hr of ur.alias){let fr=ar.indexOf(hr);if(fr>-1&&(hr.length>2||!/\w/.test(ar[fr-1])&&!/\w/.test(ar[fr+hr.length])))return ur}return null}}const indentService=Facet.define(),indentUnit=Facet.define({combine:lr=>{if(!lr.length)return"  ";let or=lr[0];if(!or||/\S/.test(or)||Array.from(or).some(ar=>ar!=or[0]))throw new Error("Invalid indent unit: "+JSON.stringify(lr[0]));return or}});function getIndentUnit(lr){let or=lr.facet(indentUnit);return or.charCodeAt(0)==9?lr.tabSize*or.length:or.length}function indentString(lr,or){let ar="",cr=lr.tabSize,ur=lr.facet(indentUnit)[0];if(ur=="	"){for(;or>=cr;)ar+="	",or-=cr;ur=" "}for(let hr=0;hr<or;hr++)ar+=ur;return ar}function getIndentation(lr,or){lr instanceof EditorState&&(lr=new IndentContext(lr));for(let cr of lr.state.facet(indentService)){let ur=cr(lr,or);if(ur!==void 0)return ur}let ar=syntaxTree(lr.state);return ar.length>=or?syntaxIndentation(lr,ar,or):null}class IndentContext{constructor(or,ar={}){this.state=or,this.options=ar,this.unit=getIndentUnit(or)}lineAt(or,ar=1){let cr=this.state.doc.lineAt(or),{simulateBreak:ur,simulateDoubleBreak:hr}=this.options;return ur!=null&&ur>=cr.from&&ur<=cr.to?hr&&ur==or?{text:"",from:or}:(ar<0?ur<or:ur<=or)?{text:cr.text.slice(ur-cr.from),from:ur}:{text:cr.text.slice(0,ur-cr.from),from:cr.from}:cr}textAfterPos(or,ar=1){if(this.options.simulateDoubleBreak&&or==this.options.simulateBreak)return"";let{text:cr,from:ur}=this.lineAt(or,ar);return cr.slice(or-ur,Math.min(cr.length,or+100-ur))}column(or,ar=1){let{text:cr,from:ur}=this.lineAt(or,ar),hr=this.countColumn(cr,or-ur),fr=this.options.overrideIndentation?this.options.overrideIndentation(ur):-1;return fr>-1&&(hr+=fr-this.countColumn(cr,cr.search(/\S|$/))),hr}countColumn(or,ar=or.length){return countColumn(or,this.state.tabSize,ar)}lineIndent(or,ar=1){let{text:cr,from:ur}=this.lineAt(or,ar),hr=this.options.overrideIndentation;if(hr){let fr=hr(ur);if(fr>-1)return fr}return this.countColumn(cr,cr.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const indentNodeProp=new NodeProp;function syntaxIndentation(lr,or,ar){return indentFrom(or.resolveInner(ar).enterUnfinishedNodesBefore(ar),ar,lr)}function ignoreClosed(lr){return lr.pos==lr.options.simulateBreak&&lr.options.simulateDoubleBreak}function indentStrategy(lr){let or=lr.type.prop(indentNodeProp);if(or)return or;let ar=lr.firstChild,cr;if(ar&&(cr=ar.type.prop(NodeProp.closedBy))){let ur=lr.lastChild,hr=ur&&cr.indexOf(ur.name)>-1;return fr=>delimitedStrategy(fr,!0,1,void 0,hr&&!ignoreClosed(fr)?ur.from:void 0)}return lr.parent==null?topIndent:null}function indentFrom(lr,or,ar){for(;lr;lr=lr.parent){let cr=indentStrategy(lr);if(cr)return cr(TreeIndentContext.create(ar,or,lr))}return null}function topIndent(){return 0}class TreeIndentContext extends IndentContext{constructor(or,ar,cr){super(or.state,or.options),this.base=or,this.pos=ar,this.node=cr}static create(or,ar,cr){return new TreeIndentContext(or,ar,cr)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(or){let ar=this.state.doc.lineAt(or.from);for(;;){let cr=or.resolve(ar.from);for(;cr.parent&&cr.parent.from==cr.from;)cr=cr.parent;if(isParent(cr,or))break;ar=this.state.doc.lineAt(cr.from)}return this.lineIndent(ar.from)}continue(){let or=this.node.parent;return or?indentFrom(or,this.pos,this.base):0}}function isParent(lr,or){for(let ar=or;ar;ar=ar.parent)if(lr==ar)return!0;return!1}function bracketedAligned(lr){let or=lr.node,ar=or.childAfter(or.from),cr=or.lastChild;if(!ar)return null;let ur=lr.options.simulateBreak,hr=lr.state.doc.lineAt(ar.from),fr=ur==null||ur<=hr.from?hr.to:Math.min(hr.to,ur);for(let dr=ar.to;;){let pr=or.childAfter(dr);if(!pr||pr==cr)return null;if(!pr.type.isSkipped)return pr.from<fr?ar:null;dr=pr.to}}function delimitedIndent({closing:lr,align:or=!0,units:ar=1}){return cr=>delimitedStrategy(cr,or,ar,lr)}function delimitedStrategy(lr,or,ar,cr,ur){let hr=lr.textAfter,fr=hr.match(/^\s*/)[0].length,dr=cr&&hr.slice(fr,fr+cr.length)==cr||ur==lr.pos+fr,pr=or?bracketedAligned(lr):null;return pr?dr?lr.column(pr.from):lr.column(pr.to):lr.baseIndent+(dr?0:lr.unit*ar)}const flatIndent=lr=>lr.baseIndent;function continuedIndent({except:lr,units:or=1}={}){return ar=>{let cr=lr&&lr.test(ar.textAfter);return ar.baseIndent+(cr?0:or*ar.unit)}}const foldService=Facet.define(),foldNodeProp=new NodeProp;function foldInside(lr){let or=lr.firstChild,ar=lr.lastChild;return or&&or.to<ar.from?{from:or.to,to:ar.type.isError?lr.to:ar.from}:null}class HighlightStyle{constructor(or,ar){this.specs=or;let cr;function ur(dr){let pr=StyleModule.newName();return(cr||(cr=Object.create(null)))["."+pr]=dr,pr}const hr=typeof ar.all=="string"?ar.all:ar.all?ur(ar.all):void 0,fr=ar.scope;this.scope=fr instanceof Language?dr=>dr.prop(languageDataProp)==fr.data:fr?dr=>dr==fr:void 0,this.style=tagHighlighter(or.map(dr=>({tag:dr.tag,class:dr.class||ur(Object.assign({},dr,{tag:null}))})),{all:hr}).style,this.module=cr?new StyleModule(cr):null,this.themeType=ar.themeType}static define(or,ar){return new HighlightStyle(or,ar||{})}}const highlighterFacet=Facet.define(),fallbackHighlighter=Facet.define({combine(lr){return lr.length?[lr[0]]:null}});function getHighlighters(lr){let or=lr.facet(highlighterFacet);return or.length?or:lr.facet(fallbackHighlighter)}function syntaxHighlighting(lr,or){let ar=[treeHighlighter],cr;return lr instanceof HighlightStyle&&(lr.module&&ar.push(EditorView.styleModule.of(lr.module)),cr=lr.themeType),or!=null&&or.fallback?ar.push(fallbackHighlighter.of(lr)):cr?ar.push(highlighterFacet.computeN([EditorView.darkTheme],ur=>ur.facet(EditorView.darkTheme)==(cr=="dark")?[lr]:[])):ar.push(highlighterFacet.of(lr)),ar}class TreeHighlighter{constructor(or){this.markCache=Object.create(null),this.tree=syntaxTree(or.state),this.decorations=this.buildDeco(or,getHighlighters(or.state))}update(or){let ar=syntaxTree(or.state),cr=getHighlighters(or.state),ur=cr!=getHighlighters(or.startState);ar.length<or.view.viewport.to&&!ur&&ar.type==this.tree.type?this.decorations=this.decorations.map(or.changes):(ar!=this.tree||or.viewportChanged||ur)&&(this.tree=ar,this.decorations=this.buildDeco(or.view,cr))}buildDeco(or,ar){if(!ar||!this.tree.length)return Decoration.none;let cr=new RangeSetBuilder;for(let{from:ur,to:hr}of or.visibleRanges)highlightTree(this.tree,ar,(fr,dr,pr)=>{cr.add(fr,dr,this.markCache[pr]||(this.markCache[pr]=Decoration.mark({class:pr})))},ur,hr);return cr.finish()}}const treeHighlighter=Prec.high(ViewPlugin.fromClass(TreeHighlighter,{decorations:lr=>lr.decorations}));tags$1.meta,tags$1.link,tags$1.heading,tags$1.emphasis,tags$1.strong,tags$1.strikethrough,tags$1.keyword,tags$1.atom,tags$1.bool,tags$1.url,tags$1.contentSeparator,tags$1.labelName,tags$1.literal,tags$1.inserted,tags$1.string,tags$1.deleted,tags$1.regexp,tags$1.escape,tags$1.string,tags$1.variableName,tags$1.variableName,tags$1.typeName,tags$1.namespace,tags$1.className,tags$1.variableName,tags$1.macroName,tags$1.propertyName,tags$1.comment,tags$1.invalid;const DefaultScanDist=1e4,DefaultBrackets="()[]{}",bracketMatchingHandle=new NodeProp;function matchingNodes(lr,or,ar){let cr=lr.prop(or<0?NodeProp.openedBy:NodeProp.closedBy);if(cr)return cr;if(lr.name.length==1){let ur=ar.indexOf(lr.name);if(ur>-1&&ur%2==(or<0?1:0))return[ar[ur+or]]}return null}function findHandle(lr){let or=lr.type.prop(bracketMatchingHandle);return or?or(lr.node):lr}function matchBrackets(lr,or,ar,cr={}){let ur=cr.maxScanDistance||DefaultScanDist,hr=cr.brackets||DefaultBrackets,fr=syntaxTree(lr),dr=fr.resolveInner(or,ar);for(let pr=dr;pr;pr=pr.parent){let mr=matchingNodes(pr.type,ar,hr);if(mr&&pr.from<pr.to){let gr=findHandle(pr);if(gr&&(ar>0?or>=gr.from&&or<gr.to:or>gr.from&&or<=gr.to))return matchMarkedBrackets(lr,or,ar,pr,gr,mr,hr)}}return matchPlainBrackets(lr,or,ar,fr,dr.type,ur,hr)}function matchMarkedBrackets(lr,or,ar,cr,ur,hr,fr){let dr=cr.parent,pr={from:ur.from,to:ur.to},mr=0,gr=dr==null?void 0:dr.cursor();if(gr&&(ar<0?gr.childBefore(cr.from):gr.childAfter(cr.to)))do if(ar<0?gr.to<=cr.from:gr.from>=cr.to){if(mr==0&&hr.indexOf(gr.type.name)>-1&&gr.from<gr.to){let yr=findHandle(gr);return{start:pr,end:yr?{from:yr.from,to:yr.to}:void 0,matched:!0}}else if(matchingNodes(gr.type,ar,fr))mr++;else if(matchingNodes(gr.type,-ar,fr)){if(mr==0){let yr=findHandle(gr);return{start:pr,end:yr&&yr.from<yr.to?{from:yr.from,to:yr.to}:void 0,matched:!1}}mr--}}while(ar<0?gr.prevSibling():gr.nextSibling());return{start:pr,matched:!1}}function matchPlainBrackets(lr,or,ar,cr,ur,hr,fr){let dr=ar<0?lr.sliceDoc(or-1,or):lr.sliceDoc(or,or+1),pr=fr.indexOf(dr);if(pr<0||pr%2==0!=ar>0)return null;let mr={from:ar<0?or-1:or,to:ar>0?or+1:or},gr=lr.doc.iterRange(or,ar>0?lr.doc.length:0),yr=0;for(let br=0;!gr.next().done&&br<=hr;){let Or=gr.value;ar<0&&(br+=Or.length);let _r=or+br*ar;for(let vr=ar>0?0:Or.length-1,xr=ar>0?Or.length:-1;vr!=xr;vr+=ar){let wr=fr.indexOf(Or[vr]);if(!(wr<0||cr.resolveInner(_r+vr,1).type!=ur))if(wr%2==0==ar>0)yr++;else{if(yr==1)return{start:mr,end:{from:_r+vr,to:_r+vr+1},matched:wr>>1==pr>>1};yr--}}ar>0&&(br+=Or.length)}return gr.done?{start:mr,matched:!1}:null}const noTokens=Object.create(null),typeArray=[NodeType.none],warned=[],defaultTable=Object.create(null);for(let[lr,or]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])defaultTable[lr]=createTokenType(noTokens,or);function warnForPart(lr,or){warned.indexOf(lr)>-1||(warned.push(lr),console.warn(or))}function createTokenType(lr,or){let ar=null;for(let hr of or.split(".")){let fr=lr[hr]||tags$1[hr];fr?typeof fr=="function"?ar?ar=fr(ar):warnForPart(hr,`Modifier ${hr} used at start of tag`):ar?warnForPart(hr,`Tag ${hr} used as modifier`):ar=fr:warnForPart(hr,`Unknown highlighting tag ${hr}`)}if(!ar)return 0;let cr=or.replace(/ /g,"_"),ur=NodeType.define({id:typeArray.length,name:cr,props:[styleTags({[cr]:ar})]});return typeArray.push(ur),ur.id}const toggleComment=lr=>{let{state:or}=lr,ar=or.doc.lineAt(or.selection.main.from),cr=getConfig(lr.state,ar.from);return cr.line?toggleLineComment(lr):cr.block?toggleBlockCommentByLine(lr):!1};function command(lr,or){return({state:ar,dispatch:cr})=>{if(ar.readOnly)return!1;let ur=lr(or,ar);return ur?(cr(ar.update(ur)),!0):!1}}const toggleLineComment=command(changeLineComment,0),toggleBlockComment=command(changeBlockComment,0),toggleBlockCommentByLine=command((lr,or)=>changeBlockComment(lr,or,selectedLineRanges(or)),0);function getConfig(lr,or){let ar=lr.languageDataAt("commentTokens",or);return ar.length?ar[0]:{}}const SearchMargin=50;function findBlockComment(lr,{open:or,close:ar},cr,ur){let hr=lr.sliceDoc(cr-SearchMargin,cr),fr=lr.sliceDoc(ur,ur+SearchMargin),dr=/\s*$/.exec(hr)[0].length,pr=/^\s*/.exec(fr)[0].length,mr=hr.length-dr;if(hr.slice(mr-or.length,mr)==or&&fr.slice(pr,pr+ar.length)==ar)return{open:{pos:cr-dr,margin:dr&&1},close:{pos:ur+pr,margin:pr&&1}};let gr,yr;ur-cr<=2*SearchMargin?gr=yr=lr.sliceDoc(cr,ur):(gr=lr.sliceDoc(cr,cr+SearchMargin),yr=lr.sliceDoc(ur-SearchMargin,ur));let br=/^\s*/.exec(gr)[0].length,Or=/\s*$/.exec(yr)[0].length,_r=yr.length-Or-ar.length;return gr.slice(br,br+or.length)==or&&yr.slice(_r,_r+ar.length)==ar?{open:{pos:cr+br+or.length,margin:/\s/.test(gr.charAt(br+or.length))?1:0},close:{pos:ur-Or-ar.length,margin:/\s/.test(yr.charAt(_r-1))?1:0}}:null}function selectedLineRanges(lr){let or=[];for(let ar of lr.selection.ranges){let cr=lr.doc.lineAt(ar.from),ur=ar.to<=cr.to?cr:lr.doc.lineAt(ar.to),hr=or.length-1;hr>=0&&or[hr].to>cr.from?or[hr].to=ur.to:or.push({from:cr.from+/^\s*/.exec(cr.text)[0].length,to:ur.to})}return or}function changeBlockComment(lr,or,ar=or.selection.ranges){let cr=ar.map(hr=>getConfig(or,hr.from).block);if(!cr.every(hr=>hr))return null;let ur=ar.map((hr,fr)=>findBlockComment(or,cr[fr],hr.from,hr.to));if(lr!=2&&!ur.every(hr=>hr))return{changes:or.changes(ar.map((hr,fr)=>ur[fr]?[]:[{from:hr.from,insert:cr[fr].open+" "},{from:hr.to,insert:" "+cr[fr].close}]))};if(lr!=1&&ur.some(hr=>hr)){let hr=[];for(let fr=0,dr;fr<ur.length;fr++)if(dr=ur[fr]){let pr=cr[fr],{open:mr,close:gr}=dr;hr.push({from:mr.pos-pr.open.length,to:mr.pos+mr.margin},{from:gr.pos-gr.margin,to:gr.pos+pr.close.length})}return{changes:hr}}return null}function changeLineComment(lr,or,ar=or.selection.ranges){let cr=[],ur=-1;for(let{from:hr,to:fr}of ar){let dr=cr.length,pr=1e9,mr=getConfig(or,hr).line;if(mr){for(let gr=hr;gr<=fr;){let yr=or.doc.lineAt(gr);if(yr.from>ur&&(hr==fr||fr>yr.from)){ur=yr.from;let br=/^\s*/.exec(yr.text)[0].length,Or=br==yr.length,_r=yr.text.slice(br,br+mr.length)==mr?br:-1;br<yr.text.length&&br<pr&&(pr=br),cr.push({line:yr,comment:_r,token:mr,indent:br,empty:Or,single:!1})}gr=yr.to+1}if(pr<1e9)for(let gr=dr;gr<cr.length;gr++)cr[gr].indent<cr[gr].line.text.length&&(cr[gr].indent=pr);cr.length==dr+1&&(cr[dr].single=!0)}}if(lr!=2&&cr.some(hr=>hr.comment<0&&(!hr.empty||hr.single))){let hr=[];for(let{line:dr,token:pr,indent:mr,empty:gr,single:yr}of cr)(yr||!gr)&&hr.push({from:dr.from+mr,insert:pr+" "});let fr=or.changes(hr);return{changes:fr,selection:or.selection.map(fr,1)}}else if(lr!=1&&cr.some(hr=>hr.comment>=0)){let hr=[];for(let{line:fr,comment:dr,token:pr}of cr)if(dr>=0){let mr=fr.from+dr,gr=mr+pr.length;fr.text[gr-fr.from]==" "&&gr++,hr.push({from:mr,to:gr})}return{changes:hr}}return null}function updateSel(lr,or){return EditorSelection.create(lr.ranges.map(or),lr.mainIndex)}function setSel(lr,or){return lr.update({selection:or,scrollIntoView:!0,userEvent:"select"})}function moveSel({state:lr,dispatch:or},ar){let cr=updateSel(lr.selection,ar);return cr.eq(lr.selection)?!1:(or(setSel(lr,cr)),!0)}function rangeEnd(lr,or){return EditorSelection.cursor(or?lr.to:lr.from)}function cursorByChar(lr,or){return moveSel(lr,ar=>ar.empty?lr.moveByChar(ar,or):rangeEnd(ar,or))}function ltrAtCursor(lr){return lr.textDirectionAt(lr.state.selection.main.head)==Direction.LTR}const cursorCharLeft=lr=>cursorByChar(lr,!ltrAtCursor(lr)),cursorCharRight=lr=>cursorByChar(lr,ltrAtCursor(lr));function cursorByGroup(lr,or){return moveSel(lr,ar=>ar.empty?lr.moveByGroup(ar,or):rangeEnd(ar,or))}const cursorGroupLeft=lr=>cursorByGroup(lr,!ltrAtCursor(lr)),cursorGroupRight=lr=>cursorByGroup(lr,ltrAtCursor(lr));function interestingNode(lr,or,ar){if(or.type.prop(ar))return!0;let cr=or.to-or.from;return cr&&(cr>2||/[^\s,.;:]/.test(lr.sliceDoc(or.from,or.to)))||or.firstChild}function moveBySyntax(lr,or,ar){let cr=syntaxTree(lr).resolveInner(or.head),ur=ar?NodeProp.closedBy:NodeProp.openedBy;for(let pr=or.head;;){let mr=ar?cr.childAfter(pr):cr.childBefore(pr);if(!mr)break;interestingNode(lr,mr,ur)?cr=mr:pr=ar?mr.to:mr.from}let hr=cr.type.prop(ur),fr,dr;return hr&&(fr=ar?matchBrackets(lr,cr.from,1):matchBrackets(lr,cr.to,-1))&&fr.matched?dr=ar?fr.end.to:fr.end.from:dr=ar?cr.to:cr.from,EditorSelection.cursor(dr,ar?-1:1)}const cursorSyntaxLeft=lr=>moveSel(lr,or=>moveBySyntax(lr.state,or,!ltrAtCursor(lr))),cursorSyntaxRight=lr=>moveSel(lr,or=>moveBySyntax(lr.state,or,ltrAtCursor(lr)));function cursorByLine(lr,or){return moveSel(lr,ar=>{if(!ar.empty)return rangeEnd(ar,or);let cr=lr.moveVertically(ar,or);return cr.head!=ar.head?cr:lr.moveToLineBoundary(ar,or)})}const cursorLineUp=lr=>cursorByLine(lr,!1),cursorLineDown=lr=>cursorByLine(lr,!0);function pageInfo(lr){let or=lr.scrollDOM.clientHeight<lr.scrollDOM.scrollHeight-2,ar=0,cr=0,ur;if(or){for(let hr of lr.state.facet(EditorView.scrollMargins)){let fr=hr(lr);fr!=null&&fr.top&&(ar=Math.max(fr==null?void 0:fr.top,ar)),fr!=null&&fr.bottom&&(cr=Math.max(fr==null?void 0:fr.bottom,cr))}ur=lr.scrollDOM.clientHeight-ar-cr}else ur=(lr.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:ar,marginBottom:cr,selfScroll:or,height:Math.max(lr.defaultLineHeight,ur-5)}}function cursorByPage(lr,or){let ar=pageInfo(lr),{state:cr}=lr,ur=updateSel(cr.selection,fr=>fr.empty?lr.moveVertically(fr,or,ar.height):rangeEnd(fr,or));if(ur.eq(cr.selection))return!1;let hr;if(ar.selfScroll){let fr=lr.coordsAtPos(cr.selection.main.head),dr=lr.scrollDOM.getBoundingClientRect(),pr=dr.top+ar.marginTop,mr=dr.bottom-ar.marginBottom;fr&&fr.top>pr&&fr.bottom<mr&&(hr=EditorView.scrollIntoView(ur.main.head,{y:"start",yMargin:fr.top-pr}))}return lr.dispatch(setSel(cr,ur),{effects:hr}),!0}const cursorPageUp=lr=>cursorByPage(lr,!1),cursorPageDown=lr=>cursorByPage(lr,!0);function moveByLineBoundary(lr,or,ar){let cr=lr.lineBlockAt(or.head),ur=lr.moveToLineBoundary(or,ar);if(ur.head==or.head&&ur.head!=(ar?cr.to:cr.from)&&(ur=lr.moveToLineBoundary(or,ar,!1)),!ar&&ur.head==cr.from&&cr.length){let hr=/^\s*/.exec(lr.state.sliceDoc(cr.from,Math.min(cr.from+100,cr.to)))[0].length;hr&&or.head!=cr.from+hr&&(ur=EditorSelection.cursor(cr.from+hr))}return ur}const cursorLineBoundaryForward=lr=>moveSel(lr,or=>moveByLineBoundary(lr,or,!0)),cursorLineBoundaryBackward=lr=>moveSel(lr,or=>moveByLineBoundary(lr,or,!1)),cursorLineBoundaryLeft=lr=>moveSel(lr,or=>moveByLineBoundary(lr,or,!ltrAtCursor(lr))),cursorLineBoundaryRight=lr=>moveSel(lr,or=>moveByLineBoundary(lr,or,ltrAtCursor(lr))),cursorLineStart=lr=>moveSel(lr,or=>EditorSelection.cursor(lr.lineBlockAt(or.head).from,1)),cursorLineEnd=lr=>moveSel(lr,or=>EditorSelection.cursor(lr.lineBlockAt(or.head).to,-1));function toMatchingBracket(lr,or,ar){let cr=!1,ur=updateSel(lr.selection,hr=>{let fr=matchBrackets(lr,hr.head,-1)||matchBrackets(lr,hr.head,1)||hr.head>0&&matchBrackets(lr,hr.head-1,1)||hr.head<lr.doc.length&&matchBrackets(lr,hr.head+1,-1);if(!fr||!fr.end)return hr;cr=!0;let dr=fr.start.from==hr.head?fr.end.to:fr.end.from;return ar?EditorSelection.range(hr.anchor,dr):EditorSelection.cursor(dr)});return cr?(or(setSel(lr,ur)),!0):!1}const cursorMatchingBracket=({state:lr,dispatch:or})=>toMatchingBracket(lr,or,!1);function extendSel(lr,or){let ar=updateSel(lr.state.selection,cr=>{let ur=or(cr);return EditorSelection.range(cr.anchor,ur.head,ur.goalColumn,ur.bidiLevel||void 0)});return ar.eq(lr.state.selection)?!1:(lr.dispatch(setSel(lr.state,ar)),!0)}function selectByChar(lr,or){return extendSel(lr,ar=>lr.moveByChar(ar,or))}const selectCharLeft=lr=>selectByChar(lr,!ltrAtCursor(lr)),selectCharRight=lr=>selectByChar(lr,ltrAtCursor(lr));function selectByGroup(lr,or){return extendSel(lr,ar=>lr.moveByGroup(ar,or))}const selectGroupLeft=lr=>selectByGroup(lr,!ltrAtCursor(lr)),selectGroupRight=lr=>selectByGroup(lr,ltrAtCursor(lr)),selectSyntaxLeft=lr=>extendSel(lr,or=>moveBySyntax(lr.state,or,!ltrAtCursor(lr))),selectSyntaxRight=lr=>extendSel(lr,or=>moveBySyntax(lr.state,or,ltrAtCursor(lr)));function selectByLine(lr,or){return extendSel(lr,ar=>lr.moveVertically(ar,or))}const selectLineUp=lr=>selectByLine(lr,!1),selectLineDown=lr=>selectByLine(lr,!0);function selectByPage(lr,or){return extendSel(lr,ar=>lr.moveVertically(ar,or,pageInfo(lr).height))}const selectPageUp=lr=>selectByPage(lr,!1),selectPageDown=lr=>selectByPage(lr,!0),selectLineBoundaryForward=lr=>extendSel(lr,or=>moveByLineBoundary(lr,or,!0)),selectLineBoundaryBackward=lr=>extendSel(lr,or=>moveByLineBoundary(lr,or,!1)),selectLineBoundaryLeft=lr=>extendSel(lr,or=>moveByLineBoundary(lr,or,!ltrAtCursor(lr))),selectLineBoundaryRight=lr=>extendSel(lr,or=>moveByLineBoundary(lr,or,ltrAtCursor(lr))),selectLineStart=lr=>extendSel(lr,or=>EditorSelection.cursor(lr.lineBlockAt(or.head).from)),selectLineEnd=lr=>extendSel(lr,or=>EditorSelection.cursor(lr.lineBlockAt(or.head).to)),cursorDocStart=({state:lr,dispatch:or})=>(or(setSel(lr,{anchor:0})),!0),cursorDocEnd=({state:lr,dispatch:or})=>(or(setSel(lr,{anchor:lr.doc.length})),!0),selectDocStart=({state:lr,dispatch:or})=>(or(setSel(lr,{anchor:lr.selection.main.anchor,head:0})),!0),selectDocEnd=({state:lr,dispatch:or})=>(or(setSel(lr,{anchor:lr.selection.main.anchor,head:lr.doc.length})),!0),selectAll=({state:lr,dispatch:or})=>(or(lr.update({selection:{anchor:0,head:lr.doc.length},userEvent:"select"})),!0),selectLine=({state:lr,dispatch:or})=>{let ar=selectedLineBlocks(lr).map(({from:cr,to:ur})=>EditorSelection.range(cr,Math.min(ur+1,lr.doc.length)));return or(lr.update({selection:EditorSelection.create(ar),userEvent:"select"})),!0},selectParentSyntax=({state:lr,dispatch:or})=>{let ar=updateSel(lr.selection,cr=>{var ur;let hr=syntaxTree(lr).resolveInner(cr.head,1);for(;!(hr.from<cr.from&&hr.to>=cr.to||hr.to>cr.to&&hr.from<=cr.from||!(!((ur=hr.parent)===null||ur===void 0)&&ur.parent));)hr=hr.parent;return EditorSelection.range(hr.to,hr.from)});return or(setSel(lr,ar)),!0},simplifySelection=({state:lr,dispatch:or})=>{let ar=lr.selection,cr=null;return ar.ranges.length>1?cr=EditorSelection.create([ar.main]):ar.main.empty||(cr=EditorSelection.create([EditorSelection.cursor(ar.main.head)])),cr?(or(setSel(lr,cr)),!0):!1};function deleteBy(lr,or){if(lr.state.readOnly)return!1;let ar="delete.selection",{state:cr}=lr,ur=cr.changeByRange(hr=>{let{from:fr,to:dr}=hr;if(fr==dr){let pr=or(fr);pr<fr?(ar="delete.backward",pr=skipAtomic(lr,pr,!1)):pr>fr&&(ar="delete.forward",pr=skipAtomic(lr,pr,!0)),fr=Math.min(fr,pr),dr=Math.max(dr,pr)}else fr=skipAtomic(lr,fr,!1),dr=skipAtomic(lr,dr,!0);return fr==dr?{range:hr}:{changes:{from:fr,to:dr},range:EditorSelection.cursor(fr)}});return ur.changes.empty?!1:(lr.dispatch(cr.update(ur,{scrollIntoView:!0,userEvent:ar,effects:ar=="delete.selection"?EditorView.announce.of(cr.phrase("Selection deleted")):void 0})),!0)}function skipAtomic(lr,or,ar){if(lr instanceof EditorView)for(let cr of lr.state.facet(EditorView.atomicRanges).map(ur=>ur(lr)))cr.between(or,or,(ur,hr)=>{ur<or&&hr>or&&(or=ar?hr:ur)});return or}const deleteByChar=(lr,or)=>deleteBy(lr,ar=>{let{state:cr}=lr,ur=cr.doc.lineAt(ar),hr,fr;if(!or&&ar>ur.from&&ar<ur.from+200&&!/[^ \t]/.test(hr=ur.text.slice(0,ar-ur.from))){if(hr[hr.length-1]=="	")return ar-1;let dr=countColumn(hr,cr.tabSize),pr=dr%getIndentUnit(cr)||getIndentUnit(cr);for(let mr=0;mr<pr&&hr[hr.length-1-mr]==" ";mr++)ar--;fr=ar}else fr=findClusterBreak(ur.text,ar-ur.from,or,or)+ur.from,fr==ar&&ur.number!=(or?cr.doc.lines:1)&&(fr+=or?1:-1);return fr}),deleteCharBackward=lr=>deleteByChar(lr,!1),deleteCharForward=lr=>deleteByChar(lr,!0),deleteByGroup=(lr,or)=>deleteBy(lr,ar=>{let cr=ar,{state:ur}=lr,hr=ur.doc.lineAt(cr),fr=ur.charCategorizer(cr);for(let dr=null;;){if(cr==(or?hr.to:hr.from)){cr==ar&&hr.number!=(or?ur.doc.lines:1)&&(cr+=or?1:-1);break}let pr=findClusterBreak(hr.text,cr-hr.from,or)+hr.from,mr=hr.text.slice(Math.min(cr,pr)-hr.from,Math.max(cr,pr)-hr.from),gr=fr(mr);if(dr!=null&&gr!=dr)break;(mr!=" "||cr!=ar)&&(dr=gr),cr=pr}return cr}),deleteGroupBackward=lr=>deleteByGroup(lr,!1),deleteGroupForward=lr=>deleteByGroup(lr,!0),deleteToLineEnd=lr=>deleteBy(lr,or=>{let ar=lr.lineBlockAt(or).to;return or<ar?ar:Math.min(lr.state.doc.length,or+1)}),deleteToLineStart=lr=>deleteBy(lr,or=>{let ar=lr.lineBlockAt(or).from;return or>ar?ar:Math.max(0,or-1)}),splitLine=({state:lr,dispatch:or})=>{if(lr.readOnly)return!1;let ar=lr.changeByRange(cr=>({changes:{from:cr.from,to:cr.to,insert:Text$2.of(["",""])},range:EditorSelection.cursor(cr.from)}));return or(lr.update(ar,{scrollIntoView:!0,userEvent:"input"})),!0},transposeChars=({state:lr,dispatch:or})=>{if(lr.readOnly)return!1;let ar=lr.changeByRange(cr=>{if(!cr.empty||cr.from==0||cr.from==lr.doc.length)return{range:cr};let ur=cr.from,hr=lr.doc.lineAt(ur),fr=ur==hr.from?ur-1:findClusterBreak(hr.text,ur-hr.from,!1)+hr.from,dr=ur==hr.to?ur+1:findClusterBreak(hr.text,ur-hr.from,!0)+hr.from;return{changes:{from:fr,to:dr,insert:lr.doc.slice(ur,dr).append(lr.doc.slice(fr,ur))},range:EditorSelection.cursor(dr)}});return ar.changes.empty?!1:(or(lr.update(ar,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function selectedLineBlocks(lr){let or=[],ar=-1;for(let cr of lr.selection.ranges){let ur=lr.doc.lineAt(cr.from),hr=lr.doc.lineAt(cr.to);if(!cr.empty&&cr.to==hr.from&&(hr=lr.doc.lineAt(cr.to-1)),ar>=ur.number){let fr=or[or.length-1];fr.to=hr.to,fr.ranges.push(cr)}else or.push({from:ur.from,to:hr.to,ranges:[cr]});ar=hr.number+1}return or}function moveLine(lr,or,ar){if(lr.readOnly)return!1;let cr=[],ur=[];for(let hr of selectedLineBlocks(lr)){if(ar?hr.to==lr.doc.length:hr.from==0)continue;let fr=lr.doc.lineAt(ar?hr.to+1:hr.from-1),dr=fr.length+1;if(ar){cr.push({from:hr.to,to:fr.to},{from:hr.from,insert:fr.text+lr.lineBreak});for(let pr of hr.ranges)ur.push(EditorSelection.range(Math.min(lr.doc.length,pr.anchor+dr),Math.min(lr.doc.length,pr.head+dr)))}else{cr.push({from:fr.from,to:hr.from},{from:hr.to,insert:lr.lineBreak+fr.text});for(let pr of hr.ranges)ur.push(EditorSelection.range(pr.anchor-dr,pr.head-dr))}}return cr.length?(or(lr.update({changes:cr,scrollIntoView:!0,selection:EditorSelection.create(ur,lr.selection.mainIndex),userEvent:"move.line"})),!0):!1}const moveLineUp=({state:lr,dispatch:or})=>moveLine(lr,or,!1),moveLineDown=({state:lr,dispatch:or})=>moveLine(lr,or,!0);function copyLine(lr,or,ar){if(lr.readOnly)return!1;let cr=[];for(let ur of selectedLineBlocks(lr))ar?cr.push({from:ur.from,insert:lr.doc.slice(ur.from,ur.to)+lr.lineBreak}):cr.push({from:ur.to,insert:lr.lineBreak+lr.doc.slice(ur.from,ur.to)});return or(lr.update({changes:cr,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const copyLineUp=({state:lr,dispatch:or})=>copyLine(lr,or,!1),copyLineDown=({state:lr,dispatch:or})=>copyLine(lr,or,!0),deleteLine=lr=>{if(lr.state.readOnly)return!1;let{state:or}=lr,ar=or.changes(selectedLineBlocks(or).map(({from:ur,to:hr})=>(ur>0?ur--:hr<or.doc.length&&hr++,{from:ur,to:hr}))),cr=updateSel(or.selection,ur=>lr.moveVertically(ur,!0)).map(ar);return lr.dispatch({changes:ar,selection:cr,scrollIntoView:!0,userEvent:"delete.line"}),!0};function isBetweenBrackets(lr,or){if(/\(\)|\[\]|\{\}/.test(lr.sliceDoc(or-1,or+1)))return{from:or,to:or};let ar=syntaxTree(lr).resolveInner(or),cr=ar.childBefore(or),ur=ar.childAfter(or),hr;return cr&&ur&&cr.to<=or&&ur.from>=or&&(hr=cr.type.prop(NodeProp.closedBy))&&hr.indexOf(ur.name)>-1&&lr.doc.lineAt(cr.to).from==lr.doc.lineAt(ur.from).from&&!/\S/.test(lr.sliceDoc(cr.to,ur.from))?{from:cr.to,to:ur.from}:null}const insertNewlineAndIndent=newlineAndIndent(!1),insertBlankLine=newlineAndIndent(!0);function newlineAndIndent(lr){return({state:or,dispatch:ar})=>{if(or.readOnly)return!1;let cr=or.changeByRange(ur=>{let{from:hr,to:fr}=ur,dr=or.doc.lineAt(hr),pr=!lr&&hr==fr&&isBetweenBrackets(or,hr);lr&&(hr=fr=(fr<=dr.to?dr:or.doc.lineAt(fr)).to);let mr=new IndentContext(or,{simulateBreak:hr,simulateDoubleBreak:!!pr}),gr=getIndentation(mr,hr);for(gr==null&&(gr=countColumn(/^\s*/.exec(or.doc.lineAt(hr).text)[0],or.tabSize));fr<dr.to&&/\s/.test(dr.text[fr-dr.from]);)fr++;pr?{from:hr,to:fr}=pr:hr>dr.from&&hr<dr.from+100&&!/\S/.test(dr.text.slice(0,hr))&&(hr=dr.from);let yr=["",indentString(or,gr)];return pr&&yr.push(indentString(or,mr.lineIndent(dr.from,-1))),{changes:{from:hr,to:fr,insert:Text$2.of(yr)},range:EditorSelection.cursor(hr+1+yr[1].length)}});return ar(or.update(cr,{scrollIntoView:!0,userEvent:"input"})),!0}}function changeBySelectedLine(lr,or){let ar=-1;return lr.changeByRange(cr=>{let ur=[];for(let fr=cr.from;fr<=cr.to;){let dr=lr.doc.lineAt(fr);dr.number>ar&&(cr.empty||cr.to>dr.from)&&(or(dr,ur,cr),ar=dr.number),fr=dr.to+1}let hr=lr.changes(ur);return{changes:ur,range:EditorSelection.range(hr.mapPos(cr.anchor,1),hr.mapPos(cr.head,1))}})}const indentSelection=({state:lr,dispatch:or})=>{if(lr.readOnly)return!1;let ar=Object.create(null),cr=new IndentContext(lr,{overrideIndentation:hr=>{let fr=ar[hr];return fr??-1}}),ur=changeBySelectedLine(lr,(hr,fr,dr)=>{let pr=getIndentation(cr,hr.from);if(pr==null)return;/\S/.test(hr.text)||(pr=0);let mr=/^\s*/.exec(hr.text)[0],gr=indentString(lr,pr);(mr!=gr||dr.from<hr.from+mr.length)&&(ar[hr.from]=pr,fr.push({from:hr.from,to:hr.from+mr.length,insert:gr}))});return ur.changes.empty||or(lr.update(ur,{userEvent:"indent"})),!0},indentMore=({state:lr,dispatch:or})=>lr.readOnly?!1:(or(lr.update(changeBySelectedLine(lr,(ar,cr)=>{cr.push({from:ar.from,insert:lr.facet(indentUnit)})}),{userEvent:"input.indent"})),!0),indentLess=({state:lr,dispatch:or})=>lr.readOnly?!1:(or(lr.update(changeBySelectedLine(lr,(ar,cr)=>{let ur=/^\s*/.exec(ar.text)[0];if(!ur)return;let hr=countColumn(ur,lr.tabSize),fr=0,dr=indentString(lr,Math.max(0,hr-getIndentUnit(lr)));for(;fr<ur.length&&fr<dr.length&&ur.charCodeAt(fr)==dr.charCodeAt(fr);)fr++;cr.push({from:ar.from+fr,to:ar.from+ur.length,insert:dr.slice(fr)})}),{userEvent:"delete.dedent"})),!0),emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}],standardKeymap=[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryLeft,shift:selectLineBoundaryLeft,preventDefault:!0},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight,preventDefault:!0},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryRight,shift:selectLineBoundaryRight,preventDefault:!0},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:!0},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:!0},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteToLineStart},{mac:"Mod-Delete",run:deleteToLineEnd}].concat(emacsStyleKeymap.map(lr=>({mac:lr.key,run:lr.run,shift:lr.shift}))),defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment}].concat(standardKeymap),indentWithTab={key:"Tab",run:indentMore,shift:indentLess};function crelt(){var lr=arguments[0];typeof lr=="string"&&(lr=document.createElement(lr));var or=1,ar=arguments[1];if(ar&&typeof ar=="object"&&ar.nodeType==null&&!Array.isArray(ar)){for(var cr in ar)if(Object.prototype.hasOwnProperty.call(ar,cr)){var ur=ar[cr];typeof ur=="string"?lr.setAttribute(cr,ur):ur!=null&&(lr[cr]=ur)}or++}for(;or<arguments.length;or++)add(lr,arguments[or]);return lr}function add(lr,or){if(typeof or=="string")lr.appendChild(document.createTextNode(or));else if(or!=null)if(or.nodeType!=null)lr.appendChild(or);else if(Array.isArray(or))for(var ar=0;ar<or.length;ar++)add(lr,or[ar]);else throw new RangeError("Unsupported child node: "+or)}const basicNormalize=typeof String.prototype.normalize=="function"?lr=>lr.normalize("NFKD"):lr=>lr;class SearchCursor{constructor(or,ar,cr=0,ur=or.length,hr,fr){this.test=fr,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=or.iterRange(cr,ur),this.bufferStart=cr,this.normalize=hr?dr=>hr(basicNormalize(dr)):basicNormalize,this.query=this.normalize(ar)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let or=this.peek();if(or<0)return this.done=!0,this;let ar=fromCodePoint(or),cr=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(or);let ur=this.normalize(ar);for(let hr=0,fr=cr;;hr++){let dr=ur.charCodeAt(hr),pr=this.match(dr,fr);if(hr==ur.length-1){if(pr)return this.value=pr,this;break}fr==cr&&hr<ar.length&&ar.charCodeAt(hr)==dr&&fr++}}}match(or,ar){let cr=null;for(let ur=0;ur<this.matches.length;ur+=2){let hr=this.matches[ur],fr=!1;this.query.charCodeAt(hr)==or&&(hr==this.query.length-1?cr={from:this.matches[ur+1],to:ar+1}:(this.matches[ur]++,fr=!0)),fr||(this.matches.splice(ur,2),ur-=2)}return this.query.charCodeAt(0)==or&&(this.query.length==1?cr={from:ar,to:ar+1}:this.matches.push(1,ar)),cr&&this.test&&!this.test(cr.from,cr.to,this.buffer,this.bufferPos)&&(cr=null),cr}}typeof Symbol<"u"&&(SearchCursor.prototype[Symbol.iterator]=function(){return this});const empty={from:-1,to:-1,match:/.*/.exec("")},baseFlags="gm"+(/x/.unicode==null?"":"u");class RegExpCursor{constructor(or,ar,cr,ur=0,hr=or.length){if(this.text=or,this.to=hr,this.curLine="",this.done=!1,this.value=empty,/\\[sWDnr]|\n|\r|\[\^/.test(ar))return new MultilineRegExpCursor(or,ar,cr,ur,hr);this.re=new RegExp(ar,baseFlags+(cr!=null&&cr.ignoreCase?"i":"")),this.test=cr==null?void 0:cr.test,this.iter=or.iter();let fr=or.lineAt(ur);this.curLineStart=fr.from,this.matchPos=toCharEnd(or,ur),this.getLine(this.curLineStart)}getLine(or){this.iter.next(or),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let or=this.matchPos-this.curLineStart;;){this.re.lastIndex=or;let ar=this.matchPos<=this.to&&this.re.exec(this.curLine);if(ar){let cr=this.curLineStart+ar.index,ur=cr+ar[0].length;if(this.matchPos=toCharEnd(this.text,ur+(cr==ur?1:0)),cr==this.curLineStart+this.curLine.length&&this.nextLine(),(cr<ur||cr>this.value.to)&&(!this.test||this.test(cr,ur,ar)))return this.value={from:cr,to:ur,match:ar},this;or=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),or=0;else return this.done=!0,this}}}const flattened=new WeakMap;class FlattenedDoc{constructor(or,ar){this.from=or,this.text=ar}get to(){return this.from+this.text.length}static get(or,ar,cr){let ur=flattened.get(or);if(!ur||ur.from>=cr||ur.to<=ar){let dr=new FlattenedDoc(ar,or.sliceString(ar,cr));return flattened.set(or,dr),dr}if(ur.from==ar&&ur.to==cr)return ur;let{text:hr,from:fr}=ur;return fr>ar&&(hr=or.sliceString(ar,fr)+hr,fr=ar),ur.to<cr&&(hr+=or.sliceString(ur.to,cr)),flattened.set(or,new FlattenedDoc(fr,hr)),new FlattenedDoc(ar,hr.slice(ar-fr,cr-fr))}}class MultilineRegExpCursor{constructor(or,ar,cr,ur,hr){this.text=or,this.to=hr,this.done=!1,this.value=empty,this.matchPos=toCharEnd(or,ur),this.re=new RegExp(ar,baseFlags+(cr!=null&&cr.ignoreCase?"i":"")),this.test=cr==null?void 0:cr.test,this.flat=FlattenedDoc.get(or,ur,this.chunkEnd(ur+5e3))}chunkEnd(or){return or>=this.to?this.to:this.text.lineAt(or).to}next(){for(;;){let or=this.re.lastIndex=this.matchPos-this.flat.from,ar=this.re.exec(this.flat.text);if(ar&&!ar[0]&&ar.index==or&&(this.re.lastIndex=or+1,ar=this.re.exec(this.flat.text)),ar){let cr=this.flat.from+ar.index,ur=cr+ar[0].length;if((this.flat.to>=this.to||ar.index+ar[0].length<=this.flat.text.length-10)&&(!this.test||this.test(cr,ur,ar)))return this.value={from:cr,to:ur,match:ar},this.matchPos=toCharEnd(this.text,ur+(cr==ur?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this});function validRegExp(lr){try{return new RegExp(lr,baseFlags),!0}catch{return!1}}function toCharEnd(lr,or){if(or>=lr.length)return or;let ar=lr.lineAt(or),cr;for(;or<ar.to&&(cr=ar.text.charCodeAt(or-ar.from))>=56320&&cr<57344;)or++;return or}function createLineDialog(lr){let or=crelt("input",{class:"cm-textfield",name:"line"}),ar=crelt("form",{class:"cm-gotoLine",onkeydown:ur=>{ur.keyCode==27?(ur.preventDefault(),lr.dispatch({effects:dialogEffect.of(!1)}),lr.focus()):ur.keyCode==13&&(ur.preventDefault(),cr())},onsubmit:ur=>{ur.preventDefault(),cr()}},crelt("label",lr.state.phrase("Go to line"),": ",or)," ",crelt("button",{class:"cm-button",type:"submit"},lr.state.phrase("go")));function cr(){let ur=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(or.value);if(!ur)return;let{state:hr}=lr,fr=hr.doc.lineAt(hr.selection.main.head),[,dr,pr,mr,gr]=ur,yr=mr?+mr.slice(1):0,br=pr?+pr:fr.number;if(pr&&gr){let vr=br/100;dr&&(vr=vr*(dr=="-"?-1:1)+fr.number/hr.doc.lines),br=Math.round(hr.doc.lines*vr)}else pr&&dr&&(br=br*(dr=="-"?-1:1)+fr.number);let Or=hr.doc.line(Math.max(1,Math.min(hr.doc.lines,br))),_r=EditorSelection.cursor(Or.from+Math.max(0,Math.min(yr,Or.length)));lr.dispatch({effects:[dialogEffect.of(!1),EditorView.scrollIntoView(_r.from,{y:"center"})],selection:_r}),lr.focus()}return{dom:ar}}const dialogEffect=StateEffect.define(),dialogField=StateField.define({create(){return!0},update(lr,or){for(let ar of or.effects)ar.is(dialogEffect)&&(lr=ar.value);return lr},provide:lr=>showPanel.from(lr,or=>or?createLineDialog:null)}),gotoLine=lr=>{let or=getPanel(lr,createLineDialog);if(!or){let ar=[dialogEffect.of(!0)];lr.state.field(dialogField,!1)==null&&ar.push(StateEffect.appendConfig.of([dialogField,baseTheme$1])),lr.dispatch({effects:ar}),or=getPanel(lr,createLineDialog)}return or&&or.dom.querySelector("input").focus(),!0},baseTheme$1=EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),selectWord=({state:lr,dispatch:or})=>{let{selection:ar}=lr,cr=EditorSelection.create(ar.ranges.map(ur=>lr.wordAt(ur.head)||EditorSelection.cursor(ur.head)),ar.mainIndex);return cr.eq(ar)?!1:(or(lr.update({selection:cr})),!0)};function findNextOccurrence(lr,or){let{main:ar,ranges:cr}=lr.selection,ur=lr.wordAt(ar.head),hr=ur&&ur.from==ar.from&&ur.to==ar.to;for(let fr=!1,dr=new SearchCursor(lr.doc,or,cr[cr.length-1].to);;)if(dr.next(),dr.done){if(fr)return null;dr=new SearchCursor(lr.doc,or,0,Math.max(0,cr[cr.length-1].from-1)),fr=!0}else{if(fr&&cr.some(pr=>pr.from==dr.value.from))continue;if(hr){let pr=lr.wordAt(dr.value.from);if(!pr||pr.from!=dr.value.from||pr.to!=dr.value.to)continue}return dr.value}}const selectNextOccurrence=({state:lr,dispatch:or})=>{let{ranges:ar}=lr.selection;if(ar.some(hr=>hr.from===hr.to))return selectWord({state:lr,dispatch:or});let cr=lr.sliceDoc(ar[0].from,ar[0].to);if(lr.selection.ranges.some(hr=>lr.sliceDoc(hr.from,hr.to)!=cr))return!1;let ur=findNextOccurrence(lr,cr);return ur?(or(lr.update({selection:lr.selection.addRange(EditorSelection.range(ur.from,ur.to),!1),effects:EditorView.scrollIntoView(ur.to)})),!0):!1},searchConfigFacet=Facet.define({combine(lr){return combineConfig(lr,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:or=>new SearchPanel(or),scrollToMatch:or=>EditorView.scrollIntoView(or)})}});function search(lr){return lr?[searchConfigFacet.of(lr),searchExtensions]:searchExtensions}class SearchQuery{constructor(or){this.search=or.search,this.caseSensitive=!!or.caseSensitive,this.literal=!!or.literal,this.regexp=!!or.regexp,this.replace=or.replace||"",this.valid=!!this.search&&(!this.regexp||validRegExp(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!or.wholeWord}unquote(or){return this.literal?or:or.replace(/\\([nrt\\])/g,(ar,cr)=>cr=="n"?`
`:cr=="r"?"\r":cr=="t"?"	":"\\")}eq(or){return this.search==or.search&&this.replace==or.replace&&this.caseSensitive==or.caseSensitive&&this.regexp==or.regexp&&this.wholeWord==or.wholeWord}create(){return this.regexp?new RegExpQuery(this):new StringQuery(this)}getCursor(or,ar=0,cr){let ur=or.doc?or:EditorState.create({doc:or});return cr==null&&(cr=ur.doc.length),this.regexp?regexpCursor(this,ur,ar,cr):stringCursor(this,ur,ar,cr)}}class QueryType{constructor(or){this.spec=or}}function stringCursor(lr,or,ar,cr){return new SearchCursor(or.doc,lr.unquoted,ar,cr,lr.caseSensitive?void 0:ur=>ur.toLowerCase(),lr.wholeWord?stringWordTest(or.doc,or.charCategorizer(or.selection.main.head)):void 0)}function stringWordTest(lr,or){return(ar,cr,ur,hr)=>((hr>ar||hr+ur.length<cr)&&(hr=Math.max(0,ar-2),ur=lr.sliceString(hr,Math.min(lr.length,cr+2))),(or(charBefore(ur,ar-hr))!=CharCategory.Word||or(charAfter(ur,ar-hr))!=CharCategory.Word)&&(or(charAfter(ur,cr-hr))!=CharCategory.Word||or(charBefore(ur,cr-hr))!=CharCategory.Word))}class StringQuery extends QueryType{constructor(or){super(or)}nextMatch(or,ar,cr){let ur=stringCursor(this.spec,or,cr,or.doc.length).nextOverlapping();return ur.done&&(ur=stringCursor(this.spec,or,0,ar).nextOverlapping()),ur.done?null:ur.value}prevMatchInRange(or,ar,cr){for(let ur=cr;;){let hr=Math.max(ar,ur-1e4-this.spec.unquoted.length),fr=stringCursor(this.spec,or,hr,ur),dr=null;for(;!fr.nextOverlapping().done;)dr=fr.value;if(dr)return dr;if(hr==ar)return null;ur-=1e4}}prevMatch(or,ar,cr){return this.prevMatchInRange(or,0,ar)||this.prevMatchInRange(or,cr,or.doc.length)}getReplacement(or){return this.spec.unquote(this.spec.replace)}matchAll(or,ar){let cr=stringCursor(this.spec,or,0,or.doc.length),ur=[];for(;!cr.next().done;){if(ur.length>=ar)return null;ur.push(cr.value)}return ur}highlight(or,ar,cr,ur){let hr=stringCursor(this.spec,or,Math.max(0,ar-this.spec.unquoted.length),Math.min(cr+this.spec.unquoted.length,or.doc.length));for(;!hr.next().done;)ur(hr.value.from,hr.value.to)}}function regexpCursor(lr,or,ar,cr){return new RegExpCursor(or.doc,lr.search,{ignoreCase:!lr.caseSensitive,test:lr.wholeWord?regexpWordTest(or.charCategorizer(or.selection.main.head)):void 0},ar,cr)}function charBefore(lr,or){return lr.slice(findClusterBreak(lr,or,!1),or)}function charAfter(lr,or){return lr.slice(or,findClusterBreak(lr,or))}function regexpWordTest(lr){return(or,ar,cr)=>!cr[0].length||(lr(charBefore(cr.input,cr.index))!=CharCategory.Word||lr(charAfter(cr.input,cr.index))!=CharCategory.Word)&&(lr(charAfter(cr.input,cr.index+cr[0].length))!=CharCategory.Word||lr(charBefore(cr.input,cr.index+cr[0].length))!=CharCategory.Word)}class RegExpQuery extends QueryType{nextMatch(or,ar,cr){let ur=regexpCursor(this.spec,or,cr,or.doc.length).next();return ur.done&&(ur=regexpCursor(this.spec,or,0,ar).next()),ur.done?null:ur.value}prevMatchInRange(or,ar,cr){for(let ur=1;;ur++){let hr=Math.max(ar,cr-ur*1e4),fr=regexpCursor(this.spec,or,hr,cr),dr=null;for(;!fr.next().done;)dr=fr.value;if(dr&&(hr==ar||dr.from>hr+10))return dr;if(hr==ar)return null}}prevMatch(or,ar,cr){return this.prevMatchInRange(or,0,ar)||this.prevMatchInRange(or,cr,or.doc.length)}getReplacement(or){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(ar,cr)=>cr=="$"?"$":cr=="&"?or.match[0]:cr!="0"&&+cr<or.match.length?or.match[cr]:ar))}matchAll(or,ar){let cr=regexpCursor(this.spec,or,0,or.doc.length),ur=[];for(;!cr.next().done;){if(ur.length>=ar)return null;ur.push(cr.value)}return ur}highlight(or,ar,cr,ur){let hr=regexpCursor(this.spec,or,Math.max(0,ar-250),Math.min(cr+250,or.doc.length));for(;!hr.next().done;)ur(hr.value.from,hr.value.to)}}const setSearchQuery=StateEffect.define(),togglePanel=StateEffect.define(),searchState=StateField.define({create(lr){return new SearchState(defaultQuery(lr).create(),null)},update(lr,or){for(let ar of or.effects)ar.is(setSearchQuery)?lr=new SearchState(ar.value.create(),lr.panel):ar.is(togglePanel)&&(lr=new SearchState(lr.query,ar.value?createSearchPanel:null));return lr},provide:lr=>showPanel.from(lr,or=>or.panel)});class SearchState{constructor(or,ar){this.query=or,this.panel=ar}}const matchMark=Decoration.mark({class:"cm-searchMatch"}),selectedMatchMark=Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),searchHighlighter=ViewPlugin.fromClass(class{constructor(lr){this.view=lr,this.decorations=this.highlight(lr.state.field(searchState))}update(lr){let or=lr.state.field(searchState);(or!=lr.startState.field(searchState)||lr.docChanged||lr.selectionSet||lr.viewportChanged)&&(this.decorations=this.highlight(or))}highlight({query:lr,panel:or}){if(!or||!lr.spec.valid)return Decoration.none;let{view:ar}=this,cr=new RangeSetBuilder;for(let ur=0,hr=ar.visibleRanges,fr=hr.length;ur<fr;ur++){let{from:dr,to:pr}=hr[ur];for(;ur<fr-1&&pr>hr[ur+1].from-2*250;)pr=hr[++ur].to;lr.highlight(ar.state,dr,pr,(mr,gr)=>{let yr=ar.state.selection.ranges.some(br=>br.from==mr&&br.to==gr);cr.add(mr,gr,yr?selectedMatchMark:matchMark)})}return cr.finish()}},{decorations:lr=>lr.decorations});function searchCommand(lr){return or=>{let ar=or.state.field(searchState,!1);return ar&&ar.query.spec.valid?lr(or,ar):openSearchPanel(or)}}const findNext=searchCommand((lr,{query:or})=>{let{to:ar}=lr.state.selection.main,cr=or.nextMatch(lr.state,ar,ar);if(!cr)return!1;let ur=EditorSelection.single(cr.from,cr.to),hr=lr.state.facet(searchConfigFacet);return lr.dispatch({selection:ur,effects:[announceMatch(lr,cr),hr.scrollToMatch(ur.main,lr)],userEvent:"select.search"}),selectSearchInput(lr),!0}),findPrevious=searchCommand((lr,{query:or})=>{let{state:ar}=lr,{from:cr}=ar.selection.main,ur=or.prevMatch(ar,cr,cr);if(!ur)return!1;let hr=EditorSelection.single(ur.from,ur.to),fr=lr.state.facet(searchConfigFacet);return lr.dispatch({selection:hr,effects:[announceMatch(lr,ur),fr.scrollToMatch(hr.main,lr)],userEvent:"select.search"}),selectSearchInput(lr),!0}),selectMatches=searchCommand((lr,{query:or})=>{let ar=or.matchAll(lr.state,1e3);return!ar||!ar.length?!1:(lr.dispatch({selection:EditorSelection.create(ar.map(cr=>EditorSelection.range(cr.from,cr.to))),userEvent:"select.search.matches"}),!0)}),selectSelectionMatches=({state:lr,dispatch:or})=>{let ar=lr.selection;if(ar.ranges.length>1||ar.main.empty)return!1;let{from:cr,to:ur}=ar.main,hr=[],fr=0;for(let dr=new SearchCursor(lr.doc,lr.sliceDoc(cr,ur));!dr.next().done;){if(hr.length>1e3)return!1;dr.value.from==cr&&(fr=hr.length),hr.push(EditorSelection.range(dr.value.from,dr.value.to))}return or(lr.update({selection:EditorSelection.create(hr,fr),userEvent:"select.search.matches"})),!0},replaceNext=searchCommand((lr,{query:or})=>{let{state:ar}=lr,{from:cr,to:ur}=ar.selection.main;if(ar.readOnly)return!1;let hr=or.nextMatch(ar,cr,cr);if(!hr)return!1;let fr=[],dr,pr,mr=[];if(hr.from==cr&&hr.to==ur&&(pr=ar.toText(or.getReplacement(hr)),fr.push({from:hr.from,to:hr.to,insert:pr}),hr=or.nextMatch(ar,hr.from,hr.to),mr.push(EditorView.announce.of(ar.phrase("replaced match on line $",ar.doc.lineAt(cr).number)+"."))),hr){let gr=fr.length==0||fr[0].from>=hr.to?0:hr.to-hr.from-pr.length;dr=EditorSelection.single(hr.from-gr,hr.to-gr),mr.push(announceMatch(lr,hr)),mr.push(ar.facet(searchConfigFacet).scrollToMatch(dr.main,lr))}return lr.dispatch({changes:fr,selection:dr,effects:mr,userEvent:"input.replace"}),!0}),replaceAll=searchCommand((lr,{query:or})=>{if(lr.state.readOnly)return!1;let ar=or.matchAll(lr.state,1e9).map(ur=>{let{from:hr,to:fr}=ur;return{from:hr,to:fr,insert:or.getReplacement(ur)}});if(!ar.length)return!1;let cr=lr.state.phrase("replaced $ matches",ar.length)+".";return lr.dispatch({changes:ar,effects:EditorView.announce.of(cr),userEvent:"input.replace.all"}),!0});function createSearchPanel(lr){return lr.state.facet(searchConfigFacet).createPanel(lr)}function defaultQuery(lr,or){var ar,cr,ur,hr,fr;let dr=lr.selection.main,pr=dr.empty||dr.to>dr.from+100?"":lr.sliceDoc(dr.from,dr.to);if(or&&!pr)return or;let mr=lr.facet(searchConfigFacet);return new SearchQuery({search:((ar=or==null?void 0:or.literal)!==null&&ar!==void 0?ar:mr.literal)?pr:pr.replace(/\n/g,"\\n"),caseSensitive:(cr=or==null?void 0:or.caseSensitive)!==null&&cr!==void 0?cr:mr.caseSensitive,literal:(ur=or==null?void 0:or.literal)!==null&&ur!==void 0?ur:mr.literal,regexp:(hr=or==null?void 0:or.regexp)!==null&&hr!==void 0?hr:mr.regexp,wholeWord:(fr=or==null?void 0:or.wholeWord)!==null&&fr!==void 0?fr:mr.wholeWord})}function getSearchInput(lr){let or=getPanel(lr,createSearchPanel);return or&&or.dom.querySelector("[main-field]")}function selectSearchInput(lr){let or=getSearchInput(lr);or&&or==lr.root.activeElement&&or.select()}const openSearchPanel=lr=>{let or=lr.state.field(searchState,!1);if(or&&or.panel){let ar=getSearchInput(lr);if(ar&&ar!=lr.root.activeElement){let cr=defaultQuery(lr.state,or.query.spec);cr.valid&&lr.dispatch({effects:setSearchQuery.of(cr)}),ar.focus(),ar.select()}}else lr.dispatch({effects:[togglePanel.of(!0),or?setSearchQuery.of(defaultQuery(lr.state,or.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});return!0},closeSearchPanel=lr=>{let or=lr.state.field(searchState,!1);if(!or||!or.panel)return!1;let ar=getPanel(lr,createSearchPanel);return ar&&ar.dom.contains(lr.root.activeElement)&&lr.focus(),lr.dispatch({effects:togglePanel.of(!1)}),!0},searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0}];class SearchPanel{constructor(or){this.view=or;let ar=this.query=or.state.field(searchState).query.spec;this.commit=this.commit.bind(this),this.searchField=crelt("input",{value:ar.search,placeholder:phrase(or,"Find"),"aria-label":phrase(or,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=crelt("input",{value:ar.replace,placeholder:phrase(or,"Replace"),"aria-label":phrase(or,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=crelt("input",{type:"checkbox",name:"case",form:"",checked:ar.caseSensitive,onchange:this.commit}),this.reField=crelt("input",{type:"checkbox",name:"re",form:"",checked:ar.regexp,onchange:this.commit}),this.wordField=crelt("input",{type:"checkbox",name:"word",form:"",checked:ar.wholeWord,onchange:this.commit});function cr(ur,hr,fr){return crelt("button",{class:"cm-button",name:ur,onclick:hr,type:"button"},fr)}this.dom=crelt("div",{onkeydown:ur=>this.keydown(ur),class:"cm-search"},[this.searchField,cr("next",()=>findNext(or),[phrase(or,"next")]),cr("prev",()=>findPrevious(or),[phrase(or,"previous")]),cr("select",()=>selectMatches(or),[phrase(or,"all")]),crelt("label",null,[this.caseField,phrase(or,"match case")]),crelt("label",null,[this.reField,phrase(or,"regexp")]),crelt("label",null,[this.wordField,phrase(or,"by word")]),...or.state.readOnly?[]:[crelt("br"),this.replaceField,cr("replace",()=>replaceNext(or),[phrase(or,"replace")]),cr("replaceAll",()=>replaceAll(or),[phrase(or,"replace all")])],crelt("button",{name:"close",onclick:()=>closeSearchPanel(or),"aria-label":phrase(or,"close"),type:"button"},["×"])])}commit(){let or=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});or.eq(this.query)||(this.query=or,this.view.dispatch({effects:setSearchQuery.of(or)}))}keydown(or){runScopeHandlers(this.view,or,"search-panel")?or.preventDefault():or.keyCode==13&&or.target==this.searchField?(or.preventDefault(),(or.shiftKey?findPrevious:findNext)(this.view)):or.keyCode==13&&or.target==this.replaceField&&(or.preventDefault(),replaceNext(this.view))}update(or){for(let ar of or.transactions)for(let cr of ar.effects)cr.is(setSearchQuery)&&!cr.value.eq(this.query)&&this.setQuery(cr.value)}setQuery(or){this.query=or,this.searchField.value=or.search,this.replaceField.value=or.replace,this.caseField.checked=or.caseSensitive,this.reField.checked=or.regexp,this.wordField.checked=or.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(searchConfigFacet).top}}function phrase(lr,or){return lr.state.phrase(or)}const AnnounceMargin=30,Break=/[\s\.,:;?!]/;function announceMatch(lr,{from:or,to:ar}){let cr=lr.state.doc.lineAt(or),ur=lr.state.doc.lineAt(ar).to,hr=Math.max(cr.from,or-AnnounceMargin),fr=Math.min(ur,ar+AnnounceMargin),dr=lr.state.sliceDoc(hr,fr);if(hr!=cr.from){for(let pr=0;pr<AnnounceMargin;pr++)if(!Break.test(dr[pr+1])&&Break.test(dr[pr])){dr=dr.slice(pr);break}}if(fr!=ur){for(let pr=dr.length-1;pr>dr.length-AnnounceMargin;pr--)if(!Break.test(dr[pr-1])&&Break.test(dr[pr])){dr=dr.slice(0,pr);break}}return EditorView.announce.of(`${lr.state.phrase("current match")}. ${dr} ${lr.state.phrase("on line")} ${cr.number}.`)}const baseTheme$2=EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),searchExtensions=[searchState,Prec.low(searchHighlighter),baseTheme$2];class CompletionContext{constructor(or,ar,cr){this.state=or,this.pos=ar,this.explicit=cr,this.abortListeners=[]}tokenBefore(or){let ar=syntaxTree(this.state).resolveInner(this.pos,-1);for(;ar&&or.indexOf(ar.name)<0;)ar=ar.parent;return ar?{from:ar.from,to:this.pos,text:this.state.sliceDoc(ar.from,this.pos),type:ar.type}:null}matchBefore(or){let ar=this.state.doc.lineAt(this.pos),cr=Math.max(ar.from,this.pos-250),ur=ar.text.slice(cr-ar.from,this.pos-ar.from),hr=ur.search(ensureAnchor(or,!1));return hr<0?null:{from:cr+hr,to:this.pos,text:ur.slice(hr)}}get aborted(){return this.abortListeners==null}addEventListener(or,ar){or=="abort"&&this.abortListeners&&this.abortListeners.push(ar)}}function toSet(lr){let or=Object.keys(lr).join(""),ar=/\w/.test(or);return ar&&(or=or.replace(/\w/g,"")),`[${ar?"\\w":""}${or.replace(/[^\w\s]/g,"\\$&")}]`}function prefixMatch(lr){let or=Object.create(null),ar=Object.create(null);for(let{label:ur}of lr){or[ur[0]]=!0;for(let hr=1;hr<ur.length;hr++)ar[ur[hr]]=!0}let cr=toSet(or)+toSet(ar)+"*$";return[new RegExp("^"+cr),new RegExp(cr)]}function completeFromList(lr){let or=lr.map(ur=>typeof ur=="string"?{label:ur}:ur),[ar,cr]=or.every(ur=>/^\w+$/.test(ur.label))?[/\w*$/,/\w+$/]:prefixMatch(or);return ur=>{let hr=ur.matchBefore(cr);return hr||ur.explicit?{from:hr?hr.from:ur.pos,options:or,validFor:ar}:null}}function ifNotIn(lr,or){return ar=>{for(let cr=syntaxTree(ar.state).resolveInner(ar.pos,-1);cr;cr=cr.parent){if(lr.indexOf(cr.name)>-1)return null;if(cr.type.isTop)break}return or(ar)}}function ensureAnchor(lr,or){var ar;let{source:cr}=lr,ur=or&&cr[0]!="^",hr=cr[cr.length-1]!="$";return!ur&&!hr?lr:new RegExp(`${ur?"^":""}(?:${cr})${hr?"$":""}`,(ar=lr.flags)!==null&&ar!==void 0?ar:lr.ignoreCase?"i":"")}const pickedCompletion=Annotation.define(),baseTheme=EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class FieldPos{constructor(or,ar,cr,ur){this.field=or,this.line=ar,this.from=cr,this.to=ur}}class FieldRange{constructor(or,ar,cr){this.field=or,this.from=ar,this.to=cr}map(or){let ar=or.mapPos(this.from,-1,MapMode.TrackDel),cr=or.mapPos(this.to,1,MapMode.TrackDel);return ar==null||cr==null?null:new FieldRange(this.field,ar,cr)}}class Snippet{constructor(or,ar){this.lines=or,this.fieldPositions=ar}instantiate(or,ar){let cr=[],ur=[ar],hr=or.doc.lineAt(ar),fr=/^\s*/.exec(hr.text)[0];for(let pr of this.lines){if(cr.length){let mr=fr,gr=/^\t*/.exec(pr)[0].length;for(let yr=0;yr<gr;yr++)mr+=or.facet(indentUnit);ur.push(ar+mr.length-gr),pr=mr+pr.slice(gr)}cr.push(pr),ar+=pr.length+1}let dr=this.fieldPositions.map(pr=>new FieldRange(pr.field,ur[pr.line]+pr.from,ur[pr.line]+pr.to));return{text:cr,ranges:dr}}static parse(or){let ar=[],cr=[],ur=[],hr;for(let fr of or.split(/\r\n?|\n/)){for(;hr=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(fr);){let dr=hr[1]?+hr[1]:null,pr=hr[2]||hr[3]||"",mr=-1;for(let gr=0;gr<ar.length;gr++)(dr!=null?ar[gr].seq==dr:pr&&ar[gr].name==pr)&&(mr=gr);if(mr<0){let gr=0;for(;gr<ar.length&&(dr==null||ar[gr].seq!=null&&ar[gr].seq<dr);)gr++;ar.splice(gr,0,{seq:dr,name:pr}),mr=gr;for(let yr of ur)yr.field>=mr&&yr.field++}ur.push(new FieldPos(mr,cr.length,hr.index,hr.index+pr.length)),fr=fr.slice(0,hr.index)+pr+fr.slice(hr.index+hr[0].length)}for(let dr;dr=/\\([{}])/.exec(fr);){fr=fr.slice(0,dr.index)+dr[1]+fr.slice(dr.index+dr[0].length);for(let pr of ur)pr.line==cr.length&&pr.from>dr.index&&(pr.from--,pr.to--)}cr.push(fr)}return new Snippet(cr,ur)}}let fieldMarker=Decoration.widget({widget:new class extends WidgetType{toDOM(){let lr=document.createElement("span");return lr.className="cm-snippetFieldPosition",lr}ignoreEvent(){return!1}}}),fieldRange=Decoration.mark({class:"cm-snippetField"});class ActiveSnippet{constructor(or,ar){this.ranges=or,this.active=ar,this.deco=Decoration.set(or.map(cr=>(cr.from==cr.to?fieldMarker:fieldRange).range(cr.from,cr.to)))}map(or){let ar=[];for(let cr of this.ranges){let ur=cr.map(or);if(!ur)return null;ar.push(ur)}return new ActiveSnippet(ar,this.active)}selectionInsideField(or){return or.ranges.every(ar=>this.ranges.some(cr=>cr.field==this.active&&cr.from<=ar.from&&cr.to>=ar.to))}}const setActive=StateEffect.define({map(lr,or){return lr&&lr.map(or)}}),moveToField=StateEffect.define(),snippetState=StateField.define({create(){return null},update(lr,or){for(let ar of or.effects){if(ar.is(setActive))return ar.value;if(ar.is(moveToField)&&lr)return new ActiveSnippet(lr.ranges,ar.value)}return lr&&or.docChanged&&(lr=lr.map(or.changes)),lr&&or.selection&&!lr.selectionInsideField(or.selection)&&(lr=null),lr},provide:lr=>EditorView.decorations.from(lr,or=>or?or.deco:Decoration.none)});function fieldSelection(lr,or){return EditorSelection.create(lr.filter(ar=>ar.field==or).map(ar=>EditorSelection.range(ar.from,ar.to)))}function snippet(lr){let or=Snippet.parse(lr);return(ar,cr,ur,hr)=>{let{text:fr,ranges:dr}=or.instantiate(ar.state,ur),pr={changes:{from:ur,to:hr,insert:Text$2.of(fr)},scrollIntoView:!0,annotations:cr?pickedCompletion.of(cr):void 0};if(dr.length&&(pr.selection=fieldSelection(dr,0)),dr.length>1){let mr=new ActiveSnippet(dr,0),gr=pr.effects=[setActive.of(mr)];ar.state.field(snippetState,!1)===void 0&&gr.push(StateEffect.appendConfig.of([snippetState,addSnippetKeymap,snippetPointerHandler,baseTheme]))}ar.dispatch(ar.state.update(pr))}}function moveField(lr){return({state:or,dispatch:ar})=>{let cr=or.field(snippetState,!1);if(!cr||lr<0&&cr.active==0)return!1;let ur=cr.active+lr,hr=lr>0&&!cr.ranges.some(fr=>fr.field==ur+lr);return ar(or.update({selection:fieldSelection(cr.ranges,ur),effects:setActive.of(hr?null:new ActiveSnippet(cr.ranges,ur))})),!0}}const clearSnippet=({state:lr,dispatch:or})=>lr.field(snippetState,!1)?(or(lr.update({effects:setActive.of(null)})),!0):!1,nextSnippetField=moveField(1),prevSnippetField=moveField(-1),defaultSnippetKeymap=[{key:"Tab",run:nextSnippetField,shift:prevSnippetField},{key:"Escape",run:clearSnippet}],snippetKeymap=Facet.define({combine(lr){return lr.length?lr[0]:defaultSnippetKeymap}}),addSnippetKeymap=Prec.highest(keymap.compute([snippetKeymap],lr=>lr.facet(snippetKeymap)));function snippetCompletion(lr,or){return Object.assign(Object.assign({},or),{apply:snippet(lr)})}const snippetPointerHandler=EditorView.domEventHandlers({mousedown(lr,or){let ar=or.state.field(snippetState,!1),cr;if(!ar||(cr=or.posAtCoords({x:lr.clientX,y:lr.clientY}))==null)return!1;let ur=ar.ranges.find(hr=>hr.from<=cr&&hr.to>=cr);return!ur||ur.field==ar.active?!1:(or.dispatch({selection:fieldSelection(ar.ranges,ur.field),effects:setActive.of(ar.ranges.some(hr=>hr.field>ur.field)?new ActiveSnippet(ar.ranges,ur.field):null)}),!0)}}),closedBracket=new class extends RangeValue{};closedBracket.startSide=1;closedBracket.endSide=-1;class CompositeBlock{static create(or,ar,cr,ur,hr){let fr=ur+(ur<<8)+or+(ar<<4)|0;return new CompositeBlock(or,ar,cr,fr,hr,[],[])}constructor(or,ar,cr,ur,hr,fr,dr){this.type=or,this.value=ar,this.from=cr,this.hash=ur,this.end=hr,this.children=fr,this.positions=dr,this.hashProp=[[NodeProp.contextHash,ur]]}addChild(or,ar){or.prop(NodeProp.contextHash)!=this.hash&&(or=new Tree$1(or.type,or.children,or.positions,or.length,this.hashProp)),this.children.push(or),this.positions.push(ar)}toTree(or,ar=this.end){let cr=this.children.length-1;return cr>=0&&(ar=Math.max(ar,this.positions[cr]+this.children[cr].length+this.from)),new Tree$1(or.types[this.type],this.children,this.positions,ar-this.from).balance({makeTree:(ur,hr,fr)=>new Tree$1(NodeType.none,ur,hr,fr,this.hashProp)})}}var Type$1;(function(lr){lr[lr.Document=1]="Document",lr[lr.CodeBlock=2]="CodeBlock",lr[lr.FencedCode=3]="FencedCode",lr[lr.Blockquote=4]="Blockquote",lr[lr.HorizontalRule=5]="HorizontalRule",lr[lr.BulletList=6]="BulletList",lr[lr.OrderedList=7]="OrderedList",lr[lr.ListItem=8]="ListItem",lr[lr.ATXHeading1=9]="ATXHeading1",lr[lr.ATXHeading2=10]="ATXHeading2",lr[lr.ATXHeading3=11]="ATXHeading3",lr[lr.ATXHeading4=12]="ATXHeading4",lr[lr.ATXHeading5=13]="ATXHeading5",lr[lr.ATXHeading6=14]="ATXHeading6",lr[lr.SetextHeading1=15]="SetextHeading1",lr[lr.SetextHeading2=16]="SetextHeading2",lr[lr.HTMLBlock=17]="HTMLBlock",lr[lr.LinkReference=18]="LinkReference",lr[lr.Paragraph=19]="Paragraph",lr[lr.CommentBlock=20]="CommentBlock",lr[lr.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",lr[lr.Escape=22]="Escape",lr[lr.Entity=23]="Entity",lr[lr.HardBreak=24]="HardBreak",lr[lr.Emphasis=25]="Emphasis",lr[lr.StrongEmphasis=26]="StrongEmphasis",lr[lr.Link=27]="Link",lr[lr.Image=28]="Image",lr[lr.InlineCode=29]="InlineCode",lr[lr.HTMLTag=30]="HTMLTag",lr[lr.Comment=31]="Comment",lr[lr.ProcessingInstruction=32]="ProcessingInstruction",lr[lr.URL=33]="URL",lr[lr.HeaderMark=34]="HeaderMark",lr[lr.QuoteMark=35]="QuoteMark",lr[lr.ListMark=36]="ListMark",lr[lr.LinkMark=37]="LinkMark",lr[lr.EmphasisMark=38]="EmphasisMark",lr[lr.CodeMark=39]="CodeMark",lr[lr.CodeText=40]="CodeText",lr[lr.CodeInfo=41]="CodeInfo",lr[lr.LinkTitle=42]="LinkTitle",lr[lr.LinkLabel=43]="LinkLabel"})(Type$1||(Type$1={}));class LeafBlock{constructor(or,ar){this.start=or,this.content=ar,this.marks=[],this.parsers=[]}}let Line$1=class{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let or=this.skipSpace(this.basePos);this.indent=this.countIndent(or,this.pos,this.indent),this.pos=or,this.next=or==this.text.length?-1:this.text.charCodeAt(or)}skipSpace(or){return skipSpace(this.text,or)}reset(or){for(this.text=or,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(or){this.basePos=or,this.baseIndent=this.countIndent(or,this.pos,this.indent)}moveBaseColumn(or){this.baseIndent=or,this.basePos=this.findColumn(or)}addMarker(or){this.markers.push(or)}countIndent(or,ar=0,cr=0){for(let ur=ar;ur<or;ur++)cr+=this.text.charCodeAt(ur)==9?4-cr%4:1;return cr}findColumn(or){let ar=0;for(let cr=0;ar<this.text.length&&cr<or;ar++)cr+=this.text.charCodeAt(ar)==9?4-cr%4:1;return ar}scrub(){if(!this.baseIndent)return this.text;let or="";for(let ar=0;ar<this.basePos;ar++)or+=" ";return or+this.text.slice(this.basePos)}};function skipForList(lr,or,ar){if(ar.pos==ar.text.length||lr!=or.block&&ar.indent>=or.stack[ar.depth+1].value+ar.baseIndent)return!0;if(ar.indent>=ar.baseIndent+4)return!1;let cr=(lr.type==Type$1.OrderedList?isOrderedList:isBulletList)(ar,or,!1);return cr>0&&(lr.type!=Type$1.BulletList||isHorizontalRule(ar,or,!1)<0)&&ar.text.charCodeAt(ar.pos+cr-1)==lr.value}const DefaultSkipMarkup={[Type$1.Blockquote](lr,or,ar){return ar.next!=62?!1:(ar.markers.push(elt(Type$1.QuoteMark,or.lineStart+ar.pos,or.lineStart+ar.pos+1)),ar.moveBase(ar.pos+(space$2(ar.text.charCodeAt(ar.pos+1))?2:1)),lr.end=or.lineStart+ar.text.length,!0)},[Type$1.ListItem](lr,or,ar){return ar.indent<ar.baseIndent+lr.value&&ar.next>-1?!1:(ar.moveBaseColumn(ar.baseIndent+lr.value),!0)},[Type$1.OrderedList]:skipForList,[Type$1.BulletList]:skipForList,[Type$1.Document](){return!0}};function space$2(lr){return lr==32||lr==9||lr==10||lr==13}function skipSpace(lr,or=0){for(;or<lr.length&&space$2(lr.charCodeAt(or));)or++;return or}function skipSpaceBack(lr,or,ar){for(;or>ar&&space$2(lr.charCodeAt(or-1));)or--;return or}function isFencedCode(lr){if(lr.next!=96&&lr.next!=126)return-1;let or=lr.pos+1;for(;or<lr.text.length&&lr.text.charCodeAt(or)==lr.next;)or++;if(or<lr.pos+3)return-1;if(lr.next==96){for(let ar=or;ar<lr.text.length;ar++)if(lr.text.charCodeAt(ar)==96)return-1}return or}function isBlockquote(lr){return lr.next!=62?-1:lr.text.charCodeAt(lr.pos+1)==32?2:1}function isHorizontalRule(lr,or,ar){if(lr.next!=42&&lr.next!=45&&lr.next!=95)return-1;let cr=1;for(let ur=lr.pos+1;ur<lr.text.length;ur++){let hr=lr.text.charCodeAt(ur);if(hr==lr.next)cr++;else if(!space$2(hr))return-1}return ar&&lr.next==45&&isSetextUnderline(lr)>-1&&lr.depth==or.stack.length||cr<3?-1:1}function inList(lr,or){for(let ar=lr.stack.length-1;ar>=0;ar--)if(lr.stack[ar].type==or)return!0;return!1}function isBulletList(lr,or,ar){return(lr.next==45||lr.next==43||lr.next==42)&&(lr.pos==lr.text.length-1||space$2(lr.text.charCodeAt(lr.pos+1)))&&(!ar||inList(or,Type$1.BulletList)||lr.skipSpace(lr.pos+2)<lr.text.length)?1:-1}function isOrderedList(lr,or,ar){let cr=lr.pos,ur=lr.next;for(;ur>=48&&ur<=57;){cr++;if(cr==lr.text.length)return-1;ur=lr.text.charCodeAt(cr)}return cr==lr.pos||cr>lr.pos+9||ur!=46&&ur!=41||cr<lr.text.length-1&&!space$2(lr.text.charCodeAt(cr+1))||ar&&!inList(or,Type$1.OrderedList)&&(lr.skipSpace(cr+1)==lr.text.length||cr>lr.pos+1||lr.next!=49)?-1:cr+1-lr.pos}function isAtxHeading(lr){if(lr.next!=35)return-1;let or=lr.pos+1;for(;or<lr.text.length&&lr.text.charCodeAt(or)==35;)or++;if(or<lr.text.length&&lr.text.charCodeAt(or)!=32)return-1;let ar=or-lr.pos;return ar>6?-1:ar}function isSetextUnderline(lr){if(lr.next!=45&&lr.next!=61||lr.indent>=lr.baseIndent+4)return-1;let or=lr.pos+1;for(;or<lr.text.length&&lr.text.charCodeAt(or)==lr.next;)or++;let ar=or;for(;or<lr.text.length&&space$2(lr.text.charCodeAt(or));)or++;return or==lr.text.length?ar:-1}const EmptyLine=/^[ \t]*$/,CommentEnd=/-->/,ProcessingEnd=/\?>/,HTMLBlockStyle=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,CommentEnd],[/^\s*<\?/,ProcessingEnd],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,EmptyLine],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,EmptyLine]];function isHTMLBlock(lr,or,ar){if(lr.next!=60)return-1;let cr=lr.text.slice(lr.pos);for(let ur=0,hr=HTMLBlockStyle.length-(ar?1:0);ur<hr;ur++)if(HTMLBlockStyle[ur][0].test(cr))return ur;return-1}function getListIndent(lr,or){let ar=lr.countIndent(or,lr.pos,lr.indent),cr=lr.countIndent(lr.skipSpace(or),or,ar);return cr>=ar+5?ar+1:cr}function addCodeText(lr,or,ar){let cr=lr.length-1;cr>=0&&lr[cr].to==or&&lr[cr].type==Type$1.CodeText?lr[cr].to=ar:lr.push(elt(Type$1.CodeText,or,ar))}const DefaultBlockParsers={LinkReference:void 0,IndentedCode(lr,or){let ar=or.baseIndent+4;if(or.indent<ar)return!1;let cr=or.findColumn(ar),ur=lr.lineStart+cr,hr=lr.lineStart+or.text.length,fr=[],dr=[];for(addCodeText(fr,ur,hr);lr.nextLine()&&or.depth>=lr.stack.length;)if(or.pos==or.text.length){addCodeText(dr,lr.lineStart-1,lr.lineStart);for(let pr of or.markers)dr.push(pr)}else{if(or.indent<ar)break;{if(dr.length){for(let mr of dr)mr.type==Type$1.CodeText?addCodeText(fr,mr.from,mr.to):fr.push(mr);dr=[]}addCodeText(fr,lr.lineStart-1,lr.lineStart);for(let mr of or.markers)fr.push(mr);hr=lr.lineStart+or.text.length;let pr=lr.lineStart+or.findColumn(or.baseIndent+4);pr<hr&&addCodeText(fr,pr,hr)}}return dr.length&&(dr=dr.filter(pr=>pr.type!=Type$1.CodeText),dr.length&&(or.markers=dr.concat(or.markers))),lr.addNode(lr.buffer.writeElements(fr,-ur).finish(Type$1.CodeBlock,hr-ur),ur),!0},FencedCode(lr,or){let ar=isFencedCode(or);if(ar<0)return!1;let cr=lr.lineStart+or.pos,ur=or.next,hr=ar-or.pos,fr=or.skipSpace(ar),dr=skipSpaceBack(or.text,or.text.length,fr),pr=[elt(Type$1.CodeMark,cr,cr+hr)];fr<dr&&pr.push(elt(Type$1.CodeInfo,lr.lineStart+fr,lr.lineStart+dr));for(let mr=!0;lr.nextLine()&&or.depth>=lr.stack.length;mr=!1){let gr=or.pos;if(or.indent-or.baseIndent<4)for(;gr<or.text.length&&or.text.charCodeAt(gr)==ur;)gr++;if(gr-or.pos>=hr&&or.skipSpace(gr)==or.text.length){for(let yr of or.markers)pr.push(yr);pr.push(elt(Type$1.CodeMark,lr.lineStart+or.pos,lr.lineStart+gr)),lr.nextLine();break}else{mr||addCodeText(pr,lr.lineStart-1,lr.lineStart);for(let Or of or.markers)pr.push(Or);let yr=lr.lineStart+or.basePos,br=lr.lineStart+or.text.length;yr<br&&addCodeText(pr,yr,br)}}return lr.addNode(lr.buffer.writeElements(pr,-cr).finish(Type$1.FencedCode,lr.prevLineEnd()-cr),cr),!0},Blockquote(lr,or){let ar=isBlockquote(or);return ar<0?!1:(lr.startContext(Type$1.Blockquote,or.pos),lr.addNode(Type$1.QuoteMark,lr.lineStart+or.pos,lr.lineStart+or.pos+1),or.moveBase(or.pos+ar),null)},HorizontalRule(lr,or){if(isHorizontalRule(or,lr,!1)<0)return!1;let ar=lr.lineStart+or.pos;return lr.nextLine(),lr.addNode(Type$1.HorizontalRule,ar),!0},BulletList(lr,or){let ar=isBulletList(or,lr,!1);if(ar<0)return!1;lr.block.type!=Type$1.BulletList&&lr.startContext(Type$1.BulletList,or.basePos,or.next);let cr=getListIndent(or,or.pos+1);return lr.startContext(Type$1.ListItem,or.basePos,cr-or.baseIndent),lr.addNode(Type$1.ListMark,lr.lineStart+or.pos,lr.lineStart+or.pos+ar),or.moveBaseColumn(cr),null},OrderedList(lr,or){let ar=isOrderedList(or,lr,!1);if(ar<0)return!1;lr.block.type!=Type$1.OrderedList&&lr.startContext(Type$1.OrderedList,or.basePos,or.text.charCodeAt(or.pos+ar-1));let cr=getListIndent(or,or.pos+ar);return lr.startContext(Type$1.ListItem,or.basePos,cr-or.baseIndent),lr.addNode(Type$1.ListMark,lr.lineStart+or.pos,lr.lineStart+or.pos+ar),or.moveBaseColumn(cr),null},ATXHeading(lr,or){let ar=isAtxHeading(or);if(ar<0)return!1;let cr=or.pos,ur=lr.lineStart+cr,hr=skipSpaceBack(or.text,or.text.length,cr),fr=hr;for(;fr>cr&&or.text.charCodeAt(fr-1)==or.next;)fr--;(fr==hr||fr==cr||!space$2(or.text.charCodeAt(fr-1)))&&(fr=or.text.length);let dr=lr.buffer.write(Type$1.HeaderMark,0,ar).writeElements(lr.parser.parseInline(or.text.slice(cr+ar+1,fr),ur+ar+1),-ur);fr<or.text.length&&dr.write(Type$1.HeaderMark,fr-cr,hr-cr);let pr=dr.finish(Type$1.ATXHeading1-1+ar,or.text.length-cr);return lr.nextLine(),lr.addNode(pr,ur),!0},HTMLBlock(lr,or){let ar=isHTMLBlock(or,lr,!1);if(ar<0)return!1;let cr=lr.lineStart+or.pos,ur=HTMLBlockStyle[ar][1],hr=[],fr=ur!=EmptyLine;for(;!ur.test(or.text)&&lr.nextLine();){if(or.depth<lr.stack.length){fr=!1;break}for(let mr of or.markers)hr.push(mr)}fr&&lr.nextLine();let dr=ur==CommentEnd?Type$1.CommentBlock:ur==ProcessingEnd?Type$1.ProcessingInstructionBlock:Type$1.HTMLBlock,pr=lr.prevLineEnd();return lr.addNode(lr.buffer.writeElements(hr,-cr).finish(dr,pr-cr),cr),!0},SetextHeading:void 0};class LinkReferenceParser{constructor(or){this.stage=0,this.elts=[],this.pos=0,this.start=or.start,this.advance(or.content)}nextLine(or,ar,cr){if(this.stage==-1)return!1;let ur=cr.content+`
`+ar.scrub(),hr=this.advance(ur);return hr>-1&&hr<ur.length?this.complete(or,cr,hr):!1}finish(or,ar){return(this.stage==2||this.stage==3)&&skipSpace(ar.content,this.pos)==ar.content.length?this.complete(or,ar,ar.content.length):!1}complete(or,ar,cr){return or.addLeafElement(ar,elt(Type$1.LinkReference,this.start,this.start+cr,this.elts)),!0}nextStage(or){return or?(this.pos=or.to-this.start,this.elts.push(or),this.stage++,!0):(or===!1&&(this.stage=-1),!1)}advance(or){for(;;){if(this.stage==-1)return-1;if(this.stage==0){if(!this.nextStage(parseLinkLabel(or,this.pos,this.start,!0)))return-1;if(or.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(elt(Type$1.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else if(this.stage==1){if(!this.nextStage(parseURL(or,skipSpace(or,this.pos),this.start)))return-1}else if(this.stage==2){let ar=skipSpace(or,this.pos),cr=0;if(ar>this.pos){let ur=parseLinkTitle(or,ar,this.start);if(ur){let hr=lineEnd(or,ur.to-this.start);hr>0&&(this.nextStage(ur),cr=hr)}}return cr||(cr=lineEnd(or,this.pos)),cr>0&&cr<or.length?cr:-1}else return lineEnd(or,this.pos)}}}function lineEnd(lr,or){for(;or<lr.length;or++){let ar=lr.charCodeAt(or);if(ar==10)break;if(!space$2(ar))return-1}return or}class SetextHeadingParser{nextLine(or,ar,cr){let ur=ar.depth<or.stack.length?-1:isSetextUnderline(ar),hr=ar.next;if(ur<0)return!1;let fr=elt(Type$1.HeaderMark,or.lineStart+ar.pos,or.lineStart+ur);return or.nextLine(),or.addLeafElement(cr,elt(hr==61?Type$1.SetextHeading1:Type$1.SetextHeading2,cr.start,or.prevLineEnd(),[...or.parser.parseInline(cr.content,cr.start),fr])),!0}finish(){return!1}}const DefaultLeafBlocks={LinkReference(lr,or){return or.content.charCodeAt(0)==91?new LinkReferenceParser(or):null},SetextHeading(){return new SetextHeadingParser}},DefaultEndLeaf=[(lr,or)=>isAtxHeading(or)>=0,(lr,or)=>isFencedCode(or)>=0,(lr,or)=>isBlockquote(or)>=0,(lr,or)=>isBulletList(or,lr,!0)>=0,(lr,or)=>isOrderedList(or,lr,!0)>=0,(lr,or)=>isHorizontalRule(or,lr,!0)>=0,(lr,or)=>isHTMLBlock(or,lr,!0)>=0],scanLineResult={text:"",end:0};class BlockContext{constructor(or,ar,cr,ur){this.parser=or,this.input=ar,this.ranges=ur,this.line=new Line$1,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=ur[ur.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=ur[0].from,this.block=CompositeBlock.create(Type$1.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=cr.length?new FragmentCursor$1(cr,ar):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:or}=this;for(;;){for(;or.depth<this.stack.length;)this.finishContext();for(let cr of or.markers)this.addNode(cr.type,cr.from,cr.to);if(or.pos<or.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(or.basePos))return null;e:for(;;){for(let cr of this.parser.blockParsers)if(cr){let ur=cr(this,or);if(ur!=!1){if(ur==!0)return null;or.forward();continue e}}break}let ar=new LeafBlock(this.lineStart+or.pos,or.text.slice(or.pos));for(let cr of this.parser.leafBlockParsers)if(cr){let ur=cr(this,ar);ur&&ar.parsers.push(ur)}e:for(;this.nextLine()&&or.pos!=or.text.length;){if(or.indent<or.baseIndent+4){for(let cr of this.parser.endLeafBlock)if(cr(this,or,ar))break e}for(let cr of ar.parsers)if(cr.nextLine(this,or,ar))return null;ar.content+=`
`+or.scrub();for(let cr of or.markers)ar.marks.push(cr)}return this.finishLeaf(ar),null}stopAt(or){if(this.stoppedAt!=null&&this.stoppedAt<or)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=or}reuseFragment(or){if(!this.fragments.moveTo(this.absoluteLineStart+or,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let ar=this.fragments.takeNodes(this);return ar?(this.absoluteLineStart+=ar,this.lineStart=toRelative(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0):!1}get depth(){return this.stack.length}parentType(or=this.depth-1){return this.parser.nodeSet.types[this.stack[or].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(or){let ar=scanLineResult;if(ar.end=or,or>=this.to)ar.text="";else if(ar.text=this.lineChunkAt(or),ar.end+=ar.text.length,this.ranges.length>1){let cr=this.absoluteLineStart,ur=this.rangeI;for(;this.ranges[ur].to<ar.end;){ur++;let hr=this.ranges[ur].from,fr=this.lineChunkAt(hr);ar.end=hr+fr.length,ar.text=ar.text.slice(0,this.ranges[ur-1].to-cr)+fr,cr=ar.end-ar.text.length}}return ar}readLine(){let{line:or}=this,{text:ar,end:cr}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=cr,or.reset(ar);or.depth<this.stack.length;or.depth++){let ur=this.stack[or.depth],hr=this.parser.skipContextMarkup[ur.type];if(!hr)throw new Error("Unhandled block context "+Type$1[ur.type]);if(!hr(ur,this,or))break;or.forward()}}lineChunkAt(or){let ar=this.input.chunk(or),cr;if(this.input.lineChunks)cr=ar==`
`?"":ar;else{let ur=ar.indexOf(`
`);cr=ur<0?ar:ar.slice(0,ur)}return or+cr.length>this.to?cr.slice(0,this.to-or):cr}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(or,ar,cr=0){this.block=CompositeBlock.create(or,cr,this.lineStart+ar,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(or,ar,cr=0){this.startContext(this.parser.getNodeType(or),ar,cr)}addNode(or,ar,cr){typeof or=="number"&&(or=new Tree$1(this.parser.nodeSet.types[or],none$1,none$1,(cr??this.prevLineEnd())-ar)),this.block.addChild(or,ar-this.block.from)}addElement(or){this.block.addChild(or.toTree(this.parser.nodeSet),or.from-this.block.from)}addLeafElement(or,ar){this.addNode(this.buffer.writeElements(injectMarks(ar.children,or.marks),-ar.from).finish(ar.type,ar.to-ar.from),ar.from)}finishContext(){let or=this.stack.pop(),ar=this.stack[this.stack.length-1];ar.addChild(or.toTree(this.parser.nodeSet),or.from-ar.from),this.block=ar}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(or){return this.ranges.length>1?injectGaps(this.ranges,0,or.topNode,this.ranges[0].from,this.reusePlaceholders):or}finishLeaf(or){for(let cr of or.parsers)if(cr.finish(this,or))return;let ar=injectMarks(this.parser.parseInline(or.content,or.start),or.marks);this.addNode(this.buffer.writeElements(ar,-or.start).finish(Type$1.Paragraph,or.content.length),or.start)}elt(or,ar,cr,ur){return typeof or=="string"?elt(this.parser.getNodeType(or),ar,cr,ur):new TreeElement(or,ar)}get buffer(){return new Buffer$1(this.parser.nodeSet)}}function injectGaps(lr,or,ar,cr,ur){let hr=lr[or].to,fr=[],dr=[],pr=ar.from+cr;function mr(gr,yr){for(;yr?gr>=hr:gr>hr;){let br=lr[or+1].from-hr;cr+=br,gr+=br,or++,hr=lr[or].to}}for(let gr=ar.firstChild;gr;gr=gr.nextSibling){mr(gr.from+cr,!0);let yr=gr.from+cr,br,Or=ur.get(gr.tree);Or?br=Or:gr.to+cr>hr?(br=injectGaps(lr,or,gr,cr,ur),mr(gr.to+cr,!1)):br=gr.toTree(),fr.push(br),dr.push(yr-pr)}return mr(ar.to+cr,!1),new Tree$1(ar.type,fr,dr,ar.to+cr-pr,ar.tree?ar.tree.propValues:void 0)}class MarkdownParser extends Parser{constructor(or,ar,cr,ur,hr,fr,dr,pr,mr){super(),this.nodeSet=or,this.blockParsers=ar,this.leafBlockParsers=cr,this.blockNames=ur,this.endLeafBlock=hr,this.skipContextMarkup=fr,this.inlineParsers=dr,this.inlineNames=pr,this.wrappers=mr,this.nodeTypes=Object.create(null);for(let gr of or.types)this.nodeTypes[gr.name]=gr.id}createParse(or,ar,cr){let ur=new BlockContext(this,or,ar,cr);for(let hr of this.wrappers)ur=hr(ur,or,ar,cr);return ur}configure(or){let ar=resolveConfig(or);if(!ar)return this;let{nodeSet:cr,skipContextMarkup:ur}=this,hr=this.blockParsers.slice(),fr=this.leafBlockParsers.slice(),dr=this.blockNames.slice(),pr=this.inlineParsers.slice(),mr=this.inlineNames.slice(),gr=this.endLeafBlock.slice(),yr=this.wrappers;if(nonEmpty(ar.defineNodes)){ur=Object.assign({},ur);let br=cr.types.slice(),Or;for(let _r of ar.defineNodes){let{name:vr,block:xr,composite:wr,style:kr}=typeof _r=="string"?{name:_r}:_r;if(br.some(Nr=>Nr.name==vr))continue;wr&&(ur[br.length]=(Nr,Br,Fr)=>wr(Br,Fr,Nr.value));let Cr=br.length,$r=wr?["Block","BlockContext"]:xr?Cr>=Type$1.ATXHeading1&&Cr<=Type$1.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;br.push(NodeType.define({id:Cr,name:vr,props:$r&&[[NodeProp.group,$r]]})),kr&&(Or||(Or={}),Array.isArray(kr)||kr instanceof Tag?Or[vr]=kr:Object.assign(Or,kr))}cr=new NodeSet(br),Or&&(cr=cr.extend(styleTags(Or)))}if(nonEmpty(ar.props)&&(cr=cr.extend(...ar.props)),nonEmpty(ar.remove))for(let br of ar.remove){let Or=this.blockNames.indexOf(br),_r=this.inlineNames.indexOf(br);Or>-1&&(hr[Or]=fr[Or]=void 0),_r>-1&&(pr[_r]=void 0)}if(nonEmpty(ar.parseBlock))for(let br of ar.parseBlock){let Or=dr.indexOf(br.name);if(Or>-1)hr[Or]=br.parse,fr[Or]=br.leaf;else{let _r=br.before?findName(dr,br.before):br.after?findName(dr,br.after)+1:dr.length-1;hr.splice(_r,0,br.parse),fr.splice(_r,0,br.leaf),dr.splice(_r,0,br.name)}br.endLeaf&&gr.push(br.endLeaf)}if(nonEmpty(ar.parseInline))for(let br of ar.parseInline){let Or=mr.indexOf(br.name);if(Or>-1)pr[Or]=br.parse;else{let _r=br.before?findName(mr,br.before):br.after?findName(mr,br.after)+1:mr.length-1;pr.splice(_r,0,br.parse),mr.splice(_r,0,br.name)}}return ar.wrap&&(yr=yr.concat(ar.wrap)),new MarkdownParser(cr,hr,fr,dr,gr,ur,pr,mr,yr)}getNodeType(or){let ar=this.nodeTypes[or];if(ar==null)throw new RangeError(`Unknown node type '${or}'`);return ar}parseInline(or,ar){let cr=new InlineContext(this,or,ar);e:for(let ur=ar;ur<cr.end;){let hr=cr.char(ur);for(let fr of this.inlineParsers)if(fr){let dr=fr(cr,hr,ur);if(dr>=0){ur=dr;continue e}}ur++}return cr.resolveMarkers(0)}}function nonEmpty(lr){return lr!=null&&lr.length>0}function resolveConfig(lr){if(!Array.isArray(lr))return lr;if(lr.length==0)return null;let or=resolveConfig(lr[0]);if(lr.length==1)return or;let ar=resolveConfig(lr.slice(1));if(!ar||!or)return or||ar;let cr=(fr,dr)=>(fr||none$1).concat(dr||none$1),ur=or.wrap,hr=ar.wrap;return{props:cr(or.props,ar.props),defineNodes:cr(or.defineNodes,ar.defineNodes),parseBlock:cr(or.parseBlock,ar.parseBlock),parseInline:cr(or.parseInline,ar.parseInline),remove:cr(or.remove,ar.remove),wrap:ur?hr?(fr,dr,pr,mr)=>ur(hr(fr,dr,pr,mr),dr,pr,mr):ur:hr}}function findName(lr,or){let ar=lr.indexOf(or);if(ar<0)throw new RangeError(`Position specified relative to unknown parser ${or}`);return ar}let nodeTypes=[NodeType.none];for(let lr=1,or;or=Type$1[lr];lr++)nodeTypes[lr]=NodeType.define({id:lr,name:or,props:lr>=Type$1.Escape?[]:[[NodeProp.group,lr in DefaultSkipMarkup?["Block","BlockContext"]:["Block","LeafBlock"]]],top:or=="Document"});const none$1=[];let Buffer$1=class{constructor(or){this.nodeSet=or,this.content=[],this.nodes=[]}write(or,ar,cr,ur=0){return this.content.push(or,ar,cr,4+ur*4),this}writeElements(or,ar=0){for(let cr of or)cr.writeTo(this,ar);return this}finish(or,ar){return Tree$1.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:or,length:ar})}},Element$1=class{constructor(or,ar,cr,ur=none$1){this.type=or,this.from=ar,this.to=cr,this.children=ur}writeTo(or,ar){let cr=or.content.length;or.writeElements(this.children,ar),or.content.push(this.type,this.from+ar,this.to+ar,or.content.length+4-cr)}toTree(or){return new Buffer$1(or).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class TreeElement{constructor(or,ar){this.tree=or,this.from=ar}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return none$1}writeTo(or,ar){or.nodes.push(this.tree),or.content.push(or.nodes.length-1,this.from+ar,this.to+ar,-1)}toTree(){return this.tree}}function elt(lr,or,ar,cr){return new Element$1(lr,or,ar,cr)}const EmphasisUnderscore={resolve:"Emphasis",mark:"EmphasisMark"},EmphasisAsterisk={resolve:"Emphasis",mark:"EmphasisMark"},LinkStart={},ImageStart={};class InlineDelimiter{constructor(or,ar,cr,ur){this.type=or,this.from=ar,this.to=cr,this.side=ur}}const Escapable="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let Punctuation=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{Punctuation=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u")}catch{}const DefaultInline={Escape(lr,or,ar){if(or!=92||ar==lr.end-1)return-1;let cr=lr.char(ar+1);for(let ur=0;ur<Escapable.length;ur++)if(Escapable.charCodeAt(ur)==cr)return lr.append(elt(Type$1.Escape,ar,ar+2));return-1},Entity(lr,or,ar){if(or!=38)return-1;let cr=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(lr.slice(ar+1,ar+31));return cr?lr.append(elt(Type$1.Entity,ar,ar+1+cr[0].length)):-1},InlineCode(lr,or,ar){if(or!=96||ar&&lr.char(ar-1)==96)return-1;let cr=ar+1;for(;cr<lr.end&&lr.char(cr)==96;)cr++;let ur=cr-ar,hr=0;for(;cr<lr.end;cr++)if(lr.char(cr)==96){if(hr++,hr==ur&&lr.char(cr+1)!=96)return lr.append(elt(Type$1.InlineCode,ar,cr+1,[elt(Type$1.CodeMark,ar,ar+ur),elt(Type$1.CodeMark,cr+1-ur,cr+1)]))}else hr=0;return-1},HTMLTag(lr,or,ar){if(or!=60||ar==lr.end-1)return-1;let cr=lr.slice(ar+1,lr.end),ur=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(cr);if(ur)return lr.append(elt(Type$1.URL,ar,ar+1+ur[0].length));let hr=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(cr);if(hr)return lr.append(elt(Type$1.Comment,ar,ar+1+hr[0].length));let fr=/^\?[^]*?\?>/.exec(cr);if(fr)return lr.append(elt(Type$1.ProcessingInstruction,ar,ar+1+fr[0].length));let dr=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(cr);return dr?lr.append(elt(Type$1.HTMLTag,ar,ar+1+dr[0].length)):-1},Emphasis(lr,or,ar){if(or!=95&&or!=42)return-1;let cr=ar+1;for(;lr.char(cr)==or;)cr++;let ur=lr.slice(ar-1,ar),hr=lr.slice(cr,cr+1),fr=Punctuation.test(ur),dr=Punctuation.test(hr),pr=/\s|^$/.test(ur),mr=/\s|^$/.test(hr),gr=!mr&&(!dr||pr||fr),yr=!pr&&(!fr||mr||dr),br=gr&&(or==42||!yr||fr),Or=yr&&(or==42||!gr||dr);return lr.append(new InlineDelimiter(or==95?EmphasisUnderscore:EmphasisAsterisk,ar,cr,(br?1:0)|(Or?2:0)))},HardBreak(lr,or,ar){if(or==92&&lr.char(ar+1)==10)return lr.append(elt(Type$1.HardBreak,ar,ar+2));if(or==32){let cr=ar+1;for(;lr.char(cr)==32;)cr++;if(lr.char(cr)==10&&cr>=ar+2)return lr.append(elt(Type$1.HardBreak,ar,cr+1))}return-1},Link(lr,or,ar){return or==91?lr.append(new InlineDelimiter(LinkStart,ar,ar+1,1)):-1},Image(lr,or,ar){return or==33&&lr.char(ar+1)==91?lr.append(new InlineDelimiter(ImageStart,ar,ar+2,1)):-1},LinkEnd(lr,or,ar){if(or!=93)return-1;for(let cr=lr.parts.length-1;cr>=0;cr--){let ur=lr.parts[cr];if(ur instanceof InlineDelimiter&&(ur.type==LinkStart||ur.type==ImageStart)){if(!ur.side||lr.skipSpace(ur.to)==ar&&!/[(\[]/.test(lr.slice(ar+1,ar+2)))return lr.parts[cr]=null,-1;let hr=lr.takeContent(cr),fr=lr.parts[cr]=finishLink(lr,hr,ur.type==LinkStart?Type$1.Link:Type$1.Image,ur.from,ar+1);if(ur.type==LinkStart)for(let dr=0;dr<cr;dr++){let pr=lr.parts[dr];pr instanceof InlineDelimiter&&pr.type==LinkStart&&(pr.side=0)}return fr.to}}return-1}};function finishLink(lr,or,ar,cr,ur){let{text:hr}=lr,fr=lr.char(ur),dr=ur;if(or.unshift(elt(Type$1.LinkMark,cr,cr+(ar==Type$1.Image?2:1))),or.push(elt(Type$1.LinkMark,ur-1,ur)),fr==40){let pr=lr.skipSpace(ur+1),mr=parseURL(hr,pr-lr.offset,lr.offset),gr;mr&&(pr=lr.skipSpace(mr.to),gr=parseLinkTitle(hr,pr-lr.offset,lr.offset),gr&&(pr=lr.skipSpace(gr.to))),lr.char(pr)==41&&(or.push(elt(Type$1.LinkMark,ur,ur+1)),dr=pr+1,mr&&or.push(mr),gr&&or.push(gr),or.push(elt(Type$1.LinkMark,pr,dr)))}else if(fr==91){let pr=parseLinkLabel(hr,ur-lr.offset,lr.offset,!1);pr&&(or.push(pr),dr=pr.to)}return elt(ar,cr,dr,or)}function parseURL(lr,or,ar){if(lr.charCodeAt(or)==60){for(let ur=or+1;ur<lr.length;ur++){let hr=lr.charCodeAt(ur);if(hr==62)return elt(Type$1.URL,or+ar,ur+1+ar);if(hr==60||hr==10)return!1}return null}else{let ur=0,hr=or;for(let fr=!1;hr<lr.length;hr++){let dr=lr.charCodeAt(hr);if(space$2(dr))break;if(fr)fr=!1;else if(dr==40)ur++;else if(dr==41){if(!ur)break;ur--}else dr==92&&(fr=!0)}return hr>or?elt(Type$1.URL,or+ar,hr+ar):hr==lr.length?null:!1}}function parseLinkTitle(lr,or,ar){let cr=lr.charCodeAt(or);if(cr!=39&&cr!=34&&cr!=40)return!1;let ur=cr==40?41:cr;for(let hr=or+1,fr=!1;hr<lr.length;hr++){let dr=lr.charCodeAt(hr);if(fr)fr=!1;else{if(dr==ur)return elt(Type$1.LinkTitle,or+ar,hr+1+ar);dr==92&&(fr=!0)}}return null}function parseLinkLabel(lr,or,ar,cr){for(let ur=!1,hr=or+1,fr=Math.min(lr.length,hr+999);hr<fr;hr++){let dr=lr.charCodeAt(hr);if(ur)ur=!1;else{if(dr==93)return cr?!1:elt(Type$1.LinkLabel,or+ar,hr+1+ar);if(cr&&!space$2(dr)&&(cr=!1),dr==91)return!1;dr==92&&(ur=!0)}}return null}class InlineContext{constructor(or,ar,cr){this.parser=or,this.text=ar,this.offset=cr,this.parts=[]}char(or){return or>=this.end?-1:this.text.charCodeAt(or-this.offset)}get end(){return this.offset+this.text.length}slice(or,ar){return this.text.slice(or-this.offset,ar-this.offset)}append(or){return this.parts.push(or),or.to}addDelimiter(or,ar,cr,ur,hr){return this.append(new InlineDelimiter(or,ar,cr,(ur?1:0)|(hr?2:0)))}addElement(or){return this.append(or)}resolveMarkers(or){for(let cr=or;cr<this.parts.length;cr++){let ur=this.parts[cr];if(!(ur instanceof InlineDelimiter&&ur.type.resolve&&ur.side&2))continue;let hr=ur.type==EmphasisUnderscore||ur.type==EmphasisAsterisk,fr=ur.to-ur.from,dr,pr=cr-1;for(;pr>=or;pr--){let vr=this.parts[pr];if(vr instanceof InlineDelimiter&&vr.side&1&&vr.type==ur.type&&!(hr&&(ur.side&1||vr.side&2)&&(vr.to-vr.from+fr)%3==0&&((vr.to-vr.from)%3||fr%3))){dr=vr;break}}if(!dr)continue;let mr=ur.type.resolve,gr=[],yr=dr.from,br=ur.to;if(hr){let vr=Math.min(2,dr.to-dr.from,fr);yr=dr.to-vr,br=ur.from+vr,mr=vr==1?"Emphasis":"StrongEmphasis"}dr.type.mark&&gr.push(this.elt(dr.type.mark,yr,dr.to));for(let vr=pr+1;vr<cr;vr++)this.parts[vr]instanceof Element$1&&gr.push(this.parts[vr]),this.parts[vr]=null;ur.type.mark&&gr.push(this.elt(ur.type.mark,ur.from,br));let Or=this.elt(mr,yr,br,gr);this.parts[pr]=hr&&dr.from!=yr?new InlineDelimiter(dr.type,dr.from,yr,dr.side):null,(this.parts[cr]=hr&&ur.to!=br?new InlineDelimiter(ur.type,br,ur.to,ur.side):null)?this.parts.splice(cr,0,Or):this.parts[cr]=Or}let ar=[];for(let cr=or;cr<this.parts.length;cr++){let ur=this.parts[cr];ur instanceof Element$1&&ar.push(ur)}return ar}findOpeningDelimiter(or){for(let ar=this.parts.length-1;ar>=0;ar--){let cr=this.parts[ar];if(cr instanceof InlineDelimiter&&cr.type==or)return ar}return null}takeContent(or){let ar=this.resolveMarkers(or);return this.parts.length=or,ar}skipSpace(or){return skipSpace(this.text,or-this.offset)+this.offset}elt(or,ar,cr,ur){return typeof or=="string"?elt(this.parser.getNodeType(or),ar,cr,ur):new TreeElement(or,ar)}}function injectMarks(lr,or){if(!or.length)return lr;if(!lr.length)return or;let ar=lr.slice(),cr=0;for(let ur of or){for(;cr<ar.length&&ar[cr].to<ur.to;)cr++;if(cr<ar.length&&ar[cr].from<ur.from){let hr=ar[cr];hr instanceof Element$1&&(ar[cr]=new Element$1(hr.type,hr.from,hr.to,injectMarks(hr.children,[ur])))}else ar.splice(cr++,0,ur)}return ar}const NotLast=[Type$1.CodeBlock,Type$1.ListItem,Type$1.OrderedList,Type$1.BulletList];let FragmentCursor$1=class{constructor(or,ar){this.fragments=or,this.input=ar,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,or.length&&(this.fragment=or[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(or,ar){for(;this.fragment&&this.fragment.to<=or;)this.nextFragment();if(!this.fragment||this.fragment.from>(or?or-1:0))return!1;if(this.fragmentEnd<0){let hr=this.fragment.to;for(;hr>0&&this.input.read(hr-1,hr)!=`
`;)hr--;this.fragmentEnd=hr?hr-1:0}let cr=this.cursor;cr||(cr=this.cursor=this.fragment.tree.cursor(),cr.firstChild());let ur=or+this.fragment.offset;for(;cr.to<=ur;)if(!cr.parent())return!1;for(;;){if(cr.from>=ur)return this.fragment.from<=ar;if(!cr.childAfter(ur))return!1}}matches(or){let ar=this.cursor.tree;return ar&&ar.prop(NodeProp.contextHash)==or}takeNodes(or){let ar=this.cursor,cr=this.fragment.offset,ur=this.fragmentEnd-(this.fragment.openEnd?1:0),hr=or.absoluteLineStart,fr=hr,dr=or.block.children.length,pr=fr,mr=dr;for(;;){if(ar.to-cr>ur){if(ar.type.isAnonymous&&ar.firstChild())continue;break}let gr=toRelative(ar.from-cr,or.ranges);if(ar.to-cr<=or.ranges[or.rangeI].to)or.addNode(ar.tree,gr);else{let yr=new Tree$1(or.parser.nodeSet.types[Type$1.Paragraph],[],[],0,or.block.hashProp);or.reusePlaceholders.set(yr,ar.tree),or.addNode(yr,gr)}if(ar.type.is("Block")&&(NotLast.indexOf(ar.type.id)<0?(fr=ar.to-cr,dr=or.block.children.length):(fr=pr,dr=mr,pr=ar.to-cr,mr=or.block.children.length)),!ar.nextSibling())break}for(;or.block.children.length>dr;)or.block.children.pop(),or.block.positions.pop();return fr-hr}};function toRelative(lr,or){let ar=lr;for(let cr=1;cr<or.length;cr++){let ur=or[cr-1].to,hr=or[cr].from;ur<lr&&(ar-=hr-ur)}return ar}const markdownHighlighting=styleTags({"Blockquote/...":tags$1.quote,HorizontalRule:tags$1.contentSeparator,"ATXHeading1/... SetextHeading1/...":tags$1.heading1,"ATXHeading2/... SetextHeading2/...":tags$1.heading2,"ATXHeading3/...":tags$1.heading3,"ATXHeading4/...":tags$1.heading4,"ATXHeading5/...":tags$1.heading5,"ATXHeading6/...":tags$1.heading6,"Comment CommentBlock":tags$1.comment,Escape:tags$1.escape,Entity:tags$1.character,"Emphasis/...":tags$1.emphasis,"StrongEmphasis/...":tags$1.strong,"Link/... Image/...":tags$1.link,"OrderedList/... BulletList/...":tags$1.list,"BlockQuote/...":tags$1.quote,"InlineCode CodeText":tags$1.monospace,URL:tags$1.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":tags$1.processingInstruction,"CodeInfo LinkLabel":tags$1.labelName,LinkTitle:tags$1.string,Paragraph:tags$1.content}),parser$3=new MarkdownParser(new NodeSet(nodeTypes).extend(markdownHighlighting),Object.keys(DefaultBlockParsers).map(lr=>DefaultBlockParsers[lr]),Object.keys(DefaultBlockParsers).map(lr=>DefaultLeafBlocks[lr]),Object.keys(DefaultBlockParsers),DefaultEndLeaf,DefaultSkipMarkup,Object.keys(DefaultInline).map(lr=>DefaultInline[lr]),Object.keys(DefaultInline),[]);function leftOverSpace(lr,or,ar){let cr=[];for(let ur=lr.firstChild,hr=or;;ur=ur.nextSibling){let fr=ur?ur.from:ar;if(fr>hr&&cr.push({from:hr,to:fr}),!ur)break;hr=ur.to}return cr}function parseCode(lr){let{codeParser:or,htmlParser:ar}=lr;return{wrap:parseMixed((ur,hr)=>{let fr=ur.type.id;if(or&&(fr==Type$1.CodeBlock||fr==Type$1.FencedCode)){let dr="";if(fr==Type$1.FencedCode){let mr=ur.node.getChild(Type$1.CodeInfo);mr&&(dr=hr.read(mr.from,mr.to))}let pr=or(dr);if(pr)return{parser:pr,overlay:mr=>mr.type.id==Type$1.CodeText}}else if(ar&&(fr==Type$1.HTMLBlock||fr==Type$1.HTMLTag))return{parser:ar,overlay:leftOverSpace(ur.node,ur.from,ur.to)};return null})}}const StrikethroughDelim={resolve:"Strikethrough",mark:"StrikethroughMark"},Strikethrough={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":tags$1.strikethrough}},{name:"StrikethroughMark",style:tags$1.processingInstruction}],parseInline:[{name:"Strikethrough",parse(lr,or,ar){if(or!=126||lr.char(ar+1)!=126||lr.char(ar+2)==126)return-1;let cr=lr.slice(ar-1,ar),ur=lr.slice(ar+2,ar+3),hr=/\s|^$/.test(cr),fr=/\s|^$/.test(ur),dr=Punctuation.test(cr),pr=Punctuation.test(ur);return lr.addDelimiter(StrikethroughDelim,ar,ar+2,!fr&&(!pr||hr||dr),!hr&&(!dr||fr||pr))},after:"Emphasis"}]};function parseRow(lr,or,ar=0,cr,ur=0){let hr=0,fr=!0,dr=-1,pr=-1,mr=!1,gr=()=>{cr.push(lr.elt("TableCell",ur+dr,ur+pr,lr.parser.parseInline(or.slice(dr,pr),ur+dr)))};for(let yr=ar;yr<or.length;yr++){let br=or.charCodeAt(yr);br==124&&!mr?((!fr||dr>-1)&&hr++,fr=!1,cr&&(dr>-1&&gr(),cr.push(lr.elt("TableDelimiter",yr+ur,yr+ur+1))),dr=pr=-1):(mr||br!=32&&br!=9)&&(dr<0&&(dr=yr),pr=yr+1),mr=!mr&&br==92}return dr>-1&&(hr++,cr&&gr()),hr}function hasPipe(lr,or){for(let ar=or;ar<lr.length;ar++){let cr=lr.charCodeAt(ar);if(cr==124)return!0;cr==92&&ar++}return!1}const delimiterLine=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class TableParser{constructor(){this.rows=null}nextLine(or,ar,cr){if(this.rows==null){this.rows=!1;let ur;if((ar.next==45||ar.next==58||ar.next==124)&&delimiterLine.test(ur=ar.text.slice(ar.pos))){let hr=[];parseRow(or,cr.content,0,hr,cr.start)==parseRow(or,ur,ar.pos)&&(this.rows=[or.elt("TableHeader",cr.start,cr.start+cr.content.length,hr),or.elt("TableDelimiter",or.lineStart+ar.pos,or.lineStart+ar.text.length)])}}else if(this.rows){let ur=[];parseRow(or,ar.text,ar.pos,ur,or.lineStart),this.rows.push(or.elt("TableRow",or.lineStart+ar.pos,or.lineStart+ar.text.length,ur))}return!1}finish(or,ar){return this.rows?(or.addLeafElement(ar,or.elt("Table",ar.start,ar.start+ar.content.length,this.rows)),!0):!1}}const Table={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":tags$1.heading}},"TableRow",{name:"TableCell",style:tags$1.content},{name:"TableDelimiter",style:tags$1.processingInstruction}],parseBlock:[{name:"Table",leaf(lr,or){return hasPipe(or.content,0)?new TableParser:null},endLeaf(lr,or,ar){if(ar.parsers.some(ur=>ur instanceof TableParser)||!hasPipe(or.text,or.basePos))return!1;let cr=lr.scanLine(lr.absoluteLineEnd+1).text;return delimiterLine.test(cr)&&parseRow(lr,or.text,or.basePos)==parseRow(lr,cr,or.basePos)},before:"SetextHeading"}]};class TaskParser{nextLine(){return!1}finish(or,ar){return or.addLeafElement(ar,or.elt("Task",ar.start,ar.start+ar.content.length,[or.elt("TaskMarker",ar.start,ar.start+3),...or.parser.parseInline(ar.content.slice(3),ar.start+3)])),!0}}const TaskList={defineNodes:[{name:"Task",block:!0,style:tags$1.list},{name:"TaskMarker",style:tags$1.atom}],parseBlock:[{name:"TaskList",leaf(lr,or){return/^\[[ xX]\][ \t]/.test(or.content)&&lr.parentType().name=="ListItem"?new TaskParser:null},after:"SetextHeading"}]},autolinkRE=/(www\.)|(https?:\/\/)|([\w.+-]+@)|(mailto:|xmpp:)/gy,urlRE=/[\w-]+(\.\w+(\.\w+)?)(\/[^\s<]*)?/gy,emailRE=/[\w.+-]+@[\w-]+\.[\w.-]+/gy,xmppResourceRE=/\/[a-zA-Z\d@.]+/gy;function count(lr,or,ar,cr){let ur=0;for(let hr=or;hr<ar;hr++)lr[hr]==cr&&ur++;return ur}function autolinkURLEnd(lr,or){urlRE.lastIndex=or;let ar=urlRE.exec(lr);if(!ar)return-1;let cr=or+ar[0].length;for(;;){let ur=lr[cr-1],hr;if(/[?!.,:*_~]/.test(ur)||ur==")"&&count(lr,or,cr,")")>count(lr,or,cr,"("))cr--;else if(ur==";"&&(hr=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(lr.slice(or,cr))))cr=or+hr.index;else break}return cr}function autolinkEmailEnd(lr,or){emailRE.lastIndex=or;let ar=emailRE.exec(lr);if(!ar)return-1;let cr=ar[0][ar[0].length-1];return cr=="_"||cr=="-"?-1:or+ar[0].length-(cr=="."?1:0)}const Autolink={parseInline:[{name:"Autolink",parse(lr,or,ar){let cr=ar-lr.offset;autolinkRE.lastIndex=cr;let ur=autolinkRE.exec(lr.text),hr=-1;return!ur||(ur[1]||ur[2]?hr=autolinkURLEnd(lr.text,cr+ur[0].length):ur[3]?hr=autolinkEmailEnd(lr.text,cr):(hr=autolinkEmailEnd(lr.text,cr+ur[0].length),hr>-1&&ur[0]=="xmpp:"&&(xmppResourceRE.lastIndex=hr,ur=xmppResourceRE.exec(lr.text),ur&&(hr=ur.index+ur[0].length))),hr<0)?-1:(lr.addElement(lr.elt("URL",ar,hr+lr.offset)),hr+lr.offset)}}]},GFM=[Table,TaskList,Strikethrough,Autolink];function parseSubSuper(lr,or,ar){return(cr,ur,hr)=>{if(ur!=lr||cr.char(hr+1)==lr)return-1;let fr=[cr.elt(ar,hr,hr+1)];for(let dr=hr+1;dr<cr.end;dr++){let pr=cr.char(dr);if(pr==lr)return cr.addElement(cr.elt(or,hr,dr+1,fr.concat(cr.elt(ar,dr,dr+1))));if(pr==92&&fr.push(cr.elt("Escape",dr,dr+++2)),space$2(pr))break}return-1}}const Superscript={defineNodes:[{name:"Superscript",style:tags$1.special(tags$1.content)},{name:"SuperscriptMark",style:tags$1.processingInstruction}],parseInline:[{name:"Superscript",parse:parseSubSuper(94,"Superscript","SuperscriptMark")}]},Subscript={defineNodes:[{name:"Subscript",style:tags$1.special(tags$1.content)},{name:"SubscriptMark",style:tags$1.processingInstruction}],parseInline:[{name:"Subscript",parse:parseSubSuper(126,"Subscript","SubscriptMark")}]},Emoji={defineNodes:[{name:"Emoji",style:tags$1.character}],parseInline:[{name:"Emoji",parse(lr,or,ar){let cr;return or!=58||!(cr=/^[a-zA-Z_0-9]+:/.exec(lr.slice(ar+1,lr.end)))?-1:lr.addElement(lr.elt("Emoji",ar,ar+1+cr[0].length))}}]};class Stack{constructor(or,ar,cr,ur,hr,fr,dr,pr,mr,gr=0,yr){this.p=or,this.stack=ar,this.state=cr,this.reducePos=ur,this.pos=hr,this.score=fr,this.buffer=dr,this.bufferBase=pr,this.curContext=mr,this.lookAhead=gr,this.parent=yr}toString(){return`[${this.stack.filter((or,ar)=>ar%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(or,ar,cr=0){let ur=or.parser.context;return new Stack(or,[],ar,cr,cr,0,[],0,ur?new StackContext(ur,ur.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(or,ar){this.stack.push(this.state,ar,this.bufferBase+this.buffer.length),this.state=or}reduce(or){var ar;let cr=or>>19,ur=or&65535,{parser:hr}=this.p,fr=hr.dynamicPrecedence(ur);if(fr&&(this.score+=fr),cr==0){this.pushState(hr.getGoto(this.state,ur,!0),this.reducePos),ur<hr.minRepeatTerm&&this.storeNode(ur,this.reducePos,this.reducePos,4,!0),this.reduceContext(ur,this.reducePos);return}let dr=this.stack.length-(cr-1)*3-(or&262144?6:0),pr=dr?this.stack[dr-2]:this.p.ranges[0].from,mr=this.reducePos-pr;mr>=2e3&&!(!((ar=this.p.parser.nodeSet.types[ur])===null||ar===void 0)&&ar.isAnonymous)&&(pr==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=mr):this.p.lastBigReductionSize<mr&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=pr,this.p.lastBigReductionSize=mr));let gr=dr?this.stack[dr-1]:0,yr=this.bufferBase+this.buffer.length-gr;if(ur<hr.minRepeatTerm||or&131072){let br=hr.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(ur,pr,br,yr+4,!0)}if(or&262144)this.state=this.stack[dr];else{let br=this.stack[dr-3];this.state=hr.getGoto(br,ur,!0)}for(;this.stack.length>dr;)this.stack.pop();this.reduceContext(ur,pr)}storeNode(or,ar,cr,ur=4,hr=!1){if(or==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let fr=this,dr=this.buffer.length;if(dr==0&&fr.parent&&(dr=fr.bufferBase-fr.parent.bufferBase,fr=fr.parent),dr>0&&fr.buffer[dr-4]==0&&fr.buffer[dr-1]>-1){if(ar==cr)return;if(fr.buffer[dr-2]>=ar){fr.buffer[dr-2]=cr;return}}}if(!hr||this.pos==cr)this.buffer.push(or,ar,cr,ur);else{let fr=this.buffer.length;if(fr>0&&this.buffer[fr-4]!=0)for(;fr>0&&this.buffer[fr-2]>cr;)this.buffer[fr]=this.buffer[fr-4],this.buffer[fr+1]=this.buffer[fr-3],this.buffer[fr+2]=this.buffer[fr-2],this.buffer[fr+3]=this.buffer[fr-1],fr-=4,ur>4&&(ur-=4);this.buffer[fr]=or,this.buffer[fr+1]=ar,this.buffer[fr+2]=cr,this.buffer[fr+3]=ur}}shift(or,ar,cr){let ur=this.pos;if(or&131072)this.pushState(or&65535,this.pos);else if(or&262144)this.pos=cr,this.shiftContext(ar,ur),ar<=this.p.parser.maxNode&&this.buffer.push(ar,ur,cr,4);else{let hr=or,{parser:fr}=this.p;(cr>this.pos||ar<=fr.maxNode)&&(this.pos=cr,fr.stateFlag(hr,1)||(this.reducePos=cr)),this.pushState(hr,ur),this.shiftContext(ar,ur),ar<=fr.maxNode&&this.buffer.push(ar,ur,cr,4)}}apply(or,ar,cr){or&65536?this.reduce(or):this.shift(or,ar,cr)}useNode(or,ar){let cr=this.p.reused.length-1;(cr<0||this.p.reused[cr]!=or)&&(this.p.reused.push(or),cr++);let ur=this.pos;this.reducePos=this.pos=ur+or.length,this.pushState(ar,ur),this.buffer.push(cr,ur,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,or,this,this.p.stream.reset(this.pos-or.length)))}split(){let or=this,ar=or.buffer.length;for(;ar>0&&or.buffer[ar-2]>or.reducePos;)ar-=4;let cr=or.buffer.slice(ar),ur=or.bufferBase+ar;for(;or&&ur==or.bufferBase;)or=or.parent;return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,cr,ur,this.curContext,this.lookAhead,or)}recoverByDelete(or,ar){let cr=or<=this.p.parser.maxNode;cr&&this.storeNode(or,this.pos,ar,4),this.storeNode(0,this.pos,ar,cr?8:4),this.pos=this.reducePos=ar,this.score-=190}canShift(or){for(let ar=new SimulatedStack(this);;){let cr=this.p.parser.stateSlot(ar.state,4)||this.p.parser.hasAction(ar.state,or);if(cr==0)return!1;if(!(cr&65536))return!0;ar.reduce(cr)}}recoverByInsert(or){if(this.stack.length>=300)return[];let ar=this.p.parser.nextStates(this.state);if(ar.length>8||this.stack.length>=120){let ur=[];for(let hr=0,fr;hr<ar.length;hr+=2)(fr=ar[hr+1])!=this.state&&this.p.parser.hasAction(fr,or)&&ur.push(ar[hr],fr);if(this.stack.length<120)for(let hr=0;ur.length<8&&hr<ar.length;hr+=2){let fr=ar[hr+1];ur.some((dr,pr)=>pr&1&&dr==fr)||ur.push(ar[hr],fr)}ar=ur}let cr=[];for(let ur=0;ur<ar.length&&cr.length<4;ur+=2){let hr=ar[ur+1];if(hr==this.state)continue;let fr=this.split();fr.pushState(hr,this.pos),fr.storeNode(0,fr.pos,fr.pos,4,!0),fr.shiftContext(ar[ur],this.pos),fr.score-=200,cr.push(fr)}return cr}forceReduce(){let{parser:or}=this.p,ar=or.stateSlot(this.state,5);if(!(ar&65536))return!1;if(!or.validAction(this.state,ar)){let cr=ar>>19,ur=ar&65535,hr=this.stack.length-cr*3;if(hr<0||or.getGoto(this.stack[hr],ur,!1)<0){let fr=this.findForcedReduction();if(fr==null)return!1;ar=fr}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(ar),!0}findForcedReduction(){let{parser:or}=this.p,ar=[],cr=(ur,hr)=>{if(!ar.includes(ur))return ar.push(ur),or.allActions(ur,fr=>{if(!(fr&393216))if(fr&65536){let dr=(fr>>19)-hr;if(dr>1){let pr=fr&65535,mr=this.stack.length-dr*3;if(mr>=0&&or.getGoto(this.stack[mr],pr,!1)>=0)return dr<<19|65536|pr}}else{let dr=cr(fr,hr+1);if(dr!=null)return dr}})};return cr(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:or}=this.p;return or.data[or.stateSlot(this.state,1)]==65535&&!or.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(or){if(this.state!=or.state||this.stack.length!=or.stack.length)return!1;for(let ar=0;ar<this.stack.length;ar+=3)if(this.stack[ar]!=or.stack[ar])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(or){return this.p.parser.dialect.flags[or]}shiftContext(or,ar){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,or,this,this.p.stream.reset(ar)))}reduceContext(or,ar){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,or,this,this.p.stream.reset(ar)))}emitContext(){let or=this.buffer.length-1;(or<0||this.buffer[or]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let or=this.buffer.length-1;(or<0||this.buffer[or]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(or){if(or!=this.curContext.context){let ar=new StackContext(this.curContext.tracker,or);ar.hash!=this.curContext.hash&&this.emitContext(),this.curContext=ar}}setLookAhead(or){or>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=or)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class StackContext{constructor(or,ar){this.tracker=or,this.context=ar,this.hash=or.strict?or.hash(ar):0}}class SimulatedStack{constructor(or){this.start=or,this.state=or.state,this.stack=or.stack,this.base=this.stack.length}reduce(or){let ar=or&65535,cr=or>>19;cr==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(cr-1)*3;let ur=this.start.p.parser.getGoto(this.stack[this.base-3],ar,!0);this.state=ur}}class StackBufferCursor{constructor(or,ar,cr){this.stack=or,this.pos=ar,this.index=cr,this.buffer=or.buffer,this.index==0&&this.maybeNext()}static create(or,ar=or.bufferBase+or.buffer.length){return new StackBufferCursor(or,ar,ar-or.bufferBase)}maybeNext(){let or=this.stack.parent;or!=null&&(this.index=this.stack.bufferBase-or.bufferBase,this.stack=or,this.buffer=or.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new StackBufferCursor(this.stack,this.pos,this.index)}}function decodeArray(lr,or=Uint16Array){if(typeof lr!="string")return lr;let ar=null;for(let cr=0,ur=0;cr<lr.length;){let hr=0;for(;;){let fr=lr.charCodeAt(cr++),dr=!1;if(fr==126){hr=65535;break}fr>=92&&fr--,fr>=34&&fr--;let pr=fr-32;if(pr>=46&&(pr-=46,dr=!0),hr+=pr,dr)break;hr*=46}ar?ar[ur++]=hr:ar=new or(hr)}return ar}class CachedToken{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const nullToken=new CachedToken;class InputStream{constructor(or,ar){this.input=or,this.ranges=ar,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=nullToken,this.rangeIndex=0,this.pos=this.chunkPos=ar[0].from,this.range=ar[0],this.end=ar[ar.length-1].to,this.readNext()}resolveOffset(or,ar){let cr=this.range,ur=this.rangeIndex,hr=this.pos+or;for(;hr<cr.from;){if(!ur)return null;let fr=this.ranges[--ur];hr-=cr.from-fr.to,cr=fr}for(;ar<0?hr>cr.to:hr>=cr.to;){if(ur==this.ranges.length-1)return null;let fr=this.ranges[++ur];hr+=fr.from-cr.to,cr=fr}return hr}clipPos(or){if(or>=this.range.from&&or<this.range.to)return or;for(let ar of this.ranges)if(ar.to>or)return Math.max(or,ar.from);return this.end}peek(or){let ar=this.chunkOff+or,cr,ur;if(ar>=0&&ar<this.chunk.length)cr=this.pos+or,ur=this.chunk.charCodeAt(ar);else{let hr=this.resolveOffset(or,1);if(hr==null)return-1;if(cr=hr,cr>=this.chunk2Pos&&cr<this.chunk2Pos+this.chunk2.length)ur=this.chunk2.charCodeAt(cr-this.chunk2Pos);else{let fr=this.rangeIndex,dr=this.range;for(;dr.to<=cr;)dr=this.ranges[++fr];this.chunk2=this.input.chunk(this.chunk2Pos=cr),cr+this.chunk2.length>dr.to&&(this.chunk2=this.chunk2.slice(0,dr.to-cr)),ur=this.chunk2.charCodeAt(0)}}return cr>=this.token.lookAhead&&(this.token.lookAhead=cr+1),ur}acceptToken(or,ar=0){let cr=ar?this.resolveOffset(ar,-1):this.pos;if(cr==null||cr<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=or,this.token.end=cr}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:or,chunkPos:ar}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=or,this.chunk2Pos=ar,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let or=this.input.chunk(this.pos),ar=this.pos+or.length;this.chunk=ar>this.range.to?or.slice(0,this.range.to-this.pos):or,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(or=1){for(this.chunkOff+=or;this.pos+or>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();or-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=or,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(or,ar){if(ar?(this.token=ar,ar.start=or,ar.lookAhead=or+1,ar.value=ar.extended=-1):this.token=nullToken,this.pos!=or){if(this.pos=or,or==this.end)return this.setDone(),this;for(;or<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;or>=this.range.to;)this.range=this.ranges[++this.rangeIndex];or>=this.chunkPos&&or<this.chunkPos+this.chunk.length?this.chunkOff=or-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(or,ar){if(or>=this.chunkPos&&ar<=this.chunkPos+this.chunk.length)return this.chunk.slice(or-this.chunkPos,ar-this.chunkPos);if(or>=this.chunk2Pos&&ar<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(or-this.chunk2Pos,ar-this.chunk2Pos);if(or>=this.range.from&&ar<=this.range.to)return this.input.read(or,ar);let cr="";for(let ur of this.ranges){if(ur.from>=ar)break;ur.to>or&&(cr+=this.input.read(Math.max(ur.from,or),Math.min(ur.to,ar)))}return cr}}class TokenGroup{constructor(or,ar){this.data=or,this.id=ar}token(or,ar){let{parser:cr}=ar.p;readToken(this.data,or,ar,this.id,cr.data,cr.tokenPrecTable)}}TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;class LocalTokenGroup{constructor(or,ar,cr){this.precTable=ar,this.elseToken=cr,this.data=typeof or=="string"?decodeArray(or):or}token(or,ar){let cr=or.pos,ur=0;for(;;){let hr=or.next<0,fr=or.resolveOffset(1,1);if(readToken(this.data,or,ar,0,this.data,this.precTable),or.token.value>-1)break;if(this.elseToken==null)return;if(hr||ur++,fr==null)break;or.reset(fr,or.token)}ur&&(or.reset(cr,or.token),or.acceptToken(this.elseToken,ur))}}LocalTokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;class ExternalTokenizer{constructor(or,ar={}){this.token=or,this.contextual=!!ar.contextual,this.fallback=!!ar.fallback,this.extend=!!ar.extend}}function readToken(lr,or,ar,cr,ur,hr){let fr=0,dr=1<<cr,{dialect:pr}=ar.p.parser;e:for(;dr&lr[fr];){let mr=lr[fr+1];for(let Or=fr+3;Or<mr;Or+=2)if((lr[Or+1]&dr)>0){let _r=lr[Or];if(pr.allows(_r)&&(or.token.value==-1||or.token.value==_r||overrides(_r,or.token.value,ur,hr))){or.acceptToken(_r);break}}let gr=or.next,yr=0,br=lr[fr+2];if(or.next<0&&br>yr&&lr[mr+br*3-3]==65535&&lr[mr+br*3-3]==65535){fr=lr[mr+br*3-1];continue e}for(;yr<br;){let Or=yr+br>>1,_r=mr+Or+(Or<<1),vr=lr[_r],xr=lr[_r+1]||65536;if(gr<vr)br=Or;else if(gr>=xr)yr=Or+1;else{fr=lr[_r+2],or.advance();continue e}}break}}function findOffset(lr,or,ar){for(let cr=or,ur;(ur=lr[cr])!=65535;cr++)if(ur==ar)return cr-or;return-1}function overrides(lr,or,ar,cr){let ur=findOffset(ar,cr,or);return ur<0||findOffset(ar,cr,lr)<ur}const verbose=typeof process<"u"&&process.env&&/\bparse\b/.test({}.LOG);let stackIDs=null;function cutAt(lr,or,ar){let cr=lr.cursor(IterMode.IncludeAnonymous);for(cr.moveTo(or);;)if(!(ar<0?cr.childBefore(or):cr.childAfter(or)))for(;;){if((ar<0?cr.to<or:cr.from>or)&&!cr.type.isError)return ar<0?Math.max(0,Math.min(cr.to-1,or-25)):Math.min(lr.length,Math.max(cr.from+1,or+25));if(ar<0?cr.prevSibling():cr.nextSibling())break;if(!cr.parent())return ar<0?0:lr.length}}class FragmentCursor{constructor(or,ar){this.fragments=or,this.nodeSet=ar,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let or=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(or){for(this.safeFrom=or.openStart?cutAt(or.tree,or.from+or.offset,1)-or.offset:or.from,this.safeTo=or.openEnd?cutAt(or.tree,or.to+or.offset,-1)-or.offset:or.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(or.tree),this.start.push(-or.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(or){if(or<this.nextStart)return null;for(;this.fragment&&this.safeTo<=or;)this.nextFragment();if(!this.fragment)return null;for(;;){let ar=this.trees.length-1;if(ar<0)return this.nextFragment(),null;let cr=this.trees[ar],ur=this.index[ar];if(ur==cr.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let hr=cr.children[ur],fr=this.start[ar]+cr.positions[ur];if(fr>or)return this.nextStart=fr,null;if(hr instanceof Tree$1){if(fr==or){if(fr<this.safeFrom)return null;let dr=fr+hr.length;if(dr<=this.safeTo){let pr=hr.prop(NodeProp.lookAhead);if(!pr||dr+pr<this.fragment.to)return hr}}this.index[ar]++,fr+hr.length>=Math.max(this.safeFrom,or)&&(this.trees.push(hr),this.start.push(fr),this.index.push(0))}else this.index[ar]++,this.nextStart=fr+hr.length}}}class TokenCache{constructor(or,ar){this.stream=ar,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=or.tokenizers.map(cr=>new CachedToken)}getActions(or){let ar=0,cr=null,{parser:ur}=or.p,{tokenizers:hr}=ur,fr=ur.stateSlot(or.state,3),dr=or.curContext?or.curContext.hash:0,pr=0;for(let mr=0;mr<hr.length;mr++){if(!(1<<mr&fr))continue;let gr=hr[mr],yr=this.tokens[mr];if(!(cr&&!gr.fallback)&&((gr.contextual||yr.start!=or.pos||yr.mask!=fr||yr.context!=dr)&&(this.updateCachedToken(yr,gr,or),yr.mask=fr,yr.context=dr),yr.lookAhead>yr.end+25&&(pr=Math.max(yr.lookAhead,pr)),yr.value!=0)){let br=ar;if(yr.extended>-1&&(ar=this.addActions(or,yr.extended,yr.end,ar)),ar=this.addActions(or,yr.value,yr.end,ar),!gr.extend&&(cr=yr,ar>br))break}}for(;this.actions.length>ar;)this.actions.pop();return pr&&or.setLookAhead(pr),!cr&&or.pos==this.stream.end&&(cr=new CachedToken,cr.value=or.p.parser.eofTerm,cr.start=cr.end=or.pos,ar=this.addActions(or,cr.value,cr.end,ar)),this.mainToken=cr,this.actions}getMainToken(or){if(this.mainToken)return this.mainToken;let ar=new CachedToken,{pos:cr,p:ur}=or;return ar.start=cr,ar.end=Math.min(cr+1,ur.stream.end),ar.value=cr==ur.stream.end?ur.parser.eofTerm:0,ar}updateCachedToken(or,ar,cr){let ur=this.stream.clipPos(cr.pos);if(ar.token(this.stream.reset(ur,or),cr),or.value>-1){let{parser:hr}=cr.p;for(let fr=0;fr<hr.specialized.length;fr++)if(hr.specialized[fr]==or.value){let dr=hr.specializers[fr](this.stream.read(or.start,or.end),cr);if(dr>=0&&cr.p.parser.dialect.allows(dr>>1)){dr&1?or.extended=dr>>1:or.value=dr>>1;break}}}else or.value=0,or.end=this.stream.clipPos(ur+1)}putAction(or,ar,cr,ur){for(let hr=0;hr<ur;hr+=3)if(this.actions[hr]==or)return ur;return this.actions[ur++]=or,this.actions[ur++]=ar,this.actions[ur++]=cr,ur}addActions(or,ar,cr,ur){let{state:hr}=or,{parser:fr}=or.p,{data:dr}=fr;for(let pr=0;pr<2;pr++)for(let mr=fr.stateSlot(hr,pr?2:1);;mr+=3){if(dr[mr]==65535)if(dr[mr+1]==1)mr=pair(dr,mr+2);else{ur==0&&dr[mr+1]==2&&(ur=this.putAction(pair(dr,mr+2),ar,cr,ur));break}dr[mr]==ar&&(ur=this.putAction(pair(dr,mr+1),ar,cr,ur))}return ur}}class Parse{constructor(or,ar,cr,ur){this.parser=or,this.input=ar,this.ranges=ur,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new InputStream(ar,ur),this.tokens=new TokenCache(or,this.stream),this.topTerm=or.top[1];let{from:hr}=ur[0];this.stacks=[Stack.start(this,or.top[0],hr)],this.fragments=cr.length&&this.stream.end-hr>or.bufferLength*4?new FragmentCursor(cr,or.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let or=this.stacks,ar=this.minStackPos,cr=this.stacks=[],ur,hr;if(this.bigReductionCount>300&&or.length==1){let[fr]=or;for(;fr.forceReduce()&&fr.stack.length&&fr.stack[fr.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let fr=0;fr<or.length;fr++){let dr=or[fr];for(;;){if(this.tokens.mainToken=null,dr.pos>ar)cr.push(dr);else{if(this.advanceStack(dr,cr,or))continue;{ur||(ur=[],hr=[]),ur.push(dr);let pr=this.tokens.getMainToken(dr);hr.push(pr.value,pr.end)}}break}}if(!cr.length){let fr=ur&&findFinished(ur);if(fr)return verbose&&console.log("Finish with "+this.stackID(fr)),this.stackToTree(fr);if(this.parser.strict)throw verbose&&ur&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+ar);this.recovering||(this.recovering=5)}if(this.recovering&&ur){let fr=this.stoppedAt!=null&&ur[0].pos>this.stoppedAt?ur[0]:this.runRecovery(ur,hr,cr);if(fr)return verbose&&console.log("Force-finish "+this.stackID(fr)),this.stackToTree(fr.forceAll())}if(this.recovering){let fr=this.recovering==1?1:this.recovering*3;if(cr.length>fr)for(cr.sort((dr,pr)=>pr.score-dr.score);cr.length>fr;)cr.pop();cr.some(dr=>dr.reducePos>ar)&&this.recovering--}else if(cr.length>1){e:for(let fr=0;fr<cr.length-1;fr++){let dr=cr[fr];for(let pr=fr+1;pr<cr.length;pr++){let mr=cr[pr];if(dr.sameState(mr)||dr.buffer.length>500&&mr.buffer.length>500)if((dr.score-mr.score||dr.buffer.length-mr.buffer.length)>0)cr.splice(pr--,1);else{cr.splice(fr--,1);continue e}}}cr.length>12&&cr.splice(12,cr.length-12)}this.minStackPos=cr[0].pos;for(let fr=1;fr<cr.length;fr++)cr[fr].pos<this.minStackPos&&(this.minStackPos=cr[fr].pos);return null}stopAt(or){if(this.stoppedAt!=null&&this.stoppedAt<or)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=or}advanceStack(or,ar,cr){let ur=or.pos,{parser:hr}=this,fr=verbose?this.stackID(or)+" -> ":"";if(this.stoppedAt!=null&&ur>this.stoppedAt)return or.forceReduce()?or:null;if(this.fragments){let mr=or.curContext&&or.curContext.tracker.strict,gr=mr?or.curContext.hash:0;for(let yr=this.fragments.nodeAt(ur);yr;){let br=this.parser.nodeSet.types[yr.type.id]==yr.type?hr.getGoto(or.state,yr.type.id):-1;if(br>-1&&yr.length&&(!mr||(yr.prop(NodeProp.contextHash)||0)==gr))return or.useNode(yr,br),verbose&&console.log(fr+this.stackID(or)+` (via reuse of ${hr.getName(yr.type.id)})`),!0;if(!(yr instanceof Tree$1)||yr.children.length==0||yr.positions[0]>0)break;let Or=yr.children[0];if(Or instanceof Tree$1&&yr.positions[0]==0)yr=Or;else break}}let dr=hr.stateSlot(or.state,4);if(dr>0)return or.reduce(dr),verbose&&console.log(fr+this.stackID(or)+` (via always-reduce ${hr.getName(dr&65535)})`),!0;if(or.stack.length>=15e3)for(;or.stack.length>9e3&&or.forceReduce(););let pr=this.tokens.getActions(or);for(let mr=0;mr<pr.length;){let gr=pr[mr++],yr=pr[mr++],br=pr[mr++],Or=mr==pr.length||!cr,_r=Or?or:or.split();if(_r.apply(gr,yr,br),verbose&&console.log(fr+this.stackID(_r)+` (via ${gr&65536?`reduce of ${hr.getName(gr&65535)}`:"shift"} for ${hr.getName(yr)} @ ${ur}${_r==or?"":", split"})`),Or)return!0;_r.pos>ur?ar.push(_r):cr.push(_r)}return!1}advanceFully(or,ar){let cr=or.pos;for(;;){if(!this.advanceStack(or,null,null))return!1;if(or.pos>cr)return pushStackDedup(or,ar),!0}}runRecovery(or,ar,cr){let ur=null,hr=!1;for(let fr=0;fr<or.length;fr++){let dr=or[fr],pr=ar[fr<<1],mr=ar[(fr<<1)+1],gr=verbose?this.stackID(dr)+" -> ":"";if(dr.deadEnd&&(hr||(hr=!0,dr.restart(),verbose&&console.log(gr+this.stackID(dr)+" (restarted)"),this.advanceFully(dr,cr))))continue;let yr=dr.split(),br=gr;for(let Or=0;yr.forceReduce()&&Or<10&&(verbose&&console.log(br+this.stackID(yr)+" (via force-reduce)"),!this.advanceFully(yr,cr));Or++)verbose&&(br=this.stackID(yr)+" -> ");for(let Or of dr.recoverByInsert(pr))verbose&&console.log(gr+this.stackID(Or)+" (via recover-insert)"),this.advanceFully(Or,cr);this.stream.end>dr.pos?(mr==dr.pos&&(mr++,pr=0),dr.recoverByDelete(pr,mr),verbose&&console.log(gr+this.stackID(dr)+` (via recover-delete ${this.parser.getName(pr)})`),pushStackDedup(dr,cr)):(!ur||ur.score<dr.score)&&(ur=dr)}return ur}stackToTree(or){return or.close(),Tree$1.build({buffer:StackBufferCursor.create(or),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:or.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(or){let ar=(stackIDs||(stackIDs=new WeakMap)).get(or);return ar||stackIDs.set(or,ar=String.fromCodePoint(this.nextStackID++)),ar+or}}function pushStackDedup(lr,or){for(let ar=0;ar<or.length;ar++){let cr=or[ar];if(cr.pos==lr.pos&&cr.sameState(lr)){or[ar].score<lr.score&&(or[ar]=lr);return}}or.push(lr)}class Dialect{constructor(or,ar,cr){this.source=or,this.flags=ar,this.disabled=cr}allows(or){return!this.disabled||this.disabled[or]==0}}const id=lr=>lr;class ContextTracker{constructor(or){this.start=or.start,this.shift=or.shift||id,this.reduce=or.reduce||id,this.reuse=or.reuse||id,this.hash=or.hash||(()=>0),this.strict=or.strict!==!1}}class LRParser extends Parser{constructor(or){if(super(),this.wrappers=[],or.version!=14)throw new RangeError(`Parser version (${or.version}) doesn't match runtime version (14)`);let ar=or.nodeNames.split(" ");this.minRepeatTerm=ar.length;for(let dr=0;dr<or.repeatNodeCount;dr++)ar.push("");let cr=Object.keys(or.topRules).map(dr=>or.topRules[dr][1]),ur=[];for(let dr=0;dr<ar.length;dr++)ur.push([]);function hr(dr,pr,mr){ur[dr].push([pr,pr.deserialize(String(mr))])}if(or.nodeProps)for(let dr of or.nodeProps){let pr=dr[0];typeof pr=="string"&&(pr=NodeProp[pr]);for(let mr=1;mr<dr.length;){let gr=dr[mr++];if(gr>=0)hr(gr,pr,dr[mr++]);else{let yr=dr[mr+-gr];for(let br=-gr;br>0;br--)hr(dr[mr++],pr,yr);mr++}}}this.nodeSet=new NodeSet(ar.map((dr,pr)=>NodeType.define({name:pr>=this.minRepeatTerm?void 0:dr,id:pr,props:ur[pr],top:cr.indexOf(pr)>-1,error:pr==0,skipped:or.skippedNodes&&or.skippedNodes.indexOf(pr)>-1}))),or.propSources&&(this.nodeSet=this.nodeSet.extend(...or.propSources)),this.strict=!1,this.bufferLength=DefaultBufferLength;let fr=decodeArray(or.tokenData);this.context=or.context,this.specializerSpecs=or.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let dr=0;dr<this.specializerSpecs.length;dr++)this.specialized[dr]=this.specializerSpecs[dr].term;this.specializers=this.specializerSpecs.map(getSpecializer),this.states=decodeArray(or.states,Uint32Array),this.data=decodeArray(or.stateData),this.goto=decodeArray(or.goto),this.maxTerm=or.maxTerm,this.tokenizers=or.tokenizers.map(dr=>typeof dr=="number"?new TokenGroup(fr,dr):dr),this.topRules=or.topRules,this.dialects=or.dialects||{},this.dynamicPrecedences=or.dynamicPrecedences||null,this.tokenPrecTable=or.tokenPrec,this.termNames=or.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(or,ar,cr){let ur=new Parse(this,or,ar,cr);for(let hr of this.wrappers)ur=hr(ur,or,ar,cr);return ur}getGoto(or,ar,cr=!1){let ur=this.goto;if(ar>=ur[0])return-1;for(let hr=ur[ar+1];;){let fr=ur[hr++],dr=fr&1,pr=ur[hr++];if(dr&&cr)return pr;for(let mr=hr+(fr>>1);hr<mr;hr++)if(ur[hr]==or)return pr;if(dr)return-1}}hasAction(or,ar){let cr=this.data;for(let ur=0;ur<2;ur++)for(let hr=this.stateSlot(or,ur?2:1),fr;;hr+=3){if((fr=cr[hr])==65535)if(cr[hr+1]==1)fr=cr[hr=pair(cr,hr+2)];else{if(cr[hr+1]==2)return pair(cr,hr+2);break}if(fr==ar||fr==0)return pair(cr,hr+1)}return 0}stateSlot(or,ar){return this.states[or*6+ar]}stateFlag(or,ar){return(this.stateSlot(or,0)&ar)>0}validAction(or,ar){return!!this.allActions(or,cr=>cr==ar?!0:null)}allActions(or,ar){let cr=this.stateSlot(or,4),ur=cr?ar(cr):void 0;for(let hr=this.stateSlot(or,1);ur==null;hr+=3){if(this.data[hr]==65535)if(this.data[hr+1]==1)hr=pair(this.data,hr+2);else break;ur=ar(pair(this.data,hr+1))}return ur}nextStates(or){let ar=[];for(let cr=this.stateSlot(or,1);;cr+=3){if(this.data[cr]==65535)if(this.data[cr+1]==1)cr=pair(this.data,cr+2);else break;if(!(this.data[cr+2]&1)){let ur=this.data[cr+1];ar.some((hr,fr)=>fr&1&&hr==ur)||ar.push(this.data[cr],ur)}}return ar}configure(or){let ar=Object.assign(Object.create(LRParser.prototype),this);if(or.props&&(ar.nodeSet=this.nodeSet.extend(...or.props)),or.top){let cr=this.topRules[or.top];if(!cr)throw new RangeError(`Invalid top rule name ${or.top}`);ar.top=cr}return or.tokenizers&&(ar.tokenizers=this.tokenizers.map(cr=>{let ur=or.tokenizers.find(hr=>hr.from==cr);return ur?ur.to:cr})),or.specializers&&(ar.specializers=this.specializers.slice(),ar.specializerSpecs=this.specializerSpecs.map((cr,ur)=>{let hr=or.specializers.find(dr=>dr.from==cr.external);if(!hr)return cr;let fr=Object.assign(Object.assign({},cr),{external:hr.to});return ar.specializers[ur]=getSpecializer(fr),fr})),or.contextTracker&&(ar.context=or.contextTracker),or.dialect&&(ar.dialect=this.parseDialect(or.dialect)),or.strict!=null&&(ar.strict=or.strict),or.wrap&&(ar.wrappers=ar.wrappers.concat(or.wrap)),or.bufferLength!=null&&(ar.bufferLength=or.bufferLength),ar}hasWrappers(){return this.wrappers.length>0}getName(or){return this.termNames?this.termNames[or]:String(or<=this.maxNode&&this.nodeSet.types[or].name||or)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(or){let ar=this.dynamicPrecedences;return ar==null?0:ar[or]||0}parseDialect(or){let ar=Object.keys(this.dialects),cr=ar.map(()=>!1);if(or)for(let hr of or.split(" ")){let fr=ar.indexOf(hr);fr>=0&&(cr[fr]=!0)}let ur=null;for(let hr=0;hr<ar.length;hr++)if(!cr[hr])for(let fr=this.dialects[ar[hr]],dr;(dr=this.data[fr++])!=65535;)(ur||(ur=new Uint8Array(this.maxTerm+1)))[dr]=1;return new Dialect(or,cr,ur)}static deserialize(or){return new LRParser(or)}}function pair(lr,or){return lr[or]|lr[or+1]<<16}function findFinished(lr){let or=null;for(let ar of lr){let cr=ar.p.stoppedAt;(ar.pos==ar.p.stream.end||cr!=null&&ar.pos>cr)&&ar.p.parser.stateFlag(ar.state,2)&&(!or||or.score<ar.score)&&(or=ar)}return or}function getSpecializer(lr){if(lr.external){let or=lr.extend?1:0;return(ar,cr)=>lr.external(ar,cr)<<1|or}return lr.get}const scriptText=54,StartCloseScriptTag=1,styleText=55,StartCloseStyleTag=2,textareaText=56,StartCloseTextareaTag=3,EndTag=4,SelfClosingEndTag=5,StartTag=6,StartScriptTag=7,StartStyleTag=8,StartTextareaTag=9,StartSelfClosingTag=10,StartCloseTag=11,NoMatchStartCloseTag=12,MismatchedStartCloseTag=13,missingCloseTag=57,IncompleteCloseTag=14,commentContent$1=58,Element=20,TagName=22,Attribute=23,AttributeName=24,AttributeValue=26,UnquotedAttributeValue=27,ScriptText=28,StyleText=31,TextareaText=34,OpenTag=36,CloseTag=37,Dialect_noMatch=0,Dialect_selfClosing=1,selfClosers$1={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},closeOnOpen={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function nameChar(lr){return lr==45||lr==46||lr==58||lr>=65&&lr<=90||lr==95||lr>=97&&lr<=122||lr>=161}function isSpace(lr){return lr==9||lr==10||lr==13||lr==32}let cachedName=null,cachedInput=null,cachedPos=0;function tagNameAfter(lr,or){let ar=lr.pos+or;if(cachedPos==ar&&cachedInput==lr)return cachedName;let cr=lr.peek(or);for(;isSpace(cr);)cr=lr.peek(++or);let ur="";for(;nameChar(cr);)ur+=String.fromCharCode(cr),cr=lr.peek(++or);return cachedInput=lr,cachedPos=ar,cachedName=ur?ur.toLowerCase():cr==question||cr==bang?void 0:null}const lessThan=60,greaterThan=62,slash$1=47,question=63,bang=33,dash$1=45;function ElementContext(lr,or){this.name=lr,this.parent=or,this.hash=or?or.hash:0;for(let ar=0;ar<lr.length;ar++)this.hash+=(this.hash<<4)+lr.charCodeAt(ar)+(lr.charCodeAt(ar)<<8)}const startTagTerms=[StartTag,StartSelfClosingTag,StartScriptTag,StartStyleTag,StartTextareaTag],elementContext=new ContextTracker({start:null,shift(lr,or,ar,cr){return startTagTerms.indexOf(or)>-1?new ElementContext(tagNameAfter(cr,1)||"",lr):lr},reduce(lr,or){return or==Element&&lr?lr.parent:lr},reuse(lr,or,ar,cr){let ur=or.type.id;return ur==StartTag||ur==OpenTag?new ElementContext(tagNameAfter(cr,1)||"",lr):lr},hash(lr){return lr?lr.hash:0},strict:!1}),tagStart=new ExternalTokenizer((lr,or)=>{if(lr.next!=lessThan){lr.next<0&&or.context&&lr.acceptToken(missingCloseTag);return}lr.advance();let ar=lr.next==slash$1;ar&&lr.advance();let cr=tagNameAfter(lr,0);if(cr===void 0)return;if(!cr)return lr.acceptToken(ar?IncompleteCloseTag:StartTag);let ur=or.context?or.context.name:null;if(ar){if(cr==ur)return lr.acceptToken(StartCloseTag);if(ur&&implicitlyClosed[ur])return lr.acceptToken(missingCloseTag,-2);if(or.dialectEnabled(Dialect_noMatch))return lr.acceptToken(NoMatchStartCloseTag);for(let hr=or.context;hr;hr=hr.parent)if(hr.name==cr)return;lr.acceptToken(MismatchedStartCloseTag)}else{if(cr=="script")return lr.acceptToken(StartScriptTag);if(cr=="style")return lr.acceptToken(StartStyleTag);if(cr=="textarea")return lr.acceptToken(StartTextareaTag);if(selfClosers$1.hasOwnProperty(cr))return lr.acceptToken(StartSelfClosingTag);ur&&closeOnOpen[ur]&&closeOnOpen[ur][cr]?lr.acceptToken(missingCloseTag,-1):lr.acceptToken(StartTag)}},{contextual:!0}),commentContent=new ExternalTokenizer(lr=>{for(let or=0,ar=0;;ar++){if(lr.next<0){ar&&lr.acceptToken(commentContent$1);break}if(lr.next==dash$1)or++;else if(lr.next==greaterThan&&or>=2){ar>3&&lr.acceptToken(commentContent$1,-2);break}else or=0;lr.advance()}});function inForeignElement(lr){for(;lr;lr=lr.parent)if(lr.name=="svg"||lr.name=="math")return!0;return!1}const endTag=new ExternalTokenizer((lr,or)=>{if(lr.next==slash$1&&lr.peek(1)==greaterThan){let ar=or.dialectEnabled(Dialect_selfClosing)||inForeignElement(or.context);lr.acceptToken(ar?SelfClosingEndTag:EndTag,2)}else lr.next==greaterThan&&lr.acceptToken(EndTag,1)});function contentTokenizer(lr,or,ar){let cr=2+lr.length;return new ExternalTokenizer(ur=>{for(let hr=0,fr=0,dr=0;;dr++){if(ur.next<0){dr&&ur.acceptToken(or);break}if(hr==0&&ur.next==lessThan||hr==1&&ur.next==slash$1||hr>=2&&hr<cr&&ur.next==lr.charCodeAt(hr-2))hr++,fr++;else if((hr==2||hr==cr)&&isSpace(ur.next))fr++;else if(hr==cr&&ur.next==greaterThan){dr>fr?ur.acceptToken(or,-fr):ur.acceptToken(ar,-(fr-2));break}else if((ur.next==10||ur.next==13)&&dr){ur.acceptToken(or,1);break}else hr=fr=0;ur.advance()}})}const scriptTokens=contentTokenizer("script",scriptText,StartCloseScriptTag),styleTokens=contentTokenizer("style",styleText,StartCloseStyleTag),textareaTokens=contentTokenizer("textarea",textareaText,StartCloseTextareaTag),htmlHighlighting=styleTags({"Text RawText":tags$1.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":tags$1.angleBracket,TagName:tags$1.tagName,"MismatchedCloseTag/TagName":[tags$1.tagName,tags$1.invalid],AttributeName:tags$1.attributeName,"AttributeValue UnquotedAttributeValue":tags$1.attributeValue,Is:tags$1.definitionOperator,"EntityReference CharacterReference":tags$1.character,Comment:tags$1.blockComment,ProcessingInst:tags$1.processingInstruction,DoctypeDecl:tags$1.documentMeta}),parser$2=LRParser.deserialize({version:14,states:",xOVO!rOOO!WQ#tO'#CqO!]Q#tO'#CzO!bQ#tO'#C}O!gQ#tO'#DQO!lQ#tO'#DSO!qOaO'#CpO!|ObO'#CpO#XOdO'#CpO$eO!rO'#CpOOO`'#Cp'#CpO$lO$fO'#DTO$tQ#tO'#DVO$yQ#tO'#DWOOO`'#Dk'#DkOOO`'#DY'#DYQVO!rOOO%OQ&rO,59]O%WQ&rO,59fO%`Q&rO,59iO%hQ&rO,59lO%sQ&rO,59nOOOa'#D^'#D^O%{OaO'#CxO&WOaO,59[OOOb'#D_'#D_O&`ObO'#C{O&kObO,59[OOOd'#D`'#D`O&sOdO'#DOO'OOdO,59[OOO`'#Da'#DaO'WO!rO,59[O'_Q#tO'#DROOO`,59[,59[OOOp'#Db'#DbO'dO$fO,59oOOO`,59o,59oO'lQ#|O,59qO'qQ#|O,59rOOO`-E7W-E7WO'vQ&rO'#CsOOQW'#DZ'#DZO(UQ&rO1G.wOOOa1G.w1G.wO(^Q&rO1G/QOOOb1G/Q1G/QO(fQ&rO1G/TOOOd1G/T1G/TO(nQ&rO1G/WOOO`1G/W1G/WOOO`1G/Y1G/YO(yQ&rO1G/YOOOa-E7[-E7[O)RQ#tO'#CyOOO`1G.v1G.vOOOb-E7]-E7]O)WQ#tO'#C|OOOd-E7^-E7^O)]Q#tO'#DPOOO`-E7_-E7_O)bQ#|O,59mOOOp-E7`-E7`OOO`1G/Z1G/ZOOO`1G/]1G/]OOO`1G/^1G/^O)gQ,UO,59_OOQW-E7X-E7XOOOa7+$c7+$cOOOb7+$l7+$lOOOd7+$o7+$oOOO`7+$r7+$rOOO`7+$t7+$tO)rQ#|O,59eO)wQ#|O,59hO)|Q#|O,59kOOO`1G/X1G/XO*RO7[O'#CvO*dOMhO'#CvOOQW1G.y1G.yOOO`1G/P1G/POOO`1G/S1G/SOOO`1G/V1G/VOOOO'#D['#D[O*uO7[O,59bOOQW,59b,59bOOOO'#D]'#D]O+WOMhO,59bOOOO-E7Y-E7YOOQW1G.|1G.|OOOO-E7Z-E7Z",stateData:"+s~O!^OS~OUSOVPOWQOXROYTO[]O][O^^O`^Oa^Ob^Oc^Ox^O{_O!dZO~OfaO~OfbO~OfcO~OfdO~OfeO~O!WfOPlP!ZlP~O!XiOQoP!ZoP~O!YlORrP!ZrP~OUSOVPOWQOXROYTOZqO[]O][O^^O`^Oa^Ob^Oc^Ox^O!dZO~O!ZrO~P#dO![sO!euO~OfvO~OfwO~OS|OhyO~OS!OOhyO~OS!QOhyO~OS!SOT!TOhyO~OS!TOhyO~O!WfOPlX!ZlX~OP!WO!Z!XO~O!XiOQoX!ZoX~OQ!ZO!Z!XO~O!YlORrX!ZrX~OR!]O!Z!XO~O!Z!XO~P#dOf!_O~O![sO!e!aO~OS!bO~OS!cO~Oi!dOSgXhgXTgX~OS!fOhyO~OS!gOhyO~OS!hOhyO~OS!iOT!jOhyO~OS!jOhyO~Of!kO~Of!lO~Of!mO~OS!nO~Ok!qO!`!oO!b!pO~OS!rO~OS!sO~OS!tO~Oa!uOb!uOc!uO!`!wO!a!uO~Oa!xOb!xOc!xO!b!wO!c!xO~Oa!uOb!uOc!uO!`!{O!a!uO~Oa!xOb!xOc!xO!b!{O!c!xO~OT~bac!dx{!d~",goto:"%p!`PPPPPPPPPPPPPPPPPPPP!a!gP!mPP!yP!|#P#S#Y#]#`#f#i#l#r#x!aP!a!aP$O$U$l$r$x%O%U%[%bPPPPPPPP%hX^OX`pXUOX`pezabcde{}!P!R!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ}bQ!PcQ!RdQ!UeZ!e{}!P!R!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:"⚠ StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:67,context:elementContext,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,21,30,33,36,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,29,32,35,37,"OpenTag"],["group",-9,14,17,18,19,20,39,40,41,42,"Entity",16,"Entity TextContent",-3,28,31,34,"TextContent Entity"]],propSources:[htmlHighlighting],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|c`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bX`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UV`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pT`POv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!cpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({W`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!a`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!a`!cpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYkWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]``P!a`!cp!^^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebhSkWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXhSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vchS`P!a`!cpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!`h`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WihSkWc!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zbkWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOa!R!R7tP;=`<%l7S!Z8OYkWa!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{ihSkWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbhSkWa!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QchSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXhSa!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TakWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOb!R!RAwP;=`<%lAY!ZBRYkWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbhSkWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbhSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXhSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!bx`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYlhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_khS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_X`P!a`!cp!eQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZhSfQ`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!a`!cpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!a`!cp!dPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!a`!cpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!a`!cpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!a`!cpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!a`!cpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!a`!cpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!a`!cpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!a`!cpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!cpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO{PP!-nP;=`<%l!-Sq!-xS!cp{POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!a`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!a`{POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!a`!cp{POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!a`!cpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!a`!cpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!a`!cpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!a`!cpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!a`!cpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!a`!cpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!cpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOxPP!7TP;=`<%l!6Vq!7]V!cpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!cpxPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!a`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!a`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!a`xPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!a`!cpxPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXiS`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[scriptTokens,styleTokens,textareaTokens,endTag,tagStart,commentContent,0,1,2,3,4,5],topRules:{Document:[0,15]},dialects:{noMatch:0,selfClosing:485},tokenPrec:487});function getAttrs(lr,or){let ar=Object.create(null);for(let cr of lr.getChildren(Attribute)){let ur=cr.getChild(AttributeName),hr=cr.getChild(AttributeValue)||cr.getChild(UnquotedAttributeValue);ur&&(ar[or.read(ur.from,ur.to)]=hr?hr.type.id==AttributeValue?or.read(hr.from+1,hr.to-1):or.read(hr.from,hr.to):"")}return ar}function findTagName(lr,or){let ar=lr.getChild(TagName);return ar?or.read(ar.from,ar.to):" "}function maybeNest(lr,or,ar){let cr;for(let ur of ar)if(!ur.attrs||ur.attrs(cr||(cr=getAttrs(lr.node.parent.firstChild,or))))return{parser:ur.parser};return null}function configureNesting(lr=[],or=[]){let ar=[],cr=[],ur=[],hr=[];for(let dr of lr)(dr.tag=="script"?ar:dr.tag=="style"?cr:dr.tag=="textarea"?ur:hr).push(dr);let fr=or.length?Object.create(null):null;for(let dr of or)(fr[dr.name]||(fr[dr.name]=[])).push(dr);return parseMixed((dr,pr)=>{let mr=dr.type.id;if(mr==ScriptText)return maybeNest(dr,pr,ar);if(mr==StyleText)return maybeNest(dr,pr,cr);if(mr==TextareaText)return maybeNest(dr,pr,ur);if(mr==Element&&hr.length){let gr=dr.node,yr=gr.firstChild,br=yr&&findTagName(yr,pr),Or;if(br){for(let _r of hr)if(_r.tag==br&&(!_r.attrs||_r.attrs(Or||(Or=getAttrs(gr,pr))))){let vr=gr.lastChild;return{parser:_r.parser,overlay:[{from:yr.to,to:vr.type.id==CloseTag?vr.from:gr.to}]}}}}if(fr&&mr==Attribute){let gr=dr.node,yr;if(yr=gr.firstChild){let br=fr[pr.read(yr.from,yr.to)];if(br)for(let Or of br){if(Or.tagName&&Or.tagName!=findTagName(gr.parent,pr))continue;let _r=gr.lastChild;if(_r.type.id==AttributeValue){let vr=_r.from+1,xr=_r.lastChild,wr=_r.to-(xr&&xr.isError?0:1);if(wr>vr)return{parser:Or.parser,overlay:[{from:vr,to:wr}]}}else if(_r.type.id==UnquotedAttributeValue)return{parser:Or.parser,overlay:[{from:_r.from,to:_r.to}]}}}}return null})}const descendantOp=96,Unit=1,callee=97,identifier$2=98,VariableName=2,space$1=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],colon=58,parenL=40,underscore=95,bracketL=91,dash=45,period=46,hash=35,percent=37;function isAlpha(lr){return lr>=65&&lr<=90||lr>=97&&lr<=122||lr>=161}function isDigit(lr){return lr>=48&&lr<=57}const identifiers=new ExternalTokenizer((lr,or)=>{for(let ar=!1,cr=0,ur=0;;ur++){let{next:hr}=lr;if(isAlpha(hr)||hr==dash||hr==underscore||ar&&isDigit(hr))!ar&&(hr!=dash||ur>0)&&(ar=!0),cr===ur&&hr==dash&&cr++,lr.advance();else{ar&&lr.acceptToken(hr==parenL?callee:cr==2&&or.canShift(VariableName)?VariableName:identifier$2);break}}}),descendant=new ExternalTokenizer(lr=>{if(space$1.includes(lr.peek(-1))){let{next:or}=lr;(isAlpha(or)||or==underscore||or==hash||or==period||or==bracketL||or==colon||or==dash)&&lr.acceptToken(descendantOp)}}),unitToken=new ExternalTokenizer(lr=>{if(!space$1.includes(lr.peek(-1))){let{next:or}=lr;if(or==percent&&(lr.advance(),lr.acceptToken(Unit)),isAlpha(or)){do lr.advance();while(isAlpha(lr.next));lr.acceptToken(Unit)}}}),cssHighlighting=styleTags({"AtKeyword import charset namespace keyframes media supports":tags$1.definitionKeyword,"from to selector":tags$1.keyword,NamespaceName:tags$1.namespace,KeyframeName:tags$1.labelName,KeyframeRangeName:tags$1.operatorKeyword,TagName:tags$1.tagName,ClassName:tags$1.className,PseudoClassName:tags$1.constant(tags$1.className),IdName:tags$1.labelName,"FeatureName PropertyName":tags$1.propertyName,AttributeName:tags$1.attributeName,NumberLiteral:tags$1.number,KeywordQuery:tags$1.keyword,UnaryQueryOp:tags$1.operatorKeyword,"CallTag ValueName":tags$1.atom,VariableName:tags$1.variableName,Callee:tags$1.operatorKeyword,Unit:tags$1.unit,"UniversalSelector NestingSelector":tags$1.definitionOperator,MatchOp:tags$1.compareOperator,"ChildOp SiblingOp, LogicOp":tags$1.logicOperator,BinOp:tags$1.arithmeticOperator,Important:tags$1.modifier,Comment:tags$1.blockComment,ColorLiteral:tags$1.color,"ParenthesizedContent StringLiteral":tags$1.string,":":tags$1.punctuation,"PseudoOp #":tags$1.derefOperator,"; ,":tags$1.separator,"( )":tags$1.paren,"[ ]":tags$1.squareBracket,"{ }":tags$1.brace}),spec_callee={__proto__:null,lang:32,"nth-child":32,"nth-last-child":32,"nth-of-type":32,"nth-last-of-type":32,dir:32,"host-context":32,url:60,"url-prefix":60,domain:60,regexp:60,selector:134},spec_AtKeyword={__proto__:null,"@import":114,"@media":138,"@charset":142,"@namespace":146,"@keyframes":152,"@supports":164},spec_identifier$1={__proto__:null,not:128,only:128},parser$1=LRParser.deserialize({version:14,states:"9bQYQ[OOO#_Q[OOP#fOWOOOOQP'#Cd'#CdOOQP'#Cc'#CcO#kQ[O'#CfO$_QXO'#CaO$fQ[O'#ChO$qQ[O'#DPO$vQ[O'#DTOOQP'#Ej'#EjO${QdO'#DeO%gQ[O'#DrO${QdO'#DtO%xQ[O'#DvO&TQ[O'#DyO&]Q[O'#EPO&kQ[O'#EROOQS'#Ei'#EiOOQS'#EU'#EUQYQ[OOO&rQXO'#CdO'gQWO'#DaO'lQWO'#EpO'wQ[O'#EpQOQWOOP(RO#tO'#C_POOO)C@X)C@XOOQP'#Cg'#CgOOQP,59Q,59QO#kQ[O,59QO(^Q[O'#EXO(xQWO,58{O)QQ[O,59SO$qQ[O,59kO$vQ[O,59oO(^Q[O,59sO(^Q[O,59uO(^Q[O,59vO)]Q[O'#D`OOQS,58{,58{OOQP'#Ck'#CkOOQO'#C}'#C}OOQP,59S,59SO)dQWO,59SO)iQWO,59SOOQP'#DR'#DROOQP,59k,59kOOQO'#DV'#DVO)nQ`O,59oOOQS'#Cp'#CpO${QdO'#CqO)vQvO'#CsO+TQtO,5:POOQO'#Cx'#CxO)iQWO'#CwO+iQWO'#CyOOQS'#Em'#EmOOQO'#Dh'#DhO+nQ[O'#DoO+|QWO'#EqO&]Q[O'#DmO,[QWO'#DpOOQO'#Er'#ErO({QWO,5:^O,aQpO,5:`OOQS'#Dx'#DxO,iQWO,5:bO,nQ[O,5:bOOQO'#D{'#D{O,vQWO,5:eO,{QWO,5:kO-TQWO,5:mOOQS-E8S-E8SO${QdO,59{O-]Q[O'#EZO-jQWO,5;[O-jQWO,5;[POOO'#ET'#ETP-uO#tO,58yPOOO,58y,58yOOQP1G.l1G.lO.lQXO,5:sOOQO-E8V-E8VOOQS1G.g1G.gOOQP1G.n1G.nO)dQWO1G.nO)iQWO1G.nOOQP1G/V1G/VO.yQ`O1G/ZO/dQXO1G/_O/zQXO1G/aO0bQXO1G/bO0xQWO,59zO0}Q[O'#DOO1UQdO'#CoOOQP1G/Z1G/ZO${QdO1G/ZO1]QpO,59]OOQS,59_,59_O${QdO,59aO1eQWO1G/kOOQS,59c,59cO1jQ!bO,59eO1rQWO'#DhO1}QWO,5:TO2SQWO,5:ZO&]Q[O,5:VO&]Q[O'#E[O2[QWO,5;]O2gQWO,5:XO(^Q[O,5:[OOQS1G/x1G/xOOQS1G/z1G/zOOQS1G/|1G/|O2xQWO1G/|O2}QdO'#D|OOQS1G0P1G0POOQS1G0V1G0VOOQS1G0X1G0XO3YQtO1G/gOOQO,5:u,5:uO3pQ[O,5:uOOQO-E8X-E8XO3}QWO1G0vPOOO-E8R-E8RPOOO1G.e1G.eOOQP7+$Y7+$YOOQP7+$u7+$uO${QdO7+$uOOQS1G/f1G/fO4YQXO'#EoO4aQWO,59jO4fQtO'#EVO5ZQdO'#ElO5eQWO,59ZO5jQpO7+$uOOQS1G.w1G.wOOQS1G.{1G.{OOQS7+%V7+%VO5rQWO1G/PO${QdO1G/oOOQO1G/u1G/uOOQO1G/q1G/qO5wQWO,5:vOOQO-E8Y-E8YO6VQXO1G/vOOQS7+%h7+%hO6^QYO'#CsOOQO'#EO'#EOO6iQ`O'#D}OOQO'#D}'#D}O6tQWO'#E]O6|QdO,5:hOOQS,5:h,5:hO7XQtO'#EYO${QdO'#EYO8VQdO7+%ROOQO7+%R7+%ROOQO1G0a1G0aO8jQpO<<HaO8rQWO,5;ZOOQP1G/U1G/UOOQS-E8T-E8TO${QdO'#EWO8zQWO,5;WOOQT1G.u1G.uOOQP<<Ha<<HaOOQS7+$k7+$kO9SQdO7+%ZOOQO7+%b7+%bOOQO,5:i,5:iO3QQdO'#E^O6tQWO,5:wOOQS,5:w,5:wOOQS-E8Z-E8ZOOQS1G0S1G0SO9ZQtO,5:tOOQS-E8W-E8WOOQO<<Hm<<HmOOQPAN={AN={O:XQdO,5:rOOQO-E8U-E8UOOQO<<Hu<<HuOOQO,5:x,5:xOOQO-E8[-E8[OOQS1G0c1G0c",stateData:":k~O#WOS#XQQ~OUYOXYO]VO^VOtWOxXO!YaO!ZZO!g[O!i]O!k^O!n_O!t`O#URO#_TO~OQfOUYOXYO]VO^VOtWOxXO!YaO!ZZO!g[O!i]O!k^O!n_O!t`O#UeO#_TO~O#R#dP~P!ZO#XjO~O#UlO~O]qO^qOpoOtrOxsO|tO!PvO#SuO#_nO~O!RwO~P#pO`}O#TzO#UyO~O#U!OO~O#U!QO~OQ!ZOb!TOf!ZOh!ZOn!YO#T!WO#U!SO#b!UO~Ob!]O!b!_O!e!`O#U![O!R#eP~Oh!eOn!YO#U!dO~Oh!gO#U!gO~Ob!]O!b!_O!e!`O#U![O~O!W#eP~P%gO]WX]!UX^WXpWXtWXxWX|WX!PWX!RWX#SWX#_WX~O]!lO~O!W!mO#R#dX!Q#dX~O#R#dX!Q#dX~P!ZO#Y!pO#Z!pO#[!rO~OUYOXYO]VO^VOtWOxXO#URO#_TO~OpoO!RwO~O`!yO#TzO#UyO~O!Q#dP~P!ZOb#QO~Ob#RO~Ov#SOz#TO~OP#VObgXjgX!WgX!bgX!egX#UgXagXQgXfgXhgXngXpgX!VgX#RgX#TgX#bgXvgX!QgX~Ob!]Oj#WO!b!_O!e!`O#U![O!W#eP~Ob#ZO~Ob!]O!b!_O!e!`O#U#[O~Op#`O!`#_O!R#eX!W#eX~Ob#cO~Oj#WO!W#eO~O!W#fO~Oh#gOn!YO~O!R#hO~O!RwO!`#_O~O!RwO!W#kO~O!W!}X#R!}X!Q!}X~P!ZO!W!mO#R#da!Q#da~O#Y!pO#Z!pO#[#rO~O]qO^qOtrOxsO|tO!PvO#SuO#_nO~Op!{a!R!{aa!{a~P.QOv#tOz#uO~O]qO^qOtrOxsO#_nO~Op{i|{i!P{i!R{i#S{ia{i~P/ROp}i|}i!P}i!R}i#S}ia}i~P/ROp!Oi|!Oi!P!Oi!R!Oi#S!Oia!Oi~P/RO!Q#vO~Oa#cP~P(^Oa#`P~P${Oa#}Oj#WO~O!W$PO~Oh$QOo$QO~O]!^Xa![X!`![X~O]$RO~Oa$SO!`#_O~Op#`O!R#ea!W#ea~O!`#_Op!aa!R!aa!W!aaa!aa~O!W$XO~O!Q$`O#U$ZO#b$YO~Oj#WOp$bO!V$dO!W!Ti#R!Ti!Q!Ti~P${O!W!}a#R!}a!Q!}a~P!ZO!W!mO#R#di!Q#di~Oa#cX~P#pOa$hO~Oj#WOQ!yXa!yXb!yXf!yXh!yXn!yXp!yX#T!yX#U!yX#b!yX~Op$jOa#`X~P${Oa$lO~Oj#WOv$mO~Oa$nO~O!`#_Op#Oa!R#Oa!W#Oa~Oa$pO~P.QOP#VOpgX!RgX~O#b$YOp!qX!R!qX~Op$rO!RwO~O!Q$vO#U$ZO#b$YO~Oj#WOQ!|Xb!|Xf!|Xh!|Xn!|Xp!|X!V!|X!W!|X#R!|X#T!|X#U!|X#b!|X!Q!|X~Op$bO!V$yO!W!Tq#R!Tq!Q!Tq~P${Oj#WOv$zO~OpoOa#ca~Op$jOa#`a~Oa$}O~P${Oj#WOQ!|ab!|af!|ah!|an!|ap!|a!V!|a!W!|a#R!|a#T!|a#U!|a#b!|a!Q!|a~Oa!zap!za~P${O#Wo#X#bj!P#b~",goto:"-Y#gPPP#hP#kP#t$TP#t$d#tPP$jPPP$p$y$yP%]P$yP$y%w&ZPPP&s&y#tP'PP#tP'VP#tP#t#tPPP']'r(PPP#kPP(W(W(b(WP(WP(W(WP#kP#kP#kP(e#kP(h(k(n(u#kP#kP(z)Q)a)o)u*P*V*a*g*mPPPPPPPPPP*s*|P+i+lP,b,e,k,tRkQ_bOPdhw!m#nkYOPdhotuvw!m#Q#c#nkSOPdhotuvw!m#Q#c#nQmTR!snQ{VR!wqQ!w}Q#Y!XR#s!yq!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${p!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${U$]#h$_$rR$q$[q!XZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${p!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${Q!e^R#g!fQ|VR!xqQ!w|R#s!xQ!PWR!zrQ!RXR!{sQxUQ!vpQ#d!bQ#j!iQ#k!jQ$t$^R%Q$sSgPwQ!ohQ#m!mR$e#nZfPhw!m#na!a[`a!V!]!_#_#`R#]!]R!f^R!h_R#i!hS$^#h$_R%O$rV$[#h$_$rQ!qjR#q!qQdOShPwU!kdh#nR#n!mQ#z#RU$i#z$o${Q$o$RR${$jQ$k#zR$|$kQpUS!up$gR$g#wQ$c#lR$x$cQ!ngS#o!n#pR#p!oQ#a!^R$V#aQ$_#hR$u$_Q$s$^R%P$s_cOPdhw!m#n^UOPdhw!m#nQ!toQ!|tQ!}uQ#OvQ#w#QR$W#cR#{#RQ!VZQ!c]Q#U!TQ#l!l[#y#R#z$R$j$o${Q#|#TQ$O#WS$a#l$cQ$f#uR$w$bR#x#QQiPR#PwQ!b[Q!jaR#X!VU!^[a!VQ!i`Q#^!]Q#b!_Q$T#_R$U#`",nodeNames:"⚠ Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent , PseudoClassName ArgList IdSelector # IdName ] AttributeSelector [ AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports AtRule Styles",maxTerm:114,nodeProps:[["openedBy",17,"(",48,"{"],["closedBy",18,")",49,"}"]],propSources:[cssHighlighting],skippedNodes:[0,3,85],repeatNodeCount:10,tokenData:"J^~R!^OX$}X^%u^p$}pq%uqr)Xrs.Rst/utu6duv$}vw7^wx7oxy9^yz9oz{9t{|:_|}?Q}!O?c!O!P@Q!P!Q@i!Q![Ab![!]B]!]!^CX!^!_$}!_!`Cj!`!aC{!a!b$}!b!cDw!c!}$}!}#OFa#O#P$}#P#QFr#Q#R6d#R#T$}#T#UGT#U#c$}#c#dHf#d#o$}#o#pH{#p#q6d#q#rI^#r#sIo#s#y$}#y#z%u#z$f$}$f$g%u$g#BY$}#BY#BZ%u#BZ$IS$}$IS$I_%u$I_$I|$}$I|$JO%u$JO$JT$}$JT$JU%u$JU$KV$}$KV$KW%u$KW&FU$}&FU&FV%u&FV;'S$};'S;=`JW<%lO$}`%QSOy%^z;'S%^;'S;=`%o<%lO%^`%cSo`Oy%^z;'S%^;'S;=`%o<%lO%^`%rP;=`<%l%^~%zh#W~OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^~'mh#W~o`OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^l)[UOy%^z#]%^#]#^)n#^;'S%^;'S;=`%o<%lO%^l)sUo`Oy%^z#a%^#a#b*V#b;'S%^;'S;=`%o<%lO%^l*[Uo`Oy%^z#d%^#d#e*n#e;'S%^;'S;=`%o<%lO%^l*sUo`Oy%^z#c%^#c#d+V#d;'S%^;'S;=`%o<%lO%^l+[Uo`Oy%^z#f%^#f#g+n#g;'S%^;'S;=`%o<%lO%^l+sUo`Oy%^z#h%^#h#i,V#i;'S%^;'S;=`%o<%lO%^l,[Uo`Oy%^z#T%^#T#U,n#U;'S%^;'S;=`%o<%lO%^l,sUo`Oy%^z#b%^#b#c-V#c;'S%^;'S;=`%o<%lO%^l-[Uo`Oy%^z#h%^#h#i-n#i;'S%^;'S;=`%o<%lO%^l-uS!V[o`Oy%^z;'S%^;'S;=`%o<%lO%^~.UWOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o<%lO.R~.sOh~~.vRO;'S.R;'S;=`/P;=`O.R~/SXOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o;=`<%l.R<%lO.R~/rP;=`<%l.Rn/zYtQOy%^z!Q%^!Q![0j![!c%^!c!i0j!i#T%^#T#Z0j#Z;'S%^;'S;=`%o<%lO%^l0oYo`Oy%^z!Q%^!Q![1_![!c%^!c!i1_!i#T%^#T#Z1_#Z;'S%^;'S;=`%o<%lO%^l1dYo`Oy%^z!Q%^!Q![2S![!c%^!c!i2S!i#T%^#T#Z2S#Z;'S%^;'S;=`%o<%lO%^l2ZYf[o`Oy%^z!Q%^!Q![2y![!c%^!c!i2y!i#T%^#T#Z2y#Z;'S%^;'S;=`%o<%lO%^l3QYf[o`Oy%^z!Q%^!Q![3p![!c%^!c!i3p!i#T%^#T#Z3p#Z;'S%^;'S;=`%o<%lO%^l3uYo`Oy%^z!Q%^!Q![4e![!c%^!c!i4e!i#T%^#T#Z4e#Z;'S%^;'S;=`%o<%lO%^l4lYf[o`Oy%^z!Q%^!Q![5[![!c%^!c!i5[!i#T%^#T#Z5[#Z;'S%^;'S;=`%o<%lO%^l5aYo`Oy%^z!Q%^!Q![6P![!c%^!c!i6P!i#T%^#T#Z6P#Z;'S%^;'S;=`%o<%lO%^l6WSf[o`Oy%^z;'S%^;'S;=`%o<%lO%^d6gUOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^d7QSzSo`Oy%^z;'S%^;'S;=`%o<%lO%^b7cSXQOy%^z;'S%^;'S;=`%o<%lO%^~7rWOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W<%lO7o~8_RO;'S7o;'S;=`8h;=`O7o~8kXOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W;=`<%l7o<%lO7o~9ZP;=`<%l7on9cSb^Oy%^z;'S%^;'S;=`%o<%lO%^~9tOa~n9{UUQjWOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^n:fWjW!PQOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^l;TUo`Oy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^l;nYo`#b[Oy%^z!Q%^!Q![;g![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^l<cYo`Oy%^z{%^{|=R|}%^}!O=R!O!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=WUo`Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=qUo`#b[Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l>[[o`#b[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^n?VSp^Oy%^z;'S%^;'S;=`%o<%lO%^l?hWjWOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^n@VU#_QOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^~@nTjWOy%^z{@}{;'S%^;'S;=`%o<%lO%^~AUSo`#X~Oy%^z;'S%^;'S;=`%o<%lO%^lAg[#b[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^bBbU]QOy%^z![%^![!]Bt!];'S%^;'S;=`%o<%lO%^bB{S^Qo`Oy%^z;'S%^;'S;=`%o<%lO%^nC^S!W^Oy%^z;'S%^;'S;=`%o<%lO%^dCoSzSOy%^z;'S%^;'S;=`%o<%lO%^bDQU|QOy%^z!`%^!`!aDd!a;'S%^;'S;=`%o<%lO%^bDkS|Qo`Oy%^z;'S%^;'S;=`%o<%lO%^bDzWOy%^z!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bEk[!YQo`Oy%^z}%^}!OEd!O!Q%^!Q![Ed![!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bFfSxQOy%^z;'S%^;'S;=`%o<%lO%^lFwSv[Oy%^z;'S%^;'S;=`%o<%lO%^bGWUOy%^z#b%^#b#cGj#c;'S%^;'S;=`%o<%lO%^bGoUo`Oy%^z#W%^#W#XHR#X;'S%^;'S;=`%o<%lO%^bHYS!`Qo`Oy%^z;'S%^;'S;=`%o<%lO%^bHiUOy%^z#f%^#f#gHR#g;'S%^;'S;=`%o<%lO%^fIQS!RUOy%^z;'S%^;'S;=`%o<%lO%^nIcS!Q^Oy%^z;'S%^;'S;=`%o<%lO%^fItU!PQOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^`JZP;=`<%l$}",tokenizers:[descendant,unitToken,identifiers,1,2,3,4,new LocalTokenGroup("m~RRYZ[z{a~~g~aO#Z~~dP!P!Qg~lO#[~~",28,102)],topRules:{StyleSheet:[0,4],Styles:[1,84]},specialized:[{term:97,get:lr=>spec_callee[lr]||-1},{term:56,get:lr=>spec_AtKeyword[lr]||-1},{term:98,get:lr=>spec_identifier$1[lr]||-1}],tokenPrec:1169});let _properties=null;function properties(){if(!_properties&&typeof document=="object"&&document.body){let{style:lr}=document.body,or=[],ar=new Set;for(let cr in lr)cr!="cssText"&&cr!="cssFloat"&&typeof lr[cr]=="string"&&(/[A-Z]/.test(cr)&&(cr=cr.replace(/[A-Z]/g,ur=>"-"+ur.toLowerCase())),ar.has(cr)||(or.push(cr),ar.add(cr)));_properties=or.sort().map(cr=>({type:"property",label:cr}))}return _properties||[]}const pseudoClasses=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(lr=>({type:"class",label:lr})),values=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(lr=>({type:"keyword",label:lr})).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(lr=>({type:"constant",label:lr}))),tags=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(lr=>({type:"type",label:lr})),identifier$1=/^(\w[\w-]*|-\w[\w-]*|)$/,variable=/^-(-[\w-]*)?$/;function isVarArg(lr,or){var ar;if((lr.name=="("||lr.type.isError)&&(lr=lr.parent||lr),lr.name!="ArgList")return!1;let cr=(ar=lr.parent)===null||ar===void 0?void 0:ar.firstChild;return(cr==null?void 0:cr.name)!="Callee"?!1:or.sliceString(cr.from,cr.to)=="var"}const VariablesByNode=new NodeWeakMap,declSelector=["Declaration"];function astTop(lr){for(let or=lr;;){if(or.type.isTop)return or;if(!(or=or.parent))return lr}}function variableNames(lr,or,ar){if(or.to-or.from>4096){let cr=VariablesByNode.get(or);if(cr)return cr;let ur=[],hr=new Set,fr=or.cursor(IterMode.IncludeAnonymous);if(fr.firstChild())do for(let dr of variableNames(lr,fr.node,ar))hr.has(dr.label)||(hr.add(dr.label),ur.push(dr));while(fr.nextSibling());return VariablesByNode.set(or,ur),ur}else{let cr=[],ur=new Set;return or.cursor().iterate(hr=>{var fr;if(ar(hr)&&hr.matchContext(declSelector)&&((fr=hr.node.nextSibling)===null||fr===void 0?void 0:fr.name)==":"){let dr=lr.sliceString(hr.from,hr.to);ur.has(dr)||(ur.add(dr),cr.push({label:dr,type:"variable"}))}}),cr}}const defineCSSCompletionSource=lr=>or=>{let{state:ar,pos:cr}=or,ur=syntaxTree(ar).resolveInner(cr,-1),hr=ur.type.isError&&ur.from==ur.to-1&&ar.doc.sliceString(ur.from,ur.to)=="-";if(ur.name=="PropertyName"||(hr||ur.name=="TagName")&&/^(Block|Styles)$/.test(ur.resolve(ur.to).name))return{from:ur.from,options:properties(),validFor:identifier$1};if(ur.name=="ValueName")return{from:ur.from,options:values,validFor:identifier$1};if(ur.name=="PseudoClassName")return{from:ur.from,options:pseudoClasses,validFor:identifier$1};if(lr(ur)||(or.explicit||hr)&&isVarArg(ur,ar.doc))return{from:lr(ur)||hr?ur.from:cr,options:variableNames(ar.doc,astTop(ur),lr),validFor:variable};if(ur.name=="TagName"){for(let{parent:pr}=ur;pr;pr=pr.parent)if(pr.name=="Block")return{from:ur.from,options:properties(),validFor:identifier$1};return{from:ur.from,options:tags,validFor:identifier$1}}if(!or.explicit)return null;let fr=ur.resolve(cr),dr=fr.childBefore(cr);return dr&&dr.name==":"&&fr.name=="PseudoClassSelector"?{from:cr,options:pseudoClasses,validFor:identifier$1}:dr&&dr.name==":"&&fr.name=="Declaration"||fr.name=="ArgList"?{from:cr,options:values,validFor:identifier$1}:fr.name=="Block"||fr.name=="Styles"?{from:cr,options:properties(),validFor:identifier$1}:null},cssCompletionSource=defineCSSCompletionSource(lr=>lr.name=="VariableName"),cssLanguage=LRLanguage.define({name:"css",parser:parser$1.configure({props:[indentNodeProp.add({Declaration:continuedIndent()}),foldNodeProp.add({"Block KeyframeList":foldInside})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function css(){return new LanguageSupport(cssLanguage,cssLanguage.data.of({autocomplete:cssCompletionSource}))}const noSemi=304,incdec=1,incdecPrefix=2,insertSemi=305,spaces=307,newline=308,LineComment=3,BlockComment=4,space=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],braceR=125,semicolon=59,slash=47,star=42,plus=43,minus=45,trackNewline=new ContextTracker({start:!1,shift(lr,or){return or==LineComment||or==BlockComment||or==spaces?lr:or==newline},strict:!1}),insertSemicolon=new ExternalTokenizer((lr,or)=>{let{next:ar}=lr;(ar==braceR||ar==-1||or.context)&&lr.acceptToken(insertSemi)},{contextual:!0,fallback:!0}),noSemicolon=new ExternalTokenizer((lr,or)=>{let{next:ar}=lr,cr;space.indexOf(ar)>-1||ar==slash&&((cr=lr.peek(1))==slash||cr==star)||ar!=braceR&&ar!=semicolon&&ar!=-1&&!or.context&&lr.acceptToken(noSemi)},{contextual:!0}),incdecToken=new ExternalTokenizer((lr,or)=>{let{next:ar}=lr;if((ar==plus||ar==minus)&&(lr.advance(),ar==lr.next)){lr.advance();let cr=!or.context&&or.canShift(incdec);lr.acceptToken(cr?incdec:incdecPrefix)}},{contextual:!0}),jsHighlight=styleTags({"get set async static":tags$1.modifier,"for while do if else switch try catch finally return throw break continue default case":tags$1.controlKeyword,"in of await yield void typeof delete instanceof":tags$1.operatorKeyword,"let var const function class extends":tags$1.definitionKeyword,"import export from":tags$1.moduleKeyword,"with debugger as new":tags$1.keyword,TemplateString:tags$1.special(tags$1.string),super:tags$1.atom,BooleanLiteral:tags$1.bool,this:tags$1.self,null:tags$1.null,Star:tags$1.modifier,VariableName:tags$1.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":tags$1.function(tags$1.variableName),VariableDefinition:tags$1.definition(tags$1.variableName),Label:tags$1.labelName,PropertyName:tags$1.propertyName,PrivatePropertyName:tags$1.special(tags$1.propertyName),"CallExpression/MemberExpression/PropertyName":tags$1.function(tags$1.propertyName),"FunctionDeclaration/VariableDefinition":tags$1.function(tags$1.definition(tags$1.variableName)),"ClassDeclaration/VariableDefinition":tags$1.definition(tags$1.className),PropertyDefinition:tags$1.definition(tags$1.propertyName),PrivatePropertyDefinition:tags$1.definition(tags$1.special(tags$1.propertyName)),UpdateOp:tags$1.updateOperator,"LineComment Hashbang":tags$1.lineComment,BlockComment:tags$1.blockComment,Number:tags$1.number,String:tags$1.string,Escape:tags$1.escape,ArithOp:tags$1.arithmeticOperator,LogicOp:tags$1.logicOperator,BitOp:tags$1.bitwiseOperator,CompareOp:tags$1.compareOperator,RegExp:tags$1.regexp,Equals:tags$1.definitionOperator,Arrow:tags$1.function(tags$1.punctuation),": Spread":tags$1.punctuation,"( )":tags$1.paren,"[ ]":tags$1.squareBracket,"{ }":tags$1.brace,"InterpolationStart InterpolationEnd":tags$1.special(tags$1.brace),".":tags$1.derefOperator,", ;":tags$1.separator,"@":tags$1.meta,TypeName:tags$1.typeName,TypeDefinition:tags$1.definition(tags$1.typeName),"type enum interface implements namespace module declare":tags$1.definitionKeyword,"abstract global Privacy readonly override":tags$1.modifier,"is keyof unique infer":tags$1.operatorKeyword,JSXAttributeValue:tags$1.attributeValue,JSXText:tags$1.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":tags$1.angleBracket,"JSXIdentifier JSXNameSpacedName":tags$1.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":tags$1.attributeName,"JSXBuiltin/JSXIdentifier":tags$1.standard(tags$1.tagName)}),spec_identifier={__proto__:null,export:16,as:21,from:29,default:32,async:37,function:38,extends:48,this:52,true:60,false:60,null:72,void:76,typeof:80,super:98,new:132,delete:148,yield:157,await:161,class:166,public:223,private:223,protected:223,readonly:225,instanceof:244,satisfies:247,in:248,const:250,import:282,keyof:337,unique:341,infer:347,is:383,abstract:403,implements:405,type:407,let:410,var:412,using:415,interface:421,enum:425,namespace:431,module:433,declare:437,global:441,for:460,of:469,while:472,with:476,do:480,if:484,else:486,switch:490,case:496,try:502,catch:506,finally:510,return:514,throw:518,break:522,continue:526,debugger:530},spec_word={__proto__:null,async:119,get:121,set:123,declare:183,public:185,private:185,protected:185,static:187,abstract:189,override:191,readonly:197,accessor:199,new:387},spec_LessThan={__proto__:null,"<":139},parser=LRParser.deserialize({version:14,states:"$6zO%TQUOOO%[QUOOO'_QWOOP(lOSOOO*zQ(CjO'#CgO+ROpO'#ChO+aO!bO'#ChO+oO07`O'#D[O.QQUO'#DbO.bQUO'#DmO%[QUO'#DwO0fQUO'#EPOOQ(CY'#EX'#EXO1PQSO'#EUOOQO'#Ej'#EjOOQO'#Id'#IdO1XQSO'#GlO1dQSO'#EiO1iQSO'#EiO3kQ(CjO'#JeO6[Q(CjO'#JfO6xQSO'#FXO6}Q#tO'#FpOOQ(CY'#Fa'#FaO7YO&jO'#FaO7hQ,UO'#FwO9OQSO'#FvOOQ(CY'#Jf'#JfOOQ(CW'#Je'#JeO9TQSO'#GpOOQQ'#KQ'#KQO9`QSO'#IQO9eQ(C[O'#IROOQQ'#JR'#JROOQQ'#IV'#IVQ`QUOOO`QUOOO%[QUO'#DoO9mQUO'#D{O9tQUO'#D}O9ZQSO'#GlO9{Q,UO'#CmO:ZQSO'#EhO:fQSO'#EsO:kQ,UO'#F`O;YQSO'#GlOOQO'#KR'#KRO;_QSO'#KRO;mQSO'#GtO;mQSO'#GuO;mQSO'#GwO9ZQSO'#GzO<dQSO'#G}O={QSO'#CcO>]QSO'#HZO>eQSO'#HaO>eQSO'#HcO`QUO'#HeO>eQSO'#HgO>eQSO'#HjO>jQSO'#HpO>oQ(C]O'#HvO%[QUO'#HxO>zQ(C]O'#HzO?VQ(C]O'#H|O9eQ(C[O'#IOO?bQ(CjO'#CgO@dQWO'#DgQOQSOOO%[QUO'#D}O@zQSO'#EQO9{Q,UO'#EhOAVQSO'#EhOAbQ`O'#F`OOQQ'#Ce'#CeOOQ(CW'#Dl'#DlOOQ(CW'#Ji'#JiO%[QUO'#JiOOQO'#Jm'#JmOOQO'#Ia'#IaOBbQWO'#EaOOQ(CW'#E`'#E`OC^Q(C`O'#EaOChQWO'#ETOOQO'#Jl'#JlOC|QWO'#JmOEZQWO'#ETOChQWO'#EaPEhO?MpO'#C`POOO)CDp)CDpOOOO'#IW'#IWOEsOpO,59SOOQ(CY,59S,59SOOOO'#IX'#IXOFRO!bO,59SO%[QUO'#D^OOOO'#IZ'#IZOFaO07`O,59vOOQ(CY,59v,59vOFoQUO'#I[OGSQSO'#JgOIUQbO'#JgO+}QUO'#JgOI]QSO,59|OIsQSO'#EjOJQQSO'#JuOJ]QSO'#JtOJ]QSO'#JtOJeQSO,5;WOJjQSO'#JsOOQ(CY,5:X,5:XOJqQUO,5:XOLrQ(CjO,5:cOMcQSO,5:kOM|Q(C[O'#JrONTQSO'#JqO9TQSO'#JqONiQSO'#JqONqQSO,5;VONvQSO'#JqO!#OQbO'#JfOOQ(CY'#Cg'#CgO%[QUO'#EPO!#nQ`O,5:pOOQO'#Jn'#JnOOQO-E<b-E<bO9ZQSO,5=WO!$UQSO,5=WO!$ZQUO,5;TO!&^Q,UO'#EeO!'qQSO,5;TO!)ZQ,UO'#DqO!)bQUO'#DvO!)lQWO,5;^O!)tQWO,5;^O%[QUO,5;^OOQQ'#FP'#FPOOQQ'#FR'#FRO%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_OOQQ'#FV'#FVO!*SQUO,5;pOOQ(CY,5;u,5;uOOQ(CY,5;v,5;vO!,VQSO,5;vOOQ(CY,5;w,5;wO%[QUO'#IhO!,_Q(C[O,5<dO!&^Q,UO,5;_O!,|Q,UO,5;_O%[QUO,5;sO!-TQ#tO'#FfO!.QQ#tO'#JyO!-lQ#tO'#JyO!.XQ#tO'#JyOOQO'#Jy'#JyO!.mQ#tO,5<OOOOO,5<[,5<[O!/OQUO'#FrOOOO'#Ig'#IgO7YO&jO,5;{O!/VQ#tO'#FtOOQ(CY,5;{,5;{O!/vQ7[O'#CsOOQ(CY'#Cw'#CwO!0ZQSO'#CwO!0`O07`O'#C{O!0|Q,UO,5<aO!1TQSO,5<cO!2jQMhO'#GRO!2wQSO'#GSO!2|QSO'#GSO!3RQMhO'#GWO!4QQWO'#G[O!4sQ7[O'#J`OOQ(CY'#J`'#J`O!4}QSO'#J_O!5]QSO'#J^O!5eQSO'#CrOOQ(CY'#Cu'#CuOOQ(CY'#DP'#DPOOQ(CY'#DR'#DRO1SQSO'#DTO!'vQ,UO'#FyO!'vQ,UO'#F{O!5mQSO'#F}O!5rQSO'#GOO!2|QSO'#GUO!'vQ,UO'#GZO!5wQSO'#EkO!6fQSO,5<bOOQ(CW'#Cp'#CpO!6nQSO'#ElO!7hQWO'#EmOOQ(CW'#Js'#JsO!7oQ(C[O'#KSO9eQ(C[O,5=[O`QUO,5>lOOQQ'#JZ'#JZOOQQ,5>m,5>mOOQQ-E<T-E<TO!9qQ(CjO,5:ZO!<_Q(CjO,5:gO%[QUO,5:gO!>xQ(CjO,5:iOOQO,5@m,5@mO!?iQ,UO,5=WO!?wQ(C[O'#J[O9OQSO'#J[O!@YQ(C[O,59XO!@eQWO,59XO!@mQ,UO,59XO9{Q,UO,59XO!@xQSO,5;TO!AQQSO'#HYO!AcQSO'#KVO%[QUO,5;xO!7cQWO,5;zO!AkQSO,5=sO!ApQSO,5=sO!AuQSO,5=sO9eQ(C[O,5=sO;mQSO,5=cOOQO'#Cs'#CsO!BTQWO,5=`O!B]Q,UO,5=aO!BhQSO,5=cO!BmQ`O,5=fO!BuQSO'#KRO>jQSO'#HPO9ZQSO'#HRO!BzQSO'#HRO9{Q,UO'#HTO!CPQSO'#HTOOQQ,5=i,5=iO!CUQSO'#HUO!C^QSO'#CmO!CcQSO,58}O!CmQSO,58}O!ErQUO,58}OOQQ,58},58}O!FSQ(C[O,58}O%[QUO,58}O!H_QUO'#H]OOQQ'#H^'#H^OOQQ'#H_'#H_O`QUO,5=uO!HuQSO,5=uO`QUO,5={O`QUO,5=}O!HzQSO,5>PO`QUO,5>RO!IPQSO,5>UO!IUQUO,5>[OOQQ,5>b,5>bO%[QUO,5>bO9eQ(C[O,5>dOOQQ,5>f,5>fO!M`QSO,5>fOOQQ,5>h,5>hO!M`QSO,5>hOOQQ,5>j,5>jO!MeQWO'#DYO%[QUO'#JiO!NSQWO'#JiO!NqQWO'#DhO# SQWO'#DhO##eQUO'#DhO##lQSO'#JhO##tQSO,5:RO##yQSO'#EnO#$XQSO'#JvO#$aQSO,5;XO#$fQWO'#DhO#$sQWO'#ESOOQ(CY,5:l,5:lO%[QUO,5:lO#$zQSO,5:lO>jQSO,5;SO!@eQWO,5;SO!@mQ,UO,5;SO9{Q,UO,5;SO#%SQSO,5@TO#%XQ!LQO,5:pOOQO-E<_-E<_O#&_Q(C`O,5:{OChQWO,5:oO#&iQWO,5:oOChQWO,5:{O!@YQ(C[O,5:oOOQ(CW'#Ed'#EdOOQO,5:{,5:{O%[QUO,5:{O#&vQ(C[O,5:{O#'RQ(C[O,5:{O!@eQWO,5:oOOQO,5;R,5;RO#'aQ(C[O,5:{POOO'#IU'#IUP#'uO?MpO,58zPOOO,58z,58zOOOO-E<U-E<UOOQ(CY1G.n1G.nOOOO-E<V-E<VO#(QQ`O,59xOOOO-E<X-E<XOOQ(CY1G/b1G/bO#(VQbO,5>vO+}QUO,5>vOOQO,5>|,5>|O#(aQUO'#I[OOQO-E<Y-E<YO#(nQSO,5@RO#(vQbO,5@RO#(}QSO,5@`OOQ(CY1G/h1G/hO%[QUO,5@aO#)VQSO'#IbOOQO-E<`-E<`O#(}QSO,5@`OOQ(CW1G0r1G0rOOQ(CY1G/s1G/sOOQ(CY1G0V1G0VO%[QUO,5@^O#)kQ(C[O,5@^O#)|Q(C[O,5@^O#*TQSO,5@]O9TQSO,5@]O#*]QSO,5@]O#*kQSO'#IeO#*TQSO,5@]OOQ(CW1G0q1G0qO!)lQWO,5:rO!)wQWO,5:rOOQO,5:t,5:tO#+]QSO,5:tO#+eQ,UO1G2rO9ZQSO1G2rOOQ(CY1G0o1G0oO#+sQ(CjO1G0oO#,xQ(ChO,5;POOQ(CY'#GQ'#GQO#-fQ(CjO'#J`O!$ZQUO1G0oO#/nQ,UO'#JjO#/xQSO,5:]O#/}QbO'#JkO%[QUO'#JkO#0XQSO,5:bOOQ(CY'#DY'#DYOOQ(CY1G0x1G0xO%[QUO1G0xOOQ(CY1G1b1G1bO#0^QSO1G0xO#2uQ(CjO1G0yO#2|Q(CjO1G0yO#5gQ(CjO1G0yO#5nQ(CjO1G0yO#7xQ(CjO1G0yO#8`Q(CjO1G0yO#;YQ(CjO1G0yO#;aQ(CjO1G0yO#=zQ(CjO1G0yO#>RQ(CjO1G0yO#?yQ(CjO1G0yO#ByQ$IUO'#CgO#DwQ$IUO1G1[O#EOQ$IUO'#JfO!,YQSO1G1bO#E`Q(CjO,5?SOOQ(CW-E<f-E<fO#FSQ(CjO1G0yOOQ(CY1G0y1G0yO#H_Q(CjO1G1_O#IRQ#tO,5<SO#IZQ#tO,5<TO#IcQ#tO'#FkO#IzQSO'#FjOOQO'#Jz'#JzOOQO'#If'#IfO#JPQ#tO1G1jOOQ(CY1G1j1G1jOOOO1G1u1G1uO#JbQ$IUO'#JeO#JlQSO,5<^O!*SQUO,5<^OOOO-E<e-E<eOOQ(CY1G1g1G1gO#JqQWO'#JyOOQ(CY,5<`,5<`O#JyQWO,5<`OOQ(CY,59c,59cO!&^Q,UO'#C}OOOO'#IY'#IYO#KOO07`O,59gOOQ(CY,59g,59gO%[QUO1G1{O!5rQSO'#IjO#KZQ,UO,5<tOOQ(CY,5<q,5<qOOQO'#Gg'#GgO!'vQ,UO,5=QOOQO'#Gi'#GiO!'vQ,UO,5=SO!&^Q,UO,5=UOOQO1G1}1G1}O#KbQ`O'#CpO#KuQ`O,5<mO#K|QSO'#J}O9ZQSO'#J}O#L[QSO,5<oO!'vQ,UO,5<nO#LaQSO'#GTO#LlQSO,5<nO#LqQ`O'#GQO#MOQ`O'#KOO#MYQSO'#KOO!&^Q,UO'#KOO#M_QSO,5<rO#MdQWO'#G]O!3{QWO'#G]O#MuQSO'#G_O#MzQSO'#GaO!2|QSO'#GdO#NPQ(C[O'#IlO#N[QWO,5<vOOQ(CY,5<v,5<vO#NcQWO'#G]O#NqQWO'#G^O#NyQWO'#G^OOQ(CY,5=V,5=VO!'vQ,UO,5?yO!'vQ,UO,5?yO$ OQSO'#ImO$ ZQSO,5?xO$ cQSO,59^O$!SQ,UO,59oOOQ(CY,59o,59oO$!uQ,UO,5<eO$#hQ,UO,5<gO@[QSO,5<iOOQ(CY,5<j,5<jO$#rQSO,5<pO$#wQ,UO,5<uO$$XQSO'#JqO!$ZQUO1G1|O$$^QSO1G1|O9TQSO'#JtO9TQSO'#EnO%[QUO'#EnO9TQSO'#IoO$$cQ(C[O,5@nOOQQ1G2v1G2vOOQQ1G4W1G4WOOQ(CY1G/u1G/uO!,VQSO1G/uO$&hQ(CjO1G0ROOQQ1G2r1G2rO!&^Q,UO1G2rO%[QUO1G2rO$'XQSO1G2rO$'dQ,UO'#EeOOQ(CW,5?v,5?vO$'nQ(C[O,5?vOOQQ1G.s1G.sO!@YQ(C[O1G.sO!@eQWO1G.sO!@mQ,UO1G.sO$(PQSO1G0oO$(UQSO'#CgO$(aQSO'#KWO$(iQSO,5=tO$(nQSO'#KWO$(sQSO'#KWO$)OQSO'#IuO$)^QSO,5@qO$)fQbO1G1dOOQ(CY1G1f1G1fO9ZQSO1G3_O@[QSO1G3_O$)mQSO1G3_O$)rQSO1G3_OOQQ1G3_1G3_O!BhQSO1G2}O!&^Q,UO1G2zO$)wQSO1G2zOOQQ1G2{1G2{O!&^Q,UO1G2{O$)|QSO1G2{O$*UQWO'#GyOOQQ1G2}1G2}O!3{QWO'#IqO!BmQ`O1G3QOOQQ1G3Q1G3QOOQQ,5=k,5=kO$*^Q,UO,5=mO9ZQSO,5=mO#MzQSO,5=oO9OQSO,5=oO!@eQWO,5=oO!@mQ,UO,5=oO9{Q,UO,5=oO$*lQSO'#KUO$*wQSO,5=pOOQQ1G.i1G.iO$*|Q(C[O1G.iO@[QSO1G.iO$+XQSO1G.iO9eQ(C[O1G.iO$-^QbO,5@sO$-nQSO,5@sO9TQSO,5@sO$-yQUO,5=wO$.QQSO,5=wOOQQ1G3a1G3aO`QUO1G3aOOQQ1G3g1G3gOOQQ1G3i1G3iO>eQSO1G3kO$.VQUO1G3mO$2ZQUO'#HlOOQQ1G3p1G3pO$2hQSO'#HrO>jQSO'#HtOOQQ1G3v1G3vO$2pQUO1G3vO9eQ(C[O1G3|OOQQ1G4O1G4OOOQ(CW'#GX'#GXO9eQ(C[O1G4QO9eQ(C[O1G4SO$6wQSO,5@TO!*SQUO,5;YO9TQSO,5;YO>jQSO,5:SO!*SQUO,5:SO!@eQWO,5:SO$6|Q$IUO,5:SOOQO,5;Y,5;YO$7WQWO'#I]O$7nQSO,5@SOOQ(CY1G/m1G/mO$7vQWO'#IcO$8QQSO,5@bOOQ(CW1G0s1G0sO# SQWO,5:SOOQO'#I`'#I`O$8YQWO,5:nOOQ(CY,5:n,5:nO#$}QSO1G0WOOQ(CY1G0W1G0WO%[QUO1G0WOOQ(CY1G0n1G0nO>jQSO1G0nO!@eQWO1G0nO!@mQ,UO1G0nOOQ(CW1G5o1G5oO!@YQ(C[O1G0ZOOQO1G0g1G0gO%[QUO1G0gO$8aQ(C[O1G0gO$8lQ(C[O1G0gO!@eQWO1G0ZOChQWO1G0ZO$8zQ(C[O1G0gOOQO1G0Z1G0ZO$9`Q(CjO1G0gPOOO-E<S-E<SPOOO1G.f1G.fOOOO1G/d1G/dO$9jQ`O,5<dO$9rQbO1G4bOOQO1G4h1G4hO%[QUO,5>vO$9|QSO1G5mO$:UQSO1G5zO$:^QbO1G5{O9TQSO,5>|O$:hQ(CjO1G5xO%[QUO1G5xO$:xQ(C[O1G5xO$;ZQSO1G5wO$;ZQSO1G5wO9TQSO1G5wO$;cQSO,5?PO9TQSO,5?POOQO,5?P,5?PO$;wQSO,5?PO$$XQSO,5?POOQO-E<c-E<cOOQO1G0^1G0^OOQO1G0`1G0`O!,YQSO1G0`OOQQ7+(^7+(^O!&^Q,UO7+(^O%[QUO7+(^O$<VQSO7+(^O$<bQ,UO7+(^O$<pQ(CjO,59oO$>xQ(CjO,5<eO$ATQ(CjO,5<gO$C`Q(CjO,5<uOOQ(CY7+&Z7+&ZO$EqQ(CjO7+&ZO$FeQ,UO'#I^O$FoQSO,5@UOOQ(CY1G/w1G/wO$FwQUO'#I_O$GUQSO,5@VO$G^QbO,5@VOOQ(CY1G/|1G/|O$GhQSO7+&dOOQ(CY7+&d7+&dO$GmQ$IUO,5:cO%[QUO7+&vO$GwQ$IUO,5:ZO$HUQ$IUO,5:gO$H`Q$IUO,5:iOOQ(CY7+&|7+&|OOQO1G1n1G1nOOQO1G1o1G1oO$HjQ#tO,5<VO!*SQUO,5<UOOQO-E<d-E<dOOQ(CY7+'U7+'UOOOO7+'a7+'aOOOO1G1x1G1xO$HuQSO1G1xOOQ(CY1G1z1G1zO$HzQ`O,59iOOOO-E<W-E<WOOQ(CY1G/R1G/RO$IRQ(CjO7+'gOOQ(CY,5?U,5?UO$IuQ`O,5?UOOQ(CY1G2`1G2`P!&^Q,UO'#IjPOQ(CY-E<h-E<hO$JeQ,UO1G2lO$KWQ,UO1G2nO$KbQ`O1G2pOOQ(CY1G2X1G2XO$KiQSO'#IiO$KwQSO,5@iO$KwQSO,5@iO$LPQSO,5@iO$L[QSO,5@iOOQO1G2Z1G2ZO$LjQ,UO1G2YO!'vQ,UO1G2YO$LzQMhO'#IkO$M[QSO,5@jO!&^Q,UO,5@jO$MdQ`O,5@jOOQ(CY1G2^1G2^OOQ(CW,5<w,5<wOOQ(CW,5<x,5<xO$$XQSO,5<xOCXQSO,5<xO!@eQWO,5<wOOQO'#G`'#G`O$MnQSO,5<yOOQ(CW,5<{,5<{O$$XQSO,5=OOOQO,5?W,5?WOOQO-E<j-E<jOOQ(CY1G2b1G2bO!3{QWO,5<wO$MvQSO,5<xO#MuQSO,5<yO!3{QWO,5<xO$NRQ,UO1G5eO$N]Q,UO1G5eOOQO,5?X,5?XOOQO-E<k-E<kOOQO1G.x1G.xO!7cQWO,59qO%[QUO,59qO$NjQSO1G2TO!'vQ,UO1G2[O$NoQ(CjO7+'hOOQ(CY7+'h7+'hO!$ZQUO7+'hO% cQSO,5;YOOQ(CW,5?Z,5?ZOOQ(CW-E<m-E<mOOQ(CY7+%a7+%aO% hQ`O'#KPO#$}QSO7+(^O% rQbO7+(^O$<YQSO7+(^O% yQ(ChO'#CgO%!^Q(ChO,5<|O%#OQSO,5<|OOQ(CW1G5b1G5bOOQQ7+$_7+$_O!@YQ(C[O7+$_O!@eQWO7+$_O!$ZQUO7+&ZO%#TQSO'#ItO%#iQSO,5@rOOQO1G3`1G3`O9ZQSO,5@rO%#iQSO,5@rO%#qQSO,5@rOOQO,5?a,5?aOOQO-E<s-E<sOOQ(CY7+'O7+'OO%#vQSO7+(yO9eQ(C[O7+(yO9ZQSO7+(yO@[QSO7+(yOOQQ7+(i7+(iO%#{Q(ChO7+(fO!&^Q,UO7+(fO%$VQ`O7+(gOOQQ7+(g7+(gO!&^Q,UO7+(gO%$^QSO'#KTO%$iQSO,5=eOOQO,5?],5?]OOQO-E<o-E<oOOQQ7+(l7+(lO%%xQWO'#HSOOQQ1G3X1G3XO!&^Q,UO1G3XO%[QUO1G3XO%&PQSO1G3XO%&[Q,UO1G3XO9eQ(C[O1G3ZO#MzQSO1G3ZO9OQSO1G3ZO!@eQWO1G3ZO!@mQ,UO1G3ZO%&jQSO'#IsO%&uQSO,5@pO%&}QWO,5@pOOQ(CW1G3[1G3[OOQQ7+$T7+$TO@[QSO7+$TO9eQ(C[O7+$TO%'YQSO7+$TO%[QUO1G6_O%[QUO1G6`O%'_Q(C[O1G6_O%'iQUO1G3cO%'pQSO1G3cO%'uQUO1G3cOOQQ7+({7+({O9eQ(C[O7+)VO`QUO7+)XOOQQ'#KZ'#KZOOQQ'#Iv'#IvO%'|QUO,5>WOOQQ,5>W,5>WO%[QUO'#HmO%(ZQSO'#HoOOQQ,5>^,5>^O9TQSO,5>^OOQQ,5>`,5>`OOQQ7+)b7+)bOOQQ7+)h7+)hOOQQ7+)l7+)lOOQQ7+)n7+)nO%(`QWO1G5oO%(tQ$IUO1G0tO%)OQSO1G0tOOQO1G/n1G/nO%)ZQ$IUO1G/nO>jQSO1G/nO!*SQUO'#DhOOQO,5>w,5>wOOQO-E<Z-E<ZOOQO,5>},5>}OOQO-E<a-E<aO!@eQWO1G/nOOQO-E<^-E<^OOQ(CY1G0Y1G0YOOQ(CY7+%r7+%rO#$}QSO7+%rOOQ(CY7+&Y7+&YO>jQSO7+&YO!@eQWO7+&YOOQO7+%u7+%uO$9`Q(CjO7+&ROOQO7+&R7+&RO%[QUO7+&RO%)eQ(C[O7+&RO!@YQ(C[O7+%uO!@eQWO7+%uO%)pQ(C[O7+&RO%*OQ(CjO7++dO%[QUO7++dO%*`QSO7++cO%*`QSO7++cOOQO1G4k1G4kO9TQSO1G4kO%*hQSO1G4kOOQO7+%z7+%zO#$}QSO<<KxO% rQbO<<KxO%*vQSO<<KxOOQQ<<Kx<<KxO!&^Q,UO<<KxO%[QUO<<KxO%+OQSO<<KxO%+ZQ(CjO1G2lO%-fQ(CjO1G2nO%/qQ(CjO1G2YO%2SQ,UO,5>xOOQO-E<[-E<[O%2^QbO,5>yO%[QUO,5>yOOQO-E<]-E<]O%2hQSO1G5qOOQ(CY<<JO<<JOO%2pQ$IUO1G0oO%4zQ$IUO1G0yO%5RQ$IUO1G0yO%7VQ$IUO1G0yO%7^Q$IUO1G0yO%9RQ$IUO1G0yO%9iQ$IUO1G0yO%;|Q$IUO1G0yO%<TQ$IUO1G0yO%>XQ$IUO1G0yO%>`Q$IUO1G0yO%@WQ$IUO1G0yO%@kQ(CjO<<JbO%ApQ$IUO1G0yO%CfQ$IUO'#J`O%EiQ$IUO1G1_O%EvQ$IUO1G0RO!*SQUO'#FmOOQO'#J{'#J{OOQO1G1q1G1qO%FQQSO1G1pO%FVQ$IUO,5?SOOOO7+'d7+'dOOOO1G/T1G/TOOQ(CY1G4p1G4pO!'vQ,UO7+([O%FaQSO,5?TO9ZQSO,5?TOOQO-E<g-E<gO%FoQSO1G6TO%FoQSO1G6TO%FwQSO1G6TO%GSQ,UO7+'tO%GdQ`O,5?VO%GnQSO,5?VO!&^Q,UO,5?VOOQO-E<i-E<iO%GsQ`O1G6UO%G}QSO1G6UOOQ(CW1G2d1G2dO$$XQSO1G2dOOQ(CW1G2c1G2cO%HVQSO1G2eO!&^Q,UO1G2eOOQ(CW1G2j1G2jO!@eQWO1G2cOCXQSO1G2dO%H[QSO1G2eO%HdQSO1G2dO!'vQ,UO7++POOQ(CY1G/]1G/]O%HoQSO1G/]OOQ(CY7+'o7+'oO%HtQ,UO7+'vO%IUQ(CjO<<KSOOQ(CY<<KS<<KSO%IxQSO1G0tO!&^Q,UO'#InO%I}QSO,5@kO!&^Q,UO1G2hOOQQ<<Gy<<GyO!@YQ(C[O<<GyO%JVQ(CjO<<IuOOQ(CY<<Iu<<IuOOQO,5?`,5?`O%JyQSO,5?`O$(sQSO,5?`OOQO-E<r-E<rO%KOQSO1G6^O%KOQSO1G6^O9ZQSO1G6^O@[QSO<<LeOOQQ<<Le<<LeO%KWQSO<<LeO9eQ(C[O<<LeOOQQ<<LQ<<LQO%#{Q(ChO<<LQOOQQ<<LR<<LRO%$VQ`O<<LRO%K]QWO'#IpO%KhQSO,5@oO!*SQUO,5@oOOQQ1G3P1G3PO%KpQUO'#JiOOQO'#Ir'#IrO9eQ(C[O'#IrO%KzQWO,5=nOOQQ,5=n,5=nO%LRQWO'#EaO%LgQSO7+(sO%LlQSO7+(sOOQQ7+(s7+(sO!&^Q,UO7+(sO%[QUO7+(sO%LtQSO7+(sOOQQ7+(u7+(uO9eQ(C[O7+(uO#MzQSO7+(uO9OQSO7+(uO!@eQWO7+(uO%MPQSO,5?_OOQO-E<q-E<qOOQO'#HV'#HVO%M[QSO1G6[O9eQ(C[O<<GoOOQQ<<Go<<GoO@[QSO<<GoO%MdQSO7++yO%MiQSO7++zO%[QUO7++yO%[QUO7++zOOQQ7+(}7+(}O%MnQSO7+(}O%MsQUO7+(}O%MzQSO7+(}OOQQ<<Lq<<LqOOQQ<<Ls<<LsOOQQ-E<t-E<tOOQQ1G3r1G3rO%NPQSO,5>XOOQQ,5>Z,5>ZO%NUQSO1G3xO9TQSO7+&`O!*SQUO7+&`OOQO7+%Y7+%YO%NZQ$IUO1G5{O>jQSO7+%YOOQ(CY<<I^<<I^OOQ(CY<<It<<ItO>jQSO<<ItOOQO<<Im<<ImO$9`Q(CjO<<ImO%[QUO<<ImOOQO<<Ia<<IaO!@YQ(C[O<<IaO%NeQ(C[O<<ImO%NpQ(CjO<= OO& QQSO<<N}OOQO7+*V7+*VO9TQSO7+*VOOQQANAdANAdO& YQSOANAdO!&^Q,UOANAdO#$}QSOANAdO% rQbOANAdO%[QUOANAdO& bQ(CjO7+'tO&#sQ(CjO7+'vO&&UQbO1G4eO&&`Q$IUO7+&ZO&&mQ$IUO,59oO&(pQ$IUO,5<eO&*sQ$IUO,5<gO&,vQ$IUO,5<uO&.lQ$IUO7+'gO&.yQ$IUO7+'hO&/WQSO,5<XOOQO7+'[7+'[O&/]Q,UO<<KvOOQO1G4o1G4oO&/dQSO1G4oO&/oQSO1G4oO&/}QSO7++oO&/}QSO7++oO!&^Q,UO1G4qO&0VQ`O1G4qO&0aQSO7++pOOQ(CW7+(O7+(OO$$XQSO7+(PO&0iQ`O7+(POOQ(CW7+'}7+'}O$$XQSO7+(OO&0pQSO7+(PO!&^Q,UO7+(POCXQSO7+(OO&0uQ,UO<<NkOOQ(CY7+$w7+$wO&1PQ`O,5?YOOQO-E<l-E<lO&1ZQ(ChO7+(SOOQQAN=eAN=eO9ZQSO1G4zOOQO1G4z1G4zO&1kQSO1G4zO&1pQSO7++xO&1pQSO7++xO9eQ(C[OANBPO@[QSOANBPOOQQANBPANBPOOQQANAlANAlOOQQANAmANAmO&1xQSO,5?[OOQO-E<n-E<nO&2TQ$IUO1G6ZO&4eQbO'#CgOOQO,5?^,5?^OOQO-E<p-E<pOOQQ1G3Y1G3YO%KpQUO,5<yOOQQ<<L_<<L_O!&^Q,UO<<L_O%LgQSO<<L_O&4oQSO<<L_O%[QUO<<L_OOQQ<<La<<LaO9eQ(C[O<<LaO#MzQSO<<LaO9OQSO<<LaO&4wQWO1G4yO&5SQSO7++vOOQQAN=ZAN=ZO9eQ(C[OAN=ZOOQQ<= e<= eOOQQ<= f<= fO&5[QSO<= eO&5aQSO<= fOOQQ<<Li<<LiO&5fQSO<<LiO&5kQUO<<LiOOQQ1G3s1G3sO>jQSO7+)dO&5rQSO<<IzO&5}Q$IUO<<IzOOQO<<Ht<<HtOOQ(CYAN?`AN?`OOQOAN?XAN?XO$9`Q(CjOAN?XOOQOAN>{AN>{O%[QUOAN?XOOQO<<Mq<<MqOOQQG27OG27OO!&^Q,UOG27OO#$}QSOG27OO&6XQSOG27OO% rQbOG27OO&6aQ$IUO<<JbO&6nQ$IUO1G2YO&8dQ$IUO1G2lO&:gQ$IUO1G2nO&<jQ$IUO<<KSO&<wQ$IUO<<IuOOQO1G1s1G1sO!'vQ,UOANAbOOQO7+*Z7+*ZO&=UQSO7+*ZO&=aQSO<= ZO&=iQ`O7+*]OOQ(CW<<Kk<<KkO$$XQSO<<KkOOQ(CW<<Kj<<KjO&=sQ`O<<KkO$$XQSO<<KjOOQO7+*f7+*fO9ZQSO7+*fO&=zQSO<= dOOQQG27kG27kO9eQ(C[OG27kO!*SQUO1G4vO&>SQSO7++uO%LgQSOANAyOOQQANAyANAyO!&^Q,UOANAyO&>[QSOANAyOOQQANA{ANA{O9eQ(C[OANA{O#MzQSOANA{OOQO'#HW'#HWOOQO7+*e7+*eOOQQG22uG22uOOQQANEPANEPOOQQANEQANEQOOQQANBTANBTO&>dQSOANBTOOQQ<<MO<<MOO!*SQUOAN?fOOQOG24sG24sO$9`Q(CjOG24sO#$}QSOLD,jOOQQLD,jLD,jO!&^Q,UOLD,jO&>iQSOLD,jO&>qQ$IUO7+'tO&@gQ$IUO7+'vO&B]Q,UOG26|OOQO<<Mu<<MuOOQ(CWANAVANAVO$$XQSOANAVOOQ(CWANAUANAUOOQO<<NQ<<NQOOQQLD-VLD-VO&BmQ$IUO7+*bOOQQG27eG27eO%LgQSOG27eO!&^Q,UOG27eOOQQG27gG27gO9eQ(C[OG27gOOQQG27oG27oO&BwQ$IUOG25QOOQOLD*_LD*_OOQQ!$(!U!$(!UO#$}QSO!$(!UO!&^Q,UO!$(!UO&CRQ(CjOG26|OOQ(CWG26qG26qOOQQLD-PLD-PO%LgQSOLD-POOQQLD-RLD-ROOQQ!)9Ep!)9EpO#$}QSO!)9EpOOQQ!$(!k!$(!kOOQQ!.K;[!.K;[O&EdQ$IUOG26|O!*SQUO'#DwO1PQSO'#EUO&GYQbO'#JeO!*SQUO'#DoO&GaQUO'#D{O&GhQbO'#CgO&JOQbO'#CgO!*SQUO'#D}O&J`QUO,5;TO!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO'#IhO&LcQSO,5<dO&LkQ,UO,5;_O&NOQ,UO,5;_O!*SQUO,5;sO1SQSO'#DTO1SQSO'#DTO!&^Q,UO'#FyO&LkQ,UO'#FyO!&^Q,UO'#F{O&LkQ,UO'#F{O!&^Q,UO'#GZO&LkQ,UO'#GZO!*SQUO,5:gO!*SQUO,5@aO&J`QUO1G0oO&NVQ$IUO'#CgO!*SQUO1G1{O!&^Q,UO,5=QO&LkQ,UO,5=QO!&^Q,UO,5=SO&LkQ,UO,5=SO!&^Q,UO,5<nO&LkQ,UO,5<nO&J`QUO1G1|O!*SQUO7+&vO!&^Q,UO1G2YO&LkQ,UO1G2YO!&^Q,UO1G2[O&LkQ,UO1G2[O&J`QUO7+'hO&J`QUO7+&ZO!&^Q,UOANAbO&LkQ,UOANAbO&NaQSO'#EiO&NfQSO'#EiO&NnQSO'#FXO&NsQSO'#EsO&NxQSO'#JuO' TQSO'#JsO' `QSO,5;TO' eQ,UO,5<aO' lQSO'#GSO' qQSO'#GSO' vQSO,5<bO'!OQSO,5;TO'!WQ$IUO1G1[O'!_QSO,5<nO'!dQSO,5<nO'!iQSO,5<pO'!nQSO,5<pO'!sQSO1G1|O'!xQSO1G0oO'!}Q,UO<<KvO'#UQ,UO<<KvO7hQ,UO'#FwO9OQSO'#FvOAVQSO'#EhO!*SQUO,5;pO!2|QSO'#GSO!2|QSO'#GSO!2|QSO'#GUO!2|QSO'#GUO!'vQ,UO7+([O!'vQ,UO7+([O$KbQ`O1G2pO$KbQ`O1G2pO!&^Q,UO,5=UO!&^Q,UO,5=U",stateData:"'$_~O'oOS'pOSROS'qRQ~OPYOQYOW!VO_qObzOcyOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!YXO!duO!iZO!lYO!mYO!nYO!pvO!rwO!uxO!y]O#q!PO$R|O$VfO%a}O%c!QO%e!OO%f!OO%g!OO%j!RO%l!SO%o!TO%p!TO%r!UO&O!WO&U!XO&W!YO&Y!ZO&[![O&_!]O&e!^O&k!_O&m!`O&o!aO&q!bO&s!cO'vSO'xTO'{UO(TVO(c[O(piO~OUtO~P`OPYOQYOb!jOc!iOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!Y!eO!duO!iZO!lYO!mYO!nYO!pvO!r!gO!u!hO$R!kO$VfO'v!dO'xTO'{UO(TVO(c[O(piO~O_!vOm!nO}!oO!]!xO!^!uO!_!uO!y9rO!}!pO#O!pO#P!wO#Q!pO#R!pO#U!yO#V!yO'w!lO'xTO'{UO(W!mO(c!sO~O'q!zO~OPZXYZX_ZXlZXzZX{ZX}ZX!WZX!fZX!gZX!iZX!mZX#YZX#edX#hZX#iZX#jZX#kZX#lZX#mZX#nZX#oZX#pZX#rZX#tZX#vZX#wZX#|ZX'mZX(TZX(dZX(kZX(lZX~O!b${X~P(qO]!|O'x#OO'y!|O'z#OO~O]#PO'z#OO'{#OO'|#PO~Or#RO!P#SO(U#SO(V#UO~OPYOQYOb!jOc!iOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!Y!eO!duO!iZO!lYO!mYO!nYO!pvO!r!gO!u!hO$R!kO$VfO'v9vO'xTO'{UO(TVO(c[O(piO~O!V#YO!W#VO!T(ZP!T(hP~P+}O!X#bO~P`OPYOQYOb!jOc!iOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!Y!eO!duO!iZO!lYO!mYO!nYO!pvO!r!gO!u!hO$R!kO$VfO'xTO'{UO(TVO(c[O(piO~Oj#lO!V#hO!y]O#c#kO#d#hO'v9wO!h(eP~P.iO!i#nO'v#mO~O!u#rO!y]O%a#sO~O#e#tO~O!b#uO#e#tO~OP$]OY$dOl$QOz#yO{#zO}#{O!W$aO!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO#v$XO#w$YO(TVO(d$ZO(k#|O(l#}O~O_(XX'm(XX'k(XX!h(XX!T(XX!Y(XX%b(XX!b(XX~P1qO#Y$eO#|$eOP(YXY(YXl(YXz(YX{(YX}(YX!W(YX!f(YX!i(YX!m(YX#h(YX#i(YX#j(YX#k(YX#l(YX#m(YX#n(YX#o(YX#p(YX#r(YX#t(YX#v(YX#w(YX(T(YX(d(YX(k(YX(l(YX!Y(YX%b(YX~O_(YX!g(YX'm(YX'k(YX!T(YX!h(YXp(YX!b(YX~P4XO#Y$eO~O$X$gO$Z$fO$b$lO~O!Y$mO$VfO$e$nO$g$pO~Oj%SOl$tOm$sOn$sOt%TOv%UOx%VO}${O!Y$|O!d%[O!i$xO#d%]O$R%YO$n%WO$p%XO$s%ZO'v$rO'xTO'{UO(P%RO(T$uOe(QP~O!i%^O~O}%aO!Y%bO'v%`O~O!b%fO~O_%gO'm%gO~O'w!lO~P%[O%g%nO~P%[O!i%^O'v%`O'w!lO(P%RO~Oc%uO!i%^O'v%`O~O#p$SO~Oz%zO!Y%wO!i%yO%c%}O'v%`O'w!lO'xTO'{UO^(yP~O!u#rO~O%l&PO}(uX!Y(uX'v(uX~O'v&QO~O!r&VO#q!PO%c!QO%e!OO%f!OO%g!OO%j!RO%l!SO%o!TO%p!TO~Ob&[Oc&ZO!u&XO%a&YO%t&WO~P;rOb&_OcyO!Y&^O!r&VO!uxO!y]O#q!PO%a}O%e!OO%f!OO%g!OO%j!RO%l!SO%o!TO%p!TO%r!UO~O`&bO#Y&eO%c&`O'w!lO~P<wO!i&fO!r&jO~O!i#nO~O!YXO~O_%gO'l&rO'm%gO~O_%gO'l&uO'm%gO~O_%gO'l&wO'm%gO~O'kZX!TZXpZX!hZX&SZX!YZX%bZX!bZX~P(qO!]'UO!^&}O!_&}O'w!lO'xTO'{UO~Om&{O}&zO!V'OO(W&yO!X([P!X(jP~P@OOh'XO!Y'VO'v%`O~Oc'^O!i%^O'v%`O~Oz%zO!i%yO~Om!nO}!oO!y9rO!}!pO#O!pO#Q!pO#R!pO'w!lO'xTO'{UO(W!mO(c!sO~O!]'dO!^'cO!_'cO#P!pO#U'eO#V'eO~PAjO_%gO!b#uO!i%^O'm%gO(P%RO(d'gO~O!m'kO#Y'iO~PBxOm!nO}!oO'xTO'{UO(W!mO(c!sO~O!YXOm(aX}(aX!](aX!^(aX!_(aX!y(aX!}(aX#O(aX#P(aX#Q(aX#R(aX#U(aX#V(aX'w(aX'x(aX'{(aX(W(aX(c(aX~O!^'cO!_'cO'w!lO~PChO'r'oO's'oO't'qO~O]!|O'x'sO'y!|O'z'sO~O]#PO'z'sO'{'sO'|#PO~Or#RO!P#SO(U#SO(V'wO~O!V'yO!T'OX!T'UX!W'OX!W'UX~P+}O!W'{O!T(ZX~OP$]OY$dOl$QOz#yO{#zO}#{O!W'{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO#v$XO#w$YO(TVO(d$ZO(k#|O(l#}O~O!T(ZX~PG[O!T(QO~O!T(gX!W(gX!b(gX!h(gX(d(gX~O#Y(gX#e#^X!X(gX~PIbO#Y(RO!T(iX!W(iX~O!W(SO!T(hX~O!T(VO~O#Y$eO~PIbO!X(WO~P`Oz#yO{#zO}#{O!g#wO!i#xO(TVOP!kaY!kal!ka!W!ka!f!ka!m!ka#h!ka#i!ka#j!ka#k!ka#l!ka#m!ka#n!ka#o!ka#p!ka#r!ka#t!ka#v!ka#w!ka(d!ka(k!ka(l!ka~O_!ka'm!ka'k!ka!T!ka!h!kap!ka!Y!ka%b!ka!b!ka~PJxO!h(XO~O!b#uO#Y(YO(d'gO!W(fX_(fX'm(fX~O!h(fX~PMhO}%aO!Y%bO!y]O#c(_O#d(^O'v%`O~O!W(`O!h(eX~O!h(bO~O}%aO!Y%bO#d(^O'v%`O~OP(YXY(YXl(YXz(YX{(YX}(YX!W(YX!f(YX!g(YX!i(YX!m(YX#h(YX#i(YX#j(YX#k(YX#l(YX#m(YX#n(YX#o(YX#p(YX#r(YX#t(YX#v(YX#w(YX(T(YX(d(YX(k(YX(l(YX~O!b#uO!h(YX~P! UOz(cO{(dO!g#wO!i#xO!y!xa}!xa~O!u!xa%a!xa!Y!xa#c!xa#d!xa'v!xa~P!#YO!u(hO~OPYOQYOb!jOc!iOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!YXO!duO!iZO!lYO!mYO!nYO!pvO!r!gO!u!hO$R!kO$VfO'v!dO'xTO'{UO(TVO(c[O(piO~Oj%SOl$tOm$sOn$sOt%TOv%UOx:[O}${O!Y$|O!d;fO!i$xO#d:bO$R%YO$n:^O$p:`O$s%ZO'v(lO'xTO'{UO(P%RO(T$uO~O#e(nO~Oj%SOl$tOm$sOn$sOt%TOv%UOx%VO}${O!Y$|O!d%[O!i$xO#d%]O$R%YO$n%WO$p%XO$s%ZO'v(lO'xTO'{UO(P%RO(T$uO~Oe(^P~P!'vO!V(rO!h(_P~P%[O(W(tO(c[O~O}(vO!i#xO(W(tO(c[O~OP9qOQ9qOb;bOc!iOjkOl9qOmkOnkOtkOv9qOx9qO}WO!RkO!SkO!Y!eO!d9tO!iZO!l9qO!m9qO!n9qO!p9uO!r9xO!u!hO$R!kO$VfO'v)UO'xTO'{UO(TVO(c[O(p;`O~O{)XO!i#xO~O!W$aO_$la'm$la'k$la!h$la!T$la!Y$la%b$la!b$la~O#q)]O~P!&^Oz)`O!b)_O!Y$YX$U$YX$X$YX$Z$YX$b$YX~O!b)_O!Y(mX$U(mX$X(mX$Z(mX$b(mX~Oz)`O~P!-lOz)`O!Y(mX$U(mX$X(mX$Z(mX$b(mX~O!Y)bO$U)fO$X)aO$Z)aO$b)gO~O!V)jO~P!*SO$X$gO$Z$fO$b)nO~Oh$tXz$tX}$tX!g$tX(k$tX(l$tX~OegXe$tXhgX!WgX#YgX~P!/bOm)pO~Or)qO(U)rO(V)tO~Oh)}Oz)vO})wO(k)yO(l){O~Oe)uO~P!0kOe*OO~Oj%SOl$tOm$sOn$sOt%TOv%UOx:[O}${O!Y$|O!d;fO!i$xO#d:bO$R%YO$n:^O$p:`O$s%ZO'xTO'{UO(P%RO(T$uO~O!V*SO'v*PO!h(qP~P!1YO#e*UO~O!i*VO~O!V*[O'v*XO!T(rP~P!1YOl*hO}*`O!]*fO!^*_O!_*_O!i*VO#U*gO%X*bO'w!lO(W!mO~O!X*eO~P!3`O!g#wOh(SXz(SX}(SX(k(SX(l(SX!W(SX#Y(SX~Oe(SX#z(SX~P!4XOh*kO#Y*jOe(RX!W(RX~O!W*lOe(QX~O'v&QOe(QP~O!i*sO~O'v(lO~Oj*wO}%aO!V#hO!Y%bO!y]O#c#kO#d#hO'v%`O!h(eP~O!b#uO#e*xO~O}%aO!V*zO!W(SO!Y%bO'v%`O!T(hP~Om'RO}*|O!V*{O'xTO'{UO(W(tO~O!X(jP~P!7SO!W*}O_(vX'm(vX~OP$]OY$dOl$QOz#yO{#zO}#{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO#v$XO#w$YO(TVO(d$ZO(k#|O(l#}O~O_!ca!W!ca'm!ca'k!ca!T!ca!h!cap!ca!Y!ca%b!ca!b!ca~P!7zOz#yO{#zO}#{O!g#wO!i#xO(TVOP!oaY!oal!oa!W!oa!f!oa!m!oa#h!oa#i!oa#j!oa#k!oa#l!oa#m!oa#n!oa#o!oa#p!oa#r!oa#t!oa#v!oa#w!oa(d!oa(k!oa(l!oa~O_!oa'm!oa'k!oa!T!oa!h!oap!oa!Y!oa%b!oa!b!oa~P!:eOz#yO{#zO}#{O!g#wO!i#xO(TVOP!qaY!qal!qa!W!qa!f!qa!m!qa#h!qa#i!qa#j!qa#k!qa#l!qa#m!qa#n!qa#o!qa#p!qa#r!qa#t!qa#v!qa#w!qa(d!qa(k!qa(l!qa~O_!qa'm!qa'k!qa!T!qa!h!qap!qa!Y!qa%b!qa!b!qa~P!=OOh+WO!Y'VO%b+VO(P%RO~O!b+YO_(OX!Y(OX'm(OX!W(OX~O_%gO!YXO'm%gO~O!i%^O(P%RO~O!i%^O'v%`O(P%RO~O!b#uO#e(nO~O%c+fO'v+bO'xTO'{UO!X(zP~O!W+gO^(yX~OY+kO~O^+lO~O!Y%wO'v%`O'w!lO^(yP~O#Y+qO(P%RO~Oh+tO!Y$|O(P%RO~O!Y+vO~Oz+xO!YXO~O%g%nO~O!u+}O~Oc,SO~O'v#mO!X(xP~Oc%uO~O%c!QO'v&QO~P<wOY,YO^,XO~OPYOQYObzOcyOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!duO!iZO!lYO!mYO!nYO!pvO!uxO!y]O$VfO%a}O'xTO'{UO(TVO(c[O(piO~O!Y!eO!r!gO$R!kO'v!dO~P!CuO^,XO_%gO'm%gO~OPYOQYOb!jOc!iOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!Y!eO!duO!iZO!lYO!mYO!nYO!pvO!u!hO$R!kO$VfO'v!dO'xTO'{UO(TVO(c[O(piO~O_,_O!rwO#q!OO%e!OO%f!OO%g!OO~P!F_O!i&fO~O&U,eO~O!Y,gO~O&g,iO&i,jOP&daQ&daW&da_&dab&dac&daj&dal&dam&dan&dat&dav&dax&da}&da!R&da!S&da!Y&da!d&da!i&da!l&da!m&da!n&da!p&da!r&da!u&da!y&da#q&da$R&da$V&da%a&da%c&da%e&da%f&da%g&da%j&da%l&da%o&da%p&da%r&da&O&da&U&da&W&da&Y&da&[&da&_&da&e&da&k&da&m&da&o&da&q&da&s&da'k&da'v&da'x&da'{&da(T&da(c&da(p&da!X&da&]&da`&da&b&da~O'v,oO~O!W|X!W!`X!X|X!X!`X!b|X!b!`X!i!`X#Y|X(P!`X~O!b,tO#Y,sO!W#bX!W(]X!X#bX!X(]X!b(]X!i(]X(P(]X~O!b,vO!i%^O(P%RO!W![X!X![X~Om!nO}!oO'xTO'{UO(W!mO~OP9qOQ9qOb;bOc!iOjkOl9qOmkOnkOtkOv9qOx9qO}WO!RkO!SkO!Y!eO!d9tO!iZO!l9qO!m9qO!n9qO!p9uO!r9xO!u!hO$R!kO$VfO'xTO'{UO(TVO(c[O(p;`O~O'v:gO~P# eO!W,zO!X([X~O!X,|O~O!b,tO#Y,sO!W#bX!X#bX~O!W,}O!X(jX~O!X-PO~O!^-QO!_-QO'w!lO~P# SO!X-TO~P'_Oh-WO!Y'VO~O!T-]O~Om!xa!]!xa!^!xa!_!xa!}!xa#O!xa#P!xa#Q!xa#R!xa#U!xa#V!xa'w!xa'x!xa'{!xa(W!xa(c!xa~P!#YO!m-bO#Y-`O~PBxO!^-dO!_-dO'w!lO~PChO_%gO#Y-`O'm%gO~O_%gO!b#uO#Y-`O'm%gO~O_%gO!b#uO!m-bO#Y-`O'm%gO(d'gO~O'r'oO's'oO't-iO~Op-jO~O!T'Oa!W'Oa~P!7zO!V-nO!T'OX!W'OX~P%[O!W'{O!T(Za~O!T(Za~PG[O!W(SO!T(ha~O}%aO!V-rO!Y%bO'v%`O!T'UX!W'UX~O#Y-tO!W(fa!h(fa_(fa'm(fa~O!b#uO~P#)kO!W(`O!h(ea~O}%aO!Y%bO#d-xO'v%`O~Oj-}O}%aO!V-zO!Y%bO!y]O#c-|O#d-zO'v%`O!W'XX!h'XX~O{.RO!i#xO~Oh.UO!Y'VO%b.TO(P%RO~O_#]i!W#]i'm#]i'k#]i!T#]i!h#]ip#]i!Y#]i%b#]i!b#]i~P!7zOh;lOz)vO})wO(k)yO(l){O~O#e#Xa_#Xa#Y#Xa'm#Xa!W#Xa!h#Xa!Y#Xa!T#Xa~P#,gO#e(SXP(SXY(SX_(SXl(SX{(SX!f(SX!i(SX!m(SX#h(SX#i(SX#j(SX#k(SX#l(SX#m(SX#n(SX#o(SX#p(SX#r(SX#t(SX#v(SX#w(SX'm(SX(T(SX(d(SX!h(SX!T(SX'k(SXp(SX!Y(SX%b(SX!b(SX~P!4XO!W._Oe(^X~P!0kOe.aO~O!W.bO!h(_X~P!7zO!h.eO~O!T.gO~OP$]Oz#yO{#zO}#{O!g#wO!i#xO!m$]O(TVOY#gi_#gil#gi!W#gi!f#gi#i#gi#j#gi#k#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi'm#gi(d#gi(k#gi(l#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~O#h#gi~P#0cO#h$OO~P#0cOP$]Oz#yO{#zO}#{O!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO(TVOY#gi_#gi!W#gi!f#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi'm#gi(d#gi(k#gi(l#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~Ol#gi~P#3TOl$QO~P#3TOP$]Ol$QOz#yO{#zO}#{O!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO(TVO_#gi!W#gi#r#gi#t#gi#v#gi#w#gi'm#gi(d#gi(k#gi(l#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~OY#gi!f#gi#m#gi#n#gi#o#gi#p#gi~P#5uOY$dO!f$SO#m$SO#n$SO#o$cO#p$SO~P#5uOP$]OY$dOl$QOz#yO{#zO}#{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO(TVO_#gi!W#gi#t#gi#v#gi#w#gi'm#gi(d#gi(l#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~O(k#gi~P#8vO(k#|O~P#8vOP$]OY$dOl$QOz#yO{#zO}#{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO(TVO(k#|O_#gi!W#gi#v#gi#w#gi'm#gi(d#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~O(l#gi~P#;hO(l#}O~P#;hOP$]OY$dOl$QOz#yO{#zO}#{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO#v$XO(TVO(k#|O(l#}O~O_#gi!W#gi#w#gi'm#gi(d#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~P#>YOPZXYZXlZXzZX{ZX}ZX!fZX!gZX!iZX!mZX#YZX#edX#hZX#iZX#jZX#kZX#lZX#mZX#nZX#oZX#pZX#rZX#tZX#vZX#wZX#|ZX(TZX(dZX(kZX(lZX!WZX!XZX~O#zZX~P#@sOP$]OY:YOl9|Oz#yO{#zO}#{O!f:OO!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O#m:OO#n:OO#o:XO#p:OO#r:PO#t:RO#v:TO#w:UO(TVO(d$ZO(k#|O(l#}O~O#z.iO~P#CQO#Y:ZO#|:ZO#z(YX!X(YX~P! UO_'[a!W'[a'm'[a'k'[a!h'[a!T'[ap'[a!Y'[a%b'[a!b'[a~P!7zOP#giY#gi_#gil#gi{#gi!W#gi!f#gi!g#gi!i#gi!m#gi#h#gi#i#gi#j#gi#k#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi'm#gi(T#gi(d#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~P#,gO_#{i!W#{i'm#{i'k#{i!T#{i!h#{ip#{i!Y#{i%b#{i!b#{i~P!7zO$X.nO$Z.nO~O$X.oO$Z.oO~O!b)_O#Y.pO!Y$_X$U$_X$X$_X$Z$_X$b$_X~O!V.qO~O!Y)bO$U.sO$X)aO$Z)aO$b.tO~O!W:VO!X(XX~P#CQO!X.uO~O!b)_O$b(mX~O$b.wO~Or)qO(U)rO(V.zO~O!T/OO~P!&^O!WdX!bdX!hdX!h$tX(ddX~P!/bO!h/UO~P#,gO!W/VO!b#uO(d'gO!h(qX~O!h/[O~O!V*SO'v%`O!h(qP~O#e/^O~O!T$tX!W$tX!b${X~P!/bO!W/_O!T(rX~P#,gO!b/aO~O!T/cO~Ol/gO!b#uO!i%^O(P%RO(d'gO~O'v/iO~O!b+YO~O_%gO!W/mO'm%gO~O!X/oO~P!3`O!^/pO!_/pO'w!lO(W!mO~O}/rO(W!mO~O#U/sO~O'v&QOe'aX!W'aX~O!W*lOe(Qa~Oe/xO~Oz/yO{/yO}/zOhwa(kwa(lwa!Wwa#Ywa~Oewa#zwa~P$ hOz)vO})wOh$ma(k$ma(l$ma!W$ma#Y$ma~Oe$ma#z$ma~P$!^Oz)vO})wOh$oa(k$oa(l$oa!W$oa#Y$oa~Oe$oa#z$oa~P$#PO#e/|O~Oe$}a!W$}a#Y$}a#z$}a~P!0kO!b#uO~O#e0PO~O!W*}O_(va'm(va~Oz#yO{#zO}#{O!g#wO!i#xO(TVOP!oiY!oil!oi!W!oi!f!oi!m!oi#h!oi#i!oi#j!oi#k!oi#l!oi#m!oi#n!oi#o!oi#p!oi#r!oi#t!oi#v!oi#w!oi(d!oi(k!oi(l!oi~O_!oi'm!oi'k!oi!T!oi!h!oip!oi!Y!oi%b!oi!b!oi~P$$nOh.UO!Y'VO%b.TO~Oj0ZO'v0YO~P!1]O!b+YO_(Oa!Y(Oa'm(Oa!W(Oa~O#e0aO~OYZX!WdX!XdX~O!W0bO!X(zX~O!X0dO~OY0eO~O'v+bO'xTO'{UO~O!Y%wO'v%`O^'iX!W'iX~O!W+gO^(ya~O!h0jO~P!7zOY0mO~O^0nO~O#Y0qO~Oh0tO!Y$|O~O(W(tO!X(wP~Oh0}O!Y0zO%b0|O(P%RO~OY1XO!W1VO!X(xX~O!X1YO~O^1[O_%gO'm%gO~O'v#mO'xTO'{UO~O#Y$eO#|$eOP(YXY(YXl(YXz(YX{(YX}(YX!W(YX!f(YX!i(YX!m(YX#h(YX#i(YX#j(YX#k(YX#l(YX#m(YX#n(YX#o(YX#r(YX#t(YX#v(YX#w(YX(T(YX(d(YX(k(YX(l(YX~O#p1_O&S1`O_(YX!g(YX~P$+dO#Y$eO#p1_O&S1`O~O_1bO~P%[O_1dO~O&]1gOP&ZiQ&ZiW&Zi_&Zib&Zic&Zij&Zil&Zim&Zin&Zit&Ziv&Zix&Zi}&Zi!R&Zi!S&Zi!Y&Zi!d&Zi!i&Zi!l&Zi!m&Zi!n&Zi!p&Zi!r&Zi!u&Zi!y&Zi#q&Zi$R&Zi$V&Zi%a&Zi%c&Zi%e&Zi%f&Zi%g&Zi%j&Zi%l&Zi%o&Zi%p&Zi%r&Zi&O&Zi&U&Zi&W&Zi&Y&Zi&[&Zi&_&Zi&e&Zi&k&Zi&m&Zi&o&Zi&q&Zi&s&Zi'k&Zi'v&Zi'x&Zi'{&Zi(T&Zi(c&Zi(p&Zi!X&Zi`&Zi&b&Zi~O`1mO!X1kO&b1lO~P`O!YXO!i1oO~O&i,jOP&diQ&diW&di_&dib&dic&dij&dil&dim&din&dit&div&dix&di}&di!R&di!S&di!Y&di!d&di!i&di!l&di!m&di!n&di!p&di!r&di!u&di!y&di#q&di$R&di$V&di%a&di%c&di%e&di%f&di%g&di%j&di%l&di%o&di%p&di%r&di&O&di&U&di&W&di&Y&di&[&di&_&di&e&di&k&di&m&di&o&di&q&di&s&di'k&di'v&di'x&di'{&di(T&di(c&di(p&di!X&di&]&di`&di&b&di~O!T1uO~O!W![a!X![a~P#CQOm!nO}!oO!V1{O(W!mO!W'PX!X'PX~P@OO!W,zO!X([a~O!W'VX!X'VX~P!7SO!W,}O!X(ja~O!X2SO~P'_O_%gO#Y2]O'm%gO~O_%gO!b#uO#Y2]O'm%gO~O_%gO!b#uO!m2aO#Y2]O'm%gO(d'gO~O_%gO'm%gO~P!7zO!W$aOp$la~O!T'Oi!W'Oi~P!7zO!W'{O!T(Zi~O!W(SO!T(hi~O!T(ii!W(ii~P!7zO!W(fi!h(fi_(fi'm(fi~P!7zO#Y2cO!W(fi!h(fi_(fi'm(fi~O!W(`O!h(ei~O}%aO!Y%bO!y]O#c2hO#d2gO'v%`O~O}%aO!Y%bO#d2gO'v%`O~Oh2oO!Y'VO%b2nO~Oh2oO!Y'VO%b2nO(P%RO~O#ewaPwaYwa_walwa!fwa!gwa!iwa!mwa#hwa#iwa#jwa#kwa#lwa#mwa#nwa#owa#pwa#rwa#twa#vwa#wwa'mwa(Twa(dwa!hwa!Twa'kwapwa!Ywa%bwa!bwa~P$ hO#e$maP$maY$ma_$mal$ma{$ma!f$ma!g$ma!i$ma!m$ma#h$ma#i$ma#j$ma#k$ma#l$ma#m$ma#n$ma#o$ma#p$ma#r$ma#t$ma#v$ma#w$ma'm$ma(T$ma(d$ma!h$ma!T$ma'k$map$ma!Y$ma%b$ma!b$ma~P$!^O#e$oaP$oaY$oa_$oal$oa{$oa!f$oa!g$oa!i$oa!m$oa#h$oa#i$oa#j$oa#k$oa#l$oa#m$oa#n$oa#o$oa#p$oa#r$oa#t$oa#v$oa#w$oa'm$oa(T$oa(d$oa!h$oa!T$oa'k$oap$oa!Y$oa%b$oa!b$oa~P$#PO#e$}aP$}aY$}a_$}al$}a{$}a!W$}a!f$}a!g$}a!i$}a!m$}a#h$}a#i$}a#j$}a#k$}a#l$}a#m$}a#n$}a#o$}a#p$}a#r$}a#t$}a#v$}a#w$}a'm$}a(T$}a(d$}a!h$}a!T$}a'k$}a#Y$}ap$}a!Y$}a%b$}a!b$}a~P#,gO_#]q!W#]q'm#]q'k#]q!T#]q!h#]qp#]q!Y#]q%b#]q!b#]q~P!7zOe'QX!W'QX~P!'vO!W._Oe(^a~O!V2wO!W'RX!h'RX~P%[O!W.bO!h(_a~O!W.bO!h(_a~P!7zO!T2zO~O#z!ka!X!ka~PJxO#z!ca!W!ca!X!ca~P#CQO#z!oa!X!oa~P!:eO#z!qa!X!qa~P!=OO!Y3^O$VfO$`3_O~O!X3cO~Op3dO~P#,gO_$iq!W$iq'm$iq'k$iq!T$iq!h$iqp$iq!Y$iq%b$iq!b$iq~P!7zO!T3eO~P#,gOz)vO})wO(l){Oh%Yi(k%Yi!W%Yi#Y%Yi~Oe%Yi#z%Yi~P$I|Oz)vO})wOh%[i(k%[i(l%[i!W%[i#Y%[i~Oe%[i#z%[i~P$JoO(d$ZO~P#,gO!V3hO'v%`O!W']X!h']X~O!W/VO!h(qa~O!W/VO!b#uO!h(qa~O!W/VO!b#uO(d'gO!h(qa~Oe$vi!W$vi#Y$vi#z$vi~P!0kO!V3pO'v*XO!T'_X!W'_X~P!1YO!W/_O!T(ra~O!W/_O!T(ra~P#,gO!b#uO#p3xO~Ol3{O!b#uO(d'gO~Oe(Ri!W(Ri~P!0kO#Y4OOe(Ri!W(Ri~P!0kO!h4RO~O_$jq!W$jq'm$jq'k$jq!T$jq!h$jqp$jq!Y$jq%b$jq!b$jq~P!7zO!T4VO~O!W4WO!Y(sX~P#,gO!g#wO~P4XO_$tX!Y$tX%VZX'm$tX!W$tX~P!/bO%V4YO_iXhiXziX}iX!YiX'miX(kiX(liX!WiX~O%V4YO~O%c4aO'v+bO'xTO'{UO!W'hX!X'hX~O!W0bO!X(za~OY4eO~O^4fO~O_%gO'm%gO~P#,gO!Y$|O~P#,gO!W4nO#Y4pO!X(wX~O!X4qO~Om!nO}4rO!]!xO!^!uO!_!uO!y9rO!}!pO#O!pO#P!pO#Q!pO#R!pO#U4wO#V!yO'w!lO'xTO'{UO(W!mO(c!sO~O!X4vO~P%$nOh4|O!Y0zO%b4{O~Oh4|O!Y0zO%b4{O(P%RO~O'v#mO!W'gX!X'gX~O!W1VO!X(xa~O'xTO'{UO(W5VO~O^5ZO~O#p5^O&S5_O~PMhO!h5`O~P%[O_5bO~O_5bO~P%[O`1mO!X5gO&b1lO~P`O!b5iO~O!b5kO!W(]i!X(]i!b(]i!i(]i(P(]i~O!W#bi!X#bi~P#CQO#Y5lO!W#bi!X#bi~O!W![i!X![i~P#CQO_%gO#Y5uO'm%gO~O_%gO!b#uO#Y5uO'm%gO~O!W(fq!h(fq_(fq'm(fq~P!7zO!W(`O!h(eq~O}%aO!Y%bO#d5|O'v%`O~O!Y'VO%b6PO~Oh6SO!Y'VO%b6PO~O#e%YiP%YiY%Yi_%Yil%Yi{%Yi!f%Yi!g%Yi!i%Yi!m%Yi#h%Yi#i%Yi#j%Yi#k%Yi#l%Yi#m%Yi#n%Yi#o%Yi#p%Yi#r%Yi#t%Yi#v%Yi#w%Yi'm%Yi(T%Yi(d%Yi!h%Yi!T%Yi'k%Yip%Yi!Y%Yi%b%Yi!b%Yi~P$I|O#e%[iP%[iY%[i_%[il%[i{%[i!f%[i!g%[i!i%[i!m%[i#h%[i#i%[i#j%[i#k%[i#l%[i#m%[i#n%[i#o%[i#p%[i#r%[i#t%[i#v%[i#w%[i'm%[i(T%[i(d%[i!h%[i!T%[i'k%[ip%[i!Y%[i%b%[i!b%[i~P$JoO#e$viP$viY$vi_$vil$vi{$vi!W$vi!f$vi!g$vi!i$vi!m$vi#h$vi#i$vi#j$vi#k$vi#l$vi#m$vi#n$vi#o$vi#p$vi#r$vi#t$vi#v$vi#w$vi'm$vi(T$vi(d$vi!h$vi!T$vi'k$vi#Y$vip$vi!Y$vi%b$vi!b$vi~P#,gOe'Qa!W'Qa~P!0kO!W'Ra!h'Ra~P!7zO!W.bO!h(_i~O#z#]i!W#]i!X#]i~P#CQOP$]Oz#yO{#zO}#{O!g#wO!i#xO!m$]O(TVOY#gil#gi!f#gi#i#gi#j#gi#k#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi#z#gi(d#gi(k#gi(l#gi!W#gi!X#gi~O#h#gi~P%2}O#h9zO~P%2}OP$]Oz#yO{#zO}#{O!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O(TVOY#gi!f#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi#z#gi(d#gi(k#gi(l#gi!W#gi!X#gi~Ol#gi~P%5YOl9|O~P%5YOP$]Ol9|Oz#yO{#zO}#{O!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O(TVO#r#gi#t#gi#v#gi#w#gi#z#gi(d#gi(k#gi(l#gi!W#gi!X#gi~OY#gi!f#gi#m#gi#n#gi#o#gi#p#gi~P%7eOY:YO!f:OO#m:OO#n:OO#o:XO#p:OO~P%7eOP$]OY:YOl9|Oz#yO{#zO}#{O!f:OO!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O#m:OO#n:OO#o:XO#p:OO#r:PO(TVO#t#gi#v#gi#w#gi#z#gi(d#gi(l#gi!W#gi!X#gi~O(k#gi~P%:PO(k#|O~P%:POP$]OY:YOl9|Oz#yO{#zO}#{O!f:OO!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O#m:OO#n:OO#o:XO#p:OO#r:PO#t:RO(TVO(k#|O#v#gi#w#gi#z#gi(d#gi!W#gi!X#gi~O(l#gi~P%<[O(l#}O~P%<[OP$]OY:YOl9|Oz#yO{#zO}#{O!f:OO!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O#m:OO#n:OO#o:XO#p:OO#r:PO#t:RO#v:TO(TVO(k#|O(l#}O~O#w#gi#z#gi(d#gi!W#gi!X#gi~P%>gO_#xy!W#xy'm#xy'k#xy!T#xy!h#xyp#xy!Y#xy%b#xy!b#xy~P!7zOh;mOz)vO})wO(k)yO(l){O~OP#giY#gil#gi{#gi!f#gi!g#gi!i#gi!m#gi#h#gi#i#gi#j#gi#k#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi#z#gi(T#gi(d#gi!W#gi!X#gi~P%A_O!g#wOP(SXY(SXh(SXl(SXz(SX{(SX}(SX!f(SX!i(SX!m(SX#h(SX#i(SX#j(SX#k(SX#l(SX#m(SX#n(SX#o(SX#p(SX#r(SX#t(SX#v(SX#w(SX#z(SX(T(SX(d(SX(k(SX(l(SX!W(SX!X(SX~O#z#{i!W#{i!X#{i~P#CQO#z!oi!X!oi~P$$nO!X6`O~O!W'[a!X'[a~P#CQO!b#uO(d'gO!W']a!h']a~O!W/VO!h(qi~O!W/VO!b#uO!h(qi~Oe$vq!W$vq#Y$vq#z$vq~P!0kO!T'_a!W'_a~P#,gO!b6gO~O!W/_O!T(ri~P#,gO!W/_O!T(ri~O!T6kO~O!b#uO#p6pO~Ol6qO!b#uO(d'gO~O!T6sO~Oe$xq!W$xq#Y$xq#z$xq~P!0kO_$jy!W$jy'm$jy'k$jy!T$jy!h$jyp$jy!Y$jy%b$jy!b$jy~P!7zO!b5kO~O!W4WO!Y(sa~O_#]y!W#]y'm#]y'k#]y!T#]y!h#]yp#]y!Y#]y%b#]y!b#]y~P!7zOY6xO~O!W0bO!X(zi~O^7OO~O(W(tO!W'dX!X'dX~O!W4nO!X(wa~OjkO'v7VO~P.iO!X7YO~P%$nOm!nO}7ZO'xTO'{UO(W!mO(c!sO~O!Y0zO~O!Y0zO%b7]O~Oh7`O!Y0zO%b7]O~OY7eO!W'ga!X'ga~O!W1VO!X(xi~O!h7iO~O!h7jO~O!h7mO~O!h7mO~P%[O_7oO~O!b7pO~O!h7qO~O!W(ii!X(ii~P#CQO_%gO#Y7yO'm%gO~O!W(fy!h(fy_(fy'm(fy~P!7zO!W(`O!h(ey~O!Y'VO%b7|O~O#e$vqP$vqY$vq_$vql$vq{$vq!W$vq!f$vq!g$vq!i$vq!m$vq#h$vq#i$vq#j$vq#k$vq#l$vq#m$vq#n$vq#o$vq#p$vq#r$vq#t$vq#v$vq#w$vq'm$vq(T$vq(d$vq!h$vq!T$vq'k$vq#Y$vqp$vq!Y$vq%b$vq!b$vq~P#,gO#e$xqP$xqY$xq_$xql$xq{$xq!W$xq!f$xq!g$xq!i$xq!m$xq#h$xq#i$xq#j$xq#k$xq#l$xq#m$xq#n$xq#o$xq#p$xq#r$xq#t$xq#v$xq#w$xq'm$xq(T$xq(d$xq!h$xq!T$xq'k$xq#Y$xqp$xq!Y$xq%b$xq!b$xq~P#,gO!W'Ri!h'Ri~P!7zO#z#]q!W#]q!X#]q~P#CQOz/yO{/yO}/zOPwaYwahwalwa!fwa!gwa!iwa!mwa#hwa#iwa#jwa#kwa#lwa#mwa#nwa#owa#pwa#rwa#twa#vwa#wwa#zwa(Twa(dwa(kwa(lwa!Wwa!Xwa~Oz)vO})wOP$maY$mah$mal$ma{$ma!f$ma!g$ma!i$ma!m$ma#h$ma#i$ma#j$ma#k$ma#l$ma#m$ma#n$ma#o$ma#p$ma#r$ma#t$ma#v$ma#w$ma#z$ma(T$ma(d$ma(k$ma(l$ma!W$ma!X$ma~Oz)vO})wOP$oaY$oah$oal$oa{$oa!f$oa!g$oa!i$oa!m$oa#h$oa#i$oa#j$oa#k$oa#l$oa#m$oa#n$oa#o$oa#p$oa#r$oa#t$oa#v$oa#w$oa#z$oa(T$oa(d$oa(k$oa(l$oa!W$oa!X$oa~OP$}aY$}al$}a{$}a!f$}a!g$}a!i$}a!m$}a#h$}a#i$}a#j$}a#k$}a#l$}a#m$}a#n$}a#o$}a#p$}a#r$}a#t$}a#v$}a#w$}a#z$}a(T$}a(d$}a!W$}a!X$}a~P%A_O#z$iq!W$iq!X$iq~P#CQO#z$jq!W$jq!X$jq~P#CQO!X8WO~O#z8XO~P!0kO!b#uO!W']i!h']i~O!b#uO(d'gO!W']i!h']i~O!W/VO!h(qq~O!T'_i!W'_i~P#,gO!W/_O!T(rq~O!T8_O~P#,gO!T8_O~Oe(Ry!W(Ry~P!0kO!W'ba!Y'ba~P#,gO_%Uq!Y%Uq'm%Uq!W%Uq~P#,gOY8dO~O!W0bO!X(zq~O#Y8hO!W'da!X'da~O!W4nO!X(wi~P#CQOPZXYZXlZXzZX{ZX}ZX!TZX!WZX!fZX!gZX!iZX!mZX#YZX#edX#hZX#iZX#jZX#kZX#lZX#mZX#nZX#oZX#pZX#rZX#tZX#vZX#wZX#|ZX(TZX(dZX(kZX(lZX~O!b%SX#p%SX~P&2_O!Y0zO%b8lO~O'xTO'{UO(W8qO~O!W1VO!X(xq~O!h8tO~O!h8uO~O!h8vO~O!h8vO~P%[O#Y8yO!W#by!X#by~O!W#by!X#by~P#CQO!Y'VO%b9OO~O#z#xy!W#xy!X#xy~P#CQOP$viY$vil$vi{$vi!f$vi!g$vi!i$vi!m$vi#h$vi#i$vi#j$vi#k$vi#l$vi#m$vi#n$vi#o$vi#p$vi#r$vi#t$vi#v$vi#w$vi#z$vi(T$vi(d$vi!W$vi!X$vi~P%A_Oz)vO})wO(l){OP%YiY%Yih%Yil%Yi{%Yi!f%Yi!g%Yi!i%Yi!m%Yi#h%Yi#i%Yi#j%Yi#k%Yi#l%Yi#m%Yi#n%Yi#o%Yi#p%Yi#r%Yi#t%Yi#v%Yi#w%Yi#z%Yi(T%Yi(d%Yi(k%Yi!W%Yi!X%Yi~Oz)vO})wOP%[iY%[ih%[il%[i{%[i!f%[i!g%[i!i%[i!m%[i#h%[i#i%[i#j%[i#k%[i#l%[i#m%[i#n%[i#o%[i#p%[i#r%[i#t%[i#v%[i#w%[i#z%[i(T%[i(d%[i(k%[i(l%[i!W%[i!X%[i~O#z$jy!W$jy!X$jy~P#CQO#z#]y!W#]y!X#]y~P#CQO!b#uO!W']q!h']q~O!W/VO!h(qy~O!T'_q!W'_q~P#,gO!T9VO~P#,gO!W0bO!X(zy~O!W4nO!X(wq~O!Y0zO%b9^O~O!h9aO~O!Y'VO%b9fO~OP$vqY$vql$vq{$vq!f$vq!g$vq!i$vq!m$vq#h$vq#i$vq#j$vq#k$vq#l$vq#m$vq#n$vq#o$vq#p$vq#r$vq#t$vq#v$vq#w$vq#z$vq(T$vq(d$vq!W$vq!X$vq~P%A_OP$xqY$xql$xq{$xq!f$xq!g$xq!i$xq!m$xq#h$xq#i$xq#j$xq#k$xq#l$xq#m$xq#n$xq#o$xq#p$xq#r$xq#t$xq#v$xq#w$xq#z$xq(T$xq(d$xq!W$xq!X$xq~P%A_Oe%^!Z!W%^!Z#Y%^!Z#z%^!Z~P!0kO!W'dq!X'dq~P#CQO!W#b!Z!X#b!Z~P#CQO#e%^!ZP%^!ZY%^!Z_%^!Zl%^!Z{%^!Z!W%^!Z!f%^!Z!g%^!Z!i%^!Z!m%^!Z#h%^!Z#i%^!Z#j%^!Z#k%^!Z#l%^!Z#m%^!Z#n%^!Z#o%^!Z#p%^!Z#r%^!Z#t%^!Z#v%^!Z#w%^!Z'm%^!Z(T%^!Z(d%^!Z!h%^!Z!T%^!Z'k%^!Z#Y%^!Zp%^!Z!Y%^!Z%b%^!Z!b%^!Z~P#,gOP%^!ZY%^!Zl%^!Z{%^!Z!f%^!Z!g%^!Z!i%^!Z!m%^!Z#h%^!Z#i%^!Z#j%^!Z#k%^!Z#l%^!Z#m%^!Z#n%^!Z#o%^!Z#p%^!Z#r%^!Z#t%^!Z#v%^!Z#w%^!Z#z%^!Z(T%^!Z(d%^!Z!W%^!Z!X%^!Z~P%A_Op(XX~P1qO'w!lO~P!*SO!TdX!WdX#YdX~P&2_OPZXYZXlZXzZX{ZX}ZX!WZX!WdX!fZX!gZX!iZX!mZX#YZX#YdX#edX#hZX#iZX#jZX#kZX#lZX#mZX#nZX#oZX#pZX#rZX#tZX#vZX#wZX#|ZX(TZX(dZX(kZX(lZX~O!bdX!hZX!hdX(ddX~P&GuOP9qOQ9qOb;bOc!iOjkOl9qOmkOnkOtkOv9qOx9qO}WO!RkO!SkO!YXO!d9tO!iZO!l9qO!m9qO!n9qO!p9uO!r9xO!u!hO$R!kO$VfO'v)UO'xTO'{UO(TVO(c[O(p;`O~O!W:VO!X$la~Oj%SOl$tOm$sOn$sOt%TOv%UOx:]O}${O!Y$|O!d;gO!i$xO#d:cO$R%YO$n:_O$p:aO$s%ZO'v(lO'xTO'{UO(P%RO(T$uO~O#q)]O~P&LkO!XZX!XdX~P&GuO#e9yO~O!b#uO#e9yO~O#Y:ZO~O#p:OO~O#Y:eO!W(iX!X(iX~O#Y:ZO!W(gX!X(gX~O#e:fO~Oe:hO~P!0kO#e:mO~O#e:nO~O!b#uO#e:oO~O!b#uO#e:fO~O#z:pO~P#CQO#e:qO~O#e:rO~O#e:sO~O#e:tO~O#e:uO~O#e:vO~O#z:wO~P!0kO#z:xO~P!0kO$V~!g!}#O#Q#R#U#c#d#o(p$n$p$s%V%a%b%c%j%l%o%p%r%t~'qR$V(p#i!S'o'w#jm#h#klz'p(W'p'v$X$Z$X~",goto:"$'R)OPPPP)PPP)SP)eP*t.xPPPP5YPP5pP;l>sP?WP?WPPP?WP@xP?WP?WP?WP@|PPARPAlPFdPPPFhPPPPFhIiPPPIoJjPFhPLxPPPP! WFhPPPFhPFhP!#fFhP!&z!'|!(VP!(y!(}!(yPPPPP!,Y!'|PP!,v!-pP!0dFhFh!0i!3s!8Y!8Y!<OPPP!<VFhPPPPPPPPPPP!?dP!@uPPFh!BSPFhPFhFhFhFhPFh!CfPP!FnP!IrP!Iv!JQ!JU!JUP!FkP!JY!JYP!M^P!MbFhFh!Mh#!k?WP?WP?W?WP##v?W?W#%r?W#(R?W#)w?W?W#*f#,d#,d#,h#,p#,d#,xP#,dP?W#-b?W#.k?W?W5YPPP#/wPPP#0b#0bP#0bP#0x#0bPP#1OP#0uP#0u#1c#0u#1}#2T5V)S#2W)SP#2_#2_#2_P)SP)SP)SP)SPP)SP#2e#2hP#2h)SP#2lP#2oP)SP)SP)SP)SP)SP)S)SPP#2u#2{#3W#3^#3d#3j#3p#4O#4U#4[#4f#4l#4v#5V#5]#5}#6a#6g#6m#6{#7b#8s#9R#9X#9_#9e#9k#9u#9{#:R#:]#:o#:uPPPPPPPPPP#:{PPPPPPP#;p#>wP#@W#@_#@gPPPP#Du#Gl#NT#NW#NZ$ S$ V$ Y$ a$ iPP$ o$ s$!k$#j$#n$$SPP$$W$$^$$bP$$e$$i$$l$%b$%y$&b$&f$&i$&l$&r$&u$&y$&}R!{RoqOXst!Z#c%f&i&k&l&n,b,g1g1jY!uQ'V-S0z4uQ%lvQ%tyQ%{|Q&a!VS&}!e,zQ']!iS'c!r!xS*_$|*dQ+`%uQ+m%}Q,R&ZQ-Q'UQ-['^Q-d'dQ/p*fQ1U,SR:d9u%OdOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|,_,b,g-W-`-n-t.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2w4r4|5^5_5b5u7Z7`7o7yS#p]9r!r)W$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cQ*o%VQ+e%wQ,T&^Q,[&fQ.X:[Q0W+WQ0[+YQ0g+fQ1^,YQ2k.UQ4`0bQ5T1VQ6R2oQ6X:]Q6z4aR8P6S&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;ct!nQ!r!u!x!y&}'U'V'c'd'e,z-Q-S-d0z4u4w$^$si#u#w$c$d$x${%W%X%])q)w)z)|)}*U*[*j*k+V+Y+q+t.T._/P/^/_/a/|0q0t0|2n3f3p3x4O4W4Y4{6P6g6p7]7|8X8l9O9^9f:X:Y:^:_:`:a:b:c:i:j:k:l:m:n:q:r:s:t:w:x;`;h;i;l;mQ&O|Q&{!eS'R%b,}Q+e%wQ/{*sQ0g+fQ0l+lQ1],XQ1^,YQ4`0bQ4i0nQ5W1XQ5X1[Q6z4aQ6}4fQ7h5ZQ8g7OR8r7ernOXst!V!Z#c%f&`&i&k&l&n,b,g1g1jR,V&b&v^OPXYstuvwz!Z!`!g!j!o#R#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'X'i'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;b;c[#[WZ#V#Y'O'y!S%cm#g#h#k%^%a(S(^(_(`*z*{*},^,t-r-x-y-z-|1o2g2h5k5|Q%oxQ%syS%x|%}Q&U!TQ'Y!hQ'[!iQ(g#rS*R$x*VS+_%t%uQ+c%wQ+|&XQ,Q&ZS-Z']'^Q.W(hQ/Z*SQ0`+`Q0f+fQ0h+gQ0k+kQ1P+}S1T,R,SQ2X-[Q3g/VQ4_0bQ4c0eQ4h0mQ5S1UQ6d3hQ6y4aQ6|4eQ8c6xR9X8dv$zi#w%W%X%])z)|*U*j*k._/^/|3f4O8X;`;h;i!S%qy!i!t%s%t%u&|'[']'^'b'l*^+_+`,w-Z-[-c/h0`2Q2X2`3zQ+X%oQ+r&RQ+u&SQ,P&ZQ.V(gQ1O+|U1S,Q,R,SQ2p.WQ4}1PS5R1T1UQ7d5S#O;d#u$c$d$x${)q)w)}*[+V+Y+q+t.T/P/_/a0q0t0|2n3p3x4W4Y4{6P6g6p7]7|8l9O9^9f:^:`:b:i:k:m:q:s:w;l;mg;e:X:Y:_:a:c:j:l:n:r:t:xW%Pi%R*l;`S&R!Q&`Q&S!RQ&T!SR+p&P$_%Oi#u#w$c$d$x${%W%X%])q)w)z)|)}*U*[*j*k+V+Y+q+t.T._/P/^/_/a/|0q0t0|2n3f3p3x4O4W4Y4{6P6g6p7]7|8X8l9O9^9f:X:Y:^:_:`:a:b:c:i:j:k:l:m:n:q:r:s:t:w:x;`;h;i;l;mT)r$u)sV*p%V:[:]U'R!e%b,}S(u#y#zQ+j%zS.P(c(dQ0u+vQ4P/yR7S4n&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;c$i$`c#X#d%j%k%m'x(O(j(q(y(z({(|(})O)P)Q)R)S)T)V)Y)^)h+T+i,x-g-l-q-s.^.d.h.j.k.l.{/}1v1y2Z2b2v2{2|2}3O3P3Q3R3S3T3U3V3W3X3[3]3b4T4]5n5t5y6V6W6]6^7U7s7w8Q8U8V8{9Z9b9s;VT#SV#T&}kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cQ'P!eR1|,zv!nQ!e!r!u!x!y&}'U'V'c'd'e,z-Q-S-d0z4u4wS*^$|*dS/h*_*fQ/q*gQ0w+xQ3z/pR3}/snqOXst!Z#c%f&i&k&l&n,b,g1g1jQ&p!^Q'm!wS(i#t9yQ+]%rQ+z&UQ+{&WQ-X'ZQ-f'fS.](n:fS0O*x:oQ0^+^Q0y+yQ1n,iQ1p,jQ1x,uQ2V-YQ2Y-^S4U0P:uQ4Z0_S4^0a:vQ5m1zQ5q2WQ5v2_Q6w4[Q7t5oQ7u5rQ7x5wR8x7q$d$_c#X#d%k%m'x(O(j(q(y(z({(|(})O)P)Q)R)S)T)V)Y)^)h+T+i,x-g-l-q-s.^.d.h.k.l.{/}1v1y2Z2b2v2{2|2}3O3P3Q3R3S3T3U3V3W3X3[3]3b4T4]5n5t5y6V6W6]6^7U7s7w8Q8U8V8{9Z9b9s;VS(f#o'`U*i$}(m3ZS+S%j.jQ2l0WQ6O2kQ8O6RR9P8P$d$^c#X#d%k%m'x(O(j(q(y(z({(|(})O)P)Q)R)S)T)V)Y)^)h+T+i,x-g-l-q-s.^.d.h.k.l.{/}1v1y2Z2b2v2{2|2}3O3P3Q3R3S3T3U3V3W3X3[3]3b4T4]5n5t5y6V6W6]6^7U7s7w8Q8U8V8{9Z9b9s;VS(e#o'`S(w#z$_S+R%j.jS.Q(d(fQ.m)XQ0T+SR2i.R&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cS#p]9rQ&k!XQ&l!YQ&n![Q&o!]R1f,eQ'W!hQ+U%oQ-V'YS.S(g+XQ2T-UW2m.V.W0V0XQ5p2UU5}2j2l2pS7{6O6QS8}7}8OS9d8|9PQ9l9eR9o9mU!vQ'V-ST4s0z4u!Q_OXZ`st!V!Z#c#g%^%f&`&b&i&k&l&n(`,b,g-y1g1j]!pQ!r'V-S0z4uT#p]9r%Y{OPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&f&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7yS(u#y#zS.P(c(d!s:|$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cY!tQ'V-S0z4uQ'b!rS'l!u!xS'n!y4wS-c'c'dQ-e'eR2`-dQ'k!tS([#f1aS-b'b'nQ/Y*RQ/f*^Q2a-eQ3l/ZS3u/g/qQ6c3gS6n3{3}Q8Z6dR8b6qQ#vbQ'j!tS(Z#f1aS(]#l*wQ*y%_Q+Z%pQ+a%vU-a'b'k'nQ-u([Q/X*RQ/e*^Q/k*aQ0]+[Q1Q,OS2^-b-eQ2f-}S3k/Y/ZS3t/f/qQ3w/jQ3y/lQ5P1RQ5x2aQ6b3gQ6f3lS6j3u3}Q6o3|Q7b5QS8Y6c6dQ8^6kQ8`6nQ8o7cQ9T8ZQ9U8_Q9W8bQ9`8pQ9h9VQ;P:zQ;[;TR;];UV!vQ'V-S%YaOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&f&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7yS#vz!j!r:y$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cR;P;b%YbOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&f&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7yQ%_j!S%py!i!t%s%t%u&|'[']'^'b'l*^+_+`,w-Z-[-c/h0`2Q2X2`3zS%vz!jQ+[%qQ,O&ZW1R,P,Q,R,SU5Q1S1T1US7c5R5SQ8p7d!r:z$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cQ;T;aR;U;b$|eOPXYstuvw!Z!`!g!o#R#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&i&k&l&n&r&z'X'i'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7yY#aWZ#V#Y'y!S%cm#g#h#k%^%a(S(^(_(`*z*{*},^,t-r-x-y-z-|1o2g2h5k5|Q,]&f!p:{$[$m)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cR;O'OS'S!e%bR2O,}%OdOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|,_,b,g-W-`-n-t.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2w4r4|5^5_5b5u7Z7`7o7y!r)W$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cQ,[&fQ0W+WQ2k.UQ6R2oR8P6S!f$Uc#X%j'x(O(j(q)Q)R)S)T)Y)^+i-g-l-q-s.^.d.{/}2Z2b2v3X4T4]5t5y6V7w8{9s!T:Q)V)h,x.j1v1y2{3T3U3V3W3[3b5n6W6]6^7U7s8Q8U8V9Z9b;V!b$Wc#X%j'x(O(j(q)S)T)Y)^+i-g-l-q-s.^.d.{/}2Z2b2v3X4T4]5t5y6V7w8{9s!P:S)V)h,x.j1v1y2{3V3W3[3b5n6W6]6^7U7s8Q8U8V9Z9b;V!^$[c#X%j'x(O(j(q)Y)^+i-g-l-q-s.^.d.{/}2Z2b2v3X4T4]5t5y6V7w8{9sQ3f/Tz;c)V)h,x.j1v1y2{3[3b5n6W6]6^7U7s8Q8U8V9Z9b;VQ;h;jR;i;k&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cS$nh$oR3_.p'TgOPWXYZhstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m$o%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.p.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cT$jf$pQ$hfS)a$k)eR)m$pT$if$pT)c$k)e'ThOPWXYZhstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m$o%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.p.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cT$nh$oQ$qhR)l$o%YjOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&f&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7y!s;a$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;c#clOPXZst!Z!`!o#R#c#n#{$m%f&b&e&f&i&k&l&n&r&z'X(v)j*|+W,_,b,g-W.U.q/z0}1_1`1b1d1g1j1l2o3^4r4|5^5_5b6S7Z7`7ov$}i#w%W%X%])z)|*U*j*k._/^/|3f4O8X;`;h;i#O(m#u$c$d$x${)q)w)}*[+V+Y+q+t.T/P/_/a0q0t0|2n3p3x4W4Y4{6P6g6p7]7|8l9O9^9f:^:`:b:i:k:m:q:s:w;l;mQ*t%ZQ.|)vg3Z:X:Y:_:a:c:j:l:n:r:t:xv$yi#w%W%X%])z)|*U*j*k._/^/|3f4O8X;`;h;iQ*W$zS*a$|*dQ*u%[Q/l*b#O;R#u$c$d$x${)q)w)}*[+V+Y+q+t.T/P/_/a0q0t0|2n3p3x4W4Y4{6P6g6p7]7|8l9O9^9f:^:`:b:i:k:m:q:s:w;l;mf;S:X:Y:_:a:c:j:l:n:r:t:xQ;W;dQ;X;eQ;Y;fR;Z;gv$}i#w%W%X%])z)|*U*j*k._/^/|3f4O8X;`;h;i#O(m#u$c$d$x${)q)w)}*[+V+Y+q+t.T/P/_/a0q0t0|2n3p3x4W4Y4{6P6g6p7]7|8l9O9^9f:^:`:b:i:k:m:q:s:w;l;mg3Z:X:Y:_:a:c:j:l:n:r:t:xnoOXst!Z#c%f&i&k&l&n,b,g1g1jQ*Z${Q,p&uQ,q&wR3o/_$^%Oi#u#w$c$d$x${%W%X%])q)w)z)|)}*U*[*j*k+V+Y+q+t.T._/P/^/_/a/|0q0t0|2n3f3p3x4O4W4Y4{6P6g6p7]7|8X8l9O9^9f:X:Y:^:_:`:a:b:c:i:j:k:l:m:n:q:r:s:t:w:x;`;h;i;l;mQ+s&SQ0s+uQ4l0rR7R4mT*c$|*dS*c$|*dT4t0z4uS/j*`4rT3|/r7ZQ+Z%pQ/k*aQ0]+[Q1Q,OQ5P1RQ7b5QQ8o7cR9`8pn)z$v(o*v/]/t/u2t3m4S6a6r9S;Q;^;_!Y:i(k)[*Q*Y.[.x.}/T/b0U0p0r2s3n3r4k4m6T6U6h6l6t6v8]8a9g;j;k]:j3Y6[8R9Q9R9pp)|$v(o*v/R/]/t/u2t3m4S6a6r9S;Q;^;_![:k(k)[*Q*Y.[.x.}/T/b0U0p0r2q2s3n3r4k4m6T6U6h6l6t6v8]8a9g;j;k_:l3Y6[8R8S9Q9R9prnOXst!V!Z#c%f&`&i&k&l&n,b,g1g1jQ&]!UR,_&frnOXst!V!Z#c%f&`&i&k&l&n,b,g1g1jR&]!UQ+w&TR0o+psnOXst!V!Z#c%f&`&i&k&l&n,b,g1g1jQ0{+|S4z1O1PU7[4x4y4}S8k7^7_S9[8j8mQ9i9]R9n9jQ&d!VR,W&`R5W1XS%x|%}R0h+gQ&i!WR,b&jR,h&oT1h,g1jR,l&pQ,k&pR1q,lQ'p!zR-h'pSsOtQ#cXT%is#cQ!}TR'r!}Q#QUR't#QQ)s$uR.y)sQ#TVR'v#TQ#WWU'|#W'}-oQ'}#XR-o(OQ,{'PR1},{Q.`(oR2u.`Q.c(qS2x.c2yR2y.dQ-S'VR2R-SY!rQ'V-S0z4uR'a!rS#^W%aU(T#^(U-pQ(U#_R-p(PQ-O'SR2P-Ot`OXst!V!Z#c%f&`&b&i&k&l&n,b,g1g1jS#gZ%^U#q`#g-yR-y(`Q(a#iQ-v(]W.O(a-v2d5zQ2d-wR5z2eQ)e$kR.r)eQ$ohR)k$oQ$bcU)Z$b-k:WQ-k9sR:W)hQ/W*RW3i/W3j6e8[U3j/X/Y/ZS6e3k3lR8[6f#o)x$v(k(o)[*Q*Y*q*r*v.Y.Z.[.x.}/R/S/T/]/b/t/u0U0p0r2q2r2s2t3Y3m3n3r4S4k4m6T6U6Y6Z6[6a6h6l6r6t6v8R8S8T8]8a9Q9R9S9g9p;Q;^;_;j;kQ/`*YU3q/`3s6iQ3s/bR6i3rQ*d$|R/n*dQ*m%QR/w*mQ4X0UR6u4XQ+O%dR0S+OQ4o0uS7T4o8iR8i7UQ+y&UR0x+yQ4u0zR7X4uQ1W,TS5U1W7fR7f5WQ0c+cW4b0c4d6{8eQ4d0fQ6{4cR8e6|Q+h%xR0i+hQ1j,gR5f1jYrOXst#cQ&m!ZQ+Q%fQ,a&iQ,c&kQ,d&lQ,f&nQ1e,bS1h,g1jR5e1gQ%hpQ&q!_Q&t!aQ&v!bQ&x!cQ'h!tQ+P%eQ+]%rQ+o&OQ,V&dQ,n&sW-_'b'j'k'nQ-f'fQ/m*cQ0^+^S1Z,W,ZQ1r,mQ1s,pQ1t,qQ2Y-^W2[-a-b-e-gQ4Z0_Q4g0lQ4j0pQ5O1QQ5Y1]Q5d1fU5s2Z2^2aQ5v2_Q6w4[Q7P4iQ7Q4kQ7W4tQ7a5PQ7g5XS7v5t5xQ7x5wQ8f6}Q8n7bQ8s7hQ8z7wQ9Y8gQ9_8oQ9c8{R9k9`Q%ryQ'Z!iQ'f!tU+^%s%t%uQ,u&|U-Y'[']'^S-^'b'lQ/d*^S0_+_+`Q1z,wS2W-Z-[Q2_-cQ3v/hQ4[0`Q5o2QQ5r2XQ5w2`R6m3zS$wi;`R*n%RU%Qi%R;`R/v*lQ$viS(k#u+YQ(o#wS)[$c$dQ*Q$xQ*Y${Q*q%WQ*r%XQ*v%]Q.Y:^Q.Z:`Q.[:bQ.x)qS.})w/PQ/R)zQ/S)|Q/T)}Q/]*UQ/b*[Q/t*jQ/u*kh0U+V.T0|2n4{6P7]7|8l9O9^9fQ0p+qQ0r+tQ2q:iQ2r:kQ2s:mQ2t._S3Y:X:YQ3m/^Q3n/_Q3r/aQ4S/|Q4k0qQ4m0tQ6T:qQ6U:sQ6Y:_Q6Z:aQ6[:cQ6a3fQ6h3pQ6l3xQ6r4OQ6t4WQ6v4YQ8R:nQ8S:jQ8T:lQ8]6gQ8a6pQ9Q:rQ9R:tQ9S8XQ9g:wQ9p:xQ;Q;`Q;^;hQ;_;iQ;j;lR;k;mnpOXst!Z#c%f&i&k&l&n,b,g1g1jQ!fPS#eZ#nQ&s!`U'_!o4r7ZQ'u#RQ(x#{Q)i$mS,Z&b&eQ,`&fQ,m&rQ,r&zQ-U'XQ.f(vQ.v)jQ0Q*|Q0X+WQ1c,_Q2U-WQ2l.UQ3a.qQ4Q/zQ4y0}Q5[1_Q5]1`Q5a1bQ5c1dQ5h1lQ6O2oQ6_3^Q7_4|Q7k5^Q7l5_Q7n5bQ8O6SQ8m7`R8w7o#WcOPXZst!Z!`!o#c#n#{%f&b&e&f&i&k&l&n&r&z'X(v*|+W,_,b,g-W.U/z0}1_1`1b1d1g1j1l2o4r4|5^5_5b6S7Z7`7oQ#XWQ#dYQ%juQ%kvS%mw!gS'x#V'{Q(O#YQ(j#tQ(q#xQ(y$OQ(z$PQ({$QQ(|$RQ(}$SQ)O$TQ)P$UQ)Q$VQ)R$WQ)S$XQ)T$YQ)V$[Q)Y$aQ)^$eW)h$m)j.q3^Q+T%lQ+i%yS,x'O1{Q-g'iS-l'y-nQ-q(RQ-s(YQ.^(nQ.d(rQ.h9qQ.j9tQ.k9uQ.l9xQ.{)uQ/}*xQ1v,sQ1y,vQ2Z-`Q2b-tQ2v.bQ2{9yQ2|9zQ2}9{Q3O9|Q3P9}Q3Q:OQ3R:PQ3S:QQ3T:RQ3U:SQ3V:TQ3W:UQ3X.iQ3[:ZQ3]:dQ3b:VQ4T0PQ4]0aQ5n:eQ5t2]Q5y2cQ6V2wQ6W:fQ6]:hQ6^:oQ7U4pQ7s5lQ7w5uQ8Q:pQ8U:uQ8V:vQ8{7yQ9Z8hQ9b8yQ9s#RR;V;cR#ZWR'Q!eY!tQ'V-S0z4uS&|!e,zQ'b!rS'l!u!xS'n!y4wS,w&}'US-c'c'dQ-e'eQ2Q-QR2`-dR(p#wR(s#xQ!fQT-R'V-S]!qQ!r'V-S0z4uQ#o]R'`9rT#jZ%^S#iZ%^S%dm,^U(]#g#h#kS-w(^(_Q-{(`Q0R*}Q2e-xU2f-y-z-|S5{2g2hR7z5|`#]W#V#Y%a'y(S*z-rr#fZm#g#h#k%^(^(_(`*}-x-y-z-|2g2h5|Q1a,^Q1w,tQ5j1oQ7r5kT:}'O*{T#`W%aS#_W%aS'z#V(SS(P#Y*zS,y'O*{T-m'y-rT'T!e%bQ$kfR)o$pT)d$k)eR3`.pT*T$x*VR*]${Q0V+VQ2j.TQ4x0|Q6Q2nQ7^4{Q7}6PQ8j7]Q8|7|Q9]8lQ9e9OQ9j9^R9m9fnqOXst!Z#c%f&i&k&l&n,b,g1g1jQ&c!VR,V&`tmOXst!U!V!Z#c%f&`&i&k&l&n,b,g1g1jR,^&fT%em,^R0v+vR,U&^Q%||R+n%}R+d%wT&g!W&jT&h!W&jT1i,g1j",nodeNames:"⚠ ArithOp ArithOp LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > TypeParamList TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXStartTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:367,context:trackNewline,nodeProps:[["group",-26,7,15,17,63,200,204,208,209,211,214,217,227,229,235,237,239,241,244,250,256,258,260,262,264,266,267,"Statement",-32,11,12,26,29,30,36,46,49,50,52,57,65,73,77,79,81,82,104,105,114,115,132,135,137,138,139,140,142,143,163,164,166,"Expression",-23,25,27,31,35,37,39,167,169,171,172,174,175,176,178,179,180,182,183,184,194,196,198,199,"Type",-3,85,97,103,"ClassItem"],["openedBy",32,"InterpolationStart",51,"[",55,"{",70,"(",144,"JSXStartTag",156,"JSXStartTag JSXStartCloseTag"],["closedBy",34,"InterpolationEnd",45,"]",56,"}",71,")",145,"JSXSelfCloseEndTag JSXEndTag",161,"JSXEndTag"]],propSources:[jsHighlight],skippedNodes:[0,3,4,270],repeatNodeCount:33,tokenData:"$Fl(CSR!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#8g!R![#:v![!]#Gv!]!^#IS!^!_#J^!_!`#Nu!`!a$#a!a!b$(n!b!c$,m!c!}Er!}#O$-w#O#P$/R#P#Q$4j#Q#R$5t#R#SEr#S#T$7R#T#o$8]#o#p$<m#p#q$=c#q#r$>s#r#s$@P#s$f%Z$f$g+g$g#BYEr#BY#BZ$AZ#BZ$ISEr$IS$I_$AZ$I_$I|Er$I|$I}$Df$I}$JO$Df$JO$JTEr$JT$JU$AZ$JU$KVEr$KV$KW$AZ$KW&FUEr&FU&FV$AZ&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$AZ?HUOEr(n%d_$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$e&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$e&j'|!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU'|!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$e&j'ypOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU'ypOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z(CS+rq$e&j'yp'|!b'o(;dOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z(CS.ST'z#S$e&j'p(;dO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c(CS.n_$e&j'yp'|!b'p(;dOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`/x`$e&j!m$Ip'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S1V`#r$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S2d_#r$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$2b3l_'x$(n$e&j'|!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k*r4r_$e&j'|!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k)`5vX$e&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q)`6jT$`#t$e&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#t6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y#t7bO$`#t#t7eP;=`<%l6y)`7kP;=`<%l5q*r7w]$`#t$e&j'|!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}%W8uZ'|!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p%W9oU$`#t'|!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}%W:UP;=`<%l8p*r:[P;=`<%l4k#%|:hh$e&j'yp'|!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__US$e&j'yp'|!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]US$e&j'|!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXUS$e&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSUSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWUS'|!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]US$e&j'ypOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWUS'ypOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYUS'yp'|!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S#%|C}i$e&j(c!L^'yp'|!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr#%|EoP;=`<%lCr(CSFRk$e&j'yp'|!b(W!LY'v&;d$X#tOY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$e&j'yp'|!b$X#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv(CSJPP;=`<%lEr%#SJ_`$e&j'yp'|!b#j$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SKl_$e&j#|$Id'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%DfLva(l%<v$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SNW`$e&j#v$Id'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$2b! c_'{$)`$e&j'ypOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b*Q!!i_$e&j'ypOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b)`!#mX$e&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h#t!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y#t!$oP;=`<%l!$Y)`!$uP;=`<%l!#h*Q!%R]$`#t$e&j'ypOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r$f!&PZ'ypOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z$f!&yU$`#t'ypOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r$f!'`P;=`<%l!%z*Q!'fP;=`<%l!!b(*Q!'t_!i(!b$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'l!)O_!hM|$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h!*[b$e&j'yp'|!b'w#)d#k$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S!+o`$e&j'yp'|!b#h$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&-O!,|`$e&j'yp'|!bl&%`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&C[!.Z_!W&;l$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!/ec$e&j'yp'|!bz'<nOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!0ya$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!2Z_!VMt$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!3eg$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!5Vg$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!6wc$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!8_c$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!9uf$e&j'yp'|!b#i$IdOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpxz!;Zz{#,f{!P!;Z!P!Q#-{!Q!^!;Z!^!_#'Z!_!`#5k!`!a#7Q!a!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(r!;fb$e&j'yp'|!b!SSOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(Q!<w`$e&j'|!b!SSOY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eb!Q!^!<n!^!_!GY!_!}!<n!}#O!Ja#O#P!Dj#P#o!<n#o#p!GY#p;'S!<n;'S;=`!Kj<%lO!<n&n!>Q^$e&j!SSOY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@Y!_!}!=y!}#O!Bw#O#P!Dj#P#o!=y#o#p!@Y#p;'S!=y;'S;=`!E[<%lO!=y&n!?Ta$e&j!SSO!^&c!_#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&cS!@_X!SSOY!@YZ!P!@Y!P!Q!@z!Q!}!@Y!}#O!Ac#O#P!Bb#P;'S!@Y;'S;=`!Bq<%lO!@YS!APU!SS#Z#[!@z#]#^!@z#a#b!@z#g#h!@z#i#j!@z#m#n!@zS!AfVOY!AcZ#O!Ac#O#P!A{#P#Q!@Y#Q;'S!Ac;'S;=`!B[<%lO!AcS!BOSOY!AcZ;'S!Ac;'S;=`!B[<%lO!AcS!B_P;=`<%l!AcS!BeSOY!@YZ;'S!@Y;'S;=`!Bq<%lO!@YS!BtP;=`<%l!@Y&n!B|[$e&jOY!BwYZ&cZ!^!Bw!^!_!Ac!_#O!Bw#O#P!Cr#P#Q!=y#Q#o!Bw#o#p!Ac#p;'S!Bw;'S;=`!Dd<%lO!Bw&n!CwX$e&jOY!BwYZ&cZ!^!Bw!^!_!Ac!_#o!Bw#o#p!Ac#p;'S!Bw;'S;=`!Dd<%lO!Bw&n!DgP;=`<%l!Bw&n!DoX$e&jOY!=yYZ&cZ!^!=y!^!_!@Y!_#o!=y#o#p!@Y#p;'S!=y;'S;=`!E[<%lO!=y&n!E_P;=`<%l!=y(Q!Eki$e&j'|!b!SSOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#Z&}#Z#[!Eb#[#]&}#]#^!Eb#^#a&}#a#b!Eb#b#g&}#g#h!Eb#h#i&}#i#j!Eb#j#m&}#m#n!Eb#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!f!GaZ'|!b!SSOY!GYZw!GYwx!@Yx!P!GY!P!Q!HS!Q!}!GY!}#O!Ic#O#P!Bb#P;'S!GY;'S;=`!JZ<%lO!GY!f!HZb'|!b!SSOY'}Zw'}x#O'}#P#Z'}#Z#[!HS#[#]'}#]#^!HS#^#a'}#a#b!HS#b#g'}#g#h!HS#h#i'}#i#j!HS#j#m'}#m#n!HS#n;'S'};'S;=`(f<%lO'}!f!IhX'|!bOY!IcZw!Icwx!Acx#O!Ic#O#P!A{#P#Q!GY#Q;'S!Ic;'S;=`!JT<%lO!Ic!f!JWP;=`<%l!Ic!f!J^P;=`<%l!GY(Q!Jh^$e&j'|!bOY!JaYZ&cZw!Jawx!Bwx!^!Ja!^!_!Ic!_#O!Ja#O#P!Cr#P#Q!<n#Q#o!Ja#o#p!Ic#p;'S!Ja;'S;=`!Kd<%lO!Ja(Q!KgP;=`<%l!Ja(Q!KmP;=`<%l!<n'`!Ky`$e&j'yp!SSOY!KpYZ&cZr!Kprs!=ys!P!Kp!P!Q!L{!Q!^!Kp!^!_!Ns!_!}!Kp!}#O##z#O#P!Dj#P#o!Kp#o#p!Ns#p;'S!Kp;'S;=`#%T<%lO!Kp'`!MUi$e&j'yp!SSOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#Z(r#Z#[!L{#[#](r#]#^!L{#^#a(r#a#b!L{#b#g(r#g#h!L{#h#i(r#i#j!L{#j#m(r#m#n!L{#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rt!NzZ'yp!SSOY!NsZr!Nsrs!@Ys!P!Ns!P!Q# m!Q!}!Ns!}#O#!|#O#P!Bb#P;'S!Ns;'S;=`##t<%lO!Nst# tb'yp!SSOY)rZr)rs#O)r#P#Z)r#Z#[# m#[#])r#]#^# m#^#a)r#a#b# m#b#g)r#g#h# m#h#i)r#i#j# m#j#m)r#m#n# m#n;'S)r;'S;=`*Z<%lO)rt##RX'ypOY#!|Zr#!|rs!Acs#O#!|#O#P!A{#P#Q!Ns#Q;'S#!|;'S;=`##n<%lO#!|t##qP;=`<%l#!|t##wP;=`<%l!Ns'`#$R^$e&j'ypOY##zYZ&cZr##zrs!Bws!^##z!^!_#!|!_#O##z#O#P!Cr#P#Q!Kp#Q#o##z#o#p#!|#p;'S##z;'S;=`#$}<%lO##z'`#%QP;=`<%l##z'`#%WP;=`<%l!Kp(r#%fk$e&j'yp'|!b!SSOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#Z%Z#Z#[#%Z#[#]%Z#]#^#%Z#^#a%Z#a#b#%Z#b#g%Z#g#h#%Z#h#i%Z#i#j#%Z#j#m%Z#m#n#%Z#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#W#'d]'yp'|!b!SSOY#'ZZr#'Zrs!GYsw#'Zwx!Nsx!P#'Z!P!Q#(]!Q!}#'Z!}#O#)w#O#P!Bb#P;'S#'Z;'S;=`#*w<%lO#'Z#W#(fe'yp'|!b!SSOY*gZr*grs'}sw*gwx)rx#O*g#P#Z*g#Z#[#(]#[#]*g#]#^#(]#^#a*g#a#b#(]#b#g*g#g#h#(]#h#i*g#i#j#(]#j#m*g#m#n#(]#n;'S*g;'S;=`+Z<%lO*g#W#*OZ'yp'|!bOY#)wZr#)wrs!Icsw#)wwx#!|x#O#)w#O#P!A{#P#Q#'Z#Q;'S#)w;'S;=`#*q<%lO#)w#W#*tP;=`<%l#)w#W#*zP;=`<%l#'Z(r#+W`$e&j'yp'|!bOY#*}YZ&cZr#*}rs!Jasw#*}wx##zx!^#*}!^!_#)w!_#O#*}#O#P!Cr#P#Q!;Z#Q#o#*}#o#p#)w#p;'S#*};'S;=`#,Y<%lO#*}(r#,]P;=`<%l#*}(r#,cP;=`<%l!;Z(CS#,sb$e&j'yp'|!b'q(;d!SSOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(CS#.W_$e&j'yp'|!bR(;dOY#-{YZ&cZr#-{rs#/Vsw#-{wx#2gx!^#-{!^!_#4f!_#O#-{#O#P#0X#P#o#-{#o#p#4f#p;'S#-{;'S;=`#5e<%lO#-{(Bb#/`]$e&j'|!bR(;dOY#/VYZ&cZw#/Vwx#0Xx!^#/V!^!_#1j!_#O#/V#O#P#0X#P#o#/V#o#p#1j#p;'S#/V;'S;=`#2a<%lO#/V(AO#0`X$e&jR(;dOY#0XYZ&cZ!^#0X!^!_#0{!_#o#0X#o#p#0{#p;'S#0X;'S;=`#1d<%lO#0X(;d#1QSR(;dOY#0{Z;'S#0{;'S;=`#1^<%lO#0{(;d#1aP;=`<%l#0{(AO#1gP;=`<%l#0X(<v#1qW'|!bR(;dOY#1jZw#1jwx#0{x#O#1j#O#P#0{#P;'S#1j;'S;=`#2Z<%lO#1j(<v#2^P;=`<%l#1j(Bb#2dP;=`<%l#/V(Ap#2p]$e&j'ypR(;dOY#2gYZ&cZr#2grs#0Xs!^#2g!^!_#3i!_#O#2g#O#P#0X#P#o#2g#o#p#3i#p;'S#2g;'S;=`#4`<%lO#2g(<U#3pW'ypR(;dOY#3iZr#3irs#0{s#O#3i#O#P#0{#P;'S#3i;'S;=`#4Y<%lO#3i(<U#4]P;=`<%l#3i(Ap#4cP;=`<%l#2g(=h#4oY'yp'|!bR(;dOY#4fZr#4frs#1jsw#4fwx#3ix#O#4f#O#P#0{#P;'S#4f;'S;=`#5_<%lO#4f(=h#5bP;=`<%l#4f(CS#5hP;=`<%l#-{%#W#5xb$e&j#|$Id'yp'|!b!SSOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z+h#7_b$U#t$e&j'yp'|!b!SSOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z$/l#8rp$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#:v![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#:v#S#U%Z#U#V#>Q#V#X%Z#X#Y!4|#Y#b%Z#b#c#<v#c#d#AY#d#l%Z#l#m#D[#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#;Rk$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#:v![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#:v#S#X%Z#X#Y!4|#Y#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#=R_$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#>Zd$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#?i!R!S#?i!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#?i#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#?tf$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#?i!R!S#?i!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#?i#S#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Acc$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#Bn!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#Bn#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Bye$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#Bn!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#Bn#S#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Deg$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#E|![!^%Z!^!_*g!_!c%Z!c!i#E|!i#O%Z#O#P&c#P#R%Z#R#S#E|#S#T%Z#T#Z#E|#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#FXi$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#E|![!^%Z!^!_*g!_!c%Z!c!i#E|!i#O%Z#O#P&c#P#R%Z#R#S#E|#S#T%Z#T#Z#E|#Z#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh#HT_!b$b$e&j#z%<f'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#I___l$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS#Jm^(P!*v!f'.r'yp'|!b$V)d(pSOY*gZr*grs'}sw*gwx)rx!P*g!P!Q#Ki!Q!^*g!^!_#L_!_!`#NP!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#KrX$g&j'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#LhZ#l$Id'yp'|!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#MZ!`#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#MdX#|$Id'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#NYX#m$Id'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Gh$ Qa#Y%?x$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$!V!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#W$!b_#e$Ih$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh$#paeBf#m$Id$b#|$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$$u!`!a$&P!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$%Q_#m$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$&[a#l$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$'a!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$'l`#l$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h$(yc(d$Ip$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P$*U!P!^%Z!^!_*g!_!a%Z!a!b$+`!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+`$*a_{'#p$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$+k`$e&j#w$Id'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&^$,x_!y!Ln$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(@^$.S_}(8n$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/WZ$e&jO!^$/y!^!_$0a!_#i$/y#i#j$0f#j#l$/y#l#m$2X#m#o$/y#o#p$0a#p;'S$/y;'S;=`$4d<%lO$/y(n$0QT]#S$e&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0fO]#S(n$0k[$e&jO!Q&c!Q![$1a![!^&c!_!c&c!c!i$1a!i#T&c#T#Z$1a#Z#o&c#o#p$3w#p;'S&c;'S;=`&w<%lO&c(n$1fZ$e&jO!Q&c!Q![$2X![!^&c!_!c&c!c!i$2X!i#T&c#T#Z$2X#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2^Z$e&jO!Q&c!Q![$3P![!^&c!_!c&c!c!i$3P!i#T&c#T#Z$3P#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3UZ$e&jO!Q&c!Q![$/y![!^&c!_!c&c!c!i$/y!i#T&c#T#Z$/y#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$3zR!Q![$4T!c!i$4T#T#Z$4T#S$4WS!Q![$4T!c!i$4T#T#Z$4T#q#r$0a(n$4gP;=`<%l$/y!2r$4u_!T!+S$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$6P`#t$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&,v$7^_$e&j'yp'|!b(T&%WOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$8lk$e&j'yp'|!b(W!LY'v&;d$Z#tOY%ZYZ&cZr%Zrs&}st%Ztu$8]uw%Zwx(rx}%Z}!O$:a!O!Q%Z!Q![$8]![!^%Z!^!_*g!_!c%Z!c!}$8]!}#O%Z#O#P&c#P#R%Z#R#S$8]#S#T%Z#T#o$8]#o#p*g#p$g%Z$g;'S$8];'S;=`$<g<%lO$8]+d$:lk$e&j'yp'|!b$Z#tOY%ZYZ&cZr%Zrs&}st%Ztu$:auw%Zwx(rx}%Z}!O$:a!O!Q%Z!Q![$:a![!^%Z!^!_*g!_!c%Z!c!}$:a!}#O%Z#O#P&c#P#R%Z#R#S$:a#S#T%Z#T#o$:a#o#p*g#p$g%Z$g;'S$:a;'S;=`$<a<%lO$:a+d$<dP;=`<%l$:a(CS$<jP;=`<%l$8]!5p$<vX!Y!3l'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Df$=na(k%<v$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+`#q;'S%Z;'S;=`+a<%lO%Z%#`$?Q_!X$I`p`$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(r$@[_!nS$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$Al|$e&j'yp'|!b'o(;d(W!LY'v&;d$X#tOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$AZ#BZ$ISEr$IS$I_$AZ$I_$JTEr$JT$JU$AZ$JU$KVEr$KV$KW$AZ$KW&FUEr&FU&FV$AZ&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$AZ?HUOEr(CS$Dwk$e&j'yp'|!b'p(;d(W!LY'v&;d$X#tOY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[noSemicolon,incdecToken,2,3,4,5,6,7,8,9,10,11,12,13,insertSemicolon,new LocalTokenGroup("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOr~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!P~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(V~~",141,328),new LocalTokenGroup("j~RQYZXz{^~^O's~~aP!P!Qd~iO't~~",25,310)],topRules:{Script:[0,5],SingleExpression:[1,268],SingleClassItem:[2,269]},dialects:{jsx:12801,ts:12803},dynamicPrecedences:{67:1,77:1,79:1,164:1,192:1},specialized:[{term:314,get:lr=>spec_identifier[lr]||-1},{term:330,get:lr=>spec_word[lr]||-1},{term:68,get:lr=>spec_LessThan[lr]||-1}],tokenPrec:12827}),snippets=[snippetCompletion("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),snippetCompletion("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),snippetCompletion("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),snippetCompletion("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),snippetCompletion("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),snippetCompletion(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),snippetCompletion("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),snippetCompletion(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),snippetCompletion(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),snippetCompletion('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),snippetCompletion('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],typescriptSnippets=snippets.concat([snippetCompletion("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),snippetCompletion("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),snippetCompletion("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),cache=new NodeWeakMap,ScopeNodes=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function defID(lr){return(or,ar)=>{let cr=or.node.getChild("VariableDefinition");return cr&&ar(cr,lr),!0}}const functionContext=["FunctionDeclaration"],gatherCompletions={FunctionDeclaration:defID("function"),ClassDeclaration:defID("class"),ClassExpression:()=>!0,EnumDeclaration:defID("constant"),TypeAliasDeclaration:defID("type"),NamespaceDeclaration:defID("namespace"),VariableDefinition(lr,or){lr.matchContext(functionContext)||or(lr,"variable")},TypeDefinition(lr,or){or(lr,"type")},__proto__:null};function getScope(lr,or){let ar=cache.get(or);if(ar)return ar;let cr=[],ur=!0;function hr(fr,dr){let pr=lr.sliceString(fr.from,fr.to);cr.push({label:pr,type:dr})}return or.cursor(IterMode.IncludeAnonymous).iterate(fr=>{if(ur)ur=!1;else if(fr.name){let dr=gatherCompletions[fr.name];if(dr&&dr(fr,hr)||ScopeNodes.has(fr.name))return!1}else if(fr.to-fr.from>8192){for(let dr of getScope(lr,fr.node))cr.push(dr);return!1}}),cache.set(or,cr),cr}const Identifier=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,dontComplete=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function localCompletionSource(lr){let or=syntaxTree(lr.state).resolveInner(lr.pos,-1);if(dontComplete.indexOf(or.name)>-1)return null;let ar=or.name=="VariableName"||or.to-or.from<20&&Identifier.test(lr.state.sliceDoc(or.from,or.to));if(!ar&&!lr.explicit)return null;let cr=[];for(let ur=or;ur;ur=ur.parent)ScopeNodes.has(ur.name)&&(cr=cr.concat(getScope(lr.state.doc,ur)));return{options:cr,from:ar?or.from:lr.pos,validFor:Identifier}}const javascriptLanguage=LRLanguage.define({name:"javascript",parser:parser.configure({props:[indentNodeProp.add({IfStatement:continuedIndent({except:/^\s*({|else\b)/}),TryStatement:continuedIndent({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:flatIndent,SwitchBody:lr=>{let or=lr.textAfter,ar=/^\s*\}/.test(or),cr=/^\s*(case|default)\b/.test(or);return lr.baseIndent+(ar?0:cr?1:2)*lr.unit},Block:delimitedIndent({closing:"}"}),ArrowFunction:lr=>lr.baseIndent+lr.unit,"TemplateString BlockComment":()=>null,"Statement Property":continuedIndent({except:/^{/}),JSXElement(lr){let or=/^\s*<\//.test(lr.textAfter);return lr.lineIndent(lr.node.from)+(or?0:lr.unit)},JSXEscape(lr){let or=/\s*\}/.test(lr.textAfter);return lr.lineIndent(lr.node.from)+(or?0:lr.unit)},"JSXOpenTag JSXSelfClosingTag"(lr){return lr.column(lr.node.from)+lr.unit}}),foldNodeProp.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":foldInside,BlockComment(lr){return{from:lr.from+2,to:lr.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),jsxSublanguage={test:lr=>/^JSX/.test(lr.name),facet:defineLanguageFacet({commentTokens:{block:{open:"{/*",close:"*/}"}}})},typescriptLanguage=javascriptLanguage.configure({dialect:"ts"},"typescript"),jsxLanguage=javascriptLanguage.configure({dialect:"jsx",props:[sublanguageProp.add(lr=>lr.isTop?[jsxSublanguage]:void 0)]}),tsxLanguage=javascriptLanguage.configure({dialect:"jsx ts",props:[sublanguageProp.add(lr=>lr.isTop?[jsxSublanguage]:void 0)]},"typescript");let kwCompletion=lr=>({label:lr,type:"keyword"});const keywords$1="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(kwCompletion),typescriptKeywords=keywords$1.concat(["declare","implements","private","protected","public"].map(kwCompletion));function javascript(lr={}){let or=lr.jsx?lr.typescript?tsxLanguage:jsxLanguage:lr.typescript?typescriptLanguage:javascriptLanguage,ar=lr.typescript?typescriptSnippets.concat(typescriptKeywords):snippets.concat(keywords$1);return new LanguageSupport(or,[javascriptLanguage.data.of({autocomplete:ifNotIn(dontComplete,completeFromList(ar))}),javascriptLanguage.data.of({autocomplete:localCompletionSource}),lr.jsx?autoCloseTags$1:[]])}function findOpenTag(lr){for(;;){if(lr.name=="JSXOpenTag"||lr.name=="JSXSelfClosingTag"||lr.name=="JSXFragmentTag")return lr;if(lr.name=="JSXEscape"||!lr.parent)return null;lr=lr.parent}}function elementName$1(lr,or,ar=lr.length){for(let cr=or==null?void 0:or.firstChild;cr;cr=cr.nextSibling)if(cr.name=="JSXIdentifier"||cr.name=="JSXBuiltin"||cr.name=="JSXNamespacedName"||cr.name=="JSXMemberExpression")return lr.sliceString(cr.from,Math.min(cr.to,ar));return""}const android=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),autoCloseTags$1=EditorView.inputHandler.of((lr,or,ar,cr,ur)=>{if((android?lr.composing:lr.compositionStarted)||lr.state.readOnly||or!=ar||cr!=">"&&cr!="/"||!javascriptLanguage.isActiveAt(lr.state,or,-1))return!1;let hr=ur(),{state:fr}=hr,dr=fr.changeByRange(pr=>{var mr;let{head:gr}=pr,yr=syntaxTree(fr).resolveInner(gr-1,-1),br;if(yr.name=="JSXStartTag"&&(yr=yr.parent),!(fr.doc.sliceString(gr-1,gr)!=cr||yr.name=="JSXAttributeValue"&&yr.to>gr)){if(cr==">"&&yr.name=="JSXFragmentTag")return{range:pr,changes:{from:gr,insert:"</>"}};if(cr=="/"&&yr.name=="JSXStartCloseTag"){let Or=yr.parent,_r=Or.parent;if(_r&&Or.from==gr-2&&((br=elementName$1(fr.doc,_r.firstChild,gr))||((mr=_r.firstChild)===null||mr===void 0?void 0:mr.name)=="JSXFragmentTag")){let vr=`${br}>`;return{range:EditorSelection.cursor(gr+vr.length,-1),changes:{from:gr,insert:vr}}}}else if(cr==">"){let Or=findOpenTag(yr);if(Or&&!/^\/?>|^<\//.test(fr.doc.sliceString(gr,gr+2))&&(br=elementName$1(fr.doc,Or,gr)))return{range:pr,changes:{from:gr,insert:`</${br}>`}}}}return{range:pr}});return dr.changes.empty?!1:(lr.dispatch([hr,fr.update(dr,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),Targets=["_blank","_self","_top","_parent"],Charsets=["ascii","utf-8","utf-16","latin1","latin1"],Methods=["get","post","put","delete"],Encs=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],Bool=["true","false"],S$1={},Tags={a:{attrs:{href:null,ping:null,type:null,media:null,target:Targets,hreflang:null}},abbr:S$1,address:S$1,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:S$1,aside:S$1,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:S$1,base:{attrs:{href:null,target:Targets}},bdi:S$1,bdo:S$1,blockquote:{attrs:{cite:null}},body:S$1,br:S$1,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:Encs,formmethod:Methods,formnovalidate:["novalidate"],formtarget:Targets,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:S$1,center:S$1,cite:S$1,code:S$1,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:S$1,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:S$1,div:S$1,dl:S$1,dt:S$1,em:S$1,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:S$1,figure:S$1,footer:S$1,form:{attrs:{action:null,name:null,"accept-charset":Charsets,autocomplete:["on","off"],enctype:Encs,method:Methods,novalidate:["novalidate"],target:Targets}},h1:S$1,h2:S$1,h3:S$1,h4:S$1,h5:S$1,h6:S$1,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:S$1,hgroup:S$1,hr:S$1,html:{attrs:{manifest:null}},i:S$1,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:Encs,formmethod:Methods,formnovalidate:["novalidate"],formtarget:Targets,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:S$1,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:S$1,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:S$1,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:Charsets,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:S$1,noscript:S$1,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:S$1,param:{attrs:{name:null,value:null}},pre:S$1,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:S$1,rt:S$1,ruby:S$1,samp:S$1,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:Charsets}},section:S$1,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:S$1,source:{attrs:{src:null,type:null,media:null}},span:S$1,strong:S$1,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:S$1,summary:S$1,sup:S$1,table:S$1,tbody:S$1,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:S$1,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:S$1,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:S$1,time:{attrs:{datetime:null}},title:S$1,tr:S$1,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:S$1,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:S$1},GlobalAttrs={accesskey:null,class:null,contenteditable:Bool,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:Bool,autocorrect:Bool,autocapitalize:Bool,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":Bool,"aria-autocomplete":["inline","list","both","none"],"aria-busy":Bool,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":Bool,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":Bool,"aria-hidden":Bool,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":Bool,"aria-multiselectable":Bool,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":Bool,"aria-relevant":null,"aria-required":Bool,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},eventAttributes="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map(lr=>"on"+lr);for(let lr of eventAttributes)GlobalAttrs[lr]=null;class Schema{constructor(or,ar){this.tags=Object.assign(Object.assign({},Tags),or),this.globalAttrs=Object.assign(Object.assign({},GlobalAttrs),ar),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}Schema.default=new Schema;function elementName(lr,or,ar=lr.length){if(!or)return"";let cr=or.firstChild,ur=cr&&cr.getChild("TagName");return ur?lr.sliceString(ur.from,Math.min(ur.to,ar)):""}function findParentElement(lr,or=!1){for(;lr;lr=lr.parent)if(lr.name=="Element")if(or)or=!1;else return lr;return null}function allowedChildren(lr,or,ar){let cr=ar.tags[elementName(lr,findParentElement(or))];return(cr==null?void 0:cr.children)||ar.allTags}function openTags(lr,or){let ar=[];for(let cr=findParentElement(or);cr&&!cr.type.isTop;cr=findParentElement(cr.parent)){let ur=elementName(lr,cr);if(ur&&cr.lastChild.name=="CloseTag")break;ur&&ar.indexOf(ur)<0&&(or.name=="EndTag"||or.from>=cr.firstChild.to)&&ar.push(ur)}return ar}const identifier=/^[:\-\.\w\u00b7-\uffff]*$/;function completeTag(lr,or,ar,cr,ur){let hr=/\s*>/.test(lr.sliceDoc(ur,ur+5))?"":">",fr=findParentElement(ar,!0);return{from:cr,to:ur,options:allowedChildren(lr.doc,fr,or).map(dr=>({label:dr,type:"type"})).concat(openTags(lr.doc,ar).map((dr,pr)=>({label:"/"+dr,apply:"/"+dr+hr,type:"type",boost:99-pr}))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function completeCloseTag(lr,or,ar,cr){let ur=/\s*>/.test(lr.sliceDoc(cr,cr+5))?"":">";return{from:ar,to:cr,options:openTags(lr.doc,or).map((hr,fr)=>({label:hr,apply:hr+ur,type:"type",boost:99-fr})),validFor:identifier}}function completeStartTag(lr,or,ar,cr){let ur=[],hr=0;for(let fr of allowedChildren(lr.doc,ar,or))ur.push({label:"<"+fr,type:"type"});for(let fr of openTags(lr.doc,ar))ur.push({label:"</"+fr+">",type:"type",boost:99-hr++});return{from:cr,to:cr,options:ur,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}function completeAttrName(lr,or,ar,cr,ur){let hr=findParentElement(ar),fr=hr?or.tags[elementName(lr.doc,hr)]:null,dr=fr&&fr.attrs?Object.keys(fr.attrs):[],pr=fr&&fr.globalAttrs===!1?dr:dr.length?dr.concat(or.globalAttrNames):or.globalAttrNames;return{from:cr,to:ur,options:pr.map(mr=>({label:mr,type:"property"})),validFor:identifier}}function completeAttrValue(lr,or,ar,cr,ur){var hr;let fr=(hr=ar.parent)===null||hr===void 0?void 0:hr.getChild("AttributeName"),dr=[],pr;if(fr){let mr=lr.sliceDoc(fr.from,fr.to),gr=or.globalAttrs[mr];if(!gr){let yr=findParentElement(ar),br=yr?or.tags[elementName(lr.doc,yr)]:null;gr=(br==null?void 0:br.attrs)&&br.attrs[mr]}if(gr){let yr=lr.sliceDoc(cr,ur).toLowerCase(),br='"',Or='"';/^['"]/.test(yr)?(pr=yr[0]=='"'?/^[^"]*$/:/^[^']*$/,br="",Or=lr.sliceDoc(ur,ur+1)==yr[0]?"":yr[0],yr=yr.slice(1),cr++):pr=/^[^\s<>='"]*$/;for(let _r of gr)dr.push({label:_r,apply:br+_r+Or,type:"constant"})}}return{from:cr,to:ur,options:dr,validFor:pr}}function htmlCompletionFor(lr,or){let{state:ar,pos:cr}=or,ur=syntaxTree(ar).resolveInner(cr,-1),hr=ur.resolve(cr);for(let fr=cr,dr;hr==ur&&(dr=ur.childBefore(fr));){let pr=dr.lastChild;if(!pr||!pr.type.isError||pr.from<pr.to)break;hr=ur=dr,fr=pr.from}return ur.name=="TagName"?ur.parent&&/CloseTag$/.test(ur.parent.name)?completeCloseTag(ar,ur,ur.from,cr):completeTag(ar,lr,ur,ur.from,cr):ur.name=="StartTag"?completeTag(ar,lr,ur,cr,cr):ur.name=="StartCloseTag"||ur.name=="IncompleteCloseTag"?completeCloseTag(ar,ur,cr,cr):or.explicit&&(ur.name=="OpenTag"||ur.name=="SelfClosingTag")||ur.name=="AttributeName"?completeAttrName(ar,lr,ur,ur.name=="AttributeName"?ur.from:cr,cr):ur.name=="Is"||ur.name=="AttributeValue"||ur.name=="UnquotedAttributeValue"?completeAttrValue(ar,lr,ur,ur.name=="Is"?cr:ur.from,cr):or.explicit&&(hr.name=="Element"||hr.name=="Text"||hr.name=="Document")?completeStartTag(ar,lr,ur,cr):null}function htmlCompletionSource(lr){return htmlCompletionFor(Schema.default,lr)}function htmlCompletionSourceWith(lr){let{extraTags:or,extraGlobalAttributes:ar}=lr,cr=ar||or?new Schema(or,ar):Schema.default;return ur=>htmlCompletionFor(cr,ur)}const jsonParser=javascriptLanguage.parser.configure({top:"SingleExpression"}),defaultNesting=[{tag:"script",attrs:lr=>lr.type=="text/typescript"||lr.lang=="ts",parser:typescriptLanguage.parser},{tag:"script",attrs:lr=>lr.type=="text/babel"||lr.type=="text/jsx",parser:jsxLanguage.parser},{tag:"script",attrs:lr=>lr.type=="text/typescript-jsx",parser:tsxLanguage.parser},{tag:"script",attrs:lr=>lr.type=="importmap"||lr.type=="speculationrules",parser:jsonParser},{tag:"script",attrs(lr){return!lr.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(lr.type)},parser:javascriptLanguage.parser},{tag:"style",attrs(lr){return(!lr.lang||lr.lang=="css")&&(!lr.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(lr.type))},parser:cssLanguage.parser}],defaultAttrs=[{name:"style",parser:cssLanguage.parser.configure({top:"Styles"})}].concat(eventAttributes.map(lr=>({name:lr,parser:javascriptLanguage.parser}))),htmlPlain=LRLanguage.define({name:"html",parser:parser$2.configure({props:[indentNodeProp.add({Element(lr){let or=/^(\s*)(<\/)?/.exec(lr.textAfter);return lr.node.to<=lr.pos+or[0].length?lr.continue():lr.lineIndent(lr.node.from)+(or[2]?0:lr.unit)},"OpenTag CloseTag SelfClosingTag"(lr){return lr.column(lr.node.from)+lr.unit},Document(lr){if(lr.pos+/\s*/.exec(lr.textAfter)[0].length<lr.node.to)return lr.continue();let or=null,ar;for(let cr=lr.node;;){let ur=cr.lastChild;if(!ur||ur.name!="Element"||ur.to!=cr.to)break;or=cr=ur}return or&&!((ar=or.lastChild)&&(ar.name=="CloseTag"||ar.name=="SelfClosingTag"))?lr.lineIndent(or.from)+lr.unit:null}}),foldNodeProp.add({Element(lr){let or=lr.firstChild,ar=lr.lastChild;return!or||or.name!="OpenTag"?null:{from:or.to,to:ar.name=="CloseTag"?ar.from:lr.to}}}),bracketMatchingHandle.add({"OpenTag CloseTag":lr=>lr.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}}),htmlLanguage=htmlPlain.configure({wrap:configureNesting(defaultNesting,defaultAttrs)});function html$1(lr={}){let or="",ar;lr.matchClosingTags===!1&&(or="noMatch"),lr.selfClosingTags===!0&&(or=(or?or+" ":"")+"selfClosing"),(lr.nestedLanguages&&lr.nestedLanguages.length||lr.nestedAttributes&&lr.nestedAttributes.length)&&(ar=configureNesting((lr.nestedLanguages||[]).concat(defaultNesting),(lr.nestedAttributes||[]).concat(defaultAttrs)));let cr=ar?htmlPlain.configure({wrap:ar,dialect:or}):or?htmlLanguage.configure({dialect:or}):htmlLanguage;return new LanguageSupport(cr,[htmlLanguage.data.of({autocomplete:htmlCompletionSourceWith(lr)}),lr.autoCloseTags!==!1?autoCloseTags:[],javascript().support,css().support])}const selfClosers=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),autoCloseTags=EditorView.inputHandler.of((lr,or,ar,cr,ur)=>{if(lr.composing||lr.state.readOnly||or!=ar||cr!=">"&&cr!="/"||!htmlLanguage.isActiveAt(lr.state,or,-1))return!1;let hr=ur(),{state:fr}=hr,dr=fr.changeByRange(pr=>{var mr,gr,yr;let br=fr.doc.sliceString(pr.from-1,pr.to)==cr,{head:Or}=pr,_r=syntaxTree(fr).resolveInner(Or-1,-1),vr;if((_r.name=="TagName"||_r.name=="StartTag")&&(_r=_r.parent),br&&cr==">"&&_r.name=="OpenTag"){if(((gr=(mr=_r.parent)===null||mr===void 0?void 0:mr.lastChild)===null||gr===void 0?void 0:gr.name)!="CloseTag"&&(vr=elementName(fr.doc,_r.parent,Or))&&!selfClosers.has(vr)){let xr=Or+(fr.doc.sliceString(Or,Or+1)===">"?1:0),wr=`</${vr}>`;return{range:pr,changes:{from:Or,to:xr,insert:wr}}}}else if(br&&cr=="/"&&_r.name=="IncompleteCloseTag"){let xr=_r.parent;if(_r.from==Or-2&&((yr=xr.lastChild)===null||yr===void 0?void 0:yr.name)!="CloseTag"&&(vr=elementName(fr.doc,xr,Or))&&!selfClosers.has(vr)){let wr=Or+(fr.doc.sliceString(Or,Or+1)===">"?1:0),kr=`${vr}>`;return{range:EditorSelection.cursor(Or+kr.length,-1),changes:{from:Or,to:wr,insert:kr}}}}return{range:pr}});return dr.changes.empty?!1:(lr.dispatch([hr,fr.update(dr,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),data=defineLanguageFacet({commentTokens:{block:{open:"<!--",close:"-->"}}}),headingProp=new NodeProp,commonmark=parser$3.configure({props:[foldNodeProp.add(lr=>!lr.is("Block")||lr.is("Document")||isHeading(lr)!=null?void 0:(or,ar)=>({from:ar.doc.lineAt(or.from).to,to:or.to})),headingProp.add(isHeading),indentNodeProp.add({Document:()=>null}),languageDataProp.add({Document:data})]});function isHeading(lr){let or=/^(?:ATX|Setext)Heading(\d)$/.exec(lr.name);return or?+or[1]:void 0}function findSectionEnd(lr,or){let ar=lr;for(;;){let cr=ar.nextSibling,ur;if(!cr||(ur=isHeading(cr.type))!=null&&ur<=or)break;ar=cr}return ar.to}const headerIndent=foldService.of((lr,or,ar)=>{for(let cr=syntaxTree(lr).resolveInner(ar,-1);cr&&!(cr.from<or);cr=cr.parent){let ur=cr.type.prop(headingProp);if(ur==null)continue;let hr=findSectionEnd(cr,ur);if(hr>ar)return{from:ar,to:hr}}return null});function mkLang(lr){return new Language(data,lr,[headerIndent],"markdown")}const commonmarkLanguage=mkLang(commonmark),extended=commonmark.configure([GFM,Subscript,Superscript,Emoji]),markdownLanguage=mkLang(extended);function getCodeParser(lr,or){return ar=>{if(ar&&lr){let cr=null;if(ar=/\S*/.exec(ar)[0],typeof lr=="function"?cr=lr(ar):cr=LanguageDescription.matchLanguageName(lr,ar,!0),cr instanceof LanguageDescription)return cr.support?cr.support.language.parser:ParseContext.getSkippingParser(cr.load());if(cr)return cr.parser}return or?or.parser:null}}class Context{constructor(or,ar,cr,ur,hr,fr,dr){this.node=or,this.from=ar,this.to=cr,this.spaceBefore=ur,this.spaceAfter=hr,this.type=fr,this.item=dr}blank(or,ar=!0){let cr=this.spaceBefore+(this.node.name=="Blockquote"?">":"");if(or!=null){for(;cr.length<or;)cr+=" ";return cr}else{for(let ur=this.to-this.from-cr.length-this.spaceAfter.length;ur>0;ur--)cr+=" ";return cr+(ar?this.spaceAfter:"")}}marker(or,ar){let cr=this.node.name=="OrderedList"?String(+itemNumber(this.item,or)[2]+ar):"";return this.spaceBefore+cr+this.type+this.spaceAfter}}function getContext(lr,or){let ar=[];for(let ur=lr;ur&&ur.name!="Document";ur=ur.parent)(ur.name=="ListItem"||ur.name=="Blockquote"||ur.name=="FencedCode")&&ar.push(ur);let cr=[];for(let ur=ar.length-1;ur>=0;ur--){let hr=ar[ur],fr,dr=or.lineAt(hr.from),pr=hr.from-dr.from;if(hr.name=="FencedCode")cr.push(new Context(hr,pr,pr,"","","",null));else if(hr.name=="Blockquote"&&(fr=/^[ \t]*>( ?)/.exec(dr.text.slice(pr))))cr.push(new Context(hr,pr,pr+fr[0].length,"",fr[1],">",null));else if(hr.name=="ListItem"&&hr.parent.name=="OrderedList"&&(fr=/^([ \t]*)\d+([.)])([ \t]*)/.exec(dr.text.slice(pr)))){let mr=fr[3],gr=fr[0].length;mr.length>=4&&(mr=mr.slice(0,mr.length-4),gr-=4),cr.push(new Context(hr.parent,pr,pr+gr,fr[1],mr,fr[2],hr))}else if(hr.name=="ListItem"&&hr.parent.name=="BulletList"&&(fr=/^([ \t]*)([-+*])([ \t]{1,4}\[[ xX]\])?([ \t]+)/.exec(dr.text.slice(pr)))){let mr=fr[4],gr=fr[0].length;mr.length>4&&(mr=mr.slice(0,mr.length-4),gr-=4);let yr=fr[2];fr[3]&&(yr+=fr[3].replace(/[xX]/," ")),cr.push(new Context(hr.parent,pr,pr+gr,fr[1],mr,yr,hr))}}return cr}function itemNumber(lr,or){return/^(\s*)(\d+)(?=[.)])/.exec(or.sliceString(lr.from,lr.from+10))}function renumberList(lr,or,ar,cr=0){for(let ur=-1,hr=lr;;){if(hr.name=="ListItem"){let dr=itemNumber(hr,or),pr=+dr[2];if(ur>=0){if(pr!=ur+1)return;ar.push({from:hr.from+dr[1].length,to:hr.from+dr[0].length,insert:String(ur+2+cr)})}ur=pr}let fr=hr.nextSibling;if(!fr)break;hr=fr}}const insertNewlineContinueMarkup=({state:lr,dispatch:or})=>{let ar=syntaxTree(lr),{doc:cr}=lr,ur=null,hr=lr.changeByRange(fr=>{if(!fr.empty||!markdownLanguage.isActiveAt(lr,fr.from))return ur={range:fr};let dr=fr.from,pr=cr.lineAt(dr),mr=getContext(ar.resolveInner(dr,-1),cr);for(;mr.length&&mr[mr.length-1].from>dr-pr.from;)mr.pop();if(!mr.length)return ur={range:fr};let gr=mr[mr.length-1];if(gr.to-gr.spaceAfter.length>dr-pr.from)return ur={range:fr};let yr=dr>=gr.to-gr.spaceAfter.length&&!/\S/.test(pr.text.slice(gr.to));if(gr.item&&yr)if(gr.node.firstChild.to>=dr||pr.from>0&&!/[^\s>]/.test(cr.lineAt(pr.from-1).text)){let xr=mr.length>1?mr[mr.length-2]:null,wr,kr="";xr&&xr.item?(wr=pr.from+xr.from,kr=xr.marker(cr,1)):wr=pr.from+(xr?xr.to:0);let Cr=[{from:wr,to:dr,insert:kr}];return gr.node.name=="OrderedList"&&renumberList(gr.item,cr,Cr,-2),xr&&xr.node.name=="OrderedList"&&renumberList(xr.item,cr,Cr),{range:EditorSelection.cursor(wr+kr.length),changes:Cr}}else{let xr="";for(let wr=0,kr=mr.length-2;wr<=kr;wr++)xr+=mr[wr].blank(wr<kr?mr[wr+1].from-xr.length:null,wr<kr);return xr+=lr.lineBreak,{range:EditorSelection.cursor(dr+xr.length),changes:{from:pr.from,insert:xr}}}if(gr.node.name=="Blockquote"&&yr&&pr.from){let xr=cr.lineAt(pr.from-1),wr=/>\s*$/.exec(xr.text);if(wr&&wr.index==gr.from){let kr=lr.changes([{from:xr.from+wr.index,to:xr.to},{from:pr.from+gr.from,to:pr.to}]);return{range:fr.map(kr),changes:kr}}}let br=[];gr.node.name=="OrderedList"&&renumberList(gr.item,cr,br);let Or=gr.item&&gr.item.from<pr.from,_r="";if(!Or||/^[\s\d.)\-+*>]*/.exec(pr.text)[0].length>=gr.to)for(let xr=0,wr=mr.length-1;xr<=wr;xr++)_r+=xr==wr&&!Or?mr[xr].marker(cr,1):mr[xr].blank(xr<wr?mr[xr+1].from-_r.length:null);let vr=dr;for(;vr>pr.from&&/\s/.test(pr.text.charAt(vr-pr.from-1));)vr--;return _r=lr.lineBreak+_r,br.push({from:vr,to:dr,insert:_r}),{range:EditorSelection.cursor(vr+_r.length),changes:br}});return ur?!1:(or(lr.update(hr,{scrollIntoView:!0,userEvent:"input"})),!0)};function isMark(lr){return lr.name=="QuoteMark"||lr.name=="ListMark"}function contextNodeForDelete(lr,or){let ar=lr.resolveInner(or,-1),cr=or;isMark(ar)&&(cr=ar.from,ar=ar.parent);for(let ur;ur=ar.childBefore(cr);)if(isMark(ur))cr=ur.from;else if(ur.name=="OrderedList"||ur.name=="BulletList")ar=ur.lastChild,cr=ar.to;else break;return ar}const deleteMarkupBackward=({state:lr,dispatch:or})=>{let ar=syntaxTree(lr),cr=null,ur=lr.changeByRange(hr=>{let fr=hr.from,{doc:dr}=lr;if(hr.empty&&markdownLanguage.isActiveAt(lr,hr.from)){let pr=dr.lineAt(fr),mr=getContext(contextNodeForDelete(ar,fr),dr);if(mr.length){let gr=mr[mr.length-1],yr=gr.to-gr.spaceAfter.length+(gr.spaceAfter?1:0);if(fr-pr.from>yr&&!/\S/.test(pr.text.slice(yr,fr-pr.from)))return{range:EditorSelection.cursor(pr.from+yr),changes:{from:pr.from+yr,to:fr}};if(fr-pr.from==yr&&(!gr.item||pr.from<=gr.item.from||!/\S/.test(pr.text.slice(0,gr.to)))){let br=pr.from+gr.from;if(gr.item&&gr.node.from<gr.item.from&&/\S/.test(pr.text.slice(gr.from,gr.to)))return{range:hr,changes:{from:br,to:pr.from+gr.to,insert:gr.blank(gr.to-gr.from)}};if(br<fr)return{range:EditorSelection.cursor(br),changes:{from:br,to:fr}}}}}return cr={range:hr}});return cr?!1:(or(lr.update(ur,{scrollIntoView:!0,userEvent:"delete"})),!0)},markdownKeymap=[{key:"Enter",run:insertNewlineContinueMarkup},{key:"Backspace",run:deleteMarkupBackward}],htmlNoMatch=html$1({matchClosingTags:!1});function markdown(lr={}){let{codeLanguages:or,defaultCodeLanguage:ar,addKeymap:cr=!0,base:{parser:ur}=commonmarkLanguage,completeHTMLTags:hr=!0}=lr;if(!(ur instanceof MarkdownParser))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let fr=lr.extensions?[lr.extensions]:[],dr=[htmlNoMatch.support],pr;ar instanceof LanguageSupport?(dr.push(ar.support),pr=ar.language):ar&&(pr=ar);let mr=or||pr?getCodeParser(or,pr):void 0;fr.push(parseCode({codeParser:mr,htmlParser:htmlNoMatch.language.parser})),cr&&dr.push(Prec.high(keymap.of(markdownKeymap)));let gr=mkLang(ur.configure(fr));return hr&&dr.push(gr.data.of({autocomplete:htmlTagCompletion})),new LanguageSupport(gr,dr)}function htmlTagCompletion(lr){let{state:or,pos:ar}=lr,cr=/<[:\-\.\w\u00b7-\uffff]*$/.exec(or.sliceDoc(ar-25,ar));if(!cr)return null;let ur=syntaxTree(or).resolveInner(ar,-1);for(;ur&&!ur.type.isTop;){if(ur.name=="CodeBlock"||ur.name=="FencedCode"||ur.name=="ProcessingInstructionBlock"||ur.name=="CommentBlock"||ur.name=="Link"||ur.name=="Image")return null;ur=ur.parent}return{from:ar-cr[0].length,to:ar,options:htmlTagCompletions(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let _tagCompletions=null;function htmlTagCompletions(){if(_tagCompletions)return _tagCompletions;let lr=htmlCompletionSource(new CompletionContext(EditorState.create({extensions:htmlNoMatch}),0,!0));return _tagCompletions=lr?lr.options:[]}const Dialogs_svelte_svelte_type_style_lang="";function create_if_block_1$6(lr){let or,ar,cr,ur,hr,fr=lr[5]("dialogs.lock.title")+"",dr,pr,mr,gr=lr[5]("dialogs.lock.text")+"",yr,br,Or=lr[5]("dialogs.lock.new")+"",_r,vr,xr,wr=lr[5]("dialogs.lock.overwrite")+"",kr,Cr,$r;return{c(){or=element$1("div"),ar=space$3(),cr=element$1("div"),ur=element$1("div"),hr=element$1("h3"),dr=text(fr),pr=space$3(),mr=element$1("p"),yr=space$3(),br=element$1("button"),_r=text(Or),vr=space$3(),xr=element$1("button"),kr=text(wr),attr(or,"class","dialog-mask"),attr(br,"class","ok"),attr(xr,"class","error"),attr(ur,"class","dialog lock svelte-1chex7r"),attr(cr,"class","dialog-container"),attr(cr,"role","dialog")},m(Nr,Br){insert$1(Nr,or,Br),insert$1(Nr,ar,Br),insert$1(Nr,cr,Br),append(cr,ur),append(ur,hr),append(hr,dr),append(ur,pr),append(ur,mr),mr.innerHTML=gr,append(ur,yr),append(ur,br),append(br,_r),append(ur,vr),append(ur,xr),append(xr,kr),Cr||($r=[listen(br,"click",lr[6]),listen(xr,"click",lr[7])],Cr=!0)},p(Nr,Br){Br&32&&fr!==(fr=Nr[5]("dialogs.lock.title")+"")&&set_data(dr,fr),Br&32&&gr!==(gr=Nr[5]("dialogs.lock.text")+"")&&(mr.innerHTML=gr),Br&32&&Or!==(Or=Nr[5]("dialogs.lock.new")+"")&&set_data(_r,Or),Br&32&&wr!==(wr=Nr[5]("dialogs.lock.overwrite")+"")&&set_data(kr,wr)},d(Nr){Nr&&(detach(or),detach(ar),detach(cr)),Cr=!1,run_all($r)}}}function create_if_block$d(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr;var gr=lr[2];function yr(br,Or){return{props:{params:br[4],callback:br[3]}}}return gr&&(ur=construct_svelte_component(gr,yr(lr))),{c(){or=element$1("div"),ar=space$3(),cr=element$1("div"),ur&&create_component(ur.$$.fragment),hr=space$3(),fr=element$1("span"),attr(or,"class","dialog-mask"),attr(fr,"tabindex","0"),attr(fr,"aria-hidden","true"),attr(cr,"id","mage-modal"),attr(cr,"class","dialog-container"),attr(cr,"tabindex","-1"),attr(cr,"aria-modal","true"),attr(cr,"role","dialog")},m(br,Or){insert$1(br,or,Or),insert$1(br,ar,Or),insert$1(br,cr,Or),ur&&mount_component(ur,cr,null),append(cr,hr),append(cr,fr),dr=!0,pr||(mr=[listen(or,"click",self$1(lr[8])),listen(fr,"focus",lr[9]),listen(cr,"click",self$1(lr[10]))],pr=!0)},p(br,Or){if(Or&4&&gr!==(gr=br[2])){if(ur){group_outros();const _r=ur;transition_out(_r.$$.fragment,1,0,()=>{destroy_component(_r,1)}),check_outros()}gr?(ur=construct_svelte_component(gr,yr(br)),create_component(ur.$$.fragment),transition_in(ur.$$.fragment,1),mount_component(ur,cr,hr)):ur=null}else if(gr){const _r={};Or&16&&(_r.params=br[4]),Or&8&&(_r.callback=br[3]),ur.$set(_r)}},i(br){dr||(ur&&transition_in(ur.$$.fragment,br),dr=!0)},o(br){ur&&transition_out(ur.$$.fragment,br),dr=!1},d(br){br&&(detach(or),detach(ar),detach(cr)),ur&&destroy_component(ur),pr=!1,run_all(mr)}}}function create_fragment$i(lr){let or,ar,cr,ur=lr[0]&&create_if_block_1$6(lr),hr=lr[2]&&create_if_block$d(lr);return{c(){ur&&ur.c(),or=space$3(),hr&&hr.c(),ar=empty$1()},m(fr,dr){ur&&ur.m(fr,dr),insert$1(fr,or,dr),hr&&hr.m(fr,dr),insert$1(fr,ar,dr),cr=!0},p(fr,[dr]){fr[0]?ur?ur.p(fr,dr):(ur=create_if_block_1$6(fr),ur.c(),ur.m(or.parentNode,or)):ur&&(ur.d(1),ur=null),fr[2]?hr?(hr.p(fr,dr),dr&4&&transition_in(hr,1)):(hr=create_if_block$d(fr),hr.c(),transition_in(hr,1),hr.m(ar.parentNode,ar)):hr&&(group_outros(),transition_out(hr,1,1,()=>{hr=null}),check_outros())},i(fr){cr||(transition_in(hr),cr=!0)},o(fr){transition_out(hr),cr=!1},d(fr){fr&&(detach(or),detach(ar)),ur&&ur.d(fr),hr&&hr.d(fr)}}}const dialogStore=writable({}),lockStore=writable({lock:!1,session:null}),dialog=(lr,...or)=>new Promise(ar=>dialogStore.set({component:lr,callback(...cr){dialogStore.set({}),ar(...cr)},params:writable(or)})),closeDialog=lr=>{try{get_store_value(dialogStore).callback(lr)}catch{}};function instance$i(lr,or,ar){let cr;component_subscribe(lr,$format,_r=>ar(5,cr=_r));let ur=!1,hr,fr,dr,pr;return lockStore.subscribe(_r=>ar(0,{lock:ur,session:hr}=_r,ur,ar(1,hr))),dialogStore.subscribe(async _r=>{ar(2,{component:fr,callback:dr,params:pr}=_r,fr,ar(3,dr),ar(4,pr)),await tick();const vr=document.querySelector("button.ok");vr&&vr.focus()}),[ur,hr,fr,dr,pr,cr,()=>hr.duplicate(),()=>hr.lock(),()=>dr(!1),()=>{var _r;return(_r=document.getElementById("mage-modal"))==null?void 0:_r.focus()},()=>dr(!1)]}class Dialogs extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$i,create_fragment$i,safe_not_equal,{})}}const subviewUpdateEffect=StateEffect.define(),chapterHistory=[],historyCanGoBack=writable(!1),focusOnChapter=async lr=>{const{book:or,editor:ar}=await store;ar.dispatch({selection:{anchor:ar.state.doc.line(or.index.chapters[lr].lines.textEnd+1).to},effects:[subviewUpdateEffect.of("subviewUpdate"),EditorView.scrollIntoView(ar.state.doc.line(or.index.chapters[lr].lines.textStart+1).to,{y:"start",yMargin:20})]}),ar.focus()},goToChapter=async(lr,or=!0)=>{const{selectedChapterIndex:ar,selectedChapter:cr}=await store,ur=get_store_value(ar),hr=get_store_value(cr);or&&ur!==-1&&(chapterHistory.push([ur,hr.key]),historyCanGoBack.set(!0)),showSidemenu.set(!1),await focusOnChapter(lr)},goToKey=async(lr,or=!0)=>{const{book:ar,selectedChapterIndex:cr,selectedChapter:ur,editor:hr}=await store,fr=get_store_value(cr),dr=get_store_value(ur);let pr=ar.index.keys[lr]??addChapter(ar,{key:lr,group:dr.group},fr)[0];or&&fr!==-1&&(chapterHistory.push([fr,dr.key]),historyCanGoBack.set(!0)),showSidemenu.set(!1),focusOnChapter(pr)},goBack=async()=>{if(chapterHistory.length==0)return;chapterHistory.length==1&&historyCanGoBack.set(!1);const{book:lr}=await store,[or,ar]=chapterHistory.pop();if(lr.index.chapters[or].key===ar){goToChapter(or,!1);return}goToKey(ar,!1)},navigator$1=Object.freeze(Object.defineProperty({__proto__:null,focusOnChapter,goBack,goToChapter,goToKey,historyCanGoBack,subviewUpdateEffect},Symbol.toStringTag,{value:"Module"})),historyCallbacks=[],fromHistory=Annotation.define(),isolateHistory=Annotation.define(),invertedEffects=Facet.define(),historyConfig=Facet.define({combine(lr){return combineConfig(lr,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});function changeEnd(lr){let or=0;return lr.iterChangedRanges((ar,cr)=>or=cr),or}const historyField_=StateField.define({create(){return HistoryState.empty},update(lr,or){let ar=or.state.facet(historyConfig),cr=or.annotation(fromHistory);if(cr){let pr=or.docChanged?EditorSelection.single(changeEnd(or.changes)):void 0,mr=HistEvent.fromTransaction(or,pr),gr=cr.side,yr=gr==0?lr.undone:lr.done;return mr?yr=updateBranch(yr,yr.length,ar.minDepth,mr):yr=addSelection(yr,or.startState.selection),new HistoryState(gr==0?cr.rest:yr,gr==0?yr:cr.rest)}let ur=or.annotation(isolateHistory);if((ur=="full"||ur=="before")&&(lr=lr.isolate()),or.annotation(Transaction.addToHistory)===!1)return or.changes.empty?lr:lr.addMapping(or.changes.desc);let hr=HistEvent.fromTransaction(or),fr=or.annotation(Transaction.time),dr=or.annotation(Transaction.userEvent);return hr?lr=lr.addChanges(hr,fr,dr,ar.newGroupDelay,ar.minDepth):or.selection&&(lr=lr.addSelection(or.startState.selection,fr,dr,ar.newGroupDelay)),(ur=="full"||ur=="after")&&(lr=lr.isolate()),lr},toJSON(lr){return{done:lr.done.map(or=>or.toJSON()),undone:lr.undone.map(or=>or.toJSON())}},fromJSON(lr){return new HistoryState(lr.done.map(HistEvent.fromJSON),lr.undone.map(HistEvent.fromJSON))}});function history(lr={}){return[historyField_,historyConfig.of(lr),EditorView.domEventHandlers({beforeinput(or,ar){let cr=or.inputType=="historyUndo"?undo:or.inputType=="historyRedo"?redo:null;return cr?(or.preventDefault(),cr(ar)):!1}})]}function cmd(lr,or){return function({state:ar,dispatch:cr}){if(!or&&ar.readOnly)return!1;let ur=ar.field(historyField_,!1);if(!ur)return!1;let hr=ur.pop(lr,ar,or);return hr?(cr(hr),!0):!1}}const undo=cmd(0,!1),redo=cmd(1,!1),undoSelection=cmd(0,!0),redoSelection=cmd(1,!0);class HistEvent{constructor(or,ar,cr,ur,hr){this.changes=or,this.effects=ar,this.mapped=cr,this.startSelection=ur,this.selectionsAfter=hr}setSelAfter(or){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,or)}toJSON(){var or,ar,cr;return{changes:(or=this.changes)==null?void 0:or.toJSON(),mapped:(ar=this.mapped)==null?void 0:ar.toJSON(),startSelection:(cr=this.startSelection)==null?void 0:cr.toJSON(),selectionsAfter:this.selectionsAfter.map(ur=>ur.toJSON())}}static fromJSON(or){return new HistEvent(or.changes&&ChangeSet.fromJSON(or.changes),[],or.mapped&&ChangeDesc.fromJSON(or.mapped),or.startSelection&&EditorSelection.fromJSON(or.startSelection),or.selectionsAfter.map(EditorSelection.fromJSON))}static fromTransaction(or,ar){let cr=none;for(let ur of or.startState.facet(invertedEffects)){let hr=ur(or);hr.length&&(cr=cr.concat(hr))}return!cr.length&&or.changes.empty?null:new HistEvent(or.changes.invert(or.startState.doc),cr,void 0,ar||or.startState.selection,none)}static selection(or){return new HistEvent(void 0,none,void 0,void 0,or)}}function updateBranch(lr,or,ar,cr){let ur=or+1>ar+20?or-ar-1:0,hr=lr.slice(ur,or);return hr.push(cr),hr}function isAdjacent(lr,or){let ar=[],cr=!1;return lr.iterChangedRanges((ur,hr)=>ar.push(ur,hr)),or.iterChangedRanges((ur,hr,fr,dr)=>{for(let pr=0;pr<ar.length;){let mr=ar[pr++],gr=ar[pr++];dr>=mr&&fr<=gr&&(cr=!0)}}),cr}function eqSelectionShape(lr,or){return lr.ranges.length==or.ranges.length&&lr.ranges.filter((ar,cr)=>ar.empty!=or.ranges[cr].empty).length===0}function conc(lr,or){return lr.length?or.length?lr.concat(or):lr:or}const none=[],MaxSelectionsPerEvent=200;function addSelection(lr,or){if(lr.length){let ar=lr[lr.length-1],cr=ar.selectionsAfter.slice(Math.max(0,ar.selectionsAfter.length-MaxSelectionsPerEvent));return cr.length&&cr[cr.length-1].eq(or)?lr:(cr.push(or),updateBranch(lr,lr.length-1,1e9,ar.setSelAfter(cr)))}else return[HistEvent.selection([or])]}function popSelection(lr){let or=lr[lr.length-1],ar=lr.slice();return ar[lr.length-1]=or.setSelAfter(or.selectionsAfter.slice(0,or.selectionsAfter.length-1)),ar}function addMappingToBranch(lr,or){if(!lr.length)return lr;let ar=lr.length,cr=none;for(;ar;){let ur=mapEvent(lr[ar-1],or,cr);if(ur.changes&&!ur.changes.empty||ur.effects.length){let hr=lr.slice(0,ar);return hr[ar-1]=ur,hr}else or=ur.mapped,ar--,cr=ur.selectionsAfter}return cr.length?[HistEvent.selection(cr)]:none}function mapEvent(lr,or,ar){let cr=conc(lr.selectionsAfter.length?lr.selectionsAfter.map(dr=>dr.map(or)):none,ar);if(!lr.changes)return HistEvent.selection(cr);let ur=lr.changes.map(or),hr=or.mapDesc(lr.changes,!0),fr=lr.mapped?lr.mapped.composeDesc(hr):hr;return new HistEvent(ur,StateEffect.mapEffects(lr.effects,or),fr,lr.startSelection.map(hr),cr)}const joinableUserEvent=/^(input\.type|delete)($|\.)/,Ni=class Ni{constructor(or,ar,cr=0,ur=void 0){this.done=or,this.undone=ar,this.prevTime=cr,this.prevUserEvent=ur}isolate(){return this.prevTime?new Ni(this.done,this.undone):this}addChanges(or,ar,cr,ur,hr){let fr=this.done,dr=fr[fr.length-1];return dr&&dr.changes&&!dr.changes.empty&&or.changes&&(!cr||joinableUserEvent.test(cr))&&(!dr.selectionsAfter.length&&ar-this.prevTime<ur&&isAdjacent(dr.changes,or.changes)||cr=="input.type.compose")?(fr=updateBranch(fr,fr.length-1,hr,new HistEvent(or.changes.compose(dr.changes),conc(or.effects,dr.effects),dr.mapped,dr.startSelection,none)),historyCallbacks.forEach(pr=>pr(!1))):(fr=updateBranch(fr,fr.length,hr,or),historyCallbacks.forEach(pr=>pr(!0))),new Ni(fr,none,ar,cr)}addSelection(or,ar,cr,ur){let hr=this.done.length?this.done[this.done.length-1].selectionsAfter:none;return hr.length>0&&ar-this.prevTime<ur&&cr==this.prevUserEvent&&cr&&/^select($|\.)/.test(cr)&&eqSelectionShape(hr[hr.length-1],or)?this:new Ni(addSelection(this.done,or),this.undone,ar,cr)}addMapping(or){return new Ni(addMappingToBranch(this.done,or),addMappingToBranch(this.undone,or),this.prevTime,this.prevUserEvent)}pop(or,ar,cr){let ur=or==0?this.done:this.undone;if(ur.length==0)return null;let hr=ur[ur.length-1];if(cr&&hr.selectionsAfter.length)return ar.update({selection:hr.selectionsAfter[hr.selectionsAfter.length-1],annotations:fromHistory.of({side:or,rest:popSelection(ur)}),userEvent:or==0?"select.undo":"select.redo",scrollIntoView:!0});if(hr.changes){let fr=ur.length==1?none:ur.slice(0,ur.length-1);return hr.mapped&&(fr=addMappingToBranch(fr,hr.mapped)),ar.update({changes:hr.changes,selection:hr.startSelection,effects:hr.effects,annotations:fromHistory.of({side:or,rest:fr}),filter:!1,userEvent:or==0?"undo":"redo",scrollIntoView:!0})}else return null}};bi(Ni,"empty",new Ni(none,none));let HistoryState=Ni;const historyKeymap=[{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:!0},{linux:"Ctrl-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:!0}];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const assert=function(lr,or){if(!lr)throw assertionError(or)},assertionError=function(lr){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+lr)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(lr){const or=[];let ar=0;for(let cr=0;cr<lr.length;cr++){let ur=lr.charCodeAt(cr);ur<128?or[ar++]=ur:ur<2048?(or[ar++]=ur>>6|192,or[ar++]=ur&63|128):(ur&64512)===55296&&cr+1<lr.length&&(lr.charCodeAt(cr+1)&64512)===56320?(ur=65536+((ur&1023)<<10)+(lr.charCodeAt(++cr)&1023),or[ar++]=ur>>18|240,or[ar++]=ur>>12&63|128,or[ar++]=ur>>6&63|128,or[ar++]=ur&63|128):(or[ar++]=ur>>12|224,or[ar++]=ur>>6&63|128,or[ar++]=ur&63|128)}return or},byteArrayToString=function(lr){const or=[];let ar=0,cr=0;for(;ar<lr.length;){const ur=lr[ar++];if(ur<128)or[cr++]=String.fromCharCode(ur);else if(ur>191&&ur<224){const hr=lr[ar++];or[cr++]=String.fromCharCode((ur&31)<<6|hr&63)}else if(ur>239&&ur<365){const hr=lr[ar++],fr=lr[ar++],dr=lr[ar++],pr=((ur&7)<<18|(hr&63)<<12|(fr&63)<<6|dr&63)-65536;or[cr++]=String.fromCharCode(55296+(pr>>10)),or[cr++]=String.fromCharCode(56320+(pr&1023))}else{const hr=lr[ar++],fr=lr[ar++];or[cr++]=String.fromCharCode((ur&15)<<12|(hr&63)<<6|fr&63)}}return or.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(lr,or){if(!Array.isArray(lr))throw Error("encodeByteArray takes an array as a parameter");this.init_();const ar=or?this.byteToCharMapWebSafe_:this.byteToCharMap_,cr=[];for(let ur=0;ur<lr.length;ur+=3){const hr=lr[ur],fr=ur+1<lr.length,dr=fr?lr[ur+1]:0,pr=ur+2<lr.length,mr=pr?lr[ur+2]:0,gr=hr>>2,yr=(hr&3)<<4|dr>>4;let br=(dr&15)<<2|mr>>6,Or=mr&63;pr||(Or=64,fr||(br=64)),cr.push(ar[gr],ar[yr],ar[br],ar[Or])}return cr.join("")},encodeString(lr,or){return this.HAS_NATIVE_SUPPORT&&!or?btoa(lr):this.encodeByteArray(stringToByteArray$1(lr),or)},decodeString(lr,or){return this.HAS_NATIVE_SUPPORT&&!or?atob(lr):byteArrayToString(this.decodeStringToByteArray(lr,or))},decodeStringToByteArray(lr,or){this.init_();const ar=or?this.charToByteMapWebSafe_:this.charToByteMap_,cr=[];for(let ur=0;ur<lr.length;){const hr=ar[lr.charAt(ur++)],dr=ur<lr.length?ar[lr.charAt(ur)]:0;++ur;const mr=ur<lr.length?ar[lr.charAt(ur)]:64;++ur;const yr=ur<lr.length?ar[lr.charAt(ur)]:64;if(++ur,hr==null||dr==null||mr==null||yr==null)throw new DecodeBase64StringError;const br=hr<<2|dr>>4;if(cr.push(br),mr!==64){const Or=dr<<4&240|mr>>2;if(cr.push(Or),yr!==64){const _r=mr<<6&192|yr;cr.push(_r)}}}return cr},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let lr=0;lr<this.ENCODED_VALS.length;lr++)this.byteToCharMap_[lr]=this.ENCODED_VALS.charAt(lr),this.charToByteMap_[this.byteToCharMap_[lr]]=lr,this.byteToCharMapWebSafe_[lr]=this.ENCODED_VALS_WEBSAFE.charAt(lr),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[lr]]=lr,lr>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(lr)]=lr,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(lr)]=lr)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(lr){const or=stringToByteArray$1(lr);return base64.encodeByteArray(or,!0)},base64urlEncodeWithoutPadding=function(lr){return base64Encode(lr).replace(/\./g,"")},base64Decode=function(lr){try{return base64.decodeString(lr,!0)}catch(or){console.error("base64Decode failed: ",or)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function deepCopy(lr){return deepExtend(void 0,lr)}function deepExtend(lr,or){if(!(or instanceof Object))return or;switch(or.constructor){case Date:const ar=or;return new Date(ar.getTime());case Object:lr===void 0&&(lr={});break;case Array:lr=[];break;default:return or}for(const ar in or)!or.hasOwnProperty(ar)||!isValidKey$1(ar)||(lr[ar]=deepExtend(lr[ar],or[ar]));return lr}function isValidKey$1(lr){return lr!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof process.env>"u")return;const lr={}.__FIREBASE_DEFAULTS__;if(lr)return JSON.parse(lr)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let lr;try{lr=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const or=lr&&base64Decode(lr[1]);return or&&JSON.parse(or)},getDefaults=()=>{try{return getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(lr){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${lr}`);return}},getDefaultAppConfig=()=>{var lr;return(lr=getDefaults())===null||lr===void 0?void 0:lr.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((or,ar)=>{this.resolve=or,this.reject=ar})}wrapCallback(or){return(ar,cr)=>{ar?this.reject(ar):this.resolve(cr),typeof or=="function"&&(this.promise.catch(()=>{}),or.length===1?or(ar):or(ar,cr))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(lr,or){if(lr.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const ar={alg:"none",type:"JWT"},cr=or||"demo-project",ur=lr.iat||0,hr=lr.sub||lr.user_id;if(!hr)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const fr=Object.assign({iss:`https://securetoken.google.com/${cr}`,aud:cr,iat:ur,exp:ur+3600,auth_time:ur,sub:hr,user_id:hr,firebase:{sign_in_provider:"custom",identities:{}}},lr),dr="";return[base64urlEncodeWithoutPadding(JSON.stringify(ar)),base64urlEncodeWithoutPadding(JSON.stringify(fr)),dr].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isBrowser(){return typeof self=="object"&&self.self===self}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isNodeSdk(){return CONSTANTS.NODE_ADMIN===!0}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((lr,or)=>{try{let ar=!0;const cr="validate-browser-context-for-indexeddb-analytics-module",ur=self.indexedDB.open(cr);ur.onsuccess=()=>{ur.result.close(),ar||self.indexedDB.deleteDatabase(cr),lr(!0)},ur.onupgradeneeded=()=>{ar=!1},ur.onerror=()=>{var hr;or(((hr=ur.error)===null||hr===void 0?void 0:hr.message)||"")}}catch(ar){or(ar)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(or,ar,cr){super(ar),this.code=or,this.customData=cr,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(or,ar,cr){this.service=or,this.serviceName=ar,this.errors=cr}create(or,...ar){const cr=ar[0]||{},ur=`${this.service}/${or}`,hr=this.errors[or],fr=hr?replaceTemplate(hr,cr):"Error",dr=`${this.serviceName}: ${fr} (${ur}).`;return new FirebaseError(ur,dr,cr)}}function replaceTemplate(lr,or){return lr.replace(PATTERN,(ar,cr)=>{const ur=or[cr];return ur!=null?String(ur):`<${cr}?>`})}const PATTERN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonEval(lr){return JSON.parse(lr)}function stringify(lr){return JSON.stringify(lr)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const decode$4=function(lr){let or={},ar={},cr={},ur="";try{const hr=lr.split(".");or=jsonEval(base64Decode(hr[0])||""),ar=jsonEval(base64Decode(hr[1])||""),ur=hr[2],cr=ar.d||{},delete ar.d}catch{}return{header:or,claims:ar,data:cr,signature:ur}},isValidFormat=function(lr){const or=decode$4(lr),ar=or.claims;return!!ar&&typeof ar=="object"&&ar.hasOwnProperty("iat")},isAdmin=function(lr){const or=decode$4(lr).claims;return typeof or=="object"&&or.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function contains(lr,or){return Object.prototype.hasOwnProperty.call(lr,or)}function safeGet(lr,or){if(Object.prototype.hasOwnProperty.call(lr,or))return lr[or]}function isEmpty(lr){for(const or in lr)if(Object.prototype.hasOwnProperty.call(lr,or))return!1;return!0}function map(lr,or,ar){const cr={};for(const ur in lr)Object.prototype.hasOwnProperty.call(lr,ur)&&(cr[ur]=or.call(ar,lr[ur],ur,lr));return cr}function deepEqual(lr,or){if(lr===or)return!0;const ar=Object.keys(lr),cr=Object.keys(or);for(const ur of ar){if(!cr.includes(ur))return!1;const hr=lr[ur],fr=or[ur];if(isObject(hr)&&isObject(fr)){if(!deepEqual(hr,fr))return!1}else if(hr!==fr)return!1}for(const ur of cr)if(!ar.includes(ur))return!1;return!0}function isObject(lr){return lr!==null&&typeof lr=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(lr){const or=[];for(const[ar,cr]of Object.entries(lr))Array.isArray(cr)?cr.forEach(ur=>{or.push(encodeURIComponent(ar)+"="+encodeURIComponent(ur))}):or.push(encodeURIComponent(ar)+"="+encodeURIComponent(cr));return or.length?"&"+or.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sha1{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let or=1;or<this.blockSize;++or)this.pad_[or]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(or,ar){ar||(ar=0);const cr=this.W_;if(typeof or=="string")for(let yr=0;yr<16;yr++)cr[yr]=or.charCodeAt(ar)<<24|or.charCodeAt(ar+1)<<16|or.charCodeAt(ar+2)<<8|or.charCodeAt(ar+3),ar+=4;else for(let yr=0;yr<16;yr++)cr[yr]=or[ar]<<24|or[ar+1]<<16|or[ar+2]<<8|or[ar+3],ar+=4;for(let yr=16;yr<80;yr++){const br=cr[yr-3]^cr[yr-8]^cr[yr-14]^cr[yr-16];cr[yr]=(br<<1|br>>>31)&4294967295}let ur=this.chain_[0],hr=this.chain_[1],fr=this.chain_[2],dr=this.chain_[3],pr=this.chain_[4],mr,gr;for(let yr=0;yr<80;yr++){yr<40?yr<20?(mr=dr^hr&(fr^dr),gr=1518500249):(mr=hr^fr^dr,gr=1859775393):yr<60?(mr=hr&fr|dr&(hr|fr),gr=2400959708):(mr=hr^fr^dr,gr=3395469782);const br=(ur<<5|ur>>>27)+mr+pr+gr+cr[yr]&4294967295;pr=dr,dr=fr,fr=(hr<<30|hr>>>2)&4294967295,hr=ur,ur=br}this.chain_[0]=this.chain_[0]+ur&4294967295,this.chain_[1]=this.chain_[1]+hr&4294967295,this.chain_[2]=this.chain_[2]+fr&4294967295,this.chain_[3]=this.chain_[3]+dr&4294967295,this.chain_[4]=this.chain_[4]+pr&4294967295}update(or,ar){if(or==null)return;ar===void 0&&(ar=or.length);const cr=ar-this.blockSize;let ur=0;const hr=this.buf_;let fr=this.inbuf_;for(;ur<ar;){if(fr===0)for(;ur<=cr;)this.compress_(or,ur),ur+=this.blockSize;if(typeof or=="string"){for(;ur<ar;)if(hr[fr]=or.charCodeAt(ur),++fr,++ur,fr===this.blockSize){this.compress_(hr),fr=0;break}}else for(;ur<ar;)if(hr[fr]=or[ur],++fr,++ur,fr===this.blockSize){this.compress_(hr),fr=0;break}}this.inbuf_=fr,this.total_+=ar}digest(){const or=[];let ar=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let ur=this.blockSize-1;ur>=56;ur--)this.buf_[ur]=ar&255,ar/=256;this.compress_(this.buf_);let cr=0;for(let ur=0;ur<5;ur++)for(let hr=24;hr>=0;hr-=8)or[cr]=this.chain_[ur]>>hr&255,++cr;return or}}function createSubscribe(lr,or){const ar=new ObserverProxy(lr,or);return ar.subscribe.bind(ar)}class ObserverProxy{constructor(or,ar){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=ar,this.task.then(()=>{or(this)}).catch(cr=>{this.error(cr)})}next(or){this.forEachObserver(ar=>{ar.next(or)})}error(or){this.forEachObserver(ar=>{ar.error(or)}),this.close(or)}complete(){this.forEachObserver(or=>{or.complete()}),this.close()}subscribe(or,ar,cr){let ur;if(or===void 0&&ar===void 0&&cr===void 0)throw new Error("Missing Observer.");implementsAnyMethods(or,["next","error","complete"])?ur=or:ur={next:or,error:ar,complete:cr},ur.next===void 0&&(ur.next=noop$1),ur.error===void 0&&(ur.error=noop$1),ur.complete===void 0&&(ur.complete=noop$1);const hr=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?ur.error(this.finalError):ur.complete()}catch{}}),this.observers.push(ur),hr}unsubscribeOne(or){this.observers===void 0||this.observers[or]===void 0||(delete this.observers[or],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(or){if(!this.finalized)for(let ar=0;ar<this.observers.length;ar++)this.sendOne(ar,or)}sendOne(or,ar){this.task.then(()=>{if(this.observers!==void 0&&this.observers[or]!==void 0)try{ar(this.observers[or])}catch(cr){typeof console<"u"&&console.error&&console.error(cr)}})}close(or){this.finalized||(this.finalized=!0,or!==void 0&&(this.finalError=or),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods(lr,or){if(typeof lr!="object"||lr===null)return!1;for(const ar of or)if(ar in lr&&typeof lr[ar]=="function")return!0;return!1}function noop$1(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const validateArgCount=function(lr,or,ar,cr){let ur;if(cr<or?ur="at least "+or:cr>ar&&(ur=ar===0?"none":"no more than "+ar),ur){const hr=lr+" failed: Was called with "+cr+(cr===1?" argument.":" arguments.")+" Expects "+ur+".";throw new Error(hr)}};function errorPrefix(lr,or){return`${lr} failed: ${or} argument `}function validateCallback(lr,or,ar,cr){if(!(cr&&!ar)&&typeof ar!="function")throw new Error(errorPrefix(lr,or)+"must be a valid function.")}function validateContextObject(lr,or,ar,cr){if(!(cr&&!ar)&&(typeof ar!="object"||ar===null))throw new Error(errorPrefix(lr,or)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray=function(lr){const or=[];let ar=0;for(let cr=0;cr<lr.length;cr++){let ur=lr.charCodeAt(cr);if(ur>=55296&&ur<=56319){const hr=ur-55296;cr++,assert(cr<lr.length,"Surrogate pair missing trail surrogate.");const fr=lr.charCodeAt(cr)-56320;ur=65536+(hr<<10)+fr}ur<128?or[ar++]=ur:ur<2048?(or[ar++]=ur>>6|192,or[ar++]=ur&63|128):ur<65536?(or[ar++]=ur>>12|224,or[ar++]=ur>>6&63|128,or[ar++]=ur&63|128):(or[ar++]=ur>>18|240,or[ar++]=ur>>12&63|128,or[ar++]=ur>>6&63|128,or[ar++]=ur&63|128)}return or},stringLength=function(lr){let or=0;for(let ar=0;ar<lr.length;ar++){const cr=lr.charCodeAt(ar);cr<128?or++:cr<2048?or+=2:cr>=55296&&cr<=56319?(or+=4,ar++):or+=3}return or};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(lr){return lr&&lr._delegate?lr._delegate:lr}class Component{constructor(or,ar,cr){this.name=or,this.instanceFactory=ar,this.type=cr,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(or){return this.instantiationMode=or,this}setMultipleInstances(or){return this.multipleInstances=or,this}setServiceProps(or){return this.serviceProps=or,this}setInstanceCreatedCallback(or){return this.onInstanceCreated=or,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(or,ar){this.name=or,this.container=ar,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(or){const ar=this.normalizeInstanceIdentifier(or);if(!this.instancesDeferred.has(ar)){const cr=new Deferred;if(this.instancesDeferred.set(ar,cr),this.isInitialized(ar)||this.shouldAutoInitialize())try{const ur=this.getOrInitializeService({instanceIdentifier:ar});ur&&cr.resolve(ur)}catch{}}return this.instancesDeferred.get(ar).promise}getImmediate(or){var ar;const cr=this.normalizeInstanceIdentifier(or==null?void 0:or.identifier),ur=(ar=or==null?void 0:or.optional)!==null&&ar!==void 0?ar:!1;if(this.isInitialized(cr)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:cr})}catch(hr){if(ur)return null;throw hr}else{if(ur)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(or){if(or.name!==this.name)throw Error(`Mismatching Component ${or.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=or,!!this.shouldAutoInitialize()){if(isComponentEager(or))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[ar,cr]of this.instancesDeferred.entries()){const ur=this.normalizeInstanceIdentifier(ar);try{const hr=this.getOrInitializeService({instanceIdentifier:ur});cr.resolve(hr)}catch{}}}}clearInstance(or=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(or),this.instancesOptions.delete(or),this.instances.delete(or)}async delete(){const or=Array.from(this.instances.values());await Promise.all([...or.filter(ar=>"INTERNAL"in ar).map(ar=>ar.INTERNAL.delete()),...or.filter(ar=>"_delete"in ar).map(ar=>ar._delete())])}isComponentSet(){return this.component!=null}isInitialized(or=DEFAULT_ENTRY_NAME$1){return this.instances.has(or)}getOptions(or=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(or)||{}}initialize(or={}){const{options:ar={}}=or,cr=this.normalizeInstanceIdentifier(or.instanceIdentifier);if(this.isInitialized(cr))throw Error(`${this.name}(${cr}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const ur=this.getOrInitializeService({instanceIdentifier:cr,options:ar});for(const[hr,fr]of this.instancesDeferred.entries()){const dr=this.normalizeInstanceIdentifier(hr);cr===dr&&fr.resolve(ur)}return ur}onInit(or,ar){var cr;const ur=this.normalizeInstanceIdentifier(ar),hr=(cr=this.onInitCallbacks.get(ur))!==null&&cr!==void 0?cr:new Set;hr.add(or),this.onInitCallbacks.set(ur,hr);const fr=this.instances.get(ur);return fr&&or(fr,ur),()=>{hr.delete(or)}}invokeOnInitCallbacks(or,ar){const cr=this.onInitCallbacks.get(ar);if(cr)for(const ur of cr)try{ur(or,ar)}catch{}}getOrInitializeService({instanceIdentifier:or,options:ar={}}){let cr=this.instances.get(or);if(!cr&&this.component&&(cr=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(or),options:ar}),this.instances.set(or,cr),this.instancesOptions.set(or,ar),this.invokeOnInitCallbacks(cr,or),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,or,cr)}catch{}return cr||null}normalizeInstanceIdentifier(or=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?or:DEFAULT_ENTRY_NAME$1:or}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(lr){return lr===DEFAULT_ENTRY_NAME$1?void 0:lr}function isComponentEager(lr){return lr.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(or){this.name=or,this.providers=new Map}addComponent(or){const ar=this.getProvider(or.name);if(ar.isComponentSet())throw new Error(`Component ${or.name} has already been registered with ${this.name}`);ar.setComponent(or)}addOrOverwriteComponent(or){this.getProvider(or.name).isComponentSet()&&this.providers.delete(or.name),this.addComponent(or)}getProvider(or){if(this.providers.has(or))return this.providers.get(or);const ar=new Provider(or,this);return this.providers.set(or,ar),ar}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instances=[];var LogLevel;(function(lr){lr[lr.DEBUG=0]="DEBUG",lr[lr.VERBOSE=1]="VERBOSE",lr[lr.INFO=2]="INFO",lr[lr.WARN=3]="WARN",lr[lr.ERROR=4]="ERROR",lr[lr.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(lr,or,...ar)=>{if(or<lr.logLevel)return;const cr=new Date().toISOString(),ur=ConsoleMethod[or];if(ur)console[ur](`[${cr}]  ${lr.name}:`,...ar);else throw new Error(`Attempted to log a message with an invalid logType (value: ${or})`)};class Logger{constructor(or){this.name=or,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null,instances.push(this)}get logLevel(){return this._logLevel}set logLevel(or){if(!(or in LogLevel))throw new TypeError(`Invalid value "${or}" assigned to \`logLevel\``);this._logLevel=or}setLogLevel(or){this._logLevel=typeof or=="string"?levelStringToEnum[or]:or}get logHandler(){return this._logHandler}set logHandler(or){if(typeof or!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=or}get userLogHandler(){return this._userLogHandler}set userLogHandler(or){this._userLogHandler=or}debug(...or){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...or),this._logHandler(this,LogLevel.DEBUG,...or)}log(...or){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...or),this._logHandler(this,LogLevel.VERBOSE,...or)}info(...or){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...or),this._logHandler(this,LogLevel.INFO,...or)}warn(...or){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...or),this._logHandler(this,LogLevel.WARN,...or)}error(...or){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...or),this._logHandler(this,LogLevel.ERROR,...or)}}function setLogLevel$1(lr){instances.forEach(or=>{or.setLogLevel(lr)})}function setUserLogHandler(lr,or){for(const ar of instances){let cr=null;or&&or.level&&(cr=levelStringToEnum[or.level]),lr===null?ar.userLogHandler=null:ar.userLogHandler=(ur,hr,...fr)=>{const dr=fr.map(pr=>{if(pr==null)return null;if(typeof pr=="string")return pr;if(typeof pr=="number"||typeof pr=="boolean")return pr.toString();if(pr instanceof Error)return pr.message;try{return JSON.stringify(pr)}catch{return null}}).filter(pr=>pr).join(" ");hr>=(cr??ur.logLevel)&&lr({level:LogLevel[hr].toLowerCase(),message:dr,args:fr,type:ur.name})}}}const instanceOfAny=(lr,or)=>or.some(ar=>lr instanceof ar);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(lr){const or=new Promise((ar,cr)=>{const ur=()=>{lr.removeEventListener("success",hr),lr.removeEventListener("error",fr)},hr=()=>{ar(wrap(lr.result)),ur()},fr=()=>{cr(lr.error),ur()};lr.addEventListener("success",hr),lr.addEventListener("error",fr)});return or.then(ar=>{ar instanceof IDBCursor&&cursorRequestMap.set(ar,lr)}).catch(()=>{}),reverseTransformCache.set(or,lr),or}function cacheDonePromiseForTransaction(lr){if(transactionDoneMap.has(lr))return;const or=new Promise((ar,cr)=>{const ur=()=>{lr.removeEventListener("complete",hr),lr.removeEventListener("error",fr),lr.removeEventListener("abort",fr)},hr=()=>{ar(),ur()},fr=()=>{cr(lr.error||new DOMException("AbortError","AbortError")),ur()};lr.addEventListener("complete",hr),lr.addEventListener("error",fr),lr.addEventListener("abort",fr)});transactionDoneMap.set(lr,or)}let idbProxyTraps={get(lr,or,ar){if(lr instanceof IDBTransaction){if(or==="done")return transactionDoneMap.get(lr);if(or==="objectStoreNames")return lr.objectStoreNames||transactionStoreNamesMap.get(lr);if(or==="store")return ar.objectStoreNames[1]?void 0:ar.objectStore(ar.objectStoreNames[0])}return wrap(lr[or])},set(lr,or,ar){return lr[or]=ar,!0},has(lr,or){return lr instanceof IDBTransaction&&(or==="done"||or==="store")?!0:or in lr}};function replaceTraps(lr){idbProxyTraps=lr(idbProxyTraps)}function wrapFunction(lr){return lr===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(or,...ar){const cr=lr.call(unwrap(this),or,...ar);return transactionStoreNamesMap.set(cr,or.sort?or.sort():[or]),wrap(cr)}:getCursorAdvanceMethods().includes(lr)?function(...or){return lr.apply(unwrap(this),or),wrap(cursorRequestMap.get(this))}:function(...or){return wrap(lr.apply(unwrap(this),or))}}function transformCachableValue(lr){return typeof lr=="function"?wrapFunction(lr):(lr instanceof IDBTransaction&&cacheDonePromiseForTransaction(lr),instanceOfAny(lr,getIdbProxyableTypes())?new Proxy(lr,idbProxyTraps):lr)}function wrap(lr){if(lr instanceof IDBRequest)return promisifyRequest(lr);if(transformCache.has(lr))return transformCache.get(lr);const or=transformCachableValue(lr);return or!==lr&&(transformCache.set(lr,or),reverseTransformCache.set(or,lr)),or}const unwrap=lr=>reverseTransformCache.get(lr);function openDB(lr,or,{blocked:ar,upgrade:cr,blocking:ur,terminated:hr}={}){const fr=indexedDB.open(lr,or),dr=wrap(fr);return cr&&fr.addEventListener("upgradeneeded",pr=>{cr(wrap(fr.result),pr.oldVersion,pr.newVersion,wrap(fr.transaction),pr)}),ar&&fr.addEventListener("blocked",pr=>ar(pr.oldVersion,pr.newVersion,pr)),dr.then(pr=>{hr&&pr.addEventListener("close",()=>hr()),ur&&pr.addEventListener("versionchange",mr=>ur(mr.oldVersion,mr.newVersion,mr))}).catch(()=>{}),dr}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(lr,or){if(!(lr instanceof IDBDatabase&&!(or in lr)&&typeof or=="string"))return;if(cachedMethods.get(or))return cachedMethods.get(or);const ar=or.replace(/FromIndex$/,""),cr=or!==ar,ur=writeMethods.includes(ar);if(!(ar in(cr?IDBIndex:IDBObjectStore).prototype)||!(ur||readMethods.includes(ar)))return;const hr=async function(fr,...dr){const pr=this.transaction(fr,ur?"readwrite":"readonly");let mr=pr.store;return cr&&(mr=mr.index(dr.shift())),(await Promise.all([mr[ar](...dr),ur&&pr.done]))[0]};return cachedMethods.set(or,hr),hr}replaceTraps(lr=>({...lr,get:(or,ar,cr)=>getMethod(or,ar)||lr.get(or,ar,cr),has:(or,ar)=>!!getMethod(or,ar)||lr.has(or,ar)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(or){this.container=or}getPlatformInfoString(){return this.container.getProviders().map(ar=>{if(isVersionServiceProvider(ar)){const cr=ar.getImmediate();return`${cr.library}/${cr.version}`}else return null}).filter(ar=>ar).join(" ")}}function isVersionServiceProvider(lr){const or=lr.getComponent();return(or==null?void 0:or.type)==="VERSION"}const name$o="@firebase/app",version$1$1="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$2=new Logger("@firebase/app"),name$n="@firebase/app-compat",name$m="@firebase/analytics-compat",name$l="@firebase/analytics",name$k="@firebase/app-check-compat",name$j="@firebase/app-check",name$i="@firebase/auth",name$h="@firebase/auth-compat",name$g="@firebase/database",name$f="@firebase/database-compat",name$e="@firebase/functions",name$d="@firebase/functions-compat",name$c="@firebase/installations",name$b="@firebase/installations-compat",name$a="@firebase/messaging",name$9="@firebase/messaging-compat",name$8="@firebase/performance",name$7="@firebase/performance-compat",name$6="@firebase/remote-config",name$5="@firebase/remote-config-compat",name$4$1="@firebase/storage",name$3$1="@firebase/storage-compat",name$2$1="@firebase/firestore",name$1$1="@firebase/firestore-compat",name$p="firebase",version$5="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$o]:"fire-core",[name$n]:"fire-core-compat",[name$l]:"fire-analytics",[name$m]:"fire-analytics-compat",[name$j]:"fire-app-check",[name$k]:"fire-app-check-compat",[name$i]:"fire-auth",[name$h]:"fire-auth-compat",[name$g]:"fire-rtdb",[name$f]:"fire-rtdb-compat",[name$e]:"fire-fn",[name$d]:"fire-fn-compat",[name$c]:"fire-iid",[name$b]:"fire-iid-compat",[name$a]:"fire-fcm",[name$9]:"fire-fcm-compat",[name$8]:"fire-perf",[name$7]:"fire-perf-compat",[name$6]:"fire-rc",[name$5]:"fire-rc-compat",[name$4$1]:"fire-gcs",[name$3$1]:"fire-gcs-compat",[name$2$1]:"fire-fst",[name$1$1]:"fire-fst-compat","fire-js":"fire-js",[name$p]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_components=new Map;function _addComponent(lr,or){try{lr.container.addComponent(or)}catch(ar){logger$2.debug(`Component ${or.name} failed to register with FirebaseApp ${lr.name}`,ar)}}function _addOrOverwriteComponent(lr,or){lr.container.addOrOverwriteComponent(or)}function _registerComponent(lr){const or=lr.name;if(_components.has(or))return logger$2.debug(`There were multiple attempts to register component ${or}.`),!1;_components.set(or,lr);for(const ar of _apps.values())_addComponent(ar,lr);return!0}function _getProvider(lr,or){const ar=lr.container.getProvider("heartbeat").getImmediate({optional:!0});return ar&&ar.triggerHeartbeat(),lr.container.getProvider(or)}function _removeServiceInstance(lr,or,ar=DEFAULT_ENTRY_NAME){_getProvider(lr,or).clearInstance(ar)}function _clearComponents(){_components.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS$1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ERROR_FACTORY$1=new ErrorFactory("app","Firebase",ERRORS$1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FirebaseAppImpl$1=class{constructor(or,ar,cr){this._isDeleted=!1,this._options=Object.assign({},or),this._config=Object.assign({},ar),this._name=ar.name,this._automaticDataCollectionEnabled=ar.automaticDataCollectionEnabled,this._container=cr,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(or){this.checkDestroyed(),this._automaticDataCollectionEnabled=or}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(or){this._isDeleted=or}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY$1.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION$1=version$5;function initializeApp(lr,or={}){let ar=lr;typeof or!="object"&&(or={name:or});const cr=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!1},or),ur=cr.name;if(typeof ur!="string"||!ur)throw ERROR_FACTORY$1.create("bad-app-name",{appName:String(ur)});if(ar||(ar=getDefaultAppConfig()),!ar)throw ERROR_FACTORY$1.create("no-options");const hr=_apps.get(ur);if(hr){if(deepEqual(ar,hr.options)&&deepEqual(cr,hr.config))return hr;throw ERROR_FACTORY$1.create("duplicate-app",{appName:ur})}const fr=new ComponentContainer(ur);for(const pr of _components.values())fr.addComponent(pr);const dr=new FirebaseAppImpl$1(ar,cr,fr);return _apps.set(ur,dr),dr}function getApp(lr=DEFAULT_ENTRY_NAME){const or=_apps.get(lr);if(!or&&lr===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!or)throw ERROR_FACTORY$1.create("no-app",{appName:lr});return or}function getApps(){return Array.from(_apps.values())}async function deleteApp(lr){const or=lr.name;_apps.has(or)&&(_apps.delete(or),await Promise.all(lr.container.getProviders().map(ar=>ar.delete())),lr.isDeleted=!0)}function registerVersion(lr,or,ar){var cr;let ur=(cr=PLATFORM_LOG_STRING[lr])!==null&&cr!==void 0?cr:lr;ar&&(ur+=`-${ar}`);const hr=ur.match(/\s|\//),fr=or.match(/\s|\//);if(hr||fr){const dr=[`Unable to register library "${ur}" with version "${or}":`];hr&&dr.push(`library name "${ur}" contains illegal characters (whitespace or "/")`),hr&&fr&&dr.push("and"),fr&&dr.push(`version name "${or}" contains illegal characters (whitespace or "/")`),logger$2.warn(dr.join(" "));return}_registerComponent(new Component(`${ur}-version`,()=>({library:ur,version:or}),"VERSION"))}function onLog(lr,or){if(lr!==null&&typeof lr!="function")throw ERROR_FACTORY$1.create("invalid-log-argument");setUserLogHandler(lr,or)}function setLogLevel(lr){setLogLevel$1(lr)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebase-heartbeat-database",DB_VERSION=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME,DB_VERSION,{upgrade:(lr,or)=>{switch(or){case 0:lr.createObjectStore(STORE_NAME)}}}).catch(lr=>{throw ERROR_FACTORY$1.create("idb-open",{originalErrorMessage:lr.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(lr){try{return await(await getDbPromise()).transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(lr))}catch(or){if(or instanceof FirebaseError)logger$2.warn(or.message);else{const ar=ERROR_FACTORY$1.create("idb-get",{originalErrorMessage:or==null?void 0:or.message});logger$2.warn(ar.message)}}}async function writeHeartbeatsToIndexedDB(lr,or){try{const cr=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await cr.objectStore(STORE_NAME).put(or,computeKey(lr)),await cr.done}catch(ar){if(ar instanceof FirebaseError)logger$2.warn(ar.message);else{const cr=ERROR_FACTORY$1.create("idb-set",{originalErrorMessage:ar==null?void 0:ar.message});logger$2.warn(cr.message)}}}function computeKey(lr){return`${lr.name}!${lr.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor(or){this.container=or,this._heartbeatsCache=null;const ar=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(ar),this._heartbeatsCachePromise=this._storage.read().then(cr=>(this._heartbeatsCache=cr,cr))}async triggerHeartbeat(){const ar=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),cr=getUTCDateString();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===cr||this._heartbeatsCache.heartbeats.some(ur=>ur.date===cr)))return this._heartbeatsCache.heartbeats.push({date:cr,agent:ar}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(ur=>{const hr=new Date(ur.date).valueOf();return Date.now()-hr<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const or=getUTCDateString(),{heartbeatsToSend:ar,unsentEntries:cr}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),ur=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:ar}));return this._heartbeatsCache.lastSentHeartbeatDate=or,cr.length>0?(this._heartbeatsCache.heartbeats=cr,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),ur}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(lr,or=MAX_HEADER_BYTES){const ar=[];let cr=lr.slice();for(const ur of lr){const hr=ar.find(fr=>fr.agent===ur.agent);if(hr){if(hr.dates.push(ur.date),countBytes(ar)>or){hr.dates.pop();break}}else if(ar.push({agent:ur.agent,dates:[ur.date]}),countBytes(ar)>or){ar.pop();break}cr=cr.slice(1)}return{heartbeatsToSend:ar,unsentEntries:cr}}class HeartbeatStorageImpl{constructor(or){this.app=or,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await readHeartbeatsFromIndexedDB(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(or){var ar;if(await this._canUseIndexedDBPromise){const ur=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(ar=or.lastSentHeartbeatDate)!==null&&ar!==void 0?ar:ur.lastSentHeartbeatDate,heartbeats:or.heartbeats})}else return}async add(or){var ar;if(await this._canUseIndexedDBPromise){const ur=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(ar=or.lastSentHeartbeatDate)!==null&&ar!==void 0?ar:ur.lastSentHeartbeatDate,heartbeats:[...ur.heartbeats,...or.heartbeats]})}else return}}function countBytes(lr){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:lr})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents$1(lr){_registerComponent(new Component("platform-logger",or=>new PlatformLoggerServiceImpl(or),"PRIVATE")),_registerComponent(new Component("heartbeat",or=>new HeartbeatServiceImpl(or),"PRIVATE")),registerVersion(name$o,version$1$1,lr),registerVersion(name$o,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents$1("");const modularAPIs=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError,SDK_VERSION:SDK_VERSION$1,_DEFAULT_ENTRY_NAME:DEFAULT_ENTRY_NAME,_addComponent,_addOrOverwriteComponent,_apps,_clearComponents,_components,_getProvider,_registerComponent,_removeServiceInstance,deleteApp,getApp,getApps,initializeApp,onLog,registerVersion,setLogLevel},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(or,ar){this._delegate=or,this.firebase=ar,_addComponent(or,new Component("app-compat",()=>this,"PUBLIC")),this.container=or.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(or){this._delegate.automaticDataCollectionEnabled=or}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(or=>{this._delegate.checkDestroyed(),or()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),deleteApp(this._delegate)))}_getService(or,ar=DEFAULT_ENTRY_NAME){var cr;this._delegate.checkDestroyed();const ur=this._delegate.container.getProvider(or);return!ur.isInitialized()&&((cr=ur.getComponent())===null||cr===void 0?void 0:cr.instantiationMode)==="EXPLICIT"&&ur.initialize(),ur.getImmediate({identifier:ar})}_removeServiceInstance(or,ar=DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(or).clearInstance(ar)}_addComponent(or){_addComponent(this._delegate,or)}_addOrOverwriteComponent(or){_addOrOverwriteComponent(this._delegate,or)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},ERROR_FACTORY=new ErrorFactory("app-compat","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createFirebaseNamespaceCore(lr){const or={},ar={__esModule:!0,initializeApp:hr,app:ur,registerVersion,setLogLevel,onLog,apps:null,SDK_VERSION:SDK_VERSION$1,INTERNAL:{registerComponent:dr,removeApp:cr,useAsService:pr,modularAPIs}};ar.default=ar,Object.defineProperty(ar,"apps",{get:fr});function cr(mr){delete or[mr]}function ur(mr){if(mr=mr||DEFAULT_ENTRY_NAME,!contains(or,mr))throw ERROR_FACTORY.create("no-app",{appName:mr});return or[mr]}ur.App=lr;function hr(mr,gr={}){const yr=initializeApp(mr,gr);if(contains(or,yr.name))return or[yr.name];const br=new lr(yr,ar);return or[yr.name]=br,br}function fr(){return Object.keys(or).map(mr=>or[mr])}function dr(mr){const gr=mr.name,yr=gr.replace("-compat","");if(_registerComponent(mr)&&mr.type==="PUBLIC"){const br=(Or=ur())=>{if(typeof Or[yr]!="function")throw ERROR_FACTORY.create("invalid-app-argument",{appName:gr});return Or[yr]()};mr.serviceProps!==void 0&&deepExtend(br,mr.serviceProps),ar[yr]=br,lr.prototype[yr]=function(...Or){return this._getService.bind(this,gr).apply(this,mr.multipleInstances?Or:[])}}return mr.type==="PUBLIC"?ar[yr]:null}function pr(mr,gr){return gr==="serverAuth"?null:gr}return ar}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createFirebaseNamespace(){const lr=createFirebaseNamespaceCore(FirebaseAppImpl);lr.INTERNAL=Object.assign(Object.assign({},lr.INTERNAL),{createFirebaseNamespace,extendNamespace:or,createSubscribe,ErrorFactory,deepExtend});function or(ar){deepExtend(lr,ar)}return lr}const firebase$1=createFirebaseNamespace();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$1=new Logger("@firebase/app-compat"),name$4="@firebase/app-compat",version$4="0.2.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(lr){registerVersion(name$4,version$4,lr)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(isBrowser()&&self.firebase!==void 0){logger$1.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const lr=self.firebase.SDK_VERSION;lr&&lr.indexOf("LITE")>=0&&logger$1.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const firebase=firebase$1;registerCoreComponents();var name$3="firebase",version$3="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */firebase.registerVersion(name$3,version$3,"app-compat");const name$2="@firebase/database",version$2="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SDK_VERSION="";function setSDKVersion(lr){SDK_VERSION=lr}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DOMStorageWrapper{constructor(or){this.domStorage_=or,this.prefix_="firebase:"}set(or,ar){ar==null?this.domStorage_.removeItem(this.prefixedName_(or)):this.domStorage_.setItem(this.prefixedName_(or),stringify(ar))}get(or){const ar=this.domStorage_.getItem(this.prefixedName_(or));return ar==null?null:jsonEval(ar)}remove(or){this.domStorage_.removeItem(this.prefixedName_(or))}prefixedName_(or){return this.prefix_+or}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MemoryStorage{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(or,ar){ar==null?delete this.cache_[or]:this.cache_[or]=ar}get(or){return contains(this.cache_,or)?this.cache_[or]:null}remove(or){delete this.cache_[or]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const createStoragefor=function(lr){try{if(typeof window<"u"&&typeof window[lr]<"u"){const or=window[lr];return or.setItem("firebase:sentinel","cache"),or.removeItem("firebase:sentinel"),new DOMStorageWrapper(or)}}catch{}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient$1=new Logger("@firebase/database"),LUIDGenerator=function(){let lr=1;return function(){return lr++}}(),sha1=function(lr){const or=stringToByteArray(lr),ar=new Sha1;ar.update(or);const cr=ar.digest();return base64.encodeByteArray(cr)},buildLogMessage_=function(...lr){let or="";for(let ar=0;ar<lr.length;ar++){const cr=lr[ar];Array.isArray(cr)||cr&&typeof cr=="object"&&typeof cr.length=="number"?or+=buildLogMessage_.apply(null,cr):typeof cr=="object"?or+=stringify(cr):or+=cr,or+=" "}return or};let logger=null,firstLog_=!0;const enableLogging$1=function(lr,or){assert(!or||lr===!0||lr===!1,"Can't turn on custom loggers persistently."),lr===!0?(logClient$1.logLevel=LogLevel.VERBOSE,logger=logClient$1.log.bind(logClient$1),or&&SessionStorage.set("logging_enabled",!0)):typeof lr=="function"?logger=lr:(logger=null,SessionStorage.remove("logging_enabled"))},log=function(...lr){if(firstLog_===!0&&(firstLog_=!1,logger===null&&SessionStorage.get("logging_enabled")===!0&&enableLogging$1(!0)),logger){const or=buildLogMessage_.apply(null,lr);logger(or)}},logWrapper=function(lr){return function(...or){log(lr,...or)}},error=function(...lr){const or="FIREBASE INTERNAL ERROR: "+buildLogMessage_(...lr);logClient$1.error(or)},fatal=function(...lr){const or=`FIREBASE FATAL ERROR: ${buildLogMessage_(...lr)}`;throw logClient$1.error(or),new Error(or)},warn$1=function(...lr){const or="FIREBASE WARNING: "+buildLogMessage_(...lr);logClient$1.warn(or)},warnIfPageIsSecure=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&warn$1("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(lr){return typeof lr=="number"&&(lr!==lr||lr===Number.POSITIVE_INFINITY||lr===Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(lr){if(document.readyState==="complete")lr();else{let or=!1;const ar=function(){if(!document.body){setTimeout(ar,Math.floor(10));return}or||(or=!0,lr())};document.addEventListener?(document.addEventListener("DOMContentLoaded",ar,!1),window.addEventListener("load",ar,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&ar()}),window.attachEvent("onload",ar))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(lr,or){if(lr===or)return 0;if(lr===MIN_NAME||or===MAX_NAME)return-1;if(or===MIN_NAME||lr===MAX_NAME)return 1;{const ar=tryParseInt(lr),cr=tryParseInt(or);return ar!==null?cr!==null?ar-cr===0?lr.length-or.length:ar-cr:-1:cr!==null?1:lr<or?-1:1}},stringCompare=function(lr,or){return lr===or?0:lr<or?-1:1},requireKey=function(lr,or){if(or&&lr in or)return or[lr];throw new Error("Missing required key ("+lr+") in object: "+stringify(or))},ObjectToUniqueKey=function(lr){if(typeof lr!="object"||lr===null)return stringify(lr);const or=[];for(const cr in lr)or.push(cr);or.sort();let ar="{";for(let cr=0;cr<or.length;cr++)cr!==0&&(ar+=","),ar+=stringify(or[cr]),ar+=":",ar+=ObjectToUniqueKey(lr[or[cr]]);return ar+="}",ar},splitStringBySize=function(lr,or){const ar=lr.length;if(ar<=or)return[lr];const cr=[];for(let ur=0;ur<ar;ur+=or)ur+or>ar?cr.push(lr.substring(ur,ar)):cr.push(lr.substring(ur,ur+or));return cr};function each(lr,or){for(const ar in lr)lr.hasOwnProperty(ar)&&or(ar,lr[ar])}const doubleToIEEE754String=function(lr){assert(!isInvalidJSONNumber(lr),"Invalid JSON number");const or=11,ar=52,cr=(1<<or-1)-1;let ur,hr,fr,dr,pr;lr===0?(hr=0,fr=0,ur=1/lr===-1/0?1:0):(ur=lr<0,lr=Math.abs(lr),lr>=Math.pow(2,1-cr)?(dr=Math.min(Math.floor(Math.log(lr)/Math.LN2),cr),hr=dr+cr,fr=Math.round(lr*Math.pow(2,ar-dr)-Math.pow(2,ar))):(hr=0,fr=Math.round(lr/Math.pow(2,1-cr-ar))));const mr=[];for(pr=ar;pr;pr-=1)mr.push(fr%2?1:0),fr=Math.floor(fr/2);for(pr=or;pr;pr-=1)mr.push(hr%2?1:0),hr=Math.floor(hr/2);mr.push(ur?1:0),mr.reverse();const gr=mr.join("");let yr="";for(pr=0;pr<64;pr+=8){let br=parseInt(gr.substr(pr,8),2).toString(16);br.length===1&&(br="0"+br),yr=yr+br}return yr.toLowerCase()},isChromeExtensionContentScript=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function errorForServerCode(lr,or){let ar="Unknown Error";lr==="too_big"?ar="The data requested exceeds the maximum size that can be accessed with a single request.":lr==="permission_denied"?ar="Client doesn't have permission to access the desired data.":lr==="unavailable"&&(ar="The service is unavailable");const cr=new Error(lr+" at "+or._path.toString()+": "+ar);return cr.code=lr.toUpperCase(),cr}const INTEGER_REGEXP_=new RegExp("^-?(0*)\\d{1,10}$"),INTEGER_32_MIN=-2147483648,INTEGER_32_MAX=2147483647,tryParseInt=function(lr){if(INTEGER_REGEXP_.test(lr)){const or=Number(lr);if(or>=INTEGER_32_MIN&&or<=INTEGER_32_MAX)return or}return null},exceptionGuard=function(lr){try{lr()}catch(or){setTimeout(()=>{const ar=or.stack||"";throw warn$1("Exception was thrown by user callback.",ar),or},Math.floor(0))}},beingCrawled=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},setTimeoutNonBlocking=function(lr,or){const ar=setTimeout(lr,or);return typeof ar=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(ar):typeof ar=="object"&&ar.unref&&ar.unref(),ar};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AppCheckTokenProvider{constructor(or,ar){this.appName_=or,this.appCheckProvider=ar,this.appCheck=ar==null?void 0:ar.getImmediate({optional:!0}),this.appCheck||ar==null||ar.get().then(cr=>this.appCheck=cr)}getToken(or){return this.appCheck?this.appCheck.getToken(or):new Promise((ar,cr)=>{setTimeout(()=>{this.appCheck?this.getToken(or).then(ar,cr):ar(null)},0)})}addTokenChangeListener(or){var ar;(ar=this.appCheckProvider)===null||ar===void 0||ar.get().then(cr=>cr.addTokenListener(or))}notifyForInvalidToken(){warn$1(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAuthTokenProvider{constructor(or,ar,cr){this.appName_=or,this.firebaseOptions_=ar,this.authProvider_=cr,this.auth_=null,this.auth_=cr.getImmediate({optional:!0}),this.auth_||cr.onInit(ur=>this.auth_=ur)}getToken(or){return this.auth_?this.auth_.getToken(or).catch(ar=>ar&&ar.code==="auth/token-not-initialized"?(log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(ar)):new Promise((ar,cr)=>{setTimeout(()=>{this.auth_?this.getToken(or).then(ar,cr):ar(null)},0)})}addTokenChangeListener(or){this.auth_?this.auth_.addAuthTokenListener(or):this.authProvider_.get().then(ar=>ar.addAuthTokenListener(or))}removeTokenChangeListener(or){this.authProvider_.get().then(ar=>ar.removeAuthTokenListener(or))}notifyForInvalidToken(){let or='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?or+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?or+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':or+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn$1(or)}}class EmulatorTokenProvider{constructor(or){this.accessToken=or}getToken(or){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(or){or(this.accessToken)}removeTokenChangeListener(or){}notifyForInvalidToken(){}}EmulatorTokenProvider.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PROTOCOL_VERSION="5",VERSION_PARAM="v",TRANSPORT_SESSION_PARAM="s",REFERER_PARAM="r",FORGE_REF="f",FORGE_DOMAIN_RE=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,LAST_SESSION_PARAM="ls",APPLICATION_ID_PARAM="p",APP_CHECK_TOKEN_PARAM="ac",WEBSOCKET="websocket",LONG_POLLING="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RepoInfo{constructor(or,ar,cr,ur,hr=!1,fr="",dr=!1,pr=!1){this.secure=ar,this.namespace=cr,this.webSocketOnly=ur,this.nodeAdmin=hr,this.persistenceKey=fr,this.includeNamespaceInQueryParams=dr,this.isUsingEmulator=pr,this._host=or.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+or)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(or){or!==this.internalHost&&(this.internalHost=or,this.isCacheableHost()&&PersistentStorage.set("host:"+this._host,this.internalHost))}toString(){let or=this.toURLString();return this.persistenceKey&&(or+="<"+this.persistenceKey+">"),or}toURLString(){const or=this.secure?"https://":"http://",ar=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${or}${this.host}/${ar}`}}function repoInfoNeedsQueryParam(lr){return lr.host!==lr.internalHost||lr.isCustomHost()||lr.includeNamespaceInQueryParams}function repoInfoConnectionURL(lr,or,ar){assert(typeof or=="string","typeof type must == string"),assert(typeof ar=="object","typeof params must == object");let cr;if(or===WEBSOCKET)cr=(lr.secure?"wss://":"ws://")+lr.internalHost+"/.ws?";else if(or===LONG_POLLING)cr=(lr.secure?"https://":"http://")+lr.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+or);repoInfoNeedsQueryParam(lr)&&(ar.ns=lr.namespace);const ur=[];return each(ar,(hr,fr)=>{ur.push(hr+"="+fr)}),cr+ur.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsCollection{constructor(){this.counters_={}}incrementCounter(or,ar=1){contains(this.counters_,or)||(this.counters_[or]=0),this.counters_[or]+=ar}get(){return deepCopy(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const collections={},reporters={};function statsManagerGetCollection(lr){const or=lr.toString();return collections[or]||(collections[or]=new StatsCollection),collections[or]}function statsManagerGetOrCreateReporter(lr,or){const ar=lr.toString();return reporters[ar]||(reporters[ar]=or()),reporters[ar]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PacketReceiver{constructor(or){this.onMessage_=or,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(or,ar){this.closeAfterResponse=or,this.onClose=ar,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(or,ar){for(this.pendingResponses[or]=ar;this.pendingResponses[this.currentResponseNum];){const cr=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let ur=0;ur<cr.length;++ur)cr[ur]&&exceptionGuard(()=>{this.onMessage_(cr[ur])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_LONGPOLL_START_PARAM="start",FIREBASE_LONGPOLL_CLOSE_COMMAND="close",FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",FIREBASE_LONGPOLL_ID_PARAM="id",FIREBASE_LONGPOLL_PW_PARAM="pw",FIREBASE_LONGPOLL_SERIAL_PARAM="ser",FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",FIREBASE_LONGPOLL_DATA_PARAM="d",FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",MAX_URL_DATA_SIZE=1870,SEG_HEADER_SIZE=30,MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE,KEEPALIVE_REQUEST_INTERVAL=25e3,LP_CONNECT_TIMEOUT=3e4;class BrowserPollConnection{constructor(or,ar,cr,ur,hr,fr,dr){this.connId=or,this.repoInfo=ar,this.applicationId=cr,this.appCheckToken=ur,this.authToken=hr,this.transportSessionId=fr,this.lastSessionId=dr,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(or),this.stats_=statsManagerGetCollection(ar),this.urlFn=pr=>(this.appCheckToken&&(pr[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),repoInfoConnectionURL(ar,LONG_POLLING,pr))}open(or,ar){this.curSegmentNum=0,this.onDisconnect_=ar,this.myPacketOrderer=new PacketReceiver(or),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT)),executeWhenDOMReady(()=>{if(this.isClosed_)return;this.scriptTagHolder=new FirebaseIFrameScriptHolder((...hr)=>{const[fr,dr,pr,mr,gr]=hr;if(this.incrementIncomingBytes_(hr),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,fr===FIREBASE_LONGPOLL_START_PARAM)this.id=dr,this.password=pr;else if(fr===FIREBASE_LONGPOLL_CLOSE_COMMAND)dr?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(dr,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+fr)},(...hr)=>{const[fr,dr]=hr;this.incrementIncomingBytes_(hr),this.myPacketOrderer.handleResponse(fr,dr)},()=>{this.onClosed_()},this.urlFn);const cr={};cr[FIREBASE_LONGPOLL_START_PARAM]="t",cr[FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(cr[FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=this.scriptTagHolder.uniqueCallbackIdentifier),cr[VERSION_PARAM]=PROTOCOL_VERSION,this.transportSessionId&&(cr[TRANSPORT_SESSION_PARAM]=this.transportSessionId),this.lastSessionId&&(cr[LAST_SESSION_PARAM]=this.lastSessionId),this.applicationId&&(cr[APPLICATION_ID_PARAM]=this.applicationId),this.appCheckToken&&(cr[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(cr[REFERER_PARAM]=FORGE_REF);const ur=this.urlFn(cr);this.log_("Connecting via long-poll to "+ur),this.scriptTagHolder.addTag(ur,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){BrowserPollConnection.forceAllow_=!0}static forceDisallow(){BrowserPollConnection.forceDisallow_=!0}static isAvailable(){return BrowserPollConnection.forceAllow_?!0:!BrowserPollConnection.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(or){const ar=stringify(or);this.bytesSent+=ar.length,this.stats_.incrementCounter("bytes_sent",ar.length);const cr=base64Encode(ar),ur=splitStringBySize(cr,MAX_PAYLOAD_SIZE);for(let hr=0;hr<ur.length;hr++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,ur.length,ur[hr]),this.curSegmentNum++}addDisconnectPingFrame(or,ar){this.myDisconnFrame=document.createElement("iframe");const cr={};cr[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",cr[FIREBASE_LONGPOLL_ID_PARAM]=or,cr[FIREBASE_LONGPOLL_PW_PARAM]=ar,this.myDisconnFrame.src=this.urlFn(cr),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(or){const ar=stringify(or).length;this.bytesReceived+=ar,this.stats_.incrementCounter("bytes_received",ar)}}class FirebaseIFrameScriptHolder{constructor(or,ar,cr,ur){this.onDisconnect=cr,this.urlFn=ur,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=or,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=ar,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();let hr="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(hr='<script>document.domain="'+document.domain+'";<\/script>');const fr="<html><body>"+hr+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(fr),this.myIFrame.doc.close()}catch(dr){log("frame writing exception"),dr.stack&&log(dr.stack),log(dr)}}}static createIFrame_(){const or=document.createElement("iframe");if(or.style.display="none",document.body){document.body.appendChild(or);try{or.contentWindow.document||log("No IE domain setting required")}catch{const cr=document.domain;or.src="javascript:void((function(){document.open();document.domain='"+cr+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return or.contentDocument?or.doc=or.contentDocument:or.contentWindow?or.doc=or.contentWindow.document:or.document&&(or.doc=or.document),or}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const or=this.onDisconnect;or&&(this.onDisconnect=null,or())}startLongPoll(or,ar){for(this.myID=or,this.myPW=ar,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const or={};or[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,or[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,or[FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;let ar=this.urlFn(or),cr="",ur=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+SEG_HEADER_SIZE+cr.length<=MAX_URL_DATA_SIZE;){const fr=this.pendingSegs.shift();cr=cr+"&"+FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+ur+"="+fr.seg+"&"+FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+ur+"="+fr.ts+"&"+FIREBASE_LONGPOLL_DATA_PARAM+ur+"="+fr.d,ur++}return ar=ar+cr,this.addLongPollTag_(ar,this.currentSerial),!0}else return!1}enqueueSegment(or,ar,cr){this.pendingSegs.push({seg:or,ts:ar,d:cr}),this.alive&&this.newRequest_()}addLongPollTag_(or,ar){this.outstandingRequests.add(ar);const cr=()=>{this.outstandingRequests.delete(ar),this.newRequest_()},ur=setTimeout(cr,Math.floor(KEEPALIVE_REQUEST_INTERVAL)),hr=()=>{clearTimeout(ur),cr()};this.addTag(or,hr)}addTag(or,ar){setTimeout(()=>{try{if(!this.sendNewPolls)return;const cr=this.myIFrame.doc.createElement("script");cr.type="text/javascript",cr.async=!0,cr.src=or,cr.onload=cr.onreadystatechange=function(){const ur=cr.readyState;(!ur||ur==="loaded"||ur==="complete")&&(cr.onload=cr.onreadystatechange=null,cr.parentNode&&cr.parentNode.removeChild(cr),ar())},cr.onerror=()=>{log("Long-poll script failed to load: "+or),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(cr)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEBSOCKET_MAX_FRAME_SIZE=16384,WEBSOCKET_KEEPALIVE_INTERVAL=45e3;let WebSocketImpl=null;typeof MozWebSocket<"u"?WebSocketImpl=MozWebSocket:typeof WebSocket<"u"&&(WebSocketImpl=WebSocket);class WebSocketConnection{constructor(or,ar,cr,ur,hr,fr,dr){this.connId=or,this.applicationId=cr,this.appCheckToken=ur,this.authToken=hr,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=statsManagerGetCollection(ar),this.connURL=WebSocketConnection.connectionURL_(ar,fr,dr,ur,cr),this.nodeAdmin=ar.nodeAdmin}static connectionURL_(or,ar,cr,ur,hr){const fr={};return fr[VERSION_PARAM]=PROTOCOL_VERSION,typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(fr[REFERER_PARAM]=FORGE_REF),ar&&(fr[TRANSPORT_SESSION_PARAM]=ar),cr&&(fr[LAST_SESSION_PARAM]=cr),ur&&(fr[APP_CHECK_TOKEN_PARAM]=ur),hr&&(fr[APPLICATION_ID_PARAM]=hr),repoInfoConnectionURL(or,WEBSOCKET,fr)}open(or,ar){this.onDisconnect=ar,this.onMessage=or,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{let cr;isNodeSdk(),this.mySock=new WebSocketImpl(this.connURL,[],cr)}catch(cr){this.log_("Error instantiating WebSocket.");const ur=cr.message||cr.data;ur&&this.log_(ur),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=cr=>{this.handleIncomingFrame(cr)},this.mySock.onerror=cr=>{this.log_("WebSocket error.  Closing connection.");const ur=cr.message||cr.data;ur&&this.log_(ur),this.onClosed_()}}start(){}static forceDisallow(){WebSocketConnection.forceDisallow_=!0}static isAvailable(){let or=!1;if(typeof navigator<"u"&&navigator.userAgent){const ar=/Android ([0-9]{0,}\.[0-9]{0,})/,cr=navigator.userAgent.match(ar);cr&&cr.length>1&&parseFloat(cr[1])<4.4&&(or=!0)}return!or&&WebSocketImpl!==null&&!WebSocketConnection.forceDisallow_}static previouslyFailed(){return PersistentStorage.isInMemoryStorage||PersistentStorage.get("previous_websocket_failure")===!0}markConnectionHealthy(){PersistentStorage.remove("previous_websocket_failure")}appendFrame_(or){if(this.frames.push(or),this.frames.length===this.totalFrames){const ar=this.frames.join("");this.frames=null;const cr=jsonEval(ar);this.onMessage(cr)}}handleNewFrameCount_(or){this.totalFrames=or,this.frames=[]}extractFrameCount_(or){if(assert(this.frames===null,"We already have a frame buffer"),or.length<=6){const ar=Number(or);if(!isNaN(ar))return this.handleNewFrameCount_(ar),null}return this.handleNewFrameCount_(1),or}handleIncomingFrame(or){if(this.mySock===null)return;const ar=or.data;if(this.bytesReceived+=ar.length,this.stats_.incrementCounter("bytes_received",ar.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(ar);else{const cr=this.extractFrameCount_(ar);cr!==null&&this.appendFrame_(cr)}}send(or){this.resetKeepAlive();const ar=stringify(or);this.bytesSent+=ar.length,this.stats_.incrementCounter("bytes_sent",ar.length);const cr=splitStringBySize(ar,WEBSOCKET_MAX_FRAME_SIZE);cr.length>1&&this.sendString_(String(cr.length));for(let ur=0;ur<cr.length;ur++)this.sendString_(cr[ur])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))}sendString_(or){try{this.mySock.send(or)}catch(ar){this.log_("Exception thrown from WebSocket.send():",ar.message||ar.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}WebSocketConnection.responsesRequiredToBeHealthy=2;WebSocketConnection.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransportManager{constructor(or){this.initTransports_(or)}static get ALL_TRANSPORTS(){return[BrowserPollConnection,WebSocketConnection]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(or){const ar=WebSocketConnection&&WebSocketConnection.isAvailable();let cr=ar&&!WebSocketConnection.previouslyFailed();if(or.webSocketOnly&&(ar||warn$1("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),cr=!0),cr)this.transports_=[WebSocketConnection];else{const ur=this.transports_=[];for(const hr of TransportManager.ALL_TRANSPORTS)hr&&hr.isAvailable()&&ur.push(hr);TransportManager.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}TransportManager.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UPGRADE_TIMEOUT=6e4,DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3,BYTES_SENT_HEALTHY_OVERRIDE=10*1024,BYTES_RECEIVED_HEALTHY_OVERRIDE=100*1024,MESSAGE_TYPE="t",MESSAGE_DATA="d",CONTROL_SHUTDOWN="s",CONTROL_RESET="r",CONTROL_ERROR="e",CONTROL_PONG="o",SWITCH_ACK="a",END_TRANSMISSION="n",PING="p",SERVER_HELLO="h";class Connection{constructor(or,ar,cr,ur,hr,fr,dr,pr,mr,gr){this.id=or,this.repoInfo_=ar,this.applicationId_=cr,this.appCheckToken_=ur,this.authToken_=hr,this.onMessage_=fr,this.onReady_=dr,this.onDisconnect_=pr,this.onKill_=mr,this.lastSessionId=gr,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(ar),this.log_("Connection created"),this.start_()}start_(){const or=this.transportManager_.initialTransport();this.conn_=new or(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=or.responsesRequiredToBeHealthy||0;const ar=this.connReceiver_(this.conn_),cr=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(ar,cr)},Math.floor(0));const ur=or.healthyTimeout||0;ur>0&&(this.healthyTimeout_=setTimeoutNonBlocking(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(ur)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(or){return ar=>{or===this.conn_?this.onConnectionLost_(ar):or===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(or){return ar=>{this.state_!==2&&(or===this.rx_?this.onPrimaryMessageReceived_(ar):or===this.secondaryConn_?this.onSecondaryMessageReceived_(ar):this.log_("message on old connection"))}}sendRequest(or){const ar={t:"d",d:or};this.sendData_(ar)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(or){if(MESSAGE_TYPE in or){const ar=or[MESSAGE_TYPE];ar===SWITCH_ACK?this.upgradeIfSecondaryHealthy_():ar===CONTROL_RESET?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):ar===CONTROL_PONG&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(or){const ar=requireKey("t",or),cr=requireKey("d",or);if(ar==="c")this.onSecondaryControl_(cr);else if(ar==="d")this.pendingDataMessages.push(cr);else throw new Error("Unknown protocol layer: "+ar)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(or){const ar=requireKey("t",or),cr=requireKey("d",or);ar==="c"?this.onControl_(cr):ar==="d"&&this.onDataMessage_(cr)}onDataMessage_(or){this.onPrimaryResponse_(),this.onMessage_(or)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(or){const ar=requireKey(MESSAGE_TYPE,or);if(MESSAGE_DATA in or){const cr=or[MESSAGE_DATA];if(ar===SERVER_HELLO){const ur=Object.assign({},cr);this.repoInfo_.isUsingEmulator&&(ur.h=this.repoInfo_.host),this.onHandshake_(ur)}else if(ar===END_TRANSMISSION){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let ur=0;ur<this.pendingDataMessages.length;++ur)this.onDataMessage_(this.pendingDataMessages[ur]);this.pendingDataMessages=[],this.tryCleanupConnection()}else ar===CONTROL_SHUTDOWN?this.onConnectionShutdown_(cr):ar===CONTROL_RESET?this.onReset_(cr):ar===CONTROL_ERROR?error("Server Error: "+cr):ar===CONTROL_PONG?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error("Unknown control packet command: "+ar)}}onHandshake_(or){const ar=or.ts,cr=or.v,ur=or.h;this.sessionId=or.s,this.repoInfo_.host=ur,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,ar),PROTOCOL_VERSION!==cr&&warn$1("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const or=this.transportManager_.upgradeTransport();or&&this.startUpgrade_(or)}startUpgrade_(or){this.secondaryConn_=new or(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=or.responsesRequiredToBeHealthy||0;const ar=this.connReceiver_(this.secondaryConn_),cr=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(ar,cr),setTimeoutNonBlocking(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(UPGRADE_TIMEOUT))}onReset_(or){this.log_("Reset packet received.  New host: "+or),this.repoInfo_.host=or,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(or,ar){this.log_("Realtime connection established."),this.conn_=or,this.state_=1,this.onReady_&&(this.onReady_(ar,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PING,d:{}}}))}onSecondaryConnectionLost_(){const or=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===or||this.rx_===or)&&this.close()}onConnectionLost_(or){this.conn_=null,!or&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(or){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(or),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(or){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(or)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ServerActions{put(or,ar,cr,ur){}merge(or,ar,cr,ur){}refreshAuthToken(or){}refreshAppCheckToken(or){}onDisconnectPut(or,ar,cr){}onDisconnectMerge(or,ar,cr){}onDisconnectCancel(or,ar){}reportStats(or){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EventEmitter$1=class{constructor(or){this.allowedEvents_=or,this.listeners_={},assert(Array.isArray(or)&&or.length>0,"Requires a non-empty array")}trigger(or,...ar){if(Array.isArray(this.listeners_[or])){const cr=[...this.listeners_[or]];for(let ur=0;ur<cr.length;ur++)cr[ur].callback.apply(cr[ur].context,ar)}}on(or,ar,cr){this.validateEventType_(or),this.listeners_[or]=this.listeners_[or]||[],this.listeners_[or].push({callback:ar,context:cr});const ur=this.getInitialEvent(or);ur&&ar.apply(cr,ur)}off(or,ar,cr){this.validateEventType_(or);const ur=this.listeners_[or]||[];for(let hr=0;hr<ur.length;hr++)if(ur[hr].callback===ar&&(!cr||cr===ur[hr].context)){ur.splice(hr,1);return}}validateEventType_(or){assert(this.allowedEvents_.find(ar=>ar===or),"Unknown event: "+or)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OnlineMonitor extends EventEmitter$1{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!isMobileCordova()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new OnlineMonitor}getInitialEvent(or){return assert(or==="online","Unknown event type: "+or),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_PATH_DEPTH=32,MAX_PATH_LENGTH_BYTES=768;class Path{constructor(or,ar){if(ar===void 0){this.pieces_=or.split("/");let cr=0;for(let ur=0;ur<this.pieces_.length;ur++)this.pieces_[ur].length>0&&(this.pieces_[cr]=this.pieces_[ur],cr++);this.pieces_.length=cr,this.pieceNum_=0}else this.pieces_=or,this.pieceNum_=ar}toString(){let or="";for(let ar=this.pieceNum_;ar<this.pieces_.length;ar++)this.pieces_[ar]!==""&&(or+="/"+this.pieces_[ar]);return or||"/"}}function newEmptyPath(){return new Path("")}function pathGetFront(lr){return lr.pieceNum_>=lr.pieces_.length?null:lr.pieces_[lr.pieceNum_]}function pathGetLength(lr){return lr.pieces_.length-lr.pieceNum_}function pathPopFront(lr){let or=lr.pieceNum_;return or<lr.pieces_.length&&or++,new Path(lr.pieces_,or)}function pathGetBack(lr){return lr.pieceNum_<lr.pieces_.length?lr.pieces_[lr.pieces_.length-1]:null}function pathToUrlEncodedString(lr){let or="";for(let ar=lr.pieceNum_;ar<lr.pieces_.length;ar++)lr.pieces_[ar]!==""&&(or+="/"+encodeURIComponent(String(lr.pieces_[ar])));return or||"/"}function pathSlice(lr,or=0){return lr.pieces_.slice(lr.pieceNum_+or)}function pathParent(lr){if(lr.pieceNum_>=lr.pieces_.length)return null;const or=[];for(let ar=lr.pieceNum_;ar<lr.pieces_.length-1;ar++)or.push(lr.pieces_[ar]);return new Path(or,0)}function pathChild(lr,or){const ar=[];for(let cr=lr.pieceNum_;cr<lr.pieces_.length;cr++)ar.push(lr.pieces_[cr]);if(or instanceof Path)for(let cr=or.pieceNum_;cr<or.pieces_.length;cr++)ar.push(or.pieces_[cr]);else{const cr=or.split("/");for(let ur=0;ur<cr.length;ur++)cr[ur].length>0&&ar.push(cr[ur])}return new Path(ar,0)}function pathIsEmpty(lr){return lr.pieceNum_>=lr.pieces_.length}function newRelativePath(lr,or){const ar=pathGetFront(lr),cr=pathGetFront(or);if(ar===null)return or;if(ar===cr)return newRelativePath(pathPopFront(lr),pathPopFront(or));throw new Error("INTERNAL ERROR: innerPath ("+or+") is not within outerPath ("+lr+")")}function pathCompare(lr,or){const ar=pathSlice(lr,0),cr=pathSlice(or,0);for(let ur=0;ur<ar.length&&ur<cr.length;ur++){const hr=nameCompare(ar[ur],cr[ur]);if(hr!==0)return hr}return ar.length===cr.length?0:ar.length<cr.length?-1:1}function pathEquals(lr,or){if(pathGetLength(lr)!==pathGetLength(or))return!1;for(let ar=lr.pieceNum_,cr=or.pieceNum_;ar<=lr.pieces_.length;ar++,cr++)if(lr.pieces_[ar]!==or.pieces_[cr])return!1;return!0}function pathContains(lr,or){let ar=lr.pieceNum_,cr=or.pieceNum_;if(pathGetLength(lr)>pathGetLength(or))return!1;for(;ar<lr.pieces_.length;){if(lr.pieces_[ar]!==or.pieces_[cr])return!1;++ar,++cr}return!0}class ValidationPath{constructor(or,ar){this.errorPrefix_=ar,this.parts_=pathSlice(or,0),this.byteLength_=Math.max(1,this.parts_.length);for(let cr=0;cr<this.parts_.length;cr++)this.byteLength_+=stringLength(this.parts_[cr]);validationPathCheckValid(this)}}function validationPathPush(lr,or){lr.parts_.length>0&&(lr.byteLength_+=1),lr.parts_.push(or),lr.byteLength_+=stringLength(or),validationPathCheckValid(lr)}function validationPathPop(lr){const or=lr.parts_.pop();lr.byteLength_-=stringLength(or),lr.parts_.length>0&&(lr.byteLength_-=1)}function validationPathCheckValid(lr){if(lr.byteLength_>MAX_PATH_LENGTH_BYTES)throw new Error(lr.errorPrefix_+"has a key path longer than "+MAX_PATH_LENGTH_BYTES+" bytes ("+lr.byteLength_+").");if(lr.parts_.length>MAX_PATH_DEPTH)throw new Error(lr.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+MAX_PATH_DEPTH+") or object contains a cycle "+validationPathToErrorString(lr))}function validationPathToErrorString(lr){return lr.parts_.length===0?"":"in property '"+lr.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VisibilityMonitor extends EventEmitter$1{constructor(){super(["visible"]);let or,ar;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(ar="visibilitychange",or="hidden"):typeof document.mozHidden<"u"?(ar="mozvisibilitychange",or="mozHidden"):typeof document.msHidden<"u"?(ar="msvisibilitychange",or="msHidden"):typeof document.webkitHidden<"u"&&(ar="webkitvisibilitychange",or="webkitHidden")),this.visible_=!0,ar&&document.addEventListener(ar,()=>{const cr=!document[or];cr!==this.visible_&&(this.visible_=cr,this.trigger("visible",cr))},!1)}static getInstance(){return new VisibilityMonitor}getInitialEvent(or){return assert(or==="visible","Unknown event type: "+or),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=60*5*1e3,RECONNECT_MAX_DELAY_FOR_ADMINS=30*1e3,RECONNECT_DELAY_MULTIPLIER=1.3,RECONNECT_DELAY_RESET_TIMEOUT=3e4,SERVER_KILL_INTERRUPT_REASON="server_kill",INVALID_TOKEN_THRESHOLD=3;class PersistentConnection extends ServerActions{constructor(or,ar,cr,ur,hr,fr,dr,pr){if(super(),this.repoInfo_=or,this.applicationId_=ar,this.onDataUpdate_=cr,this.onConnectStatus_=ur,this.onServerInfoUpdate_=hr,this.authTokenProvider_=fr,this.appCheckTokenProvider_=dr,this.authOverride_=pr,this.id=PersistentConnection.nextPersistentConnectionId_++,this.log_=logWrapper("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=RECONNECT_MIN_DELAY,this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,pr&&!isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");VisibilityMonitor.getInstance().on("visible",this.onVisible_,this),or.host.indexOf("fblocal")===-1&&OnlineMonitor.getInstance().on("online",this.onOnline_,this)}sendRequest(or,ar,cr){const ur=++this.requestNumber_,hr={r:ur,a:or,b:ar};this.log_(stringify(hr)),assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(hr),cr&&(this.requestCBHash_[ur]=cr)}get(or){this.initConnection_();const ar=new Deferred,ur={action:"g",request:{p:or._path.toString(),q:or._queryObject},onComplete:fr=>{const dr=fr.d;fr.s==="ok"?ar.resolve(dr):ar.reject(dr)}};this.outstandingGets_.push(ur),this.outstandingGetCount_++;const hr=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(hr),ar.promise}listen(or,ar,cr,ur){this.initConnection_();const hr=or._queryIdentifier,fr=or._path.toString();this.log_("Listen called for "+fr+" "+hr),this.listens.has(fr)||this.listens.set(fr,new Map),assert(or._queryParams.isDefault()||!or._queryParams.loadsAllData(),"listen() called for non-default but complete query"),assert(!this.listens.get(fr).has(hr),"listen() called twice for same path/queryId.");const dr={onComplete:ur,hashFn:ar,query:or,tag:cr};this.listens.get(fr).set(hr,dr),this.connected_&&this.sendListen_(dr)}sendGet_(or){const ar=this.outstandingGets_[or];this.sendRequest("g",ar.request,cr=>{delete this.outstandingGets_[or],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),ar.onComplete&&ar.onComplete(cr)})}sendListen_(or){const ar=or.query,cr=ar._path.toString(),ur=ar._queryIdentifier;this.log_("Listen on "+cr+" for "+ur);const hr={p:cr},fr="q";or.tag&&(hr.q=ar._queryObject,hr.t=or.tag),hr.h=or.hashFn(),this.sendRequest(fr,hr,dr=>{const pr=dr.d,mr=dr.s;PersistentConnection.warnOnListenWarnings_(pr,ar),(this.listens.get(cr)&&this.listens.get(cr).get(ur))===or&&(this.log_("listen response",dr),mr!=="ok"&&this.removeListen_(cr,ur),or.onComplete&&or.onComplete(mr,pr))})}static warnOnListenWarnings_(or,ar){if(or&&typeof or=="object"&&contains(or,"w")){const cr=safeGet(or,"w");if(Array.isArray(cr)&&~cr.indexOf("no_index")){const ur='".indexOn": "'+ar._queryParams.getIndex().toString()+'"',hr=ar._path.toString();warn$1(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${ur} at ${hr} to your security rules for better performance.`)}}}refreshAuthToken(or){this.authToken_=or,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(or)}reduceReconnectDelayIfAdminCredential_(or){(or&&or.length===40||isAdmin(or))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS)}refreshAppCheckToken(or){this.appCheckToken_=or,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const or=this.authToken_,ar=isValidFormat(or)?"auth":"gauth",cr={cred:or};this.authOverride_===null?cr.noauth=!0:typeof this.authOverride_=="object"&&(cr.authvar=this.authOverride_),this.sendRequest(ar,cr,ur=>{const hr=ur.s,fr=ur.d||"error";this.authToken_===or&&(hr==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(hr,fr))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},or=>{const ar=or.s,cr=or.d||"error";ar==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(ar,cr)})}unlisten(or,ar){const cr=or._path.toString(),ur=or._queryIdentifier;this.log_("Unlisten called for "+cr+" "+ur),assert(or._queryParams.isDefault()||!or._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(cr,ur)&&this.connected_&&this.sendUnlisten_(cr,ur,or._queryObject,ar)}sendUnlisten_(or,ar,cr,ur){this.log_("Unlisten on "+or+" for "+ar);const hr={p:or},fr="n";ur&&(hr.q=cr,hr.t=ur),this.sendRequest(fr,hr)}onDisconnectPut(or,ar,cr){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",or,ar,cr):this.onDisconnectRequestQueue_.push({pathString:or,action:"o",data:ar,onComplete:cr})}onDisconnectMerge(or,ar,cr){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",or,ar,cr):this.onDisconnectRequestQueue_.push({pathString:or,action:"om",data:ar,onComplete:cr})}onDisconnectCancel(or,ar){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",or,null,ar):this.onDisconnectRequestQueue_.push({pathString:or,action:"oc",data:null,onComplete:ar})}sendOnDisconnect_(or,ar,cr,ur){const hr={p:ar,d:cr};this.log_("onDisconnect "+or,hr),this.sendRequest(or,hr,fr=>{ur&&setTimeout(()=>{ur(fr.s,fr.d)},Math.floor(0))})}put(or,ar,cr,ur){this.putInternal("p",or,ar,cr,ur)}merge(or,ar,cr,ur){this.putInternal("m",or,ar,cr,ur)}putInternal(or,ar,cr,ur,hr){this.initConnection_();const fr={p:ar,d:cr};hr!==void 0&&(fr.h=hr),this.outstandingPuts_.push({action:or,request:fr,onComplete:ur}),this.outstandingPutCount_++;const dr=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(dr):this.log_("Buffering put: "+ar)}sendPut_(or){const ar=this.outstandingPuts_[or].action,cr=this.outstandingPuts_[or].request,ur=this.outstandingPuts_[or].onComplete;this.outstandingPuts_[or].queued=this.connected_,this.sendRequest(ar,cr,hr=>{this.log_(ar+" response",hr),delete this.outstandingPuts_[or],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),ur&&ur(hr.s,hr.d)})}reportStats(or){if(this.connected_){const ar={c:or};this.log_("reportStats",ar),this.sendRequest("s",ar,cr=>{if(cr.s!=="ok"){const hr=cr.d;this.log_("reportStats","Error sending stats: "+hr)}})}}onDataMessage_(or){if("r"in or){this.log_("from server: "+stringify(or));const ar=or.r,cr=this.requestCBHash_[ar];cr&&(delete this.requestCBHash_[ar],cr(or.b))}else{if("error"in or)throw"A server-side error has occurred: "+or.error;"a"in or&&this.onDataPush_(or.a,or.b)}}onDataPush_(or,ar){this.log_("handleServerMessage",or,ar),or==="d"?this.onDataUpdate_(ar.p,ar.d,!1,ar.t):or==="m"?this.onDataUpdate_(ar.p,ar.d,!0,ar.t):or==="c"?this.onListenRevoked_(ar.p,ar.q):or==="ac"?this.onAuthRevoked_(ar.s,ar.d):or==="apc"?this.onAppCheckRevoked_(ar.s,ar.d):or==="sd"?this.onSecurityDebugPacket_(ar):error("Unrecognized action received from server: "+stringify(or)+`
Are you using the latest client?`)}onReady_(or,ar){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(or),this.lastSessionId=ar,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(or){assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(or))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(or){or&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=or}onOnline_(or){or?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>RECONNECT_DELAY_RESET_TIMEOUT&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const or=new Date().getTime()-this.lastConnectionAttemptTime_;let ar=Math.max(0,this.reconnectDelay_-or);ar=Math.random()*ar,this.log_("Trying to reconnect in "+ar+"ms"),this.scheduleConnect_(ar),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const or=this.onDataMessage_.bind(this),ar=this.onReady_.bind(this),cr=this.onRealtimeDisconnect_.bind(this),ur=this.id+":"+PersistentConnection.nextConnectionId_++,hr=this.lastSessionId;let fr=!1,dr=null;const pr=function(){dr?dr.close():(fr=!0,cr())},mr=function(yr){assert(dr,"sendRequest call when we're not connected not allowed."),dr.sendRequest(yr)};this.realtime_={close:pr,sendRequest:mr};const gr=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[yr,br]=await Promise.all([this.authTokenProvider_.getToken(gr),this.appCheckTokenProvider_.getToken(gr)]);fr?log("getToken() completed but was canceled"):(log("getToken() completed. Creating connection."),this.authToken_=yr&&yr.accessToken,this.appCheckToken_=br&&br.token,dr=new Connection(ur,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,or,ar,cr,Or=>{warn$1(Or+" ("+this.repoInfo_.toString()+")"),this.interrupt(SERVER_KILL_INTERRUPT_REASON)},hr))}catch(yr){this.log_("Failed to get token: "+yr),fr||(this.repoInfo_.nodeAdmin&&warn$1(yr),pr())}}}interrupt(or){log("Interrupting connection for reason: "+or),this.interruptReasons_[or]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(or){log("Resuming connection for reason: "+or),delete this.interruptReasons_[or],isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(or){const ar=or-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:ar})}cancelSentTransactions_(){for(let or=0;or<this.outstandingPuts_.length;or++){const ar=this.outstandingPuts_[or];ar&&"h"in ar.request&&ar.queued&&(ar.onComplete&&ar.onComplete("disconnect"),delete this.outstandingPuts_[or],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(or,ar){let cr;ar?cr=ar.map(hr=>ObjectToUniqueKey(hr)).join("$"):cr="default";const ur=this.removeListen_(or,cr);ur&&ur.onComplete&&ur.onComplete("permission_denied")}removeListen_(or,ar){const cr=new Path(or).toString();let ur;if(this.listens.has(cr)){const hr=this.listens.get(cr);ur=hr.get(ar),hr.delete(ar),hr.size===0&&this.listens.delete(cr)}else ur=void 0;return ur}onAuthRevoked_(or,ar){log("Auth token revoked: "+or+"/"+ar),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(or==="invalid_token"||or==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=INVALID_TOKEN_THRESHOLD&&(this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(or,ar){log("App check token revoked: "+or+"/"+ar),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(or==="invalid_token"||or==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=INVALID_TOKEN_THRESHOLD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(or){this.securityDebugCallback_?this.securityDebugCallback_(or):"msg"in or&&console.log("FIREBASE: "+or.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const or of this.listens.values())for(const ar of or.values())this.sendListen_(ar);for(let or=0;or<this.outstandingPuts_.length;or++)this.outstandingPuts_[or]&&this.sendPut_(or);for(;this.onDisconnectRequestQueue_.length;){const or=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(or.action,or.pathString,or.data,or.onComplete)}for(let or=0;or<this.outstandingGets_.length;or++)this.outstandingGets_[or]&&this.sendGet_(or)}sendConnectStats_(){const or={};let ar="js";or["sdk."+ar+"."+SDK_VERSION.replace(/\./g,"-")]=1,isMobileCordova()?or["framework.cordova"]=1:isReactNative()&&(or["framework.reactnative"]=1),this.reportStats(or)}shouldReconnect_(){const or=OnlineMonitor.getInstance().currentlyOnline();return isEmpty(this.interruptReasons_)&&or}}PersistentConnection.nextPersistentConnectionId_=0;PersistentConnection.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NamedNode{constructor(or,ar){this.name=or,this.node=ar}static Wrap(or,ar){return new NamedNode(or,ar)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Index{getCompare(){return this.compare.bind(this)}indexedValueChanged(or,ar){const cr=new NamedNode(MIN_NAME,or),ur=new NamedNode(MIN_NAME,ar);return this.compare(cr,ur)!==0}minPost(){return NamedNode.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __EMPTY_NODE;class KeyIndex extends Index{static get __EMPTY_NODE(){return __EMPTY_NODE}static set __EMPTY_NODE(or){__EMPTY_NODE=or}compare(or,ar){return nameCompare(or.name,ar.name)}isDefinedOn(or){throw assertionError("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(or,ar){return!1}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,__EMPTY_NODE)}makePost(or,ar){return assert(typeof or=="string","KeyIndex indexValue must always be a string."),new NamedNode(or,__EMPTY_NODE)}toString(){return".key"}}const KEY_INDEX=new KeyIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMapIterator{constructor(or,ar,cr,ur,hr=null){this.isReverse_=ur,this.resultGenerator_=hr,this.nodeStack_=[];let fr=1;for(;!or.isEmpty();)if(or=or,fr=ar?cr(or.key,ar):1,ur&&(fr*=-1),fr<0)this.isReverse_?or=or.left:or=or.right;else if(fr===0){this.nodeStack_.push(or);break}else this.nodeStack_.push(or),this.isReverse_?or=or.right:or=or.left}getNext(){if(this.nodeStack_.length===0)return null;let or=this.nodeStack_.pop(),ar;if(this.resultGenerator_?ar=this.resultGenerator_(or.key,or.value):ar={key:or.key,value:or.value},this.isReverse_)for(or=or.left;!or.isEmpty();)this.nodeStack_.push(or),or=or.right;else for(or=or.right;!or.isEmpty();)this.nodeStack_.push(or),or=or.left;return ar}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const or=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(or.key,or.value):{key:or.key,value:or.value}}}class LLRBNode{constructor(or,ar,cr,ur,hr){this.key=or,this.value=ar,this.color=cr??LLRBNode.RED,this.left=ur??SortedMap.EMPTY_NODE,this.right=hr??SortedMap.EMPTY_NODE}copy(or,ar,cr,ur,hr){return new LLRBNode(or??this.key,ar??this.value,cr??this.color,ur??this.left,hr??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(or){return this.left.inorderTraversal(or)||!!or(this.key,this.value)||this.right.inorderTraversal(or)}reverseTraversal(or){return this.right.reverseTraversal(or)||or(this.key,this.value)||this.left.reverseTraversal(or)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(or,ar,cr){let ur=this;const hr=cr(or,ur.key);return hr<0?ur=ur.copy(null,null,null,ur.left.insert(or,ar,cr),null):hr===0?ur=ur.copy(null,ar,null,null,null):ur=ur.copy(null,null,null,null,ur.right.insert(or,ar,cr)),ur.fixUp_()}removeMin_(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;let or=this;return!or.left.isRed_()&&!or.left.left.isRed_()&&(or=or.moveRedLeft_()),or=or.copy(null,null,null,or.left.removeMin_(),null),or.fixUp_()}remove(or,ar){let cr,ur;if(cr=this,ar(or,cr.key)<0)!cr.left.isEmpty()&&!cr.left.isRed_()&&!cr.left.left.isRed_()&&(cr=cr.moveRedLeft_()),cr=cr.copy(null,null,null,cr.left.remove(or,ar),null);else{if(cr.left.isRed_()&&(cr=cr.rotateRight_()),!cr.right.isEmpty()&&!cr.right.isRed_()&&!cr.right.left.isRed_()&&(cr=cr.moveRedRight_()),ar(or,cr.key)===0){if(cr.right.isEmpty())return SortedMap.EMPTY_NODE;ur=cr.right.min_(),cr=cr.copy(ur.key,ur.value,null,null,cr.right.removeMin_())}cr=cr.copy(null,null,null,null,cr.right.remove(or,ar))}return cr.fixUp_()}isRed_(){return this.color}fixUp_(){let or=this;return or.right.isRed_()&&!or.left.isRed_()&&(or=or.rotateLeft_()),or.left.isRed_()&&or.left.left.isRed_()&&(or=or.rotateRight_()),or.left.isRed_()&&or.right.isRed_()&&(or=or.colorFlip_()),or}moveRedLeft_(){let or=this.colorFlip_();return or.right.left.isRed_()&&(or=or.copy(null,null,null,null,or.right.rotateRight_()),or=or.rotateLeft_(),or=or.colorFlip_()),or}moveRedRight_(){let or=this.colorFlip_();return or.left.left.isRed_()&&(or=or.rotateRight_(),or=or.colorFlip_()),or}rotateLeft_(){const or=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,or,null)}rotateRight_(){const or=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,or)}colorFlip_(){const or=this.left.copy(null,null,!this.left.color,null,null),ar=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,or,ar)}checkMaxDepth_(){const or=this.check_();return Math.pow(2,or)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const or=this.left.check_();if(or!==this.right.check_())throw new Error("Black depths differ");return or+(this.isRed_()?0:1)}}LLRBNode.RED=!0;LLRBNode.BLACK=!1;class LLRBEmptyNode{copy(or,ar,cr,ur,hr){return this}insert(or,ar,cr){return new LLRBNode(or,ar,null)}remove(or,ar){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(or){return!1}reverseTraversal(or){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class SortedMap{constructor(or,ar=SortedMap.EMPTY_NODE){this.comparator_=or,this.root_=ar}insert(or,ar){return new SortedMap(this.comparator_,this.root_.insert(or,ar,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}remove(or){return new SortedMap(this.comparator_,this.root_.remove(or,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}get(or){let ar,cr=this.root_;for(;!cr.isEmpty();){if(ar=this.comparator_(or,cr.key),ar===0)return cr.value;ar<0?cr=cr.left:ar>0&&(cr=cr.right)}return null}getPredecessorKey(or){let ar,cr=this.root_,ur=null;for(;!cr.isEmpty();)if(ar=this.comparator_(or,cr.key),ar===0){if(cr.left.isEmpty())return ur?ur.key:null;for(cr=cr.left;!cr.right.isEmpty();)cr=cr.right;return cr.key}else ar<0?cr=cr.left:ar>0&&(ur=cr,cr=cr.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(or){return this.root_.inorderTraversal(or)}reverseTraversal(or){return this.root_.reverseTraversal(or)}getIterator(or){return new SortedMapIterator(this.root_,null,this.comparator_,!1,or)}getIteratorFrom(or,ar){return new SortedMapIterator(this.root_,or,this.comparator_,!1,ar)}getReverseIteratorFrom(or,ar){return new SortedMapIterator(this.root_,or,this.comparator_,!0,ar)}getReverseIterator(or){return new SortedMapIterator(this.root_,null,this.comparator_,!0,or)}}SortedMap.EMPTY_NODE=new LLRBEmptyNode;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NAME_ONLY_COMPARATOR(lr,or){return nameCompare(lr.name,or.name)}function NAME_COMPARATOR(lr,or){return nameCompare(lr,or)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MAX_NODE$2;function setMaxNode$1(lr){MAX_NODE$2=lr}const priorityHashText=function(lr){return typeof lr=="number"?"number:"+doubleToIEEE754String(lr):"string:"+lr},validatePriorityNode=function(lr){if(lr.isLeafNode()){const or=lr.val();assert(typeof or=="string"||typeof or=="number"||typeof or=="object"&&contains(or,".sv"),"Priority must be a string or number.")}else assert(lr===MAX_NODE$2||lr.isEmpty(),"priority of unexpected type.");assert(lr===MAX_NODE$2||lr.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __childrenNodeConstructor;class LeafNode{constructor(or,ar=LeafNode.__childrenNodeConstructor.EMPTY_NODE){this.value_=or,this.priorityNode_=ar,this.lazyHash_=null,assert(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}static set __childrenNodeConstructor(or){__childrenNodeConstructor=or}static get __childrenNodeConstructor(){return __childrenNodeConstructor}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(or){return new LeafNode(this.value_,or)}getImmediateChild(or){return or===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}getChild(or){return pathIsEmpty(or)?this:pathGetFront(or)===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(or,ar){return null}updateImmediateChild(or,ar){return or===".priority"?this.updatePriority(ar):ar.isEmpty()&&or!==".priority"?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(or,ar).updatePriority(this.priorityNode_)}updateChild(or,ar){const cr=pathGetFront(or);return cr===null?ar:ar.isEmpty()&&cr!==".priority"?this:(assert(cr!==".priority"||pathGetLength(or)===1,".priority must be the last token in a path"),this.updateImmediateChild(cr,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(pathPopFront(or),ar)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(or,ar){return!1}val(or){return or&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let or="";this.priorityNode_.isEmpty()||(or+="priority:"+priorityHashText(this.priorityNode_.val())+":");const ar=typeof this.value_;or+=ar+":",ar==="number"?or+=doubleToIEEE754String(this.value_):or+=this.value_,this.lazyHash_=sha1(or)}return this.lazyHash_}getValue(){return this.value_}compareTo(or){return or===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:or instanceof LeafNode.__childrenNodeConstructor?-1:(assert(or.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(or))}compareToLeafNode_(or){const ar=typeof or.value_,cr=typeof this.value_,ur=LeafNode.VALUE_TYPE_ORDER.indexOf(ar),hr=LeafNode.VALUE_TYPE_ORDER.indexOf(cr);return assert(ur>=0,"Unknown leaf type: "+ar),assert(hr>=0,"Unknown leaf type: "+cr),ur===hr?cr==="object"?0:this.value_<or.value_?-1:this.value_===or.value_?0:1:hr-ur}withIndex(){return this}isIndexed(){return!0}equals(or){if(or===this)return!0;if(or.isLeafNode()){const ar=or;return this.value_===ar.value_&&this.priorityNode_.equals(ar.priorityNode_)}else return!1}}LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nodeFromJSON$1,MAX_NODE$1;function setNodeFromJSON(lr){nodeFromJSON$1=lr}function setMaxNode(lr){MAX_NODE$1=lr}class PriorityIndex extends Index{compare(or,ar){const cr=or.node.getPriority(),ur=ar.node.getPriority(),hr=cr.compareTo(ur);return hr===0?nameCompare(or.name,ar.name):hr}isDefinedOn(or){return!or.getPriority().isEmpty()}indexedValueChanged(or,ar){return!or.getPriority().equals(ar.getPriority())}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))}makePost(or,ar){const cr=nodeFromJSON$1(or);return new NamedNode(ar,new LeafNode("[PRIORITY-POST]",cr))}toString(){return".priority"}}const PRIORITY_INDEX=new PriorityIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LOG_2=Math.log(2);class Base12Num{constructor(or){const ar=hr=>parseInt(Math.log(hr)/LOG_2,10),cr=hr=>parseInt(Array(hr+1).join("1"),2);this.count=ar(or+1),this.current_=this.count-1;const ur=cr(this.count);this.bits_=or+1&ur}nextBitIsOne(){const or=!(this.bits_&1<<this.current_);return this.current_--,or}}const buildChildSet=function(lr,or,ar,cr){lr.sort(or);const ur=function(pr,mr){const gr=mr-pr;let yr,br;if(gr===0)return null;if(gr===1)return yr=lr[pr],br=ar?ar(yr):yr,new LLRBNode(br,yr.node,LLRBNode.BLACK,null,null);{const Or=parseInt(gr/2,10)+pr,_r=ur(pr,Or),vr=ur(Or+1,mr);return yr=lr[Or],br=ar?ar(yr):yr,new LLRBNode(br,yr.node,LLRBNode.BLACK,_r,vr)}},hr=function(pr){let mr=null,gr=null,yr=lr.length;const br=function(_r,vr){const xr=yr-_r,wr=yr;yr-=_r;const kr=ur(xr+1,wr),Cr=lr[xr],$r=ar?ar(Cr):Cr;Or(new LLRBNode($r,Cr.node,vr,null,kr))},Or=function(_r){mr?(mr.left=_r,mr=_r):(gr=_r,mr=_r)};for(let _r=0;_r<pr.count;++_r){const vr=pr.nextBitIsOne(),xr=Math.pow(2,pr.count-(_r+1));vr?br(xr,LLRBNode.BLACK):(br(xr,LLRBNode.BLACK),br(xr,LLRBNode.RED))}return gr},fr=new Base12Num(lr.length),dr=hr(fr);return new SortedMap(cr||or,dr)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _defaultIndexMap;const fallbackObject={};class IndexMap{constructor(or,ar){this.indexes_=or,this.indexSet_=ar}static get Default(){return assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PRIORITY_INDEX}),_defaultIndexMap}get(or){const ar=safeGet(this.indexes_,or);if(!ar)throw new Error("No index defined for "+or);return ar instanceof SortedMap?ar:null}hasIndex(or){return contains(this.indexSet_,or.toString())}addIndex(or,ar){assert(or!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const cr=[];let ur=!1;const hr=ar.getIterator(NamedNode.Wrap);let fr=hr.getNext();for(;fr;)ur=ur||or.isDefinedOn(fr.node),cr.push(fr),fr=hr.getNext();let dr;ur?dr=buildChildSet(cr,or.getCompare()):dr=fallbackObject;const pr=or.toString(),mr=Object.assign({},this.indexSet_);mr[pr]=or;const gr=Object.assign({},this.indexes_);return gr[pr]=dr,new IndexMap(gr,mr)}addToIndexes(or,ar){const cr=map(this.indexes_,(ur,hr)=>{const fr=safeGet(this.indexSet_,hr);if(assert(fr,"Missing index implementation for "+hr),ur===fallbackObject)if(fr.isDefinedOn(or.node)){const dr=[],pr=ar.getIterator(NamedNode.Wrap);let mr=pr.getNext();for(;mr;)mr.name!==or.name&&dr.push(mr),mr=pr.getNext();return dr.push(or),buildChildSet(dr,fr.getCompare())}else return fallbackObject;else{const dr=ar.get(or.name);let pr=ur;return dr&&(pr=pr.remove(new NamedNode(or.name,dr))),pr.insert(or,or.node)}});return new IndexMap(cr,this.indexSet_)}removeFromIndexes(or,ar){const cr=map(this.indexes_,ur=>{if(ur===fallbackObject)return ur;{const hr=ar.get(or.name);return hr?ur.remove(new NamedNode(or.name,hr)):ur}});return new IndexMap(cr,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EMPTY_NODE;class ChildrenNode{constructor(or,ar,cr){this.children_=or,this.priorityNode_=ar,this.indexMap_=cr,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||EMPTY_NODE}updatePriority(or){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,or,this.indexMap_)}getImmediateChild(or){if(or===".priority")return this.getPriority();{const ar=this.children_.get(or);return ar===null?EMPTY_NODE:ar}}getChild(or){const ar=pathGetFront(or);return ar===null?this:this.getImmediateChild(ar).getChild(pathPopFront(or))}hasChild(or){return this.children_.get(or)!==null}updateImmediateChild(or,ar){if(assert(ar,"We should always be passing snapshot nodes"),or===".priority")return this.updatePriority(ar);{const cr=new NamedNode(or,ar);let ur,hr;ar.isEmpty()?(ur=this.children_.remove(or),hr=this.indexMap_.removeFromIndexes(cr,this.children_)):(ur=this.children_.insert(or,ar),hr=this.indexMap_.addToIndexes(cr,this.children_));const fr=ur.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(ur,fr,hr)}}updateChild(or,ar){const cr=pathGetFront(or);if(cr===null)return ar;{assert(pathGetFront(or)!==".priority"||pathGetLength(or)===1,".priority must be the last token in a path");const ur=this.getImmediateChild(cr).updateChild(pathPopFront(or),ar);return this.updateImmediateChild(cr,ur)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(or){if(this.isEmpty())return null;const ar={};let cr=0,ur=0,hr=!0;if(this.forEachChild(PRIORITY_INDEX,(fr,dr)=>{ar[fr]=dr.val(or),cr++,hr&&ChildrenNode.INTEGER_REGEXP_.test(fr)?ur=Math.max(ur,Number(fr)):hr=!1}),!or&&hr&&ur<2*cr){const fr=[];for(const dr in ar)fr[dr]=ar[dr];return fr}else return or&&!this.getPriority().isEmpty()&&(ar[".priority"]=this.getPriority().val()),ar}hash(){if(this.lazyHash_===null){let or="";this.getPriority().isEmpty()||(or+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,(ar,cr)=>{const ur=cr.hash();ur!==""&&(or+=":"+ar+":"+ur)}),this.lazyHash_=or===""?"":sha1(or)}return this.lazyHash_}getPredecessorChildName(or,ar,cr){const ur=this.resolveIndex_(cr);if(ur){const hr=ur.getPredecessorKey(new NamedNode(or,ar));return hr?hr.name:null}else return this.children_.getPredecessorKey(or)}getFirstChildName(or){const ar=this.resolveIndex_(or);if(ar){const cr=ar.minKey();return cr&&cr.name}else return this.children_.minKey()}getFirstChild(or){const ar=this.getFirstChildName(or);return ar?new NamedNode(ar,this.children_.get(ar)):null}getLastChildName(or){const ar=this.resolveIndex_(or);if(ar){const cr=ar.maxKey();return cr&&cr.name}else return this.children_.maxKey()}getLastChild(or){const ar=this.getLastChildName(or);return ar?new NamedNode(ar,this.children_.get(ar)):null}forEachChild(or,ar){const cr=this.resolveIndex_(or);return cr?cr.inorderTraversal(ur=>ar(ur.name,ur.node)):this.children_.inorderTraversal(ar)}getIterator(or){return this.getIteratorFrom(or.minPost(),or)}getIteratorFrom(or,ar){const cr=this.resolveIndex_(ar);if(cr)return cr.getIteratorFrom(or,ur=>ur);{const ur=this.children_.getIteratorFrom(or.name,NamedNode.Wrap);let hr=ur.peek();for(;hr!=null&&ar.compare(hr,or)<0;)ur.getNext(),hr=ur.peek();return ur}}getReverseIterator(or){return this.getReverseIteratorFrom(or.maxPost(),or)}getReverseIteratorFrom(or,ar){const cr=this.resolveIndex_(ar);if(cr)return cr.getReverseIteratorFrom(or,ur=>ur);{const ur=this.children_.getReverseIteratorFrom(or.name,NamedNode.Wrap);let hr=ur.peek();for(;hr!=null&&ar.compare(hr,or)>0;)ur.getNext(),hr=ur.peek();return ur}}compareTo(or){return this.isEmpty()?or.isEmpty()?0:-1:or.isLeafNode()||or.isEmpty()?1:or===MAX_NODE?-1:0}withIndex(or){if(or===KEY_INDEX||this.indexMap_.hasIndex(or))return this;{const ar=this.indexMap_.addIndex(or,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,ar)}}isIndexed(or){return or===KEY_INDEX||this.indexMap_.hasIndex(or)}equals(or){if(or===this)return!0;if(or.isLeafNode())return!1;{const ar=or;if(this.getPriority().equals(ar.getPriority()))if(this.children_.count()===ar.children_.count()){const cr=this.getIterator(PRIORITY_INDEX),ur=ar.getIterator(PRIORITY_INDEX);let hr=cr.getNext(),fr=ur.getNext();for(;hr&&fr;){if(hr.name!==fr.name||!hr.node.equals(fr.node))return!1;hr=cr.getNext(),fr=ur.getNext()}return hr===null&&fr===null}else return!1;else return!1}}resolveIndex_(or){return or===KEY_INDEX?null:this.indexMap_.get(or.toString())}}ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class MaxNode extends ChildrenNode{constructor(){super(new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)}compareTo(or){return or===this?0:1}equals(or){return or===this}getPriority(){return this}getImmediateChild(or){return ChildrenNode.EMPTY_NODE}isEmpty(){return!1}}const MAX_NODE=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE)}});KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE;LeafNode.__childrenNodeConstructor=ChildrenNode;setMaxNode$1(MAX_NODE);setMaxNode(MAX_NODE);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const USE_HINZE=!0;function nodeFromJSON(lr,or=null){if(lr===null)return ChildrenNode.EMPTY_NODE;if(typeof lr=="object"&&".priority"in lr&&(or=lr[".priority"]),assert(or===null||typeof or=="string"||typeof or=="number"||typeof or=="object"&&".sv"in or,"Invalid priority type found: "+typeof or),typeof lr=="object"&&".value"in lr&&lr[".value"]!==null&&(lr=lr[".value"]),typeof lr!="object"||".sv"in lr){const ar=lr;return new LeafNode(ar,nodeFromJSON(or))}if(!(lr instanceof Array)&&USE_HINZE){const ar=[];let cr=!1;if(each(lr,(fr,dr)=>{if(fr.substring(0,1)!=="."){const pr=nodeFromJSON(dr);pr.isEmpty()||(cr=cr||!pr.getPriority().isEmpty(),ar.push(new NamedNode(fr,pr)))}}),ar.length===0)return ChildrenNode.EMPTY_NODE;const hr=buildChildSet(ar,NAME_ONLY_COMPARATOR,fr=>fr.name,NAME_COMPARATOR);if(cr){const fr=buildChildSet(ar,PRIORITY_INDEX.getCompare());return new ChildrenNode(hr,nodeFromJSON(or),new IndexMap({".priority":fr},{".priority":PRIORITY_INDEX}))}else return new ChildrenNode(hr,nodeFromJSON(or),IndexMap.Default)}else{let ar=ChildrenNode.EMPTY_NODE;return each(lr,(cr,ur)=>{if(contains(lr,cr)&&cr.substring(0,1)!=="."){const hr=nodeFromJSON(ur);(hr.isLeafNode()||!hr.isEmpty())&&(ar=ar.updateImmediateChild(cr,hr))}}),ar.updatePriority(nodeFromJSON(or))}}setNodeFromJSON(nodeFromJSON);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PathIndex extends Index{constructor(or){super(),this.indexPath_=or,assert(!pathIsEmpty(or)&&pathGetFront(or)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(or){return or.getChild(this.indexPath_)}isDefinedOn(or){return!or.getChild(this.indexPath_).isEmpty()}compare(or,ar){const cr=this.extractChild(or.node),ur=this.extractChild(ar.node),hr=cr.compareTo(ur);return hr===0?nameCompare(or.name,ar.name):hr}makePost(or,ar){const cr=nodeFromJSON(or),ur=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,cr);return new NamedNode(ar,ur)}maxPost(){const or=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE);return new NamedNode(MAX_NAME,or)}toString(){return pathSlice(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ValueIndex extends Index{compare(or,ar){const cr=or.node.compareTo(ar.node);return cr===0?nameCompare(or.name,ar.name):cr}isDefinedOn(or){return!0}indexedValueChanged(or,ar){return!or.equals(ar)}minPost(){return NamedNode.MIN}maxPost(){return NamedNode.MAX}makePost(or,ar){const cr=nodeFromJSON(or);return new NamedNode(ar,cr)}toString(){return".value"}}const VALUE_INDEX=new ValueIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function changeValue(lr){return{type:"value",snapshotNode:lr}}function changeChildAdded(lr,or){return{type:"child_added",snapshotNode:or,childName:lr}}function changeChildRemoved(lr,or){return{type:"child_removed",snapshotNode:or,childName:lr}}function changeChildChanged(lr,or,ar){return{type:"child_changed",snapshotNode:or,childName:lr,oldSnap:ar}}function changeChildMoved(lr,or){return{type:"child_moved",snapshotNode:or,childName:lr}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IndexedFilter{constructor(or){this.index_=or}updateChild(or,ar,cr,ur,hr,fr){assert(or.isIndexed(this.index_),"A node must be indexed if only a child is updated");const dr=or.getImmediateChild(ar);return dr.getChild(ur).equals(cr.getChild(ur))&&dr.isEmpty()===cr.isEmpty()||(fr!=null&&(cr.isEmpty()?or.hasChild(ar)?fr.trackChildChange(changeChildRemoved(ar,dr)):assert(or.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):dr.isEmpty()?fr.trackChildChange(changeChildAdded(ar,cr)):fr.trackChildChange(changeChildChanged(ar,cr,dr))),or.isLeafNode()&&cr.isEmpty())?or:or.updateImmediateChild(ar,cr).withIndex(this.index_)}updateFullNode(or,ar,cr){return cr!=null&&(or.isLeafNode()||or.forEachChild(PRIORITY_INDEX,(ur,hr)=>{ar.hasChild(ur)||cr.trackChildChange(changeChildRemoved(ur,hr))}),ar.isLeafNode()||ar.forEachChild(PRIORITY_INDEX,(ur,hr)=>{if(or.hasChild(ur)){const fr=or.getImmediateChild(ur);fr.equals(hr)||cr.trackChildChange(changeChildChanged(ur,hr,fr))}else cr.trackChildChange(changeChildAdded(ur,hr))})),ar.withIndex(this.index_)}updatePriority(or,ar){return or.isEmpty()?ChildrenNode.EMPTY_NODE:or.updatePriority(ar)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RangedFilter{constructor(or){this.indexedFilter_=new IndexedFilter(or.getIndex()),this.index_=or.getIndex(),this.startPost_=RangedFilter.getStartPost_(or),this.endPost_=RangedFilter.getEndPost_(or),this.startIsInclusive_=!or.startAfterSet_,this.endIsInclusive_=!or.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(or){const ar=this.startIsInclusive_?this.index_.compare(this.getStartPost(),or)<=0:this.index_.compare(this.getStartPost(),or)<0,cr=this.endIsInclusive_?this.index_.compare(or,this.getEndPost())<=0:this.index_.compare(or,this.getEndPost())<0;return ar&&cr}updateChild(or,ar,cr,ur,hr,fr){return this.matches(new NamedNode(ar,cr))||(cr=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(or,ar,cr,ur,hr,fr)}updateFullNode(or,ar,cr){ar.isLeafNode()&&(ar=ChildrenNode.EMPTY_NODE);let ur=ar.withIndex(this.index_);ur=ur.updatePriority(ChildrenNode.EMPTY_NODE);const hr=this;return ar.forEachChild(PRIORITY_INDEX,(fr,dr)=>{hr.matches(new NamedNode(fr,dr))||(ur=ur.updateImmediateChild(fr,ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(or,ur,cr)}updatePriority(or,ar){return or}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(or){if(or.hasStart()){const ar=or.getIndexStartName();return or.getIndex().makePost(or.getIndexStartValue(),ar)}else return or.getIndex().minPost()}static getEndPost_(or){if(or.hasEnd()){const ar=or.getIndexEndName();return or.getIndex().makePost(or.getIndexEndValue(),ar)}else return or.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LimitedFilter{constructor(or){this.withinDirectionalStart=ar=>this.reverse_?this.withinEndPost(ar):this.withinStartPost(ar),this.withinDirectionalEnd=ar=>this.reverse_?this.withinStartPost(ar):this.withinEndPost(ar),this.withinStartPost=ar=>{const cr=this.index_.compare(this.rangedFilter_.getStartPost(),ar);return this.startIsInclusive_?cr<=0:cr<0},this.withinEndPost=ar=>{const cr=this.index_.compare(ar,this.rangedFilter_.getEndPost());return this.endIsInclusive_?cr<=0:cr<0},this.rangedFilter_=new RangedFilter(or),this.index_=or.getIndex(),this.limit_=or.getLimit(),this.reverse_=!or.isViewFromLeft(),this.startIsInclusive_=!or.startAfterSet_,this.endIsInclusive_=!or.endBeforeSet_}updateChild(or,ar,cr,ur,hr,fr){return this.rangedFilter_.matches(new NamedNode(ar,cr))||(cr=ChildrenNode.EMPTY_NODE),or.getImmediateChild(ar).equals(cr)?or:or.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(or,ar,cr,ur,hr,fr):this.fullLimitUpdateChild_(or,ar,cr,hr,fr)}updateFullNode(or,ar,cr){let ur;if(ar.isLeafNode()||ar.isEmpty())ur=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<ar.numChildren()&&ar.isIndexed(this.index_)){ur=ChildrenNode.EMPTY_NODE.withIndex(this.index_);let hr;this.reverse_?hr=ar.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):hr=ar.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let fr=0;for(;hr.hasNext()&&fr<this.limit_;){const dr=hr.getNext();if(this.withinDirectionalStart(dr))if(this.withinDirectionalEnd(dr))ur=ur.updateImmediateChild(dr.name,dr.node),fr++;else break;else continue}}else{ur=ar.withIndex(this.index_),ur=ur.updatePriority(ChildrenNode.EMPTY_NODE);let hr;this.reverse_?hr=ur.getReverseIterator(this.index_):hr=ur.getIterator(this.index_);let fr=0;for(;hr.hasNext();){const dr=hr.getNext();fr<this.limit_&&this.withinDirectionalStart(dr)&&this.withinDirectionalEnd(dr)?fr++:ur=ur.updateImmediateChild(dr.name,ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(or,ur,cr)}updatePriority(or,ar){return or}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(or,ar,cr,ur,hr){let fr;if(this.reverse_){const yr=this.index_.getCompare();fr=(br,Or)=>yr(Or,br)}else fr=this.index_.getCompare();const dr=or;assert(dr.numChildren()===this.limit_,"");const pr=new NamedNode(ar,cr),mr=this.reverse_?dr.getFirstChild(this.index_):dr.getLastChild(this.index_),gr=this.rangedFilter_.matches(pr);if(dr.hasChild(ar)){const yr=dr.getImmediateChild(ar);let br=ur.getChildAfterChild(this.index_,mr,this.reverse_);for(;br!=null&&(br.name===ar||dr.hasChild(br.name));)br=ur.getChildAfterChild(this.index_,br,this.reverse_);const Or=br==null?1:fr(br,pr);if(gr&&!cr.isEmpty()&&Or>=0)return hr!=null&&hr.trackChildChange(changeChildChanged(ar,cr,yr)),dr.updateImmediateChild(ar,cr);{hr!=null&&hr.trackChildChange(changeChildRemoved(ar,yr));const vr=dr.updateImmediateChild(ar,ChildrenNode.EMPTY_NODE);return br!=null&&this.rangedFilter_.matches(br)?(hr!=null&&hr.trackChildChange(changeChildAdded(br.name,br.node)),vr.updateImmediateChild(br.name,br.node)):vr}}else return cr.isEmpty()?or:gr&&fr(mr,pr)>=0?(hr!=null&&(hr.trackChildChange(changeChildRemoved(mr.name,mr.node)),hr.trackChildChange(changeChildAdded(ar,cr))),dr.updateImmediateChild(ar,cr).updateImmediateChild(mr.name,ChildrenNode.EMPTY_NODE)):or}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryParams{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME}hasEnd(){return this.endSet_}getIndexEndValue(){return assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return assert(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX}copy(){const or=new QueryParams;return or.limitSet_=this.limitSet_,or.limit_=this.limit_,or.startSet_=this.startSet_,or.startAfterSet_=this.startAfterSet_,or.indexStartValue_=this.indexStartValue_,or.startNameSet_=this.startNameSet_,or.indexStartName_=this.indexStartName_,or.endSet_=this.endSet_,or.endBeforeSet_=this.endBeforeSet_,or.indexEndValue_=this.indexEndValue_,or.endNameSet_=this.endNameSet_,or.indexEndName_=this.indexEndName_,or.index_=this.index_,or.viewFrom_=this.viewFrom_,or}}function queryParamsGetNodeFilter(lr){return lr.loadsAllData()?new IndexedFilter(lr.getIndex()):lr.hasLimit()?new LimitedFilter(lr):new RangedFilter(lr)}function queryParamsLimitToFirst(lr,or){const ar=lr.copy();return ar.limitSet_=!0,ar.limit_=or,ar.viewFrom_="l",ar}function queryParamsLimitToLast(lr,or){const ar=lr.copy();return ar.limitSet_=!0,ar.limit_=or,ar.viewFrom_="r",ar}function queryParamsStartAt(lr,or,ar){const cr=lr.copy();return cr.startSet_=!0,or===void 0&&(or=null),cr.indexStartValue_=or,ar!=null?(cr.startNameSet_=!0,cr.indexStartName_=ar):(cr.startNameSet_=!1,cr.indexStartName_=""),cr}function queryParamsStartAfter(lr,or,ar){let cr;return lr.index_===KEY_INDEX||ar?cr=queryParamsStartAt(lr,or,ar):cr=queryParamsStartAt(lr,or,MAX_NAME),cr.startAfterSet_=!0,cr}function queryParamsEndAt(lr,or,ar){const cr=lr.copy();return cr.endSet_=!0,or===void 0&&(or=null),cr.indexEndValue_=or,ar!==void 0?(cr.endNameSet_=!0,cr.indexEndName_=ar):(cr.endNameSet_=!1,cr.indexEndName_=""),cr}function queryParamsEndBefore(lr,or,ar){let cr;return lr.index_===KEY_INDEX||ar?cr=queryParamsEndAt(lr,or,ar):cr=queryParamsEndAt(lr,or,MIN_NAME),cr.endBeforeSet_=!0,cr}function queryParamsOrderBy(lr,or){const ar=lr.copy();return ar.index_=or,ar}function queryParamsToRestQueryStringParameters(lr){const or={};if(lr.isDefault())return or;let ar;if(lr.index_===PRIORITY_INDEX?ar="$priority":lr.index_===VALUE_INDEX?ar="$value":lr.index_===KEY_INDEX?ar="$key":(assert(lr.index_ instanceof PathIndex,"Unrecognized index type!"),ar=lr.index_.toString()),or.orderBy=stringify(ar),lr.startSet_){const cr=lr.startAfterSet_?"startAfter":"startAt";or[cr]=stringify(lr.indexStartValue_),lr.startNameSet_&&(or[cr]+=","+stringify(lr.indexStartName_))}if(lr.endSet_){const cr=lr.endBeforeSet_?"endBefore":"endAt";or[cr]=stringify(lr.indexEndValue_),lr.endNameSet_&&(or[cr]+=","+stringify(lr.indexEndName_))}return lr.limitSet_&&(lr.isViewFromLeft()?or.limitToFirst=lr.limit_:or.limitToLast=lr.limit_),or}function queryParamsGetQueryObject(lr){const or={};if(lr.startSet_&&(or.sp=lr.indexStartValue_,lr.startNameSet_&&(or.sn=lr.indexStartName_),or.sin=!lr.startAfterSet_),lr.endSet_&&(or.ep=lr.indexEndValue_,lr.endNameSet_&&(or.en=lr.indexEndName_),or.ein=!lr.endBeforeSet_),lr.limitSet_){or.l=lr.limit_;let ar=lr.viewFrom_;ar===""&&(lr.isViewFromLeft()?ar="l":ar="r"),or.vf=ar}return lr.index_!==PRIORITY_INDEX&&(or.i=lr.index_.toString()),or}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ReadonlyRestClient extends ServerActions{constructor(or,ar,cr,ur){super(),this.repoInfo_=or,this.onDataUpdate_=ar,this.authTokenProvider_=cr,this.appCheckTokenProvider_=ur,this.log_=logWrapper("p:rest:"),this.listens_={}}reportStats(or){throw new Error("Method not implemented.")}static getListenId_(or,ar){return ar!==void 0?"tag$"+ar:(assert(or._queryParams.isDefault(),"should have a tag if it's not a default query."),or._path.toString())}listen(or,ar,cr,ur){const hr=or._path.toString();this.log_("Listen called for "+hr+" "+or._queryIdentifier);const fr=ReadonlyRestClient.getListenId_(or,cr),dr={};this.listens_[fr]=dr;const pr=queryParamsToRestQueryStringParameters(or._queryParams);this.restRequest_(hr+".json",pr,(mr,gr)=>{let yr=gr;if(mr===404&&(yr=null,mr=null),mr===null&&this.onDataUpdate_(hr,yr,!1,cr),safeGet(this.listens_,fr)===dr){let br;mr?mr===401?br="permission_denied":br="rest_error:"+mr:br="ok",ur(br,null)}})}unlisten(or,ar){const cr=ReadonlyRestClient.getListenId_(or,ar);delete this.listens_[cr]}get(or){const ar=queryParamsToRestQueryStringParameters(or._queryParams),cr=or._path.toString(),ur=new Deferred;return this.restRequest_(cr+".json",ar,(hr,fr)=>{let dr=fr;hr===404&&(dr=null,hr=null),hr===null?(this.onDataUpdate_(cr,dr,!1,null),ur.resolve(dr)):ur.reject(new Error(dr))}),ur.promise}refreshAuthToken(or){}restRequest_(or,ar={},cr){return ar.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([ur,hr])=>{ur&&ur.accessToken&&(ar.auth=ur.accessToken),hr&&hr.token&&(ar.ac=hr.token);const fr=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+or+"?ns="+this.repoInfo_.namespace+querystring(ar);this.log_("Sending REST request for "+fr);const dr=new XMLHttpRequest;dr.onreadystatechange=()=>{if(cr&&dr.readyState===4){this.log_("REST Response for "+fr+" received. status:",dr.status,"response:",dr.responseText);let pr=null;if(dr.status>=200&&dr.status<300){try{pr=jsonEval(dr.responseText)}catch{warn$1("Failed to parse JSON response for "+fr+": "+dr.responseText)}cr(null,pr)}else dr.status!==401&&dr.status!==404&&warn$1("Got unsuccessful REST response for "+fr+" Status: "+dr.status),cr(dr.status);cr=null}},dr.open("GET",fr,!0),dr.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotHolder{constructor(){this.rootNode_=ChildrenNode.EMPTY_NODE}getNode(or){return this.rootNode_.getChild(or)}updateSnapshot(or,ar){this.rootNode_=this.rootNode_.updateChild(or,ar)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newSparseSnapshotTree(){return{value:null,children:new Map}}function sparseSnapshotTreeRemember(lr,or,ar){if(pathIsEmpty(or))lr.value=ar,lr.children.clear();else if(lr.value!==null)lr.value=lr.value.updateChild(or,ar);else{const cr=pathGetFront(or);lr.children.has(cr)||lr.children.set(cr,newSparseSnapshotTree());const ur=lr.children.get(cr);or=pathPopFront(or),sparseSnapshotTreeRemember(ur,or,ar)}}function sparseSnapshotTreeForget(lr,or){if(pathIsEmpty(or))return lr.value=null,lr.children.clear(),!0;if(lr.value!==null){if(lr.value.isLeafNode())return!1;{const ar=lr.value;return lr.value=null,ar.forEachChild(PRIORITY_INDEX,(cr,ur)=>{sparseSnapshotTreeRemember(lr,new Path(cr),ur)}),sparseSnapshotTreeForget(lr,or)}}else if(lr.children.size>0){const ar=pathGetFront(or);return or=pathPopFront(or),lr.children.has(ar)&&sparseSnapshotTreeForget(lr.children.get(ar),or)&&lr.children.delete(ar),lr.children.size===0}else return!0}function sparseSnapshotTreeForEachTree(lr,or,ar){lr.value!==null?ar(or,lr.value):sparseSnapshotTreeForEachChild(lr,(cr,ur)=>{const hr=new Path(or.toString()+"/"+cr);sparseSnapshotTreeForEachTree(ur,hr,ar)})}function sparseSnapshotTreeForEachChild(lr,or){lr.children.forEach((ar,cr)=>{or(cr,ar)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsListener{constructor(or){this.collection_=or,this.last_=null}get(){const or=this.collection_.get(),ar=Object.assign({},or);return this.last_&&each(this.last_,(cr,ur)=>{ar[cr]=ar[cr]-ur}),this.last_=or,ar}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIRST_STATS_MIN_TIME=10*1e3,FIRST_STATS_MAX_TIME=30*1e3,REPORT_STATS_INTERVAL=5*60*1e3;class StatsReporter{constructor(or,ar){this.server_=ar,this.statsToReport_={},this.statsListener_=new StatsListener(or);const cr=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(cr))}reportStats_(){const or=this.statsListener_.get(),ar={};let cr=!1;each(or,(ur,hr)=>{hr>0&&contains(this.statsToReport_,ur)&&(ar[ur]=hr,cr=!0)}),cr&&this.server_.reportStats(ar),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(Math.random()*2*REPORT_STATS_INTERVAL))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OperationType;(function(lr){lr[lr.OVERWRITE=0]="OVERWRITE",lr[lr.MERGE=1]="MERGE",lr[lr.ACK_USER_WRITE=2]="ACK_USER_WRITE",lr[lr.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(OperationType||(OperationType={}));function newOperationSourceUser(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function newOperationSourceServer(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function newOperationSourceServerTaggedQuery(lr){return{fromUser:!1,fromServer:!0,queryId:lr,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AckUserWrite{constructor(or,ar,cr){this.path=or,this.affectedTree=ar,this.revert=cr,this.type=OperationType.ACK_USER_WRITE,this.source=newOperationSourceUser()}operationForChild(or){if(pathIsEmpty(this.path)){if(this.affectedTree.value!=null)return assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const ar=this.affectedTree.subtree(new Path(or));return new AckUserWrite(newEmptyPath(),ar,this.revert)}}else return assert(pathGetFront(this.path)===or,"operationForChild called for unrelated child."),new AckUserWrite(pathPopFront(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ListenComplete{constructor(or,ar){this.source=or,this.path=ar,this.type=OperationType.LISTEN_COMPLETE}operationForChild(or){return pathIsEmpty(this.path)?new ListenComplete(this.source,newEmptyPath()):new ListenComplete(this.source,pathPopFront(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overwrite{constructor(or,ar,cr){this.source=or,this.path=ar,this.snap=cr,this.type=OperationType.OVERWRITE}operationForChild(or){return pathIsEmpty(this.path)?new Overwrite(this.source,newEmptyPath(),this.snap.getImmediateChild(or)):new Overwrite(this.source,pathPopFront(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Merge{constructor(or,ar,cr){this.source=or,this.path=ar,this.children=cr,this.type=OperationType.MERGE}operationForChild(or){if(pathIsEmpty(this.path)){const ar=this.children.subtree(new Path(or));return ar.isEmpty()?null:ar.value?new Overwrite(this.source,newEmptyPath(),ar.value):new Merge(this.source,newEmptyPath(),ar)}else return assert(pathGetFront(this.path)===or,"Can't get a merge for a child not on the path of the operation"),new Merge(this.source,pathPopFront(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CacheNode{constructor(or,ar,cr){this.node_=or,this.fullyInitialized_=ar,this.filtered_=cr}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(or){if(pathIsEmpty(or))return this.isFullyInitialized()&&!this.filtered_;const ar=pathGetFront(or);return this.isCompleteForChild(ar)}isCompleteForChild(or){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(or)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventGenerator{constructor(or){this.query_=or,this.index_=this.query_._queryParams.getIndex()}}function eventGeneratorGenerateEventsForChanges(lr,or,ar,cr){const ur=[],hr=[];return or.forEach(fr=>{fr.type==="child_changed"&&lr.index_.indexedValueChanged(fr.oldSnap,fr.snapshotNode)&&hr.push(changeChildMoved(fr.childName,fr.snapshotNode))}),eventGeneratorGenerateEventsForType(lr,ur,"child_removed",or,cr,ar),eventGeneratorGenerateEventsForType(lr,ur,"child_added",or,cr,ar),eventGeneratorGenerateEventsForType(lr,ur,"child_moved",hr,cr,ar),eventGeneratorGenerateEventsForType(lr,ur,"child_changed",or,cr,ar),eventGeneratorGenerateEventsForType(lr,ur,"value",or,cr,ar),ur}function eventGeneratorGenerateEventsForType(lr,or,ar,cr,ur,hr){const fr=cr.filter(dr=>dr.type===ar);fr.sort((dr,pr)=>eventGeneratorCompareChanges(lr,dr,pr)),fr.forEach(dr=>{const pr=eventGeneratorMaterializeSingleChange(lr,dr,hr);ur.forEach(mr=>{mr.respondsTo(dr.type)&&or.push(mr.createEvent(pr,lr.query_))})})}function eventGeneratorMaterializeSingleChange(lr,or,ar){return or.type==="value"||or.type==="child_removed"||(or.prevName=ar.getPredecessorChildName(or.childName,or.snapshotNode,lr.index_)),or}function eventGeneratorCompareChanges(lr,or,ar){if(or.childName==null||ar.childName==null)throw assertionError("Should only compare child_ events.");const cr=new NamedNode(or.childName,or.snapshotNode),ur=new NamedNode(ar.childName,ar.snapshotNode);return lr.index_.compare(cr,ur)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewCache(lr,or){return{eventCache:lr,serverCache:or}}function viewCacheUpdateEventSnap(lr,or,ar,cr){return newViewCache(new CacheNode(or,ar,cr),lr.serverCache)}function viewCacheUpdateServerSnap(lr,or,ar,cr){return newViewCache(lr.eventCache,new CacheNode(or,ar,cr))}function viewCacheGetCompleteEventSnap(lr){return lr.eventCache.isFullyInitialized()?lr.eventCache.getNode():null}function viewCacheGetCompleteServerSnap(lr){return lr.serverCache.isFullyInitialized()?lr.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let emptyChildrenSingleton;const EmptyChildren=()=>(emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton);class ImmutableTree{constructor(or,ar=EmptyChildren()){this.value=or,this.children=ar}static fromObject(or){let ar=new ImmutableTree(null);return each(or,(cr,ur)=>{ar=ar.set(new Path(cr),ur)}),ar}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(or,ar){if(this.value!=null&&ar(this.value))return{path:newEmptyPath(),value:this.value};if(pathIsEmpty(or))return null;{const cr=pathGetFront(or),ur=this.children.get(cr);if(ur!==null){const hr=ur.findRootMostMatchingPathAndValue(pathPopFront(or),ar);return hr!=null?{path:pathChild(new Path(cr),hr.path),value:hr.value}:null}else return null}}findRootMostValueAndPath(or){return this.findRootMostMatchingPathAndValue(or,()=>!0)}subtree(or){if(pathIsEmpty(or))return this;{const ar=pathGetFront(or),cr=this.children.get(ar);return cr!==null?cr.subtree(pathPopFront(or)):new ImmutableTree(null)}}set(or,ar){if(pathIsEmpty(or))return new ImmutableTree(ar,this.children);{const cr=pathGetFront(or),hr=(this.children.get(cr)||new ImmutableTree(null)).set(pathPopFront(or),ar),fr=this.children.insert(cr,hr);return new ImmutableTree(this.value,fr)}}remove(or){if(pathIsEmpty(or))return this.children.isEmpty()?new ImmutableTree(null):new ImmutableTree(null,this.children);{const ar=pathGetFront(or),cr=this.children.get(ar);if(cr){const ur=cr.remove(pathPopFront(or));let hr;return ur.isEmpty()?hr=this.children.remove(ar):hr=this.children.insert(ar,ur),this.value===null&&hr.isEmpty()?new ImmutableTree(null):new ImmutableTree(this.value,hr)}else return this}}get(or){if(pathIsEmpty(or))return this.value;{const ar=pathGetFront(or),cr=this.children.get(ar);return cr?cr.get(pathPopFront(or)):null}}setTree(or,ar){if(pathIsEmpty(or))return ar;{const cr=pathGetFront(or),hr=(this.children.get(cr)||new ImmutableTree(null)).setTree(pathPopFront(or),ar);let fr;return hr.isEmpty()?fr=this.children.remove(cr):fr=this.children.insert(cr,hr),new ImmutableTree(this.value,fr)}}fold(or){return this.fold_(newEmptyPath(),or)}fold_(or,ar){const cr={};return this.children.inorderTraversal((ur,hr)=>{cr[ur]=hr.fold_(pathChild(or,ur),ar)}),ar(or,this.value,cr)}findOnPath(or,ar){return this.findOnPath_(or,newEmptyPath(),ar)}findOnPath_(or,ar,cr){const ur=this.value?cr(ar,this.value):!1;if(ur)return ur;if(pathIsEmpty(or))return null;{const hr=pathGetFront(or),fr=this.children.get(hr);return fr?fr.findOnPath_(pathPopFront(or),pathChild(ar,hr),cr):null}}foreachOnPath(or,ar){return this.foreachOnPath_(or,newEmptyPath(),ar)}foreachOnPath_(or,ar,cr){if(pathIsEmpty(or))return this;{this.value&&cr(ar,this.value);const ur=pathGetFront(or),hr=this.children.get(ur);return hr?hr.foreachOnPath_(pathPopFront(or),pathChild(ar,ur),cr):new ImmutableTree(null)}}foreach(or){this.foreach_(newEmptyPath(),or)}foreach_(or,ar){this.children.inorderTraversal((cr,ur)=>{ur.foreach_(pathChild(or,cr),ar)}),this.value&&ar(or,this.value)}foreachChild(or){this.children.inorderTraversal((ar,cr)=>{cr.value&&or(ar,cr.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CompoundWrite{constructor(or){this.writeTree_=or}static empty(){return new CompoundWrite(new ImmutableTree(null))}}function compoundWriteAddWrite(lr,or,ar){if(pathIsEmpty(or))return new CompoundWrite(new ImmutableTree(ar));{const cr=lr.writeTree_.findRootMostValueAndPath(or);if(cr!=null){const ur=cr.path;let hr=cr.value;const fr=newRelativePath(ur,or);return hr=hr.updateChild(fr,ar),new CompoundWrite(lr.writeTree_.set(ur,hr))}else{const ur=new ImmutableTree(ar),hr=lr.writeTree_.setTree(or,ur);return new CompoundWrite(hr)}}}function compoundWriteAddWrites(lr,or,ar){let cr=lr;return each(ar,(ur,hr)=>{cr=compoundWriteAddWrite(cr,pathChild(or,ur),hr)}),cr}function compoundWriteRemoveWrite(lr,or){if(pathIsEmpty(or))return CompoundWrite.empty();{const ar=lr.writeTree_.setTree(or,new ImmutableTree(null));return new CompoundWrite(ar)}}function compoundWriteHasCompleteWrite(lr,or){return compoundWriteGetCompleteNode(lr,or)!=null}function compoundWriteGetCompleteNode(lr,or){const ar=lr.writeTree_.findRootMostValueAndPath(or);return ar!=null?lr.writeTree_.get(ar.path).getChild(newRelativePath(ar.path,or)):null}function compoundWriteGetCompleteChildren(lr){const or=[],ar=lr.writeTree_.value;return ar!=null?ar.isLeafNode()||ar.forEachChild(PRIORITY_INDEX,(cr,ur)=>{or.push(new NamedNode(cr,ur))}):lr.writeTree_.children.inorderTraversal((cr,ur)=>{ur.value!=null&&or.push(new NamedNode(cr,ur.value))}),or}function compoundWriteChildCompoundWrite(lr,or){if(pathIsEmpty(or))return lr;{const ar=compoundWriteGetCompleteNode(lr,or);return ar!=null?new CompoundWrite(new ImmutableTree(ar)):new CompoundWrite(lr.writeTree_.subtree(or))}}function compoundWriteIsEmpty(lr){return lr.writeTree_.isEmpty()}function compoundWriteApply(lr,or){return applySubtreeWrite(newEmptyPath(),lr.writeTree_,or)}function applySubtreeWrite(lr,or,ar){if(or.value!=null)return ar.updateChild(lr,or.value);{let cr=null;return or.children.inorderTraversal((ur,hr)=>{ur===".priority"?(assert(hr.value!==null,"Priority writes must always be leaf nodes"),cr=hr.value):ar=applySubtreeWrite(pathChild(lr,ur),hr,ar)}),!ar.getChild(lr).isEmpty()&&cr!==null&&(ar=ar.updateChild(pathChild(lr,".priority"),cr)),ar}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function writeTreeChildWrites(lr,or){return newWriteTreeRef(or,lr)}function writeTreeAddOverwrite(lr,or,ar,cr,ur){assert(cr>lr.lastWriteId,"Stacking an older write on top of newer ones"),ur===void 0&&(ur=!0),lr.allWrites.push({path:or,snap:ar,writeId:cr,visible:ur}),ur&&(lr.visibleWrites=compoundWriteAddWrite(lr.visibleWrites,or,ar)),lr.lastWriteId=cr}function writeTreeAddMerge(lr,or,ar,cr){assert(cr>lr.lastWriteId,"Stacking an older merge on top of newer ones"),lr.allWrites.push({path:or,children:ar,writeId:cr,visible:!0}),lr.visibleWrites=compoundWriteAddWrites(lr.visibleWrites,or,ar),lr.lastWriteId=cr}function writeTreeGetWrite(lr,or){for(let ar=0;ar<lr.allWrites.length;ar++){const cr=lr.allWrites[ar];if(cr.writeId===or)return cr}return null}function writeTreeRemoveWrite(lr,or){const ar=lr.allWrites.findIndex(dr=>dr.writeId===or);assert(ar>=0,"removeWrite called with nonexistent writeId.");const cr=lr.allWrites[ar];lr.allWrites.splice(ar,1);let ur=cr.visible,hr=!1,fr=lr.allWrites.length-1;for(;ur&&fr>=0;){const dr=lr.allWrites[fr];dr.visible&&(fr>=ar&&writeTreeRecordContainsPath_(dr,cr.path)?ur=!1:pathContains(cr.path,dr.path)&&(hr=!0)),fr--}if(ur){if(hr)return writeTreeResetTree_(lr),!0;if(cr.snap)lr.visibleWrites=compoundWriteRemoveWrite(lr.visibleWrites,cr.path);else{const dr=cr.children;each(dr,pr=>{lr.visibleWrites=compoundWriteRemoveWrite(lr.visibleWrites,pathChild(cr.path,pr))})}return!0}else return!1}function writeTreeRecordContainsPath_(lr,or){if(lr.snap)return pathContains(lr.path,or);for(const ar in lr.children)if(lr.children.hasOwnProperty(ar)&&pathContains(pathChild(lr.path,ar),or))return!0;return!1}function writeTreeResetTree_(lr){lr.visibleWrites=writeTreeLayerTree_(lr.allWrites,writeTreeDefaultFilter_,newEmptyPath()),lr.allWrites.length>0?lr.lastWriteId=lr.allWrites[lr.allWrites.length-1].writeId:lr.lastWriteId=-1}function writeTreeDefaultFilter_(lr){return lr.visible}function writeTreeLayerTree_(lr,or,ar){let cr=CompoundWrite.empty();for(let ur=0;ur<lr.length;++ur){const hr=lr[ur];if(or(hr)){const fr=hr.path;let dr;if(hr.snap)pathContains(ar,fr)?(dr=newRelativePath(ar,fr),cr=compoundWriteAddWrite(cr,dr,hr.snap)):pathContains(fr,ar)&&(dr=newRelativePath(fr,ar),cr=compoundWriteAddWrite(cr,newEmptyPath(),hr.snap.getChild(dr)));else if(hr.children){if(pathContains(ar,fr))dr=newRelativePath(ar,fr),cr=compoundWriteAddWrites(cr,dr,hr.children);else if(pathContains(fr,ar))if(dr=newRelativePath(fr,ar),pathIsEmpty(dr))cr=compoundWriteAddWrites(cr,newEmptyPath(),hr.children);else{const pr=safeGet(hr.children,pathGetFront(dr));if(pr){const mr=pr.getChild(pathPopFront(dr));cr=compoundWriteAddWrite(cr,newEmptyPath(),mr)}}}else throw assertionError("WriteRecord should have .snap or .children")}}return cr}function writeTreeCalcCompleteEventCache(lr,or,ar,cr,ur){if(!cr&&!ur){const hr=compoundWriteGetCompleteNode(lr.visibleWrites,or);if(hr!=null)return hr;{const fr=compoundWriteChildCompoundWrite(lr.visibleWrites,or);if(compoundWriteIsEmpty(fr))return ar;if(ar==null&&!compoundWriteHasCompleteWrite(fr,newEmptyPath()))return null;{const dr=ar||ChildrenNode.EMPTY_NODE;return compoundWriteApply(fr,dr)}}}else{const hr=compoundWriteChildCompoundWrite(lr.visibleWrites,or);if(!ur&&compoundWriteIsEmpty(hr))return ar;if(!ur&&ar==null&&!compoundWriteHasCompleteWrite(hr,newEmptyPath()))return null;{const fr=function(mr){return(mr.visible||ur)&&(!cr||!~cr.indexOf(mr.writeId))&&(pathContains(mr.path,or)||pathContains(or,mr.path))},dr=writeTreeLayerTree_(lr.allWrites,fr,or),pr=ar||ChildrenNode.EMPTY_NODE;return compoundWriteApply(dr,pr)}}}function writeTreeCalcCompleteEventChildren(lr,or,ar){let cr=ChildrenNode.EMPTY_NODE;const ur=compoundWriteGetCompleteNode(lr.visibleWrites,or);if(ur)return ur.isLeafNode()||ur.forEachChild(PRIORITY_INDEX,(hr,fr)=>{cr=cr.updateImmediateChild(hr,fr)}),cr;if(ar){const hr=compoundWriteChildCompoundWrite(lr.visibleWrites,or);return ar.forEachChild(PRIORITY_INDEX,(fr,dr)=>{const pr=compoundWriteApply(compoundWriteChildCompoundWrite(hr,new Path(fr)),dr);cr=cr.updateImmediateChild(fr,pr)}),compoundWriteGetCompleteChildren(hr).forEach(fr=>{cr=cr.updateImmediateChild(fr.name,fr.node)}),cr}else{const hr=compoundWriteChildCompoundWrite(lr.visibleWrites,or);return compoundWriteGetCompleteChildren(hr).forEach(fr=>{cr=cr.updateImmediateChild(fr.name,fr.node)}),cr}}function writeTreeCalcEventCacheAfterServerOverwrite(lr,or,ar,cr,ur){assert(cr||ur,"Either existingEventSnap or existingServerSnap must exist");const hr=pathChild(or,ar);if(compoundWriteHasCompleteWrite(lr.visibleWrites,hr))return null;{const fr=compoundWriteChildCompoundWrite(lr.visibleWrites,hr);return compoundWriteIsEmpty(fr)?ur.getChild(ar):compoundWriteApply(fr,ur.getChild(ar))}}function writeTreeCalcCompleteChild(lr,or,ar,cr){const ur=pathChild(or,ar),hr=compoundWriteGetCompleteNode(lr.visibleWrites,ur);if(hr!=null)return hr;if(cr.isCompleteForChild(ar)){const fr=compoundWriteChildCompoundWrite(lr.visibleWrites,ur);return compoundWriteApply(fr,cr.getNode().getImmediateChild(ar))}else return null}function writeTreeShadowingWrite(lr,or){return compoundWriteGetCompleteNode(lr.visibleWrites,or)}function writeTreeCalcIndexedSlice(lr,or,ar,cr,ur,hr,fr){let dr;const pr=compoundWriteChildCompoundWrite(lr.visibleWrites,or),mr=compoundWriteGetCompleteNode(pr,newEmptyPath());if(mr!=null)dr=mr;else if(ar!=null)dr=compoundWriteApply(pr,ar);else return[];if(dr=dr.withIndex(fr),!dr.isEmpty()&&!dr.isLeafNode()){const gr=[],yr=fr.getCompare(),br=hr?dr.getReverseIteratorFrom(cr,fr):dr.getIteratorFrom(cr,fr);let Or=br.getNext();for(;Or&&gr.length<ur;)yr(Or,cr)!==0&&gr.push(Or),Or=br.getNext();return gr}else return[]}function newWriteTree(){return{visibleWrites:CompoundWrite.empty(),allWrites:[],lastWriteId:-1}}function writeTreeRefCalcCompleteEventCache(lr,or,ar,cr){return writeTreeCalcCompleteEventCache(lr.writeTree,lr.treePath,or,ar,cr)}function writeTreeRefCalcCompleteEventChildren(lr,or){return writeTreeCalcCompleteEventChildren(lr.writeTree,lr.treePath,or)}function writeTreeRefCalcEventCacheAfterServerOverwrite(lr,or,ar,cr){return writeTreeCalcEventCacheAfterServerOverwrite(lr.writeTree,lr.treePath,or,ar,cr)}function writeTreeRefShadowingWrite(lr,or){return writeTreeShadowingWrite(lr.writeTree,pathChild(lr.treePath,or))}function writeTreeRefCalcIndexedSlice(lr,or,ar,cr,ur,hr){return writeTreeCalcIndexedSlice(lr.writeTree,lr.treePath,or,ar,cr,ur,hr)}function writeTreeRefCalcCompleteChild(lr,or,ar){return writeTreeCalcCompleteChild(lr.writeTree,lr.treePath,or,ar)}function writeTreeRefChild(lr,or){return newWriteTreeRef(pathChild(lr.treePath,or),lr.writeTree)}function newWriteTreeRef(lr,or){return{treePath:lr,writeTree:or}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ChildChangeAccumulator{constructor(){this.changeMap=new Map}trackChildChange(or){const ar=or.type,cr=or.childName;assert(ar==="child_added"||ar==="child_changed"||ar==="child_removed","Only child changes supported for tracking"),assert(cr!==".priority","Only non-priority child changes can be tracked.");const ur=this.changeMap.get(cr);if(ur){const hr=ur.type;if(ar==="child_added"&&hr==="child_removed")this.changeMap.set(cr,changeChildChanged(cr,or.snapshotNode,ur.snapshotNode));else if(ar==="child_removed"&&hr==="child_added")this.changeMap.delete(cr);else if(ar==="child_removed"&&hr==="child_changed")this.changeMap.set(cr,changeChildRemoved(cr,ur.oldSnap));else if(ar==="child_changed"&&hr==="child_added")this.changeMap.set(cr,changeChildAdded(cr,or.snapshotNode));else if(ar==="child_changed"&&hr==="child_changed")this.changeMap.set(cr,changeChildChanged(cr,or.snapshotNode,ur.oldSnap));else throw assertionError("Illegal combination of changes: "+or+" occurred after "+ur)}else this.changeMap.set(cr,or)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NoCompleteChildSource_{getCompleteChild(or){return null}getChildAfterChild(or,ar,cr){return null}}const NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_;class WriteTreeCompleteChildSource{constructor(or,ar,cr=null){this.writes_=or,this.viewCache_=ar,this.optCompleteServerCache_=cr}getCompleteChild(or){const ar=this.viewCache_.eventCache;if(ar.isCompleteForChild(or))return ar.getNode().getImmediateChild(or);{const cr=this.optCompleteServerCache_!=null?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return writeTreeRefCalcCompleteChild(this.writes_,or,cr)}}getChildAfterChild(or,ar,cr){const ur=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:viewCacheGetCompleteServerSnap(this.viewCache_),hr=writeTreeRefCalcIndexedSlice(this.writes_,ur,ar,1,cr,or);return hr.length===0?null:hr[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewProcessor(lr){return{filter:lr}}function viewProcessorAssertIndexed(lr,or){assert(or.eventCache.getNode().isIndexed(lr.filter.getIndex()),"Event snap not indexed"),assert(or.serverCache.getNode().isIndexed(lr.filter.getIndex()),"Server snap not indexed")}function viewProcessorApplyOperation(lr,or,ar,cr,ur){const hr=new ChildChangeAccumulator;let fr,dr;if(ar.type===OperationType.OVERWRITE){const mr=ar;mr.source.fromUser?fr=viewProcessorApplyUserOverwrite(lr,or,mr.path,mr.snap,cr,ur,hr):(assert(mr.source.fromServer,"Unknown source."),dr=mr.source.tagged||or.serverCache.isFiltered()&&!pathIsEmpty(mr.path),fr=viewProcessorApplyServerOverwrite(lr,or,mr.path,mr.snap,cr,ur,dr,hr))}else if(ar.type===OperationType.MERGE){const mr=ar;mr.source.fromUser?fr=viewProcessorApplyUserMerge(lr,or,mr.path,mr.children,cr,ur,hr):(assert(mr.source.fromServer,"Unknown source."),dr=mr.source.tagged||or.serverCache.isFiltered(),fr=viewProcessorApplyServerMerge(lr,or,mr.path,mr.children,cr,ur,dr,hr))}else if(ar.type===OperationType.ACK_USER_WRITE){const mr=ar;mr.revert?fr=viewProcessorRevertUserWrite(lr,or,mr.path,cr,ur,hr):fr=viewProcessorAckUserWrite(lr,or,mr.path,mr.affectedTree,cr,ur,hr)}else if(ar.type===OperationType.LISTEN_COMPLETE)fr=viewProcessorListenComplete(lr,or,ar.path,cr,hr);else throw assertionError("Unknown operation type: "+ar.type);const pr=hr.getChanges();return viewProcessorMaybeAddValueEvent(or,fr,pr),{viewCache:fr,changes:pr}}function viewProcessorMaybeAddValueEvent(lr,or,ar){const cr=or.eventCache;if(cr.isFullyInitialized()){const ur=cr.getNode().isLeafNode()||cr.getNode().isEmpty(),hr=viewCacheGetCompleteEventSnap(lr);(ar.length>0||!lr.eventCache.isFullyInitialized()||ur&&!cr.getNode().equals(hr)||!cr.getNode().getPriority().equals(hr.getPriority()))&&ar.push(changeValue(viewCacheGetCompleteEventSnap(or)))}}function viewProcessorGenerateEventCacheAfterServerEvent(lr,or,ar,cr,ur,hr){const fr=or.eventCache;if(writeTreeRefShadowingWrite(cr,ar)!=null)return or;{let dr,pr;if(pathIsEmpty(ar))if(assert(or.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),or.serverCache.isFiltered()){const mr=viewCacheGetCompleteServerSnap(or),gr=mr instanceof ChildrenNode?mr:ChildrenNode.EMPTY_NODE,yr=writeTreeRefCalcCompleteEventChildren(cr,gr);dr=lr.filter.updateFullNode(or.eventCache.getNode(),yr,hr)}else{const mr=writeTreeRefCalcCompleteEventCache(cr,viewCacheGetCompleteServerSnap(or));dr=lr.filter.updateFullNode(or.eventCache.getNode(),mr,hr)}else{const mr=pathGetFront(ar);if(mr===".priority"){assert(pathGetLength(ar)===1,"Can't have a priority with additional path components");const gr=fr.getNode();pr=or.serverCache.getNode();const yr=writeTreeRefCalcEventCacheAfterServerOverwrite(cr,ar,gr,pr);yr!=null?dr=lr.filter.updatePriority(gr,yr):dr=fr.getNode()}else{const gr=pathPopFront(ar);let yr;if(fr.isCompleteForChild(mr)){pr=or.serverCache.getNode();const br=writeTreeRefCalcEventCacheAfterServerOverwrite(cr,ar,fr.getNode(),pr);br!=null?yr=fr.getNode().getImmediateChild(mr).updateChild(gr,br):yr=fr.getNode().getImmediateChild(mr)}else yr=writeTreeRefCalcCompleteChild(cr,mr,or.serverCache);yr!=null?dr=lr.filter.updateChild(fr.getNode(),mr,yr,gr,ur,hr):dr=fr.getNode()}}return viewCacheUpdateEventSnap(or,dr,fr.isFullyInitialized()||pathIsEmpty(ar),lr.filter.filtersNodes())}}function viewProcessorApplyServerOverwrite(lr,or,ar,cr,ur,hr,fr,dr){const pr=or.serverCache;let mr;const gr=fr?lr.filter:lr.filter.getIndexedFilter();if(pathIsEmpty(ar))mr=gr.updateFullNode(pr.getNode(),cr,null);else if(gr.filtersNodes()&&!pr.isFiltered()){const Or=pr.getNode().updateChild(ar,cr);mr=gr.updateFullNode(pr.getNode(),Or,null)}else{const Or=pathGetFront(ar);if(!pr.isCompleteForPath(ar)&&pathGetLength(ar)>1)return or;const _r=pathPopFront(ar),xr=pr.getNode().getImmediateChild(Or).updateChild(_r,cr);Or===".priority"?mr=gr.updatePriority(pr.getNode(),xr):mr=gr.updateChild(pr.getNode(),Or,xr,_r,NO_COMPLETE_CHILD_SOURCE,null)}const yr=viewCacheUpdateServerSnap(or,mr,pr.isFullyInitialized()||pathIsEmpty(ar),gr.filtersNodes()),br=new WriteTreeCompleteChildSource(ur,yr,hr);return viewProcessorGenerateEventCacheAfterServerEvent(lr,yr,ar,ur,br,dr)}function viewProcessorApplyUserOverwrite(lr,or,ar,cr,ur,hr,fr){const dr=or.eventCache;let pr,mr;const gr=new WriteTreeCompleteChildSource(ur,or,hr);if(pathIsEmpty(ar))mr=lr.filter.updateFullNode(or.eventCache.getNode(),cr,fr),pr=viewCacheUpdateEventSnap(or,mr,!0,lr.filter.filtersNodes());else{const yr=pathGetFront(ar);if(yr===".priority")mr=lr.filter.updatePriority(or.eventCache.getNode(),cr),pr=viewCacheUpdateEventSnap(or,mr,dr.isFullyInitialized(),dr.isFiltered());else{const br=pathPopFront(ar),Or=dr.getNode().getImmediateChild(yr);let _r;if(pathIsEmpty(br))_r=cr;else{const vr=gr.getCompleteChild(yr);vr!=null?pathGetBack(br)===".priority"&&vr.getChild(pathParent(br)).isEmpty()?_r=vr:_r=vr.updateChild(br,cr):_r=ChildrenNode.EMPTY_NODE}if(Or.equals(_r))pr=or;else{const vr=lr.filter.updateChild(dr.getNode(),yr,_r,br,gr,fr);pr=viewCacheUpdateEventSnap(or,vr,dr.isFullyInitialized(),lr.filter.filtersNodes())}}}return pr}function viewProcessorCacheHasChild(lr,or){return lr.eventCache.isCompleteForChild(or)}function viewProcessorApplyUserMerge(lr,or,ar,cr,ur,hr,fr){let dr=or;return cr.foreach((pr,mr)=>{const gr=pathChild(ar,pr);viewProcessorCacheHasChild(or,pathGetFront(gr))&&(dr=viewProcessorApplyUserOverwrite(lr,dr,gr,mr,ur,hr,fr))}),cr.foreach((pr,mr)=>{const gr=pathChild(ar,pr);viewProcessorCacheHasChild(or,pathGetFront(gr))||(dr=viewProcessorApplyUserOverwrite(lr,dr,gr,mr,ur,hr,fr))}),dr}function viewProcessorApplyMerge(lr,or,ar){return ar.foreach((cr,ur)=>{or=or.updateChild(cr,ur)}),or}function viewProcessorApplyServerMerge(lr,or,ar,cr,ur,hr,fr,dr){if(or.serverCache.getNode().isEmpty()&&!or.serverCache.isFullyInitialized())return or;let pr=or,mr;pathIsEmpty(ar)?mr=cr:mr=new ImmutableTree(null).setTree(ar,cr);const gr=or.serverCache.getNode();return mr.children.inorderTraversal((yr,br)=>{if(gr.hasChild(yr)){const Or=or.serverCache.getNode().getImmediateChild(yr),_r=viewProcessorApplyMerge(lr,Or,br);pr=viewProcessorApplyServerOverwrite(lr,pr,new Path(yr),_r,ur,hr,fr,dr)}}),mr.children.inorderTraversal((yr,br)=>{const Or=!or.serverCache.isCompleteForChild(yr)&&br.value===null;if(!gr.hasChild(yr)&&!Or){const _r=or.serverCache.getNode().getImmediateChild(yr),vr=viewProcessorApplyMerge(lr,_r,br);pr=viewProcessorApplyServerOverwrite(lr,pr,new Path(yr),vr,ur,hr,fr,dr)}}),pr}function viewProcessorAckUserWrite(lr,or,ar,cr,ur,hr,fr){if(writeTreeRefShadowingWrite(ur,ar)!=null)return or;const dr=or.serverCache.isFiltered(),pr=or.serverCache;if(cr.value!=null){if(pathIsEmpty(ar)&&pr.isFullyInitialized()||pr.isCompleteForPath(ar))return viewProcessorApplyServerOverwrite(lr,or,ar,pr.getNode().getChild(ar),ur,hr,dr,fr);if(pathIsEmpty(ar)){let mr=new ImmutableTree(null);return pr.getNode().forEachChild(KEY_INDEX,(gr,yr)=>{mr=mr.set(new Path(gr),yr)}),viewProcessorApplyServerMerge(lr,or,ar,mr,ur,hr,dr,fr)}else return or}else{let mr=new ImmutableTree(null);return cr.foreach((gr,yr)=>{const br=pathChild(ar,gr);pr.isCompleteForPath(br)&&(mr=mr.set(gr,pr.getNode().getChild(br)))}),viewProcessorApplyServerMerge(lr,or,ar,mr,ur,hr,dr,fr)}}function viewProcessorListenComplete(lr,or,ar,cr,ur){const hr=or.serverCache,fr=viewCacheUpdateServerSnap(or,hr.getNode(),hr.isFullyInitialized()||pathIsEmpty(ar),hr.isFiltered());return viewProcessorGenerateEventCacheAfterServerEvent(lr,fr,ar,cr,NO_COMPLETE_CHILD_SOURCE,ur)}function viewProcessorRevertUserWrite(lr,or,ar,cr,ur,hr){let fr;if(writeTreeRefShadowingWrite(cr,ar)!=null)return or;{const dr=new WriteTreeCompleteChildSource(cr,or,ur),pr=or.eventCache.getNode();let mr;if(pathIsEmpty(ar)||pathGetFront(ar)===".priority"){let gr;if(or.serverCache.isFullyInitialized())gr=writeTreeRefCalcCompleteEventCache(cr,viewCacheGetCompleteServerSnap(or));else{const yr=or.serverCache.getNode();assert(yr instanceof ChildrenNode,"serverChildren would be complete if leaf node"),gr=writeTreeRefCalcCompleteEventChildren(cr,yr)}gr=gr,mr=lr.filter.updateFullNode(pr,gr,hr)}else{const gr=pathGetFront(ar);let yr=writeTreeRefCalcCompleteChild(cr,gr,or.serverCache);yr==null&&or.serverCache.isCompleteForChild(gr)&&(yr=pr.getImmediateChild(gr)),yr!=null?mr=lr.filter.updateChild(pr,gr,yr,pathPopFront(ar),dr,hr):or.eventCache.getNode().hasChild(gr)?mr=lr.filter.updateChild(pr,gr,ChildrenNode.EMPTY_NODE,pathPopFront(ar),dr,hr):mr=pr,mr.isEmpty()&&or.serverCache.isFullyInitialized()&&(fr=writeTreeRefCalcCompleteEventCache(cr,viewCacheGetCompleteServerSnap(or)),fr.isLeafNode()&&(mr=lr.filter.updateFullNode(mr,fr,hr)))}return fr=or.serverCache.isFullyInitialized()||writeTreeRefShadowingWrite(cr,newEmptyPath())!=null,viewCacheUpdateEventSnap(or,mr,fr,lr.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class View{constructor(or,ar){this.query_=or,this.eventRegistrations_=[];const cr=this.query_._queryParams,ur=new IndexedFilter(cr.getIndex()),hr=queryParamsGetNodeFilter(cr);this.processor_=newViewProcessor(hr);const fr=ar.serverCache,dr=ar.eventCache,pr=ur.updateFullNode(ChildrenNode.EMPTY_NODE,fr.getNode(),null),mr=hr.updateFullNode(ChildrenNode.EMPTY_NODE,dr.getNode(),null),gr=new CacheNode(pr,fr.isFullyInitialized(),ur.filtersNodes()),yr=new CacheNode(mr,dr.isFullyInitialized(),hr.filtersNodes());this.viewCache_=newViewCache(yr,gr),this.eventGenerator_=new EventGenerator(this.query_)}get query(){return this.query_}}function viewGetServerCache(lr){return lr.viewCache_.serverCache.getNode()}function viewGetCompleteNode(lr){return viewCacheGetCompleteEventSnap(lr.viewCache_)}function viewGetCompleteServerCache(lr,or){const ar=viewCacheGetCompleteServerSnap(lr.viewCache_);return ar&&(lr.query._queryParams.loadsAllData()||!pathIsEmpty(or)&&!ar.getImmediateChild(pathGetFront(or)).isEmpty())?ar.getChild(or):null}function viewIsEmpty(lr){return lr.eventRegistrations_.length===0}function viewAddEventRegistration(lr,or){lr.eventRegistrations_.push(or)}function viewRemoveEventRegistration(lr,or,ar){const cr=[];if(ar){assert(or==null,"A cancel should cancel all event registrations.");const ur=lr.query._path;lr.eventRegistrations_.forEach(hr=>{const fr=hr.createCancelEvent(ar,ur);fr&&cr.push(fr)})}if(or){let ur=[];for(let hr=0;hr<lr.eventRegistrations_.length;++hr){const fr=lr.eventRegistrations_[hr];if(!fr.matches(or))ur.push(fr);else if(or.hasAnyCallback()){ur=ur.concat(lr.eventRegistrations_.slice(hr+1));break}}lr.eventRegistrations_=ur}else lr.eventRegistrations_=[];return cr}function viewApplyOperation(lr,or,ar,cr){or.type===OperationType.MERGE&&or.source.queryId!==null&&(assert(viewCacheGetCompleteServerSnap(lr.viewCache_),"We should always have a full cache before handling merges"),assert(viewCacheGetCompleteEventSnap(lr.viewCache_),"Missing event cache, even though we have a server cache"));const ur=lr.viewCache_,hr=viewProcessorApplyOperation(lr.processor_,ur,or,ar,cr);return viewProcessorAssertIndexed(lr.processor_,hr.viewCache),assert(hr.viewCache.serverCache.isFullyInitialized()||!ur.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),lr.viewCache_=hr.viewCache,viewGenerateEventsForChanges_(lr,hr.changes,hr.viewCache.eventCache.getNode(),null)}function viewGetInitialEvents(lr,or){const ar=lr.viewCache_.eventCache,cr=[];return ar.getNode().isLeafNode()||ar.getNode().forEachChild(PRIORITY_INDEX,(hr,fr)=>{cr.push(changeChildAdded(hr,fr))}),ar.isFullyInitialized()&&cr.push(changeValue(ar.getNode())),viewGenerateEventsForChanges_(lr,cr,ar.getNode(),or)}function viewGenerateEventsForChanges_(lr,or,ar,cr){const ur=cr?[cr]:lr.eventRegistrations_;return eventGeneratorGenerateEventsForChanges(lr.eventGenerator_,or,ar,ur)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor$1;class SyncPoint{constructor(){this.views=new Map}}function syncPointSetReferenceConstructor(lr){assert(!referenceConstructor$1,"__referenceConstructor has already been defined"),referenceConstructor$1=lr}function syncPointGetReferenceConstructor(){return assert(referenceConstructor$1,"Reference.ts has not been loaded"),referenceConstructor$1}function syncPointIsEmpty(lr){return lr.views.size===0}function syncPointApplyOperation(lr,or,ar,cr){const ur=or.source.queryId;if(ur!==null){const hr=lr.views.get(ur);return assert(hr!=null,"SyncTree gave us an op for an invalid query."),viewApplyOperation(hr,or,ar,cr)}else{let hr=[];for(const fr of lr.views.values())hr=hr.concat(viewApplyOperation(fr,or,ar,cr));return hr}}function syncPointGetView(lr,or,ar,cr,ur){const hr=or._queryIdentifier,fr=lr.views.get(hr);if(!fr){let dr=writeTreeRefCalcCompleteEventCache(ar,ur?cr:null),pr=!1;dr?pr=!0:cr instanceof ChildrenNode?(dr=writeTreeRefCalcCompleteEventChildren(ar,cr),pr=!1):(dr=ChildrenNode.EMPTY_NODE,pr=!1);const mr=newViewCache(new CacheNode(dr,pr,!1),new CacheNode(cr,ur,!1));return new View(or,mr)}return fr}function syncPointAddEventRegistration(lr,or,ar,cr,ur,hr){const fr=syncPointGetView(lr,or,cr,ur,hr);return lr.views.has(or._queryIdentifier)||lr.views.set(or._queryIdentifier,fr),viewAddEventRegistration(fr,ar),viewGetInitialEvents(fr,ar)}function syncPointRemoveEventRegistration(lr,or,ar,cr){const ur=or._queryIdentifier,hr=[];let fr=[];const dr=syncPointHasCompleteView(lr);if(ur==="default")for(const[pr,mr]of lr.views.entries())fr=fr.concat(viewRemoveEventRegistration(mr,ar,cr)),viewIsEmpty(mr)&&(lr.views.delete(pr),mr.query._queryParams.loadsAllData()||hr.push(mr.query));else{const pr=lr.views.get(ur);pr&&(fr=fr.concat(viewRemoveEventRegistration(pr,ar,cr)),viewIsEmpty(pr)&&(lr.views.delete(ur),pr.query._queryParams.loadsAllData()||hr.push(pr.query)))}return dr&&!syncPointHasCompleteView(lr)&&hr.push(new(syncPointGetReferenceConstructor())(or._repo,or._path)),{removed:hr,events:fr}}function syncPointGetQueryViews(lr){const or=[];for(const ar of lr.views.values())ar.query._queryParams.loadsAllData()||or.push(ar);return or}function syncPointGetCompleteServerCache(lr,or){let ar=null;for(const cr of lr.views.values())ar=ar||viewGetCompleteServerCache(cr,or);return ar}function syncPointViewForQuery(lr,or){if(or._queryParams.loadsAllData())return syncPointGetCompleteView(lr);{const cr=or._queryIdentifier;return lr.views.get(cr)}}function syncPointViewExistsForQuery(lr,or){return syncPointViewForQuery(lr,or)!=null}function syncPointHasCompleteView(lr){return syncPointGetCompleteView(lr)!=null}function syncPointGetCompleteView(lr){for(const or of lr.views.values())if(or.query._queryParams.loadsAllData())return or;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor;function syncTreeSetReferenceConstructor(lr){assert(!referenceConstructor,"__referenceConstructor has already been defined"),referenceConstructor=lr}function syncTreeGetReferenceConstructor(){return assert(referenceConstructor,"Reference.ts has not been loaded"),referenceConstructor}let syncTreeNextQueryTag_=1;class SyncTree{constructor(or){this.listenProvider_=or,this.syncPointTree_=new ImmutableTree(null),this.pendingWriteTree_=newWriteTree(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function syncTreeApplyUserOverwrite(lr,or,ar,cr,ur){return writeTreeAddOverwrite(lr.pendingWriteTree_,or,ar,cr,ur),ur?syncTreeApplyOperationToSyncPoints_(lr,new Overwrite(newOperationSourceUser(),or,ar)):[]}function syncTreeApplyUserMerge(lr,or,ar,cr){writeTreeAddMerge(lr.pendingWriteTree_,or,ar,cr);const ur=ImmutableTree.fromObject(ar);return syncTreeApplyOperationToSyncPoints_(lr,new Merge(newOperationSourceUser(),or,ur))}function syncTreeAckUserWrite(lr,or,ar=!1){const cr=writeTreeGetWrite(lr.pendingWriteTree_,or);if(writeTreeRemoveWrite(lr.pendingWriteTree_,or)){let hr=new ImmutableTree(null);return cr.snap!=null?hr=hr.set(newEmptyPath(),!0):each(cr.children,fr=>{hr=hr.set(new Path(fr),!0)}),syncTreeApplyOperationToSyncPoints_(lr,new AckUserWrite(cr.path,hr,ar))}else return[]}function syncTreeApplyServerOverwrite(lr,or,ar){return syncTreeApplyOperationToSyncPoints_(lr,new Overwrite(newOperationSourceServer(),or,ar))}function syncTreeApplyServerMerge(lr,or,ar){const cr=ImmutableTree.fromObject(ar);return syncTreeApplyOperationToSyncPoints_(lr,new Merge(newOperationSourceServer(),or,cr))}function syncTreeApplyListenComplete(lr,or){return syncTreeApplyOperationToSyncPoints_(lr,new ListenComplete(newOperationSourceServer(),or))}function syncTreeApplyTaggedListenComplete(lr,or,ar){const cr=syncTreeQueryKeyForTag_(lr,ar);if(cr){const ur=syncTreeParseQueryKey_(cr),hr=ur.path,fr=ur.queryId,dr=newRelativePath(hr,or),pr=new ListenComplete(newOperationSourceServerTaggedQuery(fr),dr);return syncTreeApplyTaggedOperation_(lr,hr,pr)}else return[]}function syncTreeRemoveEventRegistration(lr,or,ar,cr,ur=!1){const hr=or._path,fr=lr.syncPointTree_.get(hr);let dr=[];if(fr&&(or._queryIdentifier==="default"||syncPointViewExistsForQuery(fr,or))){const pr=syncPointRemoveEventRegistration(fr,or,ar,cr);syncPointIsEmpty(fr)&&(lr.syncPointTree_=lr.syncPointTree_.remove(hr));const mr=pr.removed;if(dr=pr.events,!ur){const gr=mr.findIndex(br=>br._queryParams.loadsAllData())!==-1,yr=lr.syncPointTree_.findOnPath(hr,(br,Or)=>syncPointHasCompleteView(Or));if(gr&&!yr){const br=lr.syncPointTree_.subtree(hr);if(!br.isEmpty()){const Or=syncTreeCollectDistinctViewsForSubTree_(br);for(let _r=0;_r<Or.length;++_r){const vr=Or[_r],xr=vr.query,wr=syncTreeCreateListenerForView_(lr,vr);lr.listenProvider_.startListening(syncTreeQueryForListening_(xr),syncTreeTagForQuery(lr,xr),wr.hashFn,wr.onComplete)}}}!yr&&mr.length>0&&!cr&&(gr?lr.listenProvider_.stopListening(syncTreeQueryForListening_(or),null):mr.forEach(br=>{const Or=lr.queryToTagMap.get(syncTreeMakeQueryKey_(br));lr.listenProvider_.stopListening(syncTreeQueryForListening_(br),Or)}))}syncTreeRemoveTags_(lr,mr)}return dr}function syncTreeApplyTaggedQueryOverwrite(lr,or,ar,cr){const ur=syncTreeQueryKeyForTag_(lr,cr);if(ur!=null){const hr=syncTreeParseQueryKey_(ur),fr=hr.path,dr=hr.queryId,pr=newRelativePath(fr,or),mr=new Overwrite(newOperationSourceServerTaggedQuery(dr),pr,ar);return syncTreeApplyTaggedOperation_(lr,fr,mr)}else return[]}function syncTreeApplyTaggedQueryMerge(lr,or,ar,cr){const ur=syncTreeQueryKeyForTag_(lr,cr);if(ur){const hr=syncTreeParseQueryKey_(ur),fr=hr.path,dr=hr.queryId,pr=newRelativePath(fr,or),mr=ImmutableTree.fromObject(ar),gr=new Merge(newOperationSourceServerTaggedQuery(dr),pr,mr);return syncTreeApplyTaggedOperation_(lr,fr,gr)}else return[]}function syncTreeAddEventRegistration(lr,or,ar,cr=!1){const ur=or._path;let hr=null,fr=!1;lr.syncPointTree_.foreachOnPath(ur,(br,Or)=>{const _r=newRelativePath(br,ur);hr=hr||syncPointGetCompleteServerCache(Or,_r),fr=fr||syncPointHasCompleteView(Or)});let dr=lr.syncPointTree_.get(ur);dr?(fr=fr||syncPointHasCompleteView(dr),hr=hr||syncPointGetCompleteServerCache(dr,newEmptyPath())):(dr=new SyncPoint,lr.syncPointTree_=lr.syncPointTree_.set(ur,dr));let pr;hr!=null?pr=!0:(pr=!1,hr=ChildrenNode.EMPTY_NODE,lr.syncPointTree_.subtree(ur).foreachChild((Or,_r)=>{const vr=syncPointGetCompleteServerCache(_r,newEmptyPath());vr&&(hr=hr.updateImmediateChild(Or,vr))}));const mr=syncPointViewExistsForQuery(dr,or);if(!mr&&!or._queryParams.loadsAllData()){const br=syncTreeMakeQueryKey_(or);assert(!lr.queryToTagMap.has(br),"View does not exist, but we have a tag");const Or=syncTreeGetNextQueryTag_();lr.queryToTagMap.set(br,Or),lr.tagToQueryMap.set(Or,br)}const gr=writeTreeChildWrites(lr.pendingWriteTree_,ur);let yr=syncPointAddEventRegistration(dr,or,ar,gr,hr,pr);if(!mr&&!fr&&!cr){const br=syncPointViewForQuery(dr,or);yr=yr.concat(syncTreeSetupListener_(lr,or,br))}return yr}function syncTreeCalcCompleteEventCache(lr,or,ar){const ur=lr.pendingWriteTree_,hr=lr.syncPointTree_.findOnPath(or,(fr,dr)=>{const pr=newRelativePath(fr,or),mr=syncPointGetCompleteServerCache(dr,pr);if(mr)return mr});return writeTreeCalcCompleteEventCache(ur,or,hr,ar,!0)}function syncTreeGetServerValue(lr,or){const ar=or._path;let cr=null;lr.syncPointTree_.foreachOnPath(ar,(mr,gr)=>{const yr=newRelativePath(mr,ar);cr=cr||syncPointGetCompleteServerCache(gr,yr)});let ur=lr.syncPointTree_.get(ar);ur?cr=cr||syncPointGetCompleteServerCache(ur,newEmptyPath()):(ur=new SyncPoint,lr.syncPointTree_=lr.syncPointTree_.set(ar,ur));const hr=cr!=null,fr=hr?new CacheNode(cr,!0,!1):null,dr=writeTreeChildWrites(lr.pendingWriteTree_,or._path),pr=syncPointGetView(ur,or,dr,hr?fr.getNode():ChildrenNode.EMPTY_NODE,hr);return viewGetCompleteNode(pr)}function syncTreeApplyOperationToSyncPoints_(lr,or){return syncTreeApplyOperationHelper_(or,lr.syncPointTree_,null,writeTreeChildWrites(lr.pendingWriteTree_,newEmptyPath()))}function syncTreeApplyOperationHelper_(lr,or,ar,cr){if(pathIsEmpty(lr.path))return syncTreeApplyOperationDescendantsHelper_(lr,or,ar,cr);{const ur=or.get(newEmptyPath());ar==null&&ur!=null&&(ar=syncPointGetCompleteServerCache(ur,newEmptyPath()));let hr=[];const fr=pathGetFront(lr.path),dr=lr.operationForChild(fr),pr=or.children.get(fr);if(pr&&dr){const mr=ar?ar.getImmediateChild(fr):null,gr=writeTreeRefChild(cr,fr);hr=hr.concat(syncTreeApplyOperationHelper_(dr,pr,mr,gr))}return ur&&(hr=hr.concat(syncPointApplyOperation(ur,lr,cr,ar))),hr}}function syncTreeApplyOperationDescendantsHelper_(lr,or,ar,cr){const ur=or.get(newEmptyPath());ar==null&&ur!=null&&(ar=syncPointGetCompleteServerCache(ur,newEmptyPath()));let hr=[];return or.children.inorderTraversal((fr,dr)=>{const pr=ar?ar.getImmediateChild(fr):null,mr=writeTreeRefChild(cr,fr),gr=lr.operationForChild(fr);gr&&(hr=hr.concat(syncTreeApplyOperationDescendantsHelper_(gr,dr,pr,mr)))}),ur&&(hr=hr.concat(syncPointApplyOperation(ur,lr,cr,ar))),hr}function syncTreeCreateListenerForView_(lr,or){const ar=or.query,cr=syncTreeTagForQuery(lr,ar);return{hashFn:()=>(viewGetServerCache(or)||ChildrenNode.EMPTY_NODE).hash(),onComplete:ur=>{if(ur==="ok")return cr?syncTreeApplyTaggedListenComplete(lr,ar._path,cr):syncTreeApplyListenComplete(lr,ar._path);{const hr=errorForServerCode(ur,ar);return syncTreeRemoveEventRegistration(lr,ar,null,hr)}}}}function syncTreeTagForQuery(lr,or){const ar=syncTreeMakeQueryKey_(or);return lr.queryToTagMap.get(ar)}function syncTreeMakeQueryKey_(lr){return lr._path.toString()+"$"+lr._queryIdentifier}function syncTreeQueryKeyForTag_(lr,or){return lr.tagToQueryMap.get(or)}function syncTreeParseQueryKey_(lr){const or=lr.indexOf("$");return assert(or!==-1&&or<lr.length-1,"Bad queryKey."),{queryId:lr.substr(or+1),path:new Path(lr.substr(0,or))}}function syncTreeApplyTaggedOperation_(lr,or,ar){const cr=lr.syncPointTree_.get(or);assert(cr,"Missing sync point for query tag that we're tracking");const ur=writeTreeChildWrites(lr.pendingWriteTree_,or);return syncPointApplyOperation(cr,ar,ur,null)}function syncTreeCollectDistinctViewsForSubTree_(lr){return lr.fold((or,ar,cr)=>{if(ar&&syncPointHasCompleteView(ar))return[syncPointGetCompleteView(ar)];{let ur=[];return ar&&(ur=syncPointGetQueryViews(ar)),each(cr,(hr,fr)=>{ur=ur.concat(fr)}),ur}})}function syncTreeQueryForListening_(lr){return lr._queryParams.loadsAllData()&&!lr._queryParams.isDefault()?new(syncTreeGetReferenceConstructor())(lr._repo,lr._path):lr}function syncTreeRemoveTags_(lr,or){for(let ar=0;ar<or.length;++ar){const cr=or[ar];if(!cr._queryParams.loadsAllData()){const ur=syncTreeMakeQueryKey_(cr),hr=lr.queryToTagMap.get(ur);lr.queryToTagMap.delete(ur),lr.tagToQueryMap.delete(hr)}}}function syncTreeGetNextQueryTag_(){return syncTreeNextQueryTag_++}function syncTreeSetupListener_(lr,or,ar){const cr=or._path,ur=syncTreeTagForQuery(lr,or),hr=syncTreeCreateListenerForView_(lr,ar),fr=lr.listenProvider_.startListening(syncTreeQueryForListening_(or),ur,hr.hashFn,hr.onComplete),dr=lr.syncPointTree_.subtree(cr);if(ur)assert(!syncPointHasCompleteView(dr.value),"If we're adding a query, it shouldn't be shadowed");else{const pr=dr.fold((mr,gr,yr)=>{if(!pathIsEmpty(mr)&&gr&&syncPointHasCompleteView(gr))return[syncPointGetCompleteView(gr).query];{let br=[];return gr&&(br=br.concat(syncPointGetQueryViews(gr).map(Or=>Or.query))),each(yr,(Or,_r)=>{br=br.concat(_r)}),br}});for(let mr=0;mr<pr.length;++mr){const gr=pr[mr];lr.listenProvider_.stopListening(syncTreeQueryForListening_(gr),syncTreeTagForQuery(lr,gr))}}return fr}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistingValueProvider{constructor(or){this.node_=or}getImmediateChild(or){const ar=this.node_.getImmediateChild(or);return new ExistingValueProvider(ar)}node(){return this.node_}}class DeferredValueProvider{constructor(or,ar){this.syncTree_=or,this.path_=ar}getImmediateChild(or){const ar=pathChild(this.path_,or);return new DeferredValueProvider(this.syncTree_,ar)}node(){return syncTreeCalcCompleteEventCache(this.syncTree_,this.path_)}}const generateWithValues=function(lr){return lr=lr||{},lr.timestamp=lr.timestamp||new Date().getTime(),lr},resolveDeferredLeafValue=function(lr,or,ar){if(!lr||typeof lr!="object")return lr;if(assert(".sv"in lr,"Unexpected leaf node or priority contents"),typeof lr[".sv"]=="string")return resolveScalarDeferredValue(lr[".sv"],or,ar);if(typeof lr[".sv"]=="object")return resolveComplexDeferredValue(lr[".sv"],or);assert(!1,"Unexpected server value: "+JSON.stringify(lr,null,2))},resolveScalarDeferredValue=function(lr,or,ar){switch(lr){case"timestamp":return ar.timestamp;default:assert(!1,"Unexpected server value: "+lr)}},resolveComplexDeferredValue=function(lr,or,ar){lr.hasOwnProperty("increment")||assert(!1,"Unexpected server value: "+JSON.stringify(lr,null,2));const cr=lr.increment;typeof cr!="number"&&assert(!1,"Unexpected increment value: "+cr);const ur=or.node();if(assert(ur!==null&&typeof ur<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!ur.isLeafNode())return cr;const fr=ur.getValue();return typeof fr!="number"?cr:fr+cr},resolveDeferredValueTree=function(lr,or,ar,cr){return resolveDeferredValue(or,new DeferredValueProvider(ar,lr),cr)},resolveDeferredValueSnapshot=function(lr,or,ar){return resolveDeferredValue(lr,new ExistingValueProvider(or),ar)};function resolveDeferredValue(lr,or,ar){const cr=lr.getPriority().val(),ur=resolveDeferredLeafValue(cr,or.getImmediateChild(".priority"),ar);let hr;if(lr.isLeafNode()){const fr=lr,dr=resolveDeferredLeafValue(fr.getValue(),or,ar);return dr!==fr.getValue()||ur!==fr.getPriority().val()?new LeafNode(dr,nodeFromJSON(ur)):lr}else{const fr=lr;return hr=fr,ur!==fr.getPriority().val()&&(hr=hr.updatePriority(new LeafNode(ur))),fr.forEachChild(PRIORITY_INDEX,(dr,pr)=>{const mr=resolveDeferredValue(pr,or.getImmediateChild(dr),ar);mr!==pr&&(hr=hr.updateImmediateChild(dr,mr))}),hr}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tree{constructor(or="",ar=null,cr={children:{},childCount:0}){this.name=or,this.parent=ar,this.node=cr}}function treeSubTree(lr,or){let ar=or instanceof Path?or:new Path(or),cr=lr,ur=pathGetFront(ar);for(;ur!==null;){const hr=safeGet(cr.node.children,ur)||{children:{},childCount:0};cr=new Tree(ur,cr,hr),ar=pathPopFront(ar),ur=pathGetFront(ar)}return cr}function treeGetValue(lr){return lr.node.value}function treeSetValue(lr,or){lr.node.value=or,treeUpdateParents(lr)}function treeHasChildren(lr){return lr.node.childCount>0}function treeIsEmpty(lr){return treeGetValue(lr)===void 0&&!treeHasChildren(lr)}function treeForEachChild(lr,or){each(lr.node.children,(ar,cr)=>{or(new Tree(ar,lr,cr))})}function treeForEachDescendant(lr,or,ar,cr){ar&&!cr&&or(lr),treeForEachChild(lr,ur=>{treeForEachDescendant(ur,or,!0,cr)}),ar&&cr&&or(lr)}function treeForEachAncestor(lr,or,ar){let cr=ar?lr:lr.parent;for(;cr!==null;){if(or(cr))return!0;cr=cr.parent}return!1}function treeGetPath(lr){return new Path(lr.parent===null?lr.name:treeGetPath(lr.parent)+"/"+lr.name)}function treeUpdateParents(lr){lr.parent!==null&&treeUpdateChild(lr.parent,lr.name,lr)}function treeUpdateChild(lr,or,ar){const cr=treeIsEmpty(ar),ur=contains(lr.node.children,or);cr&&ur?(delete lr.node.children[or],lr.node.childCount--,treeUpdateParents(lr)):!cr&&!ur&&(lr.node.children[or]=ar.node,lr.node.childCount++,treeUpdateParents(lr))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,MAX_LEAF_SIZE_=10*1024*1024,isValidKey=function(lr){return typeof lr=="string"&&lr.length!==0&&!INVALID_KEY_REGEX_.test(lr)},isValidPathString=function(lr){return typeof lr=="string"&&lr.length!==0&&!INVALID_PATH_REGEX_.test(lr)},isValidRootPathString=function(lr){return lr&&(lr=lr.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(lr)},isValidPriority=function(lr){return lr===null||typeof lr=="string"||typeof lr=="number"&&!isInvalidJSONNumber(lr)||lr&&typeof lr=="object"&&contains(lr,".sv")},validateFirebaseDataArg=function(lr,or,ar,cr){cr&&or===void 0||validateFirebaseData(errorPrefix(lr,"value"),or,ar)},validateFirebaseData=function(lr,or,ar){const cr=ar instanceof Path?new ValidationPath(ar,lr):ar;if(or===void 0)throw new Error(lr+"contains undefined "+validationPathToErrorString(cr));if(typeof or=="function")throw new Error(lr+"contains a function "+validationPathToErrorString(cr)+" with contents = "+or.toString());if(isInvalidJSONNumber(or))throw new Error(lr+"contains "+or.toString()+" "+validationPathToErrorString(cr));if(typeof or=="string"&&or.length>MAX_LEAF_SIZE_/3&&stringLength(or)>MAX_LEAF_SIZE_)throw new Error(lr+"contains a string greater than "+MAX_LEAF_SIZE_+" utf8 bytes "+validationPathToErrorString(cr)+" ('"+or.substring(0,50)+"...')");if(or&&typeof or=="object"){let ur=!1,hr=!1;if(each(or,(fr,dr)=>{if(fr===".value")ur=!0;else if(fr!==".priority"&&fr!==".sv"&&(hr=!0,!isValidKey(fr)))throw new Error(lr+" contains an invalid key ("+fr+") "+validationPathToErrorString(cr)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);validationPathPush(cr,fr),validateFirebaseData(lr,dr,cr),validationPathPop(cr)}),ur&&hr)throw new Error(lr+' contains ".value" child '+validationPathToErrorString(cr)+" in addition to actual children.")}},validateFirebaseMergePaths=function(lr,or){let ar,cr;for(ar=0;ar<or.length;ar++){cr=or[ar];const hr=pathSlice(cr);for(let fr=0;fr<hr.length;fr++)if(!(hr[fr]===".priority"&&fr===hr.length-1)){if(!isValidKey(hr[fr]))throw new Error(lr+"contains an invalid key ("+hr[fr]+") in path "+cr.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}or.sort(pathCompare);let ur=null;for(ar=0;ar<or.length;ar++){if(cr=or[ar],ur!==null&&pathContains(ur,cr))throw new Error(lr+"contains a path "+ur.toString()+" that is ancestor of another path "+cr.toString());ur=cr}},validateFirebaseMergeDataArg=function(lr,or,ar,cr){if(cr&&or===void 0)return;const ur=errorPrefix(lr,"values");if(!(or&&typeof or=="object")||Array.isArray(or))throw new Error(ur+" must be an object containing the children to replace.");const hr=[];each(or,(fr,dr)=>{const pr=new Path(fr);if(validateFirebaseData(ur,dr,pathChild(ar,pr)),pathGetBack(pr)===".priority"&&!isValidPriority(dr))throw new Error(ur+"contains an invalid value for '"+pr.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");hr.push(pr)}),validateFirebaseMergePaths(ur,hr)},validatePriority=function(lr,or,ar){if(!(ar&&or===void 0)){if(isInvalidJSONNumber(or))throw new Error(errorPrefix(lr,"priority")+"is "+or.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!isValidPriority(or))throw new Error(errorPrefix(lr,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},validateKey=function(lr,or,ar,cr){if(!(cr&&ar===void 0)&&!isValidKey(ar))throw new Error(errorPrefix(lr,or)+'was an invalid key = "'+ar+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},validatePathString=function(lr,or,ar,cr){if(!(cr&&ar===void 0)&&!isValidPathString(ar))throw new Error(errorPrefix(lr,or)+'was an invalid path = "'+ar+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},validateRootPathString=function(lr,or,ar,cr){ar&&(ar=ar.replace(/^\/*\.info(\/|$)/,"/")),validatePathString(lr,or,ar,cr)},validateWritablePath=function(lr,or){if(pathGetFront(or)===".info")throw new Error(lr+" failed = Can't modify data under /.info/")},validateUrl=function(lr,or){const ar=or.path.toString();if(typeof or.repoInfo.host!="string"||or.repoInfo.host.length===0||!isValidKey(or.repoInfo.namespace)&&or.repoInfo.host.split(":")[0]!=="localhost"||ar.length!==0&&!isValidRootPathString(ar))throw new Error(errorPrefix(lr,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventQueue{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function eventQueueQueueEvents(lr,or){let ar=null;for(let cr=0;cr<or.length;cr++){const ur=or[cr],hr=ur.getPath();ar!==null&&!pathEquals(hr,ar.path)&&(lr.eventLists_.push(ar),ar=null),ar===null&&(ar={events:[],path:hr}),ar.events.push(ur)}ar&&lr.eventLists_.push(ar)}function eventQueueRaiseEventsAtPath(lr,or,ar){eventQueueQueueEvents(lr,ar),eventQueueRaiseQueuedEventsMatchingPredicate(lr,cr=>pathEquals(cr,or))}function eventQueueRaiseEventsForChangedPath(lr,or,ar){eventQueueQueueEvents(lr,ar),eventQueueRaiseQueuedEventsMatchingPredicate(lr,cr=>pathContains(cr,or)||pathContains(or,cr))}function eventQueueRaiseQueuedEventsMatchingPredicate(lr,or){lr.recursionDepth_++;let ar=!0;for(let cr=0;cr<lr.eventLists_.length;cr++){const ur=lr.eventLists_[cr];if(ur){const hr=ur.path;or(hr)?(eventListRaise(lr.eventLists_[cr]),lr.eventLists_[cr]=null):ar=!1}}ar&&(lr.eventLists_=[]),lr.recursionDepth_--}function eventListRaise(lr){for(let or=0;or<lr.events.length;or++){const ar=lr.events[or];if(ar!==null){lr.events[or]=null;const cr=ar.getEventRunner();logger&&log("event: "+ar.toString()),exceptionGuard(cr)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INTERRUPT_REASON="repo_interrupt",MAX_TRANSACTION_RETRIES=25;class Repo{constructor(or,ar,cr,ur){this.repoInfo_=or,this.forceRestClient_=ar,this.authTokenProvider_=cr,this.appCheckProvider_=ur,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=newSparseSnapshotTree(),this.transactionQueueTree_=new Tree,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function repoStart(lr,or,ar){if(lr.stats_=statsManagerGetCollection(lr.repoInfo_),lr.forceRestClient_||beingCrawled())lr.server_=new ReadonlyRestClient(lr.repoInfo_,(cr,ur,hr,fr)=>{repoOnDataUpdate(lr,cr,ur,hr,fr)},lr.authTokenProvider_,lr.appCheckProvider_),setTimeout(()=>repoOnConnectStatus(lr,!0),0);else{if(typeof ar<"u"&&ar!==null){if(typeof ar!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{stringify(ar)}catch(cr){throw new Error("Invalid authOverride provided: "+cr)}}lr.persistentConnection_=new PersistentConnection(lr.repoInfo_,or,(cr,ur,hr,fr)=>{repoOnDataUpdate(lr,cr,ur,hr,fr)},cr=>{repoOnConnectStatus(lr,cr)},cr=>{repoOnServerInfoUpdate(lr,cr)},lr.authTokenProvider_,lr.appCheckProvider_,ar),lr.server_=lr.persistentConnection_}lr.authTokenProvider_.addTokenChangeListener(cr=>{lr.server_.refreshAuthToken(cr)}),lr.appCheckProvider_.addTokenChangeListener(cr=>{lr.server_.refreshAppCheckToken(cr.token)}),lr.statsReporter_=statsManagerGetOrCreateReporter(lr.repoInfo_,()=>new StatsReporter(lr.stats_,lr.server_)),lr.infoData_=new SnapshotHolder,lr.infoSyncTree_=new SyncTree({startListening:(cr,ur,hr,fr)=>{let dr=[];const pr=lr.infoData_.getNode(cr._path);return pr.isEmpty()||(dr=syncTreeApplyServerOverwrite(lr.infoSyncTree_,cr._path,pr),setTimeout(()=>{fr("ok")},0)),dr},stopListening:()=>{}}),repoUpdateInfo(lr,"connected",!1),lr.serverSyncTree_=new SyncTree({startListening:(cr,ur,hr,fr)=>(lr.server_.listen(cr,hr,ur,(dr,pr)=>{const mr=fr(dr,pr);eventQueueRaiseEventsForChangedPath(lr.eventQueue_,cr._path,mr)}),[]),stopListening:(cr,ur)=>{lr.server_.unlisten(cr,ur)}})}function repoServerTime(lr){const ar=lr.infoData_.getNode(new Path(".info/serverTimeOffset")).val()||0;return new Date().getTime()+ar}function repoGenerateServerValues(lr){return generateWithValues({timestamp:repoServerTime(lr)})}function repoOnDataUpdate(lr,or,ar,cr,ur){lr.dataUpdateCount++;const hr=new Path(or);ar=lr.interceptServerDataCallback_?lr.interceptServerDataCallback_(or,ar):ar;let fr=[];if(ur)if(cr){const pr=map(ar,mr=>nodeFromJSON(mr));fr=syncTreeApplyTaggedQueryMerge(lr.serverSyncTree_,hr,pr,ur)}else{const pr=nodeFromJSON(ar);fr=syncTreeApplyTaggedQueryOverwrite(lr.serverSyncTree_,hr,pr,ur)}else if(cr){const pr=map(ar,mr=>nodeFromJSON(mr));fr=syncTreeApplyServerMerge(lr.serverSyncTree_,hr,pr)}else{const pr=nodeFromJSON(ar);fr=syncTreeApplyServerOverwrite(lr.serverSyncTree_,hr,pr)}let dr=hr;fr.length>0&&(dr=repoRerunTransactions(lr,hr)),eventQueueRaiseEventsForChangedPath(lr.eventQueue_,dr,fr)}function repoOnConnectStatus(lr,or){repoUpdateInfo(lr,"connected",or),or===!1&&repoRunOnDisconnectEvents(lr)}function repoOnServerInfoUpdate(lr,or){each(or,(ar,cr)=>{repoUpdateInfo(lr,ar,cr)})}function repoUpdateInfo(lr,or,ar){const cr=new Path("/.info/"+or),ur=nodeFromJSON(ar);lr.infoData_.updateSnapshot(cr,ur);const hr=syncTreeApplyServerOverwrite(lr.infoSyncTree_,cr,ur);eventQueueRaiseEventsForChangedPath(lr.eventQueue_,cr,hr)}function repoGetNextWriteId(lr){return lr.nextWriteId_++}function repoGetValue(lr,or,ar){const cr=syncTreeGetServerValue(lr.serverSyncTree_,or);return cr!=null?Promise.resolve(cr):lr.server_.get(or).then(ur=>{const hr=nodeFromJSON(ur).withIndex(or._queryParams.getIndex());syncTreeAddEventRegistration(lr.serverSyncTree_,or,ar,!0);let fr;if(or._queryParams.loadsAllData())fr=syncTreeApplyServerOverwrite(lr.serverSyncTree_,or._path,hr);else{const dr=syncTreeTagForQuery(lr.serverSyncTree_,or);fr=syncTreeApplyTaggedQueryOverwrite(lr.serverSyncTree_,or._path,hr,dr)}return eventQueueRaiseEventsForChangedPath(lr.eventQueue_,or._path,fr),syncTreeRemoveEventRegistration(lr.serverSyncTree_,or,ar,null,!0),hr},ur=>(repoLog(lr,"get for query "+stringify(or)+" failed: "+ur),Promise.reject(new Error(ur))))}function repoSetWithPriority(lr,or,ar,cr,ur){repoLog(lr,"set",{path:or.toString(),value:ar,priority:cr});const hr=repoGenerateServerValues(lr),fr=nodeFromJSON(ar,cr),dr=syncTreeCalcCompleteEventCache(lr.serverSyncTree_,or),pr=resolveDeferredValueSnapshot(fr,dr,hr),mr=repoGetNextWriteId(lr),gr=syncTreeApplyUserOverwrite(lr.serverSyncTree_,or,pr,mr,!0);eventQueueQueueEvents(lr.eventQueue_,gr),lr.server_.put(or.toString(),fr.val(!0),(br,Or)=>{const _r=br==="ok";_r||warn$1("set at "+or+" failed: "+br);const vr=syncTreeAckUserWrite(lr.serverSyncTree_,mr,!_r);eventQueueRaiseEventsForChangedPath(lr.eventQueue_,or,vr),repoCallOnCompleteCallback(lr,ur,br,Or)});const yr=repoAbortTransactions(lr,or);repoRerunTransactions(lr,yr),eventQueueRaiseEventsForChangedPath(lr.eventQueue_,yr,[])}function repoUpdate(lr,or,ar,cr){repoLog(lr,"update",{path:or.toString(),value:ar});let ur=!0;const hr=repoGenerateServerValues(lr),fr={};if(each(ar,(dr,pr)=>{ur=!1,fr[dr]=resolveDeferredValueTree(pathChild(or,dr),nodeFromJSON(pr),lr.serverSyncTree_,hr)}),ur)log("update() called with empty data.  Don't do anything."),repoCallOnCompleteCallback(lr,cr,"ok",void 0);else{const dr=repoGetNextWriteId(lr),pr=syncTreeApplyUserMerge(lr.serverSyncTree_,or,fr,dr);eventQueueQueueEvents(lr.eventQueue_,pr),lr.server_.merge(or.toString(),ar,(mr,gr)=>{const yr=mr==="ok";yr||warn$1("update at "+or+" failed: "+mr);const br=syncTreeAckUserWrite(lr.serverSyncTree_,dr,!yr),Or=br.length>0?repoRerunTransactions(lr,or):or;eventQueueRaiseEventsForChangedPath(lr.eventQueue_,Or,br),repoCallOnCompleteCallback(lr,cr,mr,gr)}),each(ar,mr=>{const gr=repoAbortTransactions(lr,pathChild(or,mr));repoRerunTransactions(lr,gr)}),eventQueueRaiseEventsForChangedPath(lr.eventQueue_,or,[])}}function repoRunOnDisconnectEvents(lr){repoLog(lr,"onDisconnectEvents");const or=repoGenerateServerValues(lr),ar=newSparseSnapshotTree();sparseSnapshotTreeForEachTree(lr.onDisconnect_,newEmptyPath(),(ur,hr)=>{const fr=resolveDeferredValueTree(ur,hr,lr.serverSyncTree_,or);sparseSnapshotTreeRemember(ar,ur,fr)});let cr=[];sparseSnapshotTreeForEachTree(ar,newEmptyPath(),(ur,hr)=>{cr=cr.concat(syncTreeApplyServerOverwrite(lr.serverSyncTree_,ur,hr));const fr=repoAbortTransactions(lr,ur);repoRerunTransactions(lr,fr)}),lr.onDisconnect_=newSparseSnapshotTree(),eventQueueRaiseEventsForChangedPath(lr.eventQueue_,newEmptyPath(),cr)}function repoOnDisconnectCancel(lr,or,ar){lr.server_.onDisconnectCancel(or.toString(),(cr,ur)=>{cr==="ok"&&sparseSnapshotTreeForget(lr.onDisconnect_,or),repoCallOnCompleteCallback(lr,ar,cr,ur)})}function repoOnDisconnectSet(lr,or,ar,cr){const ur=nodeFromJSON(ar);lr.server_.onDisconnectPut(or.toString(),ur.val(!0),(hr,fr)=>{hr==="ok"&&sparseSnapshotTreeRemember(lr.onDisconnect_,or,ur),repoCallOnCompleteCallback(lr,cr,hr,fr)})}function repoOnDisconnectSetWithPriority(lr,or,ar,cr,ur){const hr=nodeFromJSON(ar,cr);lr.server_.onDisconnectPut(or.toString(),hr.val(!0),(fr,dr)=>{fr==="ok"&&sparseSnapshotTreeRemember(lr.onDisconnect_,or,hr),repoCallOnCompleteCallback(lr,ur,fr,dr)})}function repoOnDisconnectUpdate(lr,or,ar,cr){if(isEmpty(ar)){log("onDisconnect().update() called with empty data.  Don't do anything."),repoCallOnCompleteCallback(lr,cr,"ok",void 0);return}lr.server_.onDisconnectMerge(or.toString(),ar,(ur,hr)=>{ur==="ok"&&each(ar,(fr,dr)=>{const pr=nodeFromJSON(dr);sparseSnapshotTreeRemember(lr.onDisconnect_,pathChild(or,fr),pr)}),repoCallOnCompleteCallback(lr,cr,ur,hr)})}function repoAddEventCallbackForQuery(lr,or,ar){let cr;pathGetFront(or._path)===".info"?cr=syncTreeAddEventRegistration(lr.infoSyncTree_,or,ar):cr=syncTreeAddEventRegistration(lr.serverSyncTree_,or,ar),eventQueueRaiseEventsAtPath(lr.eventQueue_,or._path,cr)}function repoRemoveEventCallbackForQuery(lr,or,ar){let cr;pathGetFront(or._path)===".info"?cr=syncTreeRemoveEventRegistration(lr.infoSyncTree_,or,ar):cr=syncTreeRemoveEventRegistration(lr.serverSyncTree_,or,ar),eventQueueRaiseEventsAtPath(lr.eventQueue_,or._path,cr)}function repoInterrupt(lr){lr.persistentConnection_&&lr.persistentConnection_.interrupt(INTERRUPT_REASON)}function repoResume(lr){lr.persistentConnection_&&lr.persistentConnection_.resume(INTERRUPT_REASON)}function repoLog(lr,...or){let ar="";lr.persistentConnection_&&(ar=lr.persistentConnection_.id+":"),log(ar,...or)}function repoCallOnCompleteCallback(lr,or,ar,cr){or&&exceptionGuard(()=>{if(ar==="ok")or(null);else{const ur=(ar||"error").toUpperCase();let hr=ur;cr&&(hr+=": "+cr);const fr=new Error(hr);fr.code=ur,or(fr)}})}function repoStartTransaction(lr,or,ar,cr,ur,hr){repoLog(lr,"transaction on "+or);const fr={path:or,update:ar,onComplete:cr,status:null,order:LUIDGenerator(),applyLocally:hr,retryCount:0,unwatcher:ur,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},dr=repoGetLatestState(lr,or,void 0);fr.currentInputSnapshot=dr;const pr=fr.update(dr.val());if(pr===void 0)fr.unwatcher(),fr.currentOutputSnapshotRaw=null,fr.currentOutputSnapshotResolved=null,fr.onComplete&&fr.onComplete(null,!1,fr.currentInputSnapshot);else{validateFirebaseData("transaction failed: Data returned ",pr,fr.path),fr.status=0;const mr=treeSubTree(lr.transactionQueueTree_,or),gr=treeGetValue(mr)||[];gr.push(fr),treeSetValue(mr,gr);let yr;typeof pr=="object"&&pr!==null&&contains(pr,".priority")?(yr=safeGet(pr,".priority"),assert(isValidPriority(yr),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):yr=(syncTreeCalcCompleteEventCache(lr.serverSyncTree_,or)||ChildrenNode.EMPTY_NODE).getPriority().val();const br=repoGenerateServerValues(lr),Or=nodeFromJSON(pr,yr),_r=resolveDeferredValueSnapshot(Or,dr,br);fr.currentOutputSnapshotRaw=Or,fr.currentOutputSnapshotResolved=_r,fr.currentWriteId=repoGetNextWriteId(lr);const vr=syncTreeApplyUserOverwrite(lr.serverSyncTree_,or,_r,fr.currentWriteId,fr.applyLocally);eventQueueRaiseEventsForChangedPath(lr.eventQueue_,or,vr),repoSendReadyTransactions(lr,lr.transactionQueueTree_)}}function repoGetLatestState(lr,or,ar){return syncTreeCalcCompleteEventCache(lr.serverSyncTree_,or,ar)||ChildrenNode.EMPTY_NODE}function repoSendReadyTransactions(lr,or=lr.transactionQueueTree_){if(or||repoPruneCompletedTransactionsBelowNode(lr,or),treeGetValue(or)){const ar=repoBuildTransactionQueue(lr,or);assert(ar.length>0,"Sending zero length transaction queue"),ar.every(ur=>ur.status===0)&&repoSendTransactionQueue(lr,treeGetPath(or),ar)}else treeHasChildren(or)&&treeForEachChild(or,ar=>{repoSendReadyTransactions(lr,ar)})}function repoSendTransactionQueue(lr,or,ar){const cr=ar.map(mr=>mr.currentWriteId),ur=repoGetLatestState(lr,or,cr);let hr=ur;const fr=ur.hash();for(let mr=0;mr<ar.length;mr++){const gr=ar[mr];assert(gr.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),gr.status=1,gr.retryCount++;const yr=newRelativePath(or,gr.path);hr=hr.updateChild(yr,gr.currentOutputSnapshotRaw)}const dr=hr.val(!0),pr=or;lr.server_.put(pr.toString(),dr,mr=>{repoLog(lr,"transaction put response",{path:pr.toString(),status:mr});let gr=[];if(mr==="ok"){const yr=[];for(let br=0;br<ar.length;br++)ar[br].status=2,gr=gr.concat(syncTreeAckUserWrite(lr.serverSyncTree_,ar[br].currentWriteId)),ar[br].onComplete&&yr.push(()=>ar[br].onComplete(null,!0,ar[br].currentOutputSnapshotResolved)),ar[br].unwatcher();repoPruneCompletedTransactionsBelowNode(lr,treeSubTree(lr.transactionQueueTree_,or)),repoSendReadyTransactions(lr,lr.transactionQueueTree_),eventQueueRaiseEventsForChangedPath(lr.eventQueue_,or,gr);for(let br=0;br<yr.length;br++)exceptionGuard(yr[br])}else{if(mr==="datastale")for(let yr=0;yr<ar.length;yr++)ar[yr].status===3?ar[yr].status=4:ar[yr].status=0;else{warn$1("transaction at "+pr.toString()+" failed: "+mr);for(let yr=0;yr<ar.length;yr++)ar[yr].status=4,ar[yr].abortReason=mr}repoRerunTransactions(lr,or)}},fr)}function repoRerunTransactions(lr,or){const ar=repoGetAncestorTransactionNode(lr,or),cr=treeGetPath(ar),ur=repoBuildTransactionQueue(lr,ar);return repoRerunTransactionQueue(lr,ur,cr),cr}function repoRerunTransactionQueue(lr,or,ar){if(or.length===0)return;const cr=[];let ur=[];const fr=or.filter(dr=>dr.status===0).map(dr=>dr.currentWriteId);for(let dr=0;dr<or.length;dr++){const pr=or[dr],mr=newRelativePath(ar,pr.path);let gr=!1,yr;if(assert(mr!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),pr.status===4)gr=!0,yr=pr.abortReason,ur=ur.concat(syncTreeAckUserWrite(lr.serverSyncTree_,pr.currentWriteId,!0));else if(pr.status===0)if(pr.retryCount>=MAX_TRANSACTION_RETRIES)gr=!0,yr="maxretry",ur=ur.concat(syncTreeAckUserWrite(lr.serverSyncTree_,pr.currentWriteId,!0));else{const br=repoGetLatestState(lr,pr.path,fr);pr.currentInputSnapshot=br;const Or=or[dr].update(br.val());if(Or!==void 0){validateFirebaseData("transaction failed: Data returned ",Or,pr.path);let _r=nodeFromJSON(Or);typeof Or=="object"&&Or!=null&&contains(Or,".priority")||(_r=_r.updatePriority(br.getPriority()));const xr=pr.currentWriteId,wr=repoGenerateServerValues(lr),kr=resolveDeferredValueSnapshot(_r,br,wr);pr.currentOutputSnapshotRaw=_r,pr.currentOutputSnapshotResolved=kr,pr.currentWriteId=repoGetNextWriteId(lr),fr.splice(fr.indexOf(xr),1),ur=ur.concat(syncTreeApplyUserOverwrite(lr.serverSyncTree_,pr.path,kr,pr.currentWriteId,pr.applyLocally)),ur=ur.concat(syncTreeAckUserWrite(lr.serverSyncTree_,xr,!0))}else gr=!0,yr="nodata",ur=ur.concat(syncTreeAckUserWrite(lr.serverSyncTree_,pr.currentWriteId,!0))}eventQueueRaiseEventsForChangedPath(lr.eventQueue_,ar,ur),ur=[],gr&&(or[dr].status=2,function(br){setTimeout(br,Math.floor(0))}(or[dr].unwatcher),or[dr].onComplete&&(yr==="nodata"?cr.push(()=>or[dr].onComplete(null,!1,or[dr].currentInputSnapshot)):cr.push(()=>or[dr].onComplete(new Error(yr),!1,null))))}repoPruneCompletedTransactionsBelowNode(lr,lr.transactionQueueTree_);for(let dr=0;dr<cr.length;dr++)exceptionGuard(cr[dr]);repoSendReadyTransactions(lr,lr.transactionQueueTree_)}function repoGetAncestorTransactionNode(lr,or){let ar,cr=lr.transactionQueueTree_;for(ar=pathGetFront(or);ar!==null&&treeGetValue(cr)===void 0;)cr=treeSubTree(cr,ar),or=pathPopFront(or),ar=pathGetFront(or);return cr}function repoBuildTransactionQueue(lr,or){const ar=[];return repoAggregateTransactionQueuesForNode(lr,or,ar),ar.sort((cr,ur)=>cr.order-ur.order),ar}function repoAggregateTransactionQueuesForNode(lr,or,ar){const cr=treeGetValue(or);if(cr)for(let ur=0;ur<cr.length;ur++)ar.push(cr[ur]);treeForEachChild(or,ur=>{repoAggregateTransactionQueuesForNode(lr,ur,ar)})}function repoPruneCompletedTransactionsBelowNode(lr,or){const ar=treeGetValue(or);if(ar){let cr=0;for(let ur=0;ur<ar.length;ur++)ar[ur].status!==2&&(ar[cr]=ar[ur],cr++);ar.length=cr,treeSetValue(or,ar.length>0?ar:void 0)}treeForEachChild(or,cr=>{repoPruneCompletedTransactionsBelowNode(lr,cr)})}function repoAbortTransactions(lr,or){const ar=treeGetPath(repoGetAncestorTransactionNode(lr,or)),cr=treeSubTree(lr.transactionQueueTree_,or);return treeForEachAncestor(cr,ur=>{repoAbortTransactionsOnNode(lr,ur)}),repoAbortTransactionsOnNode(lr,cr),treeForEachDescendant(cr,ur=>{repoAbortTransactionsOnNode(lr,ur)}),ar}function repoAbortTransactionsOnNode(lr,or){const ar=treeGetValue(or);if(ar){const cr=[];let ur=[],hr=-1;for(let fr=0;fr<ar.length;fr++)ar[fr].status===3||(ar[fr].status===1?(assert(hr===fr-1,"All SENT items should be at beginning of queue."),hr=fr,ar[fr].status=3,ar[fr].abortReason="set"):(assert(ar[fr].status===0,"Unexpected transaction status in abort"),ar[fr].unwatcher(),ur=ur.concat(syncTreeAckUserWrite(lr.serverSyncTree_,ar[fr].currentWriteId,!0)),ar[fr].onComplete&&cr.push(ar[fr].onComplete.bind(null,new Error("set"),!1,null))));hr===-1?treeSetValue(or,void 0):ar.length=hr+1,eventQueueRaiseEventsForChangedPath(lr.eventQueue_,treeGetPath(or),ur);for(let fr=0;fr<cr.length;fr++)exceptionGuard(cr[fr])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodePath(lr){let or="";const ar=lr.split("/");for(let cr=0;cr<ar.length;cr++)if(ar[cr].length>0){let ur=ar[cr];try{ur=decodeURIComponent(ur.replace(/\+/g," "))}catch{}or+="/"+ur}return or}function decodeQuery(lr){const or={};lr.charAt(0)==="?"&&(lr=lr.substring(1));for(const ar of lr.split("&")){if(ar.length===0)continue;const cr=ar.split("=");cr.length===2?or[decodeURIComponent(cr[0])]=decodeURIComponent(cr[1]):warn$1(`Invalid query segment '${ar}' in query '${lr}'`)}return or}const parseRepoInfo=function(lr,or){const ar=parseDatabaseURL(lr),cr=ar.namespace;ar.domain==="firebase.com"&&fatal(ar.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!cr||cr==="undefined")&&ar.domain!=="localhost"&&fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),ar.secure||warnIfPageIsSecure();const ur=ar.scheme==="ws"||ar.scheme==="wss";return{repoInfo:new RepoInfo(ar.host,ar.secure,cr,ur,or,"",cr!==ar.subdomain),path:new Path(ar.pathString)}},parseDatabaseURL=function(lr){let or="",ar="",cr="",ur="",hr="",fr=!0,dr="https",pr=443;if(typeof lr=="string"){let mr=lr.indexOf("//");mr>=0&&(dr=lr.substring(0,mr-1),lr=lr.substring(mr+2));let gr=lr.indexOf("/");gr===-1&&(gr=lr.length);let yr=lr.indexOf("?");yr===-1&&(yr=lr.length),or=lr.substring(0,Math.min(gr,yr)),gr<yr&&(ur=decodePath(lr.substring(gr,yr)));const br=decodeQuery(lr.substring(Math.min(lr.length,yr)));mr=or.indexOf(":"),mr>=0?(fr=dr==="https"||dr==="wss",pr=parseInt(or.substring(mr+1),10)):mr=or.length;const Or=or.slice(0,mr);if(Or.toLowerCase()==="localhost")ar="localhost";else if(Or.split(".").length<=2)ar=Or;else{const _r=or.indexOf(".");cr=or.substring(0,_r).toLowerCase(),ar=or.substring(_r+1),hr=cr}"ns"in br&&(hr=br.ns)}return{host:or,port:pr,domain:ar,subdomain:cr,secure:fr,scheme:dr,pathString:ur,namespace:hr}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PUSH_CHARS="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",nextPushId=function(){let lr=0;const or=[];return function(ar){const cr=ar===lr;lr=ar;let ur;const hr=new Array(8);for(ur=7;ur>=0;ur--)hr[ur]=PUSH_CHARS.charAt(ar%64),ar=Math.floor(ar/64);assert(ar===0,"Cannot push at time == 0");let fr=hr.join("");if(cr){for(ur=11;ur>=0&&or[ur]===63;ur--)or[ur]=0;or[ur]++}else for(ur=0;ur<12;ur++)or[ur]=Math.floor(Math.random()*64);for(ur=0;ur<12;ur++)fr+=PUSH_CHARS.charAt(or[ur]);return assert(fr.length===20,"nextPushId: Length should be 20."),fr}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DataEvent{constructor(or,ar,cr,ur){this.eventType=or,this.eventRegistration=ar,this.snapshot=cr,this.prevName=ur}getPath(){const or=this.snapshot.ref;return this.eventType==="value"?or._path:or.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+stringify(this.snapshot.exportVal())}}class CancelEvent{constructor(or,ar,cr){this.eventRegistration=or,this.error=ar,this.path=cr}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CallbackContext{constructor(or,ar){this.snapshotCallback=or,this.cancelCallback=ar}onValue(or,ar){this.snapshotCallback.call(null,or,ar)}onCancel(or){return assert(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,or)}get hasCancelCallback(){return!!this.cancelCallback}matches(or){return this.snapshotCallback===or.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===or.snapshotCallback.userCallback&&this.snapshotCallback.context===or.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OnDisconnect$1=class{constructor(or,ar){this._repo=or,this._path=ar}cancel(){const or=new Deferred;return repoOnDisconnectCancel(this._repo,this._path,or.wrapCallback(()=>{})),or.promise}remove(){validateWritablePath("OnDisconnect.remove",this._path);const or=new Deferred;return repoOnDisconnectSet(this._repo,this._path,null,or.wrapCallback(()=>{})),or.promise}set(or){validateWritablePath("OnDisconnect.set",this._path),validateFirebaseDataArg("OnDisconnect.set",or,this._path,!1);const ar=new Deferred;return repoOnDisconnectSet(this._repo,this._path,or,ar.wrapCallback(()=>{})),ar.promise}setWithPriority(or,ar){validateWritablePath("OnDisconnect.setWithPriority",this._path),validateFirebaseDataArg("OnDisconnect.setWithPriority",or,this._path,!1),validatePriority("OnDisconnect.setWithPriority",ar,!1);const cr=new Deferred;return repoOnDisconnectSetWithPriority(this._repo,this._path,or,ar,cr.wrapCallback(()=>{})),cr.promise}update(or){validateWritablePath("OnDisconnect.update",this._path),validateFirebaseMergeDataArg("OnDisconnect.update",or,this._path,!1);const ar=new Deferred;return repoOnDisconnectUpdate(this._repo,this._path,or,ar.wrapCallback(()=>{})),ar.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryImpl{constructor(or,ar,cr,ur){this._repo=or,this._path=ar,this._queryParams=cr,this._orderByCalled=ur}get key(){return pathIsEmpty(this._path)?null:pathGetBack(this._path)}get ref(){return new ReferenceImpl(this._repo,this._path)}get _queryIdentifier(){const or=queryParamsGetQueryObject(this._queryParams),ar=ObjectToUniqueKey(or);return ar==="{}"?"default":ar}get _queryObject(){return queryParamsGetQueryObject(this._queryParams)}isEqual(or){if(or=getModularInstance(or),!(or instanceof QueryImpl))return!1;const ar=this._repo===or._repo,cr=pathEquals(this._path,or._path),ur=this._queryIdentifier===or._queryIdentifier;return ar&&cr&&ur}toJSON(){return this.toString()}toString(){return this._repo.toString()+pathToUrlEncodedString(this._path)}}function validateNoPreviousOrderByCall(lr,or){if(lr._orderByCalled===!0)throw new Error(or+": You can't combine multiple orderBy calls.")}function validateQueryEndpoints(lr){let or=null,ar=null;if(lr.hasStart()&&(or=lr.getIndexStartValue()),lr.hasEnd()&&(ar=lr.getIndexEndValue()),lr.getIndex()===KEY_INDEX){const cr="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",ur="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(lr.hasStart()){if(lr.getIndexStartName()!==MIN_NAME)throw new Error(cr);if(typeof or!="string")throw new Error(ur)}if(lr.hasEnd()){if(lr.getIndexEndName()!==MAX_NAME)throw new Error(cr);if(typeof ar!="string")throw new Error(ur)}}else if(lr.getIndex()===PRIORITY_INDEX){if(or!=null&&!isValidPriority(or)||ar!=null&&!isValidPriority(ar))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(assert(lr.getIndex()instanceof PathIndex||lr.getIndex()===VALUE_INDEX,"unknown index type."),or!=null&&typeof or=="object"||ar!=null&&typeof ar=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function validateLimit(lr){if(lr.hasStart()&&lr.hasEnd()&&lr.hasLimit()&&!lr.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ReferenceImpl extends QueryImpl{constructor(or,ar){super(or,ar,new QueryParams,!1)}get parent(){const or=pathParent(this._path);return or===null?null:new ReferenceImpl(this._repo,or)}get root(){let or=this;for(;or.parent!==null;)or=or.parent;return or}}let DataSnapshot$1=class es{constructor(or,ar,cr){this._node=or,this.ref=ar,this._index=cr}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(or){const ar=new Path(or),cr=child(this.ref,or);return new es(this._node.getChild(ar),cr,PRIORITY_INDEX)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(or){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(cr,ur)=>or(new es(ur,child(this.ref,cr),PRIORITY_INDEX)))}hasChild(or){const ar=new Path(or);return!this._node.getChild(ar).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function ref(lr,or){return lr=getModularInstance(lr),lr._checkNotDeleted("ref"),or!==void 0?child(lr._root,or):lr._root}function refFromURL(lr,or){lr=getModularInstance(lr),lr._checkNotDeleted("refFromURL");const ar=parseRepoInfo(or,lr._repo.repoInfo_.nodeAdmin);validateUrl("refFromURL",ar);const cr=ar.repoInfo;return!lr._repo.repoInfo_.isCustomHost()&&cr.host!==lr._repo.repoInfo_.host&&fatal("refFromURL: Host name does not match the current database: (found "+cr.host+" but expected "+lr._repo.repoInfo_.host+")"),ref(lr,ar.path.toString())}function child(lr,or){return lr=getModularInstance(lr),pathGetFront(lr._path)===null?validateRootPathString("child","path",or,!1):validatePathString("child","path",or,!1),new ReferenceImpl(lr._repo,pathChild(lr._path,or))}function push(lr,or){lr=getModularInstance(lr),validateWritablePath("push",lr._path),validateFirebaseDataArg("push",or,lr._path,!0);const ar=repoServerTime(lr._repo),cr=nextPushId(ar),ur=child(lr,cr),hr=child(lr,cr);let fr;return or!=null?fr=set(hr,or).then(()=>hr):fr=Promise.resolve(hr),ur.then=fr.then.bind(fr),ur.catch=fr.then.bind(fr,void 0),ur}function remove(lr){return validateWritablePath("remove",lr._path),set(lr,null)}function set(lr,or){lr=getModularInstance(lr),validateWritablePath("set",lr._path),validateFirebaseDataArg("set",or,lr._path,!1);const ar=new Deferred;return repoSetWithPriority(lr._repo,lr._path,or,null,ar.wrapCallback(()=>{})),ar.promise}function setPriority(lr,or){lr=getModularInstance(lr),validateWritablePath("setPriority",lr._path),validatePriority("setPriority",or,!1);const ar=new Deferred;return repoSetWithPriority(lr._repo,pathChild(lr._path,".priority"),or,null,ar.wrapCallback(()=>{})),ar.promise}function setWithPriority(lr,or,ar){if(validateWritablePath("setWithPriority",lr._path),validateFirebaseDataArg("setWithPriority",or,lr._path,!1),validatePriority("setWithPriority",ar,!1),lr.key===".length"||lr.key===".keys")throw"setWithPriority failed: "+lr.key+" is a read-only object.";const cr=new Deferred;return repoSetWithPriority(lr._repo,lr._path,or,ar,cr.wrapCallback(()=>{})),cr.promise}function update$1(lr,or){validateFirebaseMergeDataArg("update",or,lr._path,!1);const ar=new Deferred;return repoUpdate(lr._repo,lr._path,or,ar.wrapCallback(()=>{})),ar.promise}function get(lr){lr=getModularInstance(lr);const or=new CallbackContext(()=>{}),ar=new ValueEventRegistration(or);return repoGetValue(lr._repo,lr,ar).then(cr=>new DataSnapshot$1(cr,new ReferenceImpl(lr._repo,lr._path),lr._queryParams.getIndex()))}class ValueEventRegistration{constructor(or){this.callbackContext=or}respondsTo(or){return or==="value"}createEvent(or,ar){const cr=ar._queryParams.getIndex();return new DataEvent("value",this,new DataSnapshot$1(or.snapshotNode,new ReferenceImpl(ar._repo,ar._path),cr))}getEventRunner(or){return or.getEventType()==="cancel"?()=>this.callbackContext.onCancel(or.error):()=>this.callbackContext.onValue(or.snapshot,null)}createCancelEvent(or,ar){return this.callbackContext.hasCancelCallback?new CancelEvent(this,or,ar):null}matches(or){return or instanceof ValueEventRegistration?!or.callbackContext||!this.callbackContext?!0:or.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class ChildEventRegistration{constructor(or,ar){this.eventType=or,this.callbackContext=ar}respondsTo(or){let ar=or==="children_added"?"child_added":or;return ar=ar==="children_removed"?"child_removed":ar,this.eventType===ar}createCancelEvent(or,ar){return this.callbackContext.hasCancelCallback?new CancelEvent(this,or,ar):null}createEvent(or,ar){assert(or.childName!=null,"Child events should have a childName.");const cr=child(new ReferenceImpl(ar._repo,ar._path),or.childName),ur=ar._queryParams.getIndex();return new DataEvent(or.type,this,new DataSnapshot$1(or.snapshotNode,cr,ur),or.prevName)}getEventRunner(or){return or.getEventType()==="cancel"?()=>this.callbackContext.onCancel(or.error):()=>this.callbackContext.onValue(or.snapshot,or.prevName)}matches(or){return or instanceof ChildEventRegistration?this.eventType===or.eventType&&(!this.callbackContext||!or.callbackContext||this.callbackContext.matches(or.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function addEventListener$1(lr,or,ar,cr,ur){let hr;if(typeof cr=="object"&&(hr=void 0,ur=cr),typeof cr=="function"&&(hr=cr),ur&&ur.onlyOnce){const pr=ar,mr=(gr,yr)=>{repoRemoveEventCallbackForQuery(lr._repo,lr,dr),pr(gr,yr)};mr.userCallback=ar.userCallback,mr.context=ar.context,ar=mr}const fr=new CallbackContext(ar,hr||void 0),dr=or==="value"?new ValueEventRegistration(fr):new ChildEventRegistration(or,fr);return repoAddEventCallbackForQuery(lr._repo,lr,dr),()=>repoRemoveEventCallbackForQuery(lr._repo,lr,dr)}function onValue(lr,or,ar,cr){return addEventListener$1(lr,"value",or,ar,cr)}function onChildAdded(lr,or,ar,cr){return addEventListener$1(lr,"child_added",or,ar,cr)}function onChildChanged(lr,or,ar,cr){return addEventListener$1(lr,"child_changed",or,ar,cr)}function onChildMoved(lr,or,ar,cr){return addEventListener$1(lr,"child_moved",or,ar,cr)}function onChildRemoved(lr,or,ar,cr){return addEventListener$1(lr,"child_removed",or,ar,cr)}function off(lr,or,ar){let cr=null;const ur=ar?new CallbackContext(ar):null;or==="value"?cr=new ValueEventRegistration(ur):or&&(cr=new ChildEventRegistration(or,ur)),repoRemoveEventCallbackForQuery(lr._repo,lr,cr)}class QueryConstraint{}class QueryEndAtConstraint extends QueryConstraint{constructor(or,ar){super(),this._value=or,this._key=ar}_apply(or){validateFirebaseDataArg("endAt",this._value,or._path,!0);const ar=queryParamsEndAt(or._queryParams,this._value,this._key);if(validateLimit(ar),validateQueryEndpoints(ar),or._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new QueryImpl(or._repo,or._path,ar,or._orderByCalled)}}function endAt(lr,or){return validateKey("endAt","key",or,!0),new QueryEndAtConstraint(lr,or)}class QueryEndBeforeConstraint extends QueryConstraint{constructor(or,ar){super(),this._value=or,this._key=ar}_apply(or){validateFirebaseDataArg("endBefore",this._value,or._path,!1);const ar=queryParamsEndBefore(or._queryParams,this._value,this._key);if(validateLimit(ar),validateQueryEndpoints(ar),or._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new QueryImpl(or._repo,or._path,ar,or._orderByCalled)}}function endBefore(lr,or){return validateKey("endBefore","key",or,!0),new QueryEndBeforeConstraint(lr,or)}class QueryStartAtConstraint extends QueryConstraint{constructor(or,ar){super(),this._value=or,this._key=ar}_apply(or){validateFirebaseDataArg("startAt",this._value,or._path,!0);const ar=queryParamsStartAt(or._queryParams,this._value,this._key);if(validateLimit(ar),validateQueryEndpoints(ar),or._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new QueryImpl(or._repo,or._path,ar,or._orderByCalled)}}function startAt(lr=null,or){return validateKey("startAt","key",or,!0),new QueryStartAtConstraint(lr,or)}class QueryStartAfterConstraint extends QueryConstraint{constructor(or,ar){super(),this._value=or,this._key=ar}_apply(or){validateFirebaseDataArg("startAfter",this._value,or._path,!1);const ar=queryParamsStartAfter(or._queryParams,this._value,this._key);if(validateLimit(ar),validateQueryEndpoints(ar),or._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new QueryImpl(or._repo,or._path,ar,or._orderByCalled)}}function startAfter(lr,or){return validateKey("startAfter","key",or,!0),new QueryStartAfterConstraint(lr,or)}class QueryLimitToFirstConstraint extends QueryConstraint{constructor(or){super(),this._limit=or}_apply(or){if(or._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new QueryImpl(or._repo,or._path,queryParamsLimitToFirst(or._queryParams,this._limit),or._orderByCalled)}}function limitToFirst(lr){if(typeof lr!="number"||Math.floor(lr)!==lr||lr<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new QueryLimitToFirstConstraint(lr)}class QueryLimitToLastConstraint extends QueryConstraint{constructor(or){super(),this._limit=or}_apply(or){if(or._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new QueryImpl(or._repo,or._path,queryParamsLimitToLast(or._queryParams,this._limit),or._orderByCalled)}}function limitToLast(lr){if(typeof lr!="number"||Math.floor(lr)!==lr||lr<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new QueryLimitToLastConstraint(lr)}class QueryOrderByChildConstraint extends QueryConstraint{constructor(or){super(),this._path=or}_apply(or){validateNoPreviousOrderByCall(or,"orderByChild");const ar=new Path(this._path);if(pathIsEmpty(ar))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const cr=new PathIndex(ar),ur=queryParamsOrderBy(or._queryParams,cr);return validateQueryEndpoints(ur),new QueryImpl(or._repo,or._path,ur,!0)}}function orderByChild(lr){if(lr==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(lr==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(lr==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return validatePathString("orderByChild","path",lr,!1),new QueryOrderByChildConstraint(lr)}class QueryOrderByKeyConstraint extends QueryConstraint{_apply(or){validateNoPreviousOrderByCall(or,"orderByKey");const ar=queryParamsOrderBy(or._queryParams,KEY_INDEX);return validateQueryEndpoints(ar),new QueryImpl(or._repo,or._path,ar,!0)}}function orderByKey(){return new QueryOrderByKeyConstraint}class QueryOrderByPriorityConstraint extends QueryConstraint{_apply(or){validateNoPreviousOrderByCall(or,"orderByPriority");const ar=queryParamsOrderBy(or._queryParams,PRIORITY_INDEX);return validateQueryEndpoints(ar),new QueryImpl(or._repo,or._path,ar,!0)}}function orderByPriority(){return new QueryOrderByPriorityConstraint}class QueryOrderByValueConstraint extends QueryConstraint{_apply(or){validateNoPreviousOrderByCall(or,"orderByValue");const ar=queryParamsOrderBy(or._queryParams,VALUE_INDEX);return validateQueryEndpoints(ar),new QueryImpl(or._repo,or._path,ar,!0)}}function orderByValue(){return new QueryOrderByValueConstraint}class QueryEqualToValueConstraint extends QueryConstraint{constructor(or,ar){super(),this._value=or,this._key=ar}_apply(or){if(validateFirebaseDataArg("equalTo",this._value,or._path,!1),or._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(or._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new QueryEndAtConstraint(this._value,this._key)._apply(new QueryStartAtConstraint(this._value,this._key)._apply(or))}}function equalTo(lr,or){return validateKey("equalTo","key",or,!0),new QueryEqualToValueConstraint(lr,or)}function query(lr,...or){let ar=getModularInstance(lr);for(const cr of or)ar=cr._apply(ar);return ar}syncPointSetReferenceConstructor(ReferenceImpl);syncTreeSetReferenceConstructor(ReferenceImpl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_DATABASE_EMULATOR_HOST_VAR="FIREBASE_DATABASE_EMULATOR_HOST",repos={};let useRestClient=!1;function repoManagerApplyEmulatorSettings(lr,or,ar,cr){lr.repoInfo_=new RepoInfo(`${or}:${ar}`,!1,lr.repoInfo_.namespace,lr.repoInfo_.webSocketOnly,lr.repoInfo_.nodeAdmin,lr.repoInfo_.persistenceKey,lr.repoInfo_.includeNamespaceInQueryParams,!0),cr&&(lr.authTokenProvider_=cr)}function repoManagerDatabaseFromApp(lr,or,ar,cr,ur){let hr=cr||lr.options.databaseURL;hr===void 0&&(lr.options.projectId||fatal("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),log("Using default host for project ",lr.options.projectId),hr=`${lr.options.projectId}-default-rtdb.firebaseio.com`);let fr=parseRepoInfo(hr,ur),dr=fr.repoInfo,pr,mr;typeof process<"u"&&process.env&&(mr=process.env[FIREBASE_DATABASE_EMULATOR_HOST_VAR]),mr?(pr=!0,hr=`http://${mr}?ns=${dr.namespace}`,fr=parseRepoInfo(hr,ur),dr=fr.repoInfo):pr=!fr.repoInfo.secure;const gr=ur&&pr?new EmulatorTokenProvider(EmulatorTokenProvider.OWNER):new FirebaseAuthTokenProvider(lr.name,lr.options,or);validateUrl("Invalid Firebase Database URL",fr),pathIsEmpty(fr.path)||fatal("Database URL must point to the root of a Firebase Database (not including a child path).");const yr=repoManagerCreateRepo(dr,lr,gr,new AppCheckTokenProvider(lr.name,ar));return new Database$1(yr,lr)}function repoManagerDeleteRepo(lr,or){const ar=repos[or];(!ar||ar[lr.key]!==lr)&&fatal(`Database ${or}(${lr.repoInfo_}) has already been deleted.`),repoInterrupt(lr),delete ar[lr.key]}function repoManagerCreateRepo(lr,or,ar,cr){let ur=repos[or.name];ur||(ur={},repos[or.name]=ur);let hr=ur[lr.toURLString()];return hr&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),hr=new Repo(lr,useRestClient,ar,cr),ur[lr.toURLString()]=hr,hr}let Database$1=class{constructor(or,ar){this._repoInternal=or,this.app=ar,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(repoStart(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ReferenceImpl(this._repo,newEmptyPath())),this._rootInternal}_delete(){return this._rootInternal!==null&&(repoManagerDeleteRepo(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(or){this._rootInternal===null&&fatal("Cannot call "+or+" on a deleted database.")}};function checkTransportInit(){TransportManager.IS_TRANSPORT_INITIALIZED&&warn$1("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function forceWebSockets(){checkTransportInit(),BrowserPollConnection.forceDisallow()}function forceLongPolling(){checkTransportInit(),WebSocketConnection.forceDisallow(),BrowserPollConnection.forceAllow()}function connectDatabaseEmulator(lr,or,ar,cr={}){lr=getModularInstance(lr),lr._checkNotDeleted("useEmulator"),lr._instanceStarted&&fatal("Cannot call useEmulator() after instance has already been initialized.");const ur=lr._repoInternal;let hr;if(ur.repoInfo_.nodeAdmin)cr.mockUserToken&&fatal('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),hr=new EmulatorTokenProvider(EmulatorTokenProvider.OWNER);else if(cr.mockUserToken){const fr=typeof cr.mockUserToken=="string"?cr.mockUserToken:createMockUserToken(cr.mockUserToken,lr.app.options.projectId);hr=new EmulatorTokenProvider(fr)}repoManagerApplyEmulatorSettings(ur,or,ar,hr)}function goOffline(lr){lr=getModularInstance(lr),lr._checkNotDeleted("goOffline"),repoInterrupt(lr._repo)}function goOnline(lr){lr=getModularInstance(lr),lr._checkNotDeleted("goOnline"),repoResume(lr._repo)}function enableLogging(lr,or){enableLogging$1(lr,or)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerDatabase$1(lr){setSDKVersion(SDK_VERSION$1),_registerComponent(new Component("database",(or,{instanceIdentifier:ar})=>{const cr=or.getProvider("app").getImmediate(),ur=or.getProvider("auth-internal"),hr=or.getProvider("app-check-internal");return repoManagerDatabaseFromApp(cr,ur,hr,ar)},"PUBLIC").setMultipleInstances(!0)),registerVersion(name$2,version$2,lr),registerVersion(name$2,version$2,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_TIMESTAMP={".sv":"timestamp"};function serverTimestamp(){return SERVER_TIMESTAMP}function increment(lr){return{".sv":{increment:lr}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TransactionResult$1=class{constructor(or,ar){this.committed=or,this.snapshot=ar}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function runTransaction(lr,or,ar){var cr;if(lr=getModularInstance(lr),validateWritablePath("Reference.transaction",lr._path),lr.key===".length"||lr.key===".keys")throw"Reference.transaction failed: "+lr.key+" is a read-only object.";const ur=(cr=ar==null?void 0:ar.applyLocally)!==null&&cr!==void 0?cr:!0,hr=new Deferred,fr=(pr,mr,gr)=>{let yr=null;pr?hr.reject(pr):(yr=new DataSnapshot$1(gr,new ReferenceImpl(lr._repo,lr._path),PRIORITY_INDEX),hr.resolve(new TransactionResult$1(mr,yr)))},dr=onValue(lr,()=>{});return repoStartTransaction(lr._repo,lr._path,or,fr,dr,ur),hr.promise}PersistentConnection.prototype.simpleListen=function(lr,or){this.sendRequest("q",{p:lr},or)};PersistentConnection.prototype.echo=function(lr,or){this.sendRequest("echo",{d:lr},or)};registerDatabase$1();const name$1="@firebase/database-compat",version$1="0.3.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/database-compat"),warn=function(lr){const or="FIREBASE WARNING: "+lr;logClient.warn(or)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const validateBoolean=function(lr,or,ar,cr){if(!(cr&&ar===void 0)&&typeof ar!="boolean")throw new Error(errorPrefix(lr,or)+"must be a boolean.")},validateEventType=function(lr,or,ar){if(!(ar&&or===void 0))switch(or){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(errorPrefix(lr,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OnDisconnect{constructor(or){this._delegate=or}cancel(or){validateArgCount("OnDisconnect.cancel",0,1,arguments.length),validateCallback("OnDisconnect.cancel","onComplete",or,!0);const ar=this._delegate.cancel();return or&&ar.then(()=>or(null),cr=>or(cr)),ar}remove(or){validateArgCount("OnDisconnect.remove",0,1,arguments.length),validateCallback("OnDisconnect.remove","onComplete",or,!0);const ar=this._delegate.remove();return or&&ar.then(()=>or(null),cr=>or(cr)),ar}set(or,ar){validateArgCount("OnDisconnect.set",1,2,arguments.length),validateCallback("OnDisconnect.set","onComplete",ar,!0);const cr=this._delegate.set(or);return ar&&cr.then(()=>ar(null),ur=>ar(ur)),cr}setWithPriority(or,ar,cr){validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),validateCallback("OnDisconnect.setWithPriority","onComplete",cr,!0);const ur=this._delegate.setWithPriority(or,ar);return cr&&ur.then(()=>cr(null),hr=>cr(hr)),ur}update(or,ar){if(validateArgCount("OnDisconnect.update",1,2,arguments.length),Array.isArray(or)){const ur={};for(let hr=0;hr<or.length;++hr)ur[""+hr]=or[hr];or=ur,warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateCallback("OnDisconnect.update","onComplete",ar,!0);const cr=this._delegate.update(or);return ar&&cr.then(()=>ar(null),ur=>ar(ur)),cr}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransactionResult{constructor(or,ar){this.committed=or,this.snapshot=ar}toJSON(){return validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DataSnapshot{constructor(or,ar){this._database=or,this._delegate=ar}val(){return validateArgCount("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return validateArgCount("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(or){return validateArgCount("DataSnapshot.child",0,1,arguments.length),or=String(or),validatePathString("DataSnapshot.child","path",or,!1),new DataSnapshot(this._database,this._delegate.child(or))}hasChild(or){return validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),validatePathString("DataSnapshot.hasChild","path",or,!1),this._delegate.hasChild(or)}getPriority(){return validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(or){return validateArgCount("DataSnapshot.forEach",1,1,arguments.length),validateCallback("DataSnapshot.forEach","action",or,!1),this._delegate.forEach(ar=>or(new DataSnapshot(this._database,ar)))}hasChildren(){return validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return validateArgCount("DataSnapshot.ref",0,0,arguments.length),new Reference(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Query{constructor(or,ar){this.database=or,this._delegate=ar}on(or,ar,cr,ur){var hr;validateArgCount("Query.on",2,4,arguments.length),validateCallback("Query.on","callback",ar,!1);const fr=Query.getCancelAndContextArgs_("Query.on",cr,ur),dr=(mr,gr)=>{ar.call(fr.context,new DataSnapshot(this.database,mr),gr)};dr.userCallback=ar,dr.context=fr.context;const pr=(hr=fr.cancel)===null||hr===void 0?void 0:hr.bind(fr.context);switch(or){case"value":return onValue(this._delegate,dr,pr),ar;case"child_added":return onChildAdded(this._delegate,dr,pr),ar;case"child_removed":return onChildRemoved(this._delegate,dr,pr),ar;case"child_changed":return onChildChanged(this._delegate,dr,pr),ar;case"child_moved":return onChildMoved(this._delegate,dr,pr),ar;default:throw new Error(errorPrefix("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(or,ar,cr){if(validateArgCount("Query.off",0,3,arguments.length),validateEventType("Query.off",or,!0),validateCallback("Query.off","callback",ar,!0),validateContextObject("Query.off","context",cr,!0),ar){const ur=()=>{};ur.userCallback=ar,ur.context=cr,off(this._delegate,or,ur)}else off(this._delegate,or)}get(){return get(this._delegate).then(or=>new DataSnapshot(this.database,or))}once(or,ar,cr,ur){validateArgCount("Query.once",1,4,arguments.length),validateCallback("Query.once","callback",ar,!0);const hr=Query.getCancelAndContextArgs_("Query.once",cr,ur),fr=new Deferred,dr=(mr,gr)=>{const yr=new DataSnapshot(this.database,mr);ar&&ar.call(hr.context,yr,gr),fr.resolve(yr)};dr.userCallback=ar,dr.context=hr.context;const pr=mr=>{hr.cancel&&hr.cancel.call(hr.context,mr),fr.reject(mr)};switch(or){case"value":onValue(this._delegate,dr,pr,{onlyOnce:!0});break;case"child_added":onChildAdded(this._delegate,dr,pr,{onlyOnce:!0});break;case"child_removed":onChildRemoved(this._delegate,dr,pr,{onlyOnce:!0});break;case"child_changed":onChildChanged(this._delegate,dr,pr,{onlyOnce:!0});break;case"child_moved":onChildMoved(this._delegate,dr,pr,{onlyOnce:!0});break;default:throw new Error(errorPrefix("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return fr.promise}limitToFirst(or){return validateArgCount("Query.limitToFirst",1,1,arguments.length),new Query(this.database,query(this._delegate,limitToFirst(or)))}limitToLast(or){return validateArgCount("Query.limitToLast",1,1,arguments.length),new Query(this.database,query(this._delegate,limitToLast(or)))}orderByChild(or){return validateArgCount("Query.orderByChild",1,1,arguments.length),new Query(this.database,query(this._delegate,orderByChild(or)))}orderByKey(){return validateArgCount("Query.orderByKey",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByKey()))}orderByPriority(){return validateArgCount("Query.orderByPriority",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByPriority()))}orderByValue(){return validateArgCount("Query.orderByValue",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByValue()))}startAt(or=null,ar){return validateArgCount("Query.startAt",0,2,arguments.length),new Query(this.database,query(this._delegate,startAt(or,ar)))}startAfter(or=null,ar){return validateArgCount("Query.startAfter",0,2,arguments.length),new Query(this.database,query(this._delegate,startAfter(or,ar)))}endAt(or=null,ar){return validateArgCount("Query.endAt",0,2,arguments.length),new Query(this.database,query(this._delegate,endAt(or,ar)))}endBefore(or=null,ar){return validateArgCount("Query.endBefore",0,2,arguments.length),new Query(this.database,query(this._delegate,endBefore(or,ar)))}equalTo(or,ar){return validateArgCount("Query.equalTo",1,2,arguments.length),new Query(this.database,query(this._delegate,equalTo(or,ar)))}toString(){return validateArgCount("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return validateArgCount("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(or){if(validateArgCount("Query.isEqual",1,1,arguments.length),!(or instanceof Query)){const ar="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(ar)}return this._delegate.isEqual(or._delegate)}static getCancelAndContextArgs_(or,ar,cr){const ur={cancel:void 0,context:void 0};if(ar&&cr)ur.cancel=ar,validateCallback(or,"cancel",ur.cancel,!0),ur.context=cr,validateContextObject(or,"context",ur.context,!0);else if(ar)if(typeof ar=="object"&&ar!==null)ur.context=ar;else if(typeof ar=="function")ur.cancel=ar;else throw new Error(errorPrefix(or,"cancelOrContext")+" must either be a cancel callback or a context object.");return ur}get ref(){return new Reference(this.database,new ReferenceImpl(this._delegate._repo,this._delegate._path))}}class Reference extends Query{constructor(or,ar){super(or,new QueryImpl(ar._repo,ar._path,new QueryParams,!1)),this.database=or,this._delegate=ar}getKey(){return validateArgCount("Reference.key",0,0,arguments.length),this._delegate.key}child(or){return validateArgCount("Reference.child",1,1,arguments.length),typeof or=="number"&&(or=String(or)),new Reference(this.database,child(this._delegate,or))}getParent(){validateArgCount("Reference.parent",0,0,arguments.length);const or=this._delegate.parent;return or?new Reference(this.database,or):null}getRoot(){return validateArgCount("Reference.root",0,0,arguments.length),new Reference(this.database,this._delegate.root)}set(or,ar){validateArgCount("Reference.set",1,2,arguments.length),validateCallback("Reference.set","onComplete",ar,!0);const cr=set(this._delegate,or);return ar&&cr.then(()=>ar(null),ur=>ar(ur)),cr}update(or,ar){if(validateArgCount("Reference.update",1,2,arguments.length),Array.isArray(or)){const ur={};for(let hr=0;hr<or.length;++hr)ur[""+hr]=or[hr];or=ur,warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateWritablePath("Reference.update",this._delegate._path),validateCallback("Reference.update","onComplete",ar,!0);const cr=update$1(this._delegate,or);return ar&&cr.then(()=>ar(null),ur=>ar(ur)),cr}setWithPriority(or,ar,cr){validateArgCount("Reference.setWithPriority",2,3,arguments.length),validateCallback("Reference.setWithPriority","onComplete",cr,!0);const ur=setWithPriority(this._delegate,or,ar);return cr&&ur.then(()=>cr(null),hr=>cr(hr)),ur}remove(or){validateArgCount("Reference.remove",0,1,arguments.length),validateCallback("Reference.remove","onComplete",or,!0);const ar=remove(this._delegate);return or&&ar.then(()=>or(null),cr=>or(cr)),ar}transaction(or,ar,cr){validateArgCount("Reference.transaction",1,3,arguments.length),validateCallback("Reference.transaction","transactionUpdate",or,!1),validateCallback("Reference.transaction","onComplete",ar,!0),validateBoolean("Reference.transaction","applyLocally",cr,!0);const ur=runTransaction(this._delegate,or,{applyLocally:cr}).then(hr=>new TransactionResult(hr.committed,new DataSnapshot(this.database,hr.snapshot)));return ar&&ur.then(hr=>ar(null,hr.committed,hr.snapshot),hr=>ar(hr,!1,null)),ur}setPriority(or,ar){validateArgCount("Reference.setPriority",1,2,arguments.length),validateCallback("Reference.setPriority","onComplete",ar,!0);const cr=setPriority(this._delegate,or);return ar&&cr.then(()=>ar(null),ur=>ar(ur)),cr}push(or,ar){validateArgCount("Reference.push",0,2,arguments.length),validateCallback("Reference.push","onComplete",ar,!0);const cr=push(this._delegate,or),ur=cr.then(fr=>new Reference(this.database,fr));ar&&ur.then(()=>ar(null),fr=>ar(fr));const hr=new Reference(this.database,cr);return hr.then=ur.then.bind(ur),hr.catch=ur.catch.bind(ur,void 0),hr}onDisconnect(){return validateWritablePath("Reference.onDisconnect",this._delegate._path),new OnDisconnect(new OnDisconnect$1(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Database{constructor(or,ar){this._delegate=or,this.app=ar,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets,forceLongPolling}}useEmulator(or,ar,cr={}){connectDatabaseEmulator(this._delegate,or,ar,cr)}ref(or){if(validateArgCount("database.ref",0,1,arguments.length),or instanceof Reference){const ar=refFromURL(this._delegate,or.toString());return new Reference(this,ar)}else{const ar=ref(this._delegate,or);return new Reference(this,ar)}}refFromURL(or){validateArgCount("database.refFromURL",1,1,arguments.length);const cr=refFromURL(this._delegate,or);return new Reference(this,cr)}goOffline(){return validateArgCount("database.goOffline",0,0,arguments.length),goOffline(this._delegate)}goOnline(){return validateArgCount("database.goOnline",0,0,arguments.length),goOnline(this._delegate)}}Database.ServerValue={TIMESTAMP:serverTimestamp(),increment:lr=>increment(lr)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initStandalone({app:lr,url:or,version:ar,customAuthImpl:cr,namespace:ur,nodeAdmin:hr=!1}){setSDKVersion(ar);const fr=new Provider("auth-internal",new ComponentContainer("database-standalone"));return fr.setComponent(new Component("auth-internal",()=>cr,"PRIVATE")),{instance:new Database(repoManagerDatabaseFromApp(lr,fr,void 0,or,hr),lr),namespace:ur}}var INTERNAL=Object.freeze({__proto__:null,initStandalone});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ServerValue=Database.ServerValue;function registerDatabase(lr){lr.INTERNAL.registerComponent(new Component("database-compat",(or,{instanceIdentifier:ar})=>{const cr=or.getProvider("app-compat").getImmediate(),ur=or.getProvider("database").getImmediate({identifier:ar});return new Database(ur,cr)},"PUBLIC").setServiceProps({Reference,Query,Database,DataSnapshot,enableLogging,INTERNAL,ServerValue}).setMultipleInstances(!0)),lr.registerVersion(name$1,version$1)}registerDatabase(firebase);const utils={};utils.makeEventEmitter=function(lr,or){lr.prototype.allowedEvents_=or,lr.prototype.on=function(ar,cr,ur){this.validateEventType_(ar),this.eventListeners_=this.eventListeners_||{},this.eventListeners_[ar]=this.eventListeners_[ar]||[],this.eventListeners_[ar].push({callback:cr,context:ur})},lr.prototype.off=function(ar,cr){this.validateEventType_(ar),this.eventListeners_=this.eventListeners_||{};for(var ur=this.eventListeners_[ar]||[],hr=0;hr<ur.length;hr++)if(ur[hr].callback===cr){ur.splice(hr,1);return}},lr.prototype.trigger=function(ar){this.eventListeners_=this.eventListeners_||{};for(var cr=this.eventListeners_[ar]||[],ur=0;ur<cr.length;ur++)cr[ur].callback.apply(cr[ur].context,Array.prototype.slice.call(arguments,1))},lr.prototype.validateEventType_=function(ar){if(this.allowedEvents_){for(var cr=!1,ur=0;ur<this.allowedEvents_.length;ur++)if(this.allowedEvents_[ur]===ar){cr=!0;break}if(!cr)throw new Error('Unknown event "'+ar+'"')}}};utils.elt=function(lr,or,ar){var cr=document.createElement(lr);if(typeof or=="string")utils.setTextContent(cr,or);else if(or)for(var ur=0;ur<or.length;++ur)cr.appendChild(or[ur]);for(var hr in ar||{})cr.setAttribute(hr,ar[hr]);return cr};utils.setTextContent=function(lr,or){lr.innerHTML="",lr.appendChild(document.createTextNode(or))};utils.on=function(lr,or,ar,cr){lr.addEventListener?lr.addEventListener(or,ar,cr||!1):lr.attachEvent&&lr.attachEvent("on"+or,ar)};utils.off=function(lr,or,ar,cr){lr.removeEventListener?lr.removeEventListener(or,ar,cr||!1):lr.detachEvent&&lr.detachEvent("on"+or,ar)};utils.preventDefault=function(lr){lr.preventDefault?lr.preventDefault():lr.returnValue=!1};utils.stopPropagation=function(lr){lr.stopPropagation?lr.stopPropagation():lr.cancelBubble=!0};utils.stopEvent=function(lr){utils.preventDefault(lr),utils.stopPropagation(lr)};utils.stopEventAnd=function(lr){return function(or){return lr(or),utils.stopEvent(or),!1}};utils.trim=function(lr){return lr.replace(/^\s+/g,"").replace(/\s+$/g,"")};utils.stringEndsWith=function(lr,or){for(var ar=typeof or=="string"?[or]:or,cr=0;cr<ar.length;cr++){var or=ar[cr];if(lr.indexOf(or,lr.length-or.length)!==-1)return!0}return!1};utils.assert=function(or,ar){if(!or)throw new Error(ar||"assertion error")};utils.log=function(){if(typeof console<"u"&&typeof console.log<"u"){for(var lr=["Firepad:"],or=0;or<arguments.length;or++)lr.push(arguments[or]);console.log.apply(console,lr)}};const TextOp=function(){function lr(or){this.type=or,this.chars=null,this.text=null,this.attributes=null,or==="insert"?(this.text=arguments[1],utils.assert(typeof this.text=="string"),this.attributes=arguments[2]||{},utils.assert(typeof this.attributes=="object")):or==="delete"?(this.chars=arguments[1],utils.assert(typeof this.chars=="number")):or==="retain"&&(this.chars=arguments[1],utils.assert(typeof this.chars=="number"),this.attributes=arguments[2]||{},utils.assert(typeof this.attributes=="object"))}return lr.prototype.isInsert=function(){return this.type==="insert"},lr.prototype.isDelete=function(){return this.type==="delete"},lr.prototype.isRetain=function(){return this.type==="retain"},lr.prototype.equals=function(or){return this.type===or.type&&this.text===or.text&&this.chars===or.chars&&this.attributesEqual(or.attributes)},lr.prototype.attributesEqual=function(or){for(var ar in this.attributes)if(this.attributes[ar]!==or[ar])return!1;for(ar in or)if(this.attributes[ar]!==or[ar])return!1;return!0},lr.prototype.hasEmptyAttributes=function(){var or=!0;for(var ar in this.attributes){or=!1;break}return or},lr}(),TextOperation=function(){function lr(){if(!this||this.constructor!==lr)return new lr;this.ops=[],this.baseLength=0,this.targetLength=0}lr.prototype.equals=function(cr){if(this.baseLength!==cr.baseLength||this.targetLength!==cr.targetLength||this.ops.length!==cr.ops.length)return!1;for(var ur=0;ur<this.ops.length;ur++)if(!this.ops[ur].equals(cr.ops[ur]))return!1;return!0},lr.prototype.retain=function(cr,ur){if(typeof cr!="number"||cr<0)throw new Error("retain expects a positive integer.");if(cr===0)return this;this.baseLength+=cr,this.targetLength+=cr,ur=ur||{};var hr=this.ops.length>0?this.ops[this.ops.length-1]:null;return hr&&hr.isRetain()&&hr.attributesEqual(ur)?hr.chars+=cr:this.ops.push(new TextOp("retain",cr,ur)),this},lr.prototype.insert=function(cr,ur){if(typeof cr!="string")throw new Error("insert expects a string");if(cr==="")return this;ur=ur||{},this.targetLength+=cr.length;var hr=this.ops.length>0?this.ops[this.ops.length-1]:null,fr=this.ops.length>1?this.ops[this.ops.length-2]:null;return hr&&hr.isInsert()&&hr.attributesEqual(ur)?hr.text+=cr:hr&&hr.isDelete()?fr&&fr.isInsert()&&fr.attributesEqual(ur)?fr.text+=cr:(this.ops[this.ops.length-1]=new TextOp("insert",cr,ur),this.ops.push(hr)):this.ops.push(new TextOp("insert",cr,ur)),this},lr.prototype.delete=function(cr){if(typeof cr=="string"&&(cr=cr.length),typeof cr!="number"||cr<0)throw new Error("delete expects a positive integer or a string");if(cr===0)return this;this.baseLength+=cr;var ur=this.ops.length>0?this.ops[this.ops.length-1]:null;return ur&&ur.isDelete()?ur.chars+=cr:this.ops.push(new TextOp("delete",cr)),this},lr.prototype.isNoop=function(){return this.ops.length===0||this.ops.length===1&&this.ops[0].isRetain()&&this.ops[0].hasEmptyAttributes()},lr.prototype.clone=function(){for(var cr=new lr,ur=0;ur<this.ops.length;ur++)this.ops[ur].isRetain()?cr.retain(this.ops[ur].chars,this.ops[ur].attributes):this.ops[ur].isInsert()?cr.insert(this.ops[ur].text,this.ops[ur].attributes):cr.delete(this.ops[ur].chars);return cr},lr.prototype.toString=function(){var cr=Array.prototype.map||function(ur){for(var hr=this,fr=[],dr=0,pr=hr.length;dr<pr;dr++)fr[dr]=ur(hr[dr]);return fr};return cr.call(this.ops,function(ur){return ur.isRetain()?"retain "+ur.chars:ur.isInsert()?"insert '"+ur.text+"'":"delete "+ur.chars}).join(", ")},lr.prototype.toJSON=function(){for(var cr=[],ur=0;ur<this.ops.length;ur++)this.ops[ur].hasEmptyAttributes()||cr.push(this.ops[ur].attributes),this.ops[ur].type==="retain"?cr.push(this.ops[ur].chars):this.ops[ur].type==="insert"?cr.push(this.ops[ur].text):this.ops[ur].type==="delete"&&cr.push(-this.ops[ur].chars);return cr.length===0&&cr.push(0),cr},lr.fromJSON=function(cr){for(var ur=new lr,hr=0,fr=cr.length;hr<fr;hr++){var dr=cr[hr],pr={};typeof dr=="object"&&(pr=dr,hr++,dr=cr[hr]),typeof dr=="number"?dr>0?ur.retain(dr,pr):ur.delete(-dr):(utils.assert(typeof dr=="string"),ur.insert(dr,pr))}return ur},lr.prototype.apply=function(cr,ur,hr){var fr=this;if(ur=ur||[],hr=hr||[],cr.length!==fr.baseLength)throw new Error("The operation's base length must be equal to the string's length.");for(var dr=[],pr=0,mr,gr,yr=0,br=this.ops,Or=0,_r=br.length;Or<_r;Or++){var vr=br[Or];if(vr.isRetain()){if(yr+vr.chars>cr.length)throw new Error("Operation can't retain more characters than are left in the string.");for(dr[pr++]=cr.slice(yr,yr+vr.chars),mr=0;mr<vr.chars;mr++){var xr=ur[yr+mr]||{},wr={};for(gr in xr)wr[gr]=xr[gr],utils.assert(wr[gr]!==!1);for(gr in vr.attributes)vr.attributes[gr]===!1?delete wr[gr]:wr[gr]=vr.attributes[gr],utils.assert(wr[gr]!==!1);hr.push(wr)}yr+=vr.chars}else if(vr.isInsert())for(dr[pr++]=vr.text,mr=0;mr<vr.text.length;mr++){var kr={};for(gr in vr.attributes)kr[gr]=vr.attributes[gr],utils.assert(kr[gr]!==!1);hr.push(kr)}else yr+=vr.chars}if(yr!==cr.length)throw new Error("The operation didn't operate on the whole string.");var Cr=dr.join("");return utils.assert(Cr.length===hr.length),Cr},lr.prototype.invert=function(cr){for(var ur=0,hr=new lr,fr=this.ops,dr=0,pr=fr.length;dr<pr;dr++){var mr=fr[dr];mr.isRetain()?(hr.retain(mr.chars),ur+=mr.chars):mr.isInsert()?hr.delete(mr.text.length):(hr.insert(cr.slice(ur,ur+mr.chars)),ur+=mr.chars)}return hr},lr.prototype.compose=function(cr){var ur=this;if(ur.targetLength!==cr.baseLength)throw new Error("The base length of the second operation has to be the target length of the first operation");function hr(_r,vr,xr){var wr={},kr;for(kr in _r)wr[kr]=_r[kr];for(kr in vr)xr&&vr[kr]===!1?delete wr[kr]:wr[kr]=vr[kr];return wr}for(var fr=new lr,dr=ur.clone().ops,pr=cr.clone().ops,mr=0,gr=0,yr=dr[mr++],br=pr[gr++],Or;!(typeof yr>"u"&&typeof br>"u");){if(yr&&yr.isDelete()){fr.delete(yr.chars),yr=dr[mr++];continue}if(br&&br.isInsert()){fr.insert(br.text,br.attributes),br=pr[gr++];continue}if(typeof yr>"u")throw new Error("Cannot compose operations: first operation is too short.");if(typeof br>"u")throw new Error("Cannot compose operations: first operation is too long.");if(yr.isRetain()&&br.isRetain())Or=hr(yr.attributes,br.attributes),yr.chars>br.chars?(fr.retain(br.chars,Or),yr.chars-=br.chars,br=pr[gr++]):yr.chars===br.chars?(fr.retain(yr.chars,Or),yr=dr[mr++],br=pr[gr++]):(fr.retain(yr.chars,Or),br.chars-=yr.chars,yr=dr[mr++]);else if(yr.isInsert()&&br.isDelete())yr.text.length>br.chars?(yr.text=yr.text.slice(br.chars),br=pr[gr++]):yr.text.length===br.chars?(yr=dr[mr++],br=pr[gr++]):(br.chars-=yr.text.length,yr=dr[mr++]);else if(yr.isInsert()&&br.isRetain())Or=hr(yr.attributes,br.attributes,!0),yr.text.length>br.chars?(fr.insert(yr.text.slice(0,br.chars),Or),yr.text=yr.text.slice(br.chars),br=pr[gr++]):yr.text.length===br.chars?(fr.insert(yr.text,Or),yr=dr[mr++],br=pr[gr++]):(fr.insert(yr.text,Or),br.chars-=yr.text.length,yr=dr[mr++]);else if(yr.isRetain()&&br.isDelete())yr.chars>br.chars?(fr.delete(br.chars),yr.chars-=br.chars,br=pr[gr++]):yr.chars===br.chars?(fr.delete(br.chars),yr=dr[mr++],br=pr[gr++]):(fr.delete(yr.chars),br.chars-=yr.chars,yr=dr[mr++]);else throw new Error("This shouldn't happen: op1: "+JSON.stringify(yr)+", op2: "+JSON.stringify(br))}return fr};function or(cr){var ur=cr.ops;switch(ur.length){case 1:return ur[0];case 2:return ur[0].isRetain()?ur[1]:ur[1].isRetain()?ur[0]:null;case 3:if(ur[0].isRetain()&&ur[2].isRetain())return ur[1]}return null}function ar(cr){return cr.ops[0].isRetain()?cr.ops[0].chars:0}return lr.prototype.shouldBeComposedWith=function(cr){if(this.isNoop()||cr.isNoop())return!0;var ur=ar(this),hr=ar(cr),fr=or(this),dr=or(cr);return!fr||!dr?!1:fr.isInsert()&&dr.isInsert()?ur+fr.text.length===hr:fr.isDelete()&&dr.isDelete()?hr+dr.chars===ur||ur===hr:!1},lr.prototype.shouldBeComposedWithInverted=function(cr){if(this.isNoop()||cr.isNoop())return!0;var ur=ar(this),hr=ar(cr),fr=or(this),dr=or(cr);return!fr||!dr?!1:fr.isInsert()&&dr.isInsert()?ur+fr.text.length===hr||ur===hr:fr.isDelete()&&dr.isDelete()?hr+dr.chars===ur:!1},lr.transformAttributes=function(cr,ur){var hr={},fr={},dr,pr={};for(dr in cr)pr[dr]=!0;for(dr in ur)pr[dr]=!0;for(dr in pr){var mr=cr[dr],gr=ur[dr];utils.assert(mr!=null||gr!=null),mr==null?fr[dr]=gr:gr==null?hr[dr]=mr:mr===gr||(hr[dr]=mr)}return[hr,fr]},lr.transform=function(cr,ur){if(cr.baseLength!==ur.baseLength)throw new Error("Both operations have to have the same base length");for(var hr=new lr,fr=new lr,dr=cr.clone().ops,pr=ur.clone().ops,mr=0,gr=0,yr=dr[mr++],br=pr[gr++];!(typeof yr>"u"&&typeof br>"u");){if(yr&&yr.isInsert()){hr.insert(yr.text,yr.attributes),fr.retain(yr.text.length),yr=dr[mr++];continue}if(br&&br.isInsert()){hr.retain(br.text.length),fr.insert(br.text,br.attributes),br=pr[gr++];continue}if(typeof yr>"u")throw new Error("Cannot transform operations: first operation is too short.");if(typeof br>"u")throw new Error("Cannot transform operations: first operation is too long.");var Or;if(yr.isRetain()&&br.isRetain()){var _r=lr.transformAttributes(yr.attributes,br.attributes);yr.chars>br.chars?(Or=br.chars,yr.chars-=br.chars,br=pr[gr++]):yr.chars===br.chars?(Or=br.chars,yr=dr[mr++],br=pr[gr++]):(Or=yr.chars,br.chars-=yr.chars,yr=dr[mr++]),hr.retain(Or,_r[0]),fr.retain(Or,_r[1])}else if(yr.isDelete()&&br.isDelete())yr.chars>br.chars?(yr.chars-=br.chars,br=pr[gr++]):yr.chars===br.chars?(yr=dr[mr++],br=pr[gr++]):(br.chars-=yr.chars,yr=dr[mr++]);else if(yr.isDelete()&&br.isRetain())yr.chars>br.chars?(Or=br.chars,yr.chars-=br.chars,br=pr[gr++]):yr.chars===br.chars?(Or=br.chars,yr=dr[mr++],br=pr[gr++]):(Or=yr.chars,br.chars-=yr.chars,yr=dr[mr++]),hr.delete(Or);else if(yr.isRetain()&&br.isDelete())yr.chars>br.chars?(Or=br.chars,yr.chars-=br.chars,br=pr[gr++]):yr.chars===br.chars?(Or=yr.chars,yr=dr[mr++],br=pr[gr++]):(Or=yr.chars,br.chars-=yr.chars,yr=dr[mr++]),fr.delete(Or);else throw new Error("The two operations aren't compatible")}return[hr,fr]},lr.prototype.transform=function(cr){return lr.transform(this,cr)},lr}(),FirebaseAdapter=function(lr){var or=100;function ar(dr,pr,mr){this.ref_=dr,this.ready_=!1,this.firebaseCallbacks_=[],this.zombie_=!1,this.document_=new TextOperation,this.revision_=0,this.pendingReceivedRevisions_={};var gr=this;if(pr){this.setUserId(pr),this.setColor(mr);var yr=dr.root.child(".info/connected");this.firebaseOn_(yr,"value",function(br){br.val()===!0&&gr.initializeUserData_()},this),this.on("ready",function(){gr.monitorCursors_()})}else this.userId_=dr.push().key;setTimeout(function(){gr.monitorHistory_()},0)}utils.makeEventEmitter(ar,["ready","cursor","operation","ack","retry"]),ar.prototype.dispose=function(){var dr=this;if(this.removeFirebaseCallbacks_(),this.handleInitialRevisions_=()=>{},!this.ready_){this.on("ready",function(){dr.dispose()});return}this.userRef_&&(this.userRef_.child("cursor").remove(),this.userRef_.child("color").remove()),this.ref_=null,this.document_=null,this.zombie_=!0},ar.prototype.setUserId=function(dr){this.userRef_&&(this.userRef_.child("cursor").remove(),this.userRef_.child("cursor").onDisconnect().cancel(),this.userRef_.child("color").remove(),this.userRef_.child("color").onDisconnect().cancel()),this.userId_=dr,this.userRef_=this.ref_.child("users").child(dr),this.initializeUserData_()},ar.prototype.isHistoryEmpty=function(){return cr(this.ready_,"Not ready yet."),this.revision_===0},ar.prototype.sendOperation=function(dr,pr){var mr=this;if(!this.ready_){this.on("ready",function(){mr.trigger("retry")});return}cr(this.document_.targetLength===dr.baseLength,"sendOperation() called with invalid operation.");var gr=hr(this.revision_);function yr(br,Or){mr.ref_.child("history").child(br).transaction(function(_r){if(_r===null)return Or},function(_r,vr,xr){if(_r)if(_r.message==="disconnect")mr.sent_&&mr.sent_.id===br?setTimeout(function(){yr(br,Or)},0):pr&&pr(_r,!1);else throw utils.log("Transaction failure!",_r),_r;else pr&&pr(null,vr)},!1)}this.sent_={id:gr,op:dr},yr(gr,{a:mr.userId_,o:dr.toJSON(),t:firebase.database.ServerValue.TIMESTAMP})},ar.prototype.sendCursor=function(dr){this.userRef_.child("cursor").set(dr),this.cursor_=dr},ar.prototype.setColor=function(dr){this.userRef_.child("color").set(dr),this.color_=dr},ar.prototype.getDocument=function(){return this.document_},ar.prototype.registerCallbacks=function(dr){for(var pr in dr)this.on(pr,dr[pr])},ar.prototype.initializeUserData_=function(){this.userRef_.child("cursor").onDisconnect().remove(),this.userRef_.child("color").onDisconnect().remove(),this.sendCursor(this.cursor_||null),this.setColor(this.color_||null)},ar.prototype.monitorCursors_=function(){var dr=this.ref_.child("users"),pr=this;function mr(gr){var yr=gr.key,br=gr.val();pr.trigger("cursor",yr,br.cursor,br.color)}this.firebaseOn_(dr,"child_added",mr),this.firebaseOn_(dr,"child_changed",mr),this.firebaseOn_(dr,"child_removed",function(gr){var yr=gr.key;pr.trigger("cursor",yr,null)})},ar.prototype.monitorHistory_=function(){var dr=this;this.ref_.child("checkpoint").once("value",function(pr){if(!dr.zombie_){var mr=pr.child("id").val(),gr=pr.child("o").val(),yr=pr.child("a").val();gr!=null&&mr!=null&&yr!==null?(dr.pendingReceivedRevisions_[mr]={o:gr,a:yr},dr.checkpointRevision_=fr(mr),dr.monitorHistoryStartingAt_(dr.checkpointRevision_+1)):(dr.checkpointRevision_=0,dr.monitorHistoryStartingAt_(dr.checkpointRevision_))}})},ar.prototype.monitorHistoryStartingAt_=function(dr){var pr=this.ref_.child("history").startAt(null,hr(dr)),mr=this;setTimeout(function(){mr.firebaseOn_(pr,"child_added",function(gr){var yr=gr.key;mr.pendingReceivedRevisions_[yr]=gr.val(),mr.ready_&&mr.handlePendingReceivedRevisions_()}),pr.once("value",function(){mr.handleInitialRevisions_()})},0)},ar.prototype.handleInitialRevisions_=function(){cr(!this.ready_,"Should not be called multiple times."),this.revision_=this.checkpointRevision_;for(var dr=hr(this.revision_),pr=this.pendingReceivedRevisions_;pr[dr]!=null;){var mr=this.parseRevision_(pr[dr]);mr?this.document_=this.document_.compose(mr.operation):utils.log("Invalid operation.",this.ref_.toString(),dr,pr[dr]),delete pr[dr],this.revision_++,dr=hr(this.revision_)}this.trigger("operation",this.document_),this.ready_=!0;var gr=this;setTimeout(function(){gr.trigger("ready")},0)},ar.prototype.handlePendingReceivedRevisions_=function(){for(var dr=this.pendingReceivedRevisions_,pr=hr(this.revision_),mr=!1;dr[pr]!=null;){this.revision_++;var gr=this.parseRevision_(dr[pr]);gr?(this.document_=this.document_.compose(gr.operation),this.sent_&&pr===this.sent_.id?this.sent_.op.equals(gr.operation)&&gr.author===this.userId_?(this.revision_%or===0&&this.saveCheckpoint_(),this.sent_=null,this.trigger("ack")):(mr=!0,this.trigger("operation",gr.operation)):this.trigger("operation",gr.operation)):utils.log("Invalid operation.",this.ref_.toString(),pr,dr[pr]),delete dr[pr],pr=hr(this.revision_)}mr&&(this.sent_=null,this.trigger("retry"))},ar.prototype.parseRevision_=function(dr){if(typeof dr!="object"||typeof dr.a!="string"||typeof dr.o!="object")return null;var pr=null;try{pr=TextOperation.fromJSON(dr.o)}catch{return null}return pr.baseLength!==this.document_.targetLength?null:{author:dr.a,operation:pr}},ar.prototype.saveCheckpoint_=function(){this.ref_.child("checkpoint").set({a:this.userId_,o:this.document_.toJSON(),id:hr(this.revision_-1)})},ar.prototype.firebaseOn_=function(dr,pr,mr,gr){return this.firebaseCallbacks_.push({ref:dr,eventType:pr,callback:mr,context:gr}),dr.on(pr,mr,gr),mr},ar.prototype.firebaseOff_=function(dr,pr,mr,gr){dr.off(pr,mr,gr);for(var yr=0;yr<this.firebaseCallbacks_.length;yr++){var br=this.firebaseCallbacks_[yr];if(br.ref===dr&&br.eventType===pr&&br.callback===mr&&br.context===gr){this.firebaseCallbacks_.splice(yr,1);break}}},ar.prototype.removeFirebaseCallbacks_=function(){for(var dr=0;dr<this.firebaseCallbacks_.length;dr++){var pr=this.firebaseCallbacks_[dr];pr.ref.off(pr.eventType,pr.callback,pr.context)}this.firebaseCallbacks_=[]};function cr(dr,pr){if(!dr)throw new Error(pr||"assertion error")}var ur="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function hr(dr){if(dr===0)return"A0";for(var pr="";dr>0;){var mr=dr%ur.length;pr=ur[mr]+pr,dr-=mr,dr/=ur.length}var gr=ur[pr.length+9];return gr+pr}function fr(dr){cr(dr.length>0&&dr[0]===ur[dr.length+8]);for(var pr=0,mr=1;mr<dr.length;mr++)pr*=ur.length,pr+=ur.indexOf(dr[mr]);return pr}return ar}(),ATTR={BOLD:"b",ITALIC:"i",UNDERLINE:"u",STRIKE:"s",FONT:"f",FONT_SIZE:"fs",COLOR:"c",BACKGROUND_COLOR:"bc",ENTITY_SENTINEL:"ent",LINE_SENTINEL:"l",LINE_INDENT:"li",LINE_ALIGN:"la",LIST_TYPE:"lt"},sentinelConstants={LINE_SENTINEL_CHARACTER:"",ENTITY_SENTINEL_CHARACTER:""},Entity=function(){var lr=ATTR.ENTITY_SENTINEL,or=lr+"_";function ar(cr,ur){if(!(this instanceof ar))return new ar(cr,ur);this.type=cr,this.info=ur||{}}return ar.prototype.toAttributes=function(){var cr={};cr[lr]=this.type;for(var ur in this.info)cr[or+ur]=this.info[ur];return cr},ar.fromAttributes=function(cr){var ur=cr[lr],hr={};for(var fr in cr)fr.indexOf(or)===0&&(hr[fr.substr(or.length)]=cr[fr]);return new ar(ur,hr)},ar}(),getDocument=()=>window.document,EntityManager=function(){function lr(){this.entities_={};var or=["src","alt","width","height","style","class"];this.register("img",{render:function(ar){utils.assert(ar.src,"image entity should have 'src'!");for(var cr=["src","alt","width","height","style","class"],ur="<img ",hr=0;hr<cr.length;hr++){var fr=cr[hr];fr in ar&&(ur+=" "+fr+'="'+ar[fr]+'"')}return ur+=">",ur},fromElement:function(ar){for(var cr={},ur=0;ur<or.length;ur++){var hr=or[ur];ar.hasAttribute(hr)&&(cr[hr]=ar.getAttribute(hr))}return cr}})}return lr.prototype.register=function(or,ar){utils.assert(ar.render,"Entity options should include a 'render' function!"),utils.assert(ar.fromElement,"Entity options should include a 'fromElement' function!"),this.entities_[or]=ar},lr.prototype.renderToElement=function(or,ar){return this.tryRenderToElement_(or,"render",ar)},lr.prototype.exportToElement=function(or){var ar=this.tryRenderToElement_(or,"export")||this.tryRenderToElement_(or,"getHtml")||this.tryRenderToElement_(or,"render");return ar.setAttribute("data-firepad-entity",or.type),ar},lr.prototype.updateElement=function(or,ar){var cr=or.type,ur=or.info;this.entities_[cr]&&typeof this.entities_[cr].update<"u"&&this.entities_[cr].update(ur,ar)},lr.prototype.fromElement=function(or){var ar=or.getAttribute("data-firepad-entity");if(ar||(ar=or.nodeName.toLowerCase()),ar&&this.entities_[ar]){var cr=this.entities_[ar].fromElement(or);return new Entity(ar,cr)}},lr.prototype.tryRenderToElement_=function(or,ar,cr){var ur=or.type,hr=or.info;if(this.entities_[ur]&&this.entities_[ur][ar]){var fr=getDocument(),dr=this.entities_[ur][ar](hr,cr,fr);if(dr){if(typeof dr=="string"){var pr=getDocument().createElement("div");return pr.innerHTML=dr,pr.childNodes[0]}else if(typeof dr=="object")return utils.assert(typeof dr.nodeType<"u","Error rendering "+ur+" entity.  render() function must return an html string or a DOM element."),dr}}},lr.prototype.entitySupportsUpdate=function(or){return this.entities_[or]&&this.entities_[or].update},lr}(),LineFormatting=function(){function lr(or){if(!(this instanceof lr))return new lr(or);this.attributes=or||{},this.attributes[ATTR.LINE_SENTINEL]=!0}return lr.LIST_TYPE={NONE:!1,ORDERED:"o",UNORDERED:"u",TODO:"t",TODOCHECKED:"tc"},lr.prototype.cloneWithNewAttribute_=function(or,ar){var cr={};for(var ur in this.attributes)cr[ur]=this.attributes[ur];return ar===!1?delete cr[or]:cr[or]=ar,new lr(cr)},lr.prototype.indent=function(or){return this.cloneWithNewAttribute_(ATTR.LINE_INDENT,or)},lr.prototype.align=function(or){return this.cloneWithNewAttribute_(ATTR.LINE_ALIGN,or)},lr.prototype.listItem=function(or){return utils.assert(or===!1||or==="u"||or==="o"||or==="t"||or==="tc"),this.cloneWithNewAttribute_(ATTR.LIST_TYPE,or)},lr.prototype.getIndent=function(){return this.attributes[ATTR.LINE_INDENT]||0},lr.prototype.getAlign=function(){return this.attributes[ATTR.LINE_ALIGN]||0},lr.prototype.getListItem=function(){return this.attributes[ATTR.LIST_TYPE]||!1},lr}(),Formatting=function(){function lr(or){if(!(this instanceof lr))return new lr(or);this.attributes=or||{}}return lr.prototype.cloneWithNewAttribute_=function(or,ar){var cr={};for(var ur in this.attributes)cr[ur]=this.attributes[ur];return ar===!1?delete cr[or]:cr[or]=ar,new lr(cr)},lr.prototype.bold=function(or){return this.cloneWithNewAttribute_(ATTR.BOLD,or)},lr.prototype.italic=function(or){return this.cloneWithNewAttribute_(ATTR.ITALIC,or)},lr.prototype.underline=function(or){return this.cloneWithNewAttribute_(ATTR.UNDERLINE,or)},lr.prototype.strike=function(or){return this.cloneWithNewAttribute_(ATTR.STRIKE,or)},lr.prototype.font=function(or){return this.cloneWithNewAttribute_(ATTR.FONT,or)},lr.prototype.fontSize=function(or){return this.cloneWithNewAttribute_(ATTR.FONT_SIZE,or)},lr.prototype.color=function(or){return this.cloneWithNewAttribute_(ATTR.COLOR,or)},lr.prototype.backgroundColor=function(or){return this.cloneWithNewAttribute_(ATTR.BACKGROUND_COLOR,or)},lr}(),Text$1=function(){function lr(or,ar){if(!(this instanceof lr))return new lr(or,ar);this.text=or,this.formatting=ar||Formatting()}return lr}(),Line=function(){function lr(or,ar){if(!(this instanceof lr))return new lr(or,ar);Object.prototype.toString.call(or)!=="[object Array]"&&(typeof or>"u"?or=[]:or=[or]),this.textPieces=or,this.formatting=ar||LineFormatting()}return lr}(),ParseHtml=function(){var{LIST_TYPE:lr}=LineFormatting;function or(gr,yr,br){this.listType=gr||lr.UNORDERED,this.lineFormatting=yr||LineFormatting(),this.textFormatting=br||Formatting()}or.prototype.withTextFormatting=function(gr){return new or(this.listType,this.lineFormatting,gr)},or.prototype.withLineFormatting=function(gr){return new or(this.listType,gr,this.textFormatting)},or.prototype.withListType=function(gr){return new or(gr,this.lineFormatting,this.textFormatting)},or.prototype.withIncreasedIndent=function(){var gr=this.lineFormatting.indent(this.lineFormatting.getIndent()+1);return new or(this.listType,gr,this.textFormatting)},or.prototype.withAlign=function(gr){var yr=this.lineFormatting.align(gr);return new or(this.listType,yr,this.textFormatting)};function ar(){this.lines=[],this.currentLine=[],this.currentLineListItemType=null}ar.prototype.newlineIfNonEmpty=function(gr){this.cleanLine_(),this.currentLine.length>0&&this.newline(gr)},ar.prototype.newlineIfNonEmptyOrListItem=function(gr){this.cleanLine_(),(this.currentLine.length>0||this.currentLineListItemType!==null)&&this.newline(gr)},ar.prototype.newline=function(gr){this.cleanLine_();var yr=gr.lineFormatting;this.currentLineListItemType!==null&&(yr=yr.listItem(this.currentLineListItemType),this.currentLineListItemType=null),this.lines.push(Line(this.currentLine,yr)),this.currentLine=[]},ar.prototype.makeListItem=function(gr){this.currentLineListItemType=gr},ar.prototype.cleanLine_=function(){if(this.currentLine.length>0){var gr=this.currentLine.length-1;this.currentLine[0].text=this.currentLine[0].text.replace(/^ +/,""),this.currentLine[gr].text=this.currentLine[gr].text.replace(/ +$/g,"");for(var yr=0;yr<this.currentLine.length;yr++)this.currentLine[yr].text=this.currentLine[yr].text.replace(/\u00a0/g," ")}this.currentLine.length===1&&this.currentLine[0].text===""&&(this.currentLine=[])};var cr;function ur(gr,yr){var br=getDocument().createElement("div");br.innerHTML=gr,cr=yr;var Or=new ar,_r=new or;return fr(br,_r,Or),Or.lines}var hr=hr||{ELEMENT_NODE:1,TEXT_NODE:3};function fr(gr,yr,br){if(gr.nodeType===hr.ELEMENT_NODE){var Or=cr.fromElement(gr);if(Or){br.currentLine.push(new Text$1(sentinelConstants.ENTITY_SENTINEL_CHARACTER,new Formatting(Or.toAttributes())));return}}switch(gr.nodeType){case hr.TEXT_NODE:var _r=gr.nodeValue.replace(/[ \n\t]+/g," ");br.currentLine.push(Text$1(_r,yr.textFormatting));break;case hr.ELEMENT_NODE:var vr=gr.getAttribute("style")||"";switch(yr=mr(yr,vr),gr.nodeName.toLowerCase()){case"div":case"h1":case"h2":case"h3":case"p":br.newlineIfNonEmpty(yr),dr(gr,yr,br),br.newlineIfNonEmpty(yr);break;case"center":yr=yr.withAlign("center"),br.newlineIfNonEmpty(yr),dr(gr,yr.withAlign("center"),br),br.newlineIfNonEmpty(yr);break;case"b":case"strong":dr(gr,yr.withTextFormatting(yr.textFormatting.bold(!0)),br);break;case"u":dr(gr,yr.withTextFormatting(yr.textFormatting.underline(!0)),br);break;case"i":case"em":dr(gr,yr.withTextFormatting(yr.textFormatting.italic(!0)),br);break;case"s":dr(gr,yr.withTextFormatting(yr.textFormatting.strike(!0)),br);break;case"font":var xr=gr.getAttribute("face"),wr=gr.getAttribute("color"),kr=parseInt(gr.getAttribute("size"));xr&&(yr=yr.withTextFormatting(yr.textFormatting.font(xr))),wr&&(yr=yr.withTextFormatting(yr.textFormatting.color(wr))),kr&&(yr=yr.withTextFormatting(yr.textFormatting.fontSize(kr))),dr(gr,yr,br);break;case"br":br.newline(yr);break;case"ul":br.newlineIfNonEmptyOrListItem(yr);var Cr=gr.getAttribute("class")==="firepad-todo"?lr.TODO:lr.UNORDERED;dr(gr,yr.withListType(Cr).withIncreasedIndent(),br),br.newlineIfNonEmpty(yr);break;case"ol":br.newlineIfNonEmptyOrListItem(yr),dr(gr,yr.withListType(lr.ORDERED).withIncreasedIndent(),br),br.newlineIfNonEmpty(yr);break;case"li":pr(gr,yr,br);break;case"style":break;default:dr(gr,yr,br);break}break}}function dr(gr,yr,br){if(gr.hasChildNodes())for(var Or=0;Or<gr.childNodes.length;Or++)fr(gr.childNodes[Or],yr,br)}function pr(gr,yr,br){br.newlineIfNonEmptyOrListItem(yr);var Or=gr.getAttribute("class")==="firepad-checked"?lr.TODOCHECKED:yr.listType;br.makeListItem(Or);var _r=br.currentLine;dr(gr,yr,br),(_r===br.currentLine||br.currentLine.length>0)&&br.newline(yr)}function mr(gr,yr){for(var br=gr.textFormatting,Or=gr.lineFormatting,_r=yr.split(";"),vr=0;vr<_r.length;vr++){var xr=_r[vr].split(":");if(xr.length===2){var wr=utils.trim(xr[0]).toLowerCase(),kr=utils.trim(xr[1]).toLowerCase();switch(wr){case"text-decoration":var Cr=kr.indexOf("underline")>=0,$r=kr.indexOf("line-through")>=0;br=br.underline(Cr).strike($r);break;case"font-weight":var Nr=kr==="bold"||parseInt(kr)>=600;br=br.bold(Nr);break;case"font-style":var Br=kr==="italic"||kr==="oblique";br=br.italic(Br);break;case"color":br=br.color(kr);break;case"background-color":br=br.backgroundColor(kr);break;case"text-align":Or=Or.align(kr);break;case"font-size":var Fr=null,Vr=["px","pt","%","em","xx-small","x-small","small","medium","large","x-large","xx-large","smaller","larger"];utils.stringEndsWith(kr,Vr)?Fr=kr:parseInt(kr)&&(Fr=parseInt(kr)+"px"),Fr&&(br=br.fontSize(Fr));break;case"font-family":var Rr=utils.trim(kr.split(",")[0]);Rr=Rr.replace(/['"]/g,""),Rr=Rr.replace(/\w\S*/g,function(Gr){return Gr.charAt(0).toUpperCase()+Gr.substr(1).toLowerCase()}),br=br.font(Rr);break}}}return gr.withLineFormatting(Or).withTextFormatting(br)}return ur}(),SerializeHtml=function(){var{LIST_TYPE:lr}=LineFormatting,or=`<style>ul.firepad-todo { list-style: none; margin-left: 0; padding-left: 0; } ul.firepad-todo > li { padding-left: 1em; text-indent: -1em; } ul.firepad-todo > li:before { content: "\\2610"; padding-right: 5px; } ul.firepad-todo > li.firepad-checked:before { content: "\\2611"; padding-right: 5px; }</style>
`;function ar(dr){return dr===lr.ORDERED?"<ol>":dr===lr.UNORDERED?"<ul>":'<ul class="firepad-todo">'}function cr(dr){return dr===lr.ORDERED?"</ol>":"</ul>"}function ur(dr,pr){return dr===pr||dr===lr.TODO&&pr===lr.TODOCHECKED||dr===lr.TODOCHECKED&&pr===lr.TODO}function hr(dr){return dr.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;")}function fr(dr,pr){for(var mr="",gr=!0,yr=[],br=!1,Or=!0,_r=!0,vr=0,xr=dr.ops[vr],wr=!1;xr;){utils.assert(xr.isInsert());var kr=xr.attributes;if(gr){gr=!1;var Cr=0,$r=null,Nr="left";for((ATTR.LINE_SENTINEL in kr)&&(Cr=kr[ATTR.LINE_INDENT]||0,$r=kr[ATTR.LIST_TYPE]||null,Nr=kr[ATTR.LINE_ALIGN]||"left"),$r&&(Cr=Cr||1),br?(mr+="</li>",br=!1):Or||(_r&&(mr+="<br/>"),mr+="</div>"),Or=!1,utils.assert(Cr>=0,"Indent must not be negative.");yr.length>Cr||Cr===yr.length&&$r!==null&&!ur($r,yr[yr.length-1]);)mr+=cr(yr.pop());for(;yr.length<Cr;){var Br=$r||lr.UNORDERED;wr=$r==lr.TODO||$r==lr.TODOCHECKED||wr,mr+=ar(Br),yr.push(Br)}var Fr=Nr!=="left"?' style="text-align:'+Nr+'"':"";if($r){var Vr="";switch($r){case lr.TODOCHECKED:Vr=' class="firepad-checked"';break;case lr.TODO:Vr=' class="firepad-unchecked"';break}mr+="<li"+Vr+Fr+">",br=!0}else mr+="<div"+Fr+">";_r=!0}if(ATTR.LINE_SENTINEL in kr){xr=dr.ops[++vr];continue}if(ATTR.ENTITY_SENTINEL in kr){for(var Rr=0;Rr<xr.text.length;Rr++){var Gr=Entity.fromAttributes(kr),qr=pr.exportToElement(Gr);mr+=qr.outerHTML}xr=dr.ops[++vr];continue}var Ur="",Yr="";for(var Dr in kr){var Jr=kr[Dr],ai,Kr;Dr===ATTR.BOLD||Dr===ATTR.ITALIC||Dr===ATTR.UNDERLINE||Dr===ATTR.STRIKE?(utils.assert(Jr===!0),ai=Kr=Dr):Dr===ATTR.FONT_SIZE?(ai='span style="font-size: '+Jr,ai+=typeof Jr!="string"||Jr.indexOf("px",Jr.length-2)===-1?'px"':'"',Kr="span"):Dr===ATTR.FONT?(ai='span style="font-family: '+Jr+'"',Kr="span"):Dr===ATTR.COLOR?(ai='span style="color: '+Jr+'"',Kr="span"):Dr===ATTR.BACKGROUND_COLOR?(ai='span style="background-color: '+Jr+'"',Kr="span"):utils.log(!1,"Encountered unknown attribute while rendering html: "+Dr),ai&&(Ur+="<"+ai+">"),Kr&&(Yr="</"+Kr+">"+Yr)}var ui=xr.text,ii=ui.indexOf(`
`);ii>=0?(gr=!0,ii<ui.length-1?xr=new TextOp("insert",ui.substr(ii+1),kr):xr=dr.ops[++vr],ui=ui.substr(0,ii)):xr=dr.ops[++vr],ui=ui.replace(/  +/g,function(di){return new Array(di.length+1).join(" ")}).replace(/^ /," ").replace(/ $/," "),ui.length>0&&(_r=!1),mr+=Ur+hr(ui)+Yr}for(br?mr+="</li>":Or||(_r&&(mr+="&nbsp;"),mr+="</div>");yr.length>0;)mr+=cr(yr.pop());return wr&&(mr=or+mr),mr}return fr}(),textPiecesToInserts=function(lr,or){var ar=[];function cr(fr,dr){fr instanceof Text$1&&(dr=fr.formatting.attributes,fr=fr.text),ar.push({string:fr,attributes:dr}),lr=fr[fr.length-1]===`
`}function ur(fr,dr){lr&&cr(sentinelConstants.LINE_SENTINEL_CHARACTER,fr.formatting.attributes);for(var pr=0;pr<fr.textPieces.length;pr++)cr(fr.textPieces[pr]);dr&&cr(`
`)}for(var hr=0;hr<or.length;hr++)or[hr]instanceof Line?ur(or[hr],hr<or.length-1):cr(or[hr]);return ar},Cursor=function(){function lr(or,ar){this.position=or,this.selectionEnd=ar}return lr.fromJSON=function(or){return new lr(or.position,or.selectionEnd)},lr.prototype.equals=function(or){return this.position===or.position&&this.selectionEnd===or.selectionEnd},lr.prototype.compose=function(or){return or},lr.prototype.transform=function(or){function ar(ur){for(var hr=ur,fr=or.ops,dr=0,pr=or.ops.length;dr<pr&&(fr[dr].isRetain()?ur-=fr[dr].chars:fr[dr].isInsert()?hr+=fr[dr].text.length:(hr-=Math.min(ur,fr[dr].chars),ur-=fr[dr].chars),!(ur<0));dr++);return hr}var cr=ar(this.position);return this.position===this.selectionEnd?new lr(cr,cr):new lr(cr,ar(this.selectionEnd))},lr}(),Client=function(){function lr(){this.state=ar}lr.prototype.setState=function(hr){this.state=hr},lr.prototype.applyClient=function(hr){this.setState(this.state.applyClient(this,hr))},lr.prototype.applyServer=function(hr){this.setState(this.state.applyServer(this,hr))},lr.prototype.serverAck=function(){this.setState(this.state.serverAck(this))},lr.prototype.serverRetry=function(){this.setState(this.state.serverRetry(this))},lr.prototype.sendOperation=function(hr){throw new Error("sendOperation must be defined in child class")},lr.prototype.applyOperation=function(hr){throw new Error("applyOperation must be defined in child class")};function or(){}lr.Synchronized=or,or.prototype.applyClient=function(hr,fr){return hr.sendOperation(fr),new cr(fr)},or.prototype.applyServer=function(hr,fr){return hr.applyOperation(fr),this},or.prototype.serverAck=function(hr){throw new Error("There is no pending operation.")},or.prototype.serverRetry=function(hr){throw new Error("There is no pending operation.")};var ar=new or;function cr(hr){this.outstanding=hr}lr.AwaitingConfirm=cr,cr.prototype.applyClient=function(hr,fr){return new ur(this.outstanding,fr)},cr.prototype.applyServer=function(hr,fr){var dr=this.outstanding.transform(fr);return hr.applyOperation(dr[1]),new cr(dr[0])},cr.prototype.serverAck=function(hr){return ar},cr.prototype.serverRetry=function(hr){return hr.sendOperation(this.outstanding),this};function ur(hr,fr){this.outstanding=hr,this.buffer=fr}return lr.AwaitingWithBuffer=ur,ur.prototype.applyClient=function(hr,fr){var dr=this.buffer.compose(fr);return new ur(this.outstanding,dr)},ur.prototype.applyServer=function(hr,fr){var dr=this.outstanding.transform(fr),pr=this.buffer.transform(dr[1]);return hr.applyOperation(pr[1]),new ur(dr[0],pr[0])},ur.prototype.serverRetry=function(hr){var fr=this.outstanding.compose(this.buffer);return hr.sendOperation(fr),new cr(fr)},ur.prototype.serverAck=function(hr){return hr.sendOperation(this.buffer),new cr(this.buffer)},lr}(),UndoManager=function(){var lr="normal",or="undoing",ar="redoing";function cr(hr){this.maxItems=hr||50,this.state=lr,this.dontCompose=!1,this.undoStack=[],this.redoStack=[]}cr.prototype.add=function(hr,fr){if(this.state===or)this.redoStack.push(hr),this.dontCompose=!0;else if(this.state===ar)this.undoStack.push(hr),this.dontCompose=!0;else{var dr=this.undoStack;!this.dontCompose&&fr&&dr.length>0?dr.push(hr.compose(dr.pop())):(dr.push(hr),dr.length>this.maxItems&&dr.shift()),this.dontCompose=!1,this.redoStack=[]}};function ur(hr,fr){for(var dr=[],pr=fr.constructor,mr=hr.length-1;mr>=0;mr--){var gr=pr.transform(hr[mr],fr);(typeof gr[0].isNoop!="function"||!gr[0].isNoop())&&dr.push(gr[0]),fr=gr[1]}return dr.reverse()}return cr.prototype.transform=function(hr){this.undoStack=ur(this.undoStack,hr),this.redoStack=ur(this.redoStack,hr)},cr.prototype.performUndo=function(hr){if(this.state=or,this.undoStack.length===0)throw new Error("undo not possible");hr(this.undoStack.pop()),this.state=lr},cr.prototype.performRedo=function(hr){if(this.state=ar,this.redoStack.length===0)throw new Error("redo not possible");hr(this.redoStack.pop()),this.state=lr},cr.prototype.canUndo=function(){return this.undoStack.length!==0},cr.prototype.canRedo=function(){return this.redoStack.length!==0},cr.prototype.isUndoing=function(){return this.state===or},cr.prototype.isRedoing=function(){return this.state===ar},cr}(),WrappedOperation=function(lr){function or(hr,fr){this.wrapped=hr,this.meta=fr}or.prototype.apply=function(){return this.wrapped.apply.apply(this.wrapped,arguments)},or.prototype.invert=function(){var hr=this.meta;return new or(this.wrapped.invert.apply(this.wrapped,arguments),hr&&typeof hr=="object"&&typeof hr.invert=="function"?hr.invert.apply(hr,arguments):hr)};function ar(hr,fr){for(var dr in hr)hr.hasOwnProperty(dr)&&(fr[dr]=hr[dr])}function cr(hr,fr){if(hr&&typeof hr=="object"){if(typeof hr.compose=="function")return hr.compose(fr);var dr={};return ar(hr,dr),ar(fr,dr),dr}return fr}or.prototype.compose=function(hr){return new or(this.wrapped.compose(hr.wrapped),cr(this.meta,hr.meta))};function ur(hr,fr){return hr&&typeof hr=="object"&&typeof hr.transform=="function"?hr.transform(fr):hr}return or.transform=function(hr,fr){var dr=hr.wrapped.transform(fr.wrapped);return[new or(dr[0],ur(hr.meta,fr.wrapped)),new or(dr[1],ur(fr.meta,hr.wrapped))]},or.prototype.transform=function(hr){return or.transform(this,hr)},or}(),EditorClient=function(){function lr(hr,fr){this.cursorBefore=hr,this.cursorAfter=fr}lr.prototype.invert=function(){return new lr(this.cursorAfter,this.cursorBefore)},lr.prototype.compose=function(hr){return new lr(this.cursorBefore,hr.cursorAfter)},lr.prototype.transform=function(hr){return new lr(this.cursorBefore?this.cursorBefore.transform(hr):null,this.cursorAfter?this.cursorAfter.transform(hr):null)};function or(hr,fr){this.id=hr,this.editorAdapter=fr}or.prototype.setColor=function(hr){this.color=hr},or.prototype.updateCursor=function(hr){this.removeCursor(),this.cursor=hr,this.mark=this.editorAdapter.setOtherCursor(hr,this.color,this.id)},or.prototype.removeCursor=function(){this.mark&&this.mark.clear()};function ar(hr,fr){Client.call(this),this.serverAdapter=hr,this.editorAdapter=fr,this.undoManager=new UndoManager,this.clients={};var dr=this;this.editorAdapter.registerCallbacks({change:function(pr,mr){dr.onChange(pr,mr)},cursorActivity:function(){dr.onCursorActivity()},blur:function(){dr.onBlur()},focus:function(){dr.onFocus()}}),this.editorAdapter.registerUndo(function(){dr.undo()}),this.editorAdapter.registerRedo(function(){dr.redo()}),this.serverAdapter.registerCallbacks({ack:function(){dr.serverAck(),dr.focused&&dr.state instanceof Client.Synchronized&&(dr.updateCursor(),dr.sendCursor(dr.cursor)),dr.emitStatus()},retry:function(){dr.serverRetry()},operation:function(pr){dr.applyServer(pr)},cursor:function(pr,mr,gr){if(!(dr.serverAdapter.userId_===pr||!(dr.state instanceof Client.Synchronized))){var yr=dr.getClientObject(pr);mr?(gr&&yr.setColor(gr),yr.updateCursor(Cursor.fromJSON(mr))):yr.removeCursor()}}})}cr(ar,Client),ar.prototype.getClientObject=function(hr){var fr=this.clients[hr];return fr||(this.clients[hr]=new or(hr,this.editorAdapter))},ar.prototype.applyUnredo=function(hr){this.undoManager.add(this.editorAdapter.invertOperation(hr)),this.editorAdapter.applyOperation(hr.wrapped),this.cursor=hr.meta.cursorAfter,this.cursor&&this.editorAdapter.setCursor(this.cursor),this.applyClient(hr.wrapped)},ar.prototype.undo=function(){var hr=this;this.undoManager.canUndo()&&this.undoManager.performUndo(function(fr){hr.applyUnredo(fr)})},ar.prototype.redo=function(){var hr=this;this.undoManager.canRedo()&&this.undoManager.performRedo(function(fr){hr.applyUnredo(fr)})},ar.prototype.onChange=function(hr,fr){var dr=this.cursor;this.updateCursor();var pr=this.undoManager.undoStack.length>0&&fr.shouldBeComposedWithInverted(ur(this.undoManager.undoStack).wrapped),mr=new lr(this.cursor,dr);this.undoManager.add(new WrappedOperation(fr,mr),pr),this.applyClient(hr)},ar.prototype.updateCursor=function(){this.cursor=this.editorAdapter.getCursor()},ar.prototype.onCursorActivity=function(){var hr=this.cursor;this.updateCursor(),!(!this.focused||hr&&this.cursor.equals(hr))&&this.sendCursor(this.cursor)},ar.prototype.onBlur=function(){this.cursor=null,this.sendCursor(null),this.focused=!1},ar.prototype.onFocus=function(){this.focused=!0,this.onCursorActivity()},ar.prototype.sendCursor=function(hr){this.state instanceof Client.AwaitingWithBuffer||this.serverAdapter.sendCursor(hr)},ar.prototype.sendOperation=function(hr){this.serverAdapter.sendOperation(hr),this.emitStatus()},ar.prototype.applyOperation=function(hr){this.editorAdapter.applyOperation(hr),this.updateCursor(),this.undoManager.transform(new WrappedOperation(hr,null))},ar.prototype.emitStatus=function(){var hr=this;setTimeout(function(){hr.trigger("synced",hr.state instanceof Client.Synchronized)},0)};function cr(hr,fr){function dr(){}dr.prototype=fr.prototype,hr.prototype=new dr,hr.prototype.constructor=hr}function ur(hr){return hr[hr.length-1]}return ar}();utils.makeEventEmitter(EditorClient,["synced"]);const RichTextCodeMirrorAdapter=function(){function lr(mr){this.rtcm=mr,this.cm=mr.codeMirror,hr(this,"onChange"),hr(this,"onAttributesChange"),hr(this,"onCursorActivity"),hr(this,"onFocus"),hr(this,"onBlur"),this.rtcm.on("change",this.onChange),this.rtcm.on("attributesChange",this.onAttributesChange),this.cm.on("cursorActivity",this.onCursorActivity),this.cm.on("focus",this.onFocus),this.cm.on("blur",this.onBlur)}lr.prototype.detach=function(){this.rtcm.off("change",this.onChange),this.rtcm.off("attributesChange",this.onAttributesChange),this.cm.off("cursorActivity",this.onCursorActivity),this.cm.off("focus",this.onFocus),this.cm.off("blur",this.onBlur)};function or(mr,gr){return mr.line<gr.line?-1:mr.line>gr.line?1:mr.ch<gr.ch?-1:mr.ch>gr.ch?1:0}function ar(mr,gr){return or(mr,gr)===0}function cr(mr){var gr=mr.lineCount()-1;return mr.indexFromPos({line:gr,ch:mr.getLine(gr).length})}lr.operationFromCodeMirrorChanges=function(mr,gr){for(var yr=cr(gr),br=new TextOperation().retain(yr),Or=new TextOperation().retain(yr),_r=mr.length-1;_r>=0;_r--){var vr=mr[_r],xr=vr.start,wr=yr-xr-vr.text.length;br=new TextOperation().retain(xr).delete(vr.removed.length).insert(vr.text,vr.attributes).retain(wr).compose(br),Or=Or.compose(new TextOperation().retain(xr).delete(vr.text.length).insert(vr.removed,vr.removedAttributes).retain(wr)),yr+=vr.removed.length-vr.text.length}return[br,Or]},lr.operationFromAttributesChanges=function(mr,gr){for(var yr=cr(gr),br=new TextOperation,Or=new TextOperation,_r=0,vr=0;vr<mr.length;vr++){var xr=mr[vr],wr=xr.start-_r;ur(wr>=0),br.retain(wr),Or.retain(wr);var kr=xr.end-xr.start;br.retain(kr,xr.attributes),Or.retain(kr,xr.attributesInverse),_r=xr.start+kr}return br.retain(yr-_r),Or.retain(yr-_r),[br,Or]},lr.prototype.registerCallbacks=function(mr){this.callbacks=mr},lr.prototype.onChange=function(mr,gr){if(gr[0].origin!=="RTCMADAPTER"){var yr=lr.operationFromCodeMirrorChanges(gr,this.cm);this.trigger("change",yr[0],yr[1])}},lr.prototype.onAttributesChange=function(mr,gr){if(gr[0].origin!=="RTCMADAPTER"){var yr=lr.operationFromAttributesChanges(gr,this.cm);this.trigger("change",yr[0],yr[1])}},lr.prototype.onCursorActivity=function(){var mr=this;setTimeout(function(){mr.trigger("cursorActivity")},1)},lr.prototype.onFocus=function(){this.trigger("focus")},lr.prototype.onBlur=function(){this.cm.somethingSelected()||this.trigger("blur")},lr.prototype.getValue=function(){return this.cm.getValue()},lr.prototype.getCursor=function(){var mr=this.cm,gr=mr.getCursor(),yr=mr.indexFromPos(gr),br;if(mr.somethingSelected()){var Or=mr.getCursor(!0),_r=ar(gr,Or)?mr.getCursor(!1):Or;br=mr.indexFromPos(_r)}else br=yr;return new Cursor(yr,br)},lr.prototype.setCursor=function(mr){this.cm.setSelection(this.cm.posFromIndex(mr.position),this.cm.posFromIndex(mr.selectionEnd))},lr.prototype.addStyleRule=function(mr){if(!(typeof document>"u"||document===null)){if(!this.addedStyleRules){this.addedStyleRules={};var gr=document.createElement("style");document.documentElement.getElementsByTagName("head")[0].appendChild(gr),this.addedStyleSheet=gr.sheet}if(!this.addedStyleRules[mr])return this.addedStyleRules[mr]=!0,this.addedStyleSheet.insertRule(mr,0)}},lr.prototype.setOtherCursor=function(mr,gr,yr){var br=this.cm.posFromIndex(mr.position);if(!(typeof gr!="string"||!gr.match(/^#[a-fA-F0-9]{3,6}$/))){var Or=this.rtcm.end();if(!(typeof mr!="object"||typeof mr.position!="number"||typeof mr.selectionEnd!="number")&&!(mr.position<0||mr.position>Or||mr.selectionEnd<0||mr.selectionEnd>Or))if(mr.position===mr.selectionEnd){var _r=this.cm.cursorCoords(br),vr=document.createElement("span");return vr.className="other-client",vr.style.borderLeftWidth="2px",vr.style.borderLeftStyle="solid",vr.style.borderLeftColor=gr,vr.style.marginLeft=vr.style.marginRight="-1px",vr.style.height=(_r.bottom-_r.top)*.9+"px",vr.setAttribute("data-clientid",yr),vr.style.zIndex=0,this.cm.setBookmark(br,{widget:vr,insertLeft:!0})}else{var xr="selection-"+gr.replace("#",""),wr=.4,kr="."+xr+" { background: "+dr(gr)+`;
 background: `+dr(gr,wr)+";}";this.addStyleRule(kr);var Cr,$r;return mr.selectionEnd>mr.position?(Cr=br,$r=this.cm.posFromIndex(mr.selectionEnd)):(Cr=this.cm.posFromIndex(mr.selectionEnd),$r=br),this.cm.markText(Cr,$r,{className:xr})}}},lr.prototype.trigger=function(mr){var gr=Array.prototype.slice.call(arguments,1),yr=this.callbacks&&this.callbacks[mr];yr&&yr.apply(this,gr)},lr.prototype.applyOperation=function(mr){mr.ops.length>10&&this.rtcm.codeMirror.getWrapperElement().setAttribute("style","display: none");for(var gr=mr.ops,yr=0,br=0,Or=gr.length;br<Or;br++){var _r=gr[br];_r.isRetain()?(fr(_r.attributes)||this.rtcm.updateTextAttributes(yr,yr+_r.chars,function(vr){for(var xr in _r.attributes)_r.attributes[xr]===!1?delete vr[xr]:vr[xr]=_r.attributes[xr]},"RTCMADAPTER",!0),yr+=_r.chars):_r.isInsert()?(this.rtcm.insertText(yr,_r.text,_r.attributes,"RTCMADAPTER"),yr+=_r.text.length):_r.isDelete()&&this.rtcm.removeText(yr,yr+_r.chars,"RTCMADAPTER")}mr.ops.length>10&&(this.rtcm.codeMirror.getWrapperElement().setAttribute("style",""),this.rtcm.codeMirror.refresh())},lr.prototype.registerUndo=function(mr){this.cm.undo=mr},lr.prototype.registerRedo=function(mr){this.cm.redo=mr},lr.prototype.invertOperation=function(mr){for(var gr=0,yr=this.rtcm.codeMirror,br,Or,_r=new TextOperation,vr=0;vr<mr.wrapped.ops.length;vr++){var xr=mr.wrapped.ops[vr];if(xr.isRetain())if(fr(xr.attributes))_r.retain(xr.chars),gr+=xr.chars;else for(br=this.rtcm.getAttributeSpans(gr,gr+xr.chars),Or=0;Or<br.length;Or++){var wr={};for(var kr in xr.attributes){var Cr=xr.attributes[kr],$r=br[Or].attributes[kr];Cr===!1?$r&&(wr[kr]=$r):Cr!==$r&&(wr[kr]=$r||!1)}_r.retain(br[Or].length,wr),gr+=br[Or].length}else if(xr.isInsert())_r.delete(xr.text.length);else if(xr.isDelete()){var Nr=yr.getRange(yr.posFromIndex(gr),yr.posFromIndex(gr+xr.chars));br=this.rtcm.getAttributeSpans(gr,gr+xr.chars);var Br=0;for(Or=0;Or<br.length;Or++)_r.insert(Nr.substr(Br,br[Or].length),br[Or].attributes),Br+=br[Or].length;gr+=xr.chars}}return new WrappedOperation(_r,mr.meta.invert())};function ur(mr,gr){if(!mr)throw new Error(gr||"assertion error")}function hr(mr,gr){var yr=mr[gr];mr[gr]=function(){yr.apply(mr,arguments)}}function fr(mr){for(var gr in mr)return!1;return!0}function dr(mr,gr){if(typeof mr!="string")throw new TypeError("Expected a string");mr=mr.replace(/^#/,""),mr.length===3&&(mr=mr[0]+mr[0]+mr[1]+mr[1]+mr[2]+mr[2]);var yr=parseInt(mr,16),br=[yr>>16,yr>>8&255,yr&255],Or="rgb";return pr(gr)&&(Or="rgba",br.push(gr)),Or+"("+br.join(",")+")"}function pr(mr){return mr!=null}return lr}(),Span=function(){function lr(or,ar){this.pos=or,this.length=ar}return lr.prototype.end=function(){return this.pos+this.length},lr}(),AnnotationList=function(){function lr(fr,dr){if(!fr)throw new Error("AnnotationList assertion failed"+(dr?": "+dr:""))}function or(fr,dr){this.pos=fr,this.length=dr.length,this.annotation=dr.annotation,this.attachedObject_=dr.attachedObject}or.prototype.getAttachedObject=function(){return this.attachedObject_};function ar(fr,dr){this.pos=fr,this.length=dr.length,this.annotation=dr.annotation,this.node_=dr}ar.prototype.attachObject=function(fr){this.node_.attachedObject=fr};var cr={equals:function(){return!1}};function ur(fr){this.head_=new hr(0,cr),this.changeHandler_=fr}ur.prototype.insertAnnotatedSpan=function(fr,dr){this.wrapOperation_(new Span(fr.pos,0),function(pr,mr){lr(!mr||mr.next===null);var gr=new hr(fr.length,dr);if(mr){lr(fr.pos>pr&&fr.pos<pr+mr.length);var yr=new hr(0,cr);return yr.next=new hr(fr.pos-pr,mr.annotation),yr.next.next=gr,gr.next=new hr(pr+mr.length-fr.pos,mr.annotation),yr.next}else return gr})},ur.prototype.removeSpan=function(fr){fr.length!==0&&this.wrapOperation_(fr,function(dr,pr){lr(pr!==null);var mr=new hr(0,cr),gr=mr;for(fr.pos>dr&&(gr.next=new hr(fr.pos-dr,pr.annotation),gr=gr.next);fr.end()>dr+pr.length;)dr+=pr.length,pr=pr.next;var yr=dr+pr.length-fr.end();return yr>0&&(gr.next=new hr(yr,pr.annotation)),mr.next})},ur.prototype.updateSpan=function(fr,dr){fr.length!==0&&this.wrapOperation_(fr,function(pr,mr){lr(mr!==null);var gr=new hr(0,cr),yr=gr,br=pr,Or=fr.pos-br;for(lr(Or<mr.length),Or>0&&(yr.next=new hr(Or,mr.annotation),yr=yr.next,br+=yr.length);mr!==null&&fr.end()>=pr+mr.length;){var _r=pr+mr.length-br;yr.next=new hr(_r,dr(mr.annotation,_r)),yr=yr.next,pr+=mr.length,mr=mr.next,br=pr}var vr=fr.end()-br;return vr>0&&(lr(vr<mr.length),yr.next=new hr(vr,dr(mr.annotation,vr)),yr=yr.next,br+=yr.length,yr.next=new hr(pr+mr.length-br,mr.annotation)),gr.next})},ur.prototype.wrapOperation_=function(fr,dr){if(fr.pos<0)throw new Error("Span start cannot be negative.");var pr=[],mr=[],gr=this.getAffectedNodes_(fr),yr;gr.start!==null?(yr=gr.end.next,gr.end.next=null):yr=gr.succ;var br=dr(gr.startPos,gr.start),Or=!1,_r=!1;if(br){this.mergeNodesWithSameAnnotations_(br);var vr;for(gr.pred&&gr.pred.annotation.equals(br.annotation)?(Or=!0,br.length+=gr.pred.length,gr.beforePred.next=br,vr=gr.predPos):(gr.beforeStart.next=br,vr=gr.startPos);br.next;)mr.push(new ar(vr,br)),vr+=br.length,br=br.next;gr.succ&&gr.succ.annotation.equals(br.annotation)?(br.length+=gr.succ.length,_r=!0,br.next=gr.succ.next):br.next=yr,mr.push(new ar(vr,br))}else gr.pred&&gr.succ&&gr.pred.annotation.equals(gr.succ.annotation)?(Or=!0,_r=!0,br=new hr(gr.pred.length+gr.succ.length,gr.pred.annotation),gr.beforePred.next=br,br.next=gr.succ.next,mr.push(new ar(gr.startPos-gr.pred.length,br))):gr.beforeStart.next=yr;Or&&pr.push(new or(gr.predPos,gr.pred));for(var xr=gr.startPos,wr=gr.start;wr!==null;)pr.push(new or(xr,wr)),xr+=wr.length,wr=wr.next;_r&&pr.push(new or(xr,gr.succ)),this.changeHandler_(pr,mr)},ur.prototype.getAffectedNodes_=function(fr){for(var dr={},pr=null,mr=this.head_,gr=mr.next,yr=0;gr!==null&&fr.pos>=yr+gr.length;)yr+=gr.length,pr=mr,mr=gr,gr=gr.next;if(gr===null&&!(fr.length===0&&fr.pos===yr))throw new Error("Span start exceeds the bounds of the AnnotationList.");for(dr.startPos=yr,fr.length===0&&fr.pos===yr?dr.start=null:dr.start=gr,dr.beforeStart=mr,yr===fr.pos&&yr>0?(dr.pred=mr,dr.predPos=yr-mr.length,dr.beforePred=pr):dr.pred=null;gr!==null&&fr.end()>yr;)yr+=gr.length,mr=gr,gr=gr.next;if(fr.end()>yr)throw new Error("Span end exceeds the bounds of the AnnotationList.");return fr.length===0&&fr.end()===yr?dr.end=null:dr.end=mr,dr.succ=yr===fr.end()?gr:null,dr},ur.prototype.mergeNodesWithSameAnnotations_=function(fr){if(fr)for(var dr=null,pr=fr;pr;)dr&&dr.annotation.equals(pr.annotation)?(dr.length+=pr.length,dr.next=pr.next):dr=pr,pr=pr.next},ur.prototype.forEach=function(fr){for(var dr=this.head_.next;dr!==null;)fr(dr.length,dr.annotation,dr.attachedObject),dr=dr.next},ur.prototype.getAnnotatedSpansForPos=function(fr){for(var dr=0,pr=this.head_.next,mr=null;pr!==null&&dr+pr.length<=fr;)dr+=pr.length,mr=pr,pr=pr.next;if(pr===null&&dr!==fr)throw new Error("pos exceeds the bounds of the AnnotationList");var gr=[];return dr===fr&&mr&&gr.push(new or(dr-mr.length,mr)),pr&&gr.push(new or(dr,pr)),gr},ur.prototype.getAnnotatedSpansForSpan=function(fr){if(fr.length===0)return[];for(var dr=[],pr=this.getAffectedNodes_(fr),mr=pr.startPos,gr=pr.start;gr!==null&&mr<fr.end();){var yr=Math.max(mr,fr.pos),br=Math.min(mr+gr.length,fr.end()),Or=new Span(yr,br-yr);Or.annotation=gr.annotation,dr.push(Or),mr+=gr.length,gr=gr.next}return dr},ur.prototype.count=function(){for(var fr=0,dr=this.head_.next,pr=null;dr!==null;)pr&&lr(!pr.annotation.equals(dr.annotation)),pr=dr,dr=dr.next,fr++;return fr};function hr(fr,dr){this.length=fr,this.annotation=dr,this.attachedObject=null,this.next=null}return hr.prototype.clone=function(){var fr=new hr(this.spanLength,this.annotation);return fr.next=this.next,fr},ur}(),RichTextCodeMirror=function(){var lr="cmrt-",or="cmrt-",ar={c:"color",bc:"background-color",fs:"font-size",li:function(_r){return"padding-left: "+_r*40+"px"}},cr={};function ur(_r,vr,xr){this.codeMirror=_r,this.options_=xr||{},this.entityManager_=vr,this.currentAttributes_=null;var wr=this;this.annotationList_=new AnnotationList(function(kr,Cr){wr.onAnnotationsChanged_(kr,Cr)}),this.initAnnotationList_(),Or(this,"onCodeMirrorBeforeChange_"),Or(this,"onCodeMirrorChange_"),Or(this,"onCursorActivity_"),parseInt(CodeMirror.version)>=4?this.codeMirror.on("changes",this.onCodeMirrorChange_):this.codeMirror.on("change",this.onCodeMirrorChange_),this.codeMirror.on("beforeChange",this.onCodeMirrorBeforeChange_),this.codeMirror.on("cursorActivity",this.onCursorActivity_),this.changeId_=0,this.outstandingChanges_={},this.dirtyLines_=[]}utils.makeEventEmitter(ur,["change","attributesChange","newLine"]);var hr=sentinelConstants.LINE_SENTINEL_CHARACTER,fr=sentinelConstants.ENTITY_SENTINEL_CHARACTER;ur.prototype.detach=function(){this.codeMirror.off("beforeChange",this.onCodeMirrorBeforeChange_),this.codeMirror.off("change",this.onCodeMirrorChange_),this.codeMirror.off("changes",this.onCodeMirrorChange_),this.codeMirror.off("cursorActivity",this.onCursorActivity_),this.clearAnnotations_()},ur.prototype.toggleAttribute=function(_r,vr){var xr=vr||!0;if(this.emptySelection_()){var wr=this.getCurrentAttributes_();wr[_r]===xr?delete wr[_r]:wr[_r]=xr,this.currentAttributes_=wr}else{var kr=this.getCurrentAttributes_(),Cr=kr[_r]!==xr?xr:!1;this.setAttribute(_r,Cr)}},ur.prototype.setAttribute=function(_r,vr){var xr=this.codeMirror;if(this.emptySelection_()){var wr=this.getCurrentAttributes_();vr===!1?delete wr[_r]:wr[_r]=vr,this.currentAttributes_=wr}else this.updateTextAttributes(xr.indexFromPos(xr.getCursor("start")),xr.indexFromPos(xr.getCursor("end")),function(kr){vr===!1?delete kr[_r]:kr[_r]=vr}),this.updateCurrentAttributes_()},ur.prototype.updateTextAttributes=function(_r,vr,xr,wr,kr){var Cr=[],$r=_r,Nr=this;this.annotationList_.updateSpan(new Span(_r,vr-_r),function(Br,Fr){var Vr={};for(var Rr in Br.attributes)Vr[Rr]=Br.attributes[Rr];(!Vr[ATTR.LINE_SENTINEL]||kr)&&xr(Vr);var Gr={},qr={};return Nr.computeChangedAttributes_(Br.attributes,Vr,Gr,qr),br(Gr)||Cr.push({start:$r,end:$r+Fr,attributes:Gr,attributesInverse:qr,origin:wr}),$r+=Fr,new yr(Vr)}),Cr.length>0&&this.trigger("attributesChange",this,Cr)},ur.prototype.computeChangedAttributes_=function(_r,vr,xr,wr){var kr={},Cr;for(Cr in _r)kr[Cr]=!0;for(Cr in vr)kr[Cr]=!0;for(Cr in kr)Cr in vr?Cr in _r?_r[Cr]!==vr[Cr]&&(xr[Cr]=vr[Cr],wr[Cr]=_r[Cr]):(xr[Cr]=vr[Cr],wr[Cr]=!1):(xr[Cr]=!1,wr[Cr]=_r[Cr])},ur.prototype.toggleLineAttribute=function(_r,vr){var xr=this.getCurrentLineAttributes_(),wr;!(_r in xr)||xr[_r]!==vr?wr=vr:wr=!1,this.setLineAttribute(_r,wr)},ur.prototype.setLineAttribute=function(_r,vr){this.updateLineAttributesForSelection(function(xr){vr===!1?delete xr[_r]:xr[_r]=vr})},ur.prototype.updateLineAttributesForSelection=function(_r){var vr=this.codeMirror,xr=vr.getCursor("start"),wr=vr.getCursor("end"),kr=xr.line,Cr=wr.line,$r=vr.getLine(Cr),Nr=this.areLineSentinelCharacters_($r.substr(0,wr.ch));Cr>kr&&Nr&&Cr--,this.updateLineAttributes(kr,Cr,_r)},ur.prototype.updateLineAttributes=function(_r,vr,xr){for(var wr=_r;wr<=vr;wr++){var kr=this.codeMirror.getLine(wr),Cr=this.codeMirror.indexFromPos({line:wr,ch:0});if(kr[0]!==hr){var $r={};$r[ATTR.LINE_SENTINEL]=!0,xr($r),this.insertText(Cr,hr,$r)}else this.updateTextAttributes(Cr,Cr+1,xr,null,!0)}},ur.prototype.replaceText=function(_r,vr,xr,wr,kr){this.changeId_++;var Cr=or+this.changeId_;this.outstandingChanges_[Cr]={origOrigin:kr,attributes:wr};var $r=this.codeMirror,Nr=$r.posFromIndex(_r),Br=typeof vr=="number"?$r.posFromIndex(vr):null;$r.replaceRange(xr,Nr,Br,Cr)},ur.prototype.insertText=function(_r,vr,xr,wr){var kr=this.codeMirror,Cr=kr.getCursor(),$r=wr=="RTCMADAPTER"&&!kr.somethingSelected()&&_r==kr.indexFromPos(Cr);this.replaceText(_r,null,vr,xr,wr),$r&&kr.setCursor(Cr)},ur.prototype.removeText=function(_r,vr,xr){var wr=this.codeMirror;wr.replaceRange("",wr.posFromIndex(_r),wr.posFromIndex(vr),xr)},ur.prototype.insertEntityAtCursor=function(_r,vr,xr){var wr=this.codeMirror,kr=wr.indexFromPos(wr.getCursor("head"));this.insertEntityAt(kr,_r,vr,xr)},ur.prototype.insertEntityAt=function(_r,vr,xr,wr){this.codeMirror,this.insertEntity_(_r,new Entity(vr,xr),wr)},ur.prototype.insertEntity_=function(_r,vr,xr){this.replaceText(_r,null,fr,vr.toAttributes(),xr)},ur.prototype.getAttributeSpans=function(_r,vr){for(var xr=[],wr=this.annotationList_.getAnnotatedSpansForSpan(new Span(_r,vr-_r)),kr=0;kr<wr.length;kr++)xr.push({length:wr[kr].length,attributes:wr[kr].annotation.attributes});return xr},ur.prototype.end=function(){var _r=this.codeMirror.lineCount()-1;return this.codeMirror.indexFromPos({line:_r,ch:this.codeMirror.getLine(_r).length})},ur.prototype.getRange=function(_r,vr){var xr=this.codeMirror.posFromIndex(_r),wr=this.codeMirror.posFromIndex(vr);return this.codeMirror.getRange(xr,wr)},ur.prototype.initAnnotationList_=function(){var _r=this.end();_r!==0&&this.annotationList_.insertAnnotatedSpan(new Span(0,_r),new yr)},ur.prototype.onAnnotationsChanged_=function(_r,vr){var xr,wr={};this.tryToUpdateEntitiesInPlace(_r,vr);for(var kr=0;kr<_r.length;kr++){var Cr=_r[kr].annotation.attributes;ATTR.LINE_SENTINEL in Cr&&(wr[this.codeMirror.posFromIndex(_r[kr].pos).line]=!0),xr=_r[kr].getAttachedObject(),xr&&xr.clear()}for(kr=0;kr<vr.length;kr++){var $r=vr[kr].annotation,Nr=ATTR.LINE_SENTINEL in $r.attributes,Br=ATTR.ENTITY_SENTINEL in $r.attributes,Fr=this.codeMirror.posFromIndex(vr[kr].pos);if(Nr)wr[Fr.line]=!0;else if(Br)this.markEntity_(vr[kr]);else{var Vr=this.getClassNameForAttributes_($r.attributes);if(Vr!==""){var Rr=this.codeMirror.posFromIndex(vr[kr].pos+vr[kr].length);xr=this.codeMirror.markText(Fr,Rr,{className:Vr}),vr[kr].attachObject(xr)}}}for(var Gr in wr)this.dirtyLines_.push(this.codeMirror.getLineHandle(Number(Gr))),this.queueLineMarking_()},ur.prototype.tryToUpdateEntitiesInPlace=function(_r,vr){for(var xr=_r.length;xr--;)for(var wr=_r[xr],kr=vr.length;kr--;){var Cr=vr[kr];if(wr.pos==Cr.pos&&wr.length==Cr.length&&wr.annotation.attributes.ent&&wr.annotation.attributes.ent==Cr.annotation.attributes.ent){var $r=Cr.annotation.attributes.ent;if(this.entityManager_.entitySupportsUpdate($r)){_r.splice(xr,1),vr.splice(kr,1);var Nr=wr.getAttachedObject();Nr.update(Cr.annotation.attributes),Cr.attachObject(Nr)}}}},ur.prototype.queueLineMarking_=function(){if(this.lineMarkTimeout_==null){var _r=this;this.lineMarkTimeout_=setTimeout(function(){_r.lineMarkTimeout_=null;for(var vr=[],xr=0;xr<_r.dirtyLines_.length;xr++){var wr=_r.codeMirror.getLineNumber(_r.dirtyLines_[xr]);vr.push(Number(wr))}_r.dirtyLines_=[],vr.sort(function($r,Nr){return $r-Nr});var kr=-1;for(xr=0;xr<vr.length;xr++){var Cr=vr[xr];Cr>kr&&(kr=_r.markLineSentinelCharactersForChangedLines_(Cr,Cr))}},0)}},ur.prototype.addStyleWithCSS_=function(_r){var vr=document.getElementsByTagName("head")[0],xr=document.createElement("style");xr.type="text/css",xr.styleSheet?xr.styleSheet.cssText=_r:xr.appendChild(document.createTextNode(_r)),vr.appendChild(xr)},ur.prototype.getClassNameForAttributes_=function(_r){var vr="";for(var xr in _r){var wr=_r[xr];if(xr===ATTR.LINE_SENTINEL)utils.assert(wr===!0,"LINE_SENTINEL attribute should be true if it exists.");else{var kr=(this.options_.cssPrefix||lr)+xr;if(wr!==!0){xr===ATTR.FONT_SIZE&&typeof wr!="string"&&(wr=wr+"px");var Cr=wr.toString().toLowerCase().replace(/[^a-z0-9-_]/g,"-");if(kr+="-"+Cr,ar[xr]&&(cr[xr]||(cr[xr]={}),!cr[xr][Cr])){cr[xr][Cr]=!0;var $r=ar[xr],Nr=typeof $r=="function"?$r(wr):$r+": "+wr,Br=xr==ATTR.LINE_INDENT?"pre."+kr:"."+kr;if(this.addStyleWithCSS_(Br+" { "+Nr+" }"),xr===ATTR.LINE_INDENT){var Br="pre.CodeMirror-line."+kr;this.addStyleWithCSS_(Br+" { "+Nr+" }")}}}vr=vr+" "+kr}}return vr},ur.prototype.markEntity_=function(_r){for(var vr=_r.annotation.attributes,xr=Entity.fromAttributes(vr),wr=this.codeMirror,kr=this,Cr=[],$r=0;$r<_r.length;$r++){var Nr=wr.posFromIndex(_r.pos+$r),Br=wr.posFromIndex(_r.pos+$r+1),Fr={collapsed:!0,atomic:!0,inclusiveLeft:!1,inclusiveRight:!1},Vr=this.createEntityHandle_(xr,_r.pos),Rr=this.entityManager_.renderToElement(xr,Vr);Rr&&(Fr.replacedWith=Rr);var Gr=wr.markText(Nr,Br,Fr);Cr.push(Gr),Vr.setMarker(Gr)}_r.attachObject({clear:function(){for(var qr=0;qr<Cr.length;qr++)Cr[qr].clear()},update:function(qr){for(var Ur=Entity.fromAttributes(qr),Yr=0;Yr<Cr.length;Yr++)kr.entityManager_.updateElement(Ur,Cr[Yr].replacedWith)}}),this.queueRefresh_()},ur.prototype.queueRefresh_=function(){var _r=this;this.refreshTimer_||(this.refreshTimer_=setTimeout(function(){_r.codeMirror.refresh(),_r.refreshTimer_=null},0))},ur.prototype.createEntityHandle_=function(_r,vr){var xr=null,wr=this;function kr(){if(xr){var Br=xr.find();return Br?wr.codeMirror.indexFromPos(Br.from):null}else return vr}function Cr(){var Br=kr();Br!=null&&(wr.codeMirror.focus(),wr.removeText(Br,Br+1))}function $r(Br){var Fr=ATTR.ENTITY_SENTINEL,Vr=Fr+"_",Rr=kr();wr.updateTextAttributes(Rr,Rr+1,function(Gr){for(var qr in Gr)delete Gr[qr];Gr[Fr]=_r.type;for(var Ur in Br)Gr[Vr+Ur]=Br[Ur]})}function Nr(Br){xr=Br}return{find:kr,remove:Cr,replace:$r,setMarker:Nr}},ur.prototype.lineClassRemover_=function(_r){var vr=this.codeMirror,xr=vr.getLineHandle(_r);return{clear:function(){vr.removeLineClass(xr,"text",".*")}}},ur.prototype.emptySelection_=function(){var _r=this.codeMirror.getCursor("start"),vr=this.codeMirror.getCursor("end");return _r.line===vr.line&&_r.ch===vr.ch},ur.prototype.onCodeMirrorBeforeChange_=function(_r,vr){if(vr.origin==="+input"||vr.origin==="paste"){for(var xr=[],wr=0;wr<vr.text.length;wr++){var kr=vr.text[wr];kr=kr.replace(new RegExp("["+hr+fr+"]","g"),""),xr.push(kr)}vr.update(vr.from,vr.to,xr)}};function dr(_r,vr){return _r.line-vr.line||_r.ch-vr.ch}function pr(_r,vr){return dr(_r,vr)<=0}function mr(_r){return _r[_r.length-1]}function gr(_r){if(_r.length===0)return 0;for(var vr=0,xr=0;xr<_r.length;xr++)vr+=_r[xr].length;return vr+_r.length-1}ur.prototype.onCodeMirrorChange_=function(_r,vr){if(typeof vr.from=="object"){for(var xr=[];vr;)xr.push(vr),vr=vr.next;vr=xr}for(var wr=this.convertCoordinateSystemForChanges_(vr),kr=[],Cr=0;Cr<wr.length;Cr++){var $r=wr[Cr],Nr=$r.start;$r.end;var Br=$r.text,Fr=$r.removed,Vr=$r.origin;if(Fr.length>0){for(var Rr=this.annotationList_.getAnnotatedSpansForSpan(new Span(Nr,Fr.length)),Gr=0,qr=0;qr<Rr.length;qr++){var Ur=Rr[qr];kr.push({start:Nr,end:Nr+Ur.length,removedAttributes:Ur.annotation.attributes,removed:Fr.substr(Gr,Ur.length),attributes:{},text:"",origin:$r.origin}),Gr+=Ur.length}this.annotationList_.removeSpan(new Span(Nr,Fr.length))}if(Br.length>0){var Yr;$r.origin==="+input"||$r.origin==="paste"?Yr=this.currentAttributes_||{}:Vr in this.outstandingChanges_?(Yr=this.outstandingChanges_[Vr].attributes,Vr=this.outstandingChanges_[Vr].origOrigin,delete this.outstandingChanges_[Vr]):Yr={},this.annotationList_.insertAnnotatedSpan(new Span(Nr,Br.length),new yr(Yr)),kr.push({start:Nr,end:Nr,removedAttributes:{},removed:"",text:Br,attributes:Yr,origin:Vr})}}this.markLineSentinelCharactersForChanges_(vr),kr.length>0&&this.trigger("change",this,kr)},ur.prototype.convertCoordinateSystemForChanges_=function(_r){var vr=this,xr=function(Vr){return vr.codeMirror.indexFromPos(Vr)};function wr(Vr,Rr){return function(Gr){return pr(Gr,Rr.from)?Vr(Gr):pr(Rr.to,Gr)?Vr({line:Gr.line+Rr.text.length-1-(Rr.to.line-Rr.from.line),ch:Rr.to.line<Gr.line?Gr.ch:Rr.text.length<=1?Gr.ch-(Rr.to.ch-Rr.from.ch)+gr(Rr.text):Gr.ch-Rr.to.ch+mr(Rr.text).length})+gr(Rr.removed)-gr(Rr.text):Rr.from.line===Gr.line?Vr(Rr.from)+Gr.ch-Rr.from.ch:Vr(Rr.from)+gr(Rr.removed.slice(0,Gr.line-Rr.from.line))+1+Gr.ch}}for(var kr=[],Cr=_r.length-1;Cr>=0;Cr--){var $r=_r[Cr];xr=wr(xr,$r);var Nr=xr($r.from),Br=$r.removed.join(`
`),Fr=$r.text.join(`
`);kr.unshift({start:Nr,end:Nr+Br.length,removed:Br,text:Fr,origin:$r.origin})}return kr},ur.prototype.markLineSentinelCharactersForChanges_=function(_r){for(var vr=Number.MAX_VALUE,xr=-1,wr=0;wr<_r.length;wr++){var kr=_r[wr],Cr=kr.from.line;kr.from.ch,(kr.removed.length>1||kr.removed[0].indexOf(hr)>=0)&&(vr=Math.min(vr,Cr),xr=Math.max(xr,Cr)),kr.text.length>1?(vr=Math.min(vr,Cr),xr=Math.max(xr,Cr+kr.text.length-1)):kr.text[0].indexOf(hr)>=0&&(vr=Math.min(vr,Cr),xr=Math.max(xr,Cr))}xr=Math.min(xr,this.codeMirror.lineCount()-1),this.markLineSentinelCharactersForChangedLines_(vr,xr)},ur.prototype.markLineSentinelCharactersForChangedLines_=function(_r,vr){if(_r<Number.MAX_VALUE)for(;_r>0&&this.lineIsListItemOrIndented_(_r-1);)_r--;if(vr>-1)for(var xr=this.codeMirror.lineCount();vr+1<xr&&this.lineIsListItemOrIndented_(vr+1);)vr++;for(var wr=[],kr=this.codeMirror,Cr=_r;Cr<=vr;Cr++){var $r=kr.getLine(Cr),Nr=kr.getLineHandle(Cr);if(kr.removeLineClass(Nr,"text",".*"),$r.length>0)for(var Br=$r.indexOf(hr);Br>=0;){for(var Fr=Br;Br<$r.length&&$r[Br]===hr;){for(var Vr=kr.findMarksAt({line:Cr,ch:Br}),Rr=0;Rr<Vr.length;Rr++)Vr[Rr].isForLineSentinel&&Vr[Rr].clear();Br++}this.markLineSentinelCharacters_(Cr,Fr,Br,wr),Br=$r.indexOf(hr,Br)}else wr=[]}return vr},ur.prototype.markLineSentinelCharacters_=function(_r,vr,xr,wr){var kr=this.codeMirror,Cr=null,Gr=null,$r=function(){var qr=Gr.find();return qr?qr.from.line:null};if(vr===0){var Nr=this.getLineAttributes_(_r),Br=Nr[ATTR.LIST_TYPE],Fr=Nr[ATTR.LINE_INDENT]||0;for(Br&&Fr===0&&(Fr=1);Fr>=wr.length;)wr.push(1);Br==="o"?(Cr=this.makeOrderedListElement_(wr[Fr]),wr[Fr]++):Br==="u"?(Cr=this.makeUnorderedListElement_(),wr[Fr]=1):Br==="t"?(Cr=this.makeTodoListElement_(!1,$r),wr[Fr]=1):Br==="tc"&&(Cr=this.makeTodoListElement_(!0,$r),wr[Fr]=1);var Vr=this.getClassNameForAttributes_(Nr);Vr!==""&&this.codeMirror.addLineClass(_r,"text",Vr),wr[Fr+1]=1}var Rr={inclusiveLeft:!0,collapsed:!0};Cr&&(Rr.replacedWith=Cr);var Gr=kr.markText({line:_r,ch:vr},{line:_r,ch:xr},Rr);Gr.isForLineSentinel=!0},ur.prototype.makeOrderedListElement_=function(_r){return utils.elt("div",_r+".",{class:"firepad-list-left"})},ur.prototype.makeUnorderedListElement_=function(){return utils.elt("div","•",{class:"firepad-list-left"})},ur.prototype.toggleTodo=function(_r){var vr=ATTR.LIST_TYPE,xr=this.getCurrentLineAttributes_(),wr;!(vr in xr)||xr[vr]!=="t"&&xr[vr]!=="tc"?wr="t":xr[vr]==="t"?wr="tc":xr[vr]==="tc"&&(wr=_r?"t":!1),this.setLineAttribute(vr,wr)},ur.prototype.makeTodoListElement_=function(_r,vr){var xr={type:"checkbox",class:"firepad-todo-left"};_r&&(xr.checked=!0);var wr=utils.elt("input",!1,xr),kr=this;return utils.on(wr,"click",utils.stopEventAnd(function(Cr){kr.codeMirror.setCursor({line:vr(),ch:1}),kr.toggleTodo(!0)})),wr},ur.prototype.lineIsListItemOrIndented_=function(_r){var vr=this.getLineAttributes_(_r);return(vr[ATTR.LIST_TYPE]||!1)!==!1||(vr[ATTR.LINE_INDENT]||0)!==0},ur.prototype.onCursorActivity_=function(){var _r=this;setTimeout(function(){_r.updateCurrentAttributes_()},1)},ur.prototype.getCurrentAttributes_=function(){return this.currentAttributes_||this.updateCurrentAttributes_(),this.currentAttributes_},ur.prototype.updateCurrentAttributes_=function(){var _r=this.codeMirror,vr=_r.indexFromPos(_r.getCursor("anchor")),xr=_r.indexFromPos(_r.getCursor("head")),wr=xr;if(vr>xr){for(;wr<this.end();){var kr=this.getRange(wr,wr+1);if(kr!==`
`&&kr!==hr)break;wr++}wr<this.end()&&wr++}else for(;wr>0&&(kr=this.getRange(wr-1,wr),!(kr!==`
`&&kr!==hr));)wr--;var Cr=this.annotationList_.getAnnotatedSpansForPos(wr);this.currentAttributes_={};var $r={};Cr.length>0&&!(ATTR.LINE_SENTINEL in Cr[0].annotation.attributes)?$r=Cr[0].annotation.attributes:Cr.length>1&&(utils.assert(!(ATTR.LINE_SENTINEL in Cr[1].annotation.attributes),"Cursor can't be between two line sentinel characters."),$r=Cr[1].annotation.attributes);for(var Nr in $r)Nr!=="l"&&Nr!=="lt"&&Nr!=="li"&&Nr.indexOf(ATTR.ENTITY_SENTINEL)!==0&&(this.currentAttributes_[Nr]=$r[Nr])},ur.prototype.getCurrentLineAttributes_=function(){var _r=this.codeMirror,vr=_r.getCursor("anchor"),xr=_r.getCursor("head"),wr=xr.line;return xr.ch===0&&vr.line<xr.line&&wr--,this.getLineAttributes_(wr)},ur.prototype.getLineAttributes_=function(_r){var vr={},xr=this.codeMirror.getLine(_r);if(xr.length>0&&xr[0]===hr){var wr=this.codeMirror.indexFromPos({line:_r,ch:0}),kr=this.annotationList_.getAnnotatedSpansForSpan(new Span(wr,1));utils.assert(kr.length===1);for(var Cr in kr[0].annotation.attributes)vr[Cr]=kr[0].annotation.attributes[Cr]}return vr},ur.prototype.clearAnnotations_=function(){this.annotationList_.updateSpan(new Span(0,this.end()),function(_r,vr){return new yr({})})},ur.prototype.newline=function(){var _r=this.codeMirror,vr=this;if(!this.emptySelection_())_r.replaceSelection(`
`,"end","+input");else{var xr=_r.getCursor("head").line,wr=this.getLineAttributes_(xr),kr=wr[ATTR.LIST_TYPE];kr&&_r.getLine(xr).length===1?this.updateLineAttributes(xr,xr,function(Cr){delete Cr[ATTR.LIST_TYPE],delete Cr[ATTR.LINE_INDENT]}):(_r.replaceSelection(`
`,"end","+input"),this.updateLineAttributes(xr+1,xr+1,function(Cr){for(var $r in wr)Cr[$r]=wr[$r];kr==="tc"&&(Cr[ATTR.LIST_TYPE]="t"),vr.trigger("newLine",{line:xr+1,attr:Cr})}))}},ur.prototype.deleteLeft=function(){var _r=this.codeMirror,vr=_r.getCursor("head"),xr=this.getLineAttributes_(vr.line),wr=xr[ATTR.LIST_TYPE],kr=xr[ATTR.LINE_INDENT],Cr=this.emptySelection_()&&vr.ch===1;Cr&&wr?this.updateLineAttributes(vr.line,vr.line,function($r){delete $r[ATTR.LIST_TYPE],delete $r[ATTR.LINE_INDENT]}):Cr&&kr&&kr>0?this.unindent():_r.deleteH(-1,"char")},ur.prototype.deleteRight=function(){var _r=this.codeMirror,vr=_r.getCursor("head"),xr=_r.getLine(vr.line),wr=this.areLineSentinelCharacters_(xr),kr=vr.line+1<_r.lineCount()?_r.getLine(vr.line+1):"";this.emptySelection_()&&wr&&kr[0]===hr?(_r.replaceRange("",{line:vr.line,ch:0},{line:vr.line+1,ch:0},"+input"),_r.setCursor({line:vr.line,ch:0})):_r.deleteH(1,"char")},ur.prototype.indent=function(){this.updateLineAttributesForSelection(function(_r){var vr=_r[ATTR.LINE_INDENT],xr=_r[ATTR.LIST_TYPE];vr?_r[ATTR.LINE_INDENT]++:xr?_r[ATTR.LINE_INDENT]=2:_r[ATTR.LINE_INDENT]=1})},ur.prototype.unindent=function(){this.updateLineAttributesForSelection(function(_r){var vr=_r[ATTR.LINE_INDENT];vr&&vr>1?_r[ATTR.LINE_INDENT]=vr-1:(delete _r[ATTR.LIST_TYPE],delete _r[ATTR.LINE_INDENT])})},ur.prototype.getText=function(){return this.codeMirror.getValue().replace(new RegExp(hr,"g"),"")},ur.prototype.areLineSentinelCharacters_=function(_r){for(var vr=0;vr<_r.length;vr++)if(_r[vr]!==hr)return!1;return!0};function yr(_r){this.attributes=_r||{}}yr.prototype.equals=function(_r){if(!(_r instanceof yr))return!1;var vr;for(vr in this.attributes)if(_r.attributes[vr]!==this.attributes[vr])return!1;for(vr in _r.attributes)if(_r.attributes[vr]!==this.attributes[vr])return!1;return!0};function br(_r){for(var vr in _r)return!1;return!0}function Or(_r,vr){var xr=_r[vr];_r[vr]=function(){xr.apply(_r,arguments)}}return ur}(),RichTextToolbar=function(lr){function or(ar){this.imageInsertionUI=ar,this.element_=this.makeElement_()}return utils.makeEventEmitter(or,["bold","italic","underline","strike","font","font-size","color","left","center","right","unordered-list","ordered-list","todo-list","indent-increase","indent-decrease","undo","redo","insert-image"]),or.prototype.element=function(){return this.element_},or.prototype.makeButton_=function(ar,cr){var ur=this;cr=cr||ar;var hr=utils.elt("a",[utils.elt("span","",{class:"firepad-tb-"+cr})],{class:"firepad-btn"});return utils.on(hr,"click",utils.stopEventAnd(function(){ur.trigger(ar)})),hr},or.prototype.makeElement_=function(){var ar=this,cr=this.makeFontDropdown_(),ur=this.makeFontSizeDropdown_(),hr=this.makeColorDropdown_(),fr=[utils.elt("div",[cr],{class:"firepad-btn-group"}),utils.elt("div",[ur],{class:"firepad-btn-group"}),utils.elt("div",[hr],{class:"firepad-btn-group"}),utils.elt("div",[ar.makeButton_("bold"),ar.makeButton_("italic"),ar.makeButton_("underline"),ar.makeButton_("strike","strikethrough")],{class:"firepad-btn-group"}),utils.elt("div",[ar.makeButton_("unordered-list","list-2"),ar.makeButton_("ordered-list","numbered-list"),ar.makeButton_("todo-list","list")],{class:"firepad-btn-group"}),utils.elt("div",[ar.makeButton_("indent-decrease"),ar.makeButton_("indent-increase")],{class:"firepad-btn-group"}),utils.elt("div",[ar.makeButton_("left","paragraph-left"),ar.makeButton_("center","paragraph-center"),ar.makeButton_("right","paragraph-right")],{class:"firepad-btn-group"}),utils.elt("div",[ar.makeButton_("undo"),ar.makeButton_("redo")],{class:"firepad-btn-group"})];ar.imageInsertionUI&&fr.push(utils.elt("div",[ar.makeButton_("insert-image")],{class:"firepad-btn-group"}));var dr=utils.elt("div",fr,{class:"firepad-toolbar-wrapper"}),pr=utils.elt("div",null,{class:"firepad-toolbar"});return pr.appendChild(dr),pr},or.prototype.makeFontDropdown_=function(){for(var ar=["Arial","Comic Sans MS","Courier New","Impact","Times New Roman","Verdana"],cr=[],ur=0;ur<ar.length;ur++){var hr=utils.elt("span",ar[ur]);hr.setAttribute("style","font-family:"+ar[ur]),cr.push({content:hr,value:ar[ur]})}return this.makeDropdown_("Font","font",cr)},or.prototype.makeFontSizeDropdown_=function(){for(var ar=[9,10,12,14,18,24,32,42],cr=[],ur=0;ur<ar.length;ur++){var hr=utils.elt("span",ar[ur].toString());hr.setAttribute("style","font-size:"+ar[ur]+"px; line-height:"+(ar[ur]-6)+"px;"),cr.push({content:hr,value:ar[ur]})}return this.makeDropdown_("Size","font-size",cr,"px")},or.prototype.makeColorDropdown_=function(){for(var ar=["black","red","green","blue","yellow","cyan","magenta","grey"],cr=[],ur=0;ur<ar.length;ur++){var hr=utils.elt("div");hr.className="firepad-color-dropdown-item",hr.setAttribute("style","background-color:"+ar[ur]),cr.push({content:hr,value:ar[ur]})}return this.makeDropdown_("Color","color",cr)},or.prototype.makeDropdown_=function(ar,cr,ur,hr){hr=hr||"";var fr=this,dr=utils.elt("a",ar+" ▾",{class:"firepad-btn firepad-dropdown"}),pr=utils.elt("ul",[],{class:"firepad-dropdown-menu"});dr.appendChild(pr);var mr=!1;function gr(){mr||(pr.style.display="block",utils.on(document,"click",br,!0),mr=!0)}var yr=!1;function br(){mr&&(pr.style.display="",utils.off(document,"click",br,!0),mr=!1),yr=!0,setTimeout(function(){yr=!1},0)}function Or(wr,kr){typeof wr!="object"&&(wr=document.createTextNode(String(wr)));var Cr=utils.elt("a",[wr]);utils.on(Cr,"click",utils.stopEventAnd(function(){br(),fr.trigger(cr,kr+hr)})),pr.appendChild(Cr)}for(var _r=0;_r<ur.length;_r++){var vr=ur[_r].content,xr=ur[_r].value;Or(vr,xr)}return utils.on(dr,"click",utils.stopEventAnd(function(){yr||gr()})),dr},or}(),ACEAdapter=function(){class lr{constructor(ar){var cr;this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),this.ace=ar,this.aceSession=this.ace.getSession(),this.aceDoc=this.aceSession.getDocument(),this.aceDoc.setNewLineMode("unix"),this.grabDocumentState(),this.ace.on("change",this.onChange),this.ace.on("blur",this.onBlur),this.ace.on("focus",this.onFocus),this.aceSession.selection.on("changeCursor",this.onCursorActivity),this.aceRange==null&&(this.aceRange=((cr=ace.require)!=null?cr:require)("ace/range").Range)}grabDocumentState(){return this.lastDocLines=this.aceDoc.getAllLines(),this.lastCursorRange=this.aceSession.selection.getRange()}detach(){return this.ace.removeListener("change",this.onChange),this.ace.removeListener("blur",this.onBlur),this.ace.removeListener("focus",this.onFocus),this.aceSession.selection.removeListener("changeCursor",this.onCursorActivity)}onChange(ar){var cr;if(!this.ignoreChanges)return cr=this.operationFromACEChange(ar),this.trigger("change",...cr),this.grabDocumentState()}onBlur(){if(this.ace.selection.isEmpty())return this.trigger("blur")}onFocus(){return this.trigger("focus")}onCursorActivity(){return setTimeout(()=>this.trigger("cursorActivity"),0)}operationFromACEChange(ar){var cr,ur,hr,fr,dr,pr,mr;return ar.data?(ur=ar.data,(fr=ur.action)==="insertLines"||fr==="removeLines"?(mr=ur.lines.join(`
`)+`
`,ur.action.replace("Lines","")):(mr=ur.text.replace(this.aceDoc.getNewLineCharacter(),`
`),ur.action.replace("Text","")),pr=this.indexFromPos(ur.range.start)):(mr=ar.lines.join(`
`),pr=this.indexFromPos(ar.start)),dr=this.lastDocLines.join(`
`).length-pr,ar.action==="remove"&&(dr-=mr.length),hr=new TextOperation().retain(pr).insert(mr).retain(dr),cr=new TextOperation().retain(pr).delete(mr).retain(dr),ar.action==="remove"?[cr,hr]:[hr,cr]}applyOperationToACE(ar){var cr,ur,hr,fr,dr,pr,mr,gr;for(ur=0,mr=ar.ops,hr=0,fr=mr.length;hr<fr;hr++)dr=mr[hr],dr.isRetain()?ur+=dr.chars:dr.isInsert()?(this.aceDoc.insert(this.posFromIndex(ur),dr.text),ur+=dr.text.length):dr.isDelete()&&(cr=this.posFromIndex(ur),gr=this.posFromIndex(ur+dr.chars),pr=this.aceRange.fromPoints(cr,gr),this.aceDoc.remove(pr));return this.grabDocumentState()}posFromIndex(ar){var cr,ur,hr,fr,dr;for(fr=this.aceDoc.$lines,dr=cr=0,ur=fr.length;cr<ur&&(hr=fr[dr],!(ar<=hr.length));dr=++cr)ar-=hr.length+1;return{row:dr,column:ar}}indexFromPos(ar,cr){var ur,hr,fr,dr;for(cr==null&&(cr=this.lastDocLines),hr=0,ur=fr=0,dr=ar.row;0<=dr?fr<dr:fr>dr;ur=0<=dr?++fr:--fr)hr+=this.lastDocLines[ur].length+1;return hr+=ar.column}getValue(){return this.aceDoc.getValue()}getCursor(){var ar,cr,ur;try{ur=this.indexFromPos(this.aceSession.selection.getRange().start,this.aceDoc.$lines),cr=this.indexFromPos(this.aceSession.selection.getRange().end,this.aceDoc.$lines)}catch{try{ur=this.indexFromPos(this.lastCursorRange.start),cr=this.indexFromPos(this.lastCursorRange.end)}catch(fr){ar=fr,console.log("Couldn't figure out the cursor range:",ar,"-- setting it to 0:0."),[ur,cr]=[0,0]}}return ur>cr&&([ur,cr]=[cr,ur]),new Cursor(ur,cr)}setCursor(ar){var cr,ur;return ur=this.posFromIndex(ar.position),cr=this.posFromIndex(ar.selectionEnd),ar.position>ar.selectionEnd&&([ur,cr]=[cr,ur]),this.aceSession.selection.setSelectionRange(new this.aceRange(ur.row,ur.column,cr.row,cr.column))}setOtherCursor(ar,cr,ur){var hr,fr,dr,pr,mr,gr,yr;return this.otherCursors==null&&(this.otherCursors={}),dr=this.otherCursors[ur],dr&&(dr.start.detach(),dr.end.detach(),this.aceSession.removeMarker(dr.id)),yr=this.posFromIndex(ar.position),pr=this.posFromIndex(ar.selectionEnd),ar.selectionEnd<ar.position&&([yr,pr]=[pr,yr]),hr=`other-client-selection-${cr.replace("#","")}`,mr=ar.position===ar.selectionEnd,mr&&(hr=hr.replace("selection","cursor")),fr=`.${hr} {
  position: absolute;
  background-color: ${mr?"transparent":cr};
  border-left: 2px solid ${cr};
}`,this.addStyleRule(fr),this.otherCursors[ur]=dr=new this.aceRange(yr.row,yr.column,pr.row,pr.column),gr=this,dr.clipRows=function(){var br;return br=gr.aceRange.prototype.clipRows.apply(this,arguments),br.isEmpty=function(){return!1},br},dr.start=this.aceDoc.createAnchor(dr.start),dr.end=this.aceDoc.createAnchor(dr.end),dr.id=this.aceSession.addMarker(dr,hr,"text"),{clear:()=>(dr.start.detach(),dr.end.detach(),this.aceSession.removeMarker(dr.id))}}addStyleRule(ar){var cr;if(!(typeof document>"u"||document===null)&&(this.addedStyleRules||(this.addedStyleRules={},cr=document.createElement("style"),document.documentElement.getElementsByTagName("head")[0].appendChild(cr),this.addedStyleSheet=cr.sheet),!this.addedStyleRules[ar]))return this.addedStyleRules[ar]=!0,this.addedStyleSheet.insertRule(ar,0)}registerCallbacks(ar){this.callbacks=ar}trigger(ar,...cr){var ur,hr;return(ur=this.callbacks)!=null&&(hr=ur[ar])!=null?hr.apply(this,cr):void 0}applyOperation(ar){return ar.isNoop()||(this.ignoreChanges=!0),this.applyOperationToACE(ar),this.ignoreChanges=!1}registerUndo(ar){return this.ace.undo=ar}registerRedo(ar){return this.ace.redo=ar}invertOperation(ar){return ar.invert(this.getValue())}}return lr.prototype.ignoreChanges=!1,lr}();var getCSS=function(or,ar,cr){return"."+or+` {
  position: relative;
background-color: `+ar+`;
border-left: 2px solid `+cr+`;
}`},addStyleRule=function(or,ar){if(typeof document>"u"||document===null)return!1;if(this.addedStyleRules.indexOf(or)===-1){var cr=document.createElement("style"),ur=document.createTextNode(ar);cr.appendChild(ur),document.head.appendChild(cr),this.addedStyleRules.push(or)}},MonacoAdapter=function(){function lr(or){if(!or||typeof or.getModel!="function")throw new Error("MonacoAdapter: Incorrect Parameter Recieved in constructor, expected valid Monaco Instance");this.monaco=or,this.monacoModel=this.monaco.getModel(),this.lastDocLines=this.monacoModel.getLinesContent(),this.lastCursorRange=this.monaco.getSelection(),this.callbacks={},this.otherCursors=[],this.addedStyleRules=[],this.ignoreChanges=!1,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),this.changeHandler=this.monaco.onDidChangeModelContent(this.onChange),this.didBlurHandler=this.monaco.onDidBlurEditorWidget(this.onBlur),this.didFocusHandler=this.monaco.onDidFocusEditorWidget(this.onFocus),this.didChangeCursorPositionHandler=this.monaco.onDidChangeCursorPosition(this.onCursorActivity)}return lr.prototype.detach=function(){this.changeHandler.dispose(),this.didBlurHandler.dispose(),this.didFocusHandler.dispose(),this.didChangeCursorPositionHandler.dispose()},lr.prototype.getCursor=function(){var ar=this.monaco.getSelection();(typeof ar>"u"||ar===null)&&(ar=this.lastCursorRange);var cr=ar.getStartPosition(),ur=ar.getEndPosition(),hr=this.monacoModel.getOffsetAt(cr),fr=this.monacoModel.getOffsetAt(ur);if(hr>fr){var dr=[fr,hr];hr=dr[0],fr=dr[1]}return new Cursor(hr,fr)},lr.prototype.setCursor=function(ar){var cr=ar.position,ur=ar.selectionEnd,hr=this.monacoModel.getPositionAt(cr),fr=this.monacoModel.getPositionAt(ur);if(cr>ur){var dr=[fr,hr];hr=dr[0],fr=dr[1]}this.monaco.setSelection(new monaco.Range(hr.lineNumber,hr.column,fr.lineNumber,fr.column))},lr.prototype.setOtherCursor=function(ar,cr,ur){if(typeof ar!="object"||typeof ar.position!="number"||typeof ar.selectionEnd!="number"||typeof cr!="string"||!cr.match(/^#[a-fA-F0-9]{3,6}$/))return!1;var hr=ar.position,fr=ar.selectionEnd;if(hr<0||fr<0)return!1;var dr=this.otherCursors.find(function(vr){return vr.clientID===ur});dr||(dr={clientID:ur,decoration:[]},this.otherCursors.push(dr)),dr.decoration=this.monaco.deltaDecorations(dr.decoration,[]);var pr="other-client-selection-"+cr.replace("#",""),mr,gr;hr===fr?(pr=pr.replace("selection","cursor"),mr=getCSS(pr,"transparent",cr),gr=addStyleRule.call(this,pr,mr)):(mr=getCSS(pr,cr,cr),gr=addStyleRule.call(this,pr,mr)),gr==!1&&console.log(`Monaco Adapter: Failed to add some css style.
Please make sure you're running on supported environment.`);var yr=this.monacoModel.getPositionAt(hr),br=this.monacoModel.getPositionAt(fr);if(hr>fr){var Or=[br,yr];yr=Or[0],br=Or[1]}dr.decoration=this.monaco.deltaDecorations(dr.decoration,[{range:new monaco.Range(yr.lineNumber,yr.column,br.lineNumber,br.column),options:{className:pr}}]);var _r=this;return{clear:function(){dr.decoration=_r.monaco.deltaDecorations(dr.decoration,[])}}},lr.prototype.registerCallbacks=function(ar){this.callbacks=Object.assign({},this.callbacks,ar)},lr.prototype.registerUndo=function(ar){if(typeof ar=="function")this.callbacks.undo=ar;else throw new Error("MonacoAdapter: registerUndo method expects a callback function in parameter")},lr.prototype.registerRedo=function(ar){if(typeof ar=="function")this.callbacks.redo=ar;else throw new Error("MonacoAdapter: registerRedo method expects a callback function in parameter")},lr.prototype.operationFromMonacoChanges=function(ar,cr,ur){var hr=ar.text,fr=ar.rangeLength,dr=ar.rangeOffset,pr=cr.length+ur-dr,mr,gr,yr;return hr.length===0&&fr>0?(yr=cr.slice(dr,dr+fr),mr=new TextOperation().retain(dr).delete(fr).retain(pr-fr),gr=new TextOperation().retain(dr).insert(yr).retain(pr-fr)):hr.length>0&&fr>0?(yr=cr.slice(dr,dr+fr),mr=new TextOperation().retain(dr).delete(fr).insert(hr).retain(pr-fr),gr=new TextOperation().retain(dr).delete(hr.length).insert(yr).retain(pr-fr)):(mr=new TextOperation().retain(dr).insert(hr).retain(pr),gr=new TextOperation().retain(dr).delete(hr).retain(pr)),[mr,gr]},lr.prototype.onChange=function(ar){var cr=this;if(!this.ignoreChanges){var ur=this.lastDocLines.join(this.monacoModel.getEOL()),hr=0;if(!ar.changes){var fr=new TextOperation().retain(ur.length);this.trigger("change",fr,fr)}ar.changes.forEach(function(dr){var pr=cr.operationFromMonacoChanges(dr,ur,hr);hr+=pr[0].targetLength-pr[0].baseLength,cr.trigger.apply(cr,["change"].concat(pr))}),this.lastDocLines=this.monacoModel.getLinesContent()}},lr.prototype.trigger=function(ar){if(this.callbacks.hasOwnProperty(ar)){var cr=this.callbacks[ar];if(!1!=="function"){var ur=[];if(arguments.length>1)for(var hr=1;hr<arguments.length;hr++)ur.push(arguments[hr]);cr.apply(null,ur)}}},lr.prototype.onBlur=function(){this.monaco.getSelection().isEmpty()&&this.trigger("blur")},lr.prototype.onFocus=function(){this.trigger("focus")},lr.prototype.onCursorActivity=function(){var ar=this;setTimeout(function(){return ar.trigger("cursorActivity")},1)},lr.prototype.applyOperation=function(ar){ar.isNoop()||(this.ignoreChanges=!0);var cr=ar.ops,ur=0,hr=this;cr.forEach(function(fr){if(fr.isRetain())ur+=fr.chars;else if(fr.isInsert()){var dr=hr.monacoModel.getPositionAt(ur);hr.monaco.executeEdits("my-source",[{range:new monaco.Range(dr.lineNumber,dr.column,dr.lineNumber,dr.column),text:fr.text,forceMoveMarkers:!0}]),ur+=fr.text.length}else if(fr.isDelete()){var pr=hr.monacoModel.getPositionAt(ur),mr=hr.monacoModel.getPositionAt(ur+fr.chars);hr.monaco.executeEdits("my-source",[{range:new monaco.Range(pr.lineNumber,pr.column,mr.lineNumber,mr.column),text:"",forceMoveMarkers:!0}])}}),this.lastDocLines=this.monacoModel.getLinesContent(),this.ignoreChanges=!1},lr.prototype.invertOperation=function(ar){ar.invert(this.getValue())},lr}();const addCodemirror6listener=lr=>{lr.cm.dispatch({effects:StateEffect.appendConfig.of(lr.cm.constructor.updateListener.of(or=>{if(or.docChanged&&!(or.transactions[0]&&or.transactions[0].annotations.some(ar=>ar.type=="firepad"))){let ar=0,cr=new TextOperation,ur=new TextOperation;or.changes.toJSON().forEach(hr=>{if(typeof hr=="number")hr!=0&&(ar+=hr,cr=cr.retain(hr),ur=ur.retain(hr));else if(typeof hr=="object"){const[fr,...dr]=hr;if(fr>0&&(cr=cr.delete(fr),ur=ur.insert(or.startState.sliceDoc(ar,ar+fr))),dr){const pr=dr.join(`
`);cr=cr.insert(pr),ur=ur.delete(pr.length)}}}),lr.trigger("change",cr,ur)}lr.lastDocLines=lr.cm.state.doc.text}))})};var CodeMirror6Adapter=function(){function lr(or,ar={}){this.options=ar,this.cm=or,this.lastDocLines=this.cm.state.doc.text,this.lastCursorRange=this.cm.state.selection.main,this.callbacks={},this.otherCursors=[],this.addedStyleRules=[],this.ignoreChanges=!1,this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),addCodemirror6listener(this)}return lr.prototype.detach=function(){},lr.prototype.getCursor=function(){var ar=this.cm.state.selection.main;(typeof ar>"u"||ar===null)&&(ar=this.lastCursorRange);var cr=ar.from,ur=ar.to;if(cr>ur){var hr=[ur,cr];cr=hr[0],ur=hr[1]}return new Cursor(cr,ur)},lr.prototype.setCursor=function(ar){var cr=ar.position,ur=ar.selectionEnd;this.cm.dispatch({selection:{anchor:cr,head:ur}})},lr.prototype.setOtherCursor=function(ar,cr,ur){},lr.prototype.registerCallbacks=function(ar){this.callbacks=Object.assign({},this.callbacks,ar)},lr.prototype.registerUndo=function(ar){if(typeof ar=="function")this.callbacks.undo=ar;else throw new Error("CodeMirror6Adapter: registerUndo method expects a callback function in parameter")},lr.prototype.registerRedo=function(ar){if(typeof ar=="function")this.callbacks.redo=ar;else throw new Error("CodeMirror6Adapter: registerRedo method expects a callback function in parameter")},lr.prototype.trigger=function(ar){if(this.callbacks.hasOwnProperty(ar)){var cr=this.callbacks[ar];if(!1!=="function"){var ur=[];if(arguments.length>1)for(var hr=1;hr<arguments.length;hr++)ur.push(arguments[hr]);cr.apply(null,ur)}}},lr.prototype.onBlur=function(){this.monaco.getSelection().isEmpty()&&this.trigger("blur")},lr.prototype.onFocus=function(){this.trigger("focus")},lr.prototype.onCursorActivity=function(){var ar=this;setTimeout(function(){return ar.trigger("cursorActivity")},1)},lr.prototype.applyOperation=function(ar){ar.isNoop()||(this.ignoreChanges=!0);var cr=ar.ops,ur=0,hr=this;cr.forEach(function(fr){fr.isRetain()?ur+=fr.chars:fr.isInsert()?(hr.cm.dispatch({annotations:[Transaction.addToHistory.of(!1),new Annotation("firepad",!0)],changes:{from:ur,to:ur,insert:fr.text}}),ur+=fr.text.length):fr.isDelete()&&hr.cm.dispatch({annotations:[Transaction.addToHistory.of(!1),new Annotation("firepad",!0)],changes:{from:ur,to:ur+fr.chars,insert:""}})}),this.lastDocLines=this.cm.state.doc.text,this.ignoreChanges=!1},lr.prototype.invertOperation=function(ar){ar.invert(this.getValue())},lr}();/*!
 * Firepad is an open-source, collaborative code and text editor. It was designed
 * to be embedded inside larger applications. Since it uses Firebase as a backend,
 * it requires no server-side code and can be added to any web app simply by
 * including a couple JavaScript files.
 *
 * http://www.firepad.io/
 * License: MIT
 * Copyright: 2014 Firebase
 * With code from ot.js (Copyright 2012-2013 Tim Baumann)
 */let global$1;try{global$1=Function("return this")()}catch{global$1=window}const Firepad=function(){var lr=global$1.CodeMirror,or=global$1.ace;global$1.monaco;function ar(fr,dr,pr){if(!(this instanceof ar))return new ar(fr,dr,pr);if(!lr&&!or&&!global$1.monaco&&dr.type!=="CodeMirror6")throw new Error("Couldn't find CodeMirror, ACE or Monaco.  Did you forget to include codemirror.js/ace.js or import monaco?");if(this.zombie_=!1,dr.type==="CodeMirror6"){if(this.codeMirror6_=this.editor_=dr.editor,this.codeMirror6_.state.doc.toString()!=="")throw new Error("Can't initialize Firepad with a CodeMirror6 instance that already contains text.")}else if(lr&&dr instanceof lr){this.codeMirror_=this.editor_=dr;var mr=this.codeMirror_.getValue();if(mr!=="")throw new Error("Can't initialize Firepad with a CodeMirror instance that already contains text.")}else if(or&&dr&&dr.session instanceof or.EditSession){if(this.ace_=this.editor_=dr,mr=this.ace_.getValue(),mr!=="")throw new Error("Can't initialize Firepad with an ACE instance that already contains text.")}else if(global$1.monaco&&dr&&dr instanceof global$1.monaco.constructor){if(global$1.monaco,this.monaco_=this.editor_=dr,mr=this.monaco_.getValue(),mr!=="")throw new Error("Can't initialize Firepad with a Monaco instance that already contains text.")}else this.codeMirror_=this.editor_=new lr(dr);var gr;this.codeMirror6_?gr=this.codeMirror6_.dom:this.codeMirror_?gr=this.codeMirror_.getWrapperElement():this.ace_?gr=this.ace_.container:gr=this.monaco_.getDomNode(),this.firepadWrapper_=utils.elt("div",null,{class:"firepad"}),gr.parentNode.replaceChild(this.firepadWrapper_,gr),this.firepadWrapper_.appendChild(gr),this.editor_.firepad=this,this.options_=pr||{},this.getOption("richTextShortcuts",!1)&&(lr.keyMap.richtext||this.initializeKeyMap_(),this.codeMirror_.setOption("keyMap","richtext"),this.firepadWrapper_.className+=" firepad-richtext"),this.imageInsertionUI=this.getOption("imageInsertionUI",!0),this.getOption("richTextToolbar",!1)&&(this.addToolbar_(),this.firepadWrapper_.className+=" firepad-richtext firepad-with-toolbar"),this.addPoweredByLogo_(),this.codeMirror_&&this.codeMirror_.refresh();var yr=this.getOption("userId",fr.push().key),br=this.getOption("userColor",cr(yr));this.entityManager_=new EntityManager,this.firebaseAdapter_=new FirebaseAdapter(fr,yr,br),this.codeMirror6_?this.editorAdapter_=new CodeMirror6Adapter(this.codeMirror6_,this.options_):this.codeMirror_?(this.richTextCodeMirror_=new RichTextCodeMirror(this.codeMirror_,this.entityManager_,{cssPrefix:"firepad-"}),this.editorAdapter_=new RichTextCodeMirrorAdapter(this.richTextCodeMirror_)):this.ace_?this.editorAdapter_=new ACEAdapter(this.ace_):this.editorAdapter_=new MonacoAdapter(this.monaco_),this.client_=new EditorClient(this.firebaseAdapter_,this.editorAdapter_);var Or=this;this.firebaseAdapter_.on("cursor",function(){Or.trigger.apply(Or,["cursor"].concat([].slice.call(arguments)))}),this.codeMirror_&&this.richTextCodeMirror_.on("newLine",function(){Or.trigger.apply(Or,["newLine"].concat([].slice.call(arguments)))}),this.firebaseAdapter_.on("ready",function(){Or.ready_=!0,Or.ace_&&Or.editorAdapter_.grabDocumentState(),Or.monaco_&&Or.editorAdapter_.grabDocumentState();var _r=Or.getOption("defaultText",null);_r&&Or.isHistoryEmpty()&&Or.setText(_r),Or.trigger("ready")}),this.client_.on("synced",function(_r){Or.trigger("synced",_r)}),navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.match(/MSIE 8\./)&&(window.onload=function(){var _r=document.getElementsByTagName("head")[0],vr=document.createElement("style");vr.type="text/css",vr.styleSheet.cssText=":before,:after{content:none !important;}",_r.appendChild(vr),setTimeout(function(){_r.removeChild(vr)},0)})}utils.makeEventEmitter(ar),ar.fromCodeMirror=ar,ar.fromACE=ar,ar.fromMonaco=ar,ar.fromCodeMirror6=(fr,dr,...pr)=>ar(fr,{type:"CodeMirror6",editor:dr},...pr),ar.prototype.dispose=function(){this.zombie_=!0;var fr;this.codeMirror_?fr=this.codeMirror_.getWrapperElement():this.ace_?fr=this.ace_.container:fr=this.monaco_.getDomNode(),this.firepadWrapper_.removeChild(fr),this.firepadWrapper_.parentNode.replaceChild(fr,this.firepadWrapper_),this.editor_.firepad=null,this.codeMirror_&&this.codeMirror_.getOption("keyMap")==="richtext"&&this.codeMirror_.setOption("keyMap","default"),this.firebaseAdapter_.dispose(),this.editorAdapter_.detach(),this.richTextCodeMirror_&&this.richTextCodeMirror_.detach()},ar.prototype.setUserId=function(fr){this.firebaseAdapter_.setUserId(fr)},ar.prototype.setUserColor=function(fr){this.firebaseAdapter_.setColor(fr)},ar.prototype.getText=function(){return this.assertReady_("getText"),this.codeMirror_?this.richTextCodeMirror_.getText():this.ace_?this.ace_.getSession().getDocument().getValue():this.monaco_.getModel().getValue()},ar.prototype.setText=function(fr){if(this.assertReady_("setText"),this.codeMirror6_)return this.codeMirror6_.dispatch({changes:{from:0,to:this.codeMirror6_.state.doc.length,insert:fr}});if(this.monaco_)return this.monaco_.getModel().setValue(fr);if(this.ace_)return this.ace_.getSession().getDocument().setValue(fr);this.codeMirror_.getWrapperElement().style.display="none",this.codeMirror_.setValue(""),this.insertText(0,fr),this.codeMirror_.getWrapperElement().style.display="",this.codeMirror_.refresh(),this.editorAdapter_.setCursor({position:0,selectionEnd:0})},ar.prototype.insertTextAtCursor=function(fr){this.insertText(this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()),fr)},ar.prototype.insertText=function(fr,dr){utils.assert(!this.ace_,"Not supported for ace yet."),utils.assert(!this.monaco_,"Not supported for monaco yet."),this.assertReady_("insertText"),Object.prototype.toString.call(dr)!=="[object Array]"&&(dr=[dr]);var pr=this;pr.codeMirror_.operation(function(){for(var mr=fr===0,gr=textPiecesToInserts(mr,dr),yr=0;yr<gr.length;yr++){var br=gr[yr].string,Or=gr[yr].attributes;pr.richTextCodeMirror_.insertText(fr,br,Or),fr+=br.length}})},ar.prototype.getOperationForSpan=function(fr,dr){for(var pr=this.richTextCodeMirror_.getRange(fr,dr),mr=this.richTextCodeMirror_.getAttributeSpans(fr,dr),gr=0,yr=new TextOperation,br=0;br<mr.length;br++)yr.insert(pr.substr(gr,mr[br].length),mr[br].attributes),gr+=mr[br].length;return yr},ar.prototype.getHtml=function(){return this.getHtmlFromRange(null,null)},ar.prototype.getHtmlFromSelection=function(){var fr=this.codeMirror_.getCursor("start"),dr=this.codeMirror_.getCursor("end"),pr=this.codeMirror_.indexFromPos(fr),mr=this.codeMirror_.indexFromPos(dr);return this.getHtmlFromRange(pr,mr)},ar.prototype.getHtmlFromRange=function(fr,dr){this.assertReady_("getHtmlFromRange");var pr=fr!=null&&dr!=null?this.getOperationForSpan(fr,dr):this.getOperationForSpan(0,this.codeMirror_.getValue().length);return SerializeHtml(pr,this.entityManager_)},ar.prototype.insertHtml=function(fr,dr){var pr=ParseHtml(dr,this.entityManager_);this.insertText(fr,pr)},ar.prototype.insertHtmlAtCursor=function(fr){this.insertHtml(this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()),fr)},ar.prototype.setHtml=function(fr){var dr=ParseHtml(fr,this.entityManager_);this.setText(dr)},ar.prototype.isHistoryEmpty=function(){return this.assertReady_("isHistoryEmpty"),this.firebaseAdapter_.isHistoryEmpty()},ar.prototype.bold=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.BOLD),this.codeMirror_.focus()},ar.prototype.italic=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.ITALIC),this.codeMirror_.focus()},ar.prototype.underline=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.UNDERLINE),this.codeMirror_.focus()},ar.prototype.strike=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.STRIKE),this.codeMirror_.focus()},ar.prototype.fontSize=function(fr){this.richTextCodeMirror_.setAttribute(ATTR.FONT_SIZE,fr),this.codeMirror_.focus()},ar.prototype.font=function(fr){this.richTextCodeMirror_.setAttribute(ATTR.FONT,fr),this.codeMirror_.focus()},ar.prototype.color=function(fr){this.richTextCodeMirror_.setAttribute(ATTR.COLOR,fr),this.codeMirror_.focus()},ar.prototype.highlight=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.BACKGROUND_COLOR,"rgba(255,255,0,.65)"),this.codeMirror_.focus()},ar.prototype.align=function(fr){if(fr!=="left"&&fr!=="center"&&fr!=="right")throw new Error('align() must be passed "left", "center", or "right".');this.richTextCodeMirror_.setLineAttribute(ATTR.LINE_ALIGN,fr),this.codeMirror_.focus()},ar.prototype.orderedList=function(){this.richTextCodeMirror_.toggleLineAttribute(ATTR.LIST_TYPE,"o"),this.codeMirror_.focus()},ar.prototype.unorderedList=function(){this.richTextCodeMirror_.toggleLineAttribute(ATTR.LIST_TYPE,"u"),this.codeMirror_.focus()},ar.prototype.todo=function(){this.richTextCodeMirror_.toggleTodo(),this.codeMirror_.focus()},ar.prototype.newline=function(){this.richTextCodeMirror_.newline()},ar.prototype.deleteLeft=function(){this.richTextCodeMirror_.deleteLeft()},ar.prototype.deleteRight=function(){this.richTextCodeMirror_.deleteRight()},ar.prototype.indent=function(){this.richTextCodeMirror_.indent(),this.codeMirror_.focus()},ar.prototype.unindent=function(){this.richTextCodeMirror_.unindent(),this.codeMirror_.focus()},ar.prototype.undo=function(){this.codeMirror_.undo()},ar.prototype.redo=function(){this.codeMirror_.redo()},ar.prototype.insertEntity=function(fr,dr,pr){this.richTextCodeMirror_.insertEntityAtCursor(fr,dr,pr)},ar.prototype.insertEntityAt=function(fr,dr,pr,mr){this.richTextCodeMirror_.insertEntityAt(fr,dr,pr,mr)},ar.prototype.registerEntity=function(fr,dr){this.entityManager_.register(fr,dr)},ar.prototype.getOption=function(fr,dr){return fr in this.options_?this.options_[fr]:dr},ar.prototype.assertReady_=function(fr){if(!this.ready_)throw new Error('You must wait for the "ready" event before calling '+fr+".");if(this.zombie_)throw new Error("You can't use a Firepad after calling dispose()!  [called "+fr+"]")},ar.prototype.makeImageDialog_=function(){this.makeDialog_("img","Insert image url")},ar.prototype.makeDialog_=function(fr,dr){var pr=this,mr=function(){var wr=document.getElementById("overlay");wr.style.visibility="hidden",pr.firepadWrapper_.removeChild(wr)},gr=function(){var wr=document.getElementById("overlay");wr.style.visibility="hidden";var kr=document.getElementById(fr).value;kr!==null&&pr.insertEntity(fr,{src:kr}),pr.firepadWrapper_.removeChild(wr)},yr=utils.elt("input",null,{class:"firepad-dialog-input",id:fr,type:"text",placeholder:dr,autofocus:"autofocus"}),br=utils.elt("a","Submit",{class:"firepad-btn",id:"submitbtn"});utils.on(br,"click",utils.stopEventAnd(gr));var Or=utils.elt("a","Cancel",{class:"firepad-btn"});utils.on(Or,"click",utils.stopEventAnd(mr));var _r=utils.elt("div",[br,Or],{class:"firepad-btn-group"}),vr=utils.elt("div",[yr,_r],{class:"firepad-dialog-div"}),xr=utils.elt("div",[vr],{class:"firepad-dialog",id:"overlay"});this.firepadWrapper_.appendChild(xr)},ar.prototype.addToolbar_=function(){this.toolbar=new RichTextToolbar(this.imageInsertionUI),this.toolbar.on("undo",this.undo,this),this.toolbar.on("redo",this.redo,this),this.toolbar.on("bold",this.bold,this),this.toolbar.on("italic",this.italic,this),this.toolbar.on("underline",this.underline,this),this.toolbar.on("strike",this.strike,this),this.toolbar.on("font-size",this.fontSize,this),this.toolbar.on("font",this.font,this),this.toolbar.on("color",this.color,this),this.toolbar.on("left",function(){this.align("left")},this),this.toolbar.on("center",function(){this.align("center")},this),this.toolbar.on("right",function(){this.align("right")},this),this.toolbar.on("ordered-list",this.orderedList,this),this.toolbar.on("unordered-list",this.unorderedList,this),this.toolbar.on("todo-list",this.todo,this),this.toolbar.on("indent-increase",this.indent,this),this.toolbar.on("indent-decrease",this.unindent,this),this.toolbar.on("insert-image",this.makeImageDialog_,this),this.firepadWrapper_.insertBefore(this.toolbar.element(),this.firepadWrapper_.firstChild)},ar.prototype.addPoweredByLogo_=function(){var fr=utils.elt("a",null,{class:"powered-by-firepad"});fr.setAttribute("href","http://www.firepad.io/"),fr.setAttribute("target","_blank"),this.firepadWrapper_.appendChild(fr)},ar.prototype.initializeKeyMap_=function(){function fr(dr){return function(pr){setTimeout(function(){dr.call(pr.firepad)},0)}}lr.keyMap.richtext={"Ctrl-B":fr(this.bold),"Cmd-B":fr(this.bold),"Ctrl-I":fr(this.italic),"Cmd-I":fr(this.italic),"Ctrl-U":fr(this.underline),"Cmd-U":fr(this.underline),"Ctrl-H":fr(this.highlight),"Cmd-H":fr(this.highlight),Enter:fr(this.newline),Delete:fr(this.deleteRight),Backspace:fr(this.deleteLeft),Tab:fr(this.indent),"Shift-Tab":fr(this.unindent),fallthrough:["default"]}};function cr(fr){for(var dr=1,pr=0;pr<fr.length;pr++)dr=17*(dr+fr.charCodeAt(pr))%360;var mr=dr/360;return hr(mr,1,.75)}function ur(fr,dr,pr){function mr(gr){var yr=Math.round(255*gr).toString(16);return yr.length===1?"0"+yr:yr}return"#"+mr(fr)+mr(dr)+mr(pr)}function hr(fr,dr,pr){if(dr===0)return ur(pr,pr,pr);var mr=pr<.5?pr*(1+dr):pr+dr-dr*pr,gr=2*pr-mr,yr=function(br){return br<0&&(br+=1),br>1&&(br-=1),6*br<1?gr+(mr-gr)*6*br:2*br<1?mr:3*br<2?gr+(mr-gr)*6*(2/3-br):gr};return ur(yr(fr+1/3),yr(fr),yr(fr-1/3))}return ar}();Object.assign(Firepad,{Formatting,Text:Text$1,Entity,LineFormatting,Line,TextOperation,RichTextCodeMirrorAdapter,ACEAdapter,MonacoAdapter});const initEditorLocal=lr=>{const or=lr.book;cursorPosition.set({from:0,to:0});let[ar]=setupCodemirror(or);resolveInitData({editor:ar})},initEditorFirebase=lr=>{try{cursorPosition.set({from:0,to:0});let[or,ar]=setupCodemirror("");const cr=firebase.initializeApp(lr),ur=firebase.database(cr);let hr=Firepad.fromCodeMirror6(ur.ref(lr.book),or,{defaultText:get_store_value($format)("books.fire").replace("%1",lr.book),recreateWith:ar});hr.on("ready",function(){resolveInitData({editor:or})}),hr.on("synced",fr=>isSynced.set(!!fr))}catch(or){toast.push("Error: "+or.toString()),console.log(or)}},isVSCode="ISVSCODE"in window?!!window.ISVSCODE:!1,vscode=isVSCode?acquireVsCodeApi():null,updateHandlers=[];let firstTime=!0,lastDocument;const update=async lr=>{const{editor:or}=await store;if(updateHandlers.forEach(ar=>ar(lr)),lr.text===""||lr.text!=null){if(firstTime)lastDocument=lr.text,initEditorLocal({book:lr.text,cursor:{row:0,column:0}}),firstTime=!1;else{if(lastDocument&&lastDocument==lr.text)return;const ar=Math.min(get_store_value(cursorPosition).to+or.state.doc.length-lr.text.length,lr.text.length);lastDocument=lr.text,or.dispatch({selection:{anchor:ar},effects:[EditorView.scrollIntoView(ar)],changes:{from:0,to:or.state.doc.length,insert:lr.text}})}vscode.setState({text:lr.text})}};if(isVSCode){let lr=!0;historyCallbacks.push(or=>{or&&(lr=!0),lr&&(vscode.postMessage({type:"addUndo"}),lr=!1)}),window.addEventListener("message",async or=>{const{editor:ar}=await store,cr=or.data;switch(cr.type){case"update":update(cr);return;case"undo":undo({state:ar.state,dispatch:ar.dispatch});return;case"redo":redo({state:ar.state,dispatch:ar.dispatch});return}}),store.then(({book:or})=>{or.subscribe(ar=>{if(!firstTime){if(lastDocument&&ar===lastDocument)return;vscode.postMessage({type:"updateBook",book:get_store_value(or)})}})})}const loadVSSession=()=>{vscode.getState(),vscode.postMessage({type:"askUpdate"})},key$1="mage-settings",lastSettings=window.VSCODESettings||JSON.parse(localStorage.getItem(key$1)||"{}"),defaultValues={theme:"light",font:"Arial",fontSize:"12",pageWidth:"108",pageZoom:"120",titleHighlight:"2",justifyText:"1",lineSpacing:"140%",lineMargin:"4",dateFormat:"yyyymmdd-hhmmss",singleChapterMode:"1",countChars:"2"},s$2={},registerSetting=lr=>{const or=writable(lastSettings[lr]??defaultValues[lr]);return s$2[lr]=or,or};Object.keys(defaultValues).forEach(lr=>registerSetting(lr));const settings=derived(Object.values(s$2),lr=>{const or=Object.keys(s$2),ar={};for(let cr=0;cr<lr.length;cr++)ar[or[cr]]=lr[cr];return ar});let areVSCodeSettingsUpdated=!1;updateHandlers.push(lr=>{if(lr.settings!==void 0){try{const or=JSON.parse(lr.settings);Object.keys(defaultValues).forEach(ar=>s$2[ar].set(or[ar]??defaultValues[ar]))}catch{}areVSCodeSettingsUpdated=!0}});isVSCode&&vscode.postMessage({type:"askSettings"});settings.subscribe(lr=>{isVSCode?areVSCodeSettingsUpdated&&vscode.postMessage({type:"setSettings",settings:JSON.stringify(lr)}):localStorage.setItem(key$1,JSON.stringify(lr))});let onChangeCallback=lr=>({text:lr,index:indexBook(lr)});const setOnChangeCallback=lr=>onChangeCallback=lr,editorComponentID="main-editor",cursorPosition=debouncable(10,{from:0,to:0}),allowedRange=writable([0,1/0]),workingLink=Decoration.mark({class:"cm-mage-workinglink"}),brokenLink=Decoration.mark({class:"cm-mage-brokenlink"}),heading=Decoration.mark({class:"cm-mage-heading"}),bookTitle=Decoration.mark({class:"cm-mage-booktitle"}),group=Decoration.mark({class:"cm-mage-group"}),flag=Decoration.mark({class:"cm-mage-flag"}),HTMLi=Decoration.mark({class:"cm-mage-HTMLi"}),HTMLb=Decoration.mark({class:"cm-mage-HTMLb"}),HTMLu=Decoration.mark({class:"cm-mage-HTMLu"}),property=Decoration.mark({class:"cm-mage-property"}),getChapterFromLink=lr=>lr.includes("(#")?lr.substring(lr.indexOf("(#")+2,lr.lastIndexOf(")")).trim():lr.substring(lr.indexOf("[")+1,lr.indexOf("]")).trim(),getLinkDecorations=(lr,{text:or,index:ar})=>{const cr=ar.lineStarts[ar.lines.titlePageEnd+1];let ur=[];for(let{from:hr,to:fr}of lr.visibleRanges)syntaxTree(lr.state).iterate({from:hr,to:fr,enter:dr=>{if(dr.name=="Link"){const pr=lr.state.doc.sliceString(dr.from,dr.to);if(pr==="[group]")ur.push(group.range(dr.from,dr.to));else if(ar.properties.disableShortLinks=="true"){if(pr.includes("(#")){const mr=getChapterFromLink(pr),gr=ar.keys[mr]!==void 0?workingLink:brokenLink;ur.push(gr.range(dr.from,dr.to))}}else{const mr=pr.indexOf("][");if(mr!=-1){const gr=getChapterFromLink(pr.substring(0,mr+1)),yr=ar.keys[gr]!==void 0?workingLink:brokenLink;ur.push(yr.range(dr.from,dr.from+mr+1));const br=getChapterFromLink(pr.substring(mr+1)),Or=ar.keys[br]!==void 0?workingLink:brokenLink;ur.push(Or.range(dr.from+mr+1,dr.to))}else{const gr=getChapterFromLink(pr),yr=ar.keys[gr]!==void 0?workingLink:brokenLink;ur.push(yr.range(dr.from,dr.to))}}}else if(dr.name=="ATXHeading1")ur.push(bookTitle.range(dr.from,dr.to));else if(dr.name=="ATXHeading3")ur.push(heading.range(dr.from,dr.to));else if(dr.name=="InlineCode"||dr.name=="FencedCode"){const pr=lr.state.doc.sliceString(dr.from,dr.to);let mr=null;for(const[yr,br]of Object.entries(ar.properties))yr.startsWith("code-")&&pr.startsWith("`"+yr.substring(5))&&(mr=br);const gr=Decoration.mark({attributes:{class:"cm-mage-code",style:mr??""},inclusive:!0});ur.push(gr.range(dr.from,dr.to))}else if(dr.name=="Paragraph"){if(dr.to<cr){const pr=lr.state.doc.sliceString(dr.from,dr.to).split(`
`);let mr=0;for(const gr of pr){const yr=gr.indexOf(":");yr!=-1&&ur.push(property.range(dr.from+mr,dr.from+mr+yr+1)),mr+=gr.length+1}}}else if(dr.name=="Image")lr.state.doc.sliceString(dr.from,dr.to).includes("][flag-")&&ur.push(flag.range(dr.from,dr.to));else if(dr.name=="HTMLTag"){const pr=lr.state.doc.sliceString(dr.from,dr.to);pr=="<i>"||pr=="</i>"?ur.push(HTMLi.range(dr.from,dr.to)):pr=="<b>"||pr=="</b>"?ur.push(HTMLb.range(dr.from,dr.to)):(pr=="<u>"||pr=="</u>")&&ur.push(HTMLu.range(dr.from,dr.to))}}});return ur.sort((hr,fr)=>hr.from-fr.from),Decoration.set(ur)},magePlugin=ViewPlugin.fromClass(class{constructor(lr){bi(this,"decorations");bi(this,"editor");const or=lr.state.doc.toString(),ar=indexBook(or);this.decorations=getLinkDecorations(lr,{text:or,index:ar}),this.editor=lr}update(lr){if(String(get_store_value(s$2.singleChapterMode))==="2")if(console.log("preventing update"),lr.transactions.map(or=>or.effects).some(or=>or.some(ar=>ar.value==="subviewUpdate")))cursorPosition.set(lr.view.state.selection.main);else{const or=get_store_value(allowedRange),{from:ar,to:cr}=lr.view.state.selection.main,ur=Math.min(or[1],Math.max(ar,or[0])),hr=Math.max(or[0],Math.min(cr,or[1]));if(ur!==ar||hr!==cr){setTimeout(()=>this.editor.dispatch({selection:EditorSelection.create([EditorSelection.range(ur,hr)])}));return}else cursorPosition.lazySet(lr.view.state.selection.main)}else cursorPosition.lazySet(lr.view.state.selection.main);(lr.docChanged||lr.viewportChanged)&&(this.decorations=getLinkDecorations(lr.view,onChangeCallback(lr.view.state.doc.toString())))}},{decorations:lr=>lr.decorations,eventHandlers:{mousedown:(lr,or)=>{let ar=lr.target;if(ar.classList.contains("tok-link")&&(ar=ar.parentElement),ar.classList.contains("cm-mage-workinglink")||ar.classList.contains("cm-mage-brokenlink")){let cr=function(yr,br){if(yr==br)return!0;for(let Or of yr.childNodes)if(Or.nodeType==Node.TEXT_NODE&&(fr+=Or.textContent),cr(Or,br))return!0;return!1};const ur=ar.closest(".cm-line");let hr=ur.textContent??"",fr="";cr(ur,ar);const dr=yr=>yr===-1?1/0:yr,pr=Math.min(dr(hr.indexOf(")",fr.length)),dr(hr.indexOf("]",fr.length))),mr=hr.lastIndexOf("[",pr),gr=getChapterFromLink(hr.substring(mr));return goToKey(gr),lr.preventDefault(),lr.stopPropagation(),!1}}}});Decoration.replace({});const getSubviewDecorations=()=>new RangeSetBuilder().finish(),subviewPlugin=StateField.define({create(){return Decoration.none},update(lr,or){return getSubviewDecorations()},provide:lr=>EditorView.decorations.from(lr)}),setupCodemirror=lr=>{const or=isVSCode?[highlightSpecialChars(),history(),drawSelection(),highlightActiveLine(),markdown(),search(),EditorView.lineWrapping,syntaxHighlighting(classHighlighter),EditorView.contentAttributes.of({spellcheck:"true"}),magePlugin,subviewPlugin,keymap.of([...defaultKeymap,...searchKeymap,indentWithTab])]:[highlightSpecialChars(),history(),drawSelection(),highlightActiveLine(),markdown(),search(),EditorView.lineWrapping,syntaxHighlighting(classHighlighter),EditorView.contentAttributes.of({spellcheck:"true"}),magePlugin,subviewPlugin,keymap.of([...defaultKeymap,...searchKeymap,...historyKeymap,{...historyKeymap[1],key:"Mod-Shift-z"},indentWithTab])];return[new EditorView({doc:lr,parent:document.getElementById(editorComponentID),extensions:or}),or]},showSidemenu=writable(!1),showPluginPanel=writable(!1),isSynced=debouncable(500,null),bookStoreCodemirror=(lr,or)=>{let ar="",cr=null;const ur=dr=>(ar=dr,cr=indexBook(ar),Object.freeze({text:ar,index:cr})),{subscribe:hr,set:fr}=writable(ur(lr.state.doc.toString()));return or(dr=>{const pr=ur(dr);return fr(pr),pr}),{set:dr=>{lr.dispatch({changes:{from:0,to:lr.state.doc.length,insert:dr}})},subscribe:hr,get text(){return ar},get index(){return cr},get content(){return contentBook(ar,cr)},replace(dr,pr,mr){lr.dispatch({changes:{from:dr,to:pr,insert:mr}})},apply(dr){const pr=stringBook(lr.state.doc.toString());dr(pr),pr.steps.forEach(mr=>{switch(mr.type){case"s":{lr.dispatch({changes:{from:0,to:lr.state.doc.length,insert:mr.newText}});break}case"r":{lr.dispatch({changes:{from:mr.from,to:mr.to,insert:mr.newText}});break}}})}}};let resolveInitDataCallback=null;const initData=new Promise(lr=>{resolveInitDataCallback=lr}),resolveInitData=({editor:lr})=>resolveInitDataCallback({editor:lr}),store=(async()=>{const{editor:lr}=await initData,or=bookStoreCodemirror(lr,setOnChangeCallback),ar=derived([cursorPosition,or],([hr,fr])=>{const dr=lr.state.doc.toString().length;let pr=lr.state.doc.lineAt(Math.min(hr.from,Math.max(0,dr-1))).number-1,mr=-1;for(const[gr,yr]of fr.index.chapters.entries())if(yr.lines.textStart<=pr)mr=gr;else return mr;return mr}),cr=derived([ar,or],([hr,fr])=>fr.index.chapters[hr]),ur=derived([ar,or],([hr,fr])=>{if(hr==-1)return"";const dr=fr.index.chapters[hr];return dr.key+(dr.title?" - "+dr.title:"")});return{book:or,selectedChapter:cr,selectedChapterIndex:ar,selectedChapterFullTitle:ur,editor:lr}})(),nullUntilLoaded=writable({book:null,selectedChapter:null,selectedChapterIndex:null,selectedChapterFullTitle:null,editor:null});store.then(lr=>{Object.assign(window,lr),nullUntilLoaded.set(lr)});const store$1=Object.freeze(Object.defineProperty({__proto__:null,bookStoreCodemirror,isSynced,nullUntilLoaded,resolveInitData,showPluginPanel,showSidemenu,store},Symbol.toStringTag,{value:"Module"}));function create_if_block$c(lr){let or,ar=lr[0]==="templateplugin.tabs.1"&&create_if_block_1$5(lr);return{c(){ar&&ar.c(),or=empty$1()},m(cr,ur){ar&&ar.m(cr,ur),insert$1(cr,or,ur)},p(cr,ur){cr[0]==="templateplugin.tabs.1"?ar?ar.p(cr,ur):(ar=create_if_block_1$5(cr),ar.c(),ar.m(or.parentNode,or)):ar&&(ar.d(1),ar=null)},d(cr){cr&&detach(or),ar&&ar.d(cr)}}}function create_if_block_1$5(lr){let or,ar;return{c(){or=element$1("iframe"),attr(or,"title","test"),src_url_equal(or.src,ar="./tools/libreoffice/index.html#magebookplugin=true")||attr(or,"src",ar),attr(or,"width","100%"),attr(or,"height","100%"),attr(or,"frameborder","0"),or.allowFullscreen=!0,toggle_class(or,"pointer-events-none",lr[1])},m(cr,ur){insert$1(cr,or,ur)},p(cr,ur){ur&2&&toggle_class(or,"pointer-events-none",cr[1])},d(cr){cr&&detach(or)}}}function create_fragment$h(lr){let or=lr[0].startsWith("templateplugin.tabs."),ar,cr=or&&create_if_block$c(lr);return{c(){cr&&cr.c(),ar=empty$1()},m(ur,hr){cr&&cr.m(ur,hr),insert$1(ur,ar,hr)},p(ur,[hr]){hr&1&&(or=ur[0].startsWith("templateplugin.tabs.")),or?cr?cr.p(ur,hr):(cr=create_if_block$c(ur),cr.c(),cr.m(ar.parentNode,ar)):cr&&(cr.d(1),cr=null)},i:noop$2,o:noop$2,d(ur){ur&&detach(ar),cr&&cr.d(ur)}}}function instance$h(lr,or,ar){let{tab:cr=""}=or,{w:ur}=or,{isResizing:hr=!1}=or;return lr.$$set=fr=>{"tab"in fr&&ar(0,cr=fr.tab),"w"in fr&&ar(2,ur=fr.w),"isResizing"in fr&&ar(1,hr=fr.isResizing)},lr.$$.update=()=>{lr.$$.dirty&1&&console.log(cr)},[cr,hr,ur]}class Widget extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$h,create_fragment$h,safe_not_equal,{tab:0,w:2,isResizing:1})}}const templateplugin$1={title:"Hello magebook!"},en$2={templateplugin:templateplugin$1},templateplugin={title:"Ciao magebook!"},it$2={templateplugin},logo$1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAwCAQAAADJcvAQAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfnBwMKETb29ME7AAACGElEQVRIx+WUz2oTURSHv5vEtmQmaTeVGnFgBJ/ArYu48gkCgTqZIKl7xb2ggoug7oPQStUuBty7EAb0DXyAQAwILqy2pLbUmeNixmbShMmfmWrEc1bDvXx893fPXHX7nDRpoDG+dnmr7rY+Bx8bT7kztOOAR2qjKfeYvNqZcqsD0NhHH7F+mPFqwhRteu8bJoBsj1xfUrcE4CEAKlbukC26gHSy5eftSra4JTeHd2WifD+2F7ApIWB4bsN0vL26vBx2VPUTw7Ux8fXY5yi0pOOVt9uVrPaC9RjD+M6js0CNEoIYGdcyHa9ny6vBXZn+YceXhs5ieHAxlGuZjndgy+sRwElbCy3X8PENcS3T8X7U2IkAg8AFmXAQdQosUucCghh+gLRkZ0ZDQUKkHSI91zIdL2/LG0HgKJLhNMgiSwPI1rFWlU355t9XVQF4AFximtrjOz02+RIOkdOeemwGu0CRPHXOh0NUMRMChQLL5LFZDYcoQM6UYT/LKBK3YiYy/H09faS8q5YiwNmqyEofaR4/S2gYZLlCHiv4upETQPBhZkco8BU9eA2Wc8GjIImARIRykgpQTgN9VLrAJPf8Z458BhnOmeE/laE/QYZqIqB/2jB++zxkyN+aQ5W2ofx/GY5KNEVDObsM/eivN0cZxozNxxQsT4BpVEBSV7vqIunVp2xJ53qKwCfZax92f3KFYgqwLs3Lj38B31lwS1wSB2oAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDctMDNUMTA6MTc6NTQrMDA6MDBU4PuzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTA3LTAzVDEwOjE3OjU0KzAwOjAwJb1DDwAAAABJRU5ErkJggg==",Viz=window.Viz,allowedChars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!#$%&'()*+,-./:;<=>?@[\\]^_`{|}~àèéìòù\n ",whitelist$3=lr=>{let or="";for(const ar of lr)allowedChars.includes(ar)&&(or+=ar);return or},sanitizeLabel=lr=>lr.replace(/\//g,"\\").replace(/\"/g,'"'),nodeStyle=(lr,or,ar)=>{if(or.includes("final"))return', color="#ffa200"';if(or.includes("death"))return', color="#000000", fontcolor="#FFFFFF"';if(or.includes("fixed"))return', color="#b02900", fontcolor="#FFFFFF"';if(or.length>0){const cr=/\w+/g.exec(or[0]);if(cr!==null)return`, color="${cr[0].split("").reduce((fr,dr)=>fr+dr.charCodeAt(0),0)%8+1}:1", fillcolor="#D3D3D3" style="rounded,filled,bold", colorscheme="accent8"`}return""},generateGraph=lr=>{const or=bookify(lr);let ar=`digraph{
    graph [fontname="arial", fontsize=10];
    node  [fontname="arial", fontsize=12, style="rounded,filled", shape=box];
    edge  [fontname="arial", fontsize=12];
  `;const cr={};for(const hr of Object.keys(or.index.chaptersWith.flag))cr[hr]=new URL(flagURL(hr,or),document.baseURI);for(let[hr,{key:fr,title:dr,links:pr,flags:mr}]of or.index.chapters.entries()){const{content:gr}=or.content.chapters[hr];fr=whitelist$3(fr),ar+=`
      chapter${hr} [label=<<table border="0"><tr><td align="center">${whitelist$3(dr?`${fr} - ${dr}`:fr)}</td></tr>${mr.length==0?"":`<tr><td align="center"><table border="0"><tr>${mr.map(yr=>`<td align="center"><img src="${cr[yr]}"/></td>`).join("")}</tr></table></td></tr>`}</table>>, tooltip="${whitelist$3(gr)}"${nodeStyle(fr,mr)}, href="${urlOfChapterKey(fr)}"]`;for(const yr of pr)or.index.keys[yr]&&(ar+=`
        chapter${hr} -> chapter${or.index.keys[yr]}`)}let ur=0;for(let[hr,fr]of Object.entries(or.index.chaptersWith.group))ar+=`

    subgraph cluster${ur++}{
      graph [fontname="arial", fontsize=10];
      node  [fontname="arial", fontsize=12, style="rounded,filled", shape=box];
      edge  [fontname="arial", fontsize=12];
      style=filled
      fillcolor="#EEEEEE"
      color=black
      label = "${sanitizeLabel(hr)}"
      labelfontsize=14
      labelfontname=arial

      ${fr.map(dr=>`chapter${dr}`).join("; ")}
    }`;return ar+=`
}`,console.log(ar),[ar,{images:Array.from(new Set(Object.values(cr))).map(hr=>({path:hr,width:30,height:30}))}]},graphToImg=async lr=>(await Viz.instance()).renderSVGElement(...generateGraph(lr)),graph=Object.freeze(Object.defineProperty({__proto__:null,generateGraph,graphToImg},Symbol.toStringTag,{value:"Module"}));var lib$1={exports:{}};(function(lr){function or(mr,gr){for(var yr=mr.toString();yr.length<gr;)yr="0"+yr;return yr}function ar(mr){return or(mr,2)}function cr(mr){var gr=Math.abs(mr),yr=String(Math.floor(gr/60)),br=String(gr%60);return yr=("0"+yr).slice(-2),br=("0"+br).slice(-2),mr===0?"Z":(mr<0?"+":"-")+yr+":"+br}function ur(mr,gr){typeof mr!="string"&&(gr=mr,mr=lr.exports.ISO8601_FORMAT),gr||(gr=lr.exports.now());var yr=ar(gr.getDate()),br=ar(gr.getMonth()+1),Or=ar(gr.getFullYear()),_r=ar(Or.substring(2,4)),vr=mr.indexOf("yyyy")>-1?Or:_r,xr=ar(gr.getHours()),wr=ar(gr.getMinutes()),kr=ar(gr.getSeconds()),Cr=or(gr.getMilliseconds(),3),$r=cr(gr.getTimezoneOffset()),Nr=mr.replace(/dd/g,yr).replace(/MM/g,br).replace(/y{1,4}/g,vr).replace(/hh/g,xr).replace(/mm/g,wr).replace(/ss/g,kr).replace(/SSS/g,Cr).replace(/O/g,$r);return Nr}function hr(mr,gr,yr,br){mr["set"+(br?"":"UTC")+gr](yr)}function fr(mr,gr,yr){var br=mr.indexOf("O")<0,Or=!1,_r=[{pattern:/y{1,4}/,regexp:"\\d{1,4}",fn:function($r,Nr){hr($r,"FullYear",Nr,br)}},{pattern:/MM/,regexp:"\\d{1,2}",fn:function($r,Nr){hr($r,"Month",Nr-1,br),$r.getMonth()!==Nr-1&&(Or=!0)}},{pattern:/dd/,regexp:"\\d{1,2}",fn:function($r,Nr){Or&&hr($r,"Month",$r.getMonth()-1,br),hr($r,"Date",Nr,br)}},{pattern:/hh/,regexp:"\\d{1,2}",fn:function($r,Nr){hr($r,"Hours",Nr,br)}},{pattern:/mm/,regexp:"\\d\\d",fn:function($r,Nr){hr($r,"Minutes",Nr,br)}},{pattern:/ss/,regexp:"\\d\\d",fn:function($r,Nr){hr($r,"Seconds",Nr,br)}},{pattern:/SSS/,regexp:"\\d\\d\\d",fn:function($r,Nr){hr($r,"Milliseconds",Nr,br)}},{pattern:/O/,regexp:"[+-]\\d{1,2}:?\\d{2}?|Z",fn:function($r,Nr){Nr==="Z"?Nr=0:Nr=Nr.replace(":","");var Br=Math.abs(Nr),Fr=(Nr>0?-1:1)*(Br%100+Math.floor(Br/100)*60);$r.setUTCMinutes($r.getUTCMinutes()+Fr)}}],vr=_r.reduce(function($r,Nr){return Nr.pattern.test($r.regexp)?(Nr.index=$r.regexp.match(Nr.pattern).index,$r.regexp=$r.regexp.replace(Nr.pattern,"("+Nr.regexp+")")):Nr.index=-1,$r},{regexp:mr,index:[]}),xr=_r.filter(function($r){return $r.index>-1});xr.sort(function($r,Nr){return $r.index-Nr.index});var wr=new RegExp(vr.regexp),kr=wr.exec(gr);if(kr){var Cr=yr||lr.exports.now();return xr.forEach(function($r,Nr){$r.fn(Cr,kr[Nr+1])}),Cr}throw new Error("String '"+gr+"' could not be parsed as '"+mr+"'")}function dr(mr,gr,yr){if(!mr)throw new Error("pattern must be supplied");return fr(mr,gr,yr)}function pr(){return new Date}lr.exports=ur,lr.exports.asString=ur,lr.exports.parse=dr,lr.exports.now=pr,lr.exports.ISO8601_FORMAT="yyyy-MM-ddThh:mm:ss.SSS",lr.exports.ISO8601_WITH_TZ_OFFSET_FORMAT="yyyy-MM-ddThh:mm:ss.SSSO",lr.exports.DATETIME_FORMAT="dd MM yyyy hh:mm:ss.SSS",lr.exports.ABSOLUTETIME_FORMAT="hh:mm:ss.SSS"})(lib$1);var libExports=lib$1.exports;const dateFormat=getDefaultExportFromCjs$1(libExports);var FileSaver_min={exports:{}};(function(lr,or){(function(ar,cr){cr()})(commonjsGlobal$1,function(){function ar(mr,gr){return typeof gr>"u"?gr={autoBom:!1}:typeof gr!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),gr={autoBom:!gr}),gr.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(mr.type)?new Blob(["\uFEFF",mr],{type:mr.type}):mr}function cr(mr,gr,yr){var br=new XMLHttpRequest;br.open("GET",mr),br.responseType="blob",br.onload=function(){pr(br.response,gr,yr)},br.onerror=function(){console.error("could not download file")},br.send()}function ur(mr){var gr=new XMLHttpRequest;gr.open("HEAD",mr,!1);try{gr.send()}catch{}return 200<=gr.status&&299>=gr.status}function hr(mr){try{mr.dispatchEvent(new MouseEvent("click"))}catch{var gr=document.createEvent("MouseEvents");gr.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),mr.dispatchEvent(gr)}}var fr=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof commonjsGlobal$1=="object"&&commonjsGlobal$1.global===commonjsGlobal$1?commonjsGlobal$1:void 0,dr=fr.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),pr=fr.saveAs||(typeof window!="object"||window!==fr?function(){}:"download"in HTMLAnchorElement.prototype&&!dr?function(mr,gr,yr){var br=fr.URL||fr.webkitURL,Or=document.createElement("a");gr=gr||mr.name||"download",Or.download=gr,Or.rel="noopener",typeof mr=="string"?(Or.href=mr,Or.origin===location.origin?hr(Or):ur(Or.href)?cr(mr,gr,yr):hr(Or,Or.target="_blank")):(Or.href=br.createObjectURL(mr),setTimeout(function(){br.revokeObjectURL(Or.href)},4e4),setTimeout(function(){hr(Or)},0))}:"msSaveOrOpenBlob"in navigator?function(mr,gr,yr){if(gr=gr||mr.name||"download",typeof mr!="string")navigator.msSaveOrOpenBlob(ar(mr,yr),gr);else if(ur(mr))cr(mr,gr,yr);else{var br=document.createElement("a");br.href=mr,br.target="_blank",setTimeout(function(){hr(br)})}}:function(mr,gr,yr,br){if(br=br||open("","_blank"),br&&(br.document.title=br.document.body.innerText="downloading..."),typeof mr=="string")return cr(mr,gr,yr);var Or=mr.type==="application/octet-stream",_r=/constructor/i.test(fr.HTMLElement)||fr.safari,vr=/CriOS\/[\d]+/.test(navigator.userAgent);if((vr||Or&&_r||dr)&&typeof FileReader<"u"){var xr=new FileReader;xr.onloadend=function(){var Cr=xr.result;Cr=vr?Cr:Cr.replace(/^data:[^;]*;/,"data:attachment/file;"),br?br.location.href=Cr:location=Cr,br=null},xr.readAsDataURL(mr)}else{var wr=fr.URL||fr.webkitURL,kr=wr.createObjectURL(mr);br?br.location=kr:location.href=kr,br=null,setTimeout(function(){wr.revokeObjectURL(kr)},4e4)}});fr.saveAs=pr.saveAs=pr,lr.exports=pr})})(FileSaver_min);var FileSaver_minExports=FileSaver_min.exports;const saveAs=getDefaultExportFromCjs$1(FileSaver_minExports),_hasatob=typeof atob=="function",_hasbtoa=typeof btoa=="function",_hasBuffer=typeof Buffer=="function",_TD=typeof TextDecoder=="function"?new TextDecoder:void 0,_TE=typeof TextEncoder=="function"?new TextEncoder:void 0,b64ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b64chs=Array.prototype.slice.call(b64ch),b64tab=(lr=>{let or={};return lr.forEach((ar,cr)=>or[ar]=cr),or})(b64chs),b64re=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,_fromCC=String.fromCharCode.bind(String),_U8Afrom=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):lr=>new Uint8Array(Array.prototype.slice.call(lr,0)),_mkUriSafe=lr=>lr.replace(/=/g,"").replace(/[+\/]/g,or=>or=="+"?"-":"_"),_tidyB64=lr=>lr.replace(/[^A-Za-z0-9\+\/]/g,""),btoaPolyfill=lr=>{let or,ar,cr,ur,hr="";const fr=lr.length%3;for(let dr=0;dr<lr.length;){if((ar=lr.charCodeAt(dr++))>255||(cr=lr.charCodeAt(dr++))>255||(ur=lr.charCodeAt(dr++))>255)throw new TypeError("invalid character found");or=ar<<16|cr<<8|ur,hr+=b64chs[or>>18&63]+b64chs[or>>12&63]+b64chs[or>>6&63]+b64chs[or&63]}return fr?hr.slice(0,fr-3)+"===".substring(fr):hr},_btoa=_hasbtoa?lr=>btoa(lr):_hasBuffer?lr=>Buffer.from(lr,"binary").toString("base64"):btoaPolyfill,_fromUint8Array=_hasBuffer?lr=>Buffer.from(lr).toString("base64"):lr=>{let ar=[];for(let cr=0,ur=lr.length;cr<ur;cr+=4096)ar.push(_fromCC.apply(null,lr.subarray(cr,cr+4096)));return _btoa(ar.join(""))},cb_utob=lr=>{if(lr.length<2){var or=lr.charCodeAt(0);return or<128?lr:or<2048?_fromCC(192|or>>>6)+_fromCC(128|or&63):_fromCC(224|or>>>12&15)+_fromCC(128|or>>>6&63)+_fromCC(128|or&63)}else{var or=65536+(lr.charCodeAt(0)-55296)*1024+(lr.charCodeAt(1)-56320);return _fromCC(240|or>>>18&7)+_fromCC(128|or>>>12&63)+_fromCC(128|or>>>6&63)+_fromCC(128|or&63)}},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=lr=>lr.replace(re_utob,cb_utob),_encode=_hasBuffer?lr=>Buffer.from(lr,"utf8").toString("base64"):_TE?lr=>_fromUint8Array(_TE.encode(lr)):lr=>_btoa(utob(lr)),encode$6=(lr,or=!1)=>or?_mkUriSafe(_encode(lr)):_encode(lr),re_btou=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,cb_btou=lr=>{switch(lr.length){case 4:var or=(7&lr.charCodeAt(0))<<18|(63&lr.charCodeAt(1))<<12|(63&lr.charCodeAt(2))<<6|63&lr.charCodeAt(3),ar=or-65536;return _fromCC((ar>>>10)+55296)+_fromCC((ar&1023)+56320);case 3:return _fromCC((15&lr.charCodeAt(0))<<12|(63&lr.charCodeAt(1))<<6|63&lr.charCodeAt(2));default:return _fromCC((31&lr.charCodeAt(0))<<6|63&lr.charCodeAt(1))}},btou=lr=>lr.replace(re_btou,cb_btou),atobPolyfill=lr=>{if(lr=lr.replace(/\s+/g,""),!b64re.test(lr))throw new TypeError("malformed base64.");lr+="==".slice(2-(lr.length&3));let or,ar="",cr,ur;for(let hr=0;hr<lr.length;)or=b64tab[lr.charAt(hr++)]<<18|b64tab[lr.charAt(hr++)]<<12|(cr=b64tab[lr.charAt(hr++)])<<6|(ur=b64tab[lr.charAt(hr++)]),ar+=cr===64?_fromCC(or>>16&255):ur===64?_fromCC(or>>16&255,or>>8&255):_fromCC(or>>16&255,or>>8&255,or&255);return ar},_atob=_hasatob?lr=>atob(_tidyB64(lr)):_hasBuffer?lr=>Buffer.from(lr,"base64").toString("binary"):atobPolyfill,_toUint8Array=_hasBuffer?lr=>_U8Afrom(Buffer.from(lr,"base64")):lr=>_U8Afrom(_atob(lr).split("").map(or=>or.charCodeAt(0))),_decode=_hasBuffer?lr=>Buffer.from(lr,"base64").toString("utf8"):_TD?lr=>_TD.decode(_toUint8Array(lr)):lr=>btou(_atob(lr)),_unURI=lr=>_tidyB64(lr.replace(/[-_]/g,or=>or=="-"?"+":"/")),decode$3=lr=>_decode(_unURI(lr)),mimetype$5="text/markdown",extension$5="magebook",decode$2=lr=>lr,encode$5=lr=>({encodedBook:typeof lr=="string"?lr:lr.text,mimetype:mimetype$5,extension:extension$5}),md=Object.freeze(Object.defineProperty({__proto__:null,decode:decode$2,encode:encode$5,extension:extension$5,mimetype:mimetype$5},Symbol.toStringTag,{value:"Module"}));var Gt$1={},Nt$1,Ut$1;function ee$1(){if(Ut$1)return Nt$1;Ut$1=1,Nt$1=lr;function lr(ar){if(ar)return or(ar)}function or(ar){for(var cr in lr.prototype)ar[cr]=lr.prototype[cr];return ar}return lr.prototype.on=lr.prototype.addEventListener=function(ar,cr){return this._callbacks=this._callbacks||{},(this._callbacks[ar]=this._callbacks[ar]||[]).push(cr),this},lr.prototype.once=function(ar,cr){var ur=this;this._callbacks=this._callbacks||{};function hr(){ur.off(ar,hr),cr.apply(this,arguments)}return hr.fn=cr,this.on(ar,hr),this},lr.prototype.off=lr.prototype.removeListener=lr.prototype.removeAllListeners=lr.prototype.removeEventListener=function(ar,cr){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var ur=this._callbacks[ar];if(!ur)return this;if(arguments.length==1)return delete this._callbacks[ar],this;for(var hr,fr=0;fr<ur.length;fr++)if(hr=ur[fr],hr===cr||hr.fn===cr){ur.splice(fr,1);break}return this},lr.prototype.emit=function(ar){this._callbacks=this._callbacks||{};var cr=[].slice.call(arguments,1),ur=this._callbacks[ar];if(ur){ur=ur.slice(0);for(var hr=0,fr=ur.length;hr<fr;++hr)ur[hr].apply(this,cr)}return this},lr.prototype.listeners=function(ar){return this._callbacks=this._callbacks||{},this._callbacks[ar]||[]},lr.prototype.hasListeners=function(ar){return!!this.listeners(ar).length},Nt$1}var vt$1,Ot$1;function re$1(){if(Ot$1)return vt$1;Ot$1=1;var lr=ee$1();function or(){lr.call(this)}return or.prototype=new lr,vt$1=or,or.Stream=or,or.prototype.pipe=function(ar,cr){var ur=this;function hr(br){ar.writable&&ar.write(br)===!1&&ur.pause&&ur.pause()}ur.on("data",hr);function fr(){ur.readable&&ur.resume&&ur.resume()}ar.on("drain",fr),!ar._isStdio&&(!cr||cr.end!==!1)&&(ur.on("end",pr),ur.on("close",mr));var dr=!1;function pr(){dr||(dr=!0,ar.end())}function mr(){dr||(dr=!0,typeof ar.destroy=="function"&&ar.destroy())}function gr(br){if(yr(),!this.hasListeners("error"))throw br}ur.on("error",gr),ar.on("error",gr);function yr(){ur.off("data",hr),ar.off("drain",fr),ur.off("end",pr),ur.off("close",mr),ur.off("error",gr),ar.off("error",gr),ur.off("end",yr),ur.off("close",yr),ar.off("end",yr),ar.off("close",yr)}return ur.on("end",yr),ur.on("close",yr),ar.on("end",yr),ar.on("close",yr),ar.emit("pipe",ur),ar},vt$1}var It$1={},Tt$1={exports:{}},_t$1={},lt$1={},Rt$1;function ne$1(){if(Rt$1)return lt$1;Rt$1=1,lt$1.byteLength=dr,lt$1.toByteArray=mr,lt$1.fromByteArray=br;for(var lr=[],or=[],ar=typeof Uint8Array<"u"?Uint8Array:Array,cr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ur=0,hr=cr.length;ur<hr;++ur)lr[ur]=cr[ur],or[cr.charCodeAt(ur)]=ur;or["-".charCodeAt(0)]=62,or["_".charCodeAt(0)]=63;function fr(Or){var _r=Or.length;if(_r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var vr=Or.indexOf("=");vr===-1&&(vr=_r);var xr=vr===_r?0:4-vr%4;return[vr,xr]}function dr(Or){var _r=fr(Or),vr=_r[0],xr=_r[1];return(vr+xr)*3/4-xr}function pr(Or,_r,vr){return(_r+vr)*3/4-vr}function mr(Or){var _r,vr=fr(Or),xr=vr[0],wr=vr[1],kr=new ar(pr(Or,xr,wr)),Cr=0,$r=wr>0?xr-4:xr,Nr;for(Nr=0;Nr<$r;Nr+=4)_r=or[Or.charCodeAt(Nr)]<<18|or[Or.charCodeAt(Nr+1)]<<12|or[Or.charCodeAt(Nr+2)]<<6|or[Or.charCodeAt(Nr+3)],kr[Cr++]=_r>>16&255,kr[Cr++]=_r>>8&255,kr[Cr++]=_r&255;return wr===2&&(_r=or[Or.charCodeAt(Nr)]<<2|or[Or.charCodeAt(Nr+1)]>>4,kr[Cr++]=_r&255),wr===1&&(_r=or[Or.charCodeAt(Nr)]<<10|or[Or.charCodeAt(Nr+1)]<<4|or[Or.charCodeAt(Nr+2)]>>2,kr[Cr++]=_r>>8&255,kr[Cr++]=_r&255),kr}function gr(Or){return lr[Or>>18&63]+lr[Or>>12&63]+lr[Or>>6&63]+lr[Or&63]}function yr(Or,_r,vr){for(var xr,wr=[],kr=_r;kr<vr;kr+=3)xr=(Or[kr]<<16&16711680)+(Or[kr+1]<<8&65280)+(Or[kr+2]&255),wr.push(gr(xr));return wr.join("")}function br(Or){for(var _r,vr=Or.length,xr=vr%3,wr=[],kr=16383,Cr=0,$r=vr-xr;Cr<$r;Cr+=kr)wr.push(yr(Or,Cr,Cr+kr>$r?$r:Cr+kr));return xr===1?(_r=Or[vr-1],wr.push(lr[_r>>2]+lr[_r<<4&63]+"==")):xr===2&&(_r=(Or[vr-2]<<8)+Or[vr-1],wr.push(lr[_r>>10]+lr[_r>>4&63]+lr[_r<<2&63]+"=")),wr.join("")}return lt$1}var dt$1={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Lt$1;function ie$1(){return Lt$1||(Lt$1=1,dt$1.read=function(lr,or,ar,cr,ur){var hr,fr,dr=ur*8-cr-1,pr=(1<<dr)-1,mr=pr>>1,gr=-7,yr=ar?ur-1:0,br=ar?-1:1,Or=lr[or+yr];for(yr+=br,hr=Or&(1<<-gr)-1,Or>>=-gr,gr+=dr;gr>0;hr=hr*256+lr[or+yr],yr+=br,gr-=8);for(fr=hr&(1<<-gr)-1,hr>>=-gr,gr+=cr;gr>0;fr=fr*256+lr[or+yr],yr+=br,gr-=8);if(hr===0)hr=1-mr;else{if(hr===pr)return fr?NaN:(Or?-1:1)*(1/0);fr=fr+Math.pow(2,cr),hr=hr-mr}return(Or?-1:1)*fr*Math.pow(2,hr-cr)},dt$1.write=function(lr,or,ar,cr,ur,hr){var fr,dr,pr,mr=hr*8-ur-1,gr=(1<<mr)-1,yr=gr>>1,br=ur===23?Math.pow(2,-24)-Math.pow(2,-77):0,Or=cr?0:hr-1,_r=cr?1:-1,vr=or<0||or===0&&1/or<0?1:0;for(or=Math.abs(or),isNaN(or)||or===1/0?(dr=isNaN(or)?1:0,fr=gr):(fr=Math.floor(Math.log(or)/Math.LN2),or*(pr=Math.pow(2,-fr))<1&&(fr--,pr*=2),fr+yr>=1?or+=br/pr:or+=br*Math.pow(2,1-yr),or*pr>=2&&(fr++,pr/=2),fr+yr>=gr?(dr=0,fr=gr):fr+yr>=1?(dr=(or*pr-1)*Math.pow(2,ur),fr=fr+yr):(dr=or*Math.pow(2,yr-1)*Math.pow(2,ur),fr=0));ur>=8;lr[ar+Or]=dr&255,Or+=_r,dr/=256,ur-=8);for(fr=fr<<ur|dr,mr+=ur;mr>0;lr[ar+Or]=fr&255,Or+=_r,fr/=256,mr-=8);lr[ar+Or-_r]|=vr*128}),dt$1}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Kt$1;function ae$1(){return Kt$1||(Kt$1=1,function(lr){var or=ne$1(),ar=ie$1(),cr=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;lr.Buffer=dr,lr.SlowBuffer=kr,lr.INSPECT_MAX_BYTES=50;var ur=2147483647;lr.kMaxLength=ur,dr.TYPED_ARRAY_SUPPORT=hr(),!dr.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function hr(){try{var Tr=new Uint8Array(1),Sr={foo:function(){return 42}};return Object.setPrototypeOf(Sr,Uint8Array.prototype),Object.setPrototypeOf(Tr,Sr),Tr.foo()===42}catch{return!1}}Object.defineProperty(dr.prototype,"parent",{enumerable:!0,get:function(){if(dr.isBuffer(this))return this.buffer}}),Object.defineProperty(dr.prototype,"offset",{enumerable:!0,get:function(){if(dr.isBuffer(this))return this.byteOffset}});function fr(Tr){if(Tr>ur)throw new RangeError('The value "'+Tr+'" is invalid for option "size"');var Sr=new Uint8Array(Tr);return Object.setPrototypeOf(Sr,dr.prototype),Sr}function dr(Tr,Sr,Er){if(typeof Tr=="number"){if(typeof Sr=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return yr(Tr)}return pr(Tr,Sr,Er)}dr.poolSize=8192;function pr(Tr,Sr,Er){if(typeof Tr=="string")return br(Tr,Sr);if(ArrayBuffer.isView(Tr))return _r(Tr);if(Tr==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Tr);if(ri(Tr,ArrayBuffer)||Tr&&ri(Tr.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ri(Tr,SharedArrayBuffer)||Tr&&ri(Tr.buffer,SharedArrayBuffer)))return vr(Tr,Sr,Er);if(typeof Tr=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Ir=Tr.valueOf&&Tr.valueOf();if(Ir!=null&&Ir!==Tr)return dr.from(Ir,Sr,Er);var Qr=xr(Tr);if(Qr)return Qr;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Tr[Symbol.toPrimitive]=="function")return dr.from(Tr[Symbol.toPrimitive]("string"),Sr,Er);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Tr)}dr.from=function(Tr,Sr,Er){return pr(Tr,Sr,Er)},Object.setPrototypeOf(dr.prototype,Uint8Array.prototype),Object.setPrototypeOf(dr,Uint8Array);function mr(Tr){if(typeof Tr!="number")throw new TypeError('"size" argument must be of type number');if(Tr<0)throw new RangeError('The value "'+Tr+'" is invalid for option "size"')}function gr(Tr,Sr,Er){return mr(Tr),Tr<=0?fr(Tr):Sr!==void 0?typeof Er=="string"?fr(Tr).fill(Sr,Er):fr(Tr).fill(Sr):fr(Tr)}dr.alloc=function(Tr,Sr,Er){return gr(Tr,Sr,Er)};function yr(Tr){return mr(Tr),fr(Tr<0?0:wr(Tr)|0)}dr.allocUnsafe=function(Tr){return yr(Tr)},dr.allocUnsafeSlow=function(Tr){return yr(Tr)};function br(Tr,Sr){if((typeof Sr!="string"||Sr==="")&&(Sr="utf8"),!dr.isEncoding(Sr))throw new TypeError("Unknown encoding: "+Sr);var Er=Cr(Tr,Sr)|0,Ir=fr(Er),Qr=Ir.write(Tr,Sr);return Qr!==Er&&(Ir=Ir.slice(0,Qr)),Ir}function Or(Tr){for(var Sr=Tr.length<0?0:wr(Tr.length)|0,Er=fr(Sr),Ir=0;Ir<Sr;Ir+=1)Er[Ir]=Tr[Ir]&255;return Er}function _r(Tr){if(ri(Tr,Uint8Array)){var Sr=new Uint8Array(Tr);return vr(Sr.buffer,Sr.byteOffset,Sr.byteLength)}return Or(Tr)}function vr(Tr,Sr,Er){if(Sr<0||Tr.byteLength<Sr)throw new RangeError('"offset" is outside of buffer bounds');if(Tr.byteLength<Sr+(Er||0))throw new RangeError('"length" is outside of buffer bounds');var Ir;return Sr===void 0&&Er===void 0?Ir=new Uint8Array(Tr):Er===void 0?Ir=new Uint8Array(Tr,Sr):Ir=new Uint8Array(Tr,Sr,Er),Object.setPrototypeOf(Ir,dr.prototype),Ir}function xr(Tr){if(dr.isBuffer(Tr)){var Sr=wr(Tr.length)|0,Er=fr(Sr);return Er.length===0||Tr.copy(Er,0,0,Sr),Er}if(Tr.length!==void 0)return typeof Tr.length!="number"||Lr(Tr.length)?fr(0):Or(Tr);if(Tr.type==="Buffer"&&Array.isArray(Tr.data))return Or(Tr.data)}function wr(Tr){if(Tr>=ur)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ur.toString(16)+" bytes");return Tr|0}function kr(Tr){return+Tr!=Tr&&(Tr=0),dr.alloc(+Tr)}dr.isBuffer=function(Tr){return Tr!=null&&Tr._isBuffer===!0&&Tr!==dr.prototype},dr.compare=function(Tr,Sr){if(ri(Tr,Uint8Array)&&(Tr=dr.from(Tr,Tr.offset,Tr.byteLength)),ri(Sr,Uint8Array)&&(Sr=dr.from(Sr,Sr.offset,Sr.byteLength)),!dr.isBuffer(Tr)||!dr.isBuffer(Sr))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Tr===Sr)return 0;for(var Er=Tr.length,Ir=Sr.length,Qr=0,zr=Math.min(Er,Ir);Qr<zr;++Qr)if(Tr[Qr]!==Sr[Qr]){Er=Tr[Qr],Ir=Sr[Qr];break}return Er<Ir?-1:Ir<Er?1:0},dr.isEncoding=function(Tr){switch(String(Tr).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},dr.concat=function(Tr,Sr){if(!Array.isArray(Tr))throw new TypeError('"list" argument must be an Array of Buffers');if(Tr.length===0)return dr.alloc(0);var Er;if(Sr===void 0)for(Sr=0,Er=0;Er<Tr.length;++Er)Sr+=Tr[Er].length;var Ir=dr.allocUnsafe(Sr),Qr=0;for(Er=0;Er<Tr.length;++Er){var zr=Tr[Er];if(ri(zr,Uint8Array))Qr+zr.length>Ir.length?dr.from(zr).copy(Ir,Qr):Uint8Array.prototype.set.call(Ir,zr,Qr);else if(dr.isBuffer(zr))zr.copy(Ir,Qr);else throw new TypeError('"list" argument must be an Array of Buffers');Qr+=zr.length}return Ir};function Cr(Tr,Sr){if(dr.isBuffer(Tr))return Tr.length;if(ArrayBuffer.isView(Tr)||ri(Tr,ArrayBuffer))return Tr.byteLength;if(typeof Tr!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Tr);var Er=Tr.length,Ir=arguments.length>2&&arguments[2]===!0;if(!Ir&&Er===0)return 0;for(var Qr=!1;;)switch(Sr){case"ascii":case"latin1":case"binary":return Er;case"utf8":case"utf-8":return Ar(Tr).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Er*2;case"hex":return Er>>>1;case"base64":return jr(Tr).length;default:if(Qr)return Ir?-1:Ar(Tr).length;Sr=(""+Sr).toLowerCase(),Qr=!0}}dr.byteLength=Cr;function $r(Tr,Sr,Er){var Ir=!1;if((Sr===void 0||Sr<0)&&(Sr=0),Sr>this.length||((Er===void 0||Er>this.length)&&(Er=this.length),Er<=0)||(Er>>>=0,Sr>>>=0,Er<=Sr))return"";for(Tr||(Tr="utf8");;)switch(Tr){case"hex":return ii(this,Sr,Er);case"utf8":case"utf-8":return Dr(this,Sr,Er);case"ascii":return Kr(this,Sr,Er);case"latin1":case"binary":return ui(this,Sr,Er);case"base64":return Yr(this,Sr,Er);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return di(this,Sr,Er);default:if(Ir)throw new TypeError("Unknown encoding: "+Tr);Tr=(Tr+"").toLowerCase(),Ir=!0}}dr.prototype._isBuffer=!0;function Nr(Tr,Sr,Er){var Ir=Tr[Sr];Tr[Sr]=Tr[Er],Tr[Er]=Ir}dr.prototype.swap16=function(){var Tr=this.length;if(Tr%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Sr=0;Sr<Tr;Sr+=2)Nr(this,Sr,Sr+1);return this},dr.prototype.swap32=function(){var Tr=this.length;if(Tr%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Sr=0;Sr<Tr;Sr+=4)Nr(this,Sr,Sr+3),Nr(this,Sr+1,Sr+2);return this},dr.prototype.swap64=function(){var Tr=this.length;if(Tr%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Sr=0;Sr<Tr;Sr+=8)Nr(this,Sr,Sr+7),Nr(this,Sr+1,Sr+6),Nr(this,Sr+2,Sr+5),Nr(this,Sr+3,Sr+4);return this},dr.prototype.toString=function(){var Tr=this.length;return Tr===0?"":arguments.length===0?Dr(this,0,Tr):$r.apply(this,arguments)},dr.prototype.toLocaleString=dr.prototype.toString,dr.prototype.equals=function(Tr){if(!dr.isBuffer(Tr))throw new TypeError("Argument must be a Buffer");return this===Tr?!0:dr.compare(this,Tr)===0},dr.prototype.inspect=function(){var Tr="",Sr=lr.INSPECT_MAX_BYTES;return Tr=this.toString("hex",0,Sr).replace(/(.{2})/g,"$1 ").trim(),this.length>Sr&&(Tr+=" ... "),"<Buffer "+Tr+">"},cr&&(dr.prototype[cr]=dr.prototype.inspect),dr.prototype.compare=function(Tr,Sr,Er,Ir,Qr){if(ri(Tr,Uint8Array)&&(Tr=dr.from(Tr,Tr.offset,Tr.byteLength)),!dr.isBuffer(Tr))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Tr);if(Sr===void 0&&(Sr=0),Er===void 0&&(Er=Tr?Tr.length:0),Ir===void 0&&(Ir=0),Qr===void 0&&(Qr=this.length),Sr<0||Er>Tr.length||Ir<0||Qr>this.length)throw new RangeError("out of range index");if(Ir>=Qr&&Sr>=Er)return 0;if(Ir>=Qr)return-1;if(Sr>=Er)return 1;if(Sr>>>=0,Er>>>=0,Ir>>>=0,Qr>>>=0,this===Tr)return 0;for(var zr=Qr-Ir,Hr=Er-Sr,li=Math.min(zr,Hr),pi=this.slice(Ir,Qr),hi=Tr.slice(Sr,Er),fi=0;fi<li;++fi)if(pi[fi]!==hi[fi]){zr=pi[fi],Hr=hi[fi];break}return zr<Hr?-1:Hr<zr?1:0};function Br(Tr,Sr,Er,Ir,Qr){if(Tr.length===0)return-1;if(typeof Er=="string"?(Ir=Er,Er=0):Er>2147483647?Er=2147483647:Er<-2147483648&&(Er=-2147483648),Er=+Er,Lr(Er)&&(Er=Qr?0:Tr.length-1),Er<0&&(Er=Tr.length+Er),Er>=Tr.length){if(Qr)return-1;Er=Tr.length-1}else if(Er<0)if(Qr)Er=0;else return-1;if(typeof Sr=="string"&&(Sr=dr.from(Sr,Ir)),dr.isBuffer(Sr))return Sr.length===0?-1:Fr(Tr,Sr,Er,Ir,Qr);if(typeof Sr=="number")return Sr=Sr&255,typeof Uint8Array.prototype.indexOf=="function"?Qr?Uint8Array.prototype.indexOf.call(Tr,Sr,Er):Uint8Array.prototype.lastIndexOf.call(Tr,Sr,Er):Fr(Tr,[Sr],Er,Ir,Qr);throw new TypeError("val must be string, number or Buffer")}function Fr(Tr,Sr,Er,Ir,Qr){var zr=1,Hr=Tr.length,li=Sr.length;if(Ir!==void 0&&(Ir=String(Ir).toLowerCase(),Ir==="ucs2"||Ir==="ucs-2"||Ir==="utf16le"||Ir==="utf-16le")){if(Tr.length<2||Sr.length<2)return-1;zr=2,Hr/=2,li/=2,Er/=2}function pi(_i,yi){return zr===1?_i[yi]:_i.readUInt16BE(yi*zr)}var hi;if(Qr){var fi=-1;for(hi=Er;hi<Hr;hi++)if(pi(Tr,hi)===pi(Sr,fi===-1?0:hi-fi)){if(fi===-1&&(fi=hi),hi-fi+1===li)return fi*zr}else fi!==-1&&(hi-=hi-fi),fi=-1}else for(Er+li>Hr&&(Er=Hr-li),hi=Er;hi>=0;hi--){for(var mi=!0,gi=0;gi<li;gi++)if(pi(Tr,hi+gi)!==pi(Sr,gi)){mi=!1;break}if(mi)return hi}return-1}dr.prototype.includes=function(Tr,Sr,Er){return this.indexOf(Tr,Sr,Er)!==-1},dr.prototype.indexOf=function(Tr,Sr,Er){return Br(this,Tr,Sr,Er,!0)},dr.prototype.lastIndexOf=function(Tr,Sr,Er){return Br(this,Tr,Sr,Er,!1)};function Vr(Tr,Sr,Er,Ir){Er=Number(Er)||0;var Qr=Tr.length-Er;Ir?(Ir=Number(Ir),Ir>Qr&&(Ir=Qr)):Ir=Qr;var zr=Sr.length;Ir>zr/2&&(Ir=zr/2);for(var Hr=0;Hr<Ir;++Hr){var li=parseInt(Sr.substr(Hr*2,2),16);if(Lr(li))return Hr;Tr[Er+Hr]=li}return Hr}function Rr(Tr,Sr,Er,Ir){return Xr(Ar(Sr,Tr.length-Er),Tr,Er,Ir)}function Gr(Tr,Sr,Er,Ir){return Xr(Zr(Sr),Tr,Er,Ir)}function qr(Tr,Sr,Er,Ir){return Xr(jr(Sr),Tr,Er,Ir)}function Ur(Tr,Sr,Er,Ir){return Xr(Mr(Sr,Tr.length-Er),Tr,Er,Ir)}dr.prototype.write=function(Tr,Sr,Er,Ir){if(Sr===void 0)Ir="utf8",Er=this.length,Sr=0;else if(Er===void 0&&typeof Sr=="string")Ir=Sr,Er=this.length,Sr=0;else if(isFinite(Sr))Sr=Sr>>>0,isFinite(Er)?(Er=Er>>>0,Ir===void 0&&(Ir="utf8")):(Ir=Er,Er=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Qr=this.length-Sr;if((Er===void 0||Er>Qr)&&(Er=Qr),Tr.length>0&&(Er<0||Sr<0)||Sr>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ir||(Ir="utf8");for(var zr=!1;;)switch(Ir){case"hex":return Vr(this,Tr,Sr,Er);case"utf8":case"utf-8":return Rr(this,Tr,Sr,Er);case"ascii":case"latin1":case"binary":return Gr(this,Tr,Sr,Er);case"base64":return qr(this,Tr,Sr,Er);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ur(this,Tr,Sr,Er);default:if(zr)throw new TypeError("Unknown encoding: "+Ir);Ir=(""+Ir).toLowerCase(),zr=!0}},dr.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Yr(Tr,Sr,Er){return Sr===0&&Er===Tr.length?or.fromByteArray(Tr):or.fromByteArray(Tr.slice(Sr,Er))}function Dr(Tr,Sr,Er){Er=Math.min(Tr.length,Er);for(var Ir=[],Qr=Sr;Qr<Er;){var zr=Tr[Qr],Hr=null,li=zr>239?4:zr>223?3:zr>191?2:1;if(Qr+li<=Er){var pi,hi,fi,mi;switch(li){case 1:zr<128&&(Hr=zr);break;case 2:pi=Tr[Qr+1],(pi&192)===128&&(mi=(zr&31)<<6|pi&63,mi>127&&(Hr=mi));break;case 3:pi=Tr[Qr+1],hi=Tr[Qr+2],(pi&192)===128&&(hi&192)===128&&(mi=(zr&15)<<12|(pi&63)<<6|hi&63,mi>2047&&(mi<55296||mi>57343)&&(Hr=mi));break;case 4:pi=Tr[Qr+1],hi=Tr[Qr+2],fi=Tr[Qr+3],(pi&192)===128&&(hi&192)===128&&(fi&192)===128&&(mi=(zr&15)<<18|(pi&63)<<12|(hi&63)<<6|fi&63,mi>65535&&mi<1114112&&(Hr=mi))}}Hr===null?(Hr=65533,li=1):Hr>65535&&(Hr-=65536,Ir.push(Hr>>>10&1023|55296),Hr=56320|Hr&1023),Ir.push(Hr),Qr+=li}return ai(Ir)}var Jr=4096;function ai(Tr){var Sr=Tr.length;if(Sr<=Jr)return String.fromCharCode.apply(String,Tr);for(var Er="",Ir=0;Ir<Sr;)Er+=String.fromCharCode.apply(String,Tr.slice(Ir,Ir+=Jr));return Er}function Kr(Tr,Sr,Er){var Ir="";Er=Math.min(Tr.length,Er);for(var Qr=Sr;Qr<Er;++Qr)Ir+=String.fromCharCode(Tr[Qr]&127);return Ir}function ui(Tr,Sr,Er){var Ir="";Er=Math.min(Tr.length,Er);for(var Qr=Sr;Qr<Er;++Qr)Ir+=String.fromCharCode(Tr[Qr]);return Ir}function ii(Tr,Sr,Er){var Ir=Tr.length;(!Sr||Sr<0)&&(Sr=0),(!Er||Er<0||Er>Ir)&&(Er=Ir);for(var Qr="",zr=Sr;zr<Er;++zr)Qr+=oi[Tr[zr]];return Qr}function di(Tr,Sr,Er){for(var Ir=Tr.slice(Sr,Er),Qr="",zr=0;zr<Ir.length-1;zr+=2)Qr+=String.fromCharCode(Ir[zr]+Ir[zr+1]*256);return Qr}dr.prototype.slice=function(Tr,Sr){var Er=this.length;Tr=~~Tr,Sr=Sr===void 0?Er:~~Sr,Tr<0?(Tr+=Er,Tr<0&&(Tr=0)):Tr>Er&&(Tr=Er),Sr<0?(Sr+=Er,Sr<0&&(Sr=0)):Sr>Er&&(Sr=Er),Sr<Tr&&(Sr=Tr);var Ir=this.subarray(Tr,Sr);return Object.setPrototypeOf(Ir,dr.prototype),Ir};function ei(Tr,Sr,Er){if(Tr%1!==0||Tr<0)throw new RangeError("offset is not uint");if(Tr+Sr>Er)throw new RangeError("Trying to access beyond buffer length")}dr.prototype.readUintLE=dr.prototype.readUIntLE=function(Tr,Sr,Er){Tr=Tr>>>0,Sr=Sr>>>0,Er||ei(Tr,Sr,this.length);for(var Ir=this[Tr],Qr=1,zr=0;++zr<Sr&&(Qr*=256);)Ir+=this[Tr+zr]*Qr;return Ir},dr.prototype.readUintBE=dr.prototype.readUIntBE=function(Tr,Sr,Er){Tr=Tr>>>0,Sr=Sr>>>0,Er||ei(Tr,Sr,this.length);for(var Ir=this[Tr+--Sr],Qr=1;Sr>0&&(Qr*=256);)Ir+=this[Tr+--Sr]*Qr;return Ir},dr.prototype.readUint8=dr.prototype.readUInt8=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,1,this.length),this[Tr]},dr.prototype.readUint16LE=dr.prototype.readUInt16LE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,2,this.length),this[Tr]|this[Tr+1]<<8},dr.prototype.readUint16BE=dr.prototype.readUInt16BE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,2,this.length),this[Tr]<<8|this[Tr+1]},dr.prototype.readUint32LE=dr.prototype.readUInt32LE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,4,this.length),(this[Tr]|this[Tr+1]<<8|this[Tr+2]<<16)+this[Tr+3]*16777216},dr.prototype.readUint32BE=dr.prototype.readUInt32BE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,4,this.length),this[Tr]*16777216+(this[Tr+1]<<16|this[Tr+2]<<8|this[Tr+3])},dr.prototype.readIntLE=function(Tr,Sr,Er){Tr=Tr>>>0,Sr=Sr>>>0,Er||ei(Tr,Sr,this.length);for(var Ir=this[Tr],Qr=1,zr=0;++zr<Sr&&(Qr*=256);)Ir+=this[Tr+zr]*Qr;return Qr*=128,Ir>=Qr&&(Ir-=Math.pow(2,8*Sr)),Ir},dr.prototype.readIntBE=function(Tr,Sr,Er){Tr=Tr>>>0,Sr=Sr>>>0,Er||ei(Tr,Sr,this.length);for(var Ir=Sr,Qr=1,zr=this[Tr+--Ir];Ir>0&&(Qr*=256);)zr+=this[Tr+--Ir]*Qr;return Qr*=128,zr>=Qr&&(zr-=Math.pow(2,8*Sr)),zr},dr.prototype.readInt8=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,1,this.length),this[Tr]&128?(255-this[Tr]+1)*-1:this[Tr]},dr.prototype.readInt16LE=function(Tr,Sr){Tr=Tr>>>0,Sr||ei(Tr,2,this.length);var Er=this[Tr]|this[Tr+1]<<8;return Er&32768?Er|4294901760:Er},dr.prototype.readInt16BE=function(Tr,Sr){Tr=Tr>>>0,Sr||ei(Tr,2,this.length);var Er=this[Tr+1]|this[Tr]<<8;return Er&32768?Er|4294901760:Er},dr.prototype.readInt32LE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,4,this.length),this[Tr]|this[Tr+1]<<8|this[Tr+2]<<16|this[Tr+3]<<24},dr.prototype.readInt32BE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,4,this.length),this[Tr]<<24|this[Tr+1]<<16|this[Tr+2]<<8|this[Tr+3]},dr.prototype.readFloatLE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,4,this.length),ar.read(this,Tr,!0,23,4)},dr.prototype.readFloatBE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,4,this.length),ar.read(this,Tr,!1,23,4)},dr.prototype.readDoubleLE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,8,this.length),ar.read(this,Tr,!0,52,8)},dr.prototype.readDoubleBE=function(Tr,Sr){return Tr=Tr>>>0,Sr||ei(Tr,8,this.length),ar.read(this,Tr,!1,52,8)};function Wr(Tr,Sr,Er,Ir,Qr,zr){if(!dr.isBuffer(Tr))throw new TypeError('"buffer" argument must be a Buffer instance');if(Sr>Qr||Sr<zr)throw new RangeError('"value" argument is out of bounds');if(Er+Ir>Tr.length)throw new RangeError("Index out of range")}dr.prototype.writeUintLE=dr.prototype.writeUIntLE=function(Tr,Sr,Er,Ir){if(Tr=+Tr,Sr=Sr>>>0,Er=Er>>>0,!Ir){var Qr=Math.pow(2,8*Er)-1;Wr(this,Tr,Sr,Er,Qr,0)}var zr=1,Hr=0;for(this[Sr]=Tr&255;++Hr<Er&&(zr*=256);)this[Sr+Hr]=Tr/zr&255;return Sr+Er},dr.prototype.writeUintBE=dr.prototype.writeUIntBE=function(Tr,Sr,Er,Ir){if(Tr=+Tr,Sr=Sr>>>0,Er=Er>>>0,!Ir){var Qr=Math.pow(2,8*Er)-1;Wr(this,Tr,Sr,Er,Qr,0)}var zr=Er-1,Hr=1;for(this[Sr+zr]=Tr&255;--zr>=0&&(Hr*=256);)this[Sr+zr]=Tr/Hr&255;return Sr+Er},dr.prototype.writeUint8=dr.prototype.writeUInt8=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,1,255,0),this[Sr]=Tr&255,Sr+1},dr.prototype.writeUint16LE=dr.prototype.writeUInt16LE=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,2,65535,0),this[Sr]=Tr&255,this[Sr+1]=Tr>>>8,Sr+2},dr.prototype.writeUint16BE=dr.prototype.writeUInt16BE=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,2,65535,0),this[Sr]=Tr>>>8,this[Sr+1]=Tr&255,Sr+2},dr.prototype.writeUint32LE=dr.prototype.writeUInt32LE=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,4,4294967295,0),this[Sr+3]=Tr>>>24,this[Sr+2]=Tr>>>16,this[Sr+1]=Tr>>>8,this[Sr]=Tr&255,Sr+4},dr.prototype.writeUint32BE=dr.prototype.writeUInt32BE=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,4,4294967295,0),this[Sr]=Tr>>>24,this[Sr+1]=Tr>>>16,this[Sr+2]=Tr>>>8,this[Sr+3]=Tr&255,Sr+4},dr.prototype.writeIntLE=function(Tr,Sr,Er,Ir){if(Tr=+Tr,Sr=Sr>>>0,!Ir){var Qr=Math.pow(2,8*Er-1);Wr(this,Tr,Sr,Er,Qr-1,-Qr)}var zr=0,Hr=1,li=0;for(this[Sr]=Tr&255;++zr<Er&&(Hr*=256);)Tr<0&&li===0&&this[Sr+zr-1]!==0&&(li=1),this[Sr+zr]=(Tr/Hr>>0)-li&255;return Sr+Er},dr.prototype.writeIntBE=function(Tr,Sr,Er,Ir){if(Tr=+Tr,Sr=Sr>>>0,!Ir){var Qr=Math.pow(2,8*Er-1);Wr(this,Tr,Sr,Er,Qr-1,-Qr)}var zr=Er-1,Hr=1,li=0;for(this[Sr+zr]=Tr&255;--zr>=0&&(Hr*=256);)Tr<0&&li===0&&this[Sr+zr+1]!==0&&(li=1),this[Sr+zr]=(Tr/Hr>>0)-li&255;return Sr+Er},dr.prototype.writeInt8=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,1,127,-128),Tr<0&&(Tr=255+Tr+1),this[Sr]=Tr&255,Sr+1},dr.prototype.writeInt16LE=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,2,32767,-32768),this[Sr]=Tr&255,this[Sr+1]=Tr>>>8,Sr+2},dr.prototype.writeInt16BE=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,2,32767,-32768),this[Sr]=Tr>>>8,this[Sr+1]=Tr&255,Sr+2},dr.prototype.writeInt32LE=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,4,2147483647,-2147483648),this[Sr]=Tr&255,this[Sr+1]=Tr>>>8,this[Sr+2]=Tr>>>16,this[Sr+3]=Tr>>>24,Sr+4},dr.prototype.writeInt32BE=function(Tr,Sr,Er){return Tr=+Tr,Sr=Sr>>>0,Er||Wr(this,Tr,Sr,4,2147483647,-2147483648),Tr<0&&(Tr=4294967295+Tr+1),this[Sr]=Tr>>>24,this[Sr+1]=Tr>>>16,this[Sr+2]=Tr>>>8,this[Sr+3]=Tr&255,Sr+4};function ti(Tr,Sr,Er,Ir,Qr,zr){if(Er+Ir>Tr.length)throw new RangeError("Index out of range");if(Er<0)throw new RangeError("Index out of range")}function si(Tr,Sr,Er,Ir,Qr){return Sr=+Sr,Er=Er>>>0,Qr||ti(Tr,Sr,Er,4),ar.write(Tr,Sr,Er,Ir,23,4),Er+4}dr.prototype.writeFloatLE=function(Tr,Sr,Er){return si(this,Tr,Sr,!0,Er)},dr.prototype.writeFloatBE=function(Tr,Sr,Er){return si(this,Tr,Sr,!1,Er)};function ci(Tr,Sr,Er,Ir,Qr){return Sr=+Sr,Er=Er>>>0,Qr||ti(Tr,Sr,Er,8),ar.write(Tr,Sr,Er,Ir,52,8),Er+8}dr.prototype.writeDoubleLE=function(Tr,Sr,Er){return ci(this,Tr,Sr,!0,Er)},dr.prototype.writeDoubleBE=function(Tr,Sr,Er){return ci(this,Tr,Sr,!1,Er)},dr.prototype.copy=function(Tr,Sr,Er,Ir){if(!dr.isBuffer(Tr))throw new TypeError("argument should be a Buffer");if(Er||(Er=0),!Ir&&Ir!==0&&(Ir=this.length),Sr>=Tr.length&&(Sr=Tr.length),Sr||(Sr=0),Ir>0&&Ir<Er&&(Ir=Er),Ir===Er||Tr.length===0||this.length===0)return 0;if(Sr<0)throw new RangeError("targetStart out of bounds");if(Er<0||Er>=this.length)throw new RangeError("Index out of range");if(Ir<0)throw new RangeError("sourceEnd out of bounds");Ir>this.length&&(Ir=this.length),Tr.length-Sr<Ir-Er&&(Ir=Tr.length-Sr+Er);var Qr=Ir-Er;return this===Tr&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Sr,Er,Ir):Uint8Array.prototype.set.call(Tr,this.subarray(Er,Ir),Sr),Qr},dr.prototype.fill=function(Tr,Sr,Er,Ir){if(typeof Tr=="string"){if(typeof Sr=="string"?(Ir=Sr,Sr=0,Er=this.length):typeof Er=="string"&&(Ir=Er,Er=this.length),Ir!==void 0&&typeof Ir!="string")throw new TypeError("encoding must be a string");if(typeof Ir=="string"&&!dr.isEncoding(Ir))throw new TypeError("Unknown encoding: "+Ir);if(Tr.length===1){var Qr=Tr.charCodeAt(0);(Ir==="utf8"&&Qr<128||Ir==="latin1")&&(Tr=Qr)}}else typeof Tr=="number"?Tr=Tr&255:typeof Tr=="boolean"&&(Tr=Number(Tr));if(Sr<0||this.length<Sr||this.length<Er)throw new RangeError("Out of range index");if(Er<=Sr)return this;Sr=Sr>>>0,Er=Er===void 0?this.length:Er>>>0,Tr||(Tr=0);var zr;if(typeof Tr=="number")for(zr=Sr;zr<Er;++zr)this[zr]=Tr;else{var Hr=dr.isBuffer(Tr)?Tr:dr.from(Tr,Ir),li=Hr.length;if(li===0)throw new TypeError('The value "'+Tr+'" is invalid for argument "value"');for(zr=0;zr<Er-Sr;++zr)this[zr+Sr]=Hr[zr%li]}return this};var ni=/[^+/0-9A-Za-z-_]/g;function Pr(Tr){if(Tr=Tr.split("=")[0],Tr=Tr.trim().replace(ni,""),Tr.length<2)return"";for(;Tr.length%4!==0;)Tr=Tr+"=";return Tr}function Ar(Tr,Sr){Sr=Sr||1/0;for(var Er,Ir=Tr.length,Qr=null,zr=[],Hr=0;Hr<Ir;++Hr){if(Er=Tr.charCodeAt(Hr),Er>55295&&Er<57344){if(!Qr){if(Er>56319){(Sr-=3)>-1&&zr.push(239,191,189);continue}else if(Hr+1===Ir){(Sr-=3)>-1&&zr.push(239,191,189);continue}Qr=Er;continue}if(Er<56320){(Sr-=3)>-1&&zr.push(239,191,189),Qr=Er;continue}Er=(Qr-55296<<10|Er-56320)+65536}else Qr&&(Sr-=3)>-1&&zr.push(239,191,189);if(Qr=null,Er<128){if((Sr-=1)<0)break;zr.push(Er)}else if(Er<2048){if((Sr-=2)<0)break;zr.push(Er>>6|192,Er&63|128)}else if(Er<65536){if((Sr-=3)<0)break;zr.push(Er>>12|224,Er>>6&63|128,Er&63|128)}else if(Er<1114112){if((Sr-=4)<0)break;zr.push(Er>>18|240,Er>>12&63|128,Er>>6&63|128,Er&63|128)}else throw new Error("Invalid code point")}return zr}function Zr(Tr){for(var Sr=[],Er=0;Er<Tr.length;++Er)Sr.push(Tr.charCodeAt(Er)&255);return Sr}function Mr(Tr,Sr){for(var Er,Ir,Qr,zr=[],Hr=0;Hr<Tr.length&&!((Sr-=2)<0);++Hr)Er=Tr.charCodeAt(Hr),Ir=Er>>8,Qr=Er%256,zr.push(Qr),zr.push(Ir);return zr}function jr(Tr){return or.toByteArray(Pr(Tr))}function Xr(Tr,Sr,Er,Ir){for(var Qr=0;Qr<Ir&&!(Qr+Er>=Sr.length||Qr>=Tr.length);++Qr)Sr[Qr+Er]=Tr[Qr];return Qr}function ri(Tr,Sr){return Tr instanceof Sr||Tr!=null&&Tr.constructor!=null&&Tr.constructor.name!=null&&Tr.constructor.name===Sr.name}function Lr(Tr){return Tr!==Tr}var oi=function(){for(var Tr="0123456789abcdef",Sr=new Array(256),Er=0;Er<16;++Er)for(var Ir=Er*16,Qr=0;Qr<16;++Qr)Sr[Ir+Qr]=Tr[Er]+Tr[Qr];return Sr}()}(_t$1)),_t$1}var Mt$1;function ue$1(){return Mt$1||(Mt$1=1,function(lr,or){var ar=ae$1(),cr=ar.Buffer;function ur(fr,dr){for(var pr in fr)dr[pr]=fr[pr]}cr.from&&cr.alloc&&cr.allocUnsafe&&cr.allocUnsafeSlow?lr.exports=ar:(ur(ar,or),or.Buffer=hr);function hr(fr,dr,pr){return cr(fr,dr,pr)}ur(cr,hr),hr.from=function(fr,dr,pr){if(typeof fr=="number")throw new TypeError("Argument must not be a number");return cr(fr,dr,pr)},hr.alloc=function(fr,dr,pr){if(typeof fr!="number")throw new TypeError("Argument must be a number");var mr=cr(fr);return dr!==void 0?typeof pr=="string"?mr.fill(dr,pr):mr.fill(dr):mr.fill(0),mr},hr.allocUnsafe=function(fr){if(typeof fr!="number")throw new TypeError("Argument must be a number");return cr(fr)},hr.allocUnsafeSlow=function(fr){if(typeof fr!="number")throw new TypeError("Argument must be a number");return ar.SlowBuffer(fr)}}(Tt$1,Tt$1.exports)),Tt$1.exports}var Pt$1;function oe$1(){if(Pt$1)return It$1;Pt$1=1;var lr=ue$1().Buffer,or=lr.isEncoding||function(wr){switch(wr=""+wr,wr&&wr.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function ar(wr){if(!wr)return"utf8";for(var kr;;)switch(wr){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return wr;default:if(kr)return;wr=(""+wr).toLowerCase(),kr=!0}}function cr(wr){var kr=ar(wr);if(typeof kr!="string"&&(lr.isEncoding===or||!or(wr)))throw new Error("Unknown encoding: "+wr);return kr||wr}It$1.StringDecoder=ur;function ur(wr){this.encoding=cr(wr);var kr;switch(this.encoding){case"utf16le":this.text=yr,this.end=br,kr=4;break;case"utf8":this.fillLast=pr,kr=4;break;case"base64":this.text=Or,this.end=_r,kr=3;break;default:this.write=vr,this.end=xr;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=lr.allocUnsafe(kr)}ur.prototype.write=function(wr){if(wr.length===0)return"";var kr,Cr;if(this.lastNeed){if(kr=this.fillLast(wr),kr===void 0)return"";Cr=this.lastNeed,this.lastNeed=0}else Cr=0;return Cr<wr.length?kr?kr+this.text(wr,Cr):this.text(wr,Cr):kr||""},ur.prototype.end=gr,ur.prototype.text=mr,ur.prototype.fillLast=function(wr){if(this.lastNeed<=wr.length)return wr.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);wr.copy(this.lastChar,this.lastTotal-this.lastNeed,0,wr.length),this.lastNeed-=wr.length};function hr(wr){return wr<=127?0:wr>>5===6?2:wr>>4===14?3:wr>>3===30?4:wr>>6===2?-1:-2}function fr(wr,kr,Cr){var $r=kr.length-1;if($r<Cr)return 0;var Nr=hr(kr[$r]);return Nr>=0?(Nr>0&&(wr.lastNeed=Nr-1),Nr):--$r<Cr||Nr===-2?0:(Nr=hr(kr[$r]),Nr>=0?(Nr>0&&(wr.lastNeed=Nr-2),Nr):--$r<Cr||Nr===-2?0:(Nr=hr(kr[$r]),Nr>=0?(Nr>0&&(Nr===2?Nr=0:wr.lastNeed=Nr-3),Nr):0))}function dr(wr,kr,Cr){if((kr[0]&192)!==128)return wr.lastNeed=0,"�";if(wr.lastNeed>1&&kr.length>1){if((kr[1]&192)!==128)return wr.lastNeed=1,"�";if(wr.lastNeed>2&&kr.length>2&&(kr[2]&192)!==128)return wr.lastNeed=2,"�"}}function pr(wr){var kr=this.lastTotal-this.lastNeed,Cr=dr(this,wr);if(Cr!==void 0)return Cr;if(this.lastNeed<=wr.length)return wr.copy(this.lastChar,kr,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);wr.copy(this.lastChar,kr,0,wr.length),this.lastNeed-=wr.length}function mr(wr,kr){var Cr=fr(this,wr,kr);if(!this.lastNeed)return wr.toString("utf8",kr);this.lastTotal=Cr;var $r=wr.length-(Cr-this.lastNeed);return wr.copy(this.lastChar,0,$r),wr.toString("utf8",kr,$r)}function gr(wr){var kr=wr&&wr.length?this.write(wr):"";return this.lastNeed?kr+"�":kr}function yr(wr,kr){if((wr.length-kr)%2===0){var Cr=wr.toString("utf16le",kr);if(Cr){var $r=Cr.charCodeAt(Cr.length-1);if($r>=55296&&$r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=wr[wr.length-2],this.lastChar[1]=wr[wr.length-1],Cr.slice(0,-1)}return Cr}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=wr[wr.length-1],wr.toString("utf16le",kr,wr.length-1)}function br(wr){var kr=wr&&wr.length?this.write(wr):"";if(this.lastNeed){var Cr=this.lastTotal-this.lastNeed;return kr+this.lastChar.toString("utf16le",0,Cr)}return kr}function Or(wr,kr){var Cr=(wr.length-kr)%3;return Cr===0?wr.toString("base64",kr):(this.lastNeed=3-Cr,this.lastTotal=3,Cr===1?this.lastChar[0]=wr[wr.length-1]:(this.lastChar[0]=wr[wr.length-2],this.lastChar[1]=wr[wr.length-1]),wr.toString("base64",kr,wr.length-Cr))}function _r(wr){var kr=wr&&wr.length?this.write(wr):"";return this.lastNeed?kr+this.lastChar.toString("base64",0,3-this.lastNeed):kr}function vr(wr){return wr.toString(this.encoding)}function xr(wr){return wr&&wr.length?this.write(wr):""}return It$1}(function(lr){(function(or){or.parser=function(Pr,Ar){return new cr(Pr,Ar)},or.SAXParser=cr,or.SAXStream=gr,or.createStream=mr,or.MAX_BUFFER_LENGTH=64*1024;var ar=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];or.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function cr(Pr,Ar){if(!(this instanceof cr))return new cr(Pr,Ar);var Zr=this;hr(Zr),Zr.q=Zr.c="",Zr.bufferCheckPosition=or.MAX_BUFFER_LENGTH,Zr.opt=Ar||{},Zr.opt.lowercase=Zr.opt.lowercase||Zr.opt.lowercasetags,Zr.looseCase=Zr.opt.lowercase?"toLowerCase":"toUpperCase",Zr.tags=[],Zr.closed=Zr.closedRoot=Zr.sawRoot=!1,Zr.tag=Zr.error=null,Zr.strict=!!Pr,Zr.noscript=!!(Pr||Zr.opt.noscript),Zr.state=Rr.BEGIN,Zr.strictEntities=Zr.opt.strictEntities,Zr.ENTITIES=Zr.strictEntities?Object.create(or.XML_ENTITIES):Object.create(or.ENTITIES),Zr.attribList=[],Zr.opt.xmlns&&(Zr.ns=Object.create(vr)),Zr.trackPosition=Zr.opt.position!==!1,Zr.trackPosition&&(Zr.position=Zr.line=Zr.column=0),qr(Zr,"onready")}Object.create||(Object.create=function(Pr){function Ar(){}Ar.prototype=Pr;var Zr=new Ar;return Zr}),Object.keys||(Object.keys=function(Pr){var Ar=[];for(var Zr in Pr)Pr.hasOwnProperty(Zr)&&Ar.push(Zr);return Ar});function ur(Pr){for(var Ar=Math.max(or.MAX_BUFFER_LENGTH,10),Zr=0,Mr=0,jr=ar.length;Mr<jr;Mr++){var Xr=Pr[ar[Mr]].length;if(Xr>Ar)switch(ar[Mr]){case"textNode":Yr(Pr);break;case"cdata":Ur(Pr,"oncdata",Pr.cdata),Pr.cdata="";break;case"script":Ur(Pr,"onscript",Pr.script),Pr.script="";break;default:Jr(Pr,"Max buffer length exceeded: "+ar[Mr])}Zr=Math.max(Zr,Xr)}var ri=or.MAX_BUFFER_LENGTH-Zr;Pr.bufferCheckPosition=ri+Pr.position}function hr(Pr){for(var Ar=0,Zr=ar.length;Ar<Zr;Ar++)Pr[ar[Ar]]=""}function fr(Pr){Yr(Pr),Pr.cdata!==""&&(Ur(Pr,"oncdata",Pr.cdata),Pr.cdata=""),Pr.script!==""&&(Ur(Pr,"onscript",Pr.script),Pr.script="")}cr.prototype={end:function(){ai(this)},write:ni,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){fr(this)}};var dr;try{dr=re$1().Stream}catch{dr=function(){}}var pr=or.EVENTS.filter(function(Pr){return Pr!=="error"&&Pr!=="end"});function mr(Pr,Ar){return new gr(Pr,Ar)}function gr(Pr,Ar){if(!(this instanceof gr))return new gr(Pr,Ar);dr.apply(this),this._parser=new cr(Pr,Ar),this.writable=!0,this.readable=!0;var Zr=this;this._parser.onend=function(){Zr.emit("end")},this._parser.onerror=function(Mr){Zr.emit("error",Mr),Zr._parser.error=null},this._decoder=null,pr.forEach(function(Mr){Object.defineProperty(Zr,"on"+Mr,{get:function(){return Zr._parser["on"+Mr]},set:function(jr){if(!jr)return Zr.removeAllListeners(Mr),Zr._parser["on"+Mr]=jr,jr;Zr.on(Mr,jr)},enumerable:!0,configurable:!1})})}gr.prototype=Object.create(dr.prototype,{constructor:{value:gr}}),gr.prototype.write=function(Pr){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(Pr)){if(!this._decoder){var Ar=oe$1().StringDecoder;this._decoder=new Ar("utf8")}Pr=this._decoder.write(Pr)}return this._parser.write(Pr.toString()),this.emit("data",Pr),!0},gr.prototype.end=function(Pr){return Pr&&Pr.length&&this.write(Pr),this._parser.end(),!0},gr.prototype.on=function(Pr,Ar){var Zr=this;return!Zr._parser["on"+Pr]&&pr.indexOf(Pr)!==-1&&(Zr._parser["on"+Pr]=function(){var Mr=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);Mr.splice(0,0,Pr),Zr.emit.apply(Zr,Mr)}),dr.prototype.on.call(Zr,Pr,Ar)};var yr="[CDATA[",br="DOCTYPE",Or="http://www.w3.org/XML/1998/namespace",_r="http://www.w3.org/2000/xmlns/",vr={xml:Or,xmlns:_r},xr=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,wr=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,kr=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Cr=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function $r(Pr){return Pr===" "||Pr===`
`||Pr==="\r"||Pr==="	"}function Nr(Pr){return Pr==='"'||Pr==="'"}function Br(Pr){return Pr===">"||$r(Pr)}function Fr(Pr,Ar){return Pr.test(Ar)}function Vr(Pr,Ar){return!Fr(Pr,Ar)}var Rr=0;or.STATE={BEGIN:Rr++,BEGIN_WHITESPACE:Rr++,TEXT:Rr++,TEXT_ENTITY:Rr++,OPEN_WAKA:Rr++,SGML_DECL:Rr++,SGML_DECL_QUOTED:Rr++,DOCTYPE:Rr++,DOCTYPE_QUOTED:Rr++,DOCTYPE_DTD:Rr++,DOCTYPE_DTD_QUOTED:Rr++,COMMENT_STARTING:Rr++,COMMENT:Rr++,COMMENT_ENDING:Rr++,COMMENT_ENDED:Rr++,CDATA:Rr++,CDATA_ENDING:Rr++,CDATA_ENDING_2:Rr++,PROC_INST:Rr++,PROC_INST_BODY:Rr++,PROC_INST_ENDING:Rr++,OPEN_TAG:Rr++,OPEN_TAG_SLASH:Rr++,ATTRIB:Rr++,ATTRIB_NAME:Rr++,ATTRIB_NAME_SAW_WHITE:Rr++,ATTRIB_VALUE:Rr++,ATTRIB_VALUE_QUOTED:Rr++,ATTRIB_VALUE_CLOSED:Rr++,ATTRIB_VALUE_UNQUOTED:Rr++,ATTRIB_VALUE_ENTITY_Q:Rr++,ATTRIB_VALUE_ENTITY_U:Rr++,CLOSE_TAG:Rr++,CLOSE_TAG_SAW_WHITE:Rr++,SCRIPT:Rr++,SCRIPT_ENDING:Rr++},or.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},or.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(or.ENTITIES).forEach(function(Pr){var Ar=or.ENTITIES[Pr],Zr=typeof Ar=="number"?String.fromCharCode(Ar):Ar;or.ENTITIES[Pr]=Zr});for(var Gr in or.STATE)or.STATE[or.STATE[Gr]]=Gr;Rr=or.STATE;function qr(Pr,Ar,Zr){Pr[Ar]&&Pr[Ar](Zr)}function Ur(Pr,Ar,Zr){Pr.textNode&&Yr(Pr),qr(Pr,Ar,Zr)}function Yr(Pr){Pr.textNode=Dr(Pr.opt,Pr.textNode),Pr.textNode&&qr(Pr,"ontext",Pr.textNode),Pr.textNode=""}function Dr(Pr,Ar){return Pr.trim&&(Ar=Ar.trim()),Pr.normalize&&(Ar=Ar.replace(/\s+/g," ")),Ar}function Jr(Pr,Ar){return Yr(Pr),Pr.trackPosition&&(Ar+=`
Line: `+Pr.line+`
Column: `+Pr.column+`
Char: `+Pr.c),Ar=new Error(Ar),Pr.error=Ar,qr(Pr,"onerror",Ar),Pr}function ai(Pr){return Pr.sawRoot&&!Pr.closedRoot&&Kr(Pr,"Unclosed root tag"),Pr.state!==Rr.BEGIN&&Pr.state!==Rr.BEGIN_WHITESPACE&&Pr.state!==Rr.TEXT&&Jr(Pr,"Unexpected end"),Yr(Pr),Pr.c="",Pr.closed=!0,qr(Pr,"onend"),cr.call(Pr,Pr.strict,Pr.opt),Pr}function Kr(Pr,Ar){if(typeof Pr!="object"||!(Pr instanceof cr))throw new Error("bad call to strictFail");Pr.strict&&Jr(Pr,Ar)}function ui(Pr){Pr.strict||(Pr.tagName=Pr.tagName[Pr.looseCase]());var Ar=Pr.tags[Pr.tags.length-1]||Pr,Zr=Pr.tag={name:Pr.tagName,attributes:{}};Pr.opt.xmlns&&(Zr.ns=Ar.ns),Pr.attribList.length=0,Ur(Pr,"onopentagstart",Zr)}function ii(Pr,Ar){var Zr=Pr.indexOf(":"),Mr=Zr<0?["",Pr]:Pr.split(":"),jr=Mr[0],Xr=Mr[1];return Ar&&Pr==="xmlns"&&(jr="xmlns",Xr=""),{prefix:jr,local:Xr}}function di(Pr){if(Pr.strict||(Pr.attribName=Pr.attribName[Pr.looseCase]()),Pr.attribList.indexOf(Pr.attribName)!==-1||Pr.tag.attributes.hasOwnProperty(Pr.attribName)){Pr.attribName=Pr.attribValue="";return}if(Pr.opt.xmlns){var Ar=ii(Pr.attribName,!0),Zr=Ar.prefix,Mr=Ar.local;if(Zr==="xmlns")if(Mr==="xml"&&Pr.attribValue!==Or)Kr(Pr,"xml: prefix must be bound to "+Or+`
Actual: `+Pr.attribValue);else if(Mr==="xmlns"&&Pr.attribValue!==_r)Kr(Pr,"xmlns: prefix must be bound to "+_r+`
Actual: `+Pr.attribValue);else{var jr=Pr.tag,Xr=Pr.tags[Pr.tags.length-1]||Pr;jr.ns===Xr.ns&&(jr.ns=Object.create(Xr.ns)),jr.ns[Mr]=Pr.attribValue}Pr.attribList.push([Pr.attribName,Pr.attribValue])}else Pr.tag.attributes[Pr.attribName]=Pr.attribValue,Ur(Pr,"onattribute",{name:Pr.attribName,value:Pr.attribValue});Pr.attribName=Pr.attribValue=""}function ei(Pr,Ar){if(Pr.opt.xmlns){var Zr=Pr.tag,Mr=ii(Pr.tagName);Zr.prefix=Mr.prefix,Zr.local=Mr.local,Zr.uri=Zr.ns[Mr.prefix]||"",Zr.prefix&&!Zr.uri&&(Kr(Pr,"Unbound namespace prefix: "+JSON.stringify(Pr.tagName)),Zr.uri=Mr.prefix);var jr=Pr.tags[Pr.tags.length-1]||Pr;Zr.ns&&jr.ns!==Zr.ns&&Object.keys(Zr.ns).forEach(function(Hr){Ur(Pr,"onopennamespace",{prefix:Hr,uri:Zr.ns[Hr]})});for(var Xr=0,ri=Pr.attribList.length;Xr<ri;Xr++){var Lr=Pr.attribList[Xr],oi=Lr[0],Tr=Lr[1],Sr=ii(oi,!0),Er=Sr.prefix,Ir=Sr.local,Qr=Er===""?"":Zr.ns[Er]||"",zr={name:oi,value:Tr,prefix:Er,local:Ir,uri:Qr};Er&&Er!=="xmlns"&&!Qr&&(Kr(Pr,"Unbound namespace prefix: "+JSON.stringify(Er)),zr.uri=Er),Pr.tag.attributes[oi]=zr,Ur(Pr,"onattribute",zr)}Pr.attribList.length=0}Pr.tag.isSelfClosing=!!Ar,Pr.sawRoot=!0,Pr.tags.push(Pr.tag),Ur(Pr,"onopentag",Pr.tag),Ar||(!Pr.noscript&&Pr.tagName.toLowerCase()==="script"?Pr.state=Rr.SCRIPT:Pr.state=Rr.TEXT,Pr.tag=null,Pr.tagName=""),Pr.attribName=Pr.attribValue="",Pr.attribList.length=0}function Wr(Pr){if(!Pr.tagName){Kr(Pr,"Weird empty close tag."),Pr.textNode+="</>",Pr.state=Rr.TEXT;return}if(Pr.script){if(Pr.tagName!=="script"){Pr.script+="</"+Pr.tagName+">",Pr.tagName="",Pr.state=Rr.SCRIPT;return}Ur(Pr,"onscript",Pr.script),Pr.script=""}var Ar=Pr.tags.length,Zr=Pr.tagName;Pr.strict||(Zr=Zr[Pr.looseCase]());for(var Mr=Zr;Ar--;){var jr=Pr.tags[Ar];if(jr.name!==Mr)Kr(Pr,"Unexpected close tag");else break}if(Ar<0){Kr(Pr,"Unmatched closing tag: "+Pr.tagName),Pr.textNode+="</"+Pr.tagName+">",Pr.state=Rr.TEXT;return}Pr.tagName=Zr;for(var Xr=Pr.tags.length;Xr-- >Ar;){var ri=Pr.tag=Pr.tags.pop();Pr.tagName=Pr.tag.name,Ur(Pr,"onclosetag",Pr.tagName);var Lr={};for(var oi in ri.ns)Lr[oi]=ri.ns[oi];var Tr=Pr.tags[Pr.tags.length-1]||Pr;Pr.opt.xmlns&&ri.ns!==Tr.ns&&Object.keys(ri.ns).forEach(function(Sr){var Er=ri.ns[Sr];Ur(Pr,"onclosenamespace",{prefix:Sr,uri:Er})})}Ar===0&&(Pr.closedRoot=!0),Pr.tagName=Pr.attribValue=Pr.attribName="",Pr.attribList.length=0,Pr.state=Rr.TEXT}function ti(Pr){var Ar=Pr.entity,Zr=Ar.toLowerCase(),Mr,jr="";return Pr.ENTITIES[Ar]?Pr.ENTITIES[Ar]:Pr.ENTITIES[Zr]?Pr.ENTITIES[Zr]:(Ar=Zr,Ar.charAt(0)==="#"&&(Ar.charAt(1)==="x"?(Ar=Ar.slice(2),Mr=parseInt(Ar,16),jr=Mr.toString(16)):(Ar=Ar.slice(1),Mr=parseInt(Ar,10),jr=Mr.toString(10))),Ar=Ar.replace(/^0+/,""),isNaN(Mr)||jr.toLowerCase()!==Ar?(Kr(Pr,"Invalid character entity"),"&"+Pr.entity+";"):String.fromCodePoint(Mr))}function si(Pr,Ar){Ar==="<"?(Pr.state=Rr.OPEN_WAKA,Pr.startTagPosition=Pr.position):$r(Ar)||(Kr(Pr,"Non-whitespace before first tag."),Pr.textNode=Ar,Pr.state=Rr.TEXT)}function ci(Pr,Ar){var Zr="";return Ar<Pr.length&&(Zr=Pr.charAt(Ar)),Zr}function ni(Pr){var Ar=this;if(this.error)throw this.error;if(Ar.closed)return Jr(Ar,"Cannot write after close. Assign an onready handler.");if(Pr===null)return ai(Ar);typeof Pr=="object"&&(Pr=Pr.toString());for(var Zr=0,Mr="";Mr=ci(Pr,Zr++),Ar.c=Mr,!!Mr;)switch(Ar.trackPosition&&(Ar.position++,Mr===`
`?(Ar.line++,Ar.column=0):Ar.column++),Ar.state){case Rr.BEGIN:if(Ar.state=Rr.BEGIN_WHITESPACE,Mr==="\uFEFF")continue;si(Ar,Mr);continue;case Rr.BEGIN_WHITESPACE:si(Ar,Mr);continue;case Rr.TEXT:if(Ar.sawRoot&&!Ar.closedRoot){for(var jr=Zr-1;Mr&&Mr!=="<"&&Mr!=="&";)Mr=ci(Pr,Zr++),Mr&&Ar.trackPosition&&(Ar.position++,Mr===`
`?(Ar.line++,Ar.column=0):Ar.column++);Ar.textNode+=Pr.substring(jr,Zr-1)}Mr==="<"&&!(Ar.sawRoot&&Ar.closedRoot&&!Ar.strict)?(Ar.state=Rr.OPEN_WAKA,Ar.startTagPosition=Ar.position):(!$r(Mr)&&(!Ar.sawRoot||Ar.closedRoot)&&Kr(Ar,"Text data outside of root node."),Mr==="&"?Ar.state=Rr.TEXT_ENTITY:Ar.textNode+=Mr);continue;case Rr.SCRIPT:Mr==="<"?Ar.state=Rr.SCRIPT_ENDING:Ar.script+=Mr;continue;case Rr.SCRIPT_ENDING:Mr==="/"?Ar.state=Rr.CLOSE_TAG:(Ar.script+="<"+Mr,Ar.state=Rr.SCRIPT);continue;case Rr.OPEN_WAKA:if(Mr==="!")Ar.state=Rr.SGML_DECL,Ar.sgmlDecl="";else if(!$r(Mr))if(Fr(xr,Mr))Ar.state=Rr.OPEN_TAG,Ar.tagName=Mr;else if(Mr==="/")Ar.state=Rr.CLOSE_TAG,Ar.tagName="";else if(Mr==="?")Ar.state=Rr.PROC_INST,Ar.procInstName=Ar.procInstBody="";else{if(Kr(Ar,"Unencoded <"),Ar.startTagPosition+1<Ar.position){var Xr=Ar.position-Ar.startTagPosition;Mr=new Array(Xr).join(" ")+Mr}Ar.textNode+="<"+Mr,Ar.state=Rr.TEXT}continue;case Rr.SGML_DECL:(Ar.sgmlDecl+Mr).toUpperCase()===yr?(Ur(Ar,"onopencdata"),Ar.state=Rr.CDATA,Ar.sgmlDecl="",Ar.cdata=""):Ar.sgmlDecl+Mr==="--"?(Ar.state=Rr.COMMENT,Ar.comment="",Ar.sgmlDecl=""):(Ar.sgmlDecl+Mr).toUpperCase()===br?(Ar.state=Rr.DOCTYPE,(Ar.doctype||Ar.sawRoot)&&Kr(Ar,"Inappropriately located doctype declaration"),Ar.doctype="",Ar.sgmlDecl=""):Mr===">"?(Ur(Ar,"onsgmldeclaration",Ar.sgmlDecl),Ar.sgmlDecl="",Ar.state=Rr.TEXT):(Nr(Mr)&&(Ar.state=Rr.SGML_DECL_QUOTED),Ar.sgmlDecl+=Mr);continue;case Rr.SGML_DECL_QUOTED:Mr===Ar.q&&(Ar.state=Rr.SGML_DECL,Ar.q=""),Ar.sgmlDecl+=Mr;continue;case Rr.DOCTYPE:Mr===">"?(Ar.state=Rr.TEXT,Ur(Ar,"ondoctype",Ar.doctype),Ar.doctype=!0):(Ar.doctype+=Mr,Mr==="["?Ar.state=Rr.DOCTYPE_DTD:Nr(Mr)&&(Ar.state=Rr.DOCTYPE_QUOTED,Ar.q=Mr));continue;case Rr.DOCTYPE_QUOTED:Ar.doctype+=Mr,Mr===Ar.q&&(Ar.q="",Ar.state=Rr.DOCTYPE);continue;case Rr.DOCTYPE_DTD:Ar.doctype+=Mr,Mr==="]"?Ar.state=Rr.DOCTYPE:Nr(Mr)&&(Ar.state=Rr.DOCTYPE_DTD_QUOTED,Ar.q=Mr);continue;case Rr.DOCTYPE_DTD_QUOTED:Ar.doctype+=Mr,Mr===Ar.q&&(Ar.state=Rr.DOCTYPE_DTD,Ar.q="");continue;case Rr.COMMENT:Mr==="-"?Ar.state=Rr.COMMENT_ENDING:Ar.comment+=Mr;continue;case Rr.COMMENT_ENDING:Mr==="-"?(Ar.state=Rr.COMMENT_ENDED,Ar.comment=Dr(Ar.opt,Ar.comment),Ar.comment&&Ur(Ar,"oncomment",Ar.comment),Ar.comment=""):(Ar.comment+="-"+Mr,Ar.state=Rr.COMMENT);continue;case Rr.COMMENT_ENDED:Mr!==">"?(Kr(Ar,"Malformed comment"),Ar.comment+="--"+Mr,Ar.state=Rr.COMMENT):Ar.state=Rr.TEXT;continue;case Rr.CDATA:Mr==="]"?Ar.state=Rr.CDATA_ENDING:Ar.cdata+=Mr;continue;case Rr.CDATA_ENDING:Mr==="]"?Ar.state=Rr.CDATA_ENDING_2:(Ar.cdata+="]"+Mr,Ar.state=Rr.CDATA);continue;case Rr.CDATA_ENDING_2:Mr===">"?(Ar.cdata&&Ur(Ar,"oncdata",Ar.cdata),Ur(Ar,"onclosecdata"),Ar.cdata="",Ar.state=Rr.TEXT):Mr==="]"?Ar.cdata+="]":(Ar.cdata+="]]"+Mr,Ar.state=Rr.CDATA);continue;case Rr.PROC_INST:Mr==="?"?Ar.state=Rr.PROC_INST_ENDING:$r(Mr)?Ar.state=Rr.PROC_INST_BODY:Ar.procInstName+=Mr;continue;case Rr.PROC_INST_BODY:if(!Ar.procInstBody&&$r(Mr))continue;Mr==="?"?Ar.state=Rr.PROC_INST_ENDING:Ar.procInstBody+=Mr;continue;case Rr.PROC_INST_ENDING:Mr===">"?(Ur(Ar,"onprocessinginstruction",{name:Ar.procInstName,body:Ar.procInstBody}),Ar.procInstName=Ar.procInstBody="",Ar.state=Rr.TEXT):(Ar.procInstBody+="?"+Mr,Ar.state=Rr.PROC_INST_BODY);continue;case Rr.OPEN_TAG:Fr(wr,Mr)?Ar.tagName+=Mr:(ui(Ar),Mr===">"?ei(Ar):Mr==="/"?Ar.state=Rr.OPEN_TAG_SLASH:($r(Mr)||Kr(Ar,"Invalid character in tag name"),Ar.state=Rr.ATTRIB));continue;case Rr.OPEN_TAG_SLASH:Mr===">"?(ei(Ar,!0),Wr(Ar)):(Kr(Ar,"Forward-slash in opening tag not followed by >"),Ar.state=Rr.ATTRIB);continue;case Rr.ATTRIB:if($r(Mr))continue;Mr===">"?ei(Ar):Mr==="/"?Ar.state=Rr.OPEN_TAG_SLASH:Fr(xr,Mr)?(Ar.attribName=Mr,Ar.attribValue="",Ar.state=Rr.ATTRIB_NAME):Kr(Ar,"Invalid attribute name");continue;case Rr.ATTRIB_NAME:Mr==="="?Ar.state=Rr.ATTRIB_VALUE:Mr===">"?(Kr(Ar,"Attribute without value"),Ar.attribValue=Ar.attribName,di(Ar),ei(Ar)):$r(Mr)?Ar.state=Rr.ATTRIB_NAME_SAW_WHITE:Fr(wr,Mr)?Ar.attribName+=Mr:Kr(Ar,"Invalid attribute name");continue;case Rr.ATTRIB_NAME_SAW_WHITE:if(Mr==="=")Ar.state=Rr.ATTRIB_VALUE;else{if($r(Mr))continue;Kr(Ar,"Attribute without value"),Ar.tag.attributes[Ar.attribName]="",Ar.attribValue="",Ur(Ar,"onattribute",{name:Ar.attribName,value:""}),Ar.attribName="",Mr===">"?ei(Ar):Fr(xr,Mr)?(Ar.attribName=Mr,Ar.state=Rr.ATTRIB_NAME):(Kr(Ar,"Invalid attribute name"),Ar.state=Rr.ATTRIB)}continue;case Rr.ATTRIB_VALUE:if($r(Mr))continue;Nr(Mr)?(Ar.q=Mr,Ar.state=Rr.ATTRIB_VALUE_QUOTED):(Kr(Ar,"Unquoted attribute value"),Ar.state=Rr.ATTRIB_VALUE_UNQUOTED,Ar.attribValue=Mr);continue;case Rr.ATTRIB_VALUE_QUOTED:if(Mr!==Ar.q){Mr==="&"?Ar.state=Rr.ATTRIB_VALUE_ENTITY_Q:Ar.attribValue+=Mr;continue}di(Ar),Ar.q="",Ar.state=Rr.ATTRIB_VALUE_CLOSED;continue;case Rr.ATTRIB_VALUE_CLOSED:$r(Mr)?Ar.state=Rr.ATTRIB:Mr===">"?ei(Ar):Mr==="/"?Ar.state=Rr.OPEN_TAG_SLASH:Fr(xr,Mr)?(Kr(Ar,"No whitespace between attributes"),Ar.attribName=Mr,Ar.attribValue="",Ar.state=Rr.ATTRIB_NAME):Kr(Ar,"Invalid attribute name");continue;case Rr.ATTRIB_VALUE_UNQUOTED:if(!Br(Mr)){Mr==="&"?Ar.state=Rr.ATTRIB_VALUE_ENTITY_U:Ar.attribValue+=Mr;continue}di(Ar),Mr===">"?ei(Ar):Ar.state=Rr.ATTRIB;continue;case Rr.CLOSE_TAG:if(Ar.tagName)Mr===">"?Wr(Ar):Fr(wr,Mr)?Ar.tagName+=Mr:Ar.script?(Ar.script+="</"+Ar.tagName,Ar.tagName="",Ar.state=Rr.SCRIPT):($r(Mr)||Kr(Ar,"Invalid tagname in closing tag"),Ar.state=Rr.CLOSE_TAG_SAW_WHITE);else{if($r(Mr))continue;Vr(xr,Mr)?Ar.script?(Ar.script+="</"+Mr,Ar.state=Rr.SCRIPT):Kr(Ar,"Invalid tagname in closing tag."):Ar.tagName=Mr}continue;case Rr.CLOSE_TAG_SAW_WHITE:if($r(Mr))continue;Mr===">"?Wr(Ar):Kr(Ar,"Invalid characters in closing tag");continue;case Rr.TEXT_ENTITY:case Rr.ATTRIB_VALUE_ENTITY_Q:case Rr.ATTRIB_VALUE_ENTITY_U:var ri,Lr;switch(Ar.state){case Rr.TEXT_ENTITY:ri=Rr.TEXT,Lr="textNode";break;case Rr.ATTRIB_VALUE_ENTITY_Q:ri=Rr.ATTRIB_VALUE_QUOTED,Lr="attribValue";break;case Rr.ATTRIB_VALUE_ENTITY_U:ri=Rr.ATTRIB_VALUE_UNQUOTED,Lr="attribValue";break}Mr===";"?(Ar[Lr]+=ti(Ar),Ar.entity="",Ar.state=ri):Fr(Ar.entity.length?Cr:kr,Mr)?Ar.entity+=Mr:(Kr(Ar,"Invalid character in entity name"),Ar[Lr]+="&"+Ar.entity+Mr,Ar.entity="",Ar.state=ri);continue;default:throw new Error(Ar,"Unknown state: "+Ar.state)}return Ar.position>=Ar.bufferCheckPosition&&ur(Ar),Ar}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var Pr=String.fromCharCode,Ar=Math.floor,Zr=function(){var Mr=16384,jr=[],Xr,ri,Lr=-1,oi=arguments.length;if(!oi)return"";for(var Tr="";++Lr<oi;){var Sr=Number(arguments[Lr]);if(!isFinite(Sr)||Sr<0||Sr>1114111||Ar(Sr)!==Sr)throw RangeError("Invalid code point: "+Sr);Sr<=65535?jr.push(Sr):(Sr-=65536,Xr=(Sr>>10)+55296,ri=Sr%1024+56320,jr.push(Xr,ri)),(Lr+1===oi||jr.length>Mr)&&(Tr+=Pr.apply(null,jr),jr.length=0)}return Tr};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:Zr,configurable:!0,writable:!0}):String.fromCodePoint=Zr}()})(lr)})(Gt$1);var Ct$1={isArray:function(lr){return Array.isArray?Array.isArray(lr):Object.prototype.toString.call(lr)==="[object Array]"}},se$1=Ct$1.isArray,bt$1={copyOptions:function(lr){var or,ar={};for(or in lr)lr.hasOwnProperty(or)&&(ar[or]=lr[or]);return ar},ensureFlagExists:function(lr,or){(!(lr in or)||typeof or[lr]!="boolean")&&(or[lr]=!1)},ensureSpacesExists:function(lr){(!("spaces"in lr)||typeof lr.spaces!="number"&&typeof lr.spaces!="string")&&(lr.spaces=0)},ensureAlwaysArrayExists:function(lr){(!("alwaysArray"in lr)||typeof lr.alwaysArray!="boolean"&&!se$1(lr.alwaysArray))&&(lr.alwaysArray=!1)},ensureKeyExists:function(lr,or){(!(lr+"Key"in or)||typeof or[lr+"Key"]!="string")&&(or[lr+"Key"]=or.compact?"_"+lr:lr)},checkFnExists:function(lr,or){return lr+"Fn"in or}},ce$1=Gt$1,K$1=bt$1,at$1=Ct$1.isArray,y$1,v$1;function fe$1(lr){return y$1=K$1.copyOptions(lr),K$1.ensureFlagExists("ignoreDeclaration",y$1),K$1.ensureFlagExists("ignoreInstruction",y$1),K$1.ensureFlagExists("ignoreAttributes",y$1),K$1.ensureFlagExists("ignoreText",y$1),K$1.ensureFlagExists("ignoreComment",y$1),K$1.ensureFlagExists("ignoreCdata",y$1),K$1.ensureFlagExists("ignoreDoctype",y$1),K$1.ensureFlagExists("compact",y$1),K$1.ensureFlagExists("alwaysChildren",y$1),K$1.ensureFlagExists("addParent",y$1),K$1.ensureFlagExists("trim",y$1),K$1.ensureFlagExists("nativeType",y$1),K$1.ensureFlagExists("nativeTypeAttributes",y$1),K$1.ensureFlagExists("sanitize",y$1),K$1.ensureFlagExists("instructionHasAttributes",y$1),K$1.ensureFlagExists("captureSpacesBetweenElements",y$1),K$1.ensureAlwaysArrayExists(y$1),K$1.ensureKeyExists("declaration",y$1),K$1.ensureKeyExists("instruction",y$1),K$1.ensureKeyExists("attributes",y$1),K$1.ensureKeyExists("text",y$1),K$1.ensureKeyExists("comment",y$1),K$1.ensureKeyExists("cdata",y$1),K$1.ensureKeyExists("doctype",y$1),K$1.ensureKeyExists("type",y$1),K$1.ensureKeyExists("name",y$1),K$1.ensureKeyExists("elements",y$1),K$1.ensureKeyExists("parent",y$1),y$1}function Vt$1(lr){var or=Number(lr);if(!isNaN(or))return or;var ar=lr.toLowerCase();return ar==="true"?!0:ar==="false"?!1:lr}function ht$1(lr,or){var ar;if(y$1.compact){if(!v$1[y$1[lr+"Key"]]&&(at$1(y$1.alwaysArray)?y$1.alwaysArray.indexOf(y$1[lr+"Key"])!==-1:y$1.alwaysArray)&&(v$1[y$1[lr+"Key"]]=[]),v$1[y$1[lr+"Key"]]&&!at$1(v$1[y$1[lr+"Key"]])&&(v$1[y$1[lr+"Key"]]=[v$1[y$1[lr+"Key"]]]),lr+"Fn"in y$1&&typeof or=="string"&&(or=y$1[lr+"Fn"](or,v$1)),lr==="instruction"&&("instructionFn"in y$1||"instructionNameFn"in y$1)){for(ar in or)if(or.hasOwnProperty(ar))if("instructionFn"in y$1)or[ar]=y$1.instructionFn(or[ar],ar,v$1);else{var cr=or[ar];delete or[ar],or[y$1.instructionNameFn(ar,cr,v$1)]=cr}}at$1(v$1[y$1[lr+"Key"]])?v$1[y$1[lr+"Key"]].push(or):v$1[y$1[lr+"Key"]]=or}else{v$1[y$1.elementsKey]||(v$1[y$1.elementsKey]=[]);var ur={};if(ur[y$1.typeKey]=lr,lr==="instruction"){for(ar in or)if(or.hasOwnProperty(ar))break;ur[y$1.nameKey]="instructionNameFn"in y$1?y$1.instructionNameFn(ar,or,v$1):ar,y$1.instructionHasAttributes?(ur[y$1.attributesKey]=or[ar][y$1.attributesKey],"instructionFn"in y$1&&(ur[y$1.attributesKey]=y$1.instructionFn(ur[y$1.attributesKey],ar,v$1))):("instructionFn"in y$1&&(or[ar]=y$1.instructionFn(or[ar],ar,v$1)),ur[y$1.instructionKey]=or[ar])}else lr+"Fn"in y$1&&(or=y$1[lr+"Fn"](or,v$1)),ur[y$1[lr+"Key"]]=or;y$1.addParent&&(ur[y$1.parentKey]=v$1),v$1[y$1.elementsKey].push(ur)}}function jt$1(lr){if("attributesFn"in y$1&&lr&&(lr=y$1.attributesFn(lr,v$1)),(y$1.trim||"attributeValueFn"in y$1||"attributeNameFn"in y$1||y$1.nativeTypeAttributes)&&lr){var or;for(or in lr)if(lr.hasOwnProperty(or)&&(y$1.trim&&(lr[or]=lr[or].trim()),y$1.nativeTypeAttributes&&(lr[or]=Vt$1(lr[or])),"attributeValueFn"in y$1&&(lr[or]=y$1.attributeValueFn(lr[or],or,v$1)),"attributeNameFn"in y$1)){var ar=lr[or];delete lr[or],lr[y$1.attributeNameFn(or,lr[or],v$1)]=ar}}return lr}function le$1(lr){var or={};if(lr.body&&(lr.name.toLowerCase()==="xml"||y$1.instructionHasAttributes)){for(var ar=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,cr;(cr=ar.exec(lr.body))!==null;)or[cr[1]]=cr[2]||cr[3]||cr[4];or=jt$1(or)}if(lr.name.toLowerCase()==="xml"){if(y$1.ignoreDeclaration)return;v$1[y$1.declarationKey]={},Object.keys(or).length&&(v$1[y$1.declarationKey][y$1.attributesKey]=or),y$1.addParent&&(v$1[y$1.declarationKey][y$1.parentKey]=v$1)}else{if(y$1.ignoreInstruction)return;y$1.trim&&(lr.body=lr.body.trim());var ur={};y$1.instructionHasAttributes&&Object.keys(or).length?(ur[lr.name]={},ur[lr.name][y$1.attributesKey]=or):ur[lr.name]=lr.body,ht$1("instruction",ur)}}function he$1(lr,or){var ar;if(typeof lr=="object"&&(or=lr.attributes,lr=lr.name),or=jt$1(or),"elementNameFn"in y$1&&(lr=y$1.elementNameFn(lr,v$1)),y$1.compact){if(ar={},!y$1.ignoreAttributes&&or&&Object.keys(or).length){ar[y$1.attributesKey]={};var cr;for(cr in or)or.hasOwnProperty(cr)&&(ar[y$1.attributesKey][cr]=or[cr])}!(lr in v$1)&&(at$1(y$1.alwaysArray)?y$1.alwaysArray.indexOf(lr)!==-1:y$1.alwaysArray)&&(v$1[lr]=[]),v$1[lr]&&!at$1(v$1[lr])&&(v$1[lr]=[v$1[lr]]),at$1(v$1[lr])?v$1[lr].push(ar):v$1[lr]=ar}else v$1[y$1.elementsKey]||(v$1[y$1.elementsKey]=[]),ar={},ar[y$1.typeKey]="element",ar[y$1.nameKey]=lr,!y$1.ignoreAttributes&&or&&Object.keys(or).length&&(ar[y$1.attributesKey]=or),y$1.alwaysChildren&&(ar[y$1.elementsKey]=[]),v$1[y$1.elementsKey].push(ar);ar[y$1.parentKey]=v$1,v$1=ar}function ye$1(lr){y$1.ignoreText||!lr.trim()&&!y$1.captureSpacesBetweenElements||(y$1.trim&&(lr=lr.trim()),y$1.nativeType&&(lr=Vt$1(lr)),y$1.sanitize&&(lr=lr.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),ht$1("text",lr))}function Ee$1(lr){y$1.ignoreComment||(y$1.trim&&(lr=lr.trim()),ht$1("comment",lr))}function me$1(lr){var or=v$1[y$1.parentKey];y$1.addParent||delete v$1[y$1.parentKey],v$1=or}function pe$1(lr){y$1.ignoreCdata||(y$1.trim&&(lr=lr.trim()),ht$1("cdata",lr))}function ge$1(lr){y$1.ignoreDoctype||(lr=lr.replace(/^ /,""),y$1.trim&&(lr=lr.trim()),ht$1("doctype",lr))}function Te$1(lr){lr.note=lr}var Yt$1=function(lr,or){var ar=ce$1.parser(!0,{}),cr={};if(v$1=cr,y$1=fe$1(or),ar.opt={strictEntities:!0},ar.onopentag=he$1,ar.ontext=ye$1,ar.oncomment=Ee$1,ar.onclosetag=me$1,ar.onerror=Te$1,ar.oncdata=pe$1,ar.ondoctype=ge$1,ar.onprocessinginstruction=le$1,ar.write(lr).close(),cr[y$1.elementsKey]){var ur=cr[y$1.elementsKey];delete cr[y$1.elementsKey],cr[y$1.elementsKey]=ur,delete cr.text}return cr},kt$1=bt$1,de$1=Yt$1;function xe$1(lr){var or=kt$1.copyOptions(lr);return kt$1.ensureSpacesExists(or),or}var we$1=function(lr,or){var ar,cr,ur,hr;return ar=xe$1(or),cr=de$1(lr,ar),hr="compact"in ar&&ar.compact?"_parent":"parent","addParent"in ar&&ar.addParent?ur=JSON.stringify(cr,function(fr,dr){return fr===hr?"_":dr},ar.spaces):ur=JSON.stringify(cr,null,ar.spaces),ur.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},k$1=bt$1,Ae$1=Ct$1.isArray,z$1,J$1;function Fe$1(lr){var or=k$1.copyOptions(lr);return k$1.ensureFlagExists("ignoreDeclaration",or),k$1.ensureFlagExists("ignoreInstruction",or),k$1.ensureFlagExists("ignoreAttributes",or),k$1.ensureFlagExists("ignoreText",or),k$1.ensureFlagExists("ignoreComment",or),k$1.ensureFlagExists("ignoreCdata",or),k$1.ensureFlagExists("ignoreDoctype",or),k$1.ensureFlagExists("compact",or),k$1.ensureFlagExists("indentText",or),k$1.ensureFlagExists("indentCdata",or),k$1.ensureFlagExists("indentAttributes",or),k$1.ensureFlagExists("indentInstruction",or),k$1.ensureFlagExists("fullTagEmptyElement",or),k$1.ensureFlagExists("noQuotesForNativeAttributes",or),k$1.ensureSpacesExists(or),typeof or.spaces=="number"&&(or.spaces=Array(or.spaces+1).join(" ")),k$1.ensureKeyExists("declaration",or),k$1.ensureKeyExists("instruction",or),k$1.ensureKeyExists("attributes",or),k$1.ensureKeyExists("text",or),k$1.ensureKeyExists("comment",or),k$1.ensureKeyExists("cdata",or),k$1.ensureKeyExists("doctype",or),k$1.ensureKeyExists("type",or),k$1.ensureKeyExists("name",or),k$1.ensureKeyExists("elements",or),or}function et$1(lr,or,ar){return(!ar&&lr.spaces?`
`:"")+Array(or+1).join(lr.spaces)}function xt$1(lr,or,ar){if(or.ignoreAttributes)return"";"attributesFn"in or&&(lr=or.attributesFn(lr,J$1,z$1));var cr,ur,hr,fr,dr=[];for(cr in lr)lr.hasOwnProperty(cr)&&lr[cr]!==null&&lr[cr]!==void 0&&(fr=or.noQuotesForNativeAttributes&&typeof lr[cr]!="string"?"":'"',ur=""+lr[cr],ur=ur.replace(/"/g,"&quot;"),hr="attributeNameFn"in or?or.attributeNameFn(cr,ur,J$1,z$1):cr,dr.push(or.spaces&&or.indentAttributes?et$1(or,ar+1,!1):" "),dr.push(hr+"="+fr+("attributeValueFn"in or?or.attributeValueFn(ur,cr,J$1,z$1):ur)+fr));return lr&&Object.keys(lr).length&&or.spaces&&or.indentAttributes&&dr.push(et$1(or,ar,!1)),dr.join("")}function qt$1(lr,or,ar){return z$1=lr,J$1="xml",or.ignoreDeclaration?"":"<?xml"+xt$1(lr[or.attributesKey],or,ar)+"?>"}function Xt$1(lr,or,ar){if(or.ignoreInstruction)return"";var cr;for(cr in lr)if(lr.hasOwnProperty(cr))break;var ur="instructionNameFn"in or?or.instructionNameFn(cr,lr[cr],J$1,z$1):cr;if(typeof lr[cr]=="object")return z$1=lr,J$1=ur,"<?"+ur+xt$1(lr[cr][or.attributesKey],or,ar)+"?>";var hr=lr[cr]?lr[cr]:"";return"instructionFn"in or&&(hr=or.instructionFn(hr,cr,J$1,z$1)),"<?"+ur+(hr?" "+hr:"")+"?>"}function Wt$1(lr,or){return or.ignoreComment?"":"<!--"+("commentFn"in or?or.commentFn(lr,J$1,z$1):lr)+"-->"}function Ht$1(lr,or){return or.ignoreCdata?"":"<![CDATA["+("cdataFn"in or?or.cdataFn(lr,J$1,z$1):lr.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function Qt$1(lr,or){return or.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in or?or.doctypeFn(lr,J$1,z$1):lr)+">"}function Bt$1(lr,or){return or.ignoreText?"":(lr=""+lr,lr=lr.replace(/&amp;/g,"&"),lr=lr.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in or?or.textFn(lr,J$1,z$1):lr)}function Ne$1(lr,or){var ar;if(lr.elements&&lr.elements.length)for(ar=0;ar<lr.elements.length;++ar)switch(lr.elements[ar][or.typeKey]){case"text":if(or.indentText)return!0;break;case"cdata":if(or.indentCdata)return!0;break;case"instruction":if(or.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function ve$1(lr,or,ar){z$1=lr,J$1=lr.name;var cr=[],ur="elementNameFn"in or?or.elementNameFn(lr.name,lr):lr.name;cr.push("<"+ur),lr[or.attributesKey]&&cr.push(xt$1(lr[or.attributesKey],or,ar));var hr=lr[or.elementsKey]&&lr[or.elementsKey].length||lr[or.attributesKey]&&lr[or.attributesKey]["xml:space"]==="preserve";return hr||("fullTagEmptyElementFn"in or?hr=or.fullTagEmptyElementFn(lr.name,lr):hr=or.fullTagEmptyElement),hr?(cr.push(">"),lr[or.elementsKey]&&lr[or.elementsKey].length&&(cr.push($t$1(lr[or.elementsKey],or,ar+1)),z$1=lr,J$1=lr.name),cr.push(or.spaces&&Ne$1(lr,or)?`
`+Array(ar+1).join(or.spaces):""),cr.push("</"+ur+">")):cr.push("/>"),cr.join("")}function $t$1(lr,or,ar,cr){return lr.reduce(function(ur,hr){var fr=et$1(or,ar,cr&&!ur);switch(hr.type){case"element":return ur+fr+ve$1(hr,or,ar);case"comment":return ur+fr+Wt$1(hr[or.commentKey],or);case"doctype":return ur+fr+Qt$1(hr[or.doctypeKey],or);case"cdata":return ur+(or.indentCdata?fr:"")+Ht$1(hr[or.cdataKey],or);case"text":return ur+(or.indentText?fr:"")+Bt$1(hr[or.textKey],or);case"instruction":var dr={};return dr[hr[or.nameKey]]=hr[or.attributesKey]?hr:hr[or.instructionKey],ur+(or.indentInstruction?fr:"")+Xt$1(dr,or,ar)}},"")}function zt$1(lr,or,ar){var cr;for(cr in lr)if(lr.hasOwnProperty(cr))switch(cr){case or.parentKey:case or.attributesKey:break;case or.textKey:if(or.indentText||ar)return!0;break;case or.cdataKey:if(or.indentCdata||ar)return!0;break;case or.instructionKey:if(or.indentInstruction||ar)return!0;break;case or.doctypeKey:case or.commentKey:return!0;default:return!0}return!1}function Ie$1(lr,or,ar,cr,ur){z$1=lr,J$1=or;var hr="elementNameFn"in ar?ar.elementNameFn(or,lr):or;if(typeof lr>"u"||lr===null||lr==="")return"fullTagEmptyElementFn"in ar&&ar.fullTagEmptyElementFn(or,lr)||ar.fullTagEmptyElement?"<"+hr+"></"+hr+">":"<"+hr+"/>";var fr=[];if(or){if(fr.push("<"+hr),typeof lr!="object")return fr.push(">"+Bt$1(lr,ar)+"</"+hr+">"),fr.join("");lr[ar.attributesKey]&&fr.push(xt$1(lr[ar.attributesKey],ar,cr));var dr=zt$1(lr,ar,!0)||lr[ar.attributesKey]&&lr[ar.attributesKey]["xml:space"]==="preserve";if(dr||("fullTagEmptyElementFn"in ar?dr=ar.fullTagEmptyElementFn(or,lr):dr=ar.fullTagEmptyElement),dr)fr.push(">");else return fr.push("/>"),fr.join("")}return fr.push(Jt$1(lr,ar,cr+1,!1)),z$1=lr,J$1=or,or&&fr.push((ur?et$1(ar,cr,!1):"")+"</"+hr+">"),fr.join("")}function Jt$1(lr,or,ar,cr){var ur,hr,fr,dr=[];for(hr in lr)if(lr.hasOwnProperty(hr))for(fr=Ae$1(lr[hr])?lr[hr]:[lr[hr]],ur=0;ur<fr.length;++ur){switch(hr){case or.declarationKey:dr.push(qt$1(fr[ur],or,ar));break;case or.instructionKey:dr.push((or.indentInstruction?et$1(or,ar,cr):"")+Xt$1(fr[ur],or,ar));break;case or.attributesKey:case or.parentKey:break;case or.textKey:dr.push((or.indentText?et$1(or,ar,cr):"")+Bt$1(fr[ur],or));break;case or.cdataKey:dr.push((or.indentCdata?et$1(or,ar,cr):"")+Ht$1(fr[ur],or));break;case or.doctypeKey:dr.push(et$1(or,ar,cr)+Qt$1(fr[ur],or));break;case or.commentKey:dr.push(et$1(or,ar,cr)+Wt$1(fr[ur],or));break;default:dr.push(et$1(or,ar,cr)+Ie$1(fr[ur],hr,or,ar,zt$1(fr[ur],or)))}cr=cr&&!dr.length}return dr.join("")}var Zt$1=function(lr,or){or=Fe$1(or);var ar=[];return z$1=lr,J$1="_root_",or.compact?ar.push(Jt$1(lr,or,0,!0)):(lr[or.declarationKey]&&ar.push(qt$1(lr[or.declarationKey],or,0)),lr[or.elementsKey]&&lr[or.elementsKey].length&&ar.push($t$1(lr[or.elementsKey],or,0,!ar.length))),ar.join("")},_e$1=Zt$1,Ce$1=function(lr,or){lr instanceof Buffer&&(lr=lr.toString());var ar=null;if(typeof lr=="string")try{ar=JSON.parse(lr)}catch{throw new Error("The JSON structure is invalid")}else ar=lr;return _e$1(ar,or)},be$1=Yt$1,Be$1=we$1,De$1=Zt$1,Se$1=Ce$1,te$1={xml2js:be$1,xml2json:Be$1,js2xml:De$1,json2xml:Se$1};const Ue$1=te$1.js2xml,Oe$1=te$1.xml2js;function _getDefaults(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let _defaults=_getDefaults();function changeDefaults(lr){_defaults=lr}const escapeTest=/[&<>"']/,escapeReplace=new RegExp(escapeTest.source,"g"),escapeTestNoEncode=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode=new RegExp(escapeTestNoEncode.source,"g"),escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=lr=>escapeReplacements[lr];function escape(lr,or){if(or){if(escapeTest.test(lr))return lr.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(lr))return lr.replace(escapeReplaceNoEncode,getEscapeReplacement);return lr}const unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function unescape(lr){return lr.replace(unescapeTest,(or,ar)=>(ar=ar.toLowerCase(),ar==="colon"?":":ar.charAt(0)==="#"?ar.charAt(1)==="x"?String.fromCharCode(parseInt(ar.substring(2),16)):String.fromCharCode(+ar.substring(1)):""))}const caret=/(^|[^\[])\^/g;function edit(lr,or){lr=typeof lr=="string"?lr:lr.source,or=or||"";const ar={replace:(cr,ur)=>(ur=typeof ur=="object"&&"source"in ur?ur.source:ur,ur=ur.replace(caret,"$1"),lr=lr.replace(cr,ur),ar),getRegex:()=>new RegExp(lr,or)};return ar}function cleanUrl(lr){try{lr=encodeURI(lr).replace(/%25/g,"%")}catch{return null}return lr}const noopTest={exec:()=>null};function splitCells(lr,or){const ar=lr.replace(/\|/g,(hr,fr,dr)=>{let pr=!1,mr=fr;for(;--mr>=0&&dr[mr]==="\\";)pr=!pr;return pr?"|":" |"}),cr=ar.split(/ \|/);let ur=0;if(cr[0].trim()||cr.shift(),cr.length>0&&!cr[cr.length-1].trim()&&cr.pop(),or)if(cr.length>or)cr.splice(or);else for(;cr.length<or;)cr.push("");for(;ur<cr.length;ur++)cr[ur]=cr[ur].trim().replace(/\\\|/g,"|");return cr}function rtrim(lr,or,ar){const cr=lr.length;if(cr===0)return"";let ur=0;for(;ur<cr;){const hr=lr.charAt(cr-ur-1);if(hr===or&&!ar)ur++;else if(hr!==or&&ar)ur++;else break}return lr.slice(0,cr-ur)}function findClosingBracket(lr,or){if(lr.indexOf(or[1])===-1)return-1;let ar=0;for(let cr=0;cr<lr.length;cr++)if(lr[cr]==="\\")cr++;else if(lr[cr]===or[0])ar++;else if(lr[cr]===or[1]&&(ar--,ar<0))return cr;return-1}function outputLink(lr,or,ar,cr){const ur=or.href,hr=or.title?escape(or.title):null,fr=lr[1].replace(/\\([\[\]])/g,"$1");if(lr[0].charAt(0)!=="!"){cr.state.inLink=!0;const dr={type:"link",raw:ar,href:ur,title:hr,text:fr,tokens:cr.inlineTokens(fr)};return cr.state.inLink=!1,dr}return{type:"image",raw:ar,href:ur,title:hr,text:escape(fr)}}function indentCodeCompensation(lr,or){const ar=lr.match(/^(\s+)(?:```)/);if(ar===null)return or;const cr=ar[1];return or.split(`
`).map(ur=>{const hr=ur.match(/^\s+/);if(hr===null)return ur;const[fr]=hr;return fr.length>=cr.length?ur.slice(cr.length):ur}).join(`
`)}class _Tokenizer{constructor(or){bi(this,"options");bi(this,"rules");bi(this,"lexer");this.options=or||_defaults}space(or){const ar=this.rules.block.newline.exec(or);if(ar&&ar[0].length>0)return{type:"space",raw:ar[0]}}code(or){const ar=this.rules.block.code.exec(or);if(ar){const cr=ar[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:ar[0],codeBlockStyle:"indented",text:this.options.pedantic?cr:rtrim(cr,`
`)}}}fences(or){const ar=this.rules.block.fences.exec(or);if(ar){const cr=ar[0],ur=indentCodeCompensation(cr,ar[3]||"");return{type:"code",raw:cr,lang:ar[2]?ar[2].trim().replace(this.rules.inline._escapes,"$1"):ar[2],text:ur}}}heading(or){const ar=this.rules.block.heading.exec(or);if(ar){let cr=ar[2].trim();if(/#$/.test(cr)){const ur=rtrim(cr,"#");(this.options.pedantic||!ur||/ $/.test(ur))&&(cr=ur.trim())}return{type:"heading",raw:ar[0],depth:ar[1].length,text:cr,tokens:this.lexer.inline(cr)}}}hr(or){const ar=this.rules.block.hr.exec(or);if(ar)return{type:"hr",raw:ar[0]}}blockquote(or){const ar=this.rules.block.blockquote.exec(or);if(ar){const cr=ar[0].replace(/^ *>[ \t]?/gm,""),ur=this.lexer.state.top;this.lexer.state.top=!0;const hr=this.lexer.blockTokens(cr);return this.lexer.state.top=ur,{type:"blockquote",raw:ar[0],tokens:hr,text:cr}}}list(or){let ar=this.rules.block.list.exec(or);if(ar){let cr=ar[1].trim();const ur=cr.length>1,hr={type:"list",raw:"",ordered:ur,start:ur?+cr.slice(0,-1):"",loose:!1,items:[]};cr=ur?`\\d{1,9}\\${cr.slice(-1)}`:`\\${cr}`,this.options.pedantic&&(cr=ur?cr:"[*+-]");const fr=new RegExp(`^( {0,3}${cr})((?:[	 ][^\\n]*)?(?:\\n|$))`);let dr="",pr="",mr=!1;for(;or;){let gr=!1;if(!(ar=fr.exec(or))||this.rules.block.hr.test(or))break;dr=ar[0],or=or.substring(dr.length);let yr=ar[2].split(`
`,1)[0].replace(/^\t+/,wr=>" ".repeat(3*wr.length)),br=or.split(`
`,1)[0],Or=0;this.options.pedantic?(Or=2,pr=yr.trimStart()):(Or=ar[2].search(/[^ ]/),Or=Or>4?1:Or,pr=yr.slice(Or),Or+=ar[1].length);let _r=!1;if(!yr&&/^ *$/.test(br)&&(dr+=br+`
`,or=or.substring(br.length+1),gr=!0),!gr){const wr=new RegExp(`^ {0,${Math.min(3,Or-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),kr=new RegExp(`^ {0,${Math.min(3,Or-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Cr=new RegExp(`^ {0,${Math.min(3,Or-1)}}(?:\`\`\`|~~~)`),$r=new RegExp(`^ {0,${Math.min(3,Or-1)}}#`);for(;or;){const Nr=or.split(`
`,1)[0];if(br=Nr,this.options.pedantic&&(br=br.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Cr.test(br)||$r.test(br)||wr.test(br)||kr.test(or))break;if(br.search(/[^ ]/)>=Or||!br.trim())pr+=`
`+br.slice(Or);else{if(_r||yr.search(/[^ ]/)>=4||Cr.test(yr)||$r.test(yr)||kr.test(yr))break;pr+=`
`+br}!_r&&!br.trim()&&(_r=!0),dr+=Nr+`
`,or=or.substring(Nr.length+1),yr=br.slice(Or)}}hr.loose||(mr?hr.loose=!0:/\n *\n *$/.test(dr)&&(mr=!0));let vr=null,xr;this.options.gfm&&(vr=/^\[[ xX]\] /.exec(pr),vr&&(xr=vr[0]!=="[ ] ",pr=pr.replace(/^\[[ xX]\] +/,""))),hr.items.push({type:"list_item",raw:dr,task:!!vr,checked:xr,loose:!1,text:pr,tokens:[]}),hr.raw+=dr}hr.items[hr.items.length-1].raw=dr.trimEnd(),hr.items[hr.items.length-1].text=pr.trimEnd(),hr.raw=hr.raw.trimEnd();for(let gr=0;gr<hr.items.length;gr++)if(this.lexer.state.top=!1,hr.items[gr].tokens=this.lexer.blockTokens(hr.items[gr].text,[]),!hr.loose){const yr=hr.items[gr].tokens.filter(Or=>Or.type==="space"),br=yr.length>0&&yr.some(Or=>/\n.*\n/.test(Or.raw));hr.loose=br}if(hr.loose)for(let gr=0;gr<hr.items.length;gr++)hr.items[gr].loose=!0;return hr}}html(or){const ar=this.rules.block.html.exec(or);if(ar)return{type:"html",block:!0,raw:ar[0],pre:ar[1]==="pre"||ar[1]==="script"||ar[1]==="style",text:ar[0]}}def(or){const ar=this.rules.block.def.exec(or);if(ar){const cr=ar[1].toLowerCase().replace(/\s+/g," "),ur=ar[2]?ar[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",hr=ar[3]?ar[3].substring(1,ar[3].length-1).replace(this.rules.inline._escapes,"$1"):ar[3];return{type:"def",tag:cr,raw:ar[0],href:ur,title:hr}}}table(or){const ar=this.rules.block.table.exec(or);if(ar){const cr={type:"table",raw:ar[0],header:splitCells(ar[1]).map(ur=>({text:ur,tokens:[]})),align:ar[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:ar[3]&&ar[3].trim()?ar[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(cr.header.length===cr.align.length){let ur=cr.align.length,hr,fr,dr,pr;for(hr=0;hr<ur;hr++){const mr=cr.align[hr];mr&&(/^ *-+: *$/.test(mr)?cr.align[hr]="right":/^ *:-+: *$/.test(mr)?cr.align[hr]="center":/^ *:-+ *$/.test(mr)?cr.align[hr]="left":cr.align[hr]=null)}for(ur=cr.rows.length,hr=0;hr<ur;hr++)cr.rows[hr]=splitCells(cr.rows[hr],cr.header.length).map(mr=>({text:mr,tokens:[]}));for(ur=cr.header.length,fr=0;fr<ur;fr++)cr.header[fr].tokens=this.lexer.inline(cr.header[fr].text);for(ur=cr.rows.length,fr=0;fr<ur;fr++)for(pr=cr.rows[fr],dr=0;dr<pr.length;dr++)pr[dr].tokens=this.lexer.inline(pr[dr].text);return cr}}}lheading(or){const ar=this.rules.block.lheading.exec(or);if(ar)return{type:"heading",raw:ar[0],depth:ar[2].charAt(0)==="="?1:2,text:ar[1],tokens:this.lexer.inline(ar[1])}}paragraph(or){const ar=this.rules.block.paragraph.exec(or);if(ar){const cr=ar[1].charAt(ar[1].length-1)===`
`?ar[1].slice(0,-1):ar[1];return{type:"paragraph",raw:ar[0],text:cr,tokens:this.lexer.inline(cr)}}}text(or){const ar=this.rules.block.text.exec(or);if(ar)return{type:"text",raw:ar[0],text:ar[0],tokens:this.lexer.inline(ar[0])}}escape(or){const ar=this.rules.inline.escape.exec(or);if(ar)return{type:"escape",raw:ar[0],text:escape(ar[1])}}tag(or){const ar=this.rules.inline.tag.exec(or);if(ar)return!this.lexer.state.inLink&&/^<a /i.test(ar[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(ar[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(ar[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ar[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:ar[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:ar[0]}}link(or){const ar=this.rules.inline.link.exec(or);if(ar){const cr=ar[2].trim();if(!this.options.pedantic&&/^</.test(cr)){if(!/>$/.test(cr))return;const fr=rtrim(cr.slice(0,-1),"\\");if((cr.length-fr.length)%2===0)return}else{const fr=findClosingBracket(ar[2],"()");if(fr>-1){const pr=(ar[0].indexOf("!")===0?5:4)+ar[1].length+fr;ar[2]=ar[2].substring(0,fr),ar[0]=ar[0].substring(0,pr).trim(),ar[3]=""}}let ur=ar[2],hr="";if(this.options.pedantic){const fr=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(ur);fr&&(ur=fr[1],hr=fr[3])}else hr=ar[3]?ar[3].slice(1,-1):"";return ur=ur.trim(),/^</.test(ur)&&(this.options.pedantic&&!/>$/.test(cr)?ur=ur.slice(1):ur=ur.slice(1,-1)),outputLink(ar,{href:ur&&ur.replace(this.rules.inline._escapes,"$1"),title:hr&&hr.replace(this.rules.inline._escapes,"$1")},ar[0],this.lexer)}}reflink(or,ar){let cr;if((cr=this.rules.inline.reflink.exec(or))||(cr=this.rules.inline.nolink.exec(or))){let ur=(cr[2]||cr[1]).replace(/\s+/g," ");if(ur=ar[ur.toLowerCase()],!ur){const hr=cr[0].charAt(0);return{type:"text",raw:hr,text:hr}}return outputLink(cr,ur,cr[0],this.lexer)}}emStrong(or,ar,cr=""){let ur=this.rules.inline.emStrong.lDelim.exec(or);if(!ur||ur[3]&&cr.match(/[\p{L}\p{N}]/u))return;if(!(ur[1]||ur[2]||"")||!cr||this.rules.inline.punctuation.exec(cr)){const fr=[...ur[0]].length-1;let dr,pr,mr=fr,gr=0;const yr=ur[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(yr.lastIndex=0,ar=ar.slice(-1*or.length+fr);(ur=yr.exec(ar))!=null;){if(dr=ur[1]||ur[2]||ur[3]||ur[4]||ur[5]||ur[6],!dr)continue;if(pr=[...dr].length,ur[3]||ur[4]){mr+=pr;continue}else if((ur[5]||ur[6])&&fr%3&&!((fr+pr)%3)){gr+=pr;continue}if(mr-=pr,mr>0)continue;pr=Math.min(pr,pr+mr+gr);const br=[...or].slice(0,fr+ur.index+pr+1).join("");if(Math.min(fr,pr)%2){const _r=br.slice(1,-1);return{type:"em",raw:br,text:_r,tokens:this.lexer.inlineTokens(_r)}}const Or=br.slice(2,-2);return{type:"strong",raw:br,text:Or,tokens:this.lexer.inlineTokens(Or)}}}}codespan(or){const ar=this.rules.inline.code.exec(or);if(ar){let cr=ar[2].replace(/\n/g," ");const ur=/[^ ]/.test(cr),hr=/^ /.test(cr)&&/ $/.test(cr);return ur&&hr&&(cr=cr.substring(1,cr.length-1)),cr=escape(cr,!0),{type:"codespan",raw:ar[0],text:cr}}}br(or){const ar=this.rules.inline.br.exec(or);if(ar)return{type:"br",raw:ar[0]}}del(or){const ar=this.rules.inline.del.exec(or);if(ar)return{type:"del",raw:ar[0],text:ar[2],tokens:this.lexer.inlineTokens(ar[2])}}autolink(or){const ar=this.rules.inline.autolink.exec(or);if(ar){let cr,ur;return ar[2]==="@"?(cr=escape(ar[1]),ur="mailto:"+cr):(cr=escape(ar[1]),ur=cr),{type:"link",raw:ar[0],text:cr,href:ur,tokens:[{type:"text",raw:cr,text:cr}]}}}url(or){let ar;if(ar=this.rules.inline.url.exec(or)){let cr,ur;if(ar[2]==="@")cr=escape(ar[0]),ur="mailto:"+cr;else{let hr;do hr=ar[0],ar[0]=this.rules.inline._backpedal.exec(ar[0])[0];while(hr!==ar[0]);cr=escape(ar[0]),ar[1]==="www."?ur="http://"+ar[0]:ur=ar[0]}return{type:"link",raw:ar[0],text:cr,href:ur,tokens:[{type:"text",raw:cr,text:cr}]}}}inlineText(or){const ar=this.rules.inline.text.exec(or);if(ar){let cr;return this.lexer.state.inRawBlock?cr=ar[0]:cr=escape(ar[0]),{type:"text",raw:ar[0],text:cr}}}}const block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^((?:(?!^bull ).|\n(?!\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};block._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;block._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex();block.bullet=/(?:[*+-]|\d{1,9}[.)])/;block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex();block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex();block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();block.lheading=edit(block.lheading).replace(/bull/g,block.bullet).getRegex();block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex();block.normal={...block};block.gfm={...block.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex();block.pedantic={...block.normal,html:edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};inline._punctuation="\\p{P}$+<=>`^|~";inline.punctuation=edit(inline.punctuation,"u").replace(/punctuation/g,inline._punctuation).getRegex();inline.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;inline.anyPunctuation=/\\[punct]/g;inline._escapes=/\\([punct])/g;inline._comment=edit(block._comment).replace("(?:-->|$)","-->").getRegex();inline.emStrong.lDelim=edit(inline.emStrong.lDelim,"u").replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"gu").replace(/punct/g,inline._punctuation).getRegex();inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"gu").replace(/punct/g,inline._punctuation).getRegex();inline.anyPunctuation=edit(inline.anyPunctuation,"gu").replace(/punct/g,inline._punctuation).getRegex();inline._escapes=edit(inline._escapes,"gu").replace(/punct/g,inline._punctuation).getRegex();inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex();inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex();inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex();inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex();inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex();inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex();inline.normal={...inline};inline.pedantic={...inline.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()};inline.gfm={...inline.normal,escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex();inline.breaks={...inline.gfm,br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};class _Lexer{constructor(or){bi(this,"tokens");bi(this,"options");bi(this,"state");bi(this,"tokenizer");bi(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=or||_defaults,this.options.tokenizer=this.options.tokenizer||new _Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const ar={block:block.normal,inline:inline.normal};this.options.pedantic?(ar.block=block.pedantic,ar.inline=inline.pedantic):this.options.gfm&&(ar.block=block.gfm,this.options.breaks?ar.inline=inline.breaks:ar.inline=inline.gfm),this.tokenizer.rules=ar}static get rules(){return{block,inline}}static lex(or,ar){return new _Lexer(ar).lex(or)}static lexInline(or,ar){return new _Lexer(ar).inlineTokens(or)}lex(or){or=or.replace(/\r\n|\r/g,`
`),this.blockTokens(or,this.tokens);let ar;for(;ar=this.inlineQueue.shift();)this.inlineTokens(ar.src,ar.tokens);return this.tokens}blockTokens(or,ar=[]){this.options.pedantic?or=or.replace(/\t/g,"    ").replace(/^ +$/gm,""):or=or.replace(/^( *)(\t+)/gm,(dr,pr,mr)=>pr+"    ".repeat(mr.length));let cr,ur,hr,fr;for(;or;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(dr=>(cr=dr.call({lexer:this},or,ar))?(or=or.substring(cr.raw.length),ar.push(cr),!0):!1))){if(cr=this.tokenizer.space(or)){or=or.substring(cr.raw.length),cr.raw.length===1&&ar.length>0?ar[ar.length-1].raw+=`
`:ar.push(cr);continue}if(cr=this.tokenizer.code(or)){or=or.substring(cr.raw.length),ur=ar[ar.length-1],ur&&(ur.type==="paragraph"||ur.type==="text")?(ur.raw+=`
`+cr.raw,ur.text+=`
`+cr.text,this.inlineQueue[this.inlineQueue.length-1].src=ur.text):ar.push(cr);continue}if(cr=this.tokenizer.fences(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.heading(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.hr(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.blockquote(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.list(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.html(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.def(or)){or=or.substring(cr.raw.length),ur=ar[ar.length-1],ur&&(ur.type==="paragraph"||ur.type==="text")?(ur.raw+=`
`+cr.raw,ur.text+=`
`+cr.raw,this.inlineQueue[this.inlineQueue.length-1].src=ur.text):this.tokens.links[cr.tag]||(this.tokens.links[cr.tag]={href:cr.href,title:cr.title});continue}if(cr=this.tokenizer.table(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.lheading(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(hr=or,this.options.extensions&&this.options.extensions.startBlock){let dr=1/0;const pr=or.slice(1);let mr;this.options.extensions.startBlock.forEach(gr=>{mr=gr.call({lexer:this},pr),typeof mr=="number"&&mr>=0&&(dr=Math.min(dr,mr))}),dr<1/0&&dr>=0&&(hr=or.substring(0,dr+1))}if(this.state.top&&(cr=this.tokenizer.paragraph(hr))){ur=ar[ar.length-1],fr&&ur.type==="paragraph"?(ur.raw+=`
`+cr.raw,ur.text+=`
`+cr.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=ur.text):ar.push(cr),fr=hr.length!==or.length,or=or.substring(cr.raw.length);continue}if(cr=this.tokenizer.text(or)){or=or.substring(cr.raw.length),ur=ar[ar.length-1],ur&&ur.type==="text"?(ur.raw+=`
`+cr.raw,ur.text+=`
`+cr.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=ur.text):ar.push(cr);continue}if(or){const dr="Infinite loop on byte: "+or.charCodeAt(0);if(this.options.silent){console.error(dr);break}else throw new Error(dr)}}return this.state.top=!0,ar}inline(or,ar=[]){return this.inlineQueue.push({src:or,tokens:ar}),ar}inlineTokens(or,ar=[]){let cr,ur,hr,fr=or,dr,pr,mr;if(this.tokens.links){const gr=Object.keys(this.tokens.links);if(gr.length>0)for(;(dr=this.tokenizer.rules.inline.reflinkSearch.exec(fr))!=null;)gr.includes(dr[0].slice(dr[0].lastIndexOf("[")+1,-1))&&(fr=fr.slice(0,dr.index)+"["+"a".repeat(dr[0].length-2)+"]"+fr.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(dr=this.tokenizer.rules.inline.blockSkip.exec(fr))!=null;)fr=fr.slice(0,dr.index)+"["+"a".repeat(dr[0].length-2)+"]"+fr.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(dr=this.tokenizer.rules.inline.anyPunctuation.exec(fr))!=null;)fr=fr.slice(0,dr.index)+"++"+fr.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;or;)if(pr||(mr=""),pr=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(gr=>(cr=gr.call({lexer:this},or,ar))?(or=or.substring(cr.raw.length),ar.push(cr),!0):!1))){if(cr=this.tokenizer.escape(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.tag(or)){or=or.substring(cr.raw.length),ur=ar[ar.length-1],ur&&cr.type==="text"&&ur.type==="text"?(ur.raw+=cr.raw,ur.text+=cr.text):ar.push(cr);continue}if(cr=this.tokenizer.link(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.reflink(or,this.tokens.links)){or=or.substring(cr.raw.length),ur=ar[ar.length-1],ur&&cr.type==="text"&&ur.type==="text"?(ur.raw+=cr.raw,ur.text+=cr.text):ar.push(cr);continue}if(cr=this.tokenizer.emStrong(or,fr,mr)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.codespan(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.br(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.del(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(cr=this.tokenizer.autolink(or)){or=or.substring(cr.raw.length),ar.push(cr);continue}if(!this.state.inLink&&(cr=this.tokenizer.url(or))){or=or.substring(cr.raw.length),ar.push(cr);continue}if(hr=or,this.options.extensions&&this.options.extensions.startInline){let gr=1/0;const yr=or.slice(1);let br;this.options.extensions.startInline.forEach(Or=>{br=Or.call({lexer:this},yr),typeof br=="number"&&br>=0&&(gr=Math.min(gr,br))}),gr<1/0&&gr>=0&&(hr=or.substring(0,gr+1))}if(cr=this.tokenizer.inlineText(hr)){or=or.substring(cr.raw.length),cr.raw.slice(-1)!=="_"&&(mr=cr.raw.slice(-1)),pr=!0,ur=ar[ar.length-1],ur&&ur.type==="text"?(ur.raw+=cr.raw,ur.text+=cr.text):ar.push(cr);continue}if(or){const gr="Infinite loop on byte: "+or.charCodeAt(0);if(this.options.silent){console.error(gr);break}else throw new Error(gr)}}return ar}}class _Renderer{constructor(or){bi(this,"options");this.options=or||_defaults}code(or,ar,cr){var hr;const ur=(hr=(ar||"").match(/^\S*/))==null?void 0:hr[0];return or=or.replace(/\n$/,"")+`
`,ur?'<pre><code class="language-'+escape(ur)+'">'+(cr?or:escape(or,!0))+`</code></pre>
`:"<pre><code>"+(cr?or:escape(or,!0))+`</code></pre>
`}blockquote(or){return`<blockquote>
${or}</blockquote>
`}html(or,ar){return or}heading(or,ar,cr){return`<h${ar}>${or}</h${ar}>
`}hr(){return`<hr>
`}list(or,ar,cr){const ur=ar?"ol":"ul",hr=ar&&cr!==1?' start="'+cr+'"':"";return"<"+ur+hr+`>
`+or+"</"+ur+`>
`}listitem(or,ar,cr){return`<li>${or}</li>
`}checkbox(or){return"<input "+(or?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(or){return`<p>${or}</p>
`}table(or,ar){return ar&&(ar=`<tbody>${ar}</tbody>`),`<table>
<thead>
`+or+`</thead>
`+ar+`</table>
`}tablerow(or){return`<tr>
${or}</tr>
`}tablecell(or,ar){const cr=ar.header?"th":"td";return(ar.align?`<${cr} align="${ar.align}">`:`<${cr}>`)+or+`</${cr}>
`}strong(or){return`<strong>${or}</strong>`}em(or){return`<em>${or}</em>`}codespan(or){return`<code>${or}</code>`}br(){return"<br>"}del(or){return`<del>${or}</del>`}link(or,ar,cr){const ur=cleanUrl(or);if(ur===null)return cr;or=ur;let hr='<a href="'+or+'"';return ar&&(hr+=' title="'+ar+'"'),hr+=">"+cr+"</a>",hr}image(or,ar,cr){const ur=cleanUrl(or);if(ur===null)return cr;or=ur;let hr=`<img src="${or}" alt="${cr}"`;return ar&&(hr+=` title="${ar}"`),hr+=">",hr}text(or){return or}}class _TextRenderer{strong(or){return or}em(or){return or}codespan(or){return or}del(or){return or}html(or){return or}text(or){return or}link(or,ar,cr){return""+cr}image(or,ar,cr){return""+cr}br(){return""}}class _Parser{constructor(or){bi(this,"options");bi(this,"renderer");bi(this,"textRenderer");this.options=or||_defaults,this.options.renderer=this.options.renderer||new _Renderer,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new _TextRenderer}static parse(or,ar){return new _Parser(ar).parse(or)}static parseInline(or,ar){return new _Parser(ar).parseInline(or)}parse(or,ar=!0){let cr="";for(let ur=0;ur<or.length;ur++){const hr=or[ur];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[hr.type]){const fr=hr,dr=this.options.extensions.renderers[fr.type].call({parser:this},fr);if(dr!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(fr.type)){cr+=dr||"";continue}}switch(hr.type){case"space":continue;case"hr":{cr+=this.renderer.hr();continue}case"heading":{const fr=hr;cr+=this.renderer.heading(this.parseInline(fr.tokens),fr.depth,unescape(this.parseInline(fr.tokens,this.textRenderer)));continue}case"code":{const fr=hr;cr+=this.renderer.code(fr.text,fr.lang,!!fr.escaped);continue}case"table":{const fr=hr;let dr="",pr="";for(let gr=0;gr<fr.header.length;gr++)pr+=this.renderer.tablecell(this.parseInline(fr.header[gr].tokens),{header:!0,align:fr.align[gr]});dr+=this.renderer.tablerow(pr);let mr="";for(let gr=0;gr<fr.rows.length;gr++){const yr=fr.rows[gr];pr="";for(let br=0;br<yr.length;br++)pr+=this.renderer.tablecell(this.parseInline(yr[br].tokens),{header:!1,align:fr.align[br]});mr+=this.renderer.tablerow(pr)}cr+=this.renderer.table(dr,mr);continue}case"blockquote":{const fr=hr,dr=this.parse(fr.tokens);cr+=this.renderer.blockquote(dr);continue}case"list":{const fr=hr,dr=fr.ordered,pr=fr.start,mr=fr.loose;let gr="";for(let yr=0;yr<fr.items.length;yr++){const br=fr.items[yr],Or=br.checked,_r=br.task;let vr="";if(br.task){const xr=this.renderer.checkbox(!!Or);mr?br.tokens.length>0&&br.tokens[0].type==="paragraph"?(br.tokens[0].text=xr+" "+br.tokens[0].text,br.tokens[0].tokens&&br.tokens[0].tokens.length>0&&br.tokens[0].tokens[0].type==="text"&&(br.tokens[0].tokens[0].text=xr+" "+br.tokens[0].tokens[0].text)):br.tokens.unshift({type:"text",text:xr+" "}):vr+=xr+" "}vr+=this.parse(br.tokens,mr),gr+=this.renderer.listitem(vr,_r,!!Or)}cr+=this.renderer.list(gr,dr,pr);continue}case"html":{const fr=hr;cr+=this.renderer.html(fr.text,fr.block);continue}case"paragraph":{const fr=hr;cr+=this.renderer.paragraph(this.parseInline(fr.tokens));continue}case"text":{let fr=hr,dr=fr.tokens?this.parseInline(fr.tokens):fr.text;for(;ur+1<or.length&&or[ur+1].type==="text";)fr=or[++ur],dr+=`
`+(fr.tokens?this.parseInline(fr.tokens):fr.text);cr+=ar?this.renderer.paragraph(dr):dr;continue}default:{const fr='Token with "'+hr.type+'" type was not found.';if(this.options.silent)return console.error(fr),"";throw new Error(fr)}}}return cr}parseInline(or,ar){ar=ar||this.renderer;let cr="";for(let ur=0;ur<or.length;ur++){const hr=or[ur];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[hr.type]){const fr=this.options.extensions.renderers[hr.type].call({parser:this},hr);if(fr!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(hr.type)){cr+=fr||"";continue}}switch(hr.type){case"escape":{const fr=hr;cr+=ar.text(fr.text);break}case"html":{const fr=hr;cr+=ar.html(fr.text);break}case"link":{const fr=hr;cr+=ar.link(fr.href,fr.title,this.parseInline(fr.tokens,ar));break}case"image":{const fr=hr;cr+=ar.image(fr.href,fr.title,fr.text);break}case"strong":{const fr=hr;cr+=ar.strong(this.parseInline(fr.tokens,ar));break}case"em":{const fr=hr;cr+=ar.em(this.parseInline(fr.tokens,ar));break}case"codespan":{const fr=hr;cr+=ar.codespan(fr.text);break}case"br":{cr+=ar.br();break}case"del":{const fr=hr;cr+=ar.del(this.parseInline(fr.tokens,ar));break}case"text":{const fr=hr;cr+=ar.text(fr.text);break}default:{const fr='Token with "'+hr.type+'" type was not found.';if(this.options.silent)return console.error(fr),"";throw new Error(fr)}}}return cr}}class _Hooks{constructor(or){bi(this,"options");this.options=or||_defaults}preprocess(or){return or}postprocess(or){return or}}bi(_Hooks,"passThroughHooks",new Set(["preprocess","postprocess"]));var Xi,ts,Yi,as;class Marked{constructor(...or){Fi(this,Xi);Fi(this,Yi);bi(this,"defaults",_getDefaults());bi(this,"options",this.setOptions);bi(this,"parse",zi(this,Xi,ts).call(this,_Lexer.lex,_Parser.parse));bi(this,"parseInline",zi(this,Xi,ts).call(this,_Lexer.lexInline,_Parser.parseInline));bi(this,"Parser",_Parser);bi(this,"parser",_Parser.parse);bi(this,"Renderer",_Renderer);bi(this,"TextRenderer",_TextRenderer);bi(this,"Lexer",_Lexer);bi(this,"lexer",_Lexer.lex);bi(this,"Tokenizer",_Tokenizer);bi(this,"Hooks",_Hooks);this.use(...or)}walkTokens(or,ar){var ur,hr;let cr=[];for(const fr of or)switch(cr=cr.concat(ar.call(this,fr)),fr.type){case"table":{const dr=fr;for(const pr of dr.header)cr=cr.concat(this.walkTokens(pr.tokens,ar));for(const pr of dr.rows)for(const mr of pr)cr=cr.concat(this.walkTokens(mr.tokens,ar));break}case"list":{const dr=fr;cr=cr.concat(this.walkTokens(dr.items,ar));break}default:{const dr=fr;(hr=(ur=this.defaults.extensions)==null?void 0:ur.childTokens)!=null&&hr[dr.type]?this.defaults.extensions.childTokens[dr.type].forEach(pr=>{cr=cr.concat(this.walkTokens(dr[pr],ar))}):dr.tokens&&(cr=cr.concat(this.walkTokens(dr.tokens,ar)))}}return cr}use(...or){const ar=this.defaults.extensions||{renderers:{},childTokens:{}};return or.forEach(cr=>{const ur={...cr};if(ur.async=this.defaults.async||ur.async||!1,cr.extensions&&(cr.extensions.forEach(hr=>{if(!hr.name)throw new Error("extension name required");if("renderer"in hr){const fr=ar.renderers[hr.name];fr?ar.renderers[hr.name]=function(...dr){let pr=hr.renderer.apply(this,dr);return pr===!1&&(pr=fr.apply(this,dr)),pr}:ar.renderers[hr.name]=hr.renderer}if("tokenizer"in hr){if(!hr.level||hr.level!=="block"&&hr.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const fr=ar[hr.level];fr?fr.unshift(hr.tokenizer):ar[hr.level]=[hr.tokenizer],hr.start&&(hr.level==="block"?ar.startBlock?ar.startBlock.push(hr.start):ar.startBlock=[hr.start]:hr.level==="inline"&&(ar.startInline?ar.startInline.push(hr.start):ar.startInline=[hr.start]))}"childTokens"in hr&&hr.childTokens&&(ar.childTokens[hr.name]=hr.childTokens)}),ur.extensions=ar),cr.renderer){const hr=this.defaults.renderer||new _Renderer(this.defaults);for(const fr in cr.renderer){const dr=cr.renderer[fr],pr=fr,mr=hr[pr];hr[pr]=(...gr)=>{let yr=dr.apply(hr,gr);return yr===!1&&(yr=mr.apply(hr,gr)),yr||""}}ur.renderer=hr}if(cr.tokenizer){const hr=this.defaults.tokenizer||new _Tokenizer(this.defaults);for(const fr in cr.tokenizer){const dr=cr.tokenizer[fr],pr=fr,mr=hr[pr];hr[pr]=(...gr)=>{let yr=dr.apply(hr,gr);return yr===!1&&(yr=mr.apply(hr,gr)),yr}}ur.tokenizer=hr}if(cr.hooks){const hr=this.defaults.hooks||new _Hooks;for(const fr in cr.hooks){const dr=cr.hooks[fr],pr=fr,mr=hr[pr];_Hooks.passThroughHooks.has(fr)?hr[pr]=gr=>{if(this.defaults.async)return Promise.resolve(dr.call(hr,gr)).then(br=>mr.call(hr,br));const yr=dr.call(hr,gr);return mr.call(hr,yr)}:hr[pr]=(...gr)=>{let yr=dr.apply(hr,gr);return yr===!1&&(yr=mr.apply(hr,gr)),yr}}ur.hooks=hr}if(cr.walkTokens){const hr=this.defaults.walkTokens,fr=cr.walkTokens;ur.walkTokens=function(dr){let pr=[];return pr.push(fr.call(this,dr)),hr&&(pr=pr.concat(hr.call(this,dr))),pr}}this.defaults={...this.defaults,...ur}}),this}setOptions(or){return this.defaults={...this.defaults,...or},this}}Xi=new WeakSet,ts=function(or,ar){return(cr,ur)=>{const hr={...ur},fr={...this.defaults,...hr};this.defaults.async===!0&&hr.async===!1&&(fr.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),fr.async=!0);const dr=zi(this,Yi,as).call(this,!!fr.silent,!!fr.async);if(typeof cr>"u"||cr===null)return dr(new Error("marked(): input parameter is undefined or null"));if(typeof cr!="string")return dr(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(cr)+", string expected"));if(fr.hooks&&(fr.hooks.options=fr),fr.async)return Promise.resolve(fr.hooks?fr.hooks.preprocess(cr):cr).then(pr=>or(pr,fr)).then(pr=>fr.walkTokens?Promise.all(this.walkTokens(pr,fr.walkTokens)).then(()=>pr):pr).then(pr=>ar(pr,fr)).then(pr=>fr.hooks?fr.hooks.postprocess(pr):pr).catch(dr);try{fr.hooks&&(cr=fr.hooks.preprocess(cr));const pr=or(cr,fr);fr.walkTokens&&this.walkTokens(pr,fr.walkTokens);let mr=ar(pr,fr);return fr.hooks&&(mr=fr.hooks.postprocess(mr)),mr}catch(pr){return dr(pr)}}},Yi=new WeakSet,as=function(or,ar){return cr=>{if(cr.message+=`
Please report this to https://github.com/markedjs/marked.`,or){const ur="<p>An error occurred:</p><pre>"+escape(cr.message+"",!0)+"</pre>";return ar?Promise.resolve(ur):ur}if(ar)return Promise.reject(cr);throw cr}};const markedInstance=new Marked;function marked(lr,or){return markedInstance.parse(lr,or)}marked.options=marked.setOptions=function(lr){return markedInstance.setOptions(lr),marked.defaults=markedInstance.defaults,changeDefaults(marked.defaults),marked};marked.getDefaults=_getDefaults;marked.defaults=_defaults;marked.use=function(...lr){return markedInstance.use(...lr),marked.defaults=markedInstance.defaults,changeDefaults(marked.defaults),marked};marked.walkTokens=function(lr,or){return markedInstance.walkTokens(lr,or)};marked.parseInline=markedInstance.parseInline;marked.Parser=_Parser;marked.parser=_Parser.parse;marked.Renderer=_Renderer;marked.TextRenderer=_TextRenderer;marked.Lexer=_Lexer;marked.lexer=_Lexer.lex;marked.Tokenizer=_Tokenizer;marked.Hooks=_Hooks;marked.parse=marked;marked.options;marked.setOptions;marked.use;marked.walkTokens;marked.parseInline;_Parser.parse;_Lexer.lex;if(typeof DOMParser>"u"){const lr=global.JSDOM||require("jsdom").JSDOM;global.DOMParser=new lr().window.DOMParser,global.document=new lr().window.document}const a$1=document.createElement("p"),mangle=lr=>(a$1.textContent=lr,a$1.innerHTML),tokenizer={heading(){},nptable(){},hr(){},blockquote(){},code(){},def(){},list(){},table(){},lheading(){}};marked.use({tokenizer});const disableShortLinks=lr=>{marked.use({tokenizer:{reflink(or){if(lr)return;const cr=/^\[(.*?)\]/.exec(or);if(cr)return{type:"link",raw:cr[0],text:"",title:"",href:"#"+cr[1].trim(),tokens:[]}}}})},defaultHTMLRenderer={html:lr=>mangle(lr),paragraph:lr=>`${lr.trim()}<br>`,strong:lr=>`<b>${lr}</b>`,em:lr=>`<i>${lr}</i>`,codespan:lr=>"",code:lr=>"",reflink:(...lr)=>JSON.stringify(lr),br:(...lr)=>"</p><p>"},encodeToHTML=(lr,or=defaultHTMLRenderer)=>marked(lr.replace(/\n/g,` \\
`).replaceAll(" \\\n```","\n\n```"),{renderer:Object.assign(new marked.Renderer,or,{code:(ar,cr,...ur)=>or.code(ar.replaceAll(` \\
`,`
`),cr.replace(" \\",""),...ur)})})||"",trimHTML=lr=>lr.replaceAll(/( )*\<p\>( )*/g,"<p>").replaceAll(/( )*\<\/p\>( )*/g,"</p>").replaceAll(/( )*\<br>( )*/g,"<br>"),sanitizeProperties=(lr={})=>{const or={disableShortLinks:!1,page:{width:"14.8",height:"21",margins:["2.5","2","2","2"]},textFont:{family:"Times New Roman",spacing:"100%",size:"12pt"},titleFont:{family:"Times New Roman",spacing:"100%",size:"12pt"},titleStyle:"default",renameTitle:({book:ar,chapter:cr,key:ur,title:hr})=>"<b>"+(hr==""?ur:hr)+"</b>",renameLink:({book:ar,chapter:cr,text:ur,key:hr,title:fr})=>ur==""?cr==null?"ERROR":fr==""?hr:fr:ur,renameAnchor:({book:ar,key:cr})=>cr,advancedFormat:["text/html","html"]};if(lr.disableShortLinks&&lr.disableShortLinks.trim().toLowerCase()=="true"&&(or.disableShortLinks=!0),typeof lr.page=="string"){const ar=lr.page.split(",");if(ar[0]){const cr={A3:"29.70 42.00",A4:"21.00 29.70",A5:"14.80 21.00",A6:"10.50 14.80",B4:"25.00 35.30",B5:"17.60 25.00",B6:"12.50 17.60",Letter:"21.59 27.94"},ur=(cr[ar[0].trim()]?cr[ar[0].trim()]:ar[0].trim()).split(/\s+/);ur.length>=2&&(or.page.width=ur[0],or.page.height=ur[1])}if(ar[1]){const cr=ar[1].trim().split(/\s+/);cr.length>=4&&(or.page.margins=cr)}}if(lr.textFont){const ar=lr.textFont.split(",");if(ar[0]&&(or.textFont.family=ar[0].trim()),ar[1]){let cr=ar[1].trim();cr.endsWith("pt")||(cr+="pt"),or.textFont.size=cr}ar[2]&&(or.textFont.spacing=ar[2].trim())}if(lr.titleFont){const ar=lr.titleFont.split(",");if(ar[0]&&(or.titleFont.family=ar[0].trim()),ar[1]){let cr=ar[1].trim();cr.endsWith("pt")||(cr+="pt"),or.titleFont.size=cr}ar[2]&&(or.titleFont.spacing=ar[2].trim())}if(lr.titleStyle){const ar=["default","inline"],cr=ar.indexOf(lr.titleStyle.trim().toLowerCase());cr!=-1&&(or.titleStyle=ar[cr])}if(lr.renameTitle&&(or.renameTitle=new Function("{book, chapter, key, title}","return "+lr.renameTitle.trim())),lr.renameLink&&(or.renameLink=new Function("{book, text, chapter, title, key }","return "+lr.renameLink.trim())),lr.renameAnchor&&(or.renameAnchor=new Function("{book, key}","return "+lr.renameAnchor.trim())),lr.advancedFormat){const ar=lr.advancedFormat.split(",");ar[0]&&(or.advancedFormat[0]=ar[0].trim()),ar[1]&&(or.advancedFormat[1]=ar[1].trim())}return or},renameKeyAndTitle=(lr,or,ar)=>{const cr=lr.renameAnchor({key:ar.key,book:or}),ur=lr.renameTitle({book:or,chapter:ar,key:ar.key,title:ar.title});return{renamedKey:cr,renamedTitle:ur}},mimetype$4="application/xml",extension$4="xlgc",lgcVersion="3.4.3.447",whitelist$2=["<b>","</b>","<i>","</i>","<u>","</u>"],renderer$3={html:lr=>whitelist$2.includes(lr.trim().toLowerCase())?lr.trim().toLowerCase():mangle(lr),paragraph:lr=>`<p>${lr}</p>`,strong:lr=>`<b>${lr}</b>`,em:lr=>`<i>${lr}</i>`,codespan:lr=>"`"+lr+"`",code:(lr,or)=>"<p>```"+or+mangle(lr).replace(/\n/g,"</p><p>")+"```</p>",link:(lr,or,ar)=>`{link ${lr.replace("#","")}:${ar||"@T"}}`,br:()=>"</p><p>"},arrayfy=lr=>Array.isArray(lr)?lr:[lr],parseContent=lr=>lr.replaceAll(`
`,"").replaceAll("<br>",`
`).replaceAll("<br/>",`
`).replaceAll("</p>",`
`).replaceAll("<p>","").split(`
`).map(ar=>ar+(ar.includes("<p ")?"</p>":"")).join(`
`),decode$1=lr=>{let or="";const ar=Oe$1(lr,{compact:!0});let cr="";const ur={},hr=[];for(const fr of arrayfy(ar.book.entities.entity))if(fr._attributes.group==="setup"){if(fr._attributes.type==="game")for(const dr of arrayfy(fr.attribute)){let pr=dr._cdata;if(typeof pr!="string"||pr.trim().length===0)continue;const mr=dr._attributes.name.trim();pr=pr.trim(),mr==="title"&&(cr=pr),["author","version","lgc_version","revision"].includes(mr)&&(ur.name=pr)}else if(fr._attributes.type==="global_attributes")for(const dr of arrayfy(fr.attribute)){let pr=dr._cdata;if(typeof pr!="string"||pr.trim().length===0)continue;const mr=dr._attributes.name.trim();pr=pr.trim(),!["description","chapter_title"].includes(mr)&&(ur[`@${mr}`]=pr)}}else{const dr={};for(const pr of arrayfy(fr.attribute)){let mr=pr._cdata;if(typeof mr!="string"||mr.trim().length===0)continue;const gr=pr._attributes.name.trim();dr[gr]=mr}hr.push({key:fr._attributes.name,title:dr.chapter_title??"",flags:[],group:fr._attributes.group??"",content:parseContent(dr.description??"")})}return cr!==""&&(or+=`# ${cr}
`),Object.entries(ur).forEach(([fr,dr])=>{or+=`${fr}: ${dr}
`}),or.length>0&&(or+=`
`),or+=hr.map(fr=>chapterText(fr)).join(`
`),or},filterFlags=lr=>[].join(";"),encode$4=lr=>{const or=bookify(lr),ar={_declaration:{_attributes:{version:"1.0",encoding:"UTF-8"}},book:{_attributes:{producer:"LGC",producer_version:lgcVersion,schema_version:"1.0"},entities:{entity:[]},hashtags:{hashtag:[]}}},cr=(ur,hr,fr)=>({_attributes:{name:ur,type:hr},...hr==="boolean"?{_cdata:fr==!0?"true":"false"}:fr===null?{}:{_cdata:fr}});for(const[ur,{content:hr}]of chaptersOf(or))ar.book.entities.entity.push({_attributes:{group:ur.group,type:isNatNumber(ur.key)?"chapter":"section",name:ur.key},attribute:[["description","string",encodeToHTML(hr,renderer$3).trim()],["chapter_title","string",ur.title],["hashtags","array",filterFlags(ur.flags)],["flag_export","boolean",!ur.flags.includes("noexport")],["flag_fixed","boolean",ur.flags.includes("fixed")]].map(([fr,dr,pr])=>cr(fr,dr,pr))});return ar.book.entities.entity.push({_attributes:{group:"setup",name:"game",type:"entity"},attribute:[["description","string","<p></p>"],["chapter_title","string",null],["hashtags","array",null],["lgc_version","string",lgcVersion],["title","string",or.index.title.trim()],["author","string",or.index.properties.author??""],["version","string",or.index.properties.version??""],["revision","integer","1"],["editing_action","string","WRITING"],["table_of_contents","string","P(ALL)"],["editing_chapter","string",or.index.chapters[0].key]].map(([ur,hr,fr])=>cr(ur,hr,fr))},{_attributes:{group:"setup",name:"global_attributes",type:"entity"},attribute:[["description","string","<p></p>"],["chapter_title","string",null]].map(([ur,hr,fr])=>cr(ur,hr,fr))}),{encodedBook:Ue$1(ar,{compact:!0,spaces:2}),mimetype:mimetype$4,extension:extension$4}},xlgc=Object.freeze(Object.defineProperty({__proto__:null,decode:decode$1,encode:encode$4,extension:extension$4,mimetype:mimetype$4},Symbol.toStringTag,{value:"Module"})),customStyles=`
  <style:style style:name="right" style:family="paragraph" style:parent-style-name="Standard">
    <style:paragraph-properties fo:text-align="end" style:justify-single-word="false"/>
  </style:style>
  <style:style style:name="justify" style:family="paragraph" style:parent-style-name="Standard">
    <style:paragraph-properties fo:text-align="justify" style:justify-single-word="false"/>
  </style:style>
  <style:style style:name="break" style:family="paragraph" style:parent-style-name="Standard">
    <style:paragraph-properties fo:break-after="page"/>
  </style:style>
  <style:style style:name="bold" style:family="text">
   <style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/>
  </style:style>
  <style:style style:name="underline" style:family="text">
    <style:text-properties style:text-underline-style="solid" style:text-underline-width="auto" style:text-underline-color="font-color"/>
  </style:style>
  <style:style style:name="italic" style:family="text">
    <style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/>
  </style:style>`,template$1=(lr,or)=>`<?xml version="1.0" encoding="UTF-8"?>

<office:document xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:css3t="http://www.w3.org/TR/css3-text/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:config="urn:oasis:names:tc:opendocument:xmlns:config:1.0" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ooo="http://openoffice.org/2004/office" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" office:version="1.2" office:mimetype="application/vnd.oasis.opendocument.text">
 <office:meta><meta:creation-date>2017-01-01T14:28:30.863048091</meta:creation-date><meta:generator>LibreOffice/6.4.1.2$Linux_X86_64 LibreOffice_project/e1ad903d8acbc5f5b474f1d8ec3defef24b8c46b</meta:generator><meta:editing-cycles>0</meta:editing-cycles><meta:editing-duration>P0D</meta:editing-duration><meta:document-statistic meta:table-count="0" meta:image-count="0" meta:object-count="0" meta:page-count="2" meta:paragraph-count="14" meta:word-count="48" meta:character-count="272" meta:non-whitespace-character-count="237"/></office:meta>
 <office:settings>
  <config:config-item-set config:name="ooo:view-settings">
   <config:config-item config:name="ViewAreaTop" config:type="long">7895</config:config-item>
   <config:config-item config:name="ViewAreaLeft" config:type="long">0</config:config-item>
   <config:config-item config:name="ViewAreaWidth" config:type="long">33413</config:config-item>
   <config:config-item config:name="ViewAreaHeight" config:type="long">15162</config:config-item>
   <config:config-item config:name="ShowRedlineChanges" config:type="boolean">true</config:config-item>
   <config:config-item config:name="InBrowseMode" config:type="boolean">false</config:config-item>
   <config:config-item-map-indexed config:name="Views">
    <config:config-item-map-entry>
     <config:config-item config:name="ViewId" config:type="string">view2</config:config-item>
     <config:config-item config:name="ViewLeft" config:type="long">16095</config:config-item>
     <config:config-item config:name="ViewTop" config:type="long">7869</config:config-item>
     <config:config-item config:name="VisibleLeft" config:type="long">0</config:config-item>
     <config:config-item config:name="VisibleTop" config:type="long">7895</config:config-item>
     <config:config-item config:name="VisibleRight" config:type="long">33412</config:config-item>
     <config:config-item config:name="VisibleBottom" config:type="long">23056</config:config-item>
     <config:config-item config:name="ZoomType" config:type="short">0</config:config-item>
     <config:config-item config:name="ViewLayoutColumns" config:type="short">1</config:config-item>
     <config:config-item config:name="ViewLayoutBookMode" config:type="boolean">false</config:config-item>
     <config:config-item config:name="ZoomFactor" config:type="short">140</config:config-item>
     <config:config-item config:name="IsSelectedFrame" config:type="boolean">false</config:config-item>
     <config:config-item config:name="AnchoredTextOverflowLegacy" config:type="boolean">true</config:config-item>
    </config:config-item-map-entry>
   </config:config-item-map-indexed>
  </config:config-item-set>
  <config:config-item-set config:name="ooo:configuration-settings">
   <config:config-item config:name="PrintPaperFromSetup" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintFaxName" config:type="string"/>
   <config:config-item config:name="PrintSingleJobs" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintProspectRTL" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintProspect" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintReversed" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintTextPlaceholder" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintTables" config:type="boolean">true</config:config-item>
   <config:config-item config:name="PrintPageBackground" config:type="boolean">true</config:config-item>
   <config:config-item config:name="PrintLeftPages" config:type="boolean">true</config:config-item>
   <config:config-item config:name="PrintAnnotationMode" config:type="short">0</config:config-item>
   <config:config-item config:name="PrintControls" config:type="boolean">true</config:config-item>
   <config:config-item config:name="PrintHiddenText" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintDrawings" config:type="boolean">true</config:config-item>
   <config:config-item config:name="IgnoreFirstLineIndentInNumbering" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrinterSetup" config:type="base64Binary"/>
   <config:config-item config:name="CollapseEmptyCellPara" config:type="boolean">true</config:config-item>
   <config:config-item config:name="UseOldPrinterMetrics" config:type="boolean">false</config:config-item>
   <config:config-item config:name="UseOldNumbering" config:type="boolean">false</config:config-item>
   <config:config-item config:name="AddExternalLeading" config:type="boolean">true</config:config-item>
   <config:config-item config:name="TreatSingleColumnBreakAsPageBreak" config:type="boolean">false</config:config-item>
   <config:config-item config:name="IsLabelDocument" config:type="boolean">false</config:config-item>
   <config:config-item config:name="RsidRoot" config:type="int">1031266</config:config-item>
   <config:config-item config:name="ConsiderTextWrapOnObjPos" config:type="boolean">false</config:config-item>
   <config:config-item config:name="TableRowKeep" config:type="boolean">false</config:config-item>
   <config:config-item config:name="TabsRelativeToIndent" config:type="boolean">true</config:config-item>
   <config:config-item config:name="UpdateFromTemplate" config:type="boolean">true</config:config-item>
   <config:config-item config:name="SaveVersionOnClose" config:type="boolean">false</config:config-item>
   <config:config-item config:name="UseFormerTextWrapping" config:type="boolean">false</config:config-item>
   <config:config-item config:name="ChartAutoUpdate" config:type="boolean">true</config:config-item>
   <config:config-item config:name="AllowPrintJobCancel" config:type="boolean">true</config:config-item>
   <config:config-item config:name="AddParaTableSpacing" config:type="boolean">true</config:config-item>
   <config:config-item config:name="AddParaSpacingToTableCells" config:type="boolean">true</config:config-item>
   <config:config-item config:name="UseFormerLineSpacing" config:type="boolean">false</config:config-item>
   <config:config-item config:name="OutlineLevelYieldsNumbering" config:type="boolean">false</config:config-item>
   <config:config-item config:name="AlignTabStopPosition" config:type="boolean">true</config:config-item>
   <config:config-item config:name="DoNotJustifyLinesWithManualBreak" config:type="boolean">false</config:config-item>
   <config:config-item config:name="EmbedOnlyUsedFonts" config:type="boolean">false</config:config-item>
   <config:config-item config:name="LinkUpdateMode" config:type="short">1</config:config-item>
   <config:config-item config:name="CurrentDatabaseCommandType" config:type="int">0</config:config-item>
   <config:config-item config:name="CurrentDatabaseCommand" config:type="string"/>
   <config:config-item config:name="CharacterCompressionType" config:type="short">0</config:config-item>
   <config:config-item config:name="SmallCapsPercentage66" config:type="boolean">false</config:config-item>
   <config:config-item config:name="ApplyUserData" config:type="boolean">false</config:config-item>
   <config:config-item config:name="StylesNoDefault" config:type="boolean">false</config:config-item>
   <config:config-item config:name="EmbeddedDatabaseName" config:type="string"/>
   <config:config-item config:name="FloattableNomargins" config:type="boolean">false</config:config-item>
   <config:config-item config:name="BackgroundParaOverDrawings" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrinterName" config:type="string"/>
   <config:config-item config:name="UseFormerObjectPositioning" config:type="boolean">false</config:config-item>
   <config:config-item config:name="TabOverMargin" config:type="boolean">false</config:config-item>
   <config:config-item config:name="SaveGlobalDocumentLinks" config:type="boolean">false</config:config-item>
   <config:config-item config:name="CurrentDatabaseDataSource" config:type="string"/>
   <config:config-item config:name="IsKernAsianPunctuation" config:type="boolean">false</config:config-item>
   <config:config-item config:name="SaveThumbnail" config:type="boolean">true</config:config-item>
   <config:config-item config:name="PrinterPaperFromSetup" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrinterIndependentLayout" config:type="string">high-resolution</config:config-item>
   <config:config-item config:name="TabOverflow" config:type="boolean">true</config:config-item>
   <config:config-item config:name="PrintGraphics" config:type="boolean">true</config:config-item>
   <config:config-item config:name="PropLineSpacingShrinksFirstLine" config:type="boolean">true</config:config-item>
   <config:config-item config:name="DoNotResetParaAttrsForNumFont" config:type="boolean">false</config:config-item>
   <config:config-item config:name="FieldAutoUpdate" config:type="boolean">true</config:config-item>
   <config:config-item config:name="IgnoreTabsAndBlanksForLineCalculation" config:type="boolean">false</config:config-item>
   <config:config-item config:name="RedlineProtectionKey" config:type="base64Binary"/>
   <config:config-item config:name="EmbedComplexScriptFonts" config:type="boolean">true</config:config-item>
   <config:config-item config:name="LoadReadonly" config:type="boolean">false</config:config-item>
   <config:config-item config:name="DoNotCaptureDrawObjsOnPage" config:type="boolean">false</config:config-item>
   <config:config-item config:name="ClipAsCharacterAnchoredWriterFlyFrames" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintBlackFonts" config:type="boolean">false</config:config-item>
   <config:config-item config:name="DisableOffPagePositioning" config:type="boolean">false</config:config-item>
   <config:config-item config:name="SurroundTextWrapSmall" config:type="boolean">false</config:config-item>
   <config:config-item config:name="UnxForceZeroExtLeading" config:type="boolean">false</config:config-item>
   <config:config-item config:name="EmbedAsianScriptFonts" config:type="boolean">true</config:config-item>
   <config:config-item config:name="TabAtLeftIndentForParagraphsInList" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintRightPages" config:type="boolean">true</config:config-item>
   <config:config-item config:name="Rsid" config:type="int">1168269</config:config-item>
   <config:config-item config:name="MathBaselineAlignment" config:type="boolean">true</config:config-item>
   <config:config-item config:name="MsWordCompTrailingBlanks" config:type="boolean">false</config:config-item>
   <config:config-item config:name="InvertBorderSpacing" config:type="boolean">false</config:config-item>
   <config:config-item config:name="EmbedFonts" config:type="boolean">false</config:config-item>
   <config:config-item config:name="UnbreakableNumberings" config:type="boolean">false</config:config-item>
   <config:config-item config:name="AddFrameOffsets" config:type="boolean">false</config:config-item>
   <config:config-item config:name="ClippedPictures" config:type="boolean">false</config:config-item>
   <config:config-item config:name="EmbedLatinScriptFonts" config:type="boolean">true</config:config-item>
   <config:config-item config:name="EmbedSystemFonts" config:type="boolean">false</config:config-item>
   <config:config-item config:name="AddParaTableSpacingAtStart" config:type="boolean">true</config:config-item>
   <config:config-item config:name="ContinuousEndnotes" config:type="boolean">false</config:config-item>
   <config:config-item config:name="ApplyParagraphMarkFormatToNumbering" config:type="boolean">false</config:config-item>
   <config:config-item config:name="SubtractFlysAnchoredAtFlys" config:type="boolean">false</config:config-item>
   <config:config-item config:name="EmptyDbFieldHidesPara" config:type="boolean">false</config:config-item>
   <config:config-item config:name="ProtectForm" config:type="boolean">false</config:config-item>
   <config:config-item config:name="AddVerticalFrameOffsets" config:type="boolean">false</config:config-item>
   <config:config-item config:name="PrintEmptyPages" config:type="boolean">false</config:config-item>
  </config:config-item-set>
 </office:settings>
 <office:scripts>
  <office:script script:language="ooo:Basic">
   <ooo:libraries xmlns:ooo="http://openoffice.org/2004/office" xmlns:xlink="http://www.w3.org/1999/xlink">
    <ooo:library-embedded ooo:name="Standard"/>
   </ooo:libraries>
  </office:script>
 </office:scripts>
 <office:font-face-decls>
  <style:font-face style:name="FreeSans1" svg:font-family="FreeSans" style:font-family-generic="swiss"/>
  <style:font-face style:name="Liberation Serif" svg:font-family="&apos;Liberation Serif&apos;" style:font-family-generic="roman" style:font-pitch="variable"/>
  <style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;" style:font-adornments="Normale" style:font-family-generic="roman" style:font-pitch="variable"/>
  <style:font-face style:name="Liberation Sans" svg:font-family="&apos;Liberation Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/>
  <style:font-face style:name="FreeSans" svg:font-family="FreeSans" style:font-family-generic="system" style:font-pitch="variable"/>
  <style:font-face style:name="Noto Sans CJK SC Regular" svg:font-family="&apos;Noto Sans CJK SC Regular&apos;" style:font-family-generic="system" style:font-pitch="variable"/>
 </office:font-face-decls>
 <office:styles>
  <style:default-style style:family="graphic">
   <style:graphic-properties svg:stroke-color="#3465a4" draw:fill-color="#729fcf" fo:wrap-option="no-wrap" draw:shadow-offset-x="0.3cm" draw:shadow-offset-y="0.3cm" draw:start-line-spacing-horizontal="0.283cm" draw:start-line-spacing-vertical="0.283cm" draw:end-line-spacing-horizontal="0.283cm" draw:end-line-spacing-vertical="0.283cm" style:flow-with-text="false"/>
   <style:paragraph-properties style:text-autospace="ideograph-alpha" style:line-break="strict" style:font-independent-line-spacing="false">
    <style:tab-stops/>
   </style:paragraph-properties>
   <style:text-properties style:use-window-font-color="true" style:font-name="Liberation Serif" fo:font-size="12pt" fo:language="en" fo:country="US" style:letter-kerning="true" style:font-name-asian="Noto Sans CJK SC Regular" style:font-size-asian="10.5pt" style:language-asian="zh" style:country-asian="CN" style:font-name-complex="FreeSans" style:font-size-complex="12pt" style:language-complex="hi" style:country-complex="IN"/>
  </style:default-style>
  <style:default-style style:family="paragraph">
   <style:paragraph-properties fo:orphans="2" fo:widows="2" fo:hyphenation-ladder-count="no-limit" style:text-autospace="ideograph-alpha" style:punctuation-wrap="hanging" style:line-break="strict" style:tab-stop-distance="1.251cm" style:writing-mode="page"/>
   <style:text-properties style:use-window-font-color="true" style:font-name="Liberation Serif" fo:font-size="12pt" fo:language="en" fo:country="US" style:letter-kerning="true" style:font-name-asian="Noto Sans CJK SC Regular" style:font-size-asian="10.5pt" style:language-asian="zh" style:country-asian="CN" style:font-name-complex="FreeSans" style:font-size-complex="12pt" style:language-complex="hi" style:country-complex="IN" fo:hyphenate="false" fo:hyphenation-remain-char-count="2" fo:hyphenation-push-char-count="2" loext:hyphenation-no-caps="false"/>
  </style:default-style>
  <style:default-style style:family="table">
   <style:table-properties table:border-model="collapsing"/>
  </style:default-style>
  <style:default-style style:family="table-row">
   <style:table-row-properties fo:keep-together="auto"/>
  </style:default-style>
  <style:style style:name="Standard" style:family="paragraph" style:class="text">
   <style:paragraph-properties fo:line-height="${or.textFont.spacing}" style:page-number="auto"/>
   <style:text-properties style:font-name="${or.textFont.family}" fo:font-family="&apos;${or.textFont.family}&apos;" style:font-style-name="Normale" style:font-family-generic="roman" style:font-pitch="variable" fo:language="zxx" fo:country="none" fo:font-size="${or.textFont.size}" />
  </style:style>
  <style:style style:name="Heading" style:family="paragraph" style:parent-style-name="Standard" style:next-style-name="Text_20_body" style:class="text">
   <style:text-properties style:font-name="Liberation Sans" fo:font-family="&apos;Liberation Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable" fo:font-size="14pt" style:font-name-asian="Noto Sans CJK SC Regular" style:font-family-asian="&apos;Noto Sans CJK SC Regular&apos;" style:font-family-generic-asian="system" style:font-pitch-asian="variable" style:font-size-asian="14pt" style:font-name-complex="FreeSans" style:font-family-complex="FreeSans" style:font-family-generic-complex="system" style:font-pitch-complex="variable" style:font-size-complex="14pt"/>
  </style:style>
  <style:style style:name="Heading_3" style:family="paragraph" style:display-name="Heading 3" style:parent-style-name="Heading" style:next-style-name="Standard" style:default-outline-level="3" style:class="text">
    <style:paragraph-properties fo:text-align="center" style:justify-single-word="false"/>
    <style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/>
    <style:paragraph-properties fo:line-height="${or.titleFont.spacing}" style:page-number="auto"/>
    <style:text-properties style:font-name="${or.titleFont.family}" fo:font-family="&apos;${or.titleFont.family}&apos;" style:font-style-name="Normale" style:font-family-generic="roman" fo:font-size="${or.titleFont.size}" style:font-pitch="variable" fo:language="zxx" fo:country="none"/>
  </style:style>
  <style:style style:name="Text_20_body" style:display-name="Text body" style:family="paragraph" style:parent-style-name="Standard" style:class="text">
   <style:paragraph-properties fo:margin-top="0cm" fo:margin-bottom="0.247cm" loext:contextual-spacing="false" fo:line-height="120%"/>
  </style:style>
  <style:style style:name="List" style:family="paragraph" style:parent-style-name="Text_20_body" style:class="list">
   <style:text-properties style:font-size-asian="12pt" style:font-name-complex="FreeSans1" style:font-family-complex="FreeSans" style:font-family-generic-complex="swiss"/>
  </style:style>
  <style:style style:name="Caption" style:family="paragraph" style:parent-style-name="Standard" style:class="extra">
   <style:paragraph-properties fo:margin-top="0.212cm" fo:margin-bottom="0.212cm" loext:contextual-spacing="false" text:number-lines="false" text:line-number="0"/>
   <style:text-properties fo:font-size="12pt" fo:font-style="italic" style:font-size-asian="12pt" style:font-style-asian="italic" style:font-name-complex="FreeSans1" style:font-family-complex="FreeSans" style:font-family-generic-complex="swiss" style:font-size-complex="12pt" style:font-style-complex="italic"/>
  </style:style>
  <style:style style:name="Index" style:family="paragraph" style:parent-style-name="Standard" style:class="index">
   <style:paragraph-properties text:number-lines="false" text:line-number="0"/>
   <style:text-properties style:font-size-asian="12pt" style:font-name-complex="FreeSans1" style:font-family-complex="FreeSans" style:font-family-generic-complex="swiss"/>
  </style:style>
  <style:style style:name="Internet_20_link" style:display-name="Internet link" style:family="text">
   <style:text-properties fo:color="#000080" fo:language="zxx" fo:country="none" style:language-asian="zxx" style:country-asian="none" style:language-complex="zxx" style:country-complex="none"/>
  </style:style>
  <style:style style:name="Visited_20_Internet_20_Link" style:display-name="Visited Internet Link" style:family="text">
   <style:text-properties fo:color="#800000" fo:language="zxx" fo:country="none" style:language-asian="zxx" style:country-asian="none" style:language-complex="zxx" style:country-complex="none"/>
  </style:style>
  <text:outline-style style:name="Outline">
   <text:outline-level-style text:level="1" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="2" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="3" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="4" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="5" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="6" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="7" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="8" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="9" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
   <text:outline-level-style text:level="10" style:num-format="">
    <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">
     <style:list-level-label-alignment text:label-followed-by="listtab"/>
    </style:list-level-properties>
   </text:outline-level-style>
  </text:outline-style>
  <text:notes-configuration text:note-class="footnote" style:num-format="1" text:start-value="0" text:footnotes-position="page" text:start-numbering-at="document"/>
  <text:notes-configuration text:note-class="endnote" style:num-format="i" text:start-value="0"/>
  <text:linenumbering-configuration text:number-lines="false" text:offset="0.499cm" style:num-format="1" text:number-position="left" text:increment="5"/>
 </office:styles>
 <office:automatic-styles>${customStyles}
  <style:page-layout style:name="pm1">
   <style:page-layout-properties fo:page-width="${or.page.width}cm" fo:page-height="${or.page.height}cm" style:num-format="1" style:print-orientation="portrait" fo:margin-top="${or.page.margins[0]}cm" fo:margin-bottom="${or.page.margins[2]}cm" fo:margin-left="${or.page.margins[3]}cm" fo:margin-right="${or.page.margins[1]}cm" style:writing-mode="lr-tb" style:layout-grid-color="#c0c0c0" style:layout-grid-lines="20" style:layout-grid-base-height="0.706cm" style:layout-grid-ruby-height="0.353cm" style:layout-grid-mode="none" style:layout-grid-ruby-below="false" style:layout-grid-print="false" style:layout-grid-display="false" style:footnote-max-height="0cm">
    <style:footnote-sep style:width="0.018cm" style:distance-before-sep="0.101cm" style:distance-after-sep="0.101cm" style:line-style="solid" style:adjustment="left" style:rel-width="25%" style:color="#000000"/>
   </style:page-layout-properties>
   <style:header-style/>
   <style:footer-style/>
  </style:page-layout>
 </office:automatic-styles>
 <office:master-styles>
  <style:master-page style:name="Standard" style:page-layout-name="pm1"/>
 </office:master-styles>
 <office:body>
  <office:text text:use-soft-page-breaks="true">
   <office:forms form:automatic-focus="false" form:apply-design-mode="false"/>
   <text:sequence-decls>
    <text:sequence-decl text:display-outline-level="0" text:name="Illustration"/>
    <text:sequence-decl text:display-outline-level="0" text:name="Table"/>
    <text:sequence-decl text:display-outline-level="0" text:name="Text"/>
    <text:sequence-decl text:display-outline-level="0" text:name="Drawing"/>
    <text:sequence-decl text:display-outline-level="0" text:name="Figure"/>
   </text:sequence-decls>${lr}
  </office:text>
 </office:body>
</office:document>`,mimetype$3="application/vnd.oasis.opendocument.text",extension$3="fodt",whitemap={"<p>":'<text:p text:style-name="Standard">',"</p>":"</text:p>","<b>":'<text:span text:style-name="bold">',"</b>":"</text:span>","<i>":'<text:span text:style-name="italic">',"</i>":"</text:span>","<u>":'<text:span text:style-name="underline">',"</u>":"</text:span>",'<mage-link to="':'<text:a xlink:type="simple" text:style-name="Internet_20_link" text:visited-style-name="Visited_20_Internet_20_Link" xlink:href="#',"</mage-link>":"</text:a>"},whitelist$1=["<b>","</b>","<i>","</i>","<u>","</u>"],inlineRenderer$1=()=>({html:lr=>whitelist$1.includes(lr.trim().toLowerCase())?lr.trim().toLowerCase():mangle(lr),paragraph:lr=>`${lr}`,strong:lr=>`<b>${lr}</b>`,em:lr=>`<i>${lr}</i>`,codespan:()=>"",code:()=>"",link:()=>""}),renderer$2=(lr,or)=>({html:ar=>whitelist$1.includes(ar.trim().toLowerCase())?ar.trim().toLowerCase():mangle(ar),paragraph:ar=>`<p>${ar}</p>`,strong:ar=>`<b>${ar}</b>`,em:ar=>`<i>${ar}</i>`,br:()=>"</p><p>",codespan:ar=>"",code:(ar,cr)=>"",link:(ar,cr,ur)=>{const hr=ar.replace("#","").trim(),fr=or.renameAnchor({key:hr,book:lr}),dr=lr.index.keys[hr],pr=dr===void 0?void 0:lr.index.chapters[dr];return`<mage-link to="${fr}">${encodeToHTML(or.renameLink({book:lr,text:ur.trim(),chapter:pr,title:pr==null?void 0:pr.title,key:pr==null?void 0:pr.key}),inlineRenderer$1())}</mage-link>`}}),bookmark=(lr,or)=>`<text:span text:style-name="bold"><text:bookmark-start text:name="${lr}"/>${encodeToHTML(or,inlineRenderer$1())}<text:bookmark-end text:name="${lr}"/></text:span>`,sanitizeAndConvertToOpenOffice=lr=>{const or=document.createElement("p");or.innerHTML=lr,lr=or.innerHTML;for(const ar in whitemap)lr=lr.replaceAll(ar,whitemap[ar]);return lr},encode$3=lr=>{const or=bookify(lr),ar=sanitizeProperties(or.index.properties),cr=ar.titleStyle=="inline";let ur="";for(const[fr,{content:dr}]of chaptersOf(or)){if(fr.flags.includes("noexport"))continue;const{renamedKey:pr,renamedTitle:mr}=renameKeyAndTitle(ar,or,fr),gr=bookmark(pr,mr),yr=trimHTML(encodeToHTML(dr,renderer$2(or,ar)).replaceAll("<br>","</p><p>").trim()||"<p></p>"),br=sanitizeAndConvertToOpenOffice(yr);cr?ur+=br.replace(">",">"+gr+" "):ur+=`<text:p text:style-name="Heading_3" text:outline-level="3">${gr}</text:p>`+br,ur+='<text:p text:style-name="Standard"/>'}return{encodedBook:template$1(ur,ar).split(`
`).map(fr=>fr.trim()).join(""),mimetype:mimetype$3,extension:extension$3}},fodt=Object.freeze(Object.defineProperty({__proto__:null,encode:encode$3,extension:extension$3,mimetype:mimetype$3},Symbol.toStringTag,{value:"Module"}));var __defProp=Object.defineProperty,__defNormalProp=(lr,or,ar)=>or in lr?__defProp(lr,or,{enumerable:!0,configurable:!0,writable:!0,value:ar}):lr[or]=ar,__publicField=(lr,or,ar)=>(__defNormalProp(lr,typeof or!="symbol"?or+"":or,ar),ar);class BaseXmlComponent{constructor(or){__publicField(this,"rootKey"),this.rootKey=or}}const EMPTY_OBJECT=Object.seal({});class XmlComponent extends BaseXmlComponent{constructor(or){super(or),__publicField(this,"root"),this.root=new Array}prepForXml(or){var ar;or.stack.push(this);const cr=this.root.map(ur=>ur instanceof BaseXmlComponent?ur.prepForXml(or):ur).filter(ur=>ur!==void 0);return or.stack.pop(),{[this.rootKey]:cr.length?cr.length===1&&((ar=cr[0])!=null&&ar._attr)?cr[0]:cr:EMPTY_OBJECT}}addChildElement(or){return this.root.push(or),this}}class IgnoreIfEmptyXmlComponent extends XmlComponent{prepForXml(or){const ar=super.prepForXml(or);if(ar&&(typeof ar[this.rootKey]!="object"||Object.keys(ar[this.rootKey]).length))return ar}}class XmlAttributeComponent extends BaseXmlComponent{constructor(or){super("_attr"),__publicField(this,"xmlKeys"),this.root=or}prepForXml(or){const ar={};return Object.keys(this.root).forEach(cr=>{const ur=this.root[cr];if(ur!==void 0){const hr=this.xmlKeys&&this.xmlKeys[cr]||cr;ar[hr]=ur}}),{_attr:ar}}}class NextAttributeComponent extends BaseXmlComponent{constructor(or){super("_attr"),this.root=or}prepForXml(or){return{_attr:Object.values(this.root).filter(({value:cr})=>cr!==void 0).reduce((cr,{key:ur,value:hr})=>({...cr,[ur]:hr}),{})}}}class Attributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(lr){return lr&&lr.__esModule&&Object.prototype.hasOwnProperty.call(lr,"default")?lr.default:lr}var sax$1={},events={exports:{}},R$1=typeof Reflect=="object"?Reflect:null,ReflectApply=R$1&&typeof R$1.apply=="function"?R$1.apply:function(or,ar,cr){return Function.prototype.apply.call(or,ar,cr)},ReflectOwnKeys;R$1&&typeof R$1.ownKeys=="function"?ReflectOwnKeys=R$1.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(or){return Object.getOwnPropertyNames(or).concat(Object.getOwnPropertySymbols(or))}:ReflectOwnKeys=function(or){return Object.getOwnPropertyNames(or)};function ProcessEmitWarning(lr){console&&console.warn&&console.warn(lr)}var NumberIsNaN=Number.isNaN||function(or){return or!==or};function EventEmitter(){EventEmitter.init.call(this)}events.exports=EventEmitter;events.exports.once=once2;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=void 0;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(lr){if(typeof lr!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof lr)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(lr){if(typeof lr!="number"||lr<0||NumberIsNaN(lr))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+lr+".");defaultMaxListeners=lr}});EventEmitter.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter.prototype.setMaxListeners=function(or){if(typeof or!="number"||or<0||NumberIsNaN(or))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+or+".");return this._maxListeners=or,this};function _getMaxListeners(lr){return lr._maxListeners===void 0?EventEmitter.defaultMaxListeners:lr._maxListeners}EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function(or){for(var ar=[],cr=1;cr<arguments.length;cr++)ar.push(arguments[cr]);var ur=or==="error",hr=this._events;if(hr!==void 0)ur=ur&&hr.error===void 0;else if(!ur)return!1;if(ur){var fr;if(ar.length>0&&(fr=ar[0]),fr instanceof Error)throw fr;var dr=new Error("Unhandled error."+(fr?" ("+fr.message+")":""));throw dr.context=fr,dr}var pr=hr[or];if(pr===void 0)return!1;if(typeof pr=="function")ReflectApply(pr,this,ar);else for(var mr=pr.length,gr=arrayClone(pr,mr),cr=0;cr<mr;++cr)ReflectApply(gr[cr],this,ar);return!0};function _addListener(lr,or,ar,cr){var ur,hr,fr;if(checkListener(ar),hr=lr._events,hr===void 0?(hr=lr._events=Object.create(null),lr._eventsCount=0):(hr.newListener!==void 0&&(lr.emit("newListener",or,ar.listener?ar.listener:ar),hr=lr._events),fr=hr[or]),fr===void 0)fr=hr[or]=ar,++lr._eventsCount;else if(typeof fr=="function"?fr=hr[or]=cr?[ar,fr]:[fr,ar]:cr?fr.unshift(ar):fr.push(ar),ur=_getMaxListeners(lr),ur>0&&fr.length>ur&&!fr.warned){fr.warned=!0;var dr=new Error("Possible EventEmitter memory leak detected. "+fr.length+" "+String(or)+" listeners added. Use emitter.setMaxListeners() to increase limit");dr.name="MaxListenersExceededWarning",dr.emitter=lr,dr.type=or,dr.count=fr.length,ProcessEmitWarning(dr)}return lr}EventEmitter.prototype.addListener=function(or,ar){return _addListener(this,or,ar,!1)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function(or,ar){return _addListener(this,or,ar,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(lr,or,ar){var cr={fired:!1,wrapFn:void 0,target:lr,type:or,listener:ar},ur=onceWrapper.bind(cr);return ur.listener=ar,cr.wrapFn=ur,ur}EventEmitter.prototype.once=function(or,ar){return checkListener(ar),this.on(or,_onceWrap(this,or,ar)),this};EventEmitter.prototype.prependOnceListener=function(or,ar){return checkListener(ar),this.prependListener(or,_onceWrap(this,or,ar)),this};EventEmitter.prototype.removeListener=function(or,ar){var cr,ur,hr,fr,dr;if(checkListener(ar),ur=this._events,ur===void 0)return this;if(cr=ur[or],cr===void 0)return this;if(cr===ar||cr.listener===ar)--this._eventsCount===0?this._events=Object.create(null):(delete ur[or],ur.removeListener&&this.emit("removeListener",or,cr.listener||ar));else if(typeof cr!="function"){for(hr=-1,fr=cr.length-1;fr>=0;fr--)if(cr[fr]===ar||cr[fr].listener===ar){dr=cr[fr].listener,hr=fr;break}if(hr<0)return this;hr===0?cr.shift():spliceOne(cr,hr),cr.length===1&&(ur[or]=cr[0]),ur.removeListener!==void 0&&this.emit("removeListener",or,dr||ar)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function(or){var ar,cr,ur;if(cr=this._events,cr===void 0)return this;if(cr.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):cr[or]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete cr[or]),this;if(arguments.length===0){var hr=Object.keys(cr),fr;for(ur=0;ur<hr.length;++ur)fr=hr[ur],fr!=="removeListener"&&this.removeAllListeners(fr);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(ar=cr[or],typeof ar=="function")this.removeListener(or,ar);else if(ar!==void 0)for(ur=ar.length-1;ur>=0;ur--)this.removeListener(or,ar[ur]);return this};function _listeners(lr,or,ar){var cr=lr._events;if(cr===void 0)return[];var ur=cr[or];return ur===void 0?[]:typeof ur=="function"?ar?[ur.listener||ur]:[ur]:ar?unwrapListeners(ur):arrayClone(ur,ur.length)}EventEmitter.prototype.listeners=function(or){return _listeners(this,or,!0)};EventEmitter.prototype.rawListeners=function(or){return _listeners(this,or,!1)};EventEmitter.listenerCount=function(lr,or){return typeof lr.listenerCount=="function"?lr.listenerCount(or):listenerCount.call(lr,or)};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(lr){var or=this._events;if(or!==void 0){var ar=or[lr];if(typeof ar=="function")return 1;if(ar!==void 0)return ar.length}return 0}EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(lr,or){for(var ar=new Array(or),cr=0;cr<or;++cr)ar[cr]=lr[cr];return ar}function spliceOne(lr,or){for(;or+1<lr.length;or++)lr[or]=lr[or+1];lr.pop()}function unwrapListeners(lr){for(var or=new Array(lr.length),ar=0;ar<or.length;++ar)or[ar]=lr[ar].listener||lr[ar];return or}function once2(lr,or){return new Promise(function(ar,cr){function ur(fr){lr.removeListener(or,hr),cr(fr)}function hr(){typeof lr.removeListener=="function"&&lr.removeListener("error",ur),ar([].slice.call(arguments))}eventTargetAgnosticAddListener(lr,or,hr,{once:!0}),or!=="error"&&addErrorHandlerIfEventEmitter(lr,ur,{once:!0})})}function addErrorHandlerIfEventEmitter(lr,or,ar){typeof lr.on=="function"&&eventTargetAgnosticAddListener(lr,"error",or,ar)}function eventTargetAgnosticAddListener(lr,or,ar,cr){if(typeof lr.on=="function")cr.once?lr.once(or,ar):lr.on(or,ar);else if(typeof lr.addEventListener=="function")lr.addEventListener(or,function ur(hr){cr.once&&lr.removeEventListener(or,ur),ar(hr)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof lr)}var eventsExports=events.exports,inherits_browser={exports:{}};typeof Object.create=="function"?inherits_browser.exports=function(or,ar){ar&&(or.super_=ar,or.prototype=Object.create(ar.prototype,{constructor:{value:or,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(or,ar){if(ar){or.super_=ar;var cr=function(){};cr.prototype=ar.prototype,or.prototype=new cr,or.prototype.constructor=or}};var inherits_browserExports=inherits_browser.exports,buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=dr,base64Js.toByteArray=mr,base64Js.fromByteArray=br;for(var lr=[],or=[],ar=typeof Uint8Array<"u"?Uint8Array:Array,cr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ur=0,hr=cr.length;ur<hr;++ur)lr[ur]=cr[ur],or[cr.charCodeAt(ur)]=ur;or["-".charCodeAt(0)]=62,or["_".charCodeAt(0)]=63;function fr(Or){var _r=Or.length;if(_r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var vr=Or.indexOf("=");vr===-1&&(vr=_r);var xr=vr===_r?0:4-vr%4;return[vr,xr]}function dr(Or){var _r=fr(Or),vr=_r[0],xr=_r[1];return(vr+xr)*3/4-xr}function pr(Or,_r,vr){return(_r+vr)*3/4-vr}function mr(Or){var _r,vr=fr(Or),xr=vr[0],wr=vr[1],kr=new ar(pr(Or,xr,wr)),Cr=0,$r=wr>0?xr-4:xr,Nr;for(Nr=0;Nr<$r;Nr+=4)_r=or[Or.charCodeAt(Nr)]<<18|or[Or.charCodeAt(Nr+1)]<<12|or[Or.charCodeAt(Nr+2)]<<6|or[Or.charCodeAt(Nr+3)],kr[Cr++]=_r>>16&255,kr[Cr++]=_r>>8&255,kr[Cr++]=_r&255;return wr===2&&(_r=or[Or.charCodeAt(Nr)]<<2|or[Or.charCodeAt(Nr+1)]>>4,kr[Cr++]=_r&255),wr===1&&(_r=or[Or.charCodeAt(Nr)]<<10|or[Or.charCodeAt(Nr+1)]<<4|or[Or.charCodeAt(Nr+2)]>>2,kr[Cr++]=_r>>8&255,kr[Cr++]=_r&255),kr}function gr(Or){return lr[Or>>18&63]+lr[Or>>12&63]+lr[Or>>6&63]+lr[Or&63]}function yr(Or,_r,vr){for(var xr,wr=[],kr=_r;kr<vr;kr+=3)xr=(Or[kr]<<16&16711680)+(Or[kr+1]<<8&65280)+(Or[kr+2]&255),wr.push(gr(xr));return wr.join("")}function br(Or){for(var _r,vr=Or.length,xr=vr%3,wr=[],kr=16383,Cr=0,$r=vr-xr;Cr<$r;Cr+=kr)wr.push(yr(Or,Cr,Cr+kr>$r?$r:Cr+kr));return xr===1?(_r=Or[vr-1],wr.push(lr[_r>>2]+lr[_r<<4&63]+"==")):xr===2&&(_r=(Or[vr-2]<<8)+Or[vr-1],wr.push(lr[_r>>10]+lr[_r>>4&63]+lr[_r<<2&63]+"=")),wr.join("")}return base64Js}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(lr,or,ar,cr,ur){var hr,fr,dr=ur*8-cr-1,pr=(1<<dr)-1,mr=pr>>1,gr=-7,yr=ar?ur-1:0,br=ar?-1:1,Or=lr[or+yr];for(yr+=br,hr=Or&(1<<-gr)-1,Or>>=-gr,gr+=dr;gr>0;hr=hr*256+lr[or+yr],yr+=br,gr-=8);for(fr=hr&(1<<-gr)-1,hr>>=-gr,gr+=cr;gr>0;fr=fr*256+lr[or+yr],yr+=br,gr-=8);if(hr===0)hr=1-mr;else{if(hr===pr)return fr?NaN:(Or?-1:1)*(1/0);fr=fr+Math.pow(2,cr),hr=hr-mr}return(Or?-1:1)*fr*Math.pow(2,hr-cr)},ieee754.write=function(lr,or,ar,cr,ur,hr){var fr,dr,pr,mr=hr*8-ur-1,gr=(1<<mr)-1,yr=gr>>1,br=ur===23?Math.pow(2,-24)-Math.pow(2,-77):0,Or=cr?0:hr-1,_r=cr?1:-1,vr=or<0||or===0&&1/or<0?1:0;for(or=Math.abs(or),isNaN(or)||or===1/0?(dr=isNaN(or)?1:0,fr=gr):(fr=Math.floor(Math.log(or)/Math.LN2),or*(pr=Math.pow(2,-fr))<1&&(fr--,pr*=2),fr+yr>=1?or+=br/pr:or+=br*Math.pow(2,1-yr),or*pr>=2&&(fr++,pr/=2),fr+yr>=gr?(dr=0,fr=gr):fr+yr>=1?(dr=(or*pr-1)*Math.pow(2,ur),fr=fr+yr):(dr=or*Math.pow(2,yr-1)*Math.pow(2,ur),fr=0));ur>=8;lr[ar+Or]=dr&255,Or+=_r,dr/=256,ur-=8);for(fr=fr<<ur|dr,mr+=ur;mr>0;lr[ar+Or]=fr&255,Or+=_r,fr/=256,mr-=8);lr[ar+Or-_r]|=vr*128}),ieee754}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,function(lr){var or=requireBase64Js(),ar=requireIeee754(),cr=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;lr.Buffer=dr,lr.SlowBuffer=kr,lr.INSPECT_MAX_BYTES=50;var ur=2147483647;lr.kMaxLength=ur,dr.TYPED_ARRAY_SUPPORT=hr(),!dr.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function hr(){try{var Tr=new Uint8Array(1),Sr={foo:function(){return 42}};return Object.setPrototypeOf(Sr,Uint8Array.prototype),Object.setPrototypeOf(Tr,Sr),Tr.foo()===42}catch{return!1}}Object.defineProperty(dr.prototype,"parent",{enumerable:!0,get:function(){if(dr.isBuffer(this))return this.buffer}}),Object.defineProperty(dr.prototype,"offset",{enumerable:!0,get:function(){if(dr.isBuffer(this))return this.byteOffset}});function fr(Tr){if(Tr>ur)throw new RangeError('The value "'+Tr+'" is invalid for option "size"');var Sr=new Uint8Array(Tr);return Object.setPrototypeOf(Sr,dr.prototype),Sr}function dr(Tr,Sr,Er){if(typeof Tr=="number"){if(typeof Sr=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return yr(Tr)}return pr(Tr,Sr,Er)}dr.poolSize=8192;function pr(Tr,Sr,Er){if(typeof Tr=="string")return br(Tr,Sr);if(ArrayBuffer.isView(Tr))return _r(Tr);if(Tr==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Tr);if(ri(Tr,ArrayBuffer)||Tr&&ri(Tr.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ri(Tr,SharedArrayBuffer)||Tr&&ri(Tr.buffer,SharedArrayBuffer)))return vr(Tr,Sr,Er);if(typeof Tr=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Ir=Tr.valueOf&&Tr.valueOf();if(Ir!=null&&Ir!==Tr)return dr.from(Ir,Sr,Er);var Qr=xr(Tr);if(Qr)return Qr;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Tr[Symbol.toPrimitive]=="function")return dr.from(Tr[Symbol.toPrimitive]("string"),Sr,Er);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Tr)}dr.from=function(Tr,Sr,Er){return pr(Tr,Sr,Er)},Object.setPrototypeOf(dr.prototype,Uint8Array.prototype),Object.setPrototypeOf(dr,Uint8Array);function mr(Tr){if(typeof Tr!="number")throw new TypeError('"size" argument must be of type number');if(Tr<0)throw new RangeError('The value "'+Tr+'" is invalid for option "size"')}function gr(Tr,Sr,Er){return mr(Tr),Tr<=0?fr(Tr):Sr!==void 0?typeof Er=="string"?fr(Tr).fill(Sr,Er):fr(Tr).fill(Sr):fr(Tr)}dr.alloc=function(Tr,Sr,Er){return gr(Tr,Sr,Er)};function yr(Tr){return mr(Tr),fr(Tr<0?0:wr(Tr)|0)}dr.allocUnsafe=function(Tr){return yr(Tr)},dr.allocUnsafeSlow=function(Tr){return yr(Tr)};function br(Tr,Sr){if((typeof Sr!="string"||Sr==="")&&(Sr="utf8"),!dr.isEncoding(Sr))throw new TypeError("Unknown encoding: "+Sr);var Er=Cr(Tr,Sr)|0,Ir=fr(Er),Qr=Ir.write(Tr,Sr);return Qr!==Er&&(Ir=Ir.slice(0,Qr)),Ir}function Or(Tr){for(var Sr=Tr.length<0?0:wr(Tr.length)|0,Er=fr(Sr),Ir=0;Ir<Sr;Ir+=1)Er[Ir]=Tr[Ir]&255;return Er}function _r(Tr){if(ri(Tr,Uint8Array)){var Sr=new Uint8Array(Tr);return vr(Sr.buffer,Sr.byteOffset,Sr.byteLength)}return Or(Tr)}function vr(Tr,Sr,Er){if(Sr<0||Tr.byteLength<Sr)throw new RangeError('"offset" is outside of buffer bounds');if(Tr.byteLength<Sr+(Er||0))throw new RangeError('"length" is outside of buffer bounds');var Ir;return Sr===void 0&&Er===void 0?Ir=new Uint8Array(Tr):Er===void 0?Ir=new Uint8Array(Tr,Sr):Ir=new Uint8Array(Tr,Sr,Er),Object.setPrototypeOf(Ir,dr.prototype),Ir}function xr(Tr){if(dr.isBuffer(Tr)){var Sr=wr(Tr.length)|0,Er=fr(Sr);return Er.length===0||Tr.copy(Er,0,0,Sr),Er}if(Tr.length!==void 0)return typeof Tr.length!="number"||Lr(Tr.length)?fr(0):Or(Tr);if(Tr.type==="Buffer"&&Array.isArray(Tr.data))return Or(Tr.data)}function wr(Tr){if(Tr>=ur)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ur.toString(16)+" bytes");return Tr|0}function kr(Tr){return+Tr!=Tr&&(Tr=0),dr.alloc(+Tr)}dr.isBuffer=function(Sr){return Sr!=null&&Sr._isBuffer===!0&&Sr!==dr.prototype},dr.compare=function(Sr,Er){if(ri(Sr,Uint8Array)&&(Sr=dr.from(Sr,Sr.offset,Sr.byteLength)),ri(Er,Uint8Array)&&(Er=dr.from(Er,Er.offset,Er.byteLength)),!dr.isBuffer(Sr)||!dr.isBuffer(Er))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Sr===Er)return 0;for(var Ir=Sr.length,Qr=Er.length,zr=0,Hr=Math.min(Ir,Qr);zr<Hr;++zr)if(Sr[zr]!==Er[zr]){Ir=Sr[zr],Qr=Er[zr];break}return Ir<Qr?-1:Qr<Ir?1:0},dr.isEncoding=function(Sr){switch(String(Sr).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},dr.concat=function(Sr,Er){if(!Array.isArray(Sr))throw new TypeError('"list" argument must be an Array of Buffers');if(Sr.length===0)return dr.alloc(0);var Ir;if(Er===void 0)for(Er=0,Ir=0;Ir<Sr.length;++Ir)Er+=Sr[Ir].length;var Qr=dr.allocUnsafe(Er),zr=0;for(Ir=0;Ir<Sr.length;++Ir){var Hr=Sr[Ir];if(ri(Hr,Uint8Array))zr+Hr.length>Qr.length?dr.from(Hr).copy(Qr,zr):Uint8Array.prototype.set.call(Qr,Hr,zr);else if(dr.isBuffer(Hr))Hr.copy(Qr,zr);else throw new TypeError('"list" argument must be an Array of Buffers');zr+=Hr.length}return Qr};function Cr(Tr,Sr){if(dr.isBuffer(Tr))return Tr.length;if(ArrayBuffer.isView(Tr)||ri(Tr,ArrayBuffer))return Tr.byteLength;if(typeof Tr!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Tr);var Er=Tr.length,Ir=arguments.length>2&&arguments[2]===!0;if(!Ir&&Er===0)return 0;for(var Qr=!1;;)switch(Sr){case"ascii":case"latin1":case"binary":return Er;case"utf8":case"utf-8":return Ar(Tr).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Er*2;case"hex":return Er>>>1;case"base64":return jr(Tr).length;default:if(Qr)return Ir?-1:Ar(Tr).length;Sr=(""+Sr).toLowerCase(),Qr=!0}}dr.byteLength=Cr;function $r(Tr,Sr,Er){var Ir=!1;if((Sr===void 0||Sr<0)&&(Sr=0),Sr>this.length||((Er===void 0||Er>this.length)&&(Er=this.length),Er<=0)||(Er>>>=0,Sr>>>=0,Er<=Sr))return"";for(Tr||(Tr="utf8");;)switch(Tr){case"hex":return ii(this,Sr,Er);case"utf8":case"utf-8":return Dr(this,Sr,Er);case"ascii":return Kr(this,Sr,Er);case"latin1":case"binary":return ui(this,Sr,Er);case"base64":return Yr(this,Sr,Er);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return di(this,Sr,Er);default:if(Ir)throw new TypeError("Unknown encoding: "+Tr);Tr=(Tr+"").toLowerCase(),Ir=!0}}dr.prototype._isBuffer=!0;function Nr(Tr,Sr,Er){var Ir=Tr[Sr];Tr[Sr]=Tr[Er],Tr[Er]=Ir}dr.prototype.swap16=function(){var Sr=this.length;if(Sr%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Er=0;Er<Sr;Er+=2)Nr(this,Er,Er+1);return this},dr.prototype.swap32=function(){var Sr=this.length;if(Sr%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Er=0;Er<Sr;Er+=4)Nr(this,Er,Er+3),Nr(this,Er+1,Er+2);return this},dr.prototype.swap64=function(){var Sr=this.length;if(Sr%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Er=0;Er<Sr;Er+=8)Nr(this,Er,Er+7),Nr(this,Er+1,Er+6),Nr(this,Er+2,Er+5),Nr(this,Er+3,Er+4);return this},dr.prototype.toString=function(){var Sr=this.length;return Sr===0?"":arguments.length===0?Dr(this,0,Sr):$r.apply(this,arguments)},dr.prototype.toLocaleString=dr.prototype.toString,dr.prototype.equals=function(Sr){if(!dr.isBuffer(Sr))throw new TypeError("Argument must be a Buffer");return this===Sr?!0:dr.compare(this,Sr)===0},dr.prototype.inspect=function(){var Sr="",Er=lr.INSPECT_MAX_BYTES;return Sr=this.toString("hex",0,Er).replace(/(.{2})/g,"$1 ").trim(),this.length>Er&&(Sr+=" ... "),"<Buffer "+Sr+">"},cr&&(dr.prototype[cr]=dr.prototype.inspect),dr.prototype.compare=function(Sr,Er,Ir,Qr,zr){if(ri(Sr,Uint8Array)&&(Sr=dr.from(Sr,Sr.offset,Sr.byteLength)),!dr.isBuffer(Sr))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Sr);if(Er===void 0&&(Er=0),Ir===void 0&&(Ir=Sr?Sr.length:0),Qr===void 0&&(Qr=0),zr===void 0&&(zr=this.length),Er<0||Ir>Sr.length||Qr<0||zr>this.length)throw new RangeError("out of range index");if(Qr>=zr&&Er>=Ir)return 0;if(Qr>=zr)return-1;if(Er>=Ir)return 1;if(Er>>>=0,Ir>>>=0,Qr>>>=0,zr>>>=0,this===Sr)return 0;for(var Hr=zr-Qr,li=Ir-Er,pi=Math.min(Hr,li),hi=this.slice(Qr,zr),fi=Sr.slice(Er,Ir),mi=0;mi<pi;++mi)if(hi[mi]!==fi[mi]){Hr=hi[mi],li=fi[mi];break}return Hr<li?-1:li<Hr?1:0};function Br(Tr,Sr,Er,Ir,Qr){if(Tr.length===0)return-1;if(typeof Er=="string"?(Ir=Er,Er=0):Er>2147483647?Er=2147483647:Er<-2147483648&&(Er=-2147483648),Er=+Er,Lr(Er)&&(Er=Qr?0:Tr.length-1),Er<0&&(Er=Tr.length+Er),Er>=Tr.length){if(Qr)return-1;Er=Tr.length-1}else if(Er<0)if(Qr)Er=0;else return-1;if(typeof Sr=="string"&&(Sr=dr.from(Sr,Ir)),dr.isBuffer(Sr))return Sr.length===0?-1:Fr(Tr,Sr,Er,Ir,Qr);if(typeof Sr=="number")return Sr=Sr&255,typeof Uint8Array.prototype.indexOf=="function"?Qr?Uint8Array.prototype.indexOf.call(Tr,Sr,Er):Uint8Array.prototype.lastIndexOf.call(Tr,Sr,Er):Fr(Tr,[Sr],Er,Ir,Qr);throw new TypeError("val must be string, number or Buffer")}function Fr(Tr,Sr,Er,Ir,Qr){var zr=1,Hr=Tr.length,li=Sr.length;if(Ir!==void 0&&(Ir=String(Ir).toLowerCase(),Ir==="ucs2"||Ir==="ucs-2"||Ir==="utf16le"||Ir==="utf-16le")){if(Tr.length<2||Sr.length<2)return-1;zr=2,Hr/=2,li/=2,Er/=2}function pi(_i,yi){return zr===1?_i[yi]:_i.readUInt16BE(yi*zr)}var hi;if(Qr){var fi=-1;for(hi=Er;hi<Hr;hi++)if(pi(Tr,hi)===pi(Sr,fi===-1?0:hi-fi)){if(fi===-1&&(fi=hi),hi-fi+1===li)return fi*zr}else fi!==-1&&(hi-=hi-fi),fi=-1}else for(Er+li>Hr&&(Er=Hr-li),hi=Er;hi>=0;hi--){for(var mi=!0,gi=0;gi<li;gi++)if(pi(Tr,hi+gi)!==pi(Sr,gi)){mi=!1;break}if(mi)return hi}return-1}dr.prototype.includes=function(Sr,Er,Ir){return this.indexOf(Sr,Er,Ir)!==-1},dr.prototype.indexOf=function(Sr,Er,Ir){return Br(this,Sr,Er,Ir,!0)},dr.prototype.lastIndexOf=function(Sr,Er,Ir){return Br(this,Sr,Er,Ir,!1)};function Vr(Tr,Sr,Er,Ir){Er=Number(Er)||0;var Qr=Tr.length-Er;Ir?(Ir=Number(Ir),Ir>Qr&&(Ir=Qr)):Ir=Qr;var zr=Sr.length;Ir>zr/2&&(Ir=zr/2);for(var Hr=0;Hr<Ir;++Hr){var li=parseInt(Sr.substr(Hr*2,2),16);if(Lr(li))return Hr;Tr[Er+Hr]=li}return Hr}function Rr(Tr,Sr,Er,Ir){return Xr(Ar(Sr,Tr.length-Er),Tr,Er,Ir)}function Gr(Tr,Sr,Er,Ir){return Xr(Zr(Sr),Tr,Er,Ir)}function qr(Tr,Sr,Er,Ir){return Xr(jr(Sr),Tr,Er,Ir)}function Ur(Tr,Sr,Er,Ir){return Xr(Mr(Sr,Tr.length-Er),Tr,Er,Ir)}dr.prototype.write=function(Sr,Er,Ir,Qr){if(Er===void 0)Qr="utf8",Ir=this.length,Er=0;else if(Ir===void 0&&typeof Er=="string")Qr=Er,Ir=this.length,Er=0;else if(isFinite(Er))Er=Er>>>0,isFinite(Ir)?(Ir=Ir>>>0,Qr===void 0&&(Qr="utf8")):(Qr=Ir,Ir=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var zr=this.length-Er;if((Ir===void 0||Ir>zr)&&(Ir=zr),Sr.length>0&&(Ir<0||Er<0)||Er>this.length)throw new RangeError("Attempt to write outside buffer bounds");Qr||(Qr="utf8");for(var Hr=!1;;)switch(Qr){case"hex":return Vr(this,Sr,Er,Ir);case"utf8":case"utf-8":return Rr(this,Sr,Er,Ir);case"ascii":case"latin1":case"binary":return Gr(this,Sr,Er,Ir);case"base64":return qr(this,Sr,Er,Ir);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ur(this,Sr,Er,Ir);default:if(Hr)throw new TypeError("Unknown encoding: "+Qr);Qr=(""+Qr).toLowerCase(),Hr=!0}},dr.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Yr(Tr,Sr,Er){return Sr===0&&Er===Tr.length?or.fromByteArray(Tr):or.fromByteArray(Tr.slice(Sr,Er))}function Dr(Tr,Sr,Er){Er=Math.min(Tr.length,Er);for(var Ir=[],Qr=Sr;Qr<Er;){var zr=Tr[Qr],Hr=null,li=zr>239?4:zr>223?3:zr>191?2:1;if(Qr+li<=Er){var pi,hi,fi,mi;switch(li){case 1:zr<128&&(Hr=zr);break;case 2:pi=Tr[Qr+1],(pi&192)===128&&(mi=(zr&31)<<6|pi&63,mi>127&&(Hr=mi));break;case 3:pi=Tr[Qr+1],hi=Tr[Qr+2],(pi&192)===128&&(hi&192)===128&&(mi=(zr&15)<<12|(pi&63)<<6|hi&63,mi>2047&&(mi<55296||mi>57343)&&(Hr=mi));break;case 4:pi=Tr[Qr+1],hi=Tr[Qr+2],fi=Tr[Qr+3],(pi&192)===128&&(hi&192)===128&&(fi&192)===128&&(mi=(zr&15)<<18|(pi&63)<<12|(hi&63)<<6|fi&63,mi>65535&&mi<1114112&&(Hr=mi))}}Hr===null?(Hr=65533,li=1):Hr>65535&&(Hr-=65536,Ir.push(Hr>>>10&1023|55296),Hr=56320|Hr&1023),Ir.push(Hr),Qr+=li}return ai(Ir)}var Jr=4096;function ai(Tr){var Sr=Tr.length;if(Sr<=Jr)return String.fromCharCode.apply(String,Tr);for(var Er="",Ir=0;Ir<Sr;)Er+=String.fromCharCode.apply(String,Tr.slice(Ir,Ir+=Jr));return Er}function Kr(Tr,Sr,Er){var Ir="";Er=Math.min(Tr.length,Er);for(var Qr=Sr;Qr<Er;++Qr)Ir+=String.fromCharCode(Tr[Qr]&127);return Ir}function ui(Tr,Sr,Er){var Ir="";Er=Math.min(Tr.length,Er);for(var Qr=Sr;Qr<Er;++Qr)Ir+=String.fromCharCode(Tr[Qr]);return Ir}function ii(Tr,Sr,Er){var Ir=Tr.length;(!Sr||Sr<0)&&(Sr=0),(!Er||Er<0||Er>Ir)&&(Er=Ir);for(var Qr="",zr=Sr;zr<Er;++zr)Qr+=oi[Tr[zr]];return Qr}function di(Tr,Sr,Er){for(var Ir=Tr.slice(Sr,Er),Qr="",zr=0;zr<Ir.length-1;zr+=2)Qr+=String.fromCharCode(Ir[zr]+Ir[zr+1]*256);return Qr}dr.prototype.slice=function(Sr,Er){var Ir=this.length;Sr=~~Sr,Er=Er===void 0?Ir:~~Er,Sr<0?(Sr+=Ir,Sr<0&&(Sr=0)):Sr>Ir&&(Sr=Ir),Er<0?(Er+=Ir,Er<0&&(Er=0)):Er>Ir&&(Er=Ir),Er<Sr&&(Er=Sr);var Qr=this.subarray(Sr,Er);return Object.setPrototypeOf(Qr,dr.prototype),Qr};function ei(Tr,Sr,Er){if(Tr%1!==0||Tr<0)throw new RangeError("offset is not uint");if(Tr+Sr>Er)throw new RangeError("Trying to access beyond buffer length")}dr.prototype.readUintLE=dr.prototype.readUIntLE=function(Sr,Er,Ir){Sr=Sr>>>0,Er=Er>>>0,Ir||ei(Sr,Er,this.length);for(var Qr=this[Sr],zr=1,Hr=0;++Hr<Er&&(zr*=256);)Qr+=this[Sr+Hr]*zr;return Qr},dr.prototype.readUintBE=dr.prototype.readUIntBE=function(Sr,Er,Ir){Sr=Sr>>>0,Er=Er>>>0,Ir||ei(Sr,Er,this.length);for(var Qr=this[Sr+--Er],zr=1;Er>0&&(zr*=256);)Qr+=this[Sr+--Er]*zr;return Qr},dr.prototype.readUint8=dr.prototype.readUInt8=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,1,this.length),this[Sr]},dr.prototype.readUint16LE=dr.prototype.readUInt16LE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,2,this.length),this[Sr]|this[Sr+1]<<8},dr.prototype.readUint16BE=dr.prototype.readUInt16BE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,2,this.length),this[Sr]<<8|this[Sr+1]},dr.prototype.readUint32LE=dr.prototype.readUInt32LE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,4,this.length),(this[Sr]|this[Sr+1]<<8|this[Sr+2]<<16)+this[Sr+3]*16777216},dr.prototype.readUint32BE=dr.prototype.readUInt32BE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,4,this.length),this[Sr]*16777216+(this[Sr+1]<<16|this[Sr+2]<<8|this[Sr+3])},dr.prototype.readIntLE=function(Sr,Er,Ir){Sr=Sr>>>0,Er=Er>>>0,Ir||ei(Sr,Er,this.length);for(var Qr=this[Sr],zr=1,Hr=0;++Hr<Er&&(zr*=256);)Qr+=this[Sr+Hr]*zr;return zr*=128,Qr>=zr&&(Qr-=Math.pow(2,8*Er)),Qr},dr.prototype.readIntBE=function(Sr,Er,Ir){Sr=Sr>>>0,Er=Er>>>0,Ir||ei(Sr,Er,this.length);for(var Qr=Er,zr=1,Hr=this[Sr+--Qr];Qr>0&&(zr*=256);)Hr+=this[Sr+--Qr]*zr;return zr*=128,Hr>=zr&&(Hr-=Math.pow(2,8*Er)),Hr},dr.prototype.readInt8=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,1,this.length),this[Sr]&128?(255-this[Sr]+1)*-1:this[Sr]},dr.prototype.readInt16LE=function(Sr,Er){Sr=Sr>>>0,Er||ei(Sr,2,this.length);var Ir=this[Sr]|this[Sr+1]<<8;return Ir&32768?Ir|4294901760:Ir},dr.prototype.readInt16BE=function(Sr,Er){Sr=Sr>>>0,Er||ei(Sr,2,this.length);var Ir=this[Sr+1]|this[Sr]<<8;return Ir&32768?Ir|4294901760:Ir},dr.prototype.readInt32LE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,4,this.length),this[Sr]|this[Sr+1]<<8|this[Sr+2]<<16|this[Sr+3]<<24},dr.prototype.readInt32BE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,4,this.length),this[Sr]<<24|this[Sr+1]<<16|this[Sr+2]<<8|this[Sr+3]},dr.prototype.readFloatLE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,4,this.length),ar.read(this,Sr,!0,23,4)},dr.prototype.readFloatBE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,4,this.length),ar.read(this,Sr,!1,23,4)},dr.prototype.readDoubleLE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,8,this.length),ar.read(this,Sr,!0,52,8)},dr.prototype.readDoubleBE=function(Sr,Er){return Sr=Sr>>>0,Er||ei(Sr,8,this.length),ar.read(this,Sr,!1,52,8)};function Wr(Tr,Sr,Er,Ir,Qr,zr){if(!dr.isBuffer(Tr))throw new TypeError('"buffer" argument must be a Buffer instance');if(Sr>Qr||Sr<zr)throw new RangeError('"value" argument is out of bounds');if(Er+Ir>Tr.length)throw new RangeError("Index out of range")}dr.prototype.writeUintLE=dr.prototype.writeUIntLE=function(Sr,Er,Ir,Qr){if(Sr=+Sr,Er=Er>>>0,Ir=Ir>>>0,!Qr){var zr=Math.pow(2,8*Ir)-1;Wr(this,Sr,Er,Ir,zr,0)}var Hr=1,li=0;for(this[Er]=Sr&255;++li<Ir&&(Hr*=256);)this[Er+li]=Sr/Hr&255;return Er+Ir},dr.prototype.writeUintBE=dr.prototype.writeUIntBE=function(Sr,Er,Ir,Qr){if(Sr=+Sr,Er=Er>>>0,Ir=Ir>>>0,!Qr){var zr=Math.pow(2,8*Ir)-1;Wr(this,Sr,Er,Ir,zr,0)}var Hr=Ir-1,li=1;for(this[Er+Hr]=Sr&255;--Hr>=0&&(li*=256);)this[Er+Hr]=Sr/li&255;return Er+Ir},dr.prototype.writeUint8=dr.prototype.writeUInt8=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,1,255,0),this[Er]=Sr&255,Er+1},dr.prototype.writeUint16LE=dr.prototype.writeUInt16LE=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,2,65535,0),this[Er]=Sr&255,this[Er+1]=Sr>>>8,Er+2},dr.prototype.writeUint16BE=dr.prototype.writeUInt16BE=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,2,65535,0),this[Er]=Sr>>>8,this[Er+1]=Sr&255,Er+2},dr.prototype.writeUint32LE=dr.prototype.writeUInt32LE=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,4,4294967295,0),this[Er+3]=Sr>>>24,this[Er+2]=Sr>>>16,this[Er+1]=Sr>>>8,this[Er]=Sr&255,Er+4},dr.prototype.writeUint32BE=dr.prototype.writeUInt32BE=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,4,4294967295,0),this[Er]=Sr>>>24,this[Er+1]=Sr>>>16,this[Er+2]=Sr>>>8,this[Er+3]=Sr&255,Er+4},dr.prototype.writeIntLE=function(Sr,Er,Ir,Qr){if(Sr=+Sr,Er=Er>>>0,!Qr){var zr=Math.pow(2,8*Ir-1);Wr(this,Sr,Er,Ir,zr-1,-zr)}var Hr=0,li=1,pi=0;for(this[Er]=Sr&255;++Hr<Ir&&(li*=256);)Sr<0&&pi===0&&this[Er+Hr-1]!==0&&(pi=1),this[Er+Hr]=(Sr/li>>0)-pi&255;return Er+Ir},dr.prototype.writeIntBE=function(Sr,Er,Ir,Qr){if(Sr=+Sr,Er=Er>>>0,!Qr){var zr=Math.pow(2,8*Ir-1);Wr(this,Sr,Er,Ir,zr-1,-zr)}var Hr=Ir-1,li=1,pi=0;for(this[Er+Hr]=Sr&255;--Hr>=0&&(li*=256);)Sr<0&&pi===0&&this[Er+Hr+1]!==0&&(pi=1),this[Er+Hr]=(Sr/li>>0)-pi&255;return Er+Ir},dr.prototype.writeInt8=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,1,127,-128),Sr<0&&(Sr=255+Sr+1),this[Er]=Sr&255,Er+1},dr.prototype.writeInt16LE=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,2,32767,-32768),this[Er]=Sr&255,this[Er+1]=Sr>>>8,Er+2},dr.prototype.writeInt16BE=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,2,32767,-32768),this[Er]=Sr>>>8,this[Er+1]=Sr&255,Er+2},dr.prototype.writeInt32LE=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,4,2147483647,-2147483648),this[Er]=Sr&255,this[Er+1]=Sr>>>8,this[Er+2]=Sr>>>16,this[Er+3]=Sr>>>24,Er+4},dr.prototype.writeInt32BE=function(Sr,Er,Ir){return Sr=+Sr,Er=Er>>>0,Ir||Wr(this,Sr,Er,4,2147483647,-2147483648),Sr<0&&(Sr=4294967295+Sr+1),this[Er]=Sr>>>24,this[Er+1]=Sr>>>16,this[Er+2]=Sr>>>8,this[Er+3]=Sr&255,Er+4};function ti(Tr,Sr,Er,Ir,Qr,zr){if(Er+Ir>Tr.length)throw new RangeError("Index out of range");if(Er<0)throw new RangeError("Index out of range")}function si(Tr,Sr,Er,Ir,Qr){return Sr=+Sr,Er=Er>>>0,Qr||ti(Tr,Sr,Er,4),ar.write(Tr,Sr,Er,Ir,23,4),Er+4}dr.prototype.writeFloatLE=function(Sr,Er,Ir){return si(this,Sr,Er,!0,Ir)},dr.prototype.writeFloatBE=function(Sr,Er,Ir){return si(this,Sr,Er,!1,Ir)};function ci(Tr,Sr,Er,Ir,Qr){return Sr=+Sr,Er=Er>>>0,Qr||ti(Tr,Sr,Er,8),ar.write(Tr,Sr,Er,Ir,52,8),Er+8}dr.prototype.writeDoubleLE=function(Sr,Er,Ir){return ci(this,Sr,Er,!0,Ir)},dr.prototype.writeDoubleBE=function(Sr,Er,Ir){return ci(this,Sr,Er,!1,Ir)},dr.prototype.copy=function(Sr,Er,Ir,Qr){if(!dr.isBuffer(Sr))throw new TypeError("argument should be a Buffer");if(Ir||(Ir=0),!Qr&&Qr!==0&&(Qr=this.length),Er>=Sr.length&&(Er=Sr.length),Er||(Er=0),Qr>0&&Qr<Ir&&(Qr=Ir),Qr===Ir||Sr.length===0||this.length===0)return 0;if(Er<0)throw new RangeError("targetStart out of bounds");if(Ir<0||Ir>=this.length)throw new RangeError("Index out of range");if(Qr<0)throw new RangeError("sourceEnd out of bounds");Qr>this.length&&(Qr=this.length),Sr.length-Er<Qr-Ir&&(Qr=Sr.length-Er+Ir);var zr=Qr-Ir;return this===Sr&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Er,Ir,Qr):Uint8Array.prototype.set.call(Sr,this.subarray(Ir,Qr),Er),zr},dr.prototype.fill=function(Sr,Er,Ir,Qr){if(typeof Sr=="string"){if(typeof Er=="string"?(Qr=Er,Er=0,Ir=this.length):typeof Ir=="string"&&(Qr=Ir,Ir=this.length),Qr!==void 0&&typeof Qr!="string")throw new TypeError("encoding must be a string");if(typeof Qr=="string"&&!dr.isEncoding(Qr))throw new TypeError("Unknown encoding: "+Qr);if(Sr.length===1){var zr=Sr.charCodeAt(0);(Qr==="utf8"&&zr<128||Qr==="latin1")&&(Sr=zr)}}else typeof Sr=="number"?Sr=Sr&255:typeof Sr=="boolean"&&(Sr=Number(Sr));if(Er<0||this.length<Er||this.length<Ir)throw new RangeError("Out of range index");if(Ir<=Er)return this;Er=Er>>>0,Ir=Ir===void 0?this.length:Ir>>>0,Sr||(Sr=0);var Hr;if(typeof Sr=="number")for(Hr=Er;Hr<Ir;++Hr)this[Hr]=Sr;else{var li=dr.isBuffer(Sr)?Sr:dr.from(Sr,Qr),pi=li.length;if(pi===0)throw new TypeError('The value "'+Sr+'" is invalid for argument "value"');for(Hr=0;Hr<Ir-Er;++Hr)this[Hr+Er]=li[Hr%pi]}return this};var ni=/[^+/0-9A-Za-z-_]/g;function Pr(Tr){if(Tr=Tr.split("=")[0],Tr=Tr.trim().replace(ni,""),Tr.length<2)return"";for(;Tr.length%4!==0;)Tr=Tr+"=";return Tr}function Ar(Tr,Sr){Sr=Sr||1/0;for(var Er,Ir=Tr.length,Qr=null,zr=[],Hr=0;Hr<Ir;++Hr){if(Er=Tr.charCodeAt(Hr),Er>55295&&Er<57344){if(!Qr){if(Er>56319){(Sr-=3)>-1&&zr.push(239,191,189);continue}else if(Hr+1===Ir){(Sr-=3)>-1&&zr.push(239,191,189);continue}Qr=Er;continue}if(Er<56320){(Sr-=3)>-1&&zr.push(239,191,189),Qr=Er;continue}Er=(Qr-55296<<10|Er-56320)+65536}else Qr&&(Sr-=3)>-1&&zr.push(239,191,189);if(Qr=null,Er<128){if((Sr-=1)<0)break;zr.push(Er)}else if(Er<2048){if((Sr-=2)<0)break;zr.push(Er>>6|192,Er&63|128)}else if(Er<65536){if((Sr-=3)<0)break;zr.push(Er>>12|224,Er>>6&63|128,Er&63|128)}else if(Er<1114112){if((Sr-=4)<0)break;zr.push(Er>>18|240,Er>>12&63|128,Er>>6&63|128,Er&63|128)}else throw new Error("Invalid code point")}return zr}function Zr(Tr){for(var Sr=[],Er=0;Er<Tr.length;++Er)Sr.push(Tr.charCodeAt(Er)&255);return Sr}function Mr(Tr,Sr){for(var Er,Ir,Qr,zr=[],Hr=0;Hr<Tr.length&&!((Sr-=2)<0);++Hr)Er=Tr.charCodeAt(Hr),Ir=Er>>8,Qr=Er%256,zr.push(Qr),zr.push(Ir);return zr}function jr(Tr){return or.toByteArray(Pr(Tr))}function Xr(Tr,Sr,Er,Ir){for(var Qr=0;Qr<Ir&&!(Qr+Er>=Sr.length||Qr>=Tr.length);++Qr)Sr[Qr+Er]=Tr[Qr];return Qr}function ri(Tr,Sr){return Tr instanceof Sr||Tr!=null&&Tr.constructor!=null&&Tr.constructor.name!=null&&Tr.constructor.name===Sr.name}function Lr(Tr){return Tr!==Tr}var oi=function(){for(var Tr="0123456789abcdef",Sr=new Array(256),Er=0;Er<16;++Er)for(var Ir=Er*16,Qr=0;Qr<16;++Qr)Sr[Ir+Qr]=Tr[Er]+Tr[Qr];return Sr}()}(buffer)),buffer}requireBuffer();var browser$1={exports:{}},process$1=browser$1.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?cachedSetTimeout=setTimeout:cachedSetTimeout=defaultSetTimout}catch{cachedSetTimeout=defaultSetTimout}try{typeof clearTimeout=="function"?cachedClearTimeout=clearTimeout:cachedClearTimeout=defaultClearTimeout}catch{cachedClearTimeout=defaultClearTimeout}})();function runTimeout(lr){if(cachedSetTimeout===setTimeout)return setTimeout(lr,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(lr,0);try{return cachedSetTimeout(lr,0)}catch{try{return cachedSetTimeout.call(null,lr,0)}catch{return cachedSetTimeout.call(this,lr,0)}}}function runClearTimeout(lr){if(cachedClearTimeout===clearTimeout)return clearTimeout(lr);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(lr);try{return cachedClearTimeout(lr)}catch{try{return cachedClearTimeout.call(null,lr)}catch{return cachedClearTimeout.call(this,lr)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var lr=runTimeout(cleanUpNextTick);draining=!0;for(var or=queue.length;or;){for(currentQueue=queue,queue=[];++queueIndex<or;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,or=queue.length}currentQueue=null,draining=!1,runClearTimeout(lr)}}process$1.nextTick=function(lr){var or=new Array(arguments.length-1);if(arguments.length>1)for(var ar=1;ar<arguments.length;ar++)or[ar-1]=arguments[ar];queue.push(new Item(lr,or)),queue.length===1&&!draining&&runTimeout(drainQueue)};function Item(lr,or){this.fun=lr,this.array=or}Item.prototype.run=function(){this.fun.apply(null,this.array)};process$1.title="browser";process$1.browser=!0;process$1.env={};process$1.argv=[];process$1.version="";process$1.versions={};function noop(){}process$1.on=noop;process$1.addListener=noop;process$1.once=noop;process$1.off=noop;process$1.removeListener=noop;process$1.removeAllListeners=noop;process$1.emit=noop;process$1.prependListener=noop;process$1.prependOnceListener=noop;process$1.listeners=function(lr){return[]};process$1.binding=function(lr){throw new Error("process.binding is not supported")};process$1.cwd=function(){return"/"};process$1.chdir=function(lr){throw new Error("process.chdir is not supported")};process$1.umask=function(){return 0};var browserExports=browser$1.exports;const process$1$1=getDefaultExportFromCjs(browserExports);(function(lr){function or(){var cr=this||self;return delete lr.prototype.__magic__,cr}if(typeof globalThis=="object")return globalThis;if(this)return or();lr.defineProperty(lr.prototype,"__magic__",{configurable:!0,get:or});var ar=__magic__;return ar})(Object);var streamBrowser,hasRequiredStreamBrowser;function requireStreamBrowser(){return hasRequiredStreamBrowser||(hasRequiredStreamBrowser=1,streamBrowser=eventsExports.EventEmitter),streamBrowser}var util={},types$1={},shams$1,hasRequiredShams$1;function requireShams$1(){return hasRequiredShams$1||(hasRequiredShams$1=1,shams$1=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var or={},ar=Symbol("test"),cr=Object(ar);if(typeof ar=="string"||Object.prototype.toString.call(ar)!=="[object Symbol]"||Object.prototype.toString.call(cr)!=="[object Symbol]")return!1;var ur=42;or[ar]=ur;for(ar in or)return!1;if(typeof Object.keys=="function"&&Object.keys(or).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(or).length!==0)return!1;var hr=Object.getOwnPropertySymbols(or);if(hr.length!==1||hr[0]!==ar||!Object.prototype.propertyIsEnumerable.call(or,ar))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var fr=Object.getOwnPropertyDescriptor(or,ar);if(fr.value!==ur||fr.enumerable!==!0)return!1}return!0}),shams$1}var shams,hasRequiredShams;function requireShams(){if(hasRequiredShams)return shams;hasRequiredShams=1;var lr=requireShams$1();return shams=function(){return lr()&&!!Symbol.toStringTag},shams}var hasSymbols,hasRequiredHasSymbols;function requireHasSymbols(){if(hasRequiredHasSymbols)return hasSymbols;hasRequiredHasSymbols=1;var lr=typeof Symbol<"u"&&Symbol,or=requireShams$1();return hasSymbols=function(){return typeof lr!="function"||typeof Symbol!="function"||typeof lr("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:or()},hasSymbols}var implementation,hasRequiredImplementation;function requireImplementation(){if(hasRequiredImplementation)return implementation;hasRequiredImplementation=1;var lr="Function.prototype.bind called on incompatible ",or=Array.prototype.slice,ar=Object.prototype.toString,cr="[object Function]";return implementation=function(hr){var fr=this;if(typeof fr!="function"||ar.call(fr)!==cr)throw new TypeError(lr+fr);for(var dr=or.call(arguments,1),pr,mr=function(){if(this instanceof pr){var _r=fr.apply(this,dr.concat(or.call(arguments)));return Object(_r)===_r?_r:this}else return fr.apply(hr,dr.concat(or.call(arguments)))},gr=Math.max(0,fr.length-dr.length),yr=[],br=0;br<gr;br++)yr.push("$"+br);if(pr=Function("binder","return function ("+yr.join(",")+"){ return binder.apply(this,arguments); }")(mr),fr.prototype){var Or=function(){};Or.prototype=fr.prototype,pr.prototype=new Or,Or.prototype=null}return pr},implementation}var functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var lr=requireImplementation();return functionBind=Function.prototype.bind||lr,functionBind}var src,hasRequiredSrc;function requireSrc(){if(hasRequiredSrc)return src;hasRequiredSrc=1;var lr=requireFunctionBind();return src=lr.call(Function.call,Object.prototype.hasOwnProperty),src}var getIntrinsic,hasRequiredGetIntrinsic;function requireGetIntrinsic(){if(hasRequiredGetIntrinsic)return getIntrinsic;hasRequiredGetIntrinsic=1;var lr,or=SyntaxError,ar=Function,cr=TypeError,ur=function(Gr){try{return ar('"use strict"; return ('+Gr+").constructor;")()}catch{}},hr=Object.getOwnPropertyDescriptor;if(hr)try{hr({},"")}catch{hr=null}var fr=function(){throw new cr},dr=hr?function(){try{return arguments.callee,fr}catch{try{return hr(arguments,"callee").get}catch{return fr}}}():fr,pr=requireHasSymbols()(),mr=Object.getPrototypeOf||function(Gr){return Gr.__proto__},gr={},yr=typeof Uint8Array>"u"?lr:mr(Uint8Array),br={"%AggregateError%":typeof AggregateError>"u"?lr:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?lr:ArrayBuffer,"%ArrayIteratorPrototype%":pr?mr([][Symbol.iterator]()):lr,"%AsyncFromSyncIteratorPrototype%":lr,"%AsyncFunction%":gr,"%AsyncGenerator%":gr,"%AsyncGeneratorFunction%":gr,"%AsyncIteratorPrototype%":gr,"%Atomics%":typeof Atomics>"u"?lr:Atomics,"%BigInt%":typeof BigInt>"u"?lr:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?lr:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?lr:Float32Array,"%Float64Array%":typeof Float64Array>"u"?lr:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?lr:FinalizationRegistry,"%Function%":ar,"%GeneratorFunction%":gr,"%Int8Array%":typeof Int8Array>"u"?lr:Int8Array,"%Int16Array%":typeof Int16Array>"u"?lr:Int16Array,"%Int32Array%":typeof Int32Array>"u"?lr:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":pr?mr(mr([][Symbol.iterator]())):lr,"%JSON%":typeof JSON=="object"?JSON:lr,"%Map%":typeof Map>"u"?lr:Map,"%MapIteratorPrototype%":typeof Map>"u"||!pr?lr:mr(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?lr:Promise,"%Proxy%":typeof Proxy>"u"?lr:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?lr:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?lr:Set,"%SetIteratorPrototype%":typeof Set>"u"||!pr?lr:mr(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?lr:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":pr?mr(""[Symbol.iterator]()):lr,"%Symbol%":pr?Symbol:lr,"%SyntaxError%":or,"%ThrowTypeError%":dr,"%TypedArray%":yr,"%TypeError%":cr,"%Uint8Array%":typeof Uint8Array>"u"?lr:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?lr:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?lr:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?lr:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?lr:WeakMap,"%WeakRef%":typeof WeakRef>"u"?lr:WeakRef,"%WeakSet%":typeof WeakSet>"u"?lr:WeakSet},Or=function Gr(qr){var Ur;if(qr==="%AsyncFunction%")Ur=ur("async function () {}");else if(qr==="%GeneratorFunction%")Ur=ur("function* () {}");else if(qr==="%AsyncGeneratorFunction%")Ur=ur("async function* () {}");else if(qr==="%AsyncGenerator%"){var Yr=Gr("%AsyncGeneratorFunction%");Yr&&(Ur=Yr.prototype)}else if(qr==="%AsyncIteratorPrototype%"){var Dr=Gr("%AsyncGenerator%");Dr&&(Ur=mr(Dr.prototype))}return br[qr]=Ur,Ur},_r={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},vr=requireFunctionBind(),xr=requireSrc(),wr=vr.call(Function.call,Array.prototype.concat),kr=vr.call(Function.apply,Array.prototype.splice),Cr=vr.call(Function.call,String.prototype.replace),$r=vr.call(Function.call,String.prototype.slice),Nr=vr.call(Function.call,RegExp.prototype.exec),Br=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Fr=/\\(\\)?/g,Vr=function(qr){var Ur=$r(qr,0,1),Yr=$r(qr,-1);if(Ur==="%"&&Yr!=="%")throw new or("invalid intrinsic syntax, expected closing `%`");if(Yr==="%"&&Ur!=="%")throw new or("invalid intrinsic syntax, expected opening `%`");var Dr=[];return Cr(qr,Br,function(Jr,ai,Kr,ui){Dr[Dr.length]=Kr?Cr(ui,Fr,"$1"):ai||Jr}),Dr},Rr=function(qr,Ur){var Yr=qr,Dr;if(xr(_r,Yr)&&(Dr=_r[Yr],Yr="%"+Dr[0]+"%"),xr(br,Yr)){var Jr=br[Yr];if(Jr===gr&&(Jr=Or(Yr)),typeof Jr>"u"&&!Ur)throw new cr("intrinsic "+qr+" exists, but is not available. Please file an issue!");return{alias:Dr,name:Yr,value:Jr}}throw new or("intrinsic "+qr+" does not exist!")};return getIntrinsic=function(qr,Ur){if(typeof qr!="string"||qr.length===0)throw new cr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Ur!="boolean")throw new cr('"allowMissing" argument must be a boolean');if(Nr(/^%?[^%]*%?$/,qr)===null)throw new or("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Yr=Vr(qr),Dr=Yr.length>0?Yr[0]:"",Jr=Rr("%"+Dr+"%",Ur),ai=Jr.name,Kr=Jr.value,ui=!1,ii=Jr.alias;ii&&(Dr=ii[0],kr(Yr,wr([0,1],ii)));for(var di=1,ei=!0;di<Yr.length;di+=1){var Wr=Yr[di],ti=$r(Wr,0,1),si=$r(Wr,-1);if((ti==='"'||ti==="'"||ti==="`"||si==='"'||si==="'"||si==="`")&&ti!==si)throw new or("property names with quotes must have matching quotes");if((Wr==="constructor"||!ei)&&(ui=!0),Dr+="."+Wr,ai="%"+Dr+"%",xr(br,ai))Kr=br[ai];else if(Kr!=null){if(!(Wr in Kr)){if(!Ur)throw new cr("base intrinsic for "+qr+" exists, but the property is not available.");return}if(hr&&di+1>=Yr.length){var ci=hr(Kr,Wr);ei=!!ci,ei&&"get"in ci&&!("originalValue"in ci.get)?Kr=ci.get:Kr=Kr[Wr]}else ei=xr(Kr,Wr),Kr=Kr[Wr];ei&&!ui&&(br[ai]=Kr)}}return Kr},getIntrinsic}var callBind={exports:{}},hasRequiredCallBind;function requireCallBind(){return hasRequiredCallBind||(hasRequiredCallBind=1,function(lr){var or=requireFunctionBind(),ar=requireGetIntrinsic(),cr=ar("%Function.prototype.apply%"),ur=ar("%Function.prototype.call%"),hr=ar("%Reflect.apply%",!0)||or.call(ur,cr),fr=ar("%Object.getOwnPropertyDescriptor%",!0),dr=ar("%Object.defineProperty%",!0),pr=ar("%Math.max%");if(dr)try{dr({},"a",{value:1})}catch{dr=null}lr.exports=function(yr){var br=hr(or,ur,arguments);if(fr&&dr){var Or=fr(br,"length");Or.configurable&&dr(br,"length",{value:1+pr(0,yr.length-(arguments.length-1))})}return br};var mr=function(){return hr(or,cr,arguments)};dr?dr(lr.exports,"apply",{value:mr}):lr.exports.apply=mr}(callBind)),callBind.exports}var callBound,hasRequiredCallBound;function requireCallBound(){if(hasRequiredCallBound)return callBound;hasRequiredCallBound=1;var lr=requireGetIntrinsic(),or=requireCallBind(),ar=or(lr("String.prototype.indexOf"));return callBound=function(ur,hr){var fr=lr(ur,!!hr);return typeof fr=="function"&&ar(ur,".prototype.")>-1?or(fr):fr},callBound}var isArguments,hasRequiredIsArguments;function requireIsArguments(){if(hasRequiredIsArguments)return isArguments;hasRequiredIsArguments=1;var lr=requireShams()(),or=requireCallBound(),ar=or("Object.prototype.toString"),cr=function(dr){return lr&&dr&&typeof dr=="object"&&Symbol.toStringTag in dr?!1:ar(dr)==="[object Arguments]"},ur=function(dr){return cr(dr)?!0:dr!==null&&typeof dr=="object"&&typeof dr.length=="number"&&dr.length>=0&&ar(dr)!=="[object Array]"&&ar(dr.callee)==="[object Function]"},hr=function(){return cr(arguments)}();return cr.isLegacyArguments=ur,isArguments=hr?cr:ur,isArguments}var isGeneratorFunction,hasRequiredIsGeneratorFunction;function requireIsGeneratorFunction(){if(hasRequiredIsGeneratorFunction)return isGeneratorFunction;hasRequiredIsGeneratorFunction=1;var lr=Object.prototype.toString,or=Function.prototype.toString,ar=/^\s*(?:function)?\*/,cr=requireShams()(),ur=Object.getPrototypeOf,hr=function(){if(!cr)return!1;try{return Function("return function*() {}")()}catch{}},fr;return isGeneratorFunction=function(pr){if(typeof pr!="function")return!1;if(ar.test(or.call(pr)))return!0;if(!cr){var mr=lr.call(pr);return mr==="[object GeneratorFunction]"}if(!ur)return!1;if(typeof fr>"u"){var gr=hr();fr=gr?ur(gr):!1}return ur(pr)===fr},isGeneratorFunction}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var lr=Function.prototype.toString,or=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,ar,cr;if(typeof or=="function"&&typeof Object.defineProperty=="function")try{ar=Object.defineProperty({},"length",{get:function(){throw cr}}),cr={},or(function(){throw 42},null,ar)}catch(kr){kr!==cr&&(or=null)}else or=null;var ur=/^\s*class\b/,hr=function(Cr){try{var $r=lr.call(Cr);return ur.test($r)}catch{return!1}},fr=function(Cr){try{return hr(Cr)?!1:(lr.call(Cr),!0)}catch{return!1}},dr=Object.prototype.toString,pr="[object Object]",mr="[object Function]",gr="[object GeneratorFunction]",yr="[object HTMLAllCollection]",br="[object HTML document.all class]",Or="[object HTMLCollection]",_r=typeof Symbol=="function"&&!!Symbol.toStringTag,vr=!(0 in[,]),xr=function(){return!1};if(typeof document=="object"){var wr=document.all;dr.call(wr)===dr.call(document.all)&&(xr=function(Cr){if((vr||!Cr)&&(typeof Cr>"u"||typeof Cr=="object"))try{var $r=dr.call(Cr);return($r===yr||$r===br||$r===Or||$r===pr)&&Cr("")==null}catch{}return!1})}return isCallable=or?function(Cr){if(xr(Cr))return!0;if(!Cr||typeof Cr!="function"&&typeof Cr!="object")return!1;try{or(Cr,null,ar)}catch($r){if($r!==cr)return!1}return!hr(Cr)&&fr(Cr)}:function(Cr){if(xr(Cr))return!0;if(!Cr||typeof Cr!="function"&&typeof Cr!="object")return!1;if(_r)return fr(Cr);if(hr(Cr))return!1;var $r=dr.call(Cr);return $r!==mr&&$r!==gr&&!/^\[object HTML/.test($r)?!1:fr(Cr)},isCallable}var forEach_1,hasRequiredForEach;function requireForEach(){if(hasRequiredForEach)return forEach_1;hasRequiredForEach=1;var lr=requireIsCallable(),or=Object.prototype.toString,ar=Object.prototype.hasOwnProperty,cr=function(pr,mr,gr){for(var yr=0,br=pr.length;yr<br;yr++)ar.call(pr,yr)&&(gr==null?mr(pr[yr],yr,pr):mr.call(gr,pr[yr],yr,pr))},ur=function(pr,mr,gr){for(var yr=0,br=pr.length;yr<br;yr++)gr==null?mr(pr.charAt(yr),yr,pr):mr.call(gr,pr.charAt(yr),yr,pr)},hr=function(pr,mr,gr){for(var yr in pr)ar.call(pr,yr)&&(gr==null?mr(pr[yr],yr,pr):mr.call(gr,pr[yr],yr,pr))},fr=function(pr,mr,gr){if(!lr(mr))throw new TypeError("iterator must be a function");var yr;arguments.length>=3&&(yr=gr),or.call(pr)==="[object Array]"?cr(pr,mr,yr):typeof pr=="string"?ur(pr,mr,yr):hr(pr,mr,yr)};return forEach_1=fr,forEach_1}var availableTypedArrays,hasRequiredAvailableTypedArrays;function requireAvailableTypedArrays(){if(hasRequiredAvailableTypedArrays)return availableTypedArrays;hasRequiredAvailableTypedArrays=1;var lr=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],or=typeof globalThis>"u"?commonjsGlobal:globalThis;return availableTypedArrays=function(){for(var cr=[],ur=0;ur<lr.length;ur++)typeof or[lr[ur]]=="function"&&(cr[cr.length]=lr[ur]);return cr},availableTypedArrays}var gopd,hasRequiredGopd;function requireGopd(){if(hasRequiredGopd)return gopd;hasRequiredGopd=1;var lr=requireGetIntrinsic(),or=lr("%Object.getOwnPropertyDescriptor%",!0);if(or)try{or([],"length")}catch{or=null}return gopd=or,gopd}var isTypedArray,hasRequiredIsTypedArray;function requireIsTypedArray(){if(hasRequiredIsTypedArray)return isTypedArray;hasRequiredIsTypedArray=1;var lr=requireForEach(),or=requireAvailableTypedArrays(),ar=requireCallBound(),cr=ar("Object.prototype.toString"),ur=requireShams()(),hr=requireGopd(),fr=typeof globalThis>"u"?commonjsGlobal:globalThis,dr=or(),pr=ar("Array.prototype.indexOf",!0)||function(_r,vr){for(var xr=0;xr<_r.length;xr+=1)if(_r[xr]===vr)return xr;return-1},mr=ar("String.prototype.slice"),gr={},yr=Object.getPrototypeOf;ur&&hr&&yr&&lr(dr,function(Or){var _r=new fr[Or];if(Symbol.toStringTag in _r){var vr=yr(_r),xr=hr(vr,Symbol.toStringTag);if(!xr){var wr=yr(vr);xr=hr(wr,Symbol.toStringTag)}gr[Or]=xr.get}});var br=function(_r){var vr=!1;return lr(gr,function(xr,wr){if(!vr)try{vr=xr.call(_r)===wr}catch{}}),vr};return isTypedArray=function(_r){if(!_r||typeof _r!="object")return!1;if(!ur||!(Symbol.toStringTag in _r)){var vr=mr(cr(_r),8,-1);return pr(dr,vr)>-1}return hr?br(_r):!1},isTypedArray}var whichTypedArray,hasRequiredWhichTypedArray;function requireWhichTypedArray(){if(hasRequiredWhichTypedArray)return whichTypedArray;hasRequiredWhichTypedArray=1;var lr=requireForEach(),or=requireAvailableTypedArrays(),ar=requireCallBound(),cr=requireGopd(),ur=ar("Object.prototype.toString"),hr=requireShams()(),fr=typeof globalThis>"u"?commonjsGlobal:globalThis,dr=or(),pr=ar("String.prototype.slice"),mr={},gr=Object.getPrototypeOf;hr&&cr&&gr&&lr(dr,function(Or){if(typeof fr[Or]=="function"){var _r=new fr[Or];if(Symbol.toStringTag in _r){var vr=gr(_r),xr=cr(vr,Symbol.toStringTag);if(!xr){var wr=gr(vr);xr=cr(wr,Symbol.toStringTag)}mr[Or]=xr.get}}});var yr=function(_r){var vr=!1;return lr(mr,function(xr,wr){if(!vr)try{var kr=xr.call(_r);kr===wr&&(vr=kr)}catch{}}),vr},br=requireIsTypedArray();return whichTypedArray=function(_r){return br(_r)?!hr||!(Symbol.toStringTag in _r)?pr(ur(_r),8,-1):yr(_r):!1},whichTypedArray}var hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,function(lr){var or=requireIsArguments(),ar=requireIsGeneratorFunction(),cr=requireWhichTypedArray(),ur=requireIsTypedArray();function hr(Ir){return Ir.call.bind(Ir)}var fr=typeof BigInt<"u",dr=typeof Symbol<"u",pr=hr(Object.prototype.toString),mr=hr(Number.prototype.valueOf),gr=hr(String.prototype.valueOf),yr=hr(Boolean.prototype.valueOf);if(fr)var br=hr(BigInt.prototype.valueOf);if(dr)var Or=hr(Symbol.prototype.valueOf);function _r(Ir,Qr){if(typeof Ir!="object")return!1;try{return Qr(Ir),!0}catch{return!1}}lr.isArgumentsObject=or,lr.isGeneratorFunction=ar,lr.isTypedArray=ur;function vr(Ir){return typeof Promise<"u"&&Ir instanceof Promise||Ir!==null&&typeof Ir=="object"&&typeof Ir.then=="function"&&typeof Ir.catch=="function"}lr.isPromise=vr;function xr(Ir){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(Ir):ur(Ir)||ti(Ir)}lr.isArrayBufferView=xr;function wr(Ir){return cr(Ir)==="Uint8Array"}lr.isUint8Array=wr;function kr(Ir){return cr(Ir)==="Uint8ClampedArray"}lr.isUint8ClampedArray=kr;function Cr(Ir){return cr(Ir)==="Uint16Array"}lr.isUint16Array=Cr;function $r(Ir){return cr(Ir)==="Uint32Array"}lr.isUint32Array=$r;function Nr(Ir){return cr(Ir)==="Int8Array"}lr.isInt8Array=Nr;function Br(Ir){return cr(Ir)==="Int16Array"}lr.isInt16Array=Br;function Fr(Ir){return cr(Ir)==="Int32Array"}lr.isInt32Array=Fr;function Vr(Ir){return cr(Ir)==="Float32Array"}lr.isFloat32Array=Vr;function Rr(Ir){return cr(Ir)==="Float64Array"}lr.isFloat64Array=Rr;function Gr(Ir){return cr(Ir)==="BigInt64Array"}lr.isBigInt64Array=Gr;function qr(Ir){return cr(Ir)==="BigUint64Array"}lr.isBigUint64Array=qr;function Ur(Ir){return pr(Ir)==="[object Map]"}Ur.working=typeof Map<"u"&&Ur(new Map);function Yr(Ir){return typeof Map>"u"?!1:Ur.working?Ur(Ir):Ir instanceof Map}lr.isMap=Yr;function Dr(Ir){return pr(Ir)==="[object Set]"}Dr.working=typeof Set<"u"&&Dr(new Set);function Jr(Ir){return typeof Set>"u"?!1:Dr.working?Dr(Ir):Ir instanceof Set}lr.isSet=Jr;function ai(Ir){return pr(Ir)==="[object WeakMap]"}ai.working=typeof WeakMap<"u"&&ai(new WeakMap);function Kr(Ir){return typeof WeakMap>"u"?!1:ai.working?ai(Ir):Ir instanceof WeakMap}lr.isWeakMap=Kr;function ui(Ir){return pr(Ir)==="[object WeakSet]"}ui.working=typeof WeakSet<"u"&&ui(new WeakSet);function ii(Ir){return ui(Ir)}lr.isWeakSet=ii;function di(Ir){return pr(Ir)==="[object ArrayBuffer]"}di.working=typeof ArrayBuffer<"u"&&di(new ArrayBuffer);function ei(Ir){return typeof ArrayBuffer>"u"?!1:di.working?di(Ir):Ir instanceof ArrayBuffer}lr.isArrayBuffer=ei;function Wr(Ir){return pr(Ir)==="[object DataView]"}Wr.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Wr(new DataView(new ArrayBuffer(1),0,1));function ti(Ir){return typeof DataView>"u"?!1:Wr.working?Wr(Ir):Ir instanceof DataView}lr.isDataView=ti;var si=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ci(Ir){return pr(Ir)==="[object SharedArrayBuffer]"}function ni(Ir){return typeof si>"u"?!1:(typeof ci.working>"u"&&(ci.working=ci(new si)),ci.working?ci(Ir):Ir instanceof si)}lr.isSharedArrayBuffer=ni;function Pr(Ir){return pr(Ir)==="[object AsyncFunction]"}lr.isAsyncFunction=Pr;function Ar(Ir){return pr(Ir)==="[object Map Iterator]"}lr.isMapIterator=Ar;function Zr(Ir){return pr(Ir)==="[object Set Iterator]"}lr.isSetIterator=Zr;function Mr(Ir){return pr(Ir)==="[object Generator]"}lr.isGeneratorObject=Mr;function jr(Ir){return pr(Ir)==="[object WebAssembly.Module]"}lr.isWebAssemblyCompiledModule=jr;function Xr(Ir){return _r(Ir,mr)}lr.isNumberObject=Xr;function ri(Ir){return _r(Ir,gr)}lr.isStringObject=ri;function Lr(Ir){return _r(Ir,yr)}lr.isBooleanObject=Lr;function oi(Ir){return fr&&_r(Ir,br)}lr.isBigIntObject=oi;function Tr(Ir){return dr&&_r(Ir,Or)}lr.isSymbolObject=Tr;function Sr(Ir){return Xr(Ir)||ri(Ir)||Lr(Ir)||oi(Ir)||Tr(Ir)}lr.isBoxedPrimitive=Sr;function Er(Ir){return typeof Uint8Array<"u"&&(ei(Ir)||ni(Ir))}lr.isAnyArrayBuffer=Er,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(Ir){Object.defineProperty(lr,Ir,{enumerable:!1,value:function(){throw new Error(Ir+" is not supported in userland")}})})}(types$1)),types$1}var isBufferBrowser,hasRequiredIsBufferBrowser;function requireIsBufferBrowser(){return hasRequiredIsBufferBrowser||(hasRequiredIsBufferBrowser=1,isBufferBrowser=function(or){return or&&typeof or=="object"&&typeof or.copy=="function"&&typeof or.fill=="function"&&typeof or.readUInt8=="function"}),isBufferBrowser}var hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,function(lr){var or=Object.getOwnPropertyDescriptors||function(ti){for(var si=Object.keys(ti),ci={},ni=0;ni<si.length;ni++)ci[si[ni]]=Object.getOwnPropertyDescriptor(ti,si[ni]);return ci},ar=/%[sdj%]/g;lr.format=function(Wr){if(!Nr(Wr)){for(var ti=[],si=0;si<arguments.length;si++)ti.push(fr(arguments[si]));return ti.join(" ")}for(var si=1,ci=arguments,ni=ci.length,Pr=String(Wr).replace(ar,function(Zr){if(Zr==="%%")return"%";if(si>=ni)return Zr;switch(Zr){case"%s":return String(ci[si++]);case"%d":return Number(ci[si++]);case"%j":try{return JSON.stringify(ci[si++])}catch{return"[Circular]"}default:return Zr}}),Ar=ci[si];si<ni;Ar=ci[++si])kr(Ar)||!Rr(Ar)?Pr+=" "+Ar:Pr+=" "+fr(Ar);return Pr},lr.deprecate=function(Wr,ti){if(typeof process$1$1<"u"&&process$1$1.noDeprecation===!0)return Wr;if(typeof process$1$1>"u")return function(){return lr.deprecate(Wr,ti).apply(this,arguments)};var si=!1;function ci(){if(!si){if(process$1$1.throwDeprecation)throw new Error(ti);process$1$1.traceDeprecation?console.trace(ti):console.error(ti),si=!0}return Wr.apply(this,arguments)}return ci};var cr={},ur=/^$/;if(process$1$1.env.NODE_DEBUG){var hr=process$1$1.env.NODE_DEBUG;hr=hr.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),ur=new RegExp("^"+hr+"$","i")}lr.debuglog=function(Wr){if(Wr=Wr.toUpperCase(),!cr[Wr])if(ur.test(Wr)){var ti=process$1$1.pid;cr[Wr]=function(){var si=lr.format.apply(lr,arguments);console.error("%s %d: %s",Wr,ti,si)}}else cr[Wr]=function(){};return cr[Wr]};function fr(Wr,ti){var si={seen:[],stylize:pr};return arguments.length>=3&&(si.depth=arguments[2]),arguments.length>=4&&(si.colors=arguments[3]),wr(ti)?si.showHidden=ti:ti&&lr._extend(si,ti),Fr(si.showHidden)&&(si.showHidden=!1),Fr(si.depth)&&(si.depth=2),Fr(si.colors)&&(si.colors=!1),Fr(si.customInspect)&&(si.customInspect=!0),si.colors&&(si.stylize=dr),gr(si,Wr,si.depth)}lr.inspect=fr,fr.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},fr.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function dr(Wr,ti){var si=fr.styles[ti];return si?"\x1B["+fr.colors[si][0]+"m"+Wr+"\x1B["+fr.colors[si][1]+"m":Wr}function pr(Wr,ti){return Wr}function mr(Wr){var ti={};return Wr.forEach(function(si,ci){ti[si]=!0}),ti}function gr(Wr,ti,si){if(Wr.customInspect&&ti&&Ur(ti.inspect)&&ti.inspect!==lr.inspect&&!(ti.constructor&&ti.constructor.prototype===ti)){var ci=ti.inspect(si,Wr);return Nr(ci)||(ci=gr(Wr,ci,si)),ci}var ni=yr(Wr,ti);if(ni)return ni;var Pr=Object.keys(ti),Ar=mr(Pr);if(Wr.showHidden&&(Pr=Object.getOwnPropertyNames(ti)),qr(ti)&&(Pr.indexOf("message")>=0||Pr.indexOf("description")>=0))return br(ti);if(Pr.length===0){if(Ur(ti)){var Zr=ti.name?": "+ti.name:"";return Wr.stylize("[Function"+Zr+"]","special")}if(Vr(ti))return Wr.stylize(RegExp.prototype.toString.call(ti),"regexp");if(Gr(ti))return Wr.stylize(Date.prototype.toString.call(ti),"date");if(qr(ti))return br(ti)}var Mr="",jr=!1,Xr=["{","}"];if(xr(ti)&&(jr=!0,Xr=["[","]"]),Ur(ti)){var ri=ti.name?": "+ti.name:"";Mr=" [Function"+ri+"]"}if(Vr(ti)&&(Mr=" "+RegExp.prototype.toString.call(ti)),Gr(ti)&&(Mr=" "+Date.prototype.toUTCString.call(ti)),qr(ti)&&(Mr=" "+br(ti)),Pr.length===0&&(!jr||ti.length==0))return Xr[0]+Mr+Xr[1];if(si<0)return Vr(ti)?Wr.stylize(RegExp.prototype.toString.call(ti),"regexp"):Wr.stylize("[Object]","special");Wr.seen.push(ti);var Lr;return jr?Lr=Or(Wr,ti,si,Ar,Pr):Lr=Pr.map(function(oi){return _r(Wr,ti,si,Ar,oi,jr)}),Wr.seen.pop(),vr(Lr,Mr,Xr)}function yr(Wr,ti){if(Fr(ti))return Wr.stylize("undefined","undefined");if(Nr(ti)){var si="'"+JSON.stringify(ti).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Wr.stylize(si,"string")}if($r(ti))return Wr.stylize(""+ti,"number");if(wr(ti))return Wr.stylize(""+ti,"boolean");if(kr(ti))return Wr.stylize("null","null")}function br(Wr){return"["+Error.prototype.toString.call(Wr)+"]"}function Or(Wr,ti,si,ci,ni){for(var Pr=[],Ar=0,Zr=ti.length;Ar<Zr;++Ar)ui(ti,String(Ar))?Pr.push(_r(Wr,ti,si,ci,String(Ar),!0)):Pr.push("");return ni.forEach(function(Mr){Mr.match(/^\d+$/)||Pr.push(_r(Wr,ti,si,ci,Mr,!0))}),Pr}function _r(Wr,ti,si,ci,ni,Pr){var Ar,Zr,Mr;if(Mr=Object.getOwnPropertyDescriptor(ti,ni)||{value:ti[ni]},Mr.get?Mr.set?Zr=Wr.stylize("[Getter/Setter]","special"):Zr=Wr.stylize("[Getter]","special"):Mr.set&&(Zr=Wr.stylize("[Setter]","special")),ui(ci,ni)||(Ar="["+ni+"]"),Zr||(Wr.seen.indexOf(Mr.value)<0?(kr(si)?Zr=gr(Wr,Mr.value,null):Zr=gr(Wr,Mr.value,si-1),Zr.indexOf(`
`)>-1&&(Pr?Zr=Zr.split(`
`).map(function(jr){return"  "+jr}).join(`
`).slice(2):Zr=`
`+Zr.split(`
`).map(function(jr){return"   "+jr}).join(`
`))):Zr=Wr.stylize("[Circular]","special")),Fr(Ar)){if(Pr&&ni.match(/^\d+$/))return Zr;Ar=JSON.stringify(""+ni),Ar.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Ar=Ar.slice(1,-1),Ar=Wr.stylize(Ar,"name")):(Ar=Ar.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Ar=Wr.stylize(Ar,"string"))}return Ar+": "+Zr}function vr(Wr,ti,si){var ci=Wr.reduce(function(ni,Pr){return Pr.indexOf(`
`)>=0,ni+Pr.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ci>60?si[0]+(ti===""?"":ti+`
 `)+" "+Wr.join(`,
  `)+" "+si[1]:si[0]+ti+" "+Wr.join(", ")+" "+si[1]}lr.types=requireTypes();function xr(Wr){return Array.isArray(Wr)}lr.isArray=xr;function wr(Wr){return typeof Wr=="boolean"}lr.isBoolean=wr;function kr(Wr){return Wr===null}lr.isNull=kr;function Cr(Wr){return Wr==null}lr.isNullOrUndefined=Cr;function $r(Wr){return typeof Wr=="number"}lr.isNumber=$r;function Nr(Wr){return typeof Wr=="string"}lr.isString=Nr;function Br(Wr){return typeof Wr=="symbol"}lr.isSymbol=Br;function Fr(Wr){return Wr===void 0}lr.isUndefined=Fr;function Vr(Wr){return Rr(Wr)&&Dr(Wr)==="[object RegExp]"}lr.isRegExp=Vr,lr.types.isRegExp=Vr;function Rr(Wr){return typeof Wr=="object"&&Wr!==null}lr.isObject=Rr;function Gr(Wr){return Rr(Wr)&&Dr(Wr)==="[object Date]"}lr.isDate=Gr,lr.types.isDate=Gr;function qr(Wr){return Rr(Wr)&&(Dr(Wr)==="[object Error]"||Wr instanceof Error)}lr.isError=qr,lr.types.isNativeError=qr;function Ur(Wr){return typeof Wr=="function"}lr.isFunction=Ur;function Yr(Wr){return Wr===null||typeof Wr=="boolean"||typeof Wr=="number"||typeof Wr=="string"||typeof Wr=="symbol"||typeof Wr>"u"}lr.isPrimitive=Yr,lr.isBuffer=requireIsBufferBrowser();function Dr(Wr){return Object.prototype.toString.call(Wr)}function Jr(Wr){return Wr<10?"0"+Wr.toString(10):Wr.toString(10)}var ai=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Kr(){var Wr=new Date,ti=[Jr(Wr.getHours()),Jr(Wr.getMinutes()),Jr(Wr.getSeconds())].join(":");return[Wr.getDate(),ai[Wr.getMonth()],ti].join(" ")}lr.log=function(){console.log("%s - %s",Kr(),lr.format.apply(lr,arguments))},lr.inherits=inherits_browserExports,lr._extend=function(Wr,ti){if(!ti||!Rr(ti))return Wr;for(var si=Object.keys(ti),ci=si.length;ci--;)Wr[si[ci]]=ti[si[ci]];return Wr};function ui(Wr,ti){return Object.prototype.hasOwnProperty.call(Wr,ti)}var ii=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;lr.promisify=function(ti){if(typeof ti!="function")throw new TypeError('The "original" argument must be of type Function');if(ii&&ti[ii]){var si=ti[ii];if(typeof si!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(si,ii,{value:si,enumerable:!1,writable:!1,configurable:!0}),si}function si(){for(var ci,ni,Pr=new Promise(function(Mr,jr){ci=Mr,ni=jr}),Ar=[],Zr=0;Zr<arguments.length;Zr++)Ar.push(arguments[Zr]);Ar.push(function(Mr,jr){Mr?ni(Mr):ci(jr)});try{ti.apply(this,Ar)}catch(Mr){ni(Mr)}return Pr}return Object.setPrototypeOf(si,Object.getPrototypeOf(ti)),ii&&Object.defineProperty(si,ii,{value:si,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(si,or(ti))},lr.promisify.custom=ii;function di(Wr,ti){if(!Wr){var si=new Error("Promise was rejected with a falsy value");si.reason=Wr,Wr=si}return ti(Wr)}function ei(Wr){if(typeof Wr!="function")throw new TypeError('The "original" argument must be of type Function');function ti(){for(var si=[],ci=0;ci<arguments.length;ci++)si.push(arguments[ci]);var ni=si.pop();if(typeof ni!="function")throw new TypeError("The last argument must be of type Function");var Pr=this,Ar=function(){return ni.apply(Pr,arguments)};Wr.apply(this,si).then(function(Zr){process$1$1.nextTick(Ar.bind(null,null,Zr))},function(Zr){process$1$1.nextTick(di.bind(null,Zr,Ar))})}return Object.setPrototypeOf(ti,Object.getPrototypeOf(Wr)),Object.defineProperties(ti,or(Wr)),ti}lr.callbackify=ei}(util)),util}var buffer_list,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;function lr(br,Or){var _r=Object.keys(br);if(Object.getOwnPropertySymbols){var vr=Object.getOwnPropertySymbols(br);Or&&(vr=vr.filter(function(xr){return Object.getOwnPropertyDescriptor(br,xr).enumerable})),_r.push.apply(_r,vr)}return _r}function or(br){for(var Or=1;Or<arguments.length;Or++){var _r=arguments[Or]!=null?arguments[Or]:{};Or%2?lr(Object(_r),!0).forEach(function(vr){ar(br,vr,_r[vr])}):Object.getOwnPropertyDescriptors?Object.defineProperties(br,Object.getOwnPropertyDescriptors(_r)):lr(Object(_r)).forEach(function(vr){Object.defineProperty(br,vr,Object.getOwnPropertyDescriptor(_r,vr))})}return br}function ar(br,Or,_r){return Or in br?Object.defineProperty(br,Or,{value:_r,enumerable:!0,configurable:!0,writable:!0}):br[Or]=_r,br}function cr(br,Or){if(!(br instanceof Or))throw new TypeError("Cannot call a class as a function")}function ur(br,Or){for(var _r=0;_r<Or.length;_r++){var vr=Or[_r];vr.enumerable=vr.enumerable||!1,vr.configurable=!0,"value"in vr&&(vr.writable=!0),Object.defineProperty(br,vr.key,vr)}}function hr(br,Or,_r){return Or&&ur(br.prototype,Or),_r&&ur(br,_r),br}var fr=requireBuffer(),dr=fr.Buffer,pr=requireUtil(),mr=pr.inspect,gr=mr&&mr.custom||"inspect";function yr(br,Or,_r){dr.prototype.copy.call(br,Or,_r)}return buffer_list=function(){function br(){cr(this,br),this.head=null,this.tail=null,this.length=0}return hr(br,[{key:"push",value:function(_r){var vr={data:_r,next:null};this.length>0?this.tail.next=vr:this.head=vr,this.tail=vr,++this.length}},{key:"unshift",value:function(_r){var vr={data:_r,next:this.head};this.length===0&&(this.tail=vr),this.head=vr,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,_r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_r){if(this.length===0)return"";for(var vr=this.head,xr=""+vr.data;vr=vr.next;)xr+=_r+vr.data;return xr}},{key:"concat",value:function(_r){if(this.length===0)return dr.alloc(0);for(var vr=dr.allocUnsafe(_r>>>0),xr=this.head,wr=0;xr;)yr(xr.data,vr,wr),wr+=xr.data.length,xr=xr.next;return vr}},{key:"consume",value:function(_r,vr){var xr;return _r<this.head.data.length?(xr=this.head.data.slice(0,_r),this.head.data=this.head.data.slice(_r)):_r===this.head.data.length?xr=this.shift():xr=vr?this._getString(_r):this._getBuffer(_r),xr}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_r){var vr=this.head,xr=1,wr=vr.data;for(_r-=wr.length;vr=vr.next;){var kr=vr.data,Cr=_r>kr.length?kr.length:_r;if(Cr===kr.length?wr+=kr:wr+=kr.slice(0,_r),_r-=Cr,_r===0){Cr===kr.length?(++xr,vr.next?this.head=vr.next:this.head=this.tail=null):(this.head=vr,vr.data=kr.slice(Cr));break}++xr}return this.length-=xr,wr}},{key:"_getBuffer",value:function(_r){var vr=dr.allocUnsafe(_r),xr=this.head,wr=1;for(xr.data.copy(vr),_r-=xr.data.length;xr=xr.next;){var kr=xr.data,Cr=_r>kr.length?kr.length:_r;if(kr.copy(vr,vr.length-_r,0,Cr),_r-=Cr,_r===0){Cr===kr.length?(++wr,xr.next?this.head=xr.next:this.head=this.tail=null):(this.head=xr,xr.data=kr.slice(Cr));break}++wr}return this.length-=wr,vr}},{key:gr,value:function(_r,vr){return mr(this,or({},vr,{depth:0,customInspect:!1}))}}]),br}(),buffer_list}var destroy_1,hasRequiredDestroy;function requireDestroy(){if(hasRequiredDestroy)return destroy_1;hasRequiredDestroy=1;function lr(fr,dr){var pr=this,mr=this._readableState&&this._readableState.destroyed,gr=this._writableState&&this._writableState.destroyed;return mr||gr?(dr?dr(fr):fr&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process$1$1.nextTick(ur,this,fr)):process$1$1.nextTick(ur,this,fr)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(fr||null,function(yr){!dr&&yr?pr._writableState?pr._writableState.errorEmitted?process$1$1.nextTick(ar,pr):(pr._writableState.errorEmitted=!0,process$1$1.nextTick(or,pr,yr)):process$1$1.nextTick(or,pr,yr):dr?(process$1$1.nextTick(ar,pr),dr(yr)):process$1$1.nextTick(ar,pr)}),this)}function or(fr,dr){ur(fr,dr),ar(fr)}function ar(fr){fr._writableState&&!fr._writableState.emitClose||fr._readableState&&!fr._readableState.emitClose||fr.emit("close")}function cr(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function ur(fr,dr){fr.emit("error",dr)}function hr(fr,dr){var pr=fr._readableState,mr=fr._writableState;pr&&pr.autoDestroy||mr&&mr.autoDestroy?fr.destroy(dr):fr.emit("error",dr)}return destroy_1={destroy:lr,undestroy:cr,errorOrDestroy:hr},destroy_1}var errorsBrowser={},hasRequiredErrorsBrowser;function requireErrorsBrowser(){if(hasRequiredErrorsBrowser)return errorsBrowser;hasRequiredErrorsBrowser=1;function lr(dr,pr){dr.prototype=Object.create(pr.prototype),dr.prototype.constructor=dr,dr.__proto__=pr}var or={};function ar(dr,pr,mr){mr||(mr=Error);function gr(br,Or,_r){return typeof pr=="string"?pr:pr(br,Or,_r)}var yr=function(br){lr(Or,br);function Or(_r,vr,xr){return br.call(this,gr(_r,vr,xr))||this}return Or}(mr);yr.prototype.name=mr.name,yr.prototype.code=dr,or[dr]=yr}function cr(dr,pr){if(Array.isArray(dr)){var mr=dr.length;return dr=dr.map(function(gr){return String(gr)}),mr>2?"one of ".concat(pr," ").concat(dr.slice(0,mr-1).join(", "),", or ")+dr[mr-1]:mr===2?"one of ".concat(pr," ").concat(dr[0]," or ").concat(dr[1]):"of ".concat(pr," ").concat(dr[0])}else return"of ".concat(pr," ").concat(String(dr))}function ur(dr,pr,mr){return dr.substr(!mr||mr<0?0:+mr,pr.length)===pr}function hr(dr,pr,mr){return(mr===void 0||mr>dr.length)&&(mr=dr.length),dr.substring(mr-pr.length,mr)===pr}function fr(dr,pr,mr){return typeof mr!="number"&&(mr=0),mr+pr.length>dr.length?!1:dr.indexOf(pr,mr)!==-1}return ar("ERR_INVALID_OPT_VALUE",function(dr,pr){return'The value "'+pr+'" is invalid for option "'+dr+'"'},TypeError),ar("ERR_INVALID_ARG_TYPE",function(dr,pr,mr){var gr;typeof pr=="string"&&ur(pr,"not ")?(gr="must not be",pr=pr.replace(/^not /,"")):gr="must be";var yr;if(hr(dr," argument"))yr="The ".concat(dr," ").concat(gr," ").concat(cr(pr,"type"));else{var br=fr(dr,".")?"property":"argument";yr='The "'.concat(dr,'" ').concat(br," ").concat(gr," ").concat(cr(pr,"type"))}return yr+=". Received type ".concat(typeof mr),yr},TypeError),ar("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),ar("ERR_METHOD_NOT_IMPLEMENTED",function(dr){return"The "+dr+" method is not implemented"}),ar("ERR_STREAM_PREMATURE_CLOSE","Premature close"),ar("ERR_STREAM_DESTROYED",function(dr){return"Cannot call "+dr+" after a stream was destroyed"}),ar("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),ar("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),ar("ERR_STREAM_WRITE_AFTER_END","write after end"),ar("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),ar("ERR_UNKNOWN_ENCODING",function(dr){return"Unknown encoding: "+dr},TypeError),ar("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),errorsBrowser.codes=or,errorsBrowser}var state,hasRequiredState;function requireState(){if(hasRequiredState)return state;hasRequiredState=1;var lr=requireErrorsBrowser().codes.ERR_INVALID_OPT_VALUE;function or(cr,ur,hr){return cr.highWaterMark!=null?cr.highWaterMark:ur?cr[hr]:null}function ar(cr,ur,hr,fr){var dr=or(ur,fr,hr);if(dr!=null){if(!(isFinite(dr)&&Math.floor(dr)===dr)||dr<0){var pr=fr?hr:"highWaterMark";throw new lr(pr,dr)}return Math.floor(dr)}return cr.objectMode?16:16*1024}return state={getHighWaterMark:ar},state}var browser,hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser;hasRequiredBrowser=1,browser=lr;function lr(ar,cr){if(or("noDeprecation"))return ar;var ur=!1;function hr(){if(!ur){if(or("throwDeprecation"))throw new Error(cr);or("traceDeprecation")?console.trace(cr):console.warn(cr),ur=!0}return ar.apply(this,arguments)}return hr}function or(ar){try{if(!commonjsGlobal.localStorage)return!1}catch{return!1}var cr=commonjsGlobal.localStorage[ar];return cr==null?!1:String(cr).toLowerCase()==="true"}return browser}var _stream_writable,hasRequired_stream_writable;function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;hasRequired_stream_writable=1,_stream_writable=Vr;function lr(ni){var Pr=this;this.next=null,this.entry=null,this.finish=function(){ci(Pr,ni)}}var or;Vr.WritableState=Br;var ar={deprecate:requireBrowser()},cr=requireStreamBrowser(),ur=requireBuffer().Buffer,hr=commonjsGlobal.Uint8Array||function(){};function fr(ni){return ur.from(ni)}function dr(ni){return ur.isBuffer(ni)||ni instanceof hr}var pr=requireDestroy(),mr=requireState(),gr=mr.getHighWaterMark,yr=requireErrorsBrowser().codes,br=yr.ERR_INVALID_ARG_TYPE,Or=yr.ERR_METHOD_NOT_IMPLEMENTED,_r=yr.ERR_MULTIPLE_CALLBACK,vr=yr.ERR_STREAM_CANNOT_PIPE,xr=yr.ERR_STREAM_DESTROYED,wr=yr.ERR_STREAM_NULL_VALUES,kr=yr.ERR_STREAM_WRITE_AFTER_END,Cr=yr.ERR_UNKNOWN_ENCODING,$r=pr.errorOrDestroy;inherits_browserExports(Vr,cr);function Nr(){}function Br(ni,Pr,Ar){or=or||require_stream_duplex(),ni=ni||{},typeof Ar!="boolean"&&(Ar=Pr instanceof or),this.objectMode=!!ni.objectMode,Ar&&(this.objectMode=this.objectMode||!!ni.writableObjectMode),this.highWaterMark=gr(this,ni,"writableHighWaterMark",Ar),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Zr=ni.decodeStrings===!1;this.decodeStrings=!Zr,this.defaultEncoding=ni.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Mr){ai(Pr,Mr)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=ni.emitClose!==!1,this.autoDestroy=!!ni.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new lr(this)}Br.prototype.getBuffer=function(){for(var Pr=this.bufferedRequest,Ar=[];Pr;)Ar.push(Pr),Pr=Pr.next;return Ar},function(){try{Object.defineProperty(Br.prototype,"buffer",{get:ar.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Fr;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Fr=Function.prototype[Symbol.hasInstance],Object.defineProperty(Vr,Symbol.hasInstance,{value:function(Pr){return Fr.call(this,Pr)?!0:this!==Vr?!1:Pr&&Pr._writableState instanceof Br}})):Fr=function(Pr){return Pr instanceof this};function Vr(ni){or=or||require_stream_duplex();var Pr=this instanceof or;if(!Pr&&!Fr.call(Vr,this))return new Vr(ni);this._writableState=new Br(ni,this,Pr),this.writable=!0,ni&&(typeof ni.write=="function"&&(this._write=ni.write),typeof ni.writev=="function"&&(this._writev=ni.writev),typeof ni.destroy=="function"&&(this._destroy=ni.destroy),typeof ni.final=="function"&&(this._final=ni.final)),cr.call(this)}Vr.prototype.pipe=function(){$r(this,new vr)};function Rr(ni,Pr){var Ar=new kr;$r(ni,Ar),process$1$1.nextTick(Pr,Ar)}function Gr(ni,Pr,Ar,Zr){var Mr;return Ar===null?Mr=new wr:typeof Ar!="string"&&!Pr.objectMode&&(Mr=new br("chunk",["string","Buffer"],Ar)),Mr?($r(ni,Mr),process$1$1.nextTick(Zr,Mr),!1):!0}Vr.prototype.write=function(ni,Pr,Ar){var Zr=this._writableState,Mr=!1,jr=!Zr.objectMode&&dr(ni);return jr&&!ur.isBuffer(ni)&&(ni=fr(ni)),typeof Pr=="function"&&(Ar=Pr,Pr=null),jr?Pr="buffer":Pr||(Pr=Zr.defaultEncoding),typeof Ar!="function"&&(Ar=Nr),Zr.ending?Rr(this,Ar):(jr||Gr(this,Zr,ni,Ar))&&(Zr.pendingcb++,Mr=Ur(this,Zr,jr,ni,Pr,Ar)),Mr},Vr.prototype.cork=function(){this._writableState.corked++},Vr.prototype.uncork=function(){var ni=this._writableState;ni.corked&&(ni.corked--,!ni.writing&&!ni.corked&&!ni.bufferProcessing&&ni.bufferedRequest&&ii(this,ni))},Vr.prototype.setDefaultEncoding=function(Pr){if(typeof Pr=="string"&&(Pr=Pr.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Pr+"").toLowerCase())>-1))throw new Cr(Pr);return this._writableState.defaultEncoding=Pr,this},Object.defineProperty(Vr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function qr(ni,Pr,Ar){return!ni.objectMode&&ni.decodeStrings!==!1&&typeof Pr=="string"&&(Pr=ur.from(Pr,Ar)),Pr}Object.defineProperty(Vr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Ur(ni,Pr,Ar,Zr,Mr,jr){if(!Ar){var Xr=qr(Pr,Zr,Mr);Zr!==Xr&&(Ar=!0,Mr="buffer",Zr=Xr)}var ri=Pr.objectMode?1:Zr.length;Pr.length+=ri;var Lr=Pr.length<Pr.highWaterMark;if(Lr||(Pr.needDrain=!0),Pr.writing||Pr.corked){var oi=Pr.lastBufferedRequest;Pr.lastBufferedRequest={chunk:Zr,encoding:Mr,isBuf:Ar,callback:jr,next:null},oi?oi.next=Pr.lastBufferedRequest:Pr.bufferedRequest=Pr.lastBufferedRequest,Pr.bufferedRequestCount+=1}else Yr(ni,Pr,!1,ri,Zr,Mr,jr);return Lr}function Yr(ni,Pr,Ar,Zr,Mr,jr,Xr){Pr.writelen=Zr,Pr.writecb=Xr,Pr.writing=!0,Pr.sync=!0,Pr.destroyed?Pr.onwrite(new xr("write")):Ar?ni._writev(Mr,Pr.onwrite):ni._write(Mr,jr,Pr.onwrite),Pr.sync=!1}function Dr(ni,Pr,Ar,Zr,Mr){--Pr.pendingcb,Ar?(process$1$1.nextTick(Mr,Zr),process$1$1.nextTick(ti,ni,Pr),ni._writableState.errorEmitted=!0,$r(ni,Zr)):(Mr(Zr),ni._writableState.errorEmitted=!0,$r(ni,Zr),ti(ni,Pr))}function Jr(ni){ni.writing=!1,ni.writecb=null,ni.length-=ni.writelen,ni.writelen=0}function ai(ni,Pr){var Ar=ni._writableState,Zr=Ar.sync,Mr=Ar.writecb;if(typeof Mr!="function")throw new _r;if(Jr(Ar),Pr)Dr(ni,Ar,Zr,Pr,Mr);else{var jr=di(Ar)||ni.destroyed;!jr&&!Ar.corked&&!Ar.bufferProcessing&&Ar.bufferedRequest&&ii(ni,Ar),Zr?process$1$1.nextTick(Kr,ni,Ar,jr,Mr):Kr(ni,Ar,jr,Mr)}}function Kr(ni,Pr,Ar,Zr){Ar||ui(ni,Pr),Pr.pendingcb--,Zr(),ti(ni,Pr)}function ui(ni,Pr){Pr.length===0&&Pr.needDrain&&(Pr.needDrain=!1,ni.emit("drain"))}function ii(ni,Pr){Pr.bufferProcessing=!0;var Ar=Pr.bufferedRequest;if(ni._writev&&Ar&&Ar.next){var Zr=Pr.bufferedRequestCount,Mr=new Array(Zr),jr=Pr.corkedRequestsFree;jr.entry=Ar;for(var Xr=0,ri=!0;Ar;)Mr[Xr]=Ar,Ar.isBuf||(ri=!1),Ar=Ar.next,Xr+=1;Mr.allBuffers=ri,Yr(ni,Pr,!0,Pr.length,Mr,"",jr.finish),Pr.pendingcb++,Pr.lastBufferedRequest=null,jr.next?(Pr.corkedRequestsFree=jr.next,jr.next=null):Pr.corkedRequestsFree=new lr(Pr),Pr.bufferedRequestCount=0}else{for(;Ar;){var Lr=Ar.chunk,oi=Ar.encoding,Tr=Ar.callback,Sr=Pr.objectMode?1:Lr.length;if(Yr(ni,Pr,!1,Sr,Lr,oi,Tr),Ar=Ar.next,Pr.bufferedRequestCount--,Pr.writing)break}Ar===null&&(Pr.lastBufferedRequest=null)}Pr.bufferedRequest=Ar,Pr.bufferProcessing=!1}Vr.prototype._write=function(ni,Pr,Ar){Ar(new Or("_write()"))},Vr.prototype._writev=null,Vr.prototype.end=function(ni,Pr,Ar){var Zr=this._writableState;return typeof ni=="function"?(Ar=ni,ni=null,Pr=null):typeof Pr=="function"&&(Ar=Pr,Pr=null),ni!=null&&this.write(ni,Pr),Zr.corked&&(Zr.corked=1,this.uncork()),Zr.ending||si(this,Zr,Ar),this},Object.defineProperty(Vr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function di(ni){return ni.ending&&ni.length===0&&ni.bufferedRequest===null&&!ni.finished&&!ni.writing}function ei(ni,Pr){ni._final(function(Ar){Pr.pendingcb--,Ar&&$r(ni,Ar),Pr.prefinished=!0,ni.emit("prefinish"),ti(ni,Pr)})}function Wr(ni,Pr){!Pr.prefinished&&!Pr.finalCalled&&(typeof ni._final=="function"&&!Pr.destroyed?(Pr.pendingcb++,Pr.finalCalled=!0,process$1$1.nextTick(ei,ni,Pr)):(Pr.prefinished=!0,ni.emit("prefinish")))}function ti(ni,Pr){var Ar=di(Pr);if(Ar&&(Wr(ni,Pr),Pr.pendingcb===0&&(Pr.finished=!0,ni.emit("finish"),Pr.autoDestroy))){var Zr=ni._readableState;(!Zr||Zr.autoDestroy&&Zr.endEmitted)&&ni.destroy()}return Ar}function si(ni,Pr,Ar){Pr.ending=!0,ti(ni,Pr),Ar&&(Pr.finished?process$1$1.nextTick(Ar):ni.once("finish",Ar)),Pr.ended=!0,ni.writable=!1}function ci(ni,Pr,Ar){var Zr=ni.entry;for(ni.entry=null;Zr;){var Mr=Zr.callback;Pr.pendingcb--,Mr(Ar),Zr=Zr.next}Pr.corkedRequestsFree.next=ni}return Object.defineProperty(Vr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Pr){this._writableState&&(this._writableState.destroyed=Pr)}}),Vr.prototype.destroy=pr.destroy,Vr.prototype._undestroy=pr.undestroy,Vr.prototype._destroy=function(ni,Pr){Pr(ni)},_stream_writable}var _stream_duplex,hasRequired_stream_duplex;function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var lr=Object.keys||function(mr){var gr=[];for(var yr in mr)gr.push(yr);return gr};_stream_duplex=fr;var or=require_stream_readable(),ar=require_stream_writable();inherits_browserExports(fr,or);for(var cr=lr(ar.prototype),ur=0;ur<cr.length;ur++){var hr=cr[ur];fr.prototype[hr]||(fr.prototype[hr]=ar.prototype[hr])}function fr(mr){if(!(this instanceof fr))return new fr(mr);or.call(this,mr),ar.call(this,mr),this.allowHalfOpen=!0,mr&&(mr.readable===!1&&(this.readable=!1),mr.writable===!1&&(this.writable=!1),mr.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",dr)))}Object.defineProperty(fr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(fr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(fr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function dr(){this._writableState.ended||process$1$1.nextTick(pr,this)}function pr(mr){mr.end()}return Object.defineProperty(fr.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(gr){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=gr,this._writableState.destroyed=gr)}}),_stream_duplex}var string_decoder={},safeBuffer={exports:{}},hasRequiredSafeBuffer;function requireSafeBuffer(){return hasRequiredSafeBuffer||(hasRequiredSafeBuffer=1,function(lr,or){var ar=requireBuffer(),cr=ar.Buffer;function ur(fr,dr){for(var pr in fr)dr[pr]=fr[pr]}cr.from&&cr.alloc&&cr.allocUnsafe&&cr.allocUnsafeSlow?lr.exports=ar:(ur(ar,or),or.Buffer=hr);function hr(fr,dr,pr){return cr(fr,dr,pr)}ur(cr,hr),hr.from=function(fr,dr,pr){if(typeof fr=="number")throw new TypeError("Argument must not be a number");return cr(fr,dr,pr)},hr.alloc=function(fr,dr,pr){if(typeof fr!="number")throw new TypeError("Argument must be a number");var mr=cr(fr);return dr!==void 0?typeof pr=="string"?mr.fill(dr,pr):mr.fill(dr):mr.fill(0),mr},hr.allocUnsafe=function(fr){if(typeof fr!="number")throw new TypeError("Argument must be a number");return cr(fr)},hr.allocUnsafeSlow=function(fr){if(typeof fr!="number")throw new TypeError("Argument must be a number");return ar.SlowBuffer(fr)}}(safeBuffer,safeBuffer.exports)),safeBuffer.exports}var hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var lr=requireSafeBuffer().Buffer,or=lr.isEncoding||function(wr){switch(wr=""+wr,wr&&wr.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function ar(wr){if(!wr)return"utf8";for(var kr;;)switch(wr){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return wr;default:if(kr)return;wr=(""+wr).toLowerCase(),kr=!0}}function cr(wr){var kr=ar(wr);if(typeof kr!="string"&&(lr.isEncoding===or||!or(wr)))throw new Error("Unknown encoding: "+wr);return kr||wr}string_decoder.StringDecoder=ur;function ur(wr){this.encoding=cr(wr);var kr;switch(this.encoding){case"utf16le":this.text=yr,this.end=br,kr=4;break;case"utf8":this.fillLast=pr,kr=4;break;case"base64":this.text=Or,this.end=_r,kr=3;break;default:this.write=vr,this.end=xr;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=lr.allocUnsafe(kr)}ur.prototype.write=function(wr){if(wr.length===0)return"";var kr,Cr;if(this.lastNeed){if(kr=this.fillLast(wr),kr===void 0)return"";Cr=this.lastNeed,this.lastNeed=0}else Cr=0;return Cr<wr.length?kr?kr+this.text(wr,Cr):this.text(wr,Cr):kr||""},ur.prototype.end=gr,ur.prototype.text=mr,ur.prototype.fillLast=function(wr){if(this.lastNeed<=wr.length)return wr.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);wr.copy(this.lastChar,this.lastTotal-this.lastNeed,0,wr.length),this.lastNeed-=wr.length};function hr(wr){return wr<=127?0:wr>>5===6?2:wr>>4===14?3:wr>>3===30?4:wr>>6===2?-1:-2}function fr(wr,kr,Cr){var $r=kr.length-1;if($r<Cr)return 0;var Nr=hr(kr[$r]);return Nr>=0?(Nr>0&&(wr.lastNeed=Nr-1),Nr):--$r<Cr||Nr===-2?0:(Nr=hr(kr[$r]),Nr>=0?(Nr>0&&(wr.lastNeed=Nr-2),Nr):--$r<Cr||Nr===-2?0:(Nr=hr(kr[$r]),Nr>=0?(Nr>0&&(Nr===2?Nr=0:wr.lastNeed=Nr-3),Nr):0))}function dr(wr,kr,Cr){if((kr[0]&192)!==128)return wr.lastNeed=0,"�";if(wr.lastNeed>1&&kr.length>1){if((kr[1]&192)!==128)return wr.lastNeed=1,"�";if(wr.lastNeed>2&&kr.length>2&&(kr[2]&192)!==128)return wr.lastNeed=2,"�"}}function pr(wr){var kr=this.lastTotal-this.lastNeed,Cr=dr(this,wr);if(Cr!==void 0)return Cr;if(this.lastNeed<=wr.length)return wr.copy(this.lastChar,kr,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);wr.copy(this.lastChar,kr,0,wr.length),this.lastNeed-=wr.length}function mr(wr,kr){var Cr=fr(this,wr,kr);if(!this.lastNeed)return wr.toString("utf8",kr);this.lastTotal=Cr;var $r=wr.length-(Cr-this.lastNeed);return wr.copy(this.lastChar,0,$r),wr.toString("utf8",kr,$r)}function gr(wr){var kr=wr&&wr.length?this.write(wr):"";return this.lastNeed?kr+"�":kr}function yr(wr,kr){if((wr.length-kr)%2===0){var Cr=wr.toString("utf16le",kr);if(Cr){var $r=Cr.charCodeAt(Cr.length-1);if($r>=55296&&$r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=wr[wr.length-2],this.lastChar[1]=wr[wr.length-1],Cr.slice(0,-1)}return Cr}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=wr[wr.length-1],wr.toString("utf16le",kr,wr.length-1)}function br(wr){var kr=wr&&wr.length?this.write(wr):"";if(this.lastNeed){var Cr=this.lastTotal-this.lastNeed;return kr+this.lastChar.toString("utf16le",0,Cr)}return kr}function Or(wr,kr){var Cr=(wr.length-kr)%3;return Cr===0?wr.toString("base64",kr):(this.lastNeed=3-Cr,this.lastTotal=3,Cr===1?this.lastChar[0]=wr[wr.length-1]:(this.lastChar[0]=wr[wr.length-2],this.lastChar[1]=wr[wr.length-1]),wr.toString("base64",kr,wr.length-Cr))}function _r(wr){var kr=wr&&wr.length?this.write(wr):"";return this.lastNeed?kr+this.lastChar.toString("base64",0,3-this.lastNeed):kr}function vr(wr){return wr.toString(this.encoding)}function xr(wr){return wr&&wr.length?this.write(wr):""}return string_decoder}var endOfStream,hasRequiredEndOfStream;function requireEndOfStream(){if(hasRequiredEndOfStream)return endOfStream;hasRequiredEndOfStream=1;var lr=requireErrorsBrowser().codes.ERR_STREAM_PREMATURE_CLOSE;function or(hr){var fr=!1;return function(){if(!fr){fr=!0;for(var dr=arguments.length,pr=new Array(dr),mr=0;mr<dr;mr++)pr[mr]=arguments[mr];hr.apply(this,pr)}}}function ar(){}function cr(hr){return hr.setHeader&&typeof hr.abort=="function"}function ur(hr,fr,dr){if(typeof fr=="function")return ur(hr,null,fr);fr||(fr={}),dr=or(dr||ar);var pr=fr.readable||fr.readable!==!1&&hr.readable,mr=fr.writable||fr.writable!==!1&&hr.writable,gr=function(){hr.writable||br()},yr=hr._writableState&&hr._writableState.finished,br=function(){mr=!1,yr=!0,pr||dr.call(hr)},Or=hr._readableState&&hr._readableState.endEmitted,_r=function(){pr=!1,Or=!0,mr||dr.call(hr)},vr=function(Cr){dr.call(hr,Cr)},xr=function(){var Cr;if(pr&&!Or)return(!hr._readableState||!hr._readableState.ended)&&(Cr=new lr),dr.call(hr,Cr);if(mr&&!yr)return(!hr._writableState||!hr._writableState.ended)&&(Cr=new lr),dr.call(hr,Cr)},wr=function(){hr.req.on("finish",br)};return cr(hr)?(hr.on("complete",br),hr.on("abort",xr),hr.req?wr():hr.on("request",wr)):mr&&!hr._writableState&&(hr.on("end",gr),hr.on("close",gr)),hr.on("end",_r),hr.on("finish",br),fr.error!==!1&&hr.on("error",vr),hr.on("close",xr),function(){hr.removeListener("complete",br),hr.removeListener("abort",xr),hr.removeListener("request",wr),hr.req&&hr.req.removeListener("finish",br),hr.removeListener("end",gr),hr.removeListener("close",gr),hr.removeListener("finish",br),hr.removeListener("end",_r),hr.removeListener("error",vr),hr.removeListener("close",xr)}}return endOfStream=ur,endOfStream}var async_iterator,hasRequiredAsync_iterator;function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;hasRequiredAsync_iterator=1;var lr;function or(wr,kr,Cr){return kr in wr?Object.defineProperty(wr,kr,{value:Cr,enumerable:!0,configurable:!0,writable:!0}):wr[kr]=Cr,wr}var ar=requireEndOfStream(),cr=Symbol("lastResolve"),ur=Symbol("lastReject"),hr=Symbol("error"),fr=Symbol("ended"),dr=Symbol("lastPromise"),pr=Symbol("handlePromise"),mr=Symbol("stream");function gr(wr,kr){return{value:wr,done:kr}}function yr(wr){var kr=wr[cr];if(kr!==null){var Cr=wr[mr].read();Cr!==null&&(wr[dr]=null,wr[cr]=null,wr[ur]=null,kr(gr(Cr,!1)))}}function br(wr){process$1$1.nextTick(yr,wr)}function Or(wr,kr){return function(Cr,$r){wr.then(function(){if(kr[fr]){Cr(gr(void 0,!0));return}kr[pr](Cr,$r)},$r)}}var _r=Object.getPrototypeOf(function(){}),vr=Object.setPrototypeOf((lr={get stream(){return this[mr]},next:function(){var kr=this,Cr=this[hr];if(Cr!==null)return Promise.reject(Cr);if(this[fr])return Promise.resolve(gr(void 0,!0));if(this[mr].destroyed)return new Promise(function(Fr,Vr){process$1$1.nextTick(function(){kr[hr]?Vr(kr[hr]):Fr(gr(void 0,!0))})});var $r=this[dr],Nr;if($r)Nr=new Promise(Or($r,this));else{var Br=this[mr].read();if(Br!==null)return Promise.resolve(gr(Br,!1));Nr=new Promise(this[pr])}return this[dr]=Nr,Nr}},or(lr,Symbol.asyncIterator,function(){return this}),or(lr,"return",function(){var kr=this;return new Promise(function(Cr,$r){kr[mr].destroy(null,function(Nr){if(Nr){$r(Nr);return}Cr(gr(void 0,!0))})})}),lr),_r),xr=function(kr){var Cr,$r=Object.create(vr,(Cr={},or(Cr,mr,{value:kr,writable:!0}),or(Cr,cr,{value:null,writable:!0}),or(Cr,ur,{value:null,writable:!0}),or(Cr,hr,{value:null,writable:!0}),or(Cr,fr,{value:kr._readableState.endEmitted,writable:!0}),or(Cr,pr,{value:function(Br,Fr){var Vr=$r[mr].read();Vr?($r[dr]=null,$r[cr]=null,$r[ur]=null,Br(gr(Vr,!1))):($r[cr]=Br,$r[ur]=Fr)},writable:!0}),Cr));return $r[dr]=null,ar(kr,function(Nr){if(Nr&&Nr.code!=="ERR_STREAM_PREMATURE_CLOSE"){var Br=$r[ur];Br!==null&&($r[dr]=null,$r[cr]=null,$r[ur]=null,Br(Nr)),$r[hr]=Nr;return}var Fr=$r[cr];Fr!==null&&($r[dr]=null,$r[cr]=null,$r[ur]=null,Fr(gr(void 0,!0))),$r[fr]=!0}),kr.on("readable",br.bind(null,$r)),$r};return async_iterator=xr,async_iterator}var fromBrowser,hasRequiredFromBrowser;function requireFromBrowser(){return hasRequiredFromBrowser||(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")}),fromBrowser}var _stream_readable,hasRequired_stream_readable;function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;hasRequired_stream_readable=1,_stream_readable=Rr;var lr;Rr.ReadableState=Vr,eventsExports.EventEmitter;var or=function(Xr,ri){return Xr.listeners(ri).length},ar=requireStreamBrowser(),cr=requireBuffer().Buffer,ur=commonjsGlobal.Uint8Array||function(){};function hr(jr){return cr.from(jr)}function fr(jr){return cr.isBuffer(jr)||jr instanceof ur}var dr=requireUtil(),pr;dr&&dr.debuglog?pr=dr.debuglog("stream"):pr=function(){};var mr=requireBuffer_list(),gr=requireDestroy(),yr=requireState(),br=yr.getHighWaterMark,Or=requireErrorsBrowser().codes,_r=Or.ERR_INVALID_ARG_TYPE,vr=Or.ERR_STREAM_PUSH_AFTER_EOF,xr=Or.ERR_METHOD_NOT_IMPLEMENTED,wr=Or.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,kr,Cr,$r;inherits_browserExports(Rr,ar);var Nr=gr.errorOrDestroy,Br=["error","close","destroy","pause","resume"];function Fr(jr,Xr,ri){if(typeof jr.prependListener=="function")return jr.prependListener(Xr,ri);!jr._events||!jr._events[Xr]?jr.on(Xr,ri):Array.isArray(jr._events[Xr])?jr._events[Xr].unshift(ri):jr._events[Xr]=[ri,jr._events[Xr]]}function Vr(jr,Xr,ri){lr=lr||require_stream_duplex(),jr=jr||{},typeof ri!="boolean"&&(ri=Xr instanceof lr),this.objectMode=!!jr.objectMode,ri&&(this.objectMode=this.objectMode||!!jr.readableObjectMode),this.highWaterMark=br(this,jr,"readableHighWaterMark",ri),this.buffer=new mr,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=jr.emitClose!==!1,this.autoDestroy=!!jr.autoDestroy,this.destroyed=!1,this.defaultEncoding=jr.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,jr.encoding&&(kr||(kr=requireString_decoder().StringDecoder),this.decoder=new kr(jr.encoding),this.encoding=jr.encoding)}function Rr(jr){if(lr=lr||require_stream_duplex(),!(this instanceof Rr))return new Rr(jr);var Xr=this instanceof lr;this._readableState=new Vr(jr,this,Xr),this.readable=!0,jr&&(typeof jr.read=="function"&&(this._read=jr.read),typeof jr.destroy=="function"&&(this._destroy=jr.destroy)),ar.call(this)}Object.defineProperty(Rr.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Xr){this._readableState&&(this._readableState.destroyed=Xr)}}),Rr.prototype.destroy=gr.destroy,Rr.prototype._undestroy=gr.undestroy,Rr.prototype._destroy=function(jr,Xr){Xr(jr)},Rr.prototype.push=function(jr,Xr){var ri=this._readableState,Lr;return ri.objectMode?Lr=!0:typeof jr=="string"&&(Xr=Xr||ri.defaultEncoding,Xr!==ri.encoding&&(jr=cr.from(jr,Xr),Xr=""),Lr=!0),Gr(this,jr,Xr,!1,Lr)},Rr.prototype.unshift=function(jr){return Gr(this,jr,null,!0,!1)};function Gr(jr,Xr,ri,Lr,oi){pr("readableAddChunk",Xr);var Tr=jr._readableState;if(Xr===null)Tr.reading=!1,ai(jr,Tr);else{var Sr;if(oi||(Sr=Ur(Tr,Xr)),Sr)Nr(jr,Sr);else if(Tr.objectMode||Xr&&Xr.length>0)if(typeof Xr!="string"&&!Tr.objectMode&&Object.getPrototypeOf(Xr)!==cr.prototype&&(Xr=hr(Xr)),Lr)Tr.endEmitted?Nr(jr,new wr):qr(jr,Tr,Xr,!0);else if(Tr.ended)Nr(jr,new vr);else{if(Tr.destroyed)return!1;Tr.reading=!1,Tr.decoder&&!ri?(Xr=Tr.decoder.write(Xr),Tr.objectMode||Xr.length!==0?qr(jr,Tr,Xr,!1):ii(jr,Tr)):qr(jr,Tr,Xr,!1)}else Lr||(Tr.reading=!1,ii(jr,Tr))}return!Tr.ended&&(Tr.length<Tr.highWaterMark||Tr.length===0)}function qr(jr,Xr,ri,Lr){Xr.flowing&&Xr.length===0&&!Xr.sync?(Xr.awaitDrain=0,jr.emit("data",ri)):(Xr.length+=Xr.objectMode?1:ri.length,Lr?Xr.buffer.unshift(ri):Xr.buffer.push(ri),Xr.needReadable&&Kr(jr)),ii(jr,Xr)}function Ur(jr,Xr){var ri;return!fr(Xr)&&typeof Xr!="string"&&Xr!==void 0&&!jr.objectMode&&(ri=new _r("chunk",["string","Buffer","Uint8Array"],Xr)),ri}Rr.prototype.isPaused=function(){return this._readableState.flowing===!1},Rr.prototype.setEncoding=function(jr){kr||(kr=requireString_decoder().StringDecoder);var Xr=new kr(jr);this._readableState.decoder=Xr,this._readableState.encoding=this._readableState.decoder.encoding;for(var ri=this._readableState.buffer.head,Lr="";ri!==null;)Lr+=Xr.write(ri.data),ri=ri.next;return this._readableState.buffer.clear(),Lr!==""&&this._readableState.buffer.push(Lr),this._readableState.length=Lr.length,this};var Yr=1073741824;function Dr(jr){return jr>=Yr?jr=Yr:(jr--,jr|=jr>>>1,jr|=jr>>>2,jr|=jr>>>4,jr|=jr>>>8,jr|=jr>>>16,jr++),jr}function Jr(jr,Xr){return jr<=0||Xr.length===0&&Xr.ended?0:Xr.objectMode?1:jr!==jr?Xr.flowing&&Xr.length?Xr.buffer.head.data.length:Xr.length:(jr>Xr.highWaterMark&&(Xr.highWaterMark=Dr(jr)),jr<=Xr.length?jr:Xr.ended?Xr.length:(Xr.needReadable=!0,0))}Rr.prototype.read=function(jr){pr("read",jr),jr=parseInt(jr,10);var Xr=this._readableState,ri=jr;if(jr!==0&&(Xr.emittedReadable=!1),jr===0&&Xr.needReadable&&((Xr.highWaterMark!==0?Xr.length>=Xr.highWaterMark:Xr.length>0)||Xr.ended))return pr("read: emitReadable",Xr.length,Xr.ended),Xr.length===0&&Xr.ended?Ar(this):Kr(this),null;if(jr=Jr(jr,Xr),jr===0&&Xr.ended)return Xr.length===0&&Ar(this),null;var Lr=Xr.needReadable;pr("need readable",Lr),(Xr.length===0||Xr.length-jr<Xr.highWaterMark)&&(Lr=!0,pr("length less than watermark",Lr)),Xr.ended||Xr.reading?(Lr=!1,pr("reading or ended",Lr)):Lr&&(pr("do read"),Xr.reading=!0,Xr.sync=!0,Xr.length===0&&(Xr.needReadable=!0),this._read(Xr.highWaterMark),Xr.sync=!1,Xr.reading||(jr=Jr(ri,Xr)));var oi;return jr>0?oi=Pr(jr,Xr):oi=null,oi===null?(Xr.needReadable=Xr.length<=Xr.highWaterMark,jr=0):(Xr.length-=jr,Xr.awaitDrain=0),Xr.length===0&&(Xr.ended||(Xr.needReadable=!0),ri!==jr&&Xr.ended&&Ar(this)),oi!==null&&this.emit("data",oi),oi};function ai(jr,Xr){if(pr("onEofChunk"),!Xr.ended){if(Xr.decoder){var ri=Xr.decoder.end();ri&&ri.length&&(Xr.buffer.push(ri),Xr.length+=Xr.objectMode?1:ri.length)}Xr.ended=!0,Xr.sync?Kr(jr):(Xr.needReadable=!1,Xr.emittedReadable||(Xr.emittedReadable=!0,ui(jr)))}}function Kr(jr){var Xr=jr._readableState;pr("emitReadable",Xr.needReadable,Xr.emittedReadable),Xr.needReadable=!1,Xr.emittedReadable||(pr("emitReadable",Xr.flowing),Xr.emittedReadable=!0,process$1$1.nextTick(ui,jr))}function ui(jr){var Xr=jr._readableState;pr("emitReadable_",Xr.destroyed,Xr.length,Xr.ended),!Xr.destroyed&&(Xr.length||Xr.ended)&&(jr.emit("readable"),Xr.emittedReadable=!1),Xr.needReadable=!Xr.flowing&&!Xr.ended&&Xr.length<=Xr.highWaterMark,ni(jr)}function ii(jr,Xr){Xr.readingMore||(Xr.readingMore=!0,process$1$1.nextTick(di,jr,Xr))}function di(jr,Xr){for(;!Xr.reading&&!Xr.ended&&(Xr.length<Xr.highWaterMark||Xr.flowing&&Xr.length===0);){var ri=Xr.length;if(pr("maybeReadMore read 0"),jr.read(0),ri===Xr.length)break}Xr.readingMore=!1}Rr.prototype._read=function(jr){Nr(this,new xr("_read()"))},Rr.prototype.pipe=function(jr,Xr){var ri=this,Lr=this._readableState;switch(Lr.pipesCount){case 0:Lr.pipes=jr;break;case 1:Lr.pipes=[Lr.pipes,jr];break;default:Lr.pipes.push(jr);break}Lr.pipesCount+=1,pr("pipe count=%d opts=%j",Lr.pipesCount,Xr);var oi=(!Xr||Xr.end!==!1)&&jr!==process$1$1.stdout&&jr!==process$1$1.stderr,Tr=oi?Er:fi;Lr.endEmitted?process$1$1.nextTick(Tr):ri.once("end",Tr),jr.on("unpipe",Sr);function Sr(mi,gi){pr("onunpipe"),mi===ri&&gi&&gi.hasUnpiped===!1&&(gi.hasUnpiped=!0,zr())}function Er(){pr("onend"),jr.end()}var Ir=ei(ri);jr.on("drain",Ir);var Qr=!1;function zr(){pr("cleanup"),jr.removeListener("close",pi),jr.removeListener("finish",hi),jr.removeListener("drain",Ir),jr.removeListener("error",li),jr.removeListener("unpipe",Sr),ri.removeListener("end",Er),ri.removeListener("end",fi),ri.removeListener("data",Hr),Qr=!0,Lr.awaitDrain&&(!jr._writableState||jr._writableState.needDrain)&&Ir()}ri.on("data",Hr);function Hr(mi){pr("ondata");var gi=jr.write(mi);pr("dest.write",gi),gi===!1&&((Lr.pipesCount===1&&Lr.pipes===jr||Lr.pipesCount>1&&Mr(Lr.pipes,jr)!==-1)&&!Qr&&(pr("false write response, pause",Lr.awaitDrain),Lr.awaitDrain++),ri.pause())}function li(mi){pr("onerror",mi),fi(),jr.removeListener("error",li),or(jr,"error")===0&&Nr(jr,mi)}Fr(jr,"error",li);function pi(){jr.removeListener("finish",hi),fi()}jr.once("close",pi);function hi(){pr("onfinish"),jr.removeListener("close",pi),fi()}jr.once("finish",hi);function fi(){pr("unpipe"),ri.unpipe(jr)}return jr.emit("pipe",ri),Lr.flowing||(pr("pipe resume"),ri.resume()),jr};function ei(jr){return function(){var ri=jr._readableState;pr("pipeOnDrain",ri.awaitDrain),ri.awaitDrain&&ri.awaitDrain--,ri.awaitDrain===0&&or(jr,"data")&&(ri.flowing=!0,ni(jr))}}Rr.prototype.unpipe=function(jr){var Xr=this._readableState,ri={hasUnpiped:!1};if(Xr.pipesCount===0)return this;if(Xr.pipesCount===1)return jr&&jr!==Xr.pipes?this:(jr||(jr=Xr.pipes),Xr.pipes=null,Xr.pipesCount=0,Xr.flowing=!1,jr&&jr.emit("unpipe",this,ri),this);if(!jr){var Lr=Xr.pipes,oi=Xr.pipesCount;Xr.pipes=null,Xr.pipesCount=0,Xr.flowing=!1;for(var Tr=0;Tr<oi;Tr++)Lr[Tr].emit("unpipe",this,{hasUnpiped:!1});return this}var Sr=Mr(Xr.pipes,jr);return Sr===-1?this:(Xr.pipes.splice(Sr,1),Xr.pipesCount-=1,Xr.pipesCount===1&&(Xr.pipes=Xr.pipes[0]),jr.emit("unpipe",this,ri),this)},Rr.prototype.on=function(jr,Xr){var ri=ar.prototype.on.call(this,jr,Xr),Lr=this._readableState;return jr==="data"?(Lr.readableListening=this.listenerCount("readable")>0,Lr.flowing!==!1&&this.resume()):jr==="readable"&&!Lr.endEmitted&&!Lr.readableListening&&(Lr.readableListening=Lr.needReadable=!0,Lr.flowing=!1,Lr.emittedReadable=!1,pr("on readable",Lr.length,Lr.reading),Lr.length?Kr(this):Lr.reading||process$1$1.nextTick(ti,this)),ri},Rr.prototype.addListener=Rr.prototype.on,Rr.prototype.removeListener=function(jr,Xr){var ri=ar.prototype.removeListener.call(this,jr,Xr);return jr==="readable"&&process$1$1.nextTick(Wr,this),ri},Rr.prototype.removeAllListeners=function(jr){var Xr=ar.prototype.removeAllListeners.apply(this,arguments);return(jr==="readable"||jr===void 0)&&process$1$1.nextTick(Wr,this),Xr};function Wr(jr){var Xr=jr._readableState;Xr.readableListening=jr.listenerCount("readable")>0,Xr.resumeScheduled&&!Xr.paused?Xr.flowing=!0:jr.listenerCount("data")>0&&jr.resume()}function ti(jr){pr("readable nexttick read 0"),jr.read(0)}Rr.prototype.resume=function(){var jr=this._readableState;return jr.flowing||(pr("resume"),jr.flowing=!jr.readableListening,si(this,jr)),jr.paused=!1,this};function si(jr,Xr){Xr.resumeScheduled||(Xr.resumeScheduled=!0,process$1$1.nextTick(ci,jr,Xr))}function ci(jr,Xr){pr("resume",Xr.reading),Xr.reading||jr.read(0),Xr.resumeScheduled=!1,jr.emit("resume"),ni(jr),Xr.flowing&&!Xr.reading&&jr.read(0)}Rr.prototype.pause=function(){return pr("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(pr("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function ni(jr){var Xr=jr._readableState;for(pr("flow",Xr.flowing);Xr.flowing&&jr.read()!==null;);}Rr.prototype.wrap=function(jr){var Xr=this,ri=this._readableState,Lr=!1;jr.on("end",function(){if(pr("wrapped end"),ri.decoder&&!ri.ended){var Sr=ri.decoder.end();Sr&&Sr.length&&Xr.push(Sr)}Xr.push(null)}),jr.on("data",function(Sr){if(pr("wrapped data"),ri.decoder&&(Sr=ri.decoder.write(Sr)),!(ri.objectMode&&Sr==null)&&!(!ri.objectMode&&(!Sr||!Sr.length))){var Er=Xr.push(Sr);Er||(Lr=!0,jr.pause())}});for(var oi in jr)this[oi]===void 0&&typeof jr[oi]=="function"&&(this[oi]=function(Er){return function(){return jr[Er].apply(jr,arguments)}}(oi));for(var Tr=0;Tr<Br.length;Tr++)jr.on(Br[Tr],this.emit.bind(this,Br[Tr]));return this._read=function(Sr){pr("wrapped _read",Sr),Lr&&(Lr=!1,jr.resume())},this},typeof Symbol=="function"&&(Rr.prototype[Symbol.asyncIterator]=function(){return Cr===void 0&&(Cr=requireAsync_iterator()),Cr(this)}),Object.defineProperty(Rr.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Rr.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Rr.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Xr){this._readableState&&(this._readableState.flowing=Xr)}}),Rr._fromList=Pr,Object.defineProperty(Rr.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Pr(jr,Xr){if(Xr.length===0)return null;var ri;return Xr.objectMode?ri=Xr.buffer.shift():!jr||jr>=Xr.length?(Xr.decoder?ri=Xr.buffer.join(""):Xr.buffer.length===1?ri=Xr.buffer.first():ri=Xr.buffer.concat(Xr.length),Xr.buffer.clear()):ri=Xr.buffer.consume(jr,Xr.decoder),ri}function Ar(jr){var Xr=jr._readableState;pr("endReadable",Xr.endEmitted),Xr.endEmitted||(Xr.ended=!0,process$1$1.nextTick(Zr,Xr,jr))}function Zr(jr,Xr){if(pr("endReadableNT",jr.endEmitted,jr.length),!jr.endEmitted&&jr.length===0&&(jr.endEmitted=!0,Xr.readable=!1,Xr.emit("end"),jr.autoDestroy)){var ri=Xr._writableState;(!ri||ri.autoDestroy&&ri.finished)&&Xr.destroy()}}typeof Symbol=="function"&&(Rr.from=function(jr,Xr){return $r===void 0&&($r=requireFromBrowser()),$r(Rr,jr,Xr)});function Mr(jr,Xr){for(var ri=0,Lr=jr.length;ri<Lr;ri++)if(jr[ri]===Xr)return ri;return-1}return _stream_readable}var _stream_transform,hasRequired_stream_transform;function require_stream_transform(){if(hasRequired_stream_transform)return _stream_transform;hasRequired_stream_transform=1,_stream_transform=dr;var lr=requireErrorsBrowser().codes,or=lr.ERR_METHOD_NOT_IMPLEMENTED,ar=lr.ERR_MULTIPLE_CALLBACK,cr=lr.ERR_TRANSFORM_ALREADY_TRANSFORMING,ur=lr.ERR_TRANSFORM_WITH_LENGTH_0,hr=require_stream_duplex();inherits_browserExports(dr,hr);function fr(gr,yr){var br=this._transformState;br.transforming=!1;var Or=br.writecb;if(Or===null)return this.emit("error",new ar);br.writechunk=null,br.writecb=null,yr!=null&&this.push(yr),Or(gr);var _r=this._readableState;_r.reading=!1,(_r.needReadable||_r.length<_r.highWaterMark)&&this._read(_r.highWaterMark)}function dr(gr){if(!(this instanceof dr))return new dr(gr);hr.call(this,gr),this._transformState={afterTransform:fr.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,gr&&(typeof gr.transform=="function"&&(this._transform=gr.transform),typeof gr.flush=="function"&&(this._flush=gr.flush)),this.on("prefinish",pr)}function pr(){var gr=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(yr,br){mr(gr,yr,br)}):mr(this,null,null)}dr.prototype.push=function(gr,yr){return this._transformState.needTransform=!1,hr.prototype.push.call(this,gr,yr)},dr.prototype._transform=function(gr,yr,br){br(new or("_transform()"))},dr.prototype._write=function(gr,yr,br){var Or=this._transformState;if(Or.writecb=br,Or.writechunk=gr,Or.writeencoding=yr,!Or.transforming){var _r=this._readableState;(Or.needTransform||_r.needReadable||_r.length<_r.highWaterMark)&&this._read(_r.highWaterMark)}},dr.prototype._read=function(gr){var yr=this._transformState;yr.writechunk!==null&&!yr.transforming?(yr.transforming=!0,this._transform(yr.writechunk,yr.writeencoding,yr.afterTransform)):yr.needTransform=!0},dr.prototype._destroy=function(gr,yr){hr.prototype._destroy.call(this,gr,function(br){yr(br)})};function mr(gr,yr,br){if(yr)return gr.emit("error",yr);if(br!=null&&gr.push(br),gr._writableState.length)throw new ur;if(gr._transformState.transforming)throw new cr;return gr.push(null)}return _stream_transform}var _stream_passthrough,hasRequired_stream_passthrough;function require_stream_passthrough(){if(hasRequired_stream_passthrough)return _stream_passthrough;hasRequired_stream_passthrough=1,_stream_passthrough=or;var lr=require_stream_transform();inherits_browserExports(or,lr);function or(ar){if(!(this instanceof or))return new or(ar);lr.call(this,ar)}return or.prototype._transform=function(ar,cr,ur){ur(null,ar)},_stream_passthrough}var pipeline_1,hasRequiredPipeline;function requirePipeline(){if(hasRequiredPipeline)return pipeline_1;hasRequiredPipeline=1;var lr;function or(br){var Or=!1;return function(){Or||(Or=!0,br.apply(void 0,arguments))}}var ar=requireErrorsBrowser().codes,cr=ar.ERR_MISSING_ARGS,ur=ar.ERR_STREAM_DESTROYED;function hr(br){if(br)throw br}function fr(br){return br.setHeader&&typeof br.abort=="function"}function dr(br,Or,_r,vr){vr=or(vr);var xr=!1;br.on("close",function(){xr=!0}),lr===void 0&&(lr=requireEndOfStream()),lr(br,{readable:Or,writable:_r},function(kr){if(kr)return vr(kr);xr=!0,vr()});var wr=!1;return function(kr){if(!xr&&!wr){if(wr=!0,fr(br))return br.abort();if(typeof br.destroy=="function")return br.destroy();vr(kr||new ur("pipe"))}}}function pr(br){br()}function mr(br,Or){return br.pipe(Or)}function gr(br){return!br.length||typeof br[br.length-1]!="function"?hr:br.pop()}function yr(){for(var br=arguments.length,Or=new Array(br),_r=0;_r<br;_r++)Or[_r]=arguments[_r];var vr=gr(Or);if(Array.isArray(Or[0])&&(Or=Or[0]),Or.length<2)throw new cr("streams");var xr,wr=Or.map(function(kr,Cr){var $r=Cr<Or.length-1,Nr=Cr>0;return dr(kr,$r,Nr,function(Br){xr||(xr=Br),Br&&wr.forEach(pr),!$r&&(wr.forEach(pr),vr(xr))})});return Or.reduce(mr)}return pipeline_1=yr,pipeline_1}var streamBrowserify=Stream$1,EE=eventsExports.EventEmitter,inherits=inherits_browserExports;inherits(Stream$1,EE);Stream$1.Readable=require_stream_readable();Stream$1.Writable=require_stream_writable();Stream$1.Duplex=require_stream_duplex();Stream$1.Transform=require_stream_transform();Stream$1.PassThrough=require_stream_passthrough();Stream$1.finished=requireEndOfStream();Stream$1.pipeline=requirePipeline();Stream$1.Stream=Stream$1;function Stream$1(){EE.call(this)}Stream$1.prototype.pipe=function(lr,or){var ar=this;function cr(gr){lr.writable&&lr.write(gr)===!1&&ar.pause&&ar.pause()}ar.on("data",cr);function ur(){ar.readable&&ar.resume&&ar.resume()}lr.on("drain",ur),!lr._isStdio&&(!or||or.end!==!1)&&(ar.on("end",fr),ar.on("close",dr));var hr=!1;function fr(){hr||(hr=!0,lr.end())}function dr(){hr||(hr=!0,typeof lr.destroy=="function"&&lr.destroy())}function pr(gr){if(mr(),EE.listenerCount(this,"error")===0)throw gr}ar.on("error",pr),lr.on("error",pr);function mr(){ar.removeListener("data",cr),lr.removeListener("drain",ur),ar.removeListener("end",fr),ar.removeListener("close",dr),ar.removeListener("error",pr),lr.removeListener("error",pr),ar.removeListener("end",mr),ar.removeListener("close",mr),lr.removeListener("close",mr)}return ar.on("end",mr),ar.on("close",mr),lr.on("close",mr),lr.emit("pipe",ar),lr};(function(lr){(function(or){or.parser=function(Pr,Ar){return new cr(Pr,Ar)},or.SAXParser=cr,or.SAXStream=gr,or.createStream=mr,or.MAX_BUFFER_LENGTH=64*1024;var ar=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];or.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function cr(Pr,Ar){if(!(this instanceof cr))return new cr(Pr,Ar);var Zr=this;hr(Zr),Zr.q=Zr.c="",Zr.bufferCheckPosition=or.MAX_BUFFER_LENGTH,Zr.opt=Ar||{},Zr.opt.lowercase=Zr.opt.lowercase||Zr.opt.lowercasetags,Zr.looseCase=Zr.opt.lowercase?"toLowerCase":"toUpperCase",Zr.tags=[],Zr.closed=Zr.closedRoot=Zr.sawRoot=!1,Zr.tag=Zr.error=null,Zr.strict=!!Pr,Zr.noscript=!!(Pr||Zr.opt.noscript),Zr.state=Rr.BEGIN,Zr.strictEntities=Zr.opt.strictEntities,Zr.ENTITIES=Zr.strictEntities?Object.create(or.XML_ENTITIES):Object.create(or.ENTITIES),Zr.attribList=[],Zr.opt.xmlns&&(Zr.ns=Object.create(vr)),Zr.trackPosition=Zr.opt.position!==!1,Zr.trackPosition&&(Zr.position=Zr.line=Zr.column=0),qr(Zr,"onready")}Object.create||(Object.create=function(Pr){function Ar(){}Ar.prototype=Pr;var Zr=new Ar;return Zr}),Object.keys||(Object.keys=function(Pr){var Ar=[];for(var Zr in Pr)Pr.hasOwnProperty(Zr)&&Ar.push(Zr);return Ar});function ur(Pr){for(var Ar=Math.max(or.MAX_BUFFER_LENGTH,10),Zr=0,Mr=0,jr=ar.length;Mr<jr;Mr++){var Xr=Pr[ar[Mr]].length;if(Xr>Ar)switch(ar[Mr]){case"textNode":Yr(Pr);break;case"cdata":Ur(Pr,"oncdata",Pr.cdata),Pr.cdata="";break;case"script":Ur(Pr,"onscript",Pr.script),Pr.script="";break;default:Jr(Pr,"Max buffer length exceeded: "+ar[Mr])}Zr=Math.max(Zr,Xr)}var ri=or.MAX_BUFFER_LENGTH-Zr;Pr.bufferCheckPosition=ri+Pr.position}function hr(Pr){for(var Ar=0,Zr=ar.length;Ar<Zr;Ar++)Pr[ar[Ar]]=""}function fr(Pr){Yr(Pr),Pr.cdata!==""&&(Ur(Pr,"oncdata",Pr.cdata),Pr.cdata=""),Pr.script!==""&&(Ur(Pr,"onscript",Pr.script),Pr.script="")}cr.prototype={end:function(){ai(this)},write:ni,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){fr(this)}};var dr;try{dr=streamBrowserify.Stream}catch{dr=function(){}}var pr=or.EVENTS.filter(function(Pr){return Pr!=="error"&&Pr!=="end"});function mr(Pr,Ar){return new gr(Pr,Ar)}function gr(Pr,Ar){if(!(this instanceof gr))return new gr(Pr,Ar);dr.apply(this),this._parser=new cr(Pr,Ar),this.writable=!0,this.readable=!0;var Zr=this;this._parser.onend=function(){Zr.emit("end")},this._parser.onerror=function(Mr){Zr.emit("error",Mr),Zr._parser.error=null},this._decoder=null,pr.forEach(function(Mr){Object.defineProperty(Zr,"on"+Mr,{get:function(){return Zr._parser["on"+Mr]},set:function(jr){if(!jr)return Zr.removeAllListeners(Mr),Zr._parser["on"+Mr]=jr,jr;Zr.on(Mr,jr)},enumerable:!0,configurable:!1})})}gr.prototype=Object.create(dr.prototype,{constructor:{value:gr}}),gr.prototype.write=function(Pr){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(Pr)){if(!this._decoder){var Ar=requireString_decoder().StringDecoder;this._decoder=new Ar("utf8")}Pr=this._decoder.write(Pr)}return this._parser.write(Pr.toString()),this.emit("data",Pr),!0},gr.prototype.end=function(Pr){return Pr&&Pr.length&&this.write(Pr),this._parser.end(),!0},gr.prototype.on=function(Pr,Ar){var Zr=this;return!Zr._parser["on"+Pr]&&pr.indexOf(Pr)!==-1&&(Zr._parser["on"+Pr]=function(){var Mr=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);Mr.splice(0,0,Pr),Zr.emit.apply(Zr,Mr)}),dr.prototype.on.call(Zr,Pr,Ar)};var yr="[CDATA[",br="DOCTYPE",Or="http://www.w3.org/XML/1998/namespace",_r="http://www.w3.org/2000/xmlns/",vr={xml:Or,xmlns:_r},xr=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,wr=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,kr=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Cr=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function $r(Pr){return Pr===" "||Pr===`
`||Pr==="\r"||Pr==="	"}function Nr(Pr){return Pr==='"'||Pr==="'"}function Br(Pr){return Pr===">"||$r(Pr)}function Fr(Pr,Ar){return Pr.test(Ar)}function Vr(Pr,Ar){return!Fr(Pr,Ar)}var Rr=0;or.STATE={BEGIN:Rr++,BEGIN_WHITESPACE:Rr++,TEXT:Rr++,TEXT_ENTITY:Rr++,OPEN_WAKA:Rr++,SGML_DECL:Rr++,SGML_DECL_QUOTED:Rr++,DOCTYPE:Rr++,DOCTYPE_QUOTED:Rr++,DOCTYPE_DTD:Rr++,DOCTYPE_DTD_QUOTED:Rr++,COMMENT_STARTING:Rr++,COMMENT:Rr++,COMMENT_ENDING:Rr++,COMMENT_ENDED:Rr++,CDATA:Rr++,CDATA_ENDING:Rr++,CDATA_ENDING_2:Rr++,PROC_INST:Rr++,PROC_INST_BODY:Rr++,PROC_INST_ENDING:Rr++,OPEN_TAG:Rr++,OPEN_TAG_SLASH:Rr++,ATTRIB:Rr++,ATTRIB_NAME:Rr++,ATTRIB_NAME_SAW_WHITE:Rr++,ATTRIB_VALUE:Rr++,ATTRIB_VALUE_QUOTED:Rr++,ATTRIB_VALUE_CLOSED:Rr++,ATTRIB_VALUE_UNQUOTED:Rr++,ATTRIB_VALUE_ENTITY_Q:Rr++,ATTRIB_VALUE_ENTITY_U:Rr++,CLOSE_TAG:Rr++,CLOSE_TAG_SAW_WHITE:Rr++,SCRIPT:Rr++,SCRIPT_ENDING:Rr++},or.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},or.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(or.ENTITIES).forEach(function(Pr){var Ar=or.ENTITIES[Pr],Zr=typeof Ar=="number"?String.fromCharCode(Ar):Ar;or.ENTITIES[Pr]=Zr});for(var Gr in or.STATE)or.STATE[or.STATE[Gr]]=Gr;Rr=or.STATE;function qr(Pr,Ar,Zr){Pr[Ar]&&Pr[Ar](Zr)}function Ur(Pr,Ar,Zr){Pr.textNode&&Yr(Pr),qr(Pr,Ar,Zr)}function Yr(Pr){Pr.textNode=Dr(Pr.opt,Pr.textNode),Pr.textNode&&qr(Pr,"ontext",Pr.textNode),Pr.textNode=""}function Dr(Pr,Ar){return Pr.trim&&(Ar=Ar.trim()),Pr.normalize&&(Ar=Ar.replace(/\s+/g," ")),Ar}function Jr(Pr,Ar){return Yr(Pr),Pr.trackPosition&&(Ar+=`
Line: `+Pr.line+`
Column: `+Pr.column+`
Char: `+Pr.c),Ar=new Error(Ar),Pr.error=Ar,qr(Pr,"onerror",Ar),Pr}function ai(Pr){return Pr.sawRoot&&!Pr.closedRoot&&Kr(Pr,"Unclosed root tag"),Pr.state!==Rr.BEGIN&&Pr.state!==Rr.BEGIN_WHITESPACE&&Pr.state!==Rr.TEXT&&Jr(Pr,"Unexpected end"),Yr(Pr),Pr.c="",Pr.closed=!0,qr(Pr,"onend"),cr.call(Pr,Pr.strict,Pr.opt),Pr}function Kr(Pr,Ar){if(typeof Pr!="object"||!(Pr instanceof cr))throw new Error("bad call to strictFail");Pr.strict&&Jr(Pr,Ar)}function ui(Pr){Pr.strict||(Pr.tagName=Pr.tagName[Pr.looseCase]());var Ar=Pr.tags[Pr.tags.length-1]||Pr,Zr=Pr.tag={name:Pr.tagName,attributes:{}};Pr.opt.xmlns&&(Zr.ns=Ar.ns),Pr.attribList.length=0,Ur(Pr,"onopentagstart",Zr)}function ii(Pr,Ar){var Zr=Pr.indexOf(":"),Mr=Zr<0?["",Pr]:Pr.split(":"),jr=Mr[0],Xr=Mr[1];return Ar&&Pr==="xmlns"&&(jr="xmlns",Xr=""),{prefix:jr,local:Xr}}function di(Pr){if(Pr.strict||(Pr.attribName=Pr.attribName[Pr.looseCase]()),Pr.attribList.indexOf(Pr.attribName)!==-1||Pr.tag.attributes.hasOwnProperty(Pr.attribName)){Pr.attribName=Pr.attribValue="";return}if(Pr.opt.xmlns){var Ar=ii(Pr.attribName,!0),Zr=Ar.prefix,Mr=Ar.local;if(Zr==="xmlns")if(Mr==="xml"&&Pr.attribValue!==Or)Kr(Pr,"xml: prefix must be bound to "+Or+`
Actual: `+Pr.attribValue);else if(Mr==="xmlns"&&Pr.attribValue!==_r)Kr(Pr,"xmlns: prefix must be bound to "+_r+`
Actual: `+Pr.attribValue);else{var jr=Pr.tag,Xr=Pr.tags[Pr.tags.length-1]||Pr;jr.ns===Xr.ns&&(jr.ns=Object.create(Xr.ns)),jr.ns[Mr]=Pr.attribValue}Pr.attribList.push([Pr.attribName,Pr.attribValue])}else Pr.tag.attributes[Pr.attribName]=Pr.attribValue,Ur(Pr,"onattribute",{name:Pr.attribName,value:Pr.attribValue});Pr.attribName=Pr.attribValue=""}function ei(Pr,Ar){if(Pr.opt.xmlns){var Zr=Pr.tag,Mr=ii(Pr.tagName);Zr.prefix=Mr.prefix,Zr.local=Mr.local,Zr.uri=Zr.ns[Mr.prefix]||"",Zr.prefix&&!Zr.uri&&(Kr(Pr,"Unbound namespace prefix: "+JSON.stringify(Pr.tagName)),Zr.uri=Mr.prefix);var jr=Pr.tags[Pr.tags.length-1]||Pr;Zr.ns&&jr.ns!==Zr.ns&&Object.keys(Zr.ns).forEach(function(Hr){Ur(Pr,"onopennamespace",{prefix:Hr,uri:Zr.ns[Hr]})});for(var Xr=0,ri=Pr.attribList.length;Xr<ri;Xr++){var Lr=Pr.attribList[Xr],oi=Lr[0],Tr=Lr[1],Sr=ii(oi,!0),Er=Sr.prefix,Ir=Sr.local,Qr=Er===""?"":Zr.ns[Er]||"",zr={name:oi,value:Tr,prefix:Er,local:Ir,uri:Qr};Er&&Er!=="xmlns"&&!Qr&&(Kr(Pr,"Unbound namespace prefix: "+JSON.stringify(Er)),zr.uri=Er),Pr.tag.attributes[oi]=zr,Ur(Pr,"onattribute",zr)}Pr.attribList.length=0}Pr.tag.isSelfClosing=!!Ar,Pr.sawRoot=!0,Pr.tags.push(Pr.tag),Ur(Pr,"onopentag",Pr.tag),Ar||(!Pr.noscript&&Pr.tagName.toLowerCase()==="script"?Pr.state=Rr.SCRIPT:Pr.state=Rr.TEXT,Pr.tag=null,Pr.tagName=""),Pr.attribName=Pr.attribValue="",Pr.attribList.length=0}function Wr(Pr){if(!Pr.tagName){Kr(Pr,"Weird empty close tag."),Pr.textNode+="</>",Pr.state=Rr.TEXT;return}if(Pr.script){if(Pr.tagName!=="script"){Pr.script+="</"+Pr.tagName+">",Pr.tagName="",Pr.state=Rr.SCRIPT;return}Ur(Pr,"onscript",Pr.script),Pr.script=""}var Ar=Pr.tags.length,Zr=Pr.tagName;Pr.strict||(Zr=Zr[Pr.looseCase]());for(var Mr=Zr;Ar--;){var jr=Pr.tags[Ar];if(jr.name!==Mr)Kr(Pr,"Unexpected close tag");else break}if(Ar<0){Kr(Pr,"Unmatched closing tag: "+Pr.tagName),Pr.textNode+="</"+Pr.tagName+">",Pr.state=Rr.TEXT;return}Pr.tagName=Zr;for(var Xr=Pr.tags.length;Xr-- >Ar;){var ri=Pr.tag=Pr.tags.pop();Pr.tagName=Pr.tag.name,Ur(Pr,"onclosetag",Pr.tagName);var Lr={};for(var oi in ri.ns)Lr[oi]=ri.ns[oi];var Tr=Pr.tags[Pr.tags.length-1]||Pr;Pr.opt.xmlns&&ri.ns!==Tr.ns&&Object.keys(ri.ns).forEach(function(Sr){var Er=ri.ns[Sr];Ur(Pr,"onclosenamespace",{prefix:Sr,uri:Er})})}Ar===0&&(Pr.closedRoot=!0),Pr.tagName=Pr.attribValue=Pr.attribName="",Pr.attribList.length=0,Pr.state=Rr.TEXT}function ti(Pr){var Ar=Pr.entity,Zr=Ar.toLowerCase(),Mr,jr="";return Pr.ENTITIES[Ar]?Pr.ENTITIES[Ar]:Pr.ENTITIES[Zr]?Pr.ENTITIES[Zr]:(Ar=Zr,Ar.charAt(0)==="#"&&(Ar.charAt(1)==="x"?(Ar=Ar.slice(2),Mr=parseInt(Ar,16),jr=Mr.toString(16)):(Ar=Ar.slice(1),Mr=parseInt(Ar,10),jr=Mr.toString(10))),Ar=Ar.replace(/^0+/,""),isNaN(Mr)||jr.toLowerCase()!==Ar?(Kr(Pr,"Invalid character entity"),"&"+Pr.entity+";"):String.fromCodePoint(Mr))}function si(Pr,Ar){Ar==="<"?(Pr.state=Rr.OPEN_WAKA,Pr.startTagPosition=Pr.position):$r(Ar)||(Kr(Pr,"Non-whitespace before first tag."),Pr.textNode=Ar,Pr.state=Rr.TEXT)}function ci(Pr,Ar){var Zr="";return Ar<Pr.length&&(Zr=Pr.charAt(Ar)),Zr}function ni(Pr){var Ar=this;if(this.error)throw this.error;if(Ar.closed)return Jr(Ar,"Cannot write after close. Assign an onready handler.");if(Pr===null)return ai(Ar);typeof Pr=="object"&&(Pr=Pr.toString());for(var Zr=0,Mr="";Mr=ci(Pr,Zr++),Ar.c=Mr,!!Mr;)switch(Ar.trackPosition&&(Ar.position++,Mr===`
`?(Ar.line++,Ar.column=0):Ar.column++),Ar.state){case Rr.BEGIN:if(Ar.state=Rr.BEGIN_WHITESPACE,Mr==="\uFEFF")continue;si(Ar,Mr);continue;case Rr.BEGIN_WHITESPACE:si(Ar,Mr);continue;case Rr.TEXT:if(Ar.sawRoot&&!Ar.closedRoot){for(var jr=Zr-1;Mr&&Mr!=="<"&&Mr!=="&";)Mr=ci(Pr,Zr++),Mr&&Ar.trackPosition&&(Ar.position++,Mr===`
`?(Ar.line++,Ar.column=0):Ar.column++);Ar.textNode+=Pr.substring(jr,Zr-1)}Mr==="<"&&!(Ar.sawRoot&&Ar.closedRoot&&!Ar.strict)?(Ar.state=Rr.OPEN_WAKA,Ar.startTagPosition=Ar.position):(!$r(Mr)&&(!Ar.sawRoot||Ar.closedRoot)&&Kr(Ar,"Text data outside of root node."),Mr==="&"?Ar.state=Rr.TEXT_ENTITY:Ar.textNode+=Mr);continue;case Rr.SCRIPT:Mr==="<"?Ar.state=Rr.SCRIPT_ENDING:Ar.script+=Mr;continue;case Rr.SCRIPT_ENDING:Mr==="/"?Ar.state=Rr.CLOSE_TAG:(Ar.script+="<"+Mr,Ar.state=Rr.SCRIPT);continue;case Rr.OPEN_WAKA:if(Mr==="!")Ar.state=Rr.SGML_DECL,Ar.sgmlDecl="";else if(!$r(Mr))if(Fr(xr,Mr))Ar.state=Rr.OPEN_TAG,Ar.tagName=Mr;else if(Mr==="/")Ar.state=Rr.CLOSE_TAG,Ar.tagName="";else if(Mr==="?")Ar.state=Rr.PROC_INST,Ar.procInstName=Ar.procInstBody="";else{if(Kr(Ar,"Unencoded <"),Ar.startTagPosition+1<Ar.position){var Xr=Ar.position-Ar.startTagPosition;Mr=new Array(Xr).join(" ")+Mr}Ar.textNode+="<"+Mr,Ar.state=Rr.TEXT}continue;case Rr.SGML_DECL:(Ar.sgmlDecl+Mr).toUpperCase()===yr?(Ur(Ar,"onopencdata"),Ar.state=Rr.CDATA,Ar.sgmlDecl="",Ar.cdata=""):Ar.sgmlDecl+Mr==="--"?(Ar.state=Rr.COMMENT,Ar.comment="",Ar.sgmlDecl=""):(Ar.sgmlDecl+Mr).toUpperCase()===br?(Ar.state=Rr.DOCTYPE,(Ar.doctype||Ar.sawRoot)&&Kr(Ar,"Inappropriately located doctype declaration"),Ar.doctype="",Ar.sgmlDecl=""):Mr===">"?(Ur(Ar,"onsgmldeclaration",Ar.sgmlDecl),Ar.sgmlDecl="",Ar.state=Rr.TEXT):(Nr(Mr)&&(Ar.state=Rr.SGML_DECL_QUOTED),Ar.sgmlDecl+=Mr);continue;case Rr.SGML_DECL_QUOTED:Mr===Ar.q&&(Ar.state=Rr.SGML_DECL,Ar.q=""),Ar.sgmlDecl+=Mr;continue;case Rr.DOCTYPE:Mr===">"?(Ar.state=Rr.TEXT,Ur(Ar,"ondoctype",Ar.doctype),Ar.doctype=!0):(Ar.doctype+=Mr,Mr==="["?Ar.state=Rr.DOCTYPE_DTD:Nr(Mr)&&(Ar.state=Rr.DOCTYPE_QUOTED,Ar.q=Mr));continue;case Rr.DOCTYPE_QUOTED:Ar.doctype+=Mr,Mr===Ar.q&&(Ar.q="",Ar.state=Rr.DOCTYPE);continue;case Rr.DOCTYPE_DTD:Ar.doctype+=Mr,Mr==="]"?Ar.state=Rr.DOCTYPE:Nr(Mr)&&(Ar.state=Rr.DOCTYPE_DTD_QUOTED,Ar.q=Mr);continue;case Rr.DOCTYPE_DTD_QUOTED:Ar.doctype+=Mr,Mr===Ar.q&&(Ar.state=Rr.DOCTYPE_DTD,Ar.q="");continue;case Rr.COMMENT:Mr==="-"?Ar.state=Rr.COMMENT_ENDING:Ar.comment+=Mr;continue;case Rr.COMMENT_ENDING:Mr==="-"?(Ar.state=Rr.COMMENT_ENDED,Ar.comment=Dr(Ar.opt,Ar.comment),Ar.comment&&Ur(Ar,"oncomment",Ar.comment),Ar.comment=""):(Ar.comment+="-"+Mr,Ar.state=Rr.COMMENT);continue;case Rr.COMMENT_ENDED:Mr!==">"?(Kr(Ar,"Malformed comment"),Ar.comment+="--"+Mr,Ar.state=Rr.COMMENT):Ar.state=Rr.TEXT;continue;case Rr.CDATA:Mr==="]"?Ar.state=Rr.CDATA_ENDING:Ar.cdata+=Mr;continue;case Rr.CDATA_ENDING:Mr==="]"?Ar.state=Rr.CDATA_ENDING_2:(Ar.cdata+="]"+Mr,Ar.state=Rr.CDATA);continue;case Rr.CDATA_ENDING_2:Mr===">"?(Ar.cdata&&Ur(Ar,"oncdata",Ar.cdata),Ur(Ar,"onclosecdata"),Ar.cdata="",Ar.state=Rr.TEXT):Mr==="]"?Ar.cdata+="]":(Ar.cdata+="]]"+Mr,Ar.state=Rr.CDATA);continue;case Rr.PROC_INST:Mr==="?"?Ar.state=Rr.PROC_INST_ENDING:$r(Mr)?Ar.state=Rr.PROC_INST_BODY:Ar.procInstName+=Mr;continue;case Rr.PROC_INST_BODY:if(!Ar.procInstBody&&$r(Mr))continue;Mr==="?"?Ar.state=Rr.PROC_INST_ENDING:Ar.procInstBody+=Mr;continue;case Rr.PROC_INST_ENDING:Mr===">"?(Ur(Ar,"onprocessinginstruction",{name:Ar.procInstName,body:Ar.procInstBody}),Ar.procInstName=Ar.procInstBody="",Ar.state=Rr.TEXT):(Ar.procInstBody+="?"+Mr,Ar.state=Rr.PROC_INST_BODY);continue;case Rr.OPEN_TAG:Fr(wr,Mr)?Ar.tagName+=Mr:(ui(Ar),Mr===">"?ei(Ar):Mr==="/"?Ar.state=Rr.OPEN_TAG_SLASH:($r(Mr)||Kr(Ar,"Invalid character in tag name"),Ar.state=Rr.ATTRIB));continue;case Rr.OPEN_TAG_SLASH:Mr===">"?(ei(Ar,!0),Wr(Ar)):(Kr(Ar,"Forward-slash in opening tag not followed by >"),Ar.state=Rr.ATTRIB);continue;case Rr.ATTRIB:if($r(Mr))continue;Mr===">"?ei(Ar):Mr==="/"?Ar.state=Rr.OPEN_TAG_SLASH:Fr(xr,Mr)?(Ar.attribName=Mr,Ar.attribValue="",Ar.state=Rr.ATTRIB_NAME):Kr(Ar,"Invalid attribute name");continue;case Rr.ATTRIB_NAME:Mr==="="?Ar.state=Rr.ATTRIB_VALUE:Mr===">"?(Kr(Ar,"Attribute without value"),Ar.attribValue=Ar.attribName,di(Ar),ei(Ar)):$r(Mr)?Ar.state=Rr.ATTRIB_NAME_SAW_WHITE:Fr(wr,Mr)?Ar.attribName+=Mr:Kr(Ar,"Invalid attribute name");continue;case Rr.ATTRIB_NAME_SAW_WHITE:if(Mr==="=")Ar.state=Rr.ATTRIB_VALUE;else{if($r(Mr))continue;Kr(Ar,"Attribute without value"),Ar.tag.attributes[Ar.attribName]="",Ar.attribValue="",Ur(Ar,"onattribute",{name:Ar.attribName,value:""}),Ar.attribName="",Mr===">"?ei(Ar):Fr(xr,Mr)?(Ar.attribName=Mr,Ar.state=Rr.ATTRIB_NAME):(Kr(Ar,"Invalid attribute name"),Ar.state=Rr.ATTRIB)}continue;case Rr.ATTRIB_VALUE:if($r(Mr))continue;Nr(Mr)?(Ar.q=Mr,Ar.state=Rr.ATTRIB_VALUE_QUOTED):(Kr(Ar,"Unquoted attribute value"),Ar.state=Rr.ATTRIB_VALUE_UNQUOTED,Ar.attribValue=Mr);continue;case Rr.ATTRIB_VALUE_QUOTED:if(Mr!==Ar.q){Mr==="&"?Ar.state=Rr.ATTRIB_VALUE_ENTITY_Q:Ar.attribValue+=Mr;continue}di(Ar),Ar.q="",Ar.state=Rr.ATTRIB_VALUE_CLOSED;continue;case Rr.ATTRIB_VALUE_CLOSED:$r(Mr)?Ar.state=Rr.ATTRIB:Mr===">"?ei(Ar):Mr==="/"?Ar.state=Rr.OPEN_TAG_SLASH:Fr(xr,Mr)?(Kr(Ar,"No whitespace between attributes"),Ar.attribName=Mr,Ar.attribValue="",Ar.state=Rr.ATTRIB_NAME):Kr(Ar,"Invalid attribute name");continue;case Rr.ATTRIB_VALUE_UNQUOTED:if(!Br(Mr)){Mr==="&"?Ar.state=Rr.ATTRIB_VALUE_ENTITY_U:Ar.attribValue+=Mr;continue}di(Ar),Mr===">"?ei(Ar):Ar.state=Rr.ATTRIB;continue;case Rr.CLOSE_TAG:if(Ar.tagName)Mr===">"?Wr(Ar):Fr(wr,Mr)?Ar.tagName+=Mr:Ar.script?(Ar.script+="</"+Ar.tagName,Ar.tagName="",Ar.state=Rr.SCRIPT):($r(Mr)||Kr(Ar,"Invalid tagname in closing tag"),Ar.state=Rr.CLOSE_TAG_SAW_WHITE);else{if($r(Mr))continue;Vr(xr,Mr)?Ar.script?(Ar.script+="</"+Mr,Ar.state=Rr.SCRIPT):Kr(Ar,"Invalid tagname in closing tag."):Ar.tagName=Mr}continue;case Rr.CLOSE_TAG_SAW_WHITE:if($r(Mr))continue;Mr===">"?Wr(Ar):Kr(Ar,"Invalid characters in closing tag");continue;case Rr.TEXT_ENTITY:case Rr.ATTRIB_VALUE_ENTITY_Q:case Rr.ATTRIB_VALUE_ENTITY_U:var ri,Lr;switch(Ar.state){case Rr.TEXT_ENTITY:ri=Rr.TEXT,Lr="textNode";break;case Rr.ATTRIB_VALUE_ENTITY_Q:ri=Rr.ATTRIB_VALUE_QUOTED,Lr="attribValue";break;case Rr.ATTRIB_VALUE_ENTITY_U:ri=Rr.ATTRIB_VALUE_UNQUOTED,Lr="attribValue";break}Mr===";"?(Ar[Lr]+=ti(Ar),Ar.entity="",Ar.state=ri):Fr(Ar.entity.length?Cr:kr,Mr)?Ar.entity+=Mr:(Kr(Ar,"Invalid character in entity name"),Ar[Lr]+="&"+Ar.entity+Mr,Ar.entity="",Ar.state=ri);continue;default:throw new Error(Ar,"Unknown state: "+Ar.state)}return Ar.position>=Ar.bufferCheckPosition&&ur(Ar),Ar}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var Pr=String.fromCharCode,Ar=Math.floor,Zr=function(){var Mr=16384,jr=[],Xr,ri,Lr=-1,oi=arguments.length;if(!oi)return"";for(var Tr="";++Lr<oi;){var Sr=Number(arguments[Lr]);if(!isFinite(Sr)||Sr<0||Sr>1114111||Ar(Sr)!==Sr)throw RangeError("Invalid code point: "+Sr);Sr<=65535?jr.push(Sr):(Sr-=65536,Xr=(Sr>>10)+55296,ri=Sr%1024+56320,jr.push(Xr,ri)),(Lr+1===oi||jr.length>Mr)&&(Tr+=Pr.apply(null,jr),jr.length=0)}return Tr};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:Zr,configurable:!0,writable:!0}):String.fromCodePoint=Zr}()})(lr)})(sax$1);var arrayHelper={isArray:function(lr){return Array.isArray?Array.isArray(lr):Object.prototype.toString.call(lr)==="[object Array]"}},isArray$2=arrayHelper.isArray,optionsHelper={copyOptions:function(lr){var or,ar={};for(or in lr)lr.hasOwnProperty(or)&&(ar[or]=lr[or]);return ar},ensureFlagExists:function(lr,or){(!(lr in or)||typeof or[lr]!="boolean")&&(or[lr]=!1)},ensureSpacesExists:function(lr){(!("spaces"in lr)||typeof lr.spaces!="number"&&typeof lr.spaces!="string")&&(lr.spaces=0)},ensureAlwaysArrayExists:function(lr){(!("alwaysArray"in lr)||typeof lr.alwaysArray!="boolean"&&!isArray$2(lr.alwaysArray))&&(lr.alwaysArray=!1)},ensureKeyExists:function(lr,or){(!(lr+"Key"in or)||typeof or[lr+"Key"]!="string")&&(or[lr+"Key"]=or.compact?"_"+lr:lr)},checkFnExists:function(lr,or){return lr+"Fn"in or}},sax=sax$1,helper$2=optionsHelper,isArray$1=arrayHelper.isArray,options,currentElement$1;function validateOptions$2(lr){return options=helper$2.copyOptions(lr),helper$2.ensureFlagExists("ignoreDeclaration",options),helper$2.ensureFlagExists("ignoreInstruction",options),helper$2.ensureFlagExists("ignoreAttributes",options),helper$2.ensureFlagExists("ignoreText",options),helper$2.ensureFlagExists("ignoreComment",options),helper$2.ensureFlagExists("ignoreCdata",options),helper$2.ensureFlagExists("ignoreDoctype",options),helper$2.ensureFlagExists("compact",options),helper$2.ensureFlagExists("alwaysChildren",options),helper$2.ensureFlagExists("addParent",options),helper$2.ensureFlagExists("trim",options),helper$2.ensureFlagExists("nativeType",options),helper$2.ensureFlagExists("nativeTypeAttributes",options),helper$2.ensureFlagExists("sanitize",options),helper$2.ensureFlagExists("instructionHasAttributes",options),helper$2.ensureFlagExists("captureSpacesBetweenElements",options),helper$2.ensureAlwaysArrayExists(options),helper$2.ensureKeyExists("declaration",options),helper$2.ensureKeyExists("instruction",options),helper$2.ensureKeyExists("attributes",options),helper$2.ensureKeyExists("text",options),helper$2.ensureKeyExists("comment",options),helper$2.ensureKeyExists("cdata",options),helper$2.ensureKeyExists("doctype",options),helper$2.ensureKeyExists("type",options),helper$2.ensureKeyExists("name",options),helper$2.ensureKeyExists("elements",options),helper$2.ensureKeyExists("parent",options),options}function nativeType(lr){var or=Number(lr);if(!isNaN(or))return or;var ar=lr.toLowerCase();return ar==="true"?!0:ar==="false"?!1:lr}function addField(lr,or){var ar;if(options.compact){if(!currentElement$1[options[lr+"Key"]]&&(isArray$1(options.alwaysArray)?options.alwaysArray.indexOf(options[lr+"Key"])!==-1:options.alwaysArray)&&(currentElement$1[options[lr+"Key"]]=[]),currentElement$1[options[lr+"Key"]]&&!isArray$1(currentElement$1[options[lr+"Key"]])&&(currentElement$1[options[lr+"Key"]]=[currentElement$1[options[lr+"Key"]]]),lr+"Fn"in options&&typeof or=="string"&&(or=options[lr+"Fn"](or,currentElement$1)),lr==="instruction"&&("instructionFn"in options||"instructionNameFn"in options)){for(ar in or)if(or.hasOwnProperty(ar))if("instructionFn"in options)or[ar]=options.instructionFn(or[ar],ar,currentElement$1);else{var cr=or[ar];delete or[ar],or[options.instructionNameFn(ar,cr,currentElement$1)]=cr}}isArray$1(currentElement$1[options[lr+"Key"]])?currentElement$1[options[lr+"Key"]].push(or):currentElement$1[options[lr+"Key"]]=or}else{currentElement$1[options.elementsKey]||(currentElement$1[options.elementsKey]=[]);var ur={};if(ur[options.typeKey]=lr,lr==="instruction"){for(ar in or)if(or.hasOwnProperty(ar))break;ur[options.nameKey]="instructionNameFn"in options?options.instructionNameFn(ar,or,currentElement$1):ar,options.instructionHasAttributes?(ur[options.attributesKey]=or[ar][options.attributesKey],"instructionFn"in options&&(ur[options.attributesKey]=options.instructionFn(ur[options.attributesKey],ar,currentElement$1))):("instructionFn"in options&&(or[ar]=options.instructionFn(or[ar],ar,currentElement$1)),ur[options.instructionKey]=or[ar])}else lr+"Fn"in options&&(or=options[lr+"Fn"](or,currentElement$1)),ur[options[lr+"Key"]]=or;options.addParent&&(ur[options.parentKey]=currentElement$1),currentElement$1[options.elementsKey].push(ur)}}function manipulateAttributes(lr){if("attributesFn"in options&&lr&&(lr=options.attributesFn(lr,currentElement$1)),(options.trim||"attributeValueFn"in options||"attributeNameFn"in options||options.nativeTypeAttributes)&&lr){var or;for(or in lr)if(lr.hasOwnProperty(or)&&(options.trim&&(lr[or]=lr[or].trim()),options.nativeTypeAttributes&&(lr[or]=nativeType(lr[or])),"attributeValueFn"in options&&(lr[or]=options.attributeValueFn(lr[or],or,currentElement$1)),"attributeNameFn"in options)){var ar=lr[or];delete lr[or],lr[options.attributeNameFn(or,lr[or],currentElement$1)]=ar}}return lr}function onInstruction(lr){var or={};if(lr.body&&(lr.name.toLowerCase()==="xml"||options.instructionHasAttributes)){for(var ar=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,cr;(cr=ar.exec(lr.body))!==null;)or[cr[1]]=cr[2]||cr[3]||cr[4];or=manipulateAttributes(or)}if(lr.name.toLowerCase()==="xml"){if(options.ignoreDeclaration)return;currentElement$1[options.declarationKey]={},Object.keys(or).length&&(currentElement$1[options.declarationKey][options.attributesKey]=or),options.addParent&&(currentElement$1[options.declarationKey][options.parentKey]=currentElement$1)}else{if(options.ignoreInstruction)return;options.trim&&(lr.body=lr.body.trim());var ur={};options.instructionHasAttributes&&Object.keys(or).length?(ur[lr.name]={},ur[lr.name][options.attributesKey]=or):ur[lr.name]=lr.body,addField("instruction",ur)}}function onStartElement(lr,or){var ar;if(typeof lr=="object"&&(or=lr.attributes,lr=lr.name),or=manipulateAttributes(or),"elementNameFn"in options&&(lr=options.elementNameFn(lr,currentElement$1)),options.compact){if(ar={},!options.ignoreAttributes&&or&&Object.keys(or).length){ar[options.attributesKey]={};var cr;for(cr in or)or.hasOwnProperty(cr)&&(ar[options.attributesKey][cr]=or[cr])}!(lr in currentElement$1)&&(isArray$1(options.alwaysArray)?options.alwaysArray.indexOf(lr)!==-1:options.alwaysArray)&&(currentElement$1[lr]=[]),currentElement$1[lr]&&!isArray$1(currentElement$1[lr])&&(currentElement$1[lr]=[currentElement$1[lr]]),isArray$1(currentElement$1[lr])?currentElement$1[lr].push(ar):currentElement$1[lr]=ar}else currentElement$1[options.elementsKey]||(currentElement$1[options.elementsKey]=[]),ar={},ar[options.typeKey]="element",ar[options.nameKey]=lr,!options.ignoreAttributes&&or&&Object.keys(or).length&&(ar[options.attributesKey]=or),options.alwaysChildren&&(ar[options.elementsKey]=[]),currentElement$1[options.elementsKey].push(ar);ar[options.parentKey]=currentElement$1,currentElement$1=ar}function onText(lr){options.ignoreText||!lr.trim()&&!options.captureSpacesBetweenElements||(options.trim&&(lr=lr.trim()),options.nativeType&&(lr=nativeType(lr)),options.sanitize&&(lr=lr.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),addField("text",lr))}function onComment(lr){options.ignoreComment||(options.trim&&(lr=lr.trim()),addField("comment",lr))}function onEndElement(lr){var or=currentElement$1[options.parentKey];options.addParent||delete currentElement$1[options.parentKey],currentElement$1=or}function onCdata(lr){options.ignoreCdata||(options.trim&&(lr=lr.trim()),addField("cdata",lr))}function onDoctype(lr){options.ignoreDoctype||(lr=lr.replace(/^ /,""),options.trim&&(lr=lr.trim()),addField("doctype",lr))}function onError(lr){lr.note=lr}var xml2js$2=function(lr,or){var ar=sax.parser(!0,{}),cr={};if(currentElement$1=cr,options=validateOptions$2(or),ar.opt={strictEntities:!0},ar.onopentag=onStartElement,ar.ontext=onText,ar.oncomment=onComment,ar.onclosetag=onEndElement,ar.onerror=onError,ar.oncdata=onCdata,ar.ondoctype=onDoctype,ar.onprocessinginstruction=onInstruction,ar.write(lr).close(),cr[options.elementsKey]){var ur=cr[options.elementsKey];delete cr[options.elementsKey],cr[options.elementsKey]=ur,delete cr.text}return cr},helper$1=optionsHelper,xml2js$1=xml2js$2;function validateOptions$1(lr){var or=helper$1.copyOptions(lr);return helper$1.ensureSpacesExists(or),or}var xml2json$1=function(lr,or){var ar,cr,ur,hr;return ar=validateOptions$1(or),cr=xml2js$1(lr,ar),hr="compact"in ar&&ar.compact?"_parent":"parent","addParent"in ar&&ar.addParent?ur=JSON.stringify(cr,function(fr,dr){return fr===hr?"_":dr},ar.spaces):ur=JSON.stringify(cr,null,ar.spaces),ur.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},helper=optionsHelper,isArray=arrayHelper.isArray,currentElement,currentElementName;function validateOptions(lr){var or=helper.copyOptions(lr);return helper.ensureFlagExists("ignoreDeclaration",or),helper.ensureFlagExists("ignoreInstruction",or),helper.ensureFlagExists("ignoreAttributes",or),helper.ensureFlagExists("ignoreText",or),helper.ensureFlagExists("ignoreComment",or),helper.ensureFlagExists("ignoreCdata",or),helper.ensureFlagExists("ignoreDoctype",or),helper.ensureFlagExists("compact",or),helper.ensureFlagExists("indentText",or),helper.ensureFlagExists("indentCdata",or),helper.ensureFlagExists("indentAttributes",or),helper.ensureFlagExists("indentInstruction",or),helper.ensureFlagExists("fullTagEmptyElement",or),helper.ensureFlagExists("noQuotesForNativeAttributes",or),helper.ensureSpacesExists(or),typeof or.spaces=="number"&&(or.spaces=Array(or.spaces+1).join(" ")),helper.ensureKeyExists("declaration",or),helper.ensureKeyExists("instruction",or),helper.ensureKeyExists("attributes",or),helper.ensureKeyExists("text",or),helper.ensureKeyExists("comment",or),helper.ensureKeyExists("cdata",or),helper.ensureKeyExists("doctype",or),helper.ensureKeyExists("type",or),helper.ensureKeyExists("name",or),helper.ensureKeyExists("elements",or),or}function writeIndentation(lr,or,ar){return(!ar&&lr.spaces?`
`:"")+Array(or+1).join(lr.spaces)}function writeAttributes(lr,or,ar){if(or.ignoreAttributes)return"";"attributesFn"in or&&(lr=or.attributesFn(lr,currentElementName,currentElement));var cr,ur,hr,fr,dr=[];for(cr in lr)lr.hasOwnProperty(cr)&&lr[cr]!==null&&lr[cr]!==void 0&&(fr=or.noQuotesForNativeAttributes&&typeof lr[cr]!="string"?"":'"',ur=""+lr[cr],ur=ur.replace(/"/g,"&quot;"),hr="attributeNameFn"in or?or.attributeNameFn(cr,ur,currentElementName,currentElement):cr,dr.push(or.spaces&&or.indentAttributes?writeIndentation(or,ar+1,!1):" "),dr.push(hr+"="+fr+("attributeValueFn"in or?or.attributeValueFn(ur,cr,currentElementName,currentElement):ur)+fr));return lr&&Object.keys(lr).length&&or.spaces&&or.indentAttributes&&dr.push(writeIndentation(or,ar,!1)),dr.join("")}function writeDeclaration(lr,or,ar){return currentElement=lr,currentElementName="xml",or.ignoreDeclaration?"":"<?xml"+writeAttributes(lr[or.attributesKey],or,ar)+"?>"}function writeInstruction(lr,or,ar){if(or.ignoreInstruction)return"";var cr;for(cr in lr)if(lr.hasOwnProperty(cr))break;var ur="instructionNameFn"in or?or.instructionNameFn(cr,lr[cr],currentElementName,currentElement):cr;if(typeof lr[cr]=="object")return currentElement=lr,currentElementName=ur,"<?"+ur+writeAttributes(lr[cr][or.attributesKey],or,ar)+"?>";var hr=lr[cr]?lr[cr]:"";return"instructionFn"in or&&(hr=or.instructionFn(hr,cr,currentElementName,currentElement)),"<?"+ur+(hr?" "+hr:"")+"?>"}function writeComment(lr,or){return or.ignoreComment?"":"<!--"+("commentFn"in or?or.commentFn(lr,currentElementName,currentElement):lr)+"-->"}function writeCdata(lr,or){return or.ignoreCdata?"":"<![CDATA["+("cdataFn"in or?or.cdataFn(lr,currentElementName,currentElement):lr.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function writeDoctype(lr,or){return or.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in or?or.doctypeFn(lr,currentElementName,currentElement):lr)+">"}function writeText(lr,or){return or.ignoreText?"":(lr=""+lr,lr=lr.replace(/&amp;/g,"&"),lr=lr.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in or?or.textFn(lr,currentElementName,currentElement):lr)}function hasContent(lr,or){var ar;if(lr.elements&&lr.elements.length)for(ar=0;ar<lr.elements.length;++ar)switch(lr.elements[ar][or.typeKey]){case"text":if(or.indentText)return!0;break;case"cdata":if(or.indentCdata)return!0;break;case"instruction":if(or.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function writeElement(lr,or,ar){currentElement=lr,currentElementName=lr.name;var cr=[],ur="elementNameFn"in or?or.elementNameFn(lr.name,lr):lr.name;cr.push("<"+ur),lr[or.attributesKey]&&cr.push(writeAttributes(lr[or.attributesKey],or,ar));var hr=lr[or.elementsKey]&&lr[or.elementsKey].length||lr[or.attributesKey]&&lr[or.attributesKey]["xml:space"]==="preserve";return hr||("fullTagEmptyElementFn"in or?hr=or.fullTagEmptyElementFn(lr.name,lr):hr=or.fullTagEmptyElement),hr?(cr.push(">"),lr[or.elementsKey]&&lr[or.elementsKey].length&&(cr.push(writeElements(lr[or.elementsKey],or,ar+1)),currentElement=lr,currentElementName=lr.name),cr.push(or.spaces&&hasContent(lr,or)?`
`+Array(ar+1).join(or.spaces):""),cr.push("</"+ur+">")):cr.push("/>"),cr.join("")}function writeElements(lr,or,ar,cr){return lr.reduce(function(ur,hr){var fr=writeIndentation(or,ar,cr&&!ur);switch(hr.type){case"element":return ur+fr+writeElement(hr,or,ar);case"comment":return ur+fr+writeComment(hr[or.commentKey],or);case"doctype":return ur+fr+writeDoctype(hr[or.doctypeKey],or);case"cdata":return ur+(or.indentCdata?fr:"")+writeCdata(hr[or.cdataKey],or);case"text":return ur+(or.indentText?fr:"")+writeText(hr[or.textKey],or);case"instruction":var dr={};return dr[hr[or.nameKey]]=hr[or.attributesKey]?hr:hr[or.instructionKey],ur+(or.indentInstruction?fr:"")+writeInstruction(dr,or,ar)}},"")}function hasContentCompact(lr,or,ar){var cr;for(cr in lr)if(lr.hasOwnProperty(cr))switch(cr){case or.parentKey:case or.attributesKey:break;case or.textKey:if(or.indentText||ar)return!0;break;case or.cdataKey:if(or.indentCdata||ar)return!0;break;case or.instructionKey:if(or.indentInstruction||ar)return!0;break;case or.doctypeKey:case or.commentKey:return!0;default:return!0}return!1}function writeElementCompact(lr,or,ar,cr,ur){currentElement=lr,currentElementName=or;var hr="elementNameFn"in ar?ar.elementNameFn(or,lr):or;if(typeof lr>"u"||lr===null||lr==="")return"fullTagEmptyElementFn"in ar&&ar.fullTagEmptyElementFn(or,lr)||ar.fullTagEmptyElement?"<"+hr+"></"+hr+">":"<"+hr+"/>";var fr=[];if(or){if(fr.push("<"+hr),typeof lr!="object")return fr.push(">"+writeText(lr,ar)+"</"+hr+">"),fr.join("");lr[ar.attributesKey]&&fr.push(writeAttributes(lr[ar.attributesKey],ar,cr));var dr=hasContentCompact(lr,ar,!0)||lr[ar.attributesKey]&&lr[ar.attributesKey]["xml:space"]==="preserve";if(dr||("fullTagEmptyElementFn"in ar?dr=ar.fullTagEmptyElementFn(or,lr):dr=ar.fullTagEmptyElement),dr)fr.push(">");else return fr.push("/>"),fr.join("")}return fr.push(writeElementsCompact(lr,ar,cr+1,!1)),currentElement=lr,currentElementName=or,or&&fr.push((ur?writeIndentation(ar,cr,!1):"")+"</"+hr+">"),fr.join("")}function writeElementsCompact(lr,or,ar,cr){var ur,hr,fr,dr=[];for(hr in lr)if(lr.hasOwnProperty(hr))for(fr=isArray(lr[hr])?lr[hr]:[lr[hr]],ur=0;ur<fr.length;++ur){switch(hr){case or.declarationKey:dr.push(writeDeclaration(fr[ur],or,ar));break;case or.instructionKey:dr.push((or.indentInstruction?writeIndentation(or,ar,cr):"")+writeInstruction(fr[ur],or,ar));break;case or.attributesKey:case or.parentKey:break;case or.textKey:dr.push((or.indentText?writeIndentation(or,ar,cr):"")+writeText(fr[ur],or));break;case or.cdataKey:dr.push((or.indentCdata?writeIndentation(or,ar,cr):"")+writeCdata(fr[ur],or));break;case or.doctypeKey:dr.push(writeIndentation(or,ar,cr)+writeDoctype(fr[ur],or));break;case or.commentKey:dr.push(writeIndentation(or,ar,cr)+writeComment(fr[ur],or));break;default:dr.push(writeIndentation(or,ar,cr)+writeElementCompact(fr[ur],hr,or,ar,hasContentCompact(fr[ur],or)))}cr=cr&&!dr.length}return dr.join("")}var js2xml$2=function(lr,or){or=validateOptions(or);var ar=[];return currentElement=lr,currentElementName="_root_",or.compact?ar.push(writeElementsCompact(lr,or,0,!0)):(lr[or.declarationKey]&&ar.push(writeDeclaration(lr[or.declarationKey],or,0)),lr[or.elementsKey]&&lr[or.elementsKey].length&&ar.push(writeElements(lr[or.elementsKey],or,0,!ar.length))),ar.join("")},js2xml$1=js2xml$2,json2xml$1=function(lr,or){lr instanceof Buffer&&(lr=lr.toString());var ar=null;if(typeof lr=="string")try{ar=JSON.parse(lr)}catch{throw new Error("The JSON structure is invalid")}else ar=lr;return js2xml$1(ar,or)},xml2js=xml2js$2,xml2json=xml2json$1,js2xml=js2xml$2,json2xml=json2xml$1,lib={xml2js,xml2json,js2xml,json2xml};const convertToXmlComponent=lr=>{switch(lr.type){case void 0:case"element":const or=new ImportedXmlComponent(lr.name,lr.attributes),ar=lr.elements||[];for(const cr of ar){const ur=convertToXmlComponent(cr);ur!==void 0&&or.push(ur)}return or;case"text":return lr.text;default:return}};class ImportedXmlComponentAttributes extends XmlAttributeComponent{}class ImportedXmlComponent extends XmlComponent{static fromXmlString(or){const ar=lib.xml2js(or,{compact:!1});return convertToXmlComponent(ar)}constructor(or,ar){super(or),ar&&this.root.push(new ImportedXmlComponentAttributes(ar))}push(or){this.root.push(or)}}class ImportedRootElementAttributes extends XmlComponent{constructor(or){super(""),this._attr=or}prepForXml(or){return{_attr:this._attr}}}class InitializableXmlComponent extends XmlComponent{constructor(or,ar){super(or),ar&&(this.root=ar.root)}}const decimalNumber=lr=>{if(isNaN(lr))throw new Error(`Invalid value '${lr}' specified. Must be an integer.`);return Math.floor(lr)},unsignedDecimalNumber=lr=>{const or=decimalNumber(lr);if(or<0)throw new Error(`Invalid value '${lr}' specified. Must be a positive integer.`);return or},hexBinary=(lr,or)=>{const ar=or*2;if(lr.length!==ar||isNaN(+`0x${lr}`))throw new Error(`Invalid hex value '${lr}'. Expected ${ar} digit hex value`);return lr},uCharHexNumber=lr=>hexBinary(lr,1),universalMeasureValue=lr=>{const or=lr.slice(-2),ar=lr.substring(0,lr.length-2);return`${Number(ar)}${or}`},positiveUniversalMeasureValue=lr=>{const or=universalMeasureValue(lr);if(parseFloat(or)<0)throw new Error(`Invalid value '${or}' specified. Expected a positive number.`);return or},hexColorValue=lr=>{if(lr==="auto")return lr;const or=lr.charAt(0)==="#"?lr.substring(1):lr;return hexBinary(or,3)},signedTwipsMeasureValue=lr=>typeof lr=="string"?universalMeasureValue(lr):decimalNumber(lr),hpsMeasureValue=lr=>typeof lr=="string"?positiveUniversalMeasureValue(lr):unsignedDecimalNumber(lr),twipsMeasureValue=lr=>typeof lr=="string"?positiveUniversalMeasureValue(lr):unsignedDecimalNumber(lr),eighthPointMeasureValue=unsignedDecimalNumber,pointMeasureValue=unsignedDecimalNumber,dateTimeValue=lr=>lr.toISOString();class OnOffElement extends XmlComponent{constructor(or,ar=!0){super(or),ar!==!0&&this.root.push(new Attributes({val:ar}))}}class HpsMeasureElement extends XmlComponent{constructor(or,ar){super(or),this.root.push(new Attributes({val:hpsMeasureValue(ar)}))}}class StringValueElement extends XmlComponent{constructor(or,ar){super(or),this.root.push(new Attributes({val:ar}))}}class NumberValueElement extends XmlComponent{constructor(or,ar){super(or),this.root.push(new Attributes({val:ar}))}}class StringContainer extends XmlComponent{constructor(or,ar){super(or),this.root.push(ar)}}class BuilderElement extends XmlComponent{constructor(or){super(or.name),or.attributes&&this.root.push(new NextAttributeComponent(or.attributes))}}var AlignmentType=(lr=>(lr.START="start",lr.CENTER="center",lr.END="end",lr.BOTH="both",lr.MEDIUM_KASHIDA="mediumKashida",lr.DISTRIBUTE="distribute",lr.NUM_TAB="numTab",lr.HIGH_KASHIDA="highKashida",lr.LOW_KASHIDA="lowKashida",lr.THAI_DISTRIBUTE="thaiDistribute",lr.LEFT="left",lr.RIGHT="right",lr.JUSTIFIED="both",lr))(AlignmentType||{});class AlignmentAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{val:"w:val"})}}class Alignment extends XmlComponent{constructor(or){super("w:jc"),this.root.push(new AlignmentAttributes({val:or}))}}class BorderElement extends XmlComponent{constructor(or,{color:ar,size:cr,space:ur,style:hr}){super(or),this.root.push(new BordersAttributes({style:hr,color:ar===void 0?void 0:hexColorValue(ar),size:cr===void 0?void 0:eighthPointMeasureValue(cr),space:ur===void 0?void 0:pointMeasureValue(ur)}))}}class BordersAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}var BorderStyle=(lr=>(lr.SINGLE="single",lr.DASH_DOT_STROKED="dashDotStroked",lr.DASHED="dashed",lr.DASH_SMALL_GAP="dashSmallGap",lr.DOT_DASH="dotDash",lr.DOT_DOT_DASH="dotDotDash",lr.DOTTED="dotted",lr.DOUBLE="double",lr.DOUBLE_WAVE="doubleWave",lr.INSET="inset",lr.NIL="nil",lr.NONE="none",lr.OUTSET="outset",lr.THICK="thick",lr.THICK_THIN_LARGE_GAP="thickThinLargeGap",lr.THICK_THIN_MEDIUM_GAP="thickThinMediumGap",lr.THICK_THIN_SMALL_GAP="thickThinSmallGap",lr.THIN_THICK_LARGE_GAP="thinThickLargeGap",lr.THIN_THICK_MEDIUM_GAP="thinThickMediumGap",lr.THIN_THICK_SMALL_GAP="thinThickSmallGap",lr.THIN_THICK_THIN_LARGE_GAP="thinThickThinLargeGap",lr.THIN_THICK_THIN_MEDIUM_GAP="thinThickThinMediumGap",lr.THIN_THICK_THIN_SMALL_GAP="thinThickThinSmallGap",lr.THREE_D_EMBOSS="threeDEmboss",lr.THREE_D_ENGRAVE="threeDEngrave",lr.TRIPLE="triple",lr.WAVE="wave",lr))(BorderStyle||{});class Border extends IgnoreIfEmptyXmlComponent{constructor(or){super("w:pBdr"),or.top&&this.root.push(new BorderElement("w:top",or.top)),or.bottom&&this.root.push(new BorderElement("w:bottom",or.bottom)),or.left&&this.root.push(new BorderElement("w:left",or.left)),or.right&&this.root.push(new BorderElement("w:right",or.right))}}class ThematicBreak extends XmlComponent{constructor(){super("w:pBdr");const or=new BorderElement("w:bottom",{color:"auto",space:1,style:BorderStyle.SINGLE,size:6});this.root.push(or)}}class Indent extends XmlComponent{constructor({start:or,end:ar,left:cr,right:ur,hanging:hr,firstLine:fr}){super("w:ind"),this.root.push(new NextAttributeComponent({start:{key:"w:start",value:or===void 0?void 0:signedTwipsMeasureValue(or)},end:{key:"w:end",value:ar===void 0?void 0:signedTwipsMeasureValue(ar)},left:{key:"w:left",value:cr===void 0?void 0:signedTwipsMeasureValue(cr)},right:{key:"w:right",value:ur===void 0?void 0:signedTwipsMeasureValue(ur)},hanging:{key:"w:hanging",value:hr===void 0?void 0:twipsMeasureValue(hr)},firstLine:{key:"w:firstLine",value:fr===void 0?void 0:twipsMeasureValue(fr)}}))}}let Break$1=class extends XmlComponent{constructor(){super("w:br")}};class FidCharAttrs extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class Begin extends XmlComponent{constructor(or){super("w:fldChar"),this.root.push(new FidCharAttrs({type:"begin",dirty:or}))}}class Separate extends XmlComponent{constructor(or){super("w:fldChar"),this.root.push(new FidCharAttrs({type:"separate",dirty:or}))}}class End extends XmlComponent{constructor(or){super("w:fldChar"),this.root.push(new FidCharAttrs({type:"end",dirty:or}))}}var SpaceType=(lr=>(lr.DEFAULT="default",lr.PRESERVE="preserve",lr))(SpaceType||{});class TextAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{space:"xml:space"})}}class Page extends XmlComponent{constructor(){super("w:instrText"),this.root.push(new TextAttributes({space:SpaceType.PRESERVE})),this.root.push("PAGE")}}class NumberOfPages extends XmlComponent{constructor(){super("w:instrText"),this.root.push(new TextAttributes({space:SpaceType.PRESERVE})),this.root.push("NUMPAGES")}}class NumberOfPagesSection extends XmlComponent{constructor(){super("w:instrText"),this.root.push(new TextAttributes({space:SpaceType.PRESERVE})),this.root.push("SECTIONPAGES")}}class ShadingAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class Shading extends XmlComponent{constructor({fill:or,color:ar,type:cr}){super("w:shd"),this.root.push(new ShadingAttributes({fill:or===void 0?void 0:hexColorValue(or),color:ar===void 0?void 0:hexColorValue(ar),type:cr}))}}class ChangeAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}class BaseEmphasisMark extends XmlComponent{constructor(or){super("w:em"),this.root.push(new Attributes({val:or}))}}class EmphasisMark extends BaseEmphasisMark{constructor(or="dot"){super(or)}}class CharacterSpacing extends XmlComponent{constructor(or){super("w:spacing"),this.root.push(new Attributes({val:signedTwipsMeasureValue(or)}))}}class Color extends XmlComponent{constructor(or){super("w:color"),this.root.push(new Attributes({val:hexColorValue(or)}))}}class Highlight extends XmlComponent{constructor(or){super("w:highlight"),this.root.push(new Attributes({val:or}))}}class HighlightComplexScript extends XmlComponent{constructor(or){super("w:highlightCs"),this.root.push(new Attributes({val:or}))}}const createLanguageComponent=lr=>new BuilderElement({name:"w:lang",attributes:{value:{key:"w:val",value:lr.value},eastAsia:{key:"w:eastAsia",value:lr.eastAsia},bidirectional:{key:"w:bidi",value:lr.bidirectional}}});class RunFontAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class RunFonts extends XmlComponent{constructor(or,ar){if(super("w:rFonts"),typeof or=="string"){const cr=or;this.root.push(new RunFontAttributes({ascii:cr,cs:cr,eastAsia:cr,hAnsi:cr,hint:ar}))}else{const cr=or;this.root.push(new RunFontAttributes(cr))}}}let VerticalAlign$1=class extends XmlComponent{constructor(or){super("w:vertAlign"),this.root.push(new Attributes({val:or}))}};class SuperScript extends VerticalAlign$1{constructor(){super("superscript")}}class SubScript extends VerticalAlign$1{constructor(){super("subscript")}}var UnderlineType=(lr=>(lr.SINGLE="single",lr.WORDS="words",lr.DOUBLE="double",lr.THICK="thick",lr.DOTTED="dotted",lr.DOTTEDHEAVY="dottedHeavy",lr.DASH="dash",lr.DASHEDHEAVY="dashedHeavy",lr.DASHLONG="dashLong",lr.DASHLONGHEAVY="dashLongHeavy",lr.DOTDASH="dotDash",lr.DASHDOTHEAVY="dashDotHeavy",lr.DOTDOTDASH="dotDotDash",lr.DASHDOTDOTHEAVY="dashDotDotHeavy",lr.WAVE="wave",lr.WAVYHEAVY="wavyHeavy",lr.WAVYDOUBLE="wavyDouble",lr.NONE="none",lr))(UnderlineType||{});class Underline extends XmlComponent{constructor(or="single",ar){super("w:u"),this.root.push(new Attributes({val:or,color:ar===void 0?void 0:hexColorValue(ar)}))}}class RunProperties extends IgnoreIfEmptyXmlComponent{constructor(or){if(super("w:rPr"),!or)return;or.noProof!==void 0&&this.push(new OnOffElement("w:noProof",or.noProof)),or.bold!==void 0&&this.push(new OnOffElement("w:b",or.bold)),(or.boldComplexScript===void 0&&or.bold!==void 0||or.boldComplexScript)&&this.push(new OnOffElement("w:bCs",or.boldComplexScript??or.bold)),or.italics!==void 0&&this.push(new OnOffElement("w:i",or.italics)),(or.italicsComplexScript===void 0&&or.italics!==void 0||or.italicsComplexScript)&&this.push(new OnOffElement("w:iCs",or.italicsComplexScript??or.italics)),or.underline&&this.push(new Underline(or.underline.type,or.underline.color)),or.effect&&this.push(new StringValueElement("w:effect",or.effect)),or.emphasisMark&&this.push(new EmphasisMark(or.emphasisMark.type)),or.color&&this.push(new Color(or.color)),or.kern&&this.push(new HpsMeasureElement("w:kern",or.kern)),or.position&&this.push(new StringValueElement("w:position",or.position)),or.size!==void 0&&this.push(new HpsMeasureElement("w:sz",or.size));const ar=or.sizeComplexScript===void 0||or.sizeComplexScript===!0?or.size:or.sizeComplexScript;ar&&this.push(new HpsMeasureElement("w:szCs",ar)),or.rightToLeft!==void 0&&this.push(new OnOffElement("w:rtl",or.rightToLeft)),or.smallCaps!==void 0?this.push(new OnOffElement("w:smallCaps",or.smallCaps)):or.allCaps!==void 0&&this.push(new OnOffElement("w:caps",or.allCaps)),or.strike!==void 0&&this.push(new OnOffElement("w:strike",or.strike)),or.doubleStrike!==void 0&&this.push(new OnOffElement("w:dstrike",or.doubleStrike)),or.subScript&&this.push(new SubScript),or.superScript&&this.push(new SuperScript),or.style&&this.push(new StringValueElement("w:rStyle",or.style)),or.font&&(typeof or.font=="string"?this.push(new RunFonts(or.font)):"name"in or.font?this.push(new RunFonts(or.font.name,or.font.hint)):this.push(new RunFonts(or.font))),or.highlight&&this.push(new Highlight(or.highlight));const cr=or.highlightComplexScript===void 0||or.highlightComplexScript===!0?or.highlight:or.highlightComplexScript;cr&&this.push(new HighlightComplexScript(cr)),or.characterSpacing&&this.push(new CharacterSpacing(or.characterSpacing)),or.emboss!==void 0&&this.push(new OnOffElement("w:emboss",or.emboss)),or.imprint!==void 0&&this.push(new OnOffElement("w:imprint",or.imprint)),or.shading&&this.push(new Shading(or.shading)),or.revision&&this.push(new RunPropertiesChange(or.revision)),or.border&&this.push(new BorderElement("w:bdr",or.border)),or.snapToGrid&&this.push(new OnOffElement("w:snapToGrid",or.snapToGrid)),or.vanish&&this.push(new OnOffElement("w:vanish",or.vanish)),or.specVanish&&this.push(new OnOffElement("w:specVanish",or.vanish)),or.scale!==void 0&&this.push(new NumberValueElement("w:w",or.scale)),or.language&&this.push(createLanguageComponent(or.language)),or.math&&this.push(new OnOffElement("w:oMath",or.math))}push(or){this.root.push(or)}}class RunPropertiesChange extends XmlComponent{constructor(or){super("w:rPrChange"),this.root.push(new ChangeAttributes({id:or.id,author:or.author,date:or.date})),this.addChildElement(new RunProperties(or))}}class Text extends XmlComponent{constructor(or){return super("w:t"),typeof or=="string"?(this.root.push(new TextAttributes({space:SpaceType.PRESERVE})),this.root.push(or),this):(this.root.push(new TextAttributes({space:or.space??SpaceType.DEFAULT})),this.root.push(or.text),this)}}class Run extends XmlComponent{constructor(or){if(super("w:r"),__publicField(this,"properties"),this.properties=new RunProperties(or),this.root.push(this.properties),or.break)for(let ar=0;ar<or.break;ar++)this.root.push(new Break$1);if(or.children)for(const ar of or.children){if(typeof ar=="string"){switch(ar){case"CURRENT":this.root.push(new Begin),this.root.push(new Page),this.root.push(new Separate),this.root.push(new End);break;case"TOTAL_PAGES":this.root.push(new Begin),this.root.push(new NumberOfPages),this.root.push(new Separate),this.root.push(new End);break;case"TOTAL_PAGES_IN_SECTION":this.root.push(new Begin),this.root.push(new NumberOfPagesSection),this.root.push(new Separate),this.root.push(new End);break;default:this.root.push(new Text(ar));break}continue}this.root.push(ar)}else or.text&&this.root.push(new Text(or.text))}}class TextRun extends Run{constructor(or){if(typeof or=="string")return super({}),this.root.push(new Text(or)),this;super(or)}}let urlAlphabet="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",nanoid=(lr=21)=>{let or="",ar=lr;for(;ar--;)or+=urlAlphabet[Math.random()*64|0];return or};const convertInchesToTwip=lr=>Math.floor(lr*72*20),uniqueNumericIdCreator=(lr=0)=>{let or=lr;return()=>++or},abstractNumUniqueNumericIdGen=()=>uniqueNumericIdCreator(),concreteNumUniqueNumericIdGen=()=>uniqueNumericIdCreator(1),bookmarkUniqueNumericIdGen=()=>uniqueNumericIdCreator(),uniqueId=()=>nanoid().toLowerCase();class CommentAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class RootCommentsAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class Comment extends XmlComponent{constructor({id:or,initials:ar,author:cr,date:ur=new Date,children:hr}){super("w:comment"),this.root.push(new CommentAttributes({id:or,initials:ar,author:cr,date:ur.toISOString()}));for(const fr of hr)this.root.push(fr)}}class Comments extends XmlComponent{constructor({children:or}){super("w:comments"),this.root.push(new RootCommentsAttributes({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const ar of or)this.root.push(new Comment(ar))}}class PageBreakBefore extends XmlComponent{constructor(){super("w:pageBreakBefore")}}var LineRuleType=(lr=>(lr.AT_LEAST="atLeast",lr.EXACTLY="exactly",lr.EXACT="exact",lr.AUTO="auto",lr))(LineRuleType||{});class SpacingAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"})}}class Spacing extends XmlComponent{constructor(or){super("w:spacing"),this.root.push(new SpacingAttributes(or))}}var HeadingLevel=(lr=>(lr.HEADING_1="Heading1",lr.HEADING_2="Heading2",lr.HEADING_3="Heading3",lr.HEADING_4="Heading4",lr.HEADING_5="Heading5",lr.HEADING_6="Heading6",lr.TITLE="Title",lr))(HeadingLevel||{});let Style$1=class extends XmlComponent{constructor(or){super("w:pStyle"),this.root.push(new Attributes({val:or}))}};class TabStop extends XmlComponent{constructor(or){super("w:tabs");for(const ar of or)this.root.push(new TabStopItem(ar))}}var TabStopType=(lr=>(lr.LEFT="left",lr.RIGHT="right",lr.CENTER="center",lr.BAR="bar",lr.CLEAR="clear",lr.DECIMAL="decimal",lr.END="end",lr.NUM="num",lr.START="start",lr))(TabStopType||{});class TabAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class TabStopItem extends XmlComponent{constructor({type:or,position:ar,leader:cr}){super("w:tab"),this.root.push(new TabAttributes({val:or,pos:ar,leader:cr}))}}class NumberProperties extends XmlComponent{constructor(or,ar){super("w:numPr"),this.root.push(new IndentLevel(ar)),this.root.push(new NumberId(or))}}class IndentLevel extends XmlComponent{constructor(or){if(super("w:ilvl"),or>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Attributes({val:or}))}}class NumberId extends XmlComponent{constructor(or){super("w:numId"),this.root.push(new Attributes({val:typeof or=="string"?`{${or}}`:or}))}}class FileChild extends XmlComponent{constructor(){super(...arguments),__publicField(this,"fileChild",Symbol())}}class RelationshipAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}var TargetModeType=(lr=>(lr.EXTERNAL="External",lr))(TargetModeType||{});class Relationship extends XmlComponent{constructor(or,ar,cr,ur){super("Relationship"),this.root.push(new RelationshipAttributes({id:or,type:ar,target:cr,targetMode:ur}))}}class HyperlinkAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class ConcreteHyperlink extends XmlComponent{constructor(or,ar,cr){super("w:hyperlink"),__publicField(this,"linkId"),this.linkId=ar;const ur={history:1,anchor:cr||void 0,id:cr?void 0:`rId${this.linkId}`},hr=new HyperlinkAttributes(ur);this.root.push(hr),or.forEach(fr=>{this.root.push(fr)})}}class InternalHyperlink extends ConcreteHyperlink{constructor(or){super(or.children,uniqueId(),or.anchor)}}class ExternalHyperlink extends XmlComponent{constructor(or){super("w:externalHyperlink"),this.options=or}}class BookmarkStartAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class BookmarkEndAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{id:"w:id"})}}class Bookmark{constructor(or){__publicField(this,"bookmarkUniqueNumericId",bookmarkUniqueNumericIdGen()),__publicField(this,"start"),__publicField(this,"children"),__publicField(this,"end");const ar=this.bookmarkUniqueNumericId();this.start=new BookmarkStart(or.id,ar),this.children=or.children,this.end=new BookmarkEnd(ar)}}class BookmarkStart extends XmlComponent{constructor(or,ar){super("w:bookmarkStart");const cr=new BookmarkStartAttributes({name:or,id:ar});this.root.push(cr)}}class BookmarkEnd extends XmlComponent{constructor(or){super("w:bookmarkEnd");const ar=new BookmarkEndAttributes({id:or});this.root.push(ar)}}class OutlineLevel extends XmlComponent{constructor(or){super("w:outlineLvl"),this.level=or,this.root.push(new Attributes({val:or}))}}class VerticalAlignAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{verticalAlign:"w:val"})}}class VerticalAlignElement extends XmlComponent{constructor(or){super("w:vAlign"),this.root.push(new VerticalAlignAttributes({verticalAlign:or}))}}var HeaderFooterReferenceType=(lr=>(lr.DEFAULT="default",lr.FIRST="first",lr.EVEN="even",lr))(HeaderFooterReferenceType||{});class FooterReferenceAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{type:"w:type",id:"r:id"})}}var HeaderFooterType=(lr=>(lr.HEADER="w:headerReference",lr.FOOTER="w:footerReference",lr))(HeaderFooterType||{});class HeaderFooterReference extends XmlComponent{constructor(or,ar){super(or),this.root.push(new FooterReferenceAttributes({type:ar.type||"default",id:`rId${ar.id}`}))}}class Columns extends XmlComponent{constructor({space:or,count:ar,separate:cr,equalWidth:ur,children:hr}){super("w:cols"),this.root.push(new NextAttributeComponent({space:{key:"w:space",value:or===void 0?void 0:twipsMeasureValue(or)},count:{key:"w:num",value:ar===void 0?void 0:decimalNumber(ar)},separate:{key:"w:sep",value:cr},equalWidth:{key:"w:equalWidth",value:ur}})),!ur&&hr&&hr.forEach(fr=>this.addChildElement(fr))}}class DocGridAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"})}}class DocumentGrid extends XmlComponent{constructor(or,ar,cr){super("w:docGrid"),this.root.push(new DocGridAttributes({type:cr,linePitch:decimalNumber(or),charSpace:ar?decimalNumber(ar):void 0}))}}class LineNumberType extends XmlComponent{constructor({countBy:or,start:ar,restart:cr,distance:ur}){super("w:lnNumType"),this.root.push(new NextAttributeComponent({countBy:{key:"w:countBy",value:or===void 0?void 0:decimalNumber(or)},start:{key:"w:start",value:ar===void 0?void 0:decimalNumber(ar)},restart:{key:"w:restart",value:cr},distance:{key:"w:distance",value:ur===void 0?void 0:twipsMeasureValue(ur)}}))}}class PageBordersAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class PageBorders extends IgnoreIfEmptyXmlComponent{constructor(or){if(super("w:pgBorders"),!or)return this;or.pageBorders?this.root.push(new PageBordersAttributes({display:or.pageBorders.display,offsetFrom:or.pageBorders.offsetFrom,zOrder:or.pageBorders.zOrder})):this.root.push(new PageBordersAttributes({})),or.pageBorderTop&&this.root.push(new BorderElement("w:top",or.pageBorderTop)),or.pageBorderLeft&&this.root.push(new BorderElement("w:left",or.pageBorderLeft)),or.pageBorderBottom&&this.root.push(new BorderElement("w:bottom",or.pageBorderBottom)),or.pageBorderRight&&this.root.push(new BorderElement("w:right",or.pageBorderRight))}}class PageMargin extends XmlComponent{constructor(or,ar,cr,ur,hr,fr,dr){super("w:pgMar"),this.root.push(new NextAttributeComponent({top:{key:"w:top",value:signedTwipsMeasureValue(or)},right:{key:"w:right",value:twipsMeasureValue(ar)},bottom:{key:"w:bottom",value:signedTwipsMeasureValue(cr)},left:{key:"w:left",value:twipsMeasureValue(ur)},header:{key:"w:header",value:twipsMeasureValue(hr)},footer:{key:"w:footer",value:twipsMeasureValue(fr)},gutter:{key:"w:gutter",value:twipsMeasureValue(dr)}}))}}class PageNumberTypeAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class PageNumberType extends XmlComponent{constructor({start:or,formatType:ar,separator:cr}){super("w:pgNumType"),this.root.push(new PageNumberTypeAttributes({start:or===void 0?void 0:decimalNumber(or),formatType:ar,separator:cr}))}}var PageOrientation=(lr=>(lr.PORTRAIT="portrait",lr.LANDSCAPE="landscape",lr))(PageOrientation||{});class PageSize extends XmlComponent{constructor(or,ar,cr){super("w:pgSz");const ur=cr==="landscape",hr=twipsMeasureValue(or),fr=twipsMeasureValue(ar);this.root.push(new NextAttributeComponent({width:{key:"w:w",value:ur?fr:hr},height:{key:"w:h",value:ur?hr:fr},orientation:{key:"w:orient",value:cr}}))}}class PageTextDirectionAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{val:"w:val"})}}class PageTextDirection extends XmlComponent{constructor(or){super("w:textDirection"),this.root.push(new PageTextDirectionAttributes({val:or}))}}class SectionTypeAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{val:"w:val"})}}class Type extends XmlComponent{constructor(or){super("w:type"),this.root.push(new SectionTypeAttributes({val:or}))}}const sectionMarginDefaults={TOP:"1in",RIGHT:"1in",BOTTOM:"1in",LEFT:"1in",HEADER:708,FOOTER:708,GUTTER:0},sectionPageSizeDefaults={WIDTH:11906,HEIGHT:16838,ORIENTATION:PageOrientation.PORTRAIT};class SectionProperties extends XmlComponent{constructor({page:{size:{width:or=sectionPageSizeDefaults.WIDTH,height:ar=sectionPageSizeDefaults.HEIGHT,orientation:cr=sectionPageSizeDefaults.ORIENTATION}={},margin:{top:ur=sectionMarginDefaults.TOP,right:hr=sectionMarginDefaults.RIGHT,bottom:fr=sectionMarginDefaults.BOTTOM,left:dr=sectionMarginDefaults.LEFT,header:pr=sectionMarginDefaults.HEADER,footer:mr=sectionMarginDefaults.FOOTER,gutter:gr=sectionMarginDefaults.GUTTER}={},pageNumbers:yr={},borders:br,textDirection:Or}={},grid:{linePitch:_r=360,charSpace:vr,type:xr}={},headerWrapperGroup:wr={},footerWrapperGroup:kr={},lineNumbers:Cr,titlePage:$r,verticalAlign:Nr,column:Br,type:Fr}={}){super("w:sectPr"),this.addHeaderFooterGroup(HeaderFooterType.HEADER,wr),this.addHeaderFooterGroup(HeaderFooterType.FOOTER,kr),Fr&&this.root.push(new Type(Fr)),this.root.push(new PageSize(or,ar,cr)),this.root.push(new PageMargin(ur,hr,fr,dr,pr,mr,gr)),br&&this.root.push(new PageBorders(br)),Cr&&this.root.push(new LineNumberType(Cr)),this.root.push(new PageNumberType(yr)),Br&&this.root.push(new Columns(Br)),Nr&&this.root.push(new VerticalAlignElement(Nr)),$r!==void 0&&this.root.push(new OnOffElement("w:titlePg",$r)),Or&&this.root.push(new PageTextDirection(Or)),this.root.push(new DocumentGrid(_r,vr,xr))}addHeaderFooterGroup(or,ar){ar.default&&this.root.push(new HeaderFooterReference(or,{type:HeaderFooterReferenceType.DEFAULT,id:ar.default.View.ReferenceId})),ar.first&&this.root.push(new HeaderFooterReference(or,{type:HeaderFooterReferenceType.FIRST,id:ar.first.View.ReferenceId})),ar.even&&this.root.push(new HeaderFooterReference(or,{type:HeaderFooterReferenceType.EVEN,id:ar.even.View.ReferenceId}))}}class Body extends XmlComponent{constructor(){super("w:body"),__publicField(this,"sections",[])}addSection(or){const ar=this.sections.pop();this.root.push(this.createSectionParagraph(ar)),this.sections.push(new SectionProperties(or))}prepForXml(or){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(or)}push(or){this.root.push(or)}createSectionParagraph(or){const ar=new Paragraph({}),cr=new ParagraphProperties({});return cr.push(or),ar.addChildElement(cr),ar}}class DocumentAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",aink:"xmlns:aink",am3d:"xmlns:am3d",w16cex:"xmlns:w16cex",w16cid:"xmlns:w16cid",w16:"xmlns:w16",w16sdtdh:"xmlns:w16sdtdh",w16se:"xmlns:w16se"})}}class DocumentBackgroundAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class DocumentBackground extends XmlComponent{constructor(or){super("w:background"),this.root.push(new DocumentBackgroundAttributes({color:or.color===void 0?void 0:hexColorValue(or.color),themeColor:or.themeColor,themeShade:or.themeShade===void 0?void 0:uCharHexNumber(or.themeShade),themeTint:or.themeTint===void 0?void 0:uCharHexNumber(or.themeTint)}))}}class Document extends XmlComponent{constructor(or){super("w:document"),__publicField(this,"body"),this.root.push(new DocumentAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex",Ignorable:"w14 w15 wp14"})),this.body=new Body,or.background&&this.root.push(new DocumentBackground(or.background)),this.root.push(this.body)}add(or){return this.body.push(or),this}get Body(){return this.body}}class RelationshipsAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{xmlns:"xmlns"})}}class Relationships extends XmlComponent{constructor(){super("Relationships"),this.root.push(new RelationshipsAttributes({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(or,ar,cr,ur){const hr=new Relationship(`rId${or}`,ar,cr,ur);return this.root.push(hr),hr}get RelationshipCount(){return this.root.length-1}}class DocumentWrapper{constructor(or){__publicField(this,"document"),__publicField(this,"relationships"),this.document=new Document(or),this.relationships=new Relationships}get View(){return this.document}get Relationships(){return this.relationships}}class WordWrapAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{val:"w:val"})}}class WordWrap extends XmlComponent{constructor(){super("w:wordWrap"),this.root.push(new WordWrapAttributes({val:0}))}}class FramePropertiesAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{anchorLock:"w:anchorLock",dropCap:"w:dropCap",width:"w:w",height:"w:h",x:"w:x",y:"w:y",anchorHorizontal:"w:hAnchor",anchorVertical:"w:vAnchor",spaceHorizontal:"w:hSpace",spaceVertical:"w:vSpace",rule:"w:hRule",alignmentX:"w:xAlign",alignmentY:"w:yAlign",lines:"w:lines",wrap:"w:wrap"})}}class FrameProperties extends XmlComponent{constructor(or){var ar,cr;super("w:framePr"),this.root.push(new FramePropertiesAttributes({anchorLock:or.anchorLock,dropCap:or.dropCap,width:or.width,height:or.height,x:or.position?or.position.x:void 0,y:or.position?or.position.y:void 0,anchorHorizontal:or.anchor.horizontal,anchorVertical:or.anchor.vertical,spaceHorizontal:(ar=or.space)==null?void 0:ar.horizontal,spaceVertical:(cr=or.space)==null?void 0:cr.vertical,rule:or.rule,alignmentX:or.alignment?or.alignment.x:void 0,alignmentY:or.alignment?or.alignment.y:void 0,lines:or.lines,wrap:or.wrap}))}}class ParagraphProperties extends IgnoreIfEmptyXmlComponent{constructor(or){if(super("w:pPr"),__publicField(this,"numberingReferences",[]),!or)return this;or.heading&&this.push(new Style$1(or.heading)),or.bullet&&this.push(new Style$1("ListParagraph")),or.numbering&&!or.style&&!or.heading&&(or.numbering.custom||this.push(new Style$1("ListParagraph"))),or.style&&this.push(new Style$1(or.style)),or.keepNext!==void 0&&this.push(new OnOffElement("w:keepNext",or.keepNext)),or.keepLines!==void 0&&this.push(new OnOffElement("w:keepLines",or.keepLines)),or.pageBreakBefore&&this.push(new PageBreakBefore),or.frame&&this.push(new FrameProperties(or.frame)),or.widowControl!==void 0&&this.push(new OnOffElement("w:widowControl",or.widowControl)),or.bullet&&this.push(new NumberProperties(1,or.bullet.level)),or.numbering&&(this.numberingReferences.push({reference:or.numbering.reference,instance:or.numbering.instance??0}),this.push(new NumberProperties(`${or.numbering.reference}-${or.numbering.instance??0}`,or.numbering.level))),or.border&&this.push(new Border(or.border)),or.thematicBreak&&this.push(new ThematicBreak),or.shading&&this.push(new Shading(or.shading)),or.wordWrap&&this.push(new WordWrap);const ar=[...or.rightTabStop?[{type:TabStopType.RIGHT,position:or.rightTabStop}]:[],...or.tabStops?or.tabStops:[],...or.leftTabStop?[{type:TabStopType.LEFT,position:or.leftTabStop}]:[]];ar.length>0&&this.push(new TabStop(ar)),or.bidirectional!==void 0&&this.push(new OnOffElement("w:bidi",or.bidirectional)),or.spacing&&this.push(new Spacing(or.spacing)),or.indent&&this.push(new Indent(or.indent)),or.contextualSpacing!==void 0&&this.push(new OnOffElement("w:contextualSpacing",or.contextualSpacing)),or.alignment&&this.push(new Alignment(or.alignment)),or.outlineLevel!==void 0&&this.push(new OutlineLevel(or.outlineLevel)),or.suppressLineNumbers!==void 0&&this.push(new OnOffElement("w:suppressLineNumbers",or.suppressLineNumbers)),or.autoSpaceEastAsianText!==void 0&&this.push(new OnOffElement("w:autoSpaceDN",or.autoSpaceEastAsianText))}push(or){this.root.push(or)}prepForXml(or){if(or.viewWrapper instanceof DocumentWrapper)for(const ar of this.numberingReferences)or.file.Numbering.createConcreteNumberingInstance(ar.reference,ar.instance);return super.prepForXml(or)}}class Paragraph extends FileChild{constructor(or){if(super("w:p"),__publicField(this,"properties"),typeof or=="string")return this.properties=new ParagraphProperties({}),this.root.push(this.properties),this.root.push(new TextRun(or)),this;if(this.properties=new ParagraphProperties(or),this.root.push(this.properties),or.text&&this.root.push(new TextRun(or.text)),or.children)for(const ar of or.children){if(ar instanceof Bookmark){this.root.push(ar.start);for(const cr of ar.children)this.root.push(cr);this.root.push(ar.end);continue}this.root.push(ar)}}prepForXml(or){for(const ar of this.root)if(ar instanceof ExternalHyperlink){const cr=this.root.indexOf(ar),ur=new ConcreteHyperlink(ar.options.children,uniqueId());or.viewWrapper.Relationships.createRelationship(ur.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",ar.options.link,TargetModeType.EXTERNAL),this.root[cr]=ur}return super.prepForXml(or)}addRunToFront(or){return this.root.splice(1,0,or),this}}const NONE_BORDER={style:BorderStyle.NONE,size:0,color:"auto"},DEFAULT_BORDER={style:BorderStyle.SINGLE,size:4,color:"auto"};class TableBorders extends XmlComponent{constructor(or){super("w:tblBorders"),or.top?this.root.push(new BorderElement("w:top",or.top)):this.root.push(new BorderElement("w:top",DEFAULT_BORDER)),or.left?this.root.push(new BorderElement("w:left",or.left)):this.root.push(new BorderElement("w:left",DEFAULT_BORDER)),or.bottom?this.root.push(new BorderElement("w:bottom",or.bottom)):this.root.push(new BorderElement("w:bottom",DEFAULT_BORDER)),or.right?this.root.push(new BorderElement("w:right",or.right)):this.root.push(new BorderElement("w:right",DEFAULT_BORDER)),or.insideHorizontal?this.root.push(new BorderElement("w:insideH",or.insideHorizontal)):this.root.push(new BorderElement("w:insideH",DEFAULT_BORDER)),or.insideVertical?this.root.push(new BorderElement("w:insideV",or.insideVertical)):this.root.push(new BorderElement("w:insideV",DEFAULT_BORDER))}}__publicField(TableBorders,"NONE",{top:NONE_BORDER,bottom:NONE_BORDER,left:NONE_BORDER,right:NONE_BORDER,insideHorizontal:NONE_BORDER,insideVertical:NONE_BORDER});class AppPropertiesAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class AppProperties extends XmlComponent{constructor(){super("Properties"),this.root.push(new AppPropertiesAttributes({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class ContentTypeAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{xmlns:"xmlns"})}}class DefaultAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class Default extends XmlComponent{constructor(or,ar){super("Default"),this.root.push(new DefaultAttributes({contentType:or,extension:ar}))}}class OverrideAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class Override extends XmlComponent{constructor(or,ar){super("Override"),this.root.push(new OverrideAttributes({contentType:or,partName:ar}))}}class ContentTypes extends XmlComponent{constructor(){super("Types"),this.root.push(new ContentTypeAttributes({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new Default("image/png","png")),this.root.push(new Default("image/jpeg","jpeg")),this.root.push(new Default("image/jpeg","jpg")),this.root.push(new Default("image/bmp","bmp")),this.root.push(new Default("image/gif","gif")),this.root.push(new Default("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new Default("application/xml","xml")),this.root.push(new Override("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new Override("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new Override("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new Override("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new Override("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new Override("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new Override("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new Override("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new Override("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml"))}addFooter(or){this.root.push(new Override("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${or}.xml`))}addHeader(or){this.root.push(new Override("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${or}.xml`))}}class CoreProperties extends XmlComponent{constructor(or){super("cp:coreProperties"),this.root.push(new DocumentAttributes({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),or.title&&this.root.push(new StringContainer("dc:title",or.title)),or.subject&&this.root.push(new StringContainer("dc:subject",or.subject)),or.creator&&this.root.push(new StringContainer("dc:creator",or.creator)),or.keywords&&this.root.push(new StringContainer("cp:keywords",or.keywords)),or.description&&this.root.push(new StringContainer("dc:description",or.description)),or.lastModifiedBy&&this.root.push(new StringContainer("cp:lastModifiedBy",or.lastModifiedBy)),or.revision&&this.root.push(new StringContainer("cp:revision",String(or.revision))),this.root.push(new TimestampElement("dcterms:created")),this.root.push(new TimestampElement("dcterms:modified"))}}class TimestampElement extends XmlComponent{constructor(or){super(or),this.root.push(new DocumentAttributes({type:"dcterms:W3CDTF"})),this.root.push(dateTimeValue(new Date))}}class CustomPropertiesAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class CustomPropertyAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class CustomProperty extends XmlComponent{constructor(or,ar){super("property"),this.root.push(new CustomPropertyAttributes({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:or.toString(),name:ar.name})),this.root.push(new CustomPropertyValue(ar.value))}}class CustomPropertyValue extends XmlComponent{constructor(or){super("vt:lpwstr"),this.root.push(or)}}class CustomProperties extends XmlComponent{constructor(or){super("Properties"),__publicField(this,"nextId"),__publicField(this,"properties",[]),this.root.push(new CustomPropertiesAttributes({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const ar of or)this.addCustomProperty(ar)}prepForXml(or){return this.properties.forEach(ar=>this.root.push(ar)),super.prepForXml(or)}addCustomProperty(or){this.properties.push(new CustomProperty(this.nextId++,or))}}class FooterAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let Footer$1=class extends InitializableXmlComponent{constructor(or,ar){super("w:ftr",ar),__publicField(this,"refId"),this.refId=or,ar||this.root.push(new FooterAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(or){this.root.push(or)}};class FooterWrapper{constructor(or,ar,cr){__publicField(this,"footer"),__publicField(this,"relationships"),this.media=or,this.footer=new Footer$1(ar,cr),this.relationships=new Relationships}add(or){this.footer.add(or)}addChildElement(or){this.footer.addChildElement(or)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class FootnoteAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class FootnoteRef extends XmlComponent{constructor(){super("w:footnoteRef")}}class FootnoteRefRun extends Run{constructor(){super({style:"FootnoteReference"}),this.root.push(new FootnoteRef)}}var FootnoteType=(lr=>(lr.SEPERATOR="separator",lr.CONTINUATION_SEPERATOR="continuationSeparator",lr))(FootnoteType||{});class Footnote extends XmlComponent{constructor(or){super("w:footnote"),this.root.push(new FootnoteAttributes({type:or.type,id:or.id}));for(let ar=0;ar<or.children.length;ar++){const cr=or.children[ar];ar===0&&cr.addRunToFront(new FootnoteRefRun),this.root.push(cr)}}}class ContinuationSeperator extends XmlComponent{constructor(){super("w:continuationSeparator")}}class ContinuationSeperatorRun extends Run{constructor(){super({}),this.root.push(new ContinuationSeperator)}}class Seperator extends XmlComponent{constructor(){super("w:separator")}}class SeperatorRun extends Run{constructor(){super({}),this.root.push(new Seperator)}}class FootnotesAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class FootNotes extends XmlComponent{constructor(){super("w:footnotes"),this.root.push(new FootnotesAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const or=new Footnote({id:-1,type:FootnoteType.SEPERATOR,children:[new Paragraph({spacing:{after:0,line:240,lineRule:LineRuleType.AUTO},children:[new SeperatorRun]})]});this.root.push(or);const ar=new Footnote({id:0,type:FootnoteType.CONTINUATION_SEPERATOR,children:[new Paragraph({spacing:{after:0,line:240,lineRule:LineRuleType.AUTO},children:[new ContinuationSeperatorRun]})]});this.root.push(ar)}createFootNote(or,ar){const cr=new Footnote({id:or,children:ar});this.root.push(cr)}}class FootnotesWrapper{constructor(){__publicField(this,"footnotess"),__publicField(this,"relationships"),this.footnotess=new FootNotes,this.relationships=new Relationships}get View(){return this.footnotess}get Relationships(){return this.relationships}}class HeaderAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let Header$1=class extends InitializableXmlComponent{constructor(or,ar){super("w:hdr",ar),__publicField(this,"refId"),this.refId=or,ar||this.root.push(new HeaderAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(or){this.root.push(or)}};class HeaderWrapper{constructor(or,ar,cr){__publicField(this,"header"),__publicField(this,"relationships"),this.media=or,this.header=new Header$1(ar,cr),this.relationships=new Relationships}add(or){return this.header.add(or),this}addChildElement(or){this.header.addChildElement(or)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class Media{constructor(){__publicField(this,"map"),this.map=new Map}addImage(or,ar){this.map.set(or,ar)}get Array(){return Array.from(this.map.values())}}var LevelFormat=(lr=>(lr.DECIMAL="decimal",lr.UPPER_ROMAN="upperRoman",lr.LOWER_ROMAN="lowerRoman",lr.UPPER_LETTER="upperLetter",lr.LOWER_LETTER="lowerLetter",lr.ORDINAL="ordinal",lr.CARDINAL_TEXT="cardinalText",lr.ORDINAL_TEXT="ordinalText",lr.HEX="hex",lr.CHICAGO="chicago",lr.IDEOGRAPH__DIGITAL="ideographDigital",lr.JAPANESE_COUNTING="japaneseCounting",lr.AIUEO="aiueo",lr.IROHA="iroha",lr.DECIMAL_FULL_WIDTH="decimalFullWidth",lr.DECIMAL_HALF_WIDTH="decimalHalfWidth",lr.JAPANESE_LEGAL="japaneseLegal",lr.JAPANESE_DIGITAL_TEN_THOUSAND="japaneseDigitalTenThousand",lr.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",lr.DECIMAL_FULL_WIDTH2="decimalFullWidth2",lr.AIUEO_FULL_WIDTH="aiueoFullWidth",lr.IROHA_FULL_WIDTH="irohaFullWidth",lr.DECIMAL_ZERO="decimalZero",lr.BULLET="bullet",lr.GANADA="ganada",lr.CHOSUNG="chosung",lr.DECIMAL_ENCLOSED_FULLSTOP="decimalEnclosedFullstop",lr.DECIMAL_ENCLOSED_PARENTHESES="decimalEnclosedParen",lr.DECIMAL_ENCLOSED_CIRCLE_CHINESE="decimalEnclosedCircleChinese",lr.IDEOGRAPH_ENCLOSED_CIRCLE="ideographEnclosedCircle",lr.IDEOGRAPH_TRADITIONAL="ideographTraditional",lr.IDEOGRAPH_ZODIAC="ideographZodiac",lr.IDEOGRAPH_ZODIAC_TRADITIONAL="ideographZodiacTraditional",lr.TAIWANESE_COUNTING="taiwaneseCounting",lr.IDEOGRAPH_LEGAL_TRADITIONAL="ideographLegalTraditional",lr.TAIWANESE_COUNTING_THOUSAND="taiwaneseCountingThousand",lr.TAIWANESE_DIGITAL="taiwaneseDigital",lr.CHINESE_COUNTING="chineseCounting",lr.CHINESE_LEGAL_SIMPLIFIED="chineseLegalSimplified",lr.CHINESE_COUNTING_THOUSAND="chineseCountingThousand",lr.KOREAN_DIGITAL="koreanDigital",lr.KOREAN_COUNTING="koreanCounting",lr.KOREAN_LEGAL="koreanLegal",lr.KOREAN_DIGITAL2="koreanDigital2",lr.VIETNAMESE_COUNTING="vietnameseCounting",lr.RUSSIAN_LOWER="russianLower",lr.RUSSIAN_UPPER="russianUpper",lr.NONE="none",lr.NUMBER_IN_DASH="numberInDash",lr.HEBREW1="hebrew1",lr.HEBREW2="hebrew2",lr.ARABIC_ALPHA="arabicAlpha",lr.ARABIC_ABJAD="arabicAbjad",lr.HINDI_VOWELS="hindiVowels",lr.HINDI_CONSONANTS="hindiConsonants",lr.HINDI_NUMBERS="hindiNumbers",lr.HINDI_COUNTING="hindiCounting",lr.THAI_LETTERS="thaiLetters",lr.THAI_NUMBERS="thaiNumbers",lr.THAI_COUNTING="thaiCounting",lr.BAHT_TEXT="bahtText",lr.DOLLAR_TEXT="dollarText",lr.CUSTOM="custom",lr))(LevelFormat||{});class LevelAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class NumberFormat extends XmlComponent{constructor(or){super("w:numFmt"),this.root.push(new Attributes({val:or}))}}class LevelText extends XmlComponent{constructor(or){super("w:lvlText"),this.root.push(new Attributes({val:or}))}}class LevelJc extends XmlComponent{constructor(or){super("w:lvlJc"),this.root.push(new Attributes({val:or}))}}class Suffix extends XmlComponent{constructor(or){super("w:suff"),this.root.push(new Attributes({val:or}))}}class IsLegalNumberingStyle extends XmlComponent{constructor(){super("w:isLgl")}}class LevelBase extends XmlComponent{constructor({level:or,format:ar,text:cr,alignment:ur=AlignmentType.START,start:hr=1,style:fr,suffix:dr,isLegalNumberingStyle:pr}){if(super("w:lvl"),__publicField(this,"paragraphProperties"),__publicField(this,"runProperties"),this.root.push(new NumberValueElement("w:start",decimalNumber(hr))),ar&&this.root.push(new NumberFormat(ar)),dr&&this.root.push(new Suffix(dr)),pr&&this.root.push(new IsLegalNumberingStyle),cr&&this.root.push(new LevelText(cr)),this.root.push(new LevelJc(ur)),this.paragraphProperties=new ParagraphProperties(fr&&fr.paragraph),this.runProperties=new RunProperties(fr&&fr.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),or>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new LevelAttributes({ilvl:decimalNumber(or),tentative:1}))}}class Level extends LevelBase{}class MultiLevelType extends XmlComponent{constructor(or){super("w:multiLevelType"),this.root.push(new Attributes({val:or}))}}class AbstractNumberingAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class AbstractNumbering extends XmlComponent{constructor(or,ar){super("w:abstractNum"),__publicField(this,"id"),this.root.push(new AbstractNumberingAttributes({abstractNumId:decimalNumber(or),restartNumberingAfterBreak:0})),this.root.push(new MultiLevelType("hybridMultilevel")),this.id=or;for(const cr of ar)this.root.push(new Level(cr))}}class AbstractNumId extends XmlComponent{constructor(or){super("w:abstractNumId"),this.root.push(new Attributes({val:or}))}}class NumAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{numId:"w:numId"})}}class ConcreteNumbering extends XmlComponent{constructor(or){if(super("w:num"),__publicField(this,"numId"),__publicField(this,"reference"),__publicField(this,"instance"),this.numId=or.numId,this.reference=or.reference,this.instance=or.instance,this.root.push(new NumAttributes({numId:decimalNumber(or.numId)})),this.root.push(new AbstractNumId(decimalNumber(or.abstractNumId))),or.overrideLevels&&or.overrideLevels.length)for(const ar of or.overrideLevels)this.root.push(new LevelOverride(ar.num,ar.start))}}class LevelOverrideAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{ilvl:"w:ilvl"})}}class LevelOverride extends XmlComponent{constructor(or,ar){super("w:lvlOverride"),this.root.push(new LevelOverrideAttributes({ilvl:or})),ar!==void 0&&this.root.push(new StartOverride(ar))}}class StartOverrideAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{val:"w:val"})}}class StartOverride extends XmlComponent{constructor(or){super("w:startOverride"),this.root.push(new StartOverrideAttributes({val:or}))}}class Numbering extends XmlComponent{constructor(or){super("w:numbering"),__publicField(this,"abstractNumberingMap",new Map),__publicField(this,"concreteNumberingMap",new Map),__publicField(this,"referenceConfigMap",new Map),__publicField(this,"abstractNumUniqueNumericId",abstractNumUniqueNumericIdGen()),__publicField(this,"concreteNumUniqueNumericId",concreteNumUniqueNumericIdGen()),this.root.push(new DocumentAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const ar=new AbstractNumbering(this.abstractNumUniqueNumericId(),[{level:0,format:LevelFormat.BULLET,text:"●",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:convertInchesToTwip(.5),hanging:convertInchesToTwip(.25)}}}},{level:1,format:LevelFormat.BULLET,text:"○",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:convertInchesToTwip(1),hanging:convertInchesToTwip(.25)}}}},{level:2,format:LevelFormat.BULLET,text:"■",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:2160,hanging:convertInchesToTwip(.25)}}}},{level:3,format:LevelFormat.BULLET,text:"●",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:2880,hanging:convertInchesToTwip(.25)}}}},{level:4,format:LevelFormat.BULLET,text:"○",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:3600,hanging:convertInchesToTwip(.25)}}}},{level:5,format:LevelFormat.BULLET,text:"■",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:4320,hanging:convertInchesToTwip(.25)}}}},{level:6,format:LevelFormat.BULLET,text:"●",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:5040,hanging:convertInchesToTwip(.25)}}}},{level:7,format:LevelFormat.BULLET,text:"●",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:5760,hanging:convertInchesToTwip(.25)}}}},{level:8,format:LevelFormat.BULLET,text:"●",alignment:AlignmentType.LEFT,style:{paragraph:{indent:{left:6480,hanging:convertInchesToTwip(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new ConcreteNumbering({numId:1,abstractNumId:ar.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",ar);for(const cr of or.config)this.abstractNumberingMap.set(cr.reference,new AbstractNumbering(this.abstractNumUniqueNumericId(),cr.levels)),this.referenceConfigMap.set(cr.reference,cr.levels)}prepForXml(or){for(const ar of this.abstractNumberingMap.values())this.root.push(ar);for(const ar of this.concreteNumberingMap.values())this.root.push(ar);return super.prepForXml(or)}createConcreteNumberingInstance(or,ar){const cr=this.abstractNumberingMap.get(or);if(!cr)return;const ur=`${or}-${ar}`;if(this.concreteNumberingMap.has(ur))return;const hr=this.referenceConfigMap.get(or),fr=hr&&hr[0].start,dr={numId:this.concreteNumUniqueNumericId(),abstractNumId:cr.id,reference:or,instance:ar,overrideLevel:fr&&Number.isInteger(fr)?{num:0,start:fr}:{num:0,start:1}};this.concreteNumberingMap.set(ur,new ConcreteNumbering(dr))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class CompatibilitySettingAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class CompatibilitySetting extends XmlComponent{constructor(or){super("w:compatSetting"),this.root.push(new CompatibilitySettingAttributes({version:or,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class Compatibility extends XmlComponent{constructor(or){super("w:compat"),or.version&&this.root.push(new CompatibilitySetting(or.version)),or.useSingleBorderforContiguousCells&&this.root.push(new OnOffElement("w:useSingleBorderforContiguousCells",or.useSingleBorderforContiguousCells)),or.wordPerfectJustification&&this.root.push(new OnOffElement("w:wpJustification",or.wordPerfectJustification)),or.noTabStopForHangingIndent&&this.root.push(new OnOffElement("w:noTabHangInd",or.noTabStopForHangingIndent)),or.noLeading&&this.root.push(new OnOffElement("w:noLeading",or.noLeading)),or.spaceForUnderline&&this.root.push(new OnOffElement("w:spaceForUL",or.spaceForUnderline)),or.noColumnBalance&&this.root.push(new OnOffElement("w:noColumnBalance",or.noColumnBalance)),or.balanceSingleByteDoubleByteWidth&&this.root.push(new OnOffElement("w:balanceSingleByteDoubleByteWidth",or.balanceSingleByteDoubleByteWidth)),or.noExtraLineSpacing&&this.root.push(new OnOffElement("w:noExtraLineSpacing",or.noExtraLineSpacing)),or.doNotLeaveBackslashAlone&&this.root.push(new OnOffElement("w:doNotLeaveBackslashAlone",or.doNotLeaveBackslashAlone)),or.underlineTrailingSpaces&&this.root.push(new OnOffElement("w:ulTrailSpace",or.underlineTrailingSpaces)),or.doNotExpandShiftReturn&&this.root.push(new OnOffElement("w:doNotExpandShiftReturn",or.doNotExpandShiftReturn)),or.spacingInWholePoints&&this.root.push(new OnOffElement("w:spacingInWholePoints",or.spacingInWholePoints)),or.lineWrapLikeWord6&&this.root.push(new OnOffElement("w:lineWrapLikeWord6",or.lineWrapLikeWord6)),or.printBodyTextBeforeHeader&&this.root.push(new OnOffElement("w:printBodyTextBeforeHeader",or.printBodyTextBeforeHeader)),or.printColorsBlack&&this.root.push(new OnOffElement("w:printColBlack",or.printColorsBlack)),or.spaceWidth&&this.root.push(new OnOffElement("w:wpSpaceWidth",or.spaceWidth)),or.showBreaksInFrames&&this.root.push(new OnOffElement("w:showBreaksInFrames",or.showBreaksInFrames)),or.subFontBySize&&this.root.push(new OnOffElement("w:subFontBySize",or.subFontBySize)),or.suppressBottomSpacing&&this.root.push(new OnOffElement("w:suppressBottomSpacing",or.suppressBottomSpacing)),or.suppressTopSpacing&&this.root.push(new OnOffElement("w:suppressTopSpacing",or.suppressTopSpacing)),or.suppressSpacingAtTopOfPage&&this.root.push(new OnOffElement("w:suppressSpacingAtTopOfPage",or.suppressSpacingAtTopOfPage)),or.suppressTopSpacingWP&&this.root.push(new OnOffElement("w:suppressTopSpacingWP",or.suppressTopSpacingWP)),or.suppressSpBfAfterPgBrk&&this.root.push(new OnOffElement("w:suppressSpBfAfterPgBrk",or.suppressSpBfAfterPgBrk)),or.swapBordersFacingPages&&this.root.push(new OnOffElement("w:swapBordersFacingPages",or.swapBordersFacingPages)),or.convertMailMergeEsc&&this.root.push(new OnOffElement("w:convMailMergeEsc",or.convertMailMergeEsc)),or.truncateFontHeightsLikeWP6&&this.root.push(new OnOffElement("w:truncateFontHeightsLikeWP6",or.truncateFontHeightsLikeWP6)),or.macWordSmallCaps&&this.root.push(new OnOffElement("w:mwSmallCaps",or.macWordSmallCaps)),or.usePrinterMetrics&&this.root.push(new OnOffElement("w:usePrinterMetrics",or.usePrinterMetrics)),or.doNotSuppressParagraphBorders&&this.root.push(new OnOffElement("w:doNotSuppressParagraphBorders",or.doNotSuppressParagraphBorders)),or.wrapTrailSpaces&&this.root.push(new OnOffElement("w:wrapTrailSpaces",or.wrapTrailSpaces)),or.footnoteLayoutLikeWW8&&this.root.push(new OnOffElement("w:footnoteLayoutLikeWW8",or.footnoteLayoutLikeWW8)),or.shapeLayoutLikeWW8&&this.root.push(new OnOffElement("w:shapeLayoutLikeWW8",or.shapeLayoutLikeWW8)),or.alignTablesRowByRow&&this.root.push(new OnOffElement("w:alignTablesRowByRow",or.alignTablesRowByRow)),or.forgetLastTabAlignment&&this.root.push(new OnOffElement("w:forgetLastTabAlignment",or.forgetLastTabAlignment)),or.adjustLineHeightInTable&&this.root.push(new OnOffElement("w:adjustLineHeightInTable",or.adjustLineHeightInTable)),or.autoSpaceLikeWord95&&this.root.push(new OnOffElement("w:autoSpaceLikeWord95",or.autoSpaceLikeWord95)),or.noSpaceRaiseLower&&this.root.push(new OnOffElement("w:noSpaceRaiseLower",or.noSpaceRaiseLower)),or.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new OnOffElement("w:doNotUseHTMLParagraphAutoSpacing",or.doNotUseHTMLParagraphAutoSpacing)),or.layoutRawTableWidth&&this.root.push(new OnOffElement("w:layoutRawTableWidth",or.layoutRawTableWidth)),or.layoutTableRowsApart&&this.root.push(new OnOffElement("w:layoutTableRowsApart",or.layoutTableRowsApart)),or.useWord97LineBreakRules&&this.root.push(new OnOffElement("w:useWord97LineBreakRules",or.useWord97LineBreakRules)),or.doNotBreakWrappedTables&&this.root.push(new OnOffElement("w:doNotBreakWrappedTables",or.doNotBreakWrappedTables)),or.doNotSnapToGridInCell&&this.root.push(new OnOffElement("w:doNotSnapToGridInCell",or.doNotSnapToGridInCell)),or.selectFieldWithFirstOrLastCharacter&&this.root.push(new OnOffElement("w:selectFldWithFirstOrLastChar",or.selectFieldWithFirstOrLastCharacter)),or.applyBreakingRules&&this.root.push(new OnOffElement("w:applyBreakingRules",or.applyBreakingRules)),or.doNotWrapTextWithPunctuation&&this.root.push(new OnOffElement("w:doNotWrapTextWithPunct",or.doNotWrapTextWithPunctuation)),or.doNotUseEastAsianBreakRules&&this.root.push(new OnOffElement("w:doNotUseEastAsianBreakRules",or.doNotUseEastAsianBreakRules)),or.useWord2002TableStyleRules&&this.root.push(new OnOffElement("w:useWord2002TableStyleRules",or.useWord2002TableStyleRules)),or.growAutofit&&this.root.push(new OnOffElement("w:growAutofit",or.growAutofit)),or.useFELayout&&this.root.push(new OnOffElement("w:useFELayout",or.useFELayout)),or.useNormalStyleForList&&this.root.push(new OnOffElement("w:useNormalStyleForList",or.useNormalStyleForList)),or.doNotUseIndentAsNumberingTabStop&&this.root.push(new OnOffElement("w:doNotUseIndentAsNumberingTabStop",or.doNotUseIndentAsNumberingTabStop)),or.useAlternateEastAsianLineBreakRules&&this.root.push(new OnOffElement("w:useAltKinsokuLineBreakRules",or.useAlternateEastAsianLineBreakRules)),or.allowSpaceOfSameStyleInTable&&this.root.push(new OnOffElement("w:allowSpaceOfSameStyleInTable",or.allowSpaceOfSameStyleInTable)),or.doNotSuppressIndentation&&this.root.push(new OnOffElement("w:doNotSuppressIndentation",or.doNotSuppressIndentation)),or.doNotAutofitConstrainedTables&&this.root.push(new OnOffElement("w:doNotAutofitConstrainedTables",or.doNotAutofitConstrainedTables)),or.autofitToFirstFixedWidthCell&&this.root.push(new OnOffElement("w:autofitToFirstFixedWidthCell",or.autofitToFirstFixedWidthCell)),or.underlineTabInNumberingList&&this.root.push(new OnOffElement("w:underlineTabInNumList",or.underlineTabInNumberingList)),or.displayHangulFixedWidth&&this.root.push(new OnOffElement("w:displayHangulFixedWidth",or.displayHangulFixedWidth)),or.splitPgBreakAndParaMark&&this.root.push(new OnOffElement("w:splitPgBreakAndParaMark",or.splitPgBreakAndParaMark)),or.doNotVerticallyAlignCellWithSp&&this.root.push(new OnOffElement("w:doNotVertAlignCellWithSp",or.doNotVerticallyAlignCellWithSp)),or.doNotBreakConstrainedForcedTable&&this.root.push(new OnOffElement("w:doNotBreakConstrainedForcedTable",or.doNotBreakConstrainedForcedTable)),or.ignoreVerticalAlignmentInTextboxes&&this.root.push(new OnOffElement("w:doNotVertAlignInTxbx",or.ignoreVerticalAlignmentInTextboxes)),or.useAnsiKerningPairs&&this.root.push(new OnOffElement("w:useAnsiKerningPairs",or.useAnsiKerningPairs)),or.cachedColumnBalance&&this.root.push(new OnOffElement("w:cachedColBalance",or.cachedColumnBalance))}}class SettingsAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}let Settings$1=class extends XmlComponent{constructor(or){var ar;super("w:settings"),this.root.push(new SettingsAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new OnOffElement("w:displayBackgroundShape",!0)),or.trackRevisions!==void 0&&this.root.push(new OnOffElement("w:trackRevisions",or.trackRevisions)),or.evenAndOddHeaders!==void 0&&this.root.push(new OnOffElement("w:evenAndOddHeaders",or.evenAndOddHeaders)),or.updateFields!==void 0&&this.root.push(new OnOffElement("w:updateFields",or.updateFields)),this.root.push(new Compatibility({...or.compatibility??{},version:((ar=or.compatibility)==null?void 0:ar.version)??or.compatibilityModeVersion??15}))}};class ComponentAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{val:"w:val"})}}class Name extends XmlComponent{constructor(or){super("w:name"),this.root.push(new ComponentAttributes({val:or}))}}class UiPriority extends XmlComponent{constructor(or){super("w:uiPriority"),this.root.push(new ComponentAttributes({val:decimalNumber(or)}))}}class StyleAttributes extends XmlAttributeComponent{constructor(){super(...arguments),__publicField(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class Style2 extends XmlComponent{constructor(or,ar){super("w:style"),this.root.push(new StyleAttributes(or)),ar.name&&this.root.push(new Name(ar.name)),ar.basedOn&&this.root.push(new StringValueElement("w:basedOn",ar.basedOn)),ar.next&&this.root.push(new StringValueElement("w:next",ar.next)),ar.link&&this.root.push(new StringValueElement("w:link",ar.link)),ar.uiPriority!==void 0&&this.root.push(new UiPriority(ar.uiPriority)),ar.semiHidden!==void 0&&this.root.push(new OnOffElement("w:semiHidden",ar.semiHidden)),ar.unhideWhenUsed!==void 0&&this.root.push(new OnOffElement("w:unhideWhenUsed",ar.unhideWhenUsed)),ar.quickFormat!==void 0&&this.root.push(new OnOffElement("w:qFormat",ar.quickFormat))}}class StyleForParagraph extends Style2{constructor(or){super({type:"paragraph",styleId:or.id},or),__publicField(this,"paragraphProperties"),__publicField(this,"runProperties"),this.paragraphProperties=new ParagraphProperties(or.paragraph),this.runProperties=new RunProperties(or.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class StyleForCharacter extends Style2{constructor(or){super({type:"character",styleId:or.id},{uiPriority:99,unhideWhenUsed:!0,...or}),__publicField(this,"runProperties"),this.runProperties=new RunProperties(or.run),this.root.push(this.runProperties)}}class HeadingStyle extends StyleForParagraph{constructor(or){super({basedOn:"Normal",next:"Normal",quickFormat:!0,...or})}}class TitleStyle extends HeadingStyle{constructor(or){super({id:"Title",name:"Title",...or})}}class Heading1Style extends HeadingStyle{constructor(or){super({id:"Heading1",name:"Heading 1",...or})}}class Heading2Style extends HeadingStyle{constructor(or){super({id:"Heading2",name:"Heading 2",...or})}}class Heading3Style extends HeadingStyle{constructor(or){super({id:"Heading3",name:"Heading 3",...or})}}class Heading4Style extends HeadingStyle{constructor(or){super({id:"Heading4",name:"Heading 4",...or})}}class Heading5Style extends HeadingStyle{constructor(or){super({id:"Heading5",name:"Heading 5",...or})}}class Heading6Style extends HeadingStyle{constructor(or){super({id:"Heading6",name:"Heading 6",...or})}}class StrongStyle extends HeadingStyle{constructor(or){super({id:"Strong",name:"Strong",...or})}}class ListParagraph extends StyleForParagraph{constructor(or){super({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0,...or})}}class FootnoteText extends StyleForParagraph{constructor(or){super({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:LineRuleType.AUTO}},run:{size:20},...or})}}class FootnoteReferenceStyle extends StyleForCharacter{constructor(or){super({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0},...or})}}class FootnoteTextChar extends StyleForCharacter{constructor(or){super({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20},...or})}}class HyperlinkStyle extends StyleForCharacter{constructor(or){super({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:UnderlineType.SINGLE}},...or})}}class Styles extends XmlComponent{constructor(or){if(super("w:styles"),or.initialStyles&&this.root.push(or.initialStyles),or.importedStyles)for(const ar of or.importedStyles)this.root.push(ar);if(or.paragraphStyles)for(const ar of or.paragraphStyles)this.root.push(new StyleForParagraph(ar));if(or.characterStyles)for(const ar of or.characterStyles)this.root.push(new StyleForCharacter(ar))}}class ParagraphPropertiesDefaults extends XmlComponent{constructor(or){super("w:pPrDefault"),this.root.push(new ParagraphProperties(or))}}class RunPropertiesDefaults extends XmlComponent{constructor(or){super("w:rPrDefault"),this.root.push(new RunProperties(or))}}class DocumentDefaults extends XmlComponent{constructor(or){super("w:docDefaults"),__publicField(this,"runPropertiesDefaults"),__publicField(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new RunPropertiesDefaults(or.run),this.paragraphPropertiesDefaults=new ParagraphPropertiesDefaults(or.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class ExternalStylesFactory{newInstance(or){const ar=lib.xml2js(or,{compact:!1});let cr;for(const fr of ar.elements||[])fr.name==="w:styles"&&(cr=fr);if(cr===void 0)throw new Error("can not find styles element");const ur=cr.elements||[];return new Styles({initialStyles:new ImportedRootElementAttributes(cr.attributes),importedStyles:ur.map(fr=>convertToXmlComponent(fr))})}}class DefaultStylesFactory{newInstance(or={}){return{initialStyles:new DocumentAttributes({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new DocumentDefaults(or.document??{}),new TitleStyle({run:{size:56},...or.title}),new Heading1Style({run:{color:"2E74B5",size:32},...or.heading1}),new Heading2Style({run:{color:"2E74B5",size:26},...or.heading2}),new Heading3Style({run:{color:"1F4D78",size:24},...or.heading3}),new Heading4Style({run:{color:"2E74B5",italics:!0},...or.heading4}),new Heading5Style({run:{color:"2E74B5"},...or.heading5}),new Heading6Style({run:{color:"1F4D78"},...or.heading6}),new StrongStyle({run:{bold:!0},...or.strong}),new ListParagraph(or.listParagraph||{}),new HyperlinkStyle(or.hyperlink||{}),new FootnoteReferenceStyle(or.footnoteReference||{}),new FootnoteText(or.footnoteText||{}),new FootnoteTextChar(or.footnoteTextChar||{})]}}}class File{constructor(or){__publicField(this,"currentRelationshipId",1),__publicField(this,"documentWrapper"),__publicField(this,"headers",[]),__publicField(this,"footers",[]),__publicField(this,"coreProperties"),__publicField(this,"numbering"),__publicField(this,"media"),__publicField(this,"fileRelationships"),__publicField(this,"footnotesWrapper"),__publicField(this,"settings"),__publicField(this,"contentTypes"),__publicField(this,"customProperties"),__publicField(this,"appProperties"),__publicField(this,"styles"),__publicField(this,"comments");var ar,cr;if(this.coreProperties=new CoreProperties({...or,creator:or.creator??"Un-named",revision:or.revision??1,lastModifiedBy:or.lastModifiedBy??"Un-named"}),this.numbering=new Numbering(or.numbering?or.numbering:{config:[]}),this.comments=new Comments(or.comments??{children:[]}),this.fileRelationships=new Relationships,this.customProperties=new CustomProperties(or.customProperties??[]),this.appProperties=new AppProperties,this.footnotesWrapper=new FootnotesWrapper,this.contentTypes=new ContentTypes,this.documentWrapper=new DocumentWrapper({background:or.background}),this.settings=new Settings$1({compatibilityModeVersion:or.compatabilityModeVersion,compatibility:or.compatibility,evenAndOddHeaders:!!or.evenAndOddHeaderAndFooters,trackRevisions:(ar=or.features)==null?void 0:ar.trackRevisions,updateFields:(cr=or.features)==null?void 0:cr.updateFields}),this.media=new Media,or.externalStyles){const ur=new ExternalStylesFactory;this.styles=ur.newInstance(or.externalStyles)}else if(or.styles){const hr=new DefaultStylesFactory().newInstance(or.styles.default);this.styles=new Styles({...hr,...or.styles})}else{const ur=new DefaultStylesFactory;this.styles=new Styles(ur.newInstance())}this.addDefaultRelationships();for(const ur of or.sections)this.addSection(ur);if(or.footnotes)for(const ur in or.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(ur),or.footnotes[ur].children)}addSection({headers:or={},footers:ar={},children:cr,properties:ur}){this.documentWrapper.View.Body.addSection({...ur,headerWrapperGroup:{default:or.default?this.createHeader(or.default):void 0,first:or.first?this.createHeader(or.first):void 0,even:or.even?this.createHeader(or.even):void 0},footerWrapperGroup:{default:ar.default?this.createFooter(ar.default):void 0,first:ar.first?this.createFooter(ar.first):void 0,even:ar.even?this.createFooter(ar.even):void 0}});for(const hr of cr)this.documentWrapper.View.add(hr)}createHeader(or){const ar=new HeaderWrapper(this.media,this.currentRelationshipId++);for(const cr of or.options.children)ar.add(cr);return this.addHeaderToDocument(ar),ar}createFooter(or){const ar=new FooterWrapper(this.media,this.currentRelationshipId++);for(const cr of or.options.children)ar.add(cr);return this.addFooterToDocument(ar),ar}addHeaderToDocument(or,ar=HeaderFooterReferenceType.DEFAULT){this.headers.push({header:or,type:ar}),this.documentWrapper.Relationships.createRelationship(or.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(or,ar=HeaderFooterReferenceType.DEFAULT){this.footers.push({footer:or,type:ar}),this.documentWrapper.Relationships.createRelationship(or.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(or=>or.header)}get Footers(){return this.footers.map(or=>or.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}}function commonjsRequire(lr){throw new Error('Could not dynamically require "'+lr+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jszip_min={exports:{}};(function(lr,or){(function(ar){lr.exports=ar()})(function(){return function ar(cr,ur,hr){function fr(mr,gr){if(!ur[mr]){if(!cr[mr]){var yr=typeof commonjsRequire=="function"&&commonjsRequire;if(!gr&&yr)return yr(mr,!0);if(dr)return dr(mr,!0);var br=new Error("Cannot find module '"+mr+"'");throw br.code="MODULE_NOT_FOUND",br}var Or=ur[mr]={exports:{}};cr[mr][0].call(Or.exports,function(_r){var vr=cr[mr][1][_r];return fr(vr||_r)},Or,Or.exports,ar,cr,ur,hr)}return ur[mr].exports}for(var dr=typeof commonjsRequire=="function"&&commonjsRequire,pr=0;pr<hr.length;pr++)fr(hr[pr]);return fr}({1:[function(ar,cr,ur){var hr=ar("./utils"),fr=ar("./support"),dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";ur.encode=function(pr){for(var mr,gr,yr,br,Or,_r,vr,xr=[],wr=0,kr=pr.length,Cr=kr,$r=hr.getTypeOf(pr)!=="string";wr<pr.length;)Cr=kr-wr,yr=$r?(mr=pr[wr++],gr=wr<kr?pr[wr++]:0,wr<kr?pr[wr++]:0):(mr=pr.charCodeAt(wr++),gr=wr<kr?pr.charCodeAt(wr++):0,wr<kr?pr.charCodeAt(wr++):0),br=mr>>2,Or=(3&mr)<<4|gr>>4,_r=1<Cr?(15&gr)<<2|yr>>6:64,vr=2<Cr?63&yr:64,xr.push(dr.charAt(br)+dr.charAt(Or)+dr.charAt(_r)+dr.charAt(vr));return xr.join("")},ur.decode=function(pr){var mr,gr,yr,br,Or,_r,vr=0,xr=0,wr="data:";if(pr.substr(0,wr.length)===wr)throw new Error("Invalid base64 input, it looks like a data url.");var kr,Cr=3*(pr=pr.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(pr.charAt(pr.length-1)===dr.charAt(64)&&Cr--,pr.charAt(pr.length-2)===dr.charAt(64)&&Cr--,Cr%1!=0)throw new Error("Invalid base64 input, bad content length.");for(kr=fr.uint8array?new Uint8Array(0|Cr):new Array(0|Cr);vr<pr.length;)mr=dr.indexOf(pr.charAt(vr++))<<2|(br=dr.indexOf(pr.charAt(vr++)))>>4,gr=(15&br)<<4|(Or=dr.indexOf(pr.charAt(vr++)))>>2,yr=(3&Or)<<6|(_r=dr.indexOf(pr.charAt(vr++))),kr[xr++]=mr,Or!==64&&(kr[xr++]=gr),_r!==64&&(kr[xr++]=yr);return kr}},{"./support":30,"./utils":32}],2:[function(ar,cr,ur){var hr=ar("./external"),fr=ar("./stream/DataWorker"),dr=ar("./stream/Crc32Probe"),pr=ar("./stream/DataLengthProbe");function mr(gr,yr,br,Or,_r){this.compressedSize=gr,this.uncompressedSize=yr,this.crc32=br,this.compression=Or,this.compressedContent=_r}mr.prototype={getContentWorker:function(){var gr=new fr(hr.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new pr("data_length")),yr=this;return gr.on("end",function(){if(this.streamInfo.data_length!==yr.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),gr},getCompressedWorker:function(){return new fr(hr.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},mr.createWorkerFrom=function(gr,yr,br){return gr.pipe(new dr).pipe(new pr("uncompressedSize")).pipe(yr.compressWorker(br)).pipe(new pr("compressedSize")).withStreamInfo("compression",yr)},cr.exports=mr},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(ar,cr,ur){var hr=ar("./stream/GenericWorker");ur.STORE={magic:"\0\0",compressWorker:function(){return new hr("STORE compression")},uncompressWorker:function(){return new hr("STORE decompression")}},ur.DEFLATE=ar("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(ar,cr,ur){var hr=ar("./utils"),fr=function(){for(var dr,pr=[],mr=0;mr<256;mr++){dr=mr;for(var gr=0;gr<8;gr++)dr=1&dr?3988292384^dr>>>1:dr>>>1;pr[mr]=dr}return pr}();cr.exports=function(dr,pr){return dr!==void 0&&dr.length?hr.getTypeOf(dr)!=="string"?function(mr,gr,yr,br){var Or=fr,_r=br+yr;mr^=-1;for(var vr=br;vr<_r;vr++)mr=mr>>>8^Or[255&(mr^gr[vr])];return-1^mr}(0|pr,dr,dr.length,0):function(mr,gr,yr,br){var Or=fr,_r=br+yr;mr^=-1;for(var vr=br;vr<_r;vr++)mr=mr>>>8^Or[255&(mr^gr.charCodeAt(vr))];return-1^mr}(0|pr,dr,dr.length,0):0}},{"./utils":32}],5:[function(ar,cr,ur){ur.base64=!1,ur.binary=!1,ur.dir=!1,ur.createFolders=!0,ur.date=null,ur.compression=null,ur.compressionOptions=null,ur.comment=null,ur.unixPermissions=null,ur.dosPermissions=null},{}],6:[function(ar,cr,ur){var hr=null;hr=typeof Promise<"u"?Promise:ar("lie"),cr.exports={Promise:hr}},{lie:37}],7:[function(ar,cr,ur){var hr=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",fr=ar("pako"),dr=ar("./utils"),pr=ar("./stream/GenericWorker"),mr=hr?"uint8array":"array";function gr(yr,br){pr.call(this,"FlateWorker/"+yr),this._pako=null,this._pakoAction=yr,this._pakoOptions=br,this.meta={}}ur.magic="\b\0",dr.inherits(gr,pr),gr.prototype.processChunk=function(yr){this.meta=yr.meta,this._pako===null&&this._createPako(),this._pako.push(dr.transformTo(mr,yr.data),!1)},gr.prototype.flush=function(){pr.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},gr.prototype.cleanUp=function(){pr.prototype.cleanUp.call(this),this._pako=null},gr.prototype._createPako=function(){this._pako=new fr[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var yr=this;this._pako.onData=function(br){yr.push({data:br,meta:yr.meta})}},ur.compressWorker=function(yr){return new gr("Deflate",yr)},ur.uncompressWorker=function(){return new gr("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(ar,cr,ur){function hr(Or,_r){var vr,xr="";for(vr=0;vr<_r;vr++)xr+=String.fromCharCode(255&Or),Or>>>=8;return xr}function fr(Or,_r,vr,xr,wr,kr){var Cr,$r,Nr=Or.file,Br=Or.compression,Fr=kr!==mr.utf8encode,Vr=dr.transformTo("string",kr(Nr.name)),Rr=dr.transformTo("string",mr.utf8encode(Nr.name)),Gr=Nr.comment,qr=dr.transformTo("string",kr(Gr)),Ur=dr.transformTo("string",mr.utf8encode(Gr)),Yr=Rr.length!==Nr.name.length,Dr=Ur.length!==Gr.length,Jr="",ai="",Kr="",ui=Nr.dir,ii=Nr.date,di={crc32:0,compressedSize:0,uncompressedSize:0};_r&&!vr||(di.crc32=Or.crc32,di.compressedSize=Or.compressedSize,di.uncompressedSize=Or.uncompressedSize);var ei=0;_r&&(ei|=8),Fr||!Yr&&!Dr||(ei|=2048);var Wr=0,ti=0;ui&&(Wr|=16),wr==="UNIX"?(ti=798,Wr|=function(ci,ni){var Pr=ci;return ci||(Pr=ni?16893:33204),(65535&Pr)<<16}(Nr.unixPermissions,ui)):(ti=20,Wr|=function(ci){return 63&(ci||0)}(Nr.dosPermissions)),Cr=ii.getUTCHours(),Cr<<=6,Cr|=ii.getUTCMinutes(),Cr<<=5,Cr|=ii.getUTCSeconds()/2,$r=ii.getUTCFullYear()-1980,$r<<=4,$r|=ii.getUTCMonth()+1,$r<<=5,$r|=ii.getUTCDate(),Yr&&(ai=hr(1,1)+hr(gr(Vr),4)+Rr,Jr+="up"+hr(ai.length,2)+ai),Dr&&(Kr=hr(1,1)+hr(gr(qr),4)+Ur,Jr+="uc"+hr(Kr.length,2)+Kr);var si="";return si+=`
\0`,si+=hr(ei,2),si+=Br.magic,si+=hr(Cr,2),si+=hr($r,2),si+=hr(di.crc32,4),si+=hr(di.compressedSize,4),si+=hr(di.uncompressedSize,4),si+=hr(Vr.length,2),si+=hr(Jr.length,2),{fileRecord:yr.LOCAL_FILE_HEADER+si+Vr+Jr,dirRecord:yr.CENTRAL_FILE_HEADER+hr(ti,2)+si+hr(qr.length,2)+"\0\0\0\0"+hr(Wr,4)+hr(xr,4)+Vr+Jr+qr}}var dr=ar("../utils"),pr=ar("../stream/GenericWorker"),mr=ar("../utf8"),gr=ar("../crc32"),yr=ar("../signature");function br(Or,_r,vr,xr){pr.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_r,this.zipPlatform=vr,this.encodeFileName=xr,this.streamFiles=Or,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}dr.inherits(br,pr),br.prototype.push=function(Or){var _r=Or.meta.percent||0,vr=this.entriesCount,xr=this._sources.length;this.accumulate?this.contentBuffer.push(Or):(this.bytesWritten+=Or.data.length,pr.prototype.push.call(this,{data:Or.data,meta:{currentFile:this.currentFile,percent:vr?(_r+100*(vr-xr-1))/vr:100}}))},br.prototype.openedSource=function(Or){this.currentSourceOffset=this.bytesWritten,this.currentFile=Or.file.name;var _r=this.streamFiles&&!Or.file.dir;if(_r){var vr=fr(Or,_r,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:vr.fileRecord,meta:{percent:0}})}else this.accumulate=!0},br.prototype.closedSource=function(Or){this.accumulate=!1;var _r=this.streamFiles&&!Or.file.dir,vr=fr(Or,_r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(vr.dirRecord),_r)this.push({data:function(xr){return yr.DATA_DESCRIPTOR+hr(xr.crc32,4)+hr(xr.compressedSize,4)+hr(xr.uncompressedSize,4)}(Or),meta:{percent:100}});else for(this.push({data:vr.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},br.prototype.flush=function(){for(var Or=this.bytesWritten,_r=0;_r<this.dirRecords.length;_r++)this.push({data:this.dirRecords[_r],meta:{percent:100}});var vr=this.bytesWritten-Or,xr=function(wr,kr,Cr,$r,Nr){var Br=dr.transformTo("string",Nr($r));return yr.CENTRAL_DIRECTORY_END+"\0\0\0\0"+hr(wr,2)+hr(wr,2)+hr(kr,4)+hr(Cr,4)+hr(Br.length,2)+Br}(this.dirRecords.length,vr,Or,this.zipComment,this.encodeFileName);this.push({data:xr,meta:{percent:100}})},br.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},br.prototype.registerPrevious=function(Or){this._sources.push(Or);var _r=this;return Or.on("data",function(vr){_r.processChunk(vr)}),Or.on("end",function(){_r.closedSource(_r.previous.streamInfo),_r._sources.length?_r.prepareNextSource():_r.end()}),Or.on("error",function(vr){_r.error(vr)}),this},br.prototype.resume=function(){return!!pr.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},br.prototype.error=function(Or){var _r=this._sources;if(!pr.prototype.error.call(this,Or))return!1;for(var vr=0;vr<_r.length;vr++)try{_r[vr].error(Or)}catch{}return!0},br.prototype.lock=function(){pr.prototype.lock.call(this);for(var Or=this._sources,_r=0;_r<Or.length;_r++)Or[_r].lock()},cr.exports=br},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(ar,cr,ur){var hr=ar("../compressions"),fr=ar("./ZipFileWorker");ur.generateWorker=function(dr,pr,mr){var gr=new fr(pr.streamFiles,mr,pr.platform,pr.encodeFileName),yr=0;try{dr.forEach(function(br,Or){yr++;var _r=function(kr,Cr){var $r=kr||Cr,Nr=hr[$r];if(!Nr)throw new Error($r+" is not a valid compression method !");return Nr}(Or.options.compression,pr.compression),vr=Or.options.compressionOptions||pr.compressionOptions||{},xr=Or.dir,wr=Or.date;Or._compressWorker(_r,vr).withStreamInfo("file",{name:br,dir:xr,date:wr,comment:Or.comment||"",unixPermissions:Or.unixPermissions,dosPermissions:Or.dosPermissions}).pipe(gr)}),gr.entriesCount=yr}catch(br){gr.error(br)}return gr}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(ar,cr,ur){function hr(){if(!(this instanceof hr))return new hr;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var fr=new hr;for(var dr in this)typeof this[dr]!="function"&&(fr[dr]=this[dr]);return fr}}(hr.prototype=ar("./object")).loadAsync=ar("./load"),hr.support=ar("./support"),hr.defaults=ar("./defaults"),hr.version="3.10.1",hr.loadAsync=function(fr,dr){return new hr().loadAsync(fr,dr)},hr.external=ar("./external"),cr.exports=hr},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(ar,cr,ur){var hr=ar("./utils"),fr=ar("./external"),dr=ar("./utf8"),pr=ar("./zipEntries"),mr=ar("./stream/Crc32Probe"),gr=ar("./nodejsUtils");function yr(br){return new fr.Promise(function(Or,_r){var vr=br.decompressed.getContentWorker().pipe(new mr);vr.on("error",function(xr){_r(xr)}).on("end",function(){vr.streamInfo.crc32!==br.decompressed.crc32?_r(new Error("Corrupted zip : CRC32 mismatch")):Or()}).resume()})}cr.exports=function(br,Or){var _r=this;return Or=hr.extend(Or||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:dr.utf8decode}),gr.isNode&&gr.isStream(br)?fr.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):hr.prepareContent("the loaded zip file",br,!0,Or.optimizedBinaryString,Or.base64).then(function(vr){var xr=new pr(Or);return xr.load(vr),xr}).then(function(vr){var xr=[fr.Promise.resolve(vr)],wr=vr.files;if(Or.checkCRC32)for(var kr=0;kr<wr.length;kr++)xr.push(yr(wr[kr]));return fr.Promise.all(xr)}).then(function(vr){for(var xr=vr.shift(),wr=xr.files,kr=0;kr<wr.length;kr++){var Cr=wr[kr],$r=Cr.fileNameStr,Nr=hr.resolve(Cr.fileNameStr);_r.file(Nr,Cr.decompressed,{binary:!0,optimizedBinaryString:!0,date:Cr.date,dir:Cr.dir,comment:Cr.fileCommentStr.length?Cr.fileCommentStr:null,unixPermissions:Cr.unixPermissions,dosPermissions:Cr.dosPermissions,createFolders:Or.createFolders}),Cr.dir||(_r.file(Nr).unsafeOriginalName=$r)}return xr.zipComment.length&&(_r.comment=xr.zipComment),_r})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(ar,cr,ur){var hr=ar("../utils"),fr=ar("../stream/GenericWorker");function dr(pr,mr){fr.call(this,"Nodejs stream input adapter for "+pr),this._upstreamEnded=!1,this._bindStream(mr)}hr.inherits(dr,fr),dr.prototype._bindStream=function(pr){var mr=this;(this._stream=pr).pause(),pr.on("data",function(gr){mr.push({data:gr,meta:{percent:0}})}).on("error",function(gr){mr.isPaused?this.generatedError=gr:mr.error(gr)}).on("end",function(){mr.isPaused?mr._upstreamEnded=!0:mr.end()})},dr.prototype.pause=function(){return!!fr.prototype.pause.call(this)&&(this._stream.pause(),!0)},dr.prototype.resume=function(){return!!fr.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},cr.exports=dr},{"../stream/GenericWorker":28,"../utils":32}],13:[function(ar,cr,ur){var hr=ar("readable-stream").Readable;function fr(dr,pr,mr){hr.call(this,pr),this._helper=dr;var gr=this;dr.on("data",function(yr,br){gr.push(yr)||gr._helper.pause(),mr&&mr(br)}).on("error",function(yr){gr.emit("error",yr)}).on("end",function(){gr.push(null)})}ar("../utils").inherits(fr,hr),fr.prototype._read=function(){this._helper.resume()},cr.exports=fr},{"../utils":32,"readable-stream":16}],14:[function(ar,cr,ur){cr.exports={isNode:typeof Buffer<"u",newBufferFrom:function(hr,fr){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(hr,fr);if(typeof hr=="number")throw new Error('The "data" argument must not be a number');return new Buffer(hr,fr)},allocBuffer:function(hr){if(Buffer.alloc)return Buffer.alloc(hr);var fr=new Buffer(hr);return fr.fill(0),fr},isBuffer:function(hr){return Buffer.isBuffer(hr)},isStream:function(hr){return hr&&typeof hr.on=="function"&&typeof hr.pause=="function"&&typeof hr.resume=="function"}}},{}],15:[function(ar,cr,ur){function hr(Nr,Br,Fr){var Vr,Rr=dr.getTypeOf(Br),Gr=dr.extend(Fr||{},gr);Gr.date=Gr.date||new Date,Gr.compression!==null&&(Gr.compression=Gr.compression.toUpperCase()),typeof Gr.unixPermissions=="string"&&(Gr.unixPermissions=parseInt(Gr.unixPermissions,8)),Gr.unixPermissions&&16384&Gr.unixPermissions&&(Gr.dir=!0),Gr.dosPermissions&&16&Gr.dosPermissions&&(Gr.dir=!0),Gr.dir&&(Nr=wr(Nr)),Gr.createFolders&&(Vr=xr(Nr))&&kr.call(this,Vr,!0);var qr=Rr==="string"&&Gr.binary===!1&&Gr.base64===!1;Fr&&Fr.binary!==void 0||(Gr.binary=!qr),(Br instanceof yr&&Br.uncompressedSize===0||Gr.dir||!Br||Br.length===0)&&(Gr.base64=!1,Gr.binary=!0,Br="",Gr.compression="STORE",Rr="string");var Ur=null;Ur=Br instanceof yr||Br instanceof pr?Br:_r.isNode&&_r.isStream(Br)?new vr(Nr,Br):dr.prepareContent(Nr,Br,Gr.binary,Gr.optimizedBinaryString,Gr.base64);var Yr=new br(Nr,Ur,Gr);this.files[Nr]=Yr}var fr=ar("./utf8"),dr=ar("./utils"),pr=ar("./stream/GenericWorker"),mr=ar("./stream/StreamHelper"),gr=ar("./defaults"),yr=ar("./compressedObject"),br=ar("./zipObject"),Or=ar("./generate"),_r=ar("./nodejsUtils"),vr=ar("./nodejs/NodejsStreamInputAdapter"),xr=function(Nr){Nr.slice(-1)==="/"&&(Nr=Nr.substring(0,Nr.length-1));var Br=Nr.lastIndexOf("/");return 0<Br?Nr.substring(0,Br):""},wr=function(Nr){return Nr.slice(-1)!=="/"&&(Nr+="/"),Nr},kr=function(Nr,Br){return Br=Br!==void 0?Br:gr.createFolders,Nr=wr(Nr),this.files[Nr]||hr.call(this,Nr,null,{dir:!0,createFolders:Br}),this.files[Nr]};function Cr(Nr){return Object.prototype.toString.call(Nr)==="[object RegExp]"}var $r={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Nr){var Br,Fr,Vr;for(Br in this.files)Vr=this.files[Br],(Fr=Br.slice(this.root.length,Br.length))&&Br.slice(0,this.root.length)===this.root&&Nr(Fr,Vr)},filter:function(Nr){var Br=[];return this.forEach(function(Fr,Vr){Nr(Fr,Vr)&&Br.push(Vr)}),Br},file:function(Nr,Br,Fr){if(arguments.length!==1)return Nr=this.root+Nr,hr.call(this,Nr,Br,Fr),this;if(Cr(Nr)){var Vr=Nr;return this.filter(function(Gr,qr){return!qr.dir&&Vr.test(Gr)})}var Rr=this.files[this.root+Nr];return Rr&&!Rr.dir?Rr:null},folder:function(Nr){if(!Nr)return this;if(Cr(Nr))return this.filter(function(Rr,Gr){return Gr.dir&&Nr.test(Rr)});var Br=this.root+Nr,Fr=kr.call(this,Br),Vr=this.clone();return Vr.root=Fr.name,Vr},remove:function(Nr){Nr=this.root+Nr;var Br=this.files[Nr];if(Br||(Nr.slice(-1)!=="/"&&(Nr+="/"),Br=this.files[Nr]),Br&&!Br.dir)delete this.files[Nr];else for(var Fr=this.filter(function(Rr,Gr){return Gr.name.slice(0,Nr.length)===Nr}),Vr=0;Vr<Fr.length;Vr++)delete this.files[Fr[Vr].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Nr){var Br,Fr={};try{if((Fr=dr.extend(Nr||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:fr.utf8encode})).type=Fr.type.toLowerCase(),Fr.compression=Fr.compression.toUpperCase(),Fr.type==="binarystring"&&(Fr.type="string"),!Fr.type)throw new Error("No output type specified.");dr.checkSupport(Fr.type),Fr.platform!=="darwin"&&Fr.platform!=="freebsd"&&Fr.platform!=="linux"&&Fr.platform!=="sunos"||(Fr.platform="UNIX"),Fr.platform==="win32"&&(Fr.platform="DOS");var Vr=Fr.comment||this.comment||"";Br=Or.generateWorker(this,Fr,Vr)}catch(Rr){(Br=new pr("error")).error(Rr)}return new mr(Br,Fr.type||"string",Fr.mimeType)},generateAsync:function(Nr,Br){return this.generateInternalStream(Nr).accumulate(Br)},generateNodeStream:function(Nr,Br){return(Nr=Nr||{}).type||(Nr.type="nodebuffer"),this.generateInternalStream(Nr).toNodejsStream(Br)}};cr.exports=$r},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(ar,cr,ur){cr.exports=ar("stream")},{stream:void 0}],17:[function(ar,cr,ur){var hr=ar("./DataReader");function fr(dr){hr.call(this,dr);for(var pr=0;pr<this.data.length;pr++)dr[pr]=255&dr[pr]}ar("../utils").inherits(fr,hr),fr.prototype.byteAt=function(dr){return this.data[this.zero+dr]},fr.prototype.lastIndexOfSignature=function(dr){for(var pr=dr.charCodeAt(0),mr=dr.charCodeAt(1),gr=dr.charCodeAt(2),yr=dr.charCodeAt(3),br=this.length-4;0<=br;--br)if(this.data[br]===pr&&this.data[br+1]===mr&&this.data[br+2]===gr&&this.data[br+3]===yr)return br-this.zero;return-1},fr.prototype.readAndCheckSignature=function(dr){var pr=dr.charCodeAt(0),mr=dr.charCodeAt(1),gr=dr.charCodeAt(2),yr=dr.charCodeAt(3),br=this.readData(4);return pr===br[0]&&mr===br[1]&&gr===br[2]&&yr===br[3]},fr.prototype.readData=function(dr){if(this.checkOffset(dr),dr===0)return[];var pr=this.data.slice(this.zero+this.index,this.zero+this.index+dr);return this.index+=dr,pr},cr.exports=fr},{"../utils":32,"./DataReader":18}],18:[function(ar,cr,ur){var hr=ar("../utils");function fr(dr){this.data=dr,this.length=dr.length,this.index=0,this.zero=0}fr.prototype={checkOffset:function(dr){this.checkIndex(this.index+dr)},checkIndex:function(dr){if(this.length<this.zero+dr||dr<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+dr+"). Corrupted zip ?")},setIndex:function(dr){this.checkIndex(dr),this.index=dr},skip:function(dr){this.setIndex(this.index+dr)},byteAt:function(){},readInt:function(dr){var pr,mr=0;for(this.checkOffset(dr),pr=this.index+dr-1;pr>=this.index;pr--)mr=(mr<<8)+this.byteAt(pr);return this.index+=dr,mr},readString:function(dr){return hr.transformTo("string",this.readData(dr))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var dr=this.readInt(4);return new Date(Date.UTC(1980+(dr>>25&127),(dr>>21&15)-1,dr>>16&31,dr>>11&31,dr>>5&63,(31&dr)<<1))}},cr.exports=fr},{"../utils":32}],19:[function(ar,cr,ur){var hr=ar("./Uint8ArrayReader");function fr(dr){hr.call(this,dr)}ar("../utils").inherits(fr,hr),fr.prototype.readData=function(dr){this.checkOffset(dr);var pr=this.data.slice(this.zero+this.index,this.zero+this.index+dr);return this.index+=dr,pr},cr.exports=fr},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(ar,cr,ur){var hr=ar("./DataReader");function fr(dr){hr.call(this,dr)}ar("../utils").inherits(fr,hr),fr.prototype.byteAt=function(dr){return this.data.charCodeAt(this.zero+dr)},fr.prototype.lastIndexOfSignature=function(dr){return this.data.lastIndexOf(dr)-this.zero},fr.prototype.readAndCheckSignature=function(dr){return dr===this.readData(4)},fr.prototype.readData=function(dr){this.checkOffset(dr);var pr=this.data.slice(this.zero+this.index,this.zero+this.index+dr);return this.index+=dr,pr},cr.exports=fr},{"../utils":32,"./DataReader":18}],21:[function(ar,cr,ur){var hr=ar("./ArrayReader");function fr(dr){hr.call(this,dr)}ar("../utils").inherits(fr,hr),fr.prototype.readData=function(dr){if(this.checkOffset(dr),dr===0)return new Uint8Array(0);var pr=this.data.subarray(this.zero+this.index,this.zero+this.index+dr);return this.index+=dr,pr},cr.exports=fr},{"../utils":32,"./ArrayReader":17}],22:[function(ar,cr,ur){var hr=ar("../utils"),fr=ar("../support"),dr=ar("./ArrayReader"),pr=ar("./StringReader"),mr=ar("./NodeBufferReader"),gr=ar("./Uint8ArrayReader");cr.exports=function(yr){var br=hr.getTypeOf(yr);return hr.checkSupport(br),br!=="string"||fr.uint8array?br==="nodebuffer"?new mr(yr):fr.uint8array?new gr(hr.transformTo("uint8array",yr)):new dr(hr.transformTo("array",yr)):new pr(yr)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(ar,cr,ur){ur.LOCAL_FILE_HEADER="PK",ur.CENTRAL_FILE_HEADER="PK",ur.CENTRAL_DIRECTORY_END="PK",ur.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",ur.ZIP64_CENTRAL_DIRECTORY_END="PK",ur.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(ar,cr,ur){var hr=ar("./GenericWorker"),fr=ar("../utils");function dr(pr){hr.call(this,"ConvertWorker to "+pr),this.destType=pr}fr.inherits(dr,hr),dr.prototype.processChunk=function(pr){this.push({data:fr.transformTo(this.destType,pr.data),meta:pr.meta})},cr.exports=dr},{"../utils":32,"./GenericWorker":28}],25:[function(ar,cr,ur){var hr=ar("./GenericWorker"),fr=ar("../crc32");function dr(){hr.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}ar("../utils").inherits(dr,hr),dr.prototype.processChunk=function(pr){this.streamInfo.crc32=fr(pr.data,this.streamInfo.crc32||0),this.push(pr)},cr.exports=dr},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(ar,cr,ur){var hr=ar("../utils"),fr=ar("./GenericWorker");function dr(pr){fr.call(this,"DataLengthProbe for "+pr),this.propName=pr,this.withStreamInfo(pr,0)}hr.inherits(dr,fr),dr.prototype.processChunk=function(pr){if(pr){var mr=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=mr+pr.data.length}fr.prototype.processChunk.call(this,pr)},cr.exports=dr},{"../utils":32,"./GenericWorker":28}],27:[function(ar,cr,ur){var hr=ar("../utils"),fr=ar("./GenericWorker");function dr(pr){fr.call(this,"DataWorker");var mr=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,pr.then(function(gr){mr.dataIsReady=!0,mr.data=gr,mr.max=gr&&gr.length||0,mr.type=hr.getTypeOf(gr),mr.isPaused||mr._tickAndRepeat()},function(gr){mr.error(gr)})}hr.inherits(dr,fr),dr.prototype.cleanUp=function(){fr.prototype.cleanUp.call(this),this.data=null},dr.prototype.resume=function(){return!!fr.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,hr.delay(this._tickAndRepeat,[],this)),!0)},dr.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(hr.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},dr.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var pr=null,mr=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":pr=this.data.substring(this.index,mr);break;case"uint8array":pr=this.data.subarray(this.index,mr);break;case"array":case"nodebuffer":pr=this.data.slice(this.index,mr)}return this.index=mr,this.push({data:pr,meta:{percent:this.max?this.index/this.max*100:0}})},cr.exports=dr},{"../utils":32,"./GenericWorker":28}],28:[function(ar,cr,ur){function hr(fr){this.name=fr||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}hr.prototype={push:function(fr){this.emit("data",fr)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(fr){this.emit("error",fr)}return!0},error:function(fr){return!this.isFinished&&(this.isPaused?this.generatedError=fr:(this.isFinished=!0,this.emit("error",fr),this.previous&&this.previous.error(fr),this.cleanUp()),!0)},on:function(fr,dr){return this._listeners[fr].push(dr),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(fr,dr){if(this._listeners[fr])for(var pr=0;pr<this._listeners[fr].length;pr++)this._listeners[fr][pr].call(this,dr)},pipe:function(fr){return fr.registerPrevious(this)},registerPrevious:function(fr){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=fr.streamInfo,this.mergeStreamInfo(),this.previous=fr;var dr=this;return fr.on("data",function(pr){dr.processChunk(pr)}),fr.on("end",function(){dr.end()}),fr.on("error",function(pr){dr.error(pr)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var fr=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),fr=!0),this.previous&&this.previous.resume(),!fr},flush:function(){},processChunk:function(fr){this.push(fr)},withStreamInfo:function(fr,dr){return this.extraStreamInfo[fr]=dr,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var fr in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,fr)&&(this.streamInfo[fr]=this.extraStreamInfo[fr])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var fr="Worker "+this.name;return this.previous?this.previous+" -> "+fr:fr}},cr.exports=hr},{}],29:[function(ar,cr,ur){var hr=ar("../utils"),fr=ar("./ConvertWorker"),dr=ar("./GenericWorker"),pr=ar("../base64"),mr=ar("../support"),gr=ar("../external"),yr=null;if(mr.nodestream)try{yr=ar("../nodejs/NodejsStreamOutputAdapter")}catch{}function br(_r,vr){return new gr.Promise(function(xr,wr){var kr=[],Cr=_r._internalType,$r=_r._outputType,Nr=_r._mimeType;_r.on("data",function(Br,Fr){kr.push(Br),vr&&vr(Fr)}).on("error",function(Br){kr=[],wr(Br)}).on("end",function(){try{var Br=function(Fr,Vr,Rr){switch(Fr){case"blob":return hr.newBlob(hr.transformTo("arraybuffer",Vr),Rr);case"base64":return pr.encode(Vr);default:return hr.transformTo(Fr,Vr)}}($r,function(Fr,Vr){var Rr,Gr=0,qr=null,Ur=0;for(Rr=0;Rr<Vr.length;Rr++)Ur+=Vr[Rr].length;switch(Fr){case"string":return Vr.join("");case"array":return Array.prototype.concat.apply([],Vr);case"uint8array":for(qr=new Uint8Array(Ur),Rr=0;Rr<Vr.length;Rr++)qr.set(Vr[Rr],Gr),Gr+=Vr[Rr].length;return qr;case"nodebuffer":return Buffer.concat(Vr);default:throw new Error("concat : unsupported type '"+Fr+"'")}}(Cr,kr),Nr);xr(Br)}catch(Fr){wr(Fr)}kr=[]}).resume()})}function Or(_r,vr,xr){var wr=vr;switch(vr){case"blob":case"arraybuffer":wr="uint8array";break;case"base64":wr="string"}try{this._internalType=wr,this._outputType=vr,this._mimeType=xr,hr.checkSupport(wr),this._worker=_r.pipe(new fr(wr)),_r.lock()}catch(kr){this._worker=new dr("error"),this._worker.error(kr)}}Or.prototype={accumulate:function(_r){return br(this,_r)},on:function(_r,vr){var xr=this;return _r==="data"?this._worker.on(_r,function(wr){vr.call(xr,wr.data,wr.meta)}):this._worker.on(_r,function(){hr.delay(vr,arguments,xr)}),this},resume:function(){return hr.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_r){if(hr.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new yr(this,{objectMode:this._outputType!=="nodebuffer"},_r)}},cr.exports=Or},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(ar,cr,ur){if(ur.base64=!0,ur.array=!0,ur.string=!0,ur.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",ur.nodebuffer=typeof Buffer<"u",ur.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")ur.blob=!1;else{var hr=new ArrayBuffer(0);try{ur.blob=new Blob([hr],{type:"application/zip"}).size===0}catch{try{var fr=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);fr.append(hr),ur.blob=fr.getBlob("application/zip").size===0}catch{ur.blob=!1}}}try{ur.nodestream=!!ar("readable-stream").Readable}catch{ur.nodestream=!1}},{"readable-stream":16}],31:[function(ar,cr,ur){for(var hr=ar("./utils"),fr=ar("./support"),dr=ar("./nodejsUtils"),pr=ar("./stream/GenericWorker"),mr=new Array(256),gr=0;gr<256;gr++)mr[gr]=252<=gr?6:248<=gr?5:240<=gr?4:224<=gr?3:192<=gr?2:1;mr[254]=mr[254]=1;function yr(){pr.call(this,"utf-8 decode"),this.leftOver=null}function br(){pr.call(this,"utf-8 encode")}ur.utf8encode=function(Or){return fr.nodebuffer?dr.newBufferFrom(Or,"utf-8"):function(_r){var vr,xr,wr,kr,Cr,$r=_r.length,Nr=0;for(kr=0;kr<$r;kr++)(64512&(xr=_r.charCodeAt(kr)))==55296&&kr+1<$r&&(64512&(wr=_r.charCodeAt(kr+1)))==56320&&(xr=65536+(xr-55296<<10)+(wr-56320),kr++),Nr+=xr<128?1:xr<2048?2:xr<65536?3:4;for(vr=fr.uint8array?new Uint8Array(Nr):new Array(Nr),kr=Cr=0;Cr<Nr;kr++)(64512&(xr=_r.charCodeAt(kr)))==55296&&kr+1<$r&&(64512&(wr=_r.charCodeAt(kr+1)))==56320&&(xr=65536+(xr-55296<<10)+(wr-56320),kr++),xr<128?vr[Cr++]=xr:(xr<2048?vr[Cr++]=192|xr>>>6:(xr<65536?vr[Cr++]=224|xr>>>12:(vr[Cr++]=240|xr>>>18,vr[Cr++]=128|xr>>>12&63),vr[Cr++]=128|xr>>>6&63),vr[Cr++]=128|63&xr);return vr}(Or)},ur.utf8decode=function(Or){return fr.nodebuffer?hr.transformTo("nodebuffer",Or).toString("utf-8"):function(_r){var vr,xr,wr,kr,Cr=_r.length,$r=new Array(2*Cr);for(vr=xr=0;vr<Cr;)if((wr=_r[vr++])<128)$r[xr++]=wr;else if(4<(kr=mr[wr]))$r[xr++]=65533,vr+=kr-1;else{for(wr&=kr===2?31:kr===3?15:7;1<kr&&vr<Cr;)wr=wr<<6|63&_r[vr++],kr--;1<kr?$r[xr++]=65533:wr<65536?$r[xr++]=wr:(wr-=65536,$r[xr++]=55296|wr>>10&1023,$r[xr++]=56320|1023&wr)}return $r.length!==xr&&($r.subarray?$r=$r.subarray(0,xr):$r.length=xr),hr.applyFromCharCode($r)}(Or=hr.transformTo(fr.uint8array?"uint8array":"array",Or))},hr.inherits(yr,pr),yr.prototype.processChunk=function(Or){var _r=hr.transformTo(fr.uint8array?"uint8array":"array",Or.data);if(this.leftOver&&this.leftOver.length){if(fr.uint8array){var vr=_r;(_r=new Uint8Array(vr.length+this.leftOver.length)).set(this.leftOver,0),_r.set(vr,this.leftOver.length)}else _r=this.leftOver.concat(_r);this.leftOver=null}var xr=function(kr,Cr){var $r;for((Cr=Cr||kr.length)>kr.length&&(Cr=kr.length),$r=Cr-1;0<=$r&&(192&kr[$r])==128;)$r--;return $r<0||$r===0?Cr:$r+mr[kr[$r]]>Cr?$r:Cr}(_r),wr=_r;xr!==_r.length&&(fr.uint8array?(wr=_r.subarray(0,xr),this.leftOver=_r.subarray(xr,_r.length)):(wr=_r.slice(0,xr),this.leftOver=_r.slice(xr,_r.length))),this.push({data:ur.utf8decode(wr),meta:Or.meta})},yr.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:ur.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},ur.Utf8DecodeWorker=yr,hr.inherits(br,pr),br.prototype.processChunk=function(Or){this.push({data:ur.utf8encode(Or.data),meta:Or.meta})},ur.Utf8EncodeWorker=br},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(ar,cr,ur){var hr=ar("./support"),fr=ar("./base64"),dr=ar("./nodejsUtils"),pr=ar("./external");function mr(vr){return vr}function gr(vr,xr){for(var wr=0;wr<vr.length;++wr)xr[wr]=255&vr.charCodeAt(wr);return xr}ar("setimmediate"),ur.newBlob=function(vr,xr){ur.checkSupport("blob");try{return new Blob([vr],{type:xr})}catch{try{var wr=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return wr.append(vr),wr.getBlob(xr)}catch{throw new Error("Bug : can't construct the Blob.")}}};var yr={stringifyByChunk:function(vr,xr,wr){var kr=[],Cr=0,$r=vr.length;if($r<=wr)return String.fromCharCode.apply(null,vr);for(;Cr<$r;)xr==="array"||xr==="nodebuffer"?kr.push(String.fromCharCode.apply(null,vr.slice(Cr,Math.min(Cr+wr,$r)))):kr.push(String.fromCharCode.apply(null,vr.subarray(Cr,Math.min(Cr+wr,$r)))),Cr+=wr;return kr.join("")},stringifyByChar:function(vr){for(var xr="",wr=0;wr<vr.length;wr++)xr+=String.fromCharCode(vr[wr]);return xr},applyCanBeUsed:{uint8array:function(){try{return hr.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return hr.nodebuffer&&String.fromCharCode.apply(null,dr.allocBuffer(1)).length===1}catch{return!1}}()}};function br(vr){var xr=65536,wr=ur.getTypeOf(vr),kr=!0;if(wr==="uint8array"?kr=yr.applyCanBeUsed.uint8array:wr==="nodebuffer"&&(kr=yr.applyCanBeUsed.nodebuffer),kr)for(;1<xr;)try{return yr.stringifyByChunk(vr,wr,xr)}catch{xr=Math.floor(xr/2)}return yr.stringifyByChar(vr)}function Or(vr,xr){for(var wr=0;wr<vr.length;wr++)xr[wr]=vr[wr];return xr}ur.applyFromCharCode=br;var _r={};_r.string={string:mr,array:function(vr){return gr(vr,new Array(vr.length))},arraybuffer:function(vr){return _r.string.uint8array(vr).buffer},uint8array:function(vr){return gr(vr,new Uint8Array(vr.length))},nodebuffer:function(vr){return gr(vr,dr.allocBuffer(vr.length))}},_r.array={string:br,array:mr,arraybuffer:function(vr){return new Uint8Array(vr).buffer},uint8array:function(vr){return new Uint8Array(vr)},nodebuffer:function(vr){return dr.newBufferFrom(vr)}},_r.arraybuffer={string:function(vr){return br(new Uint8Array(vr))},array:function(vr){return Or(new Uint8Array(vr),new Array(vr.byteLength))},arraybuffer:mr,uint8array:function(vr){return new Uint8Array(vr)},nodebuffer:function(vr){return dr.newBufferFrom(new Uint8Array(vr))}},_r.uint8array={string:br,array:function(vr){return Or(vr,new Array(vr.length))},arraybuffer:function(vr){return vr.buffer},uint8array:mr,nodebuffer:function(vr){return dr.newBufferFrom(vr)}},_r.nodebuffer={string:br,array:function(vr){return Or(vr,new Array(vr.length))},arraybuffer:function(vr){return _r.nodebuffer.uint8array(vr).buffer},uint8array:function(vr){return Or(vr,new Uint8Array(vr.length))},nodebuffer:mr},ur.transformTo=function(vr,xr){if(xr=xr||"",!vr)return xr;ur.checkSupport(vr);var wr=ur.getTypeOf(xr);return _r[wr][vr](xr)},ur.resolve=function(vr){for(var xr=vr.split("/"),wr=[],kr=0;kr<xr.length;kr++){var Cr=xr[kr];Cr==="."||Cr===""&&kr!==0&&kr!==xr.length-1||(Cr===".."?wr.pop():wr.push(Cr))}return wr.join("/")},ur.getTypeOf=function(vr){return typeof vr=="string"?"string":Object.prototype.toString.call(vr)==="[object Array]"?"array":hr.nodebuffer&&dr.isBuffer(vr)?"nodebuffer":hr.uint8array&&vr instanceof Uint8Array?"uint8array":hr.arraybuffer&&vr instanceof ArrayBuffer?"arraybuffer":void 0},ur.checkSupport=function(vr){if(!hr[vr.toLowerCase()])throw new Error(vr+" is not supported by this platform")},ur.MAX_VALUE_16BITS=65535,ur.MAX_VALUE_32BITS=-1,ur.pretty=function(vr){var xr,wr,kr="";for(wr=0;wr<(vr||"").length;wr++)kr+="\\x"+((xr=vr.charCodeAt(wr))<16?"0":"")+xr.toString(16).toUpperCase();return kr},ur.delay=function(vr,xr,wr){setImmediate(function(){vr.apply(wr||null,xr||[])})},ur.inherits=function(vr,xr){function wr(){}wr.prototype=xr.prototype,vr.prototype=new wr},ur.extend=function(){var vr,xr,wr={};for(vr=0;vr<arguments.length;vr++)for(xr in arguments[vr])Object.prototype.hasOwnProperty.call(arguments[vr],xr)&&wr[xr]===void 0&&(wr[xr]=arguments[vr][xr]);return wr},ur.prepareContent=function(vr,xr,wr,kr,Cr){return pr.Promise.resolve(xr).then(function($r){return hr.blob&&($r instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call($r))!==-1)&&typeof FileReader<"u"?new pr.Promise(function(Nr,Br){var Fr=new FileReader;Fr.onload=function(Vr){Nr(Vr.target.result)},Fr.onerror=function(Vr){Br(Vr.target.error)},Fr.readAsArrayBuffer($r)}):$r}).then(function($r){var Nr=ur.getTypeOf($r);return Nr?(Nr==="arraybuffer"?$r=ur.transformTo("uint8array",$r):Nr==="string"&&(Cr?$r=fr.decode($r):wr&&kr!==!0&&($r=function(Br){return gr(Br,hr.uint8array?new Uint8Array(Br.length):new Array(Br.length))}($r))),$r):pr.Promise.reject(new Error("Can't read the data of '"+vr+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(ar,cr,ur){var hr=ar("./reader/readerFor"),fr=ar("./utils"),dr=ar("./signature"),pr=ar("./zipEntry"),mr=ar("./support");function gr(yr){this.files=[],this.loadOptions=yr}gr.prototype={checkSignature:function(yr){if(!this.reader.readAndCheckSignature(yr)){this.reader.index-=4;var br=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+fr.pretty(br)+", expected "+fr.pretty(yr)+")")}},isSignature:function(yr,br){var Or=this.reader.index;this.reader.setIndex(yr);var _r=this.reader.readString(4)===br;return this.reader.setIndex(Or),_r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var yr=this.reader.readData(this.zipCommentLength),br=mr.uint8array?"uint8array":"array",Or=fr.transformTo(br,yr);this.zipComment=this.loadOptions.decodeFileName(Or)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var yr,br,Or,_r=this.zip64EndOfCentralSize-44;0<_r;)yr=this.reader.readInt(2),br=this.reader.readInt(4),Or=this.reader.readData(br),this.zip64ExtensibleData[yr]={id:yr,length:br,value:Or}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var yr,br;for(yr=0;yr<this.files.length;yr++)br=this.files[yr],this.reader.setIndex(br.localHeaderOffset),this.checkSignature(dr.LOCAL_FILE_HEADER),br.readLocalPart(this.reader),br.handleUTF8(),br.processAttributes()},readCentralDir:function(){var yr;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(dr.CENTRAL_FILE_HEADER);)(yr=new pr({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(yr);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var yr=this.reader.lastIndexOfSignature(dr.CENTRAL_DIRECTORY_END);if(yr<0)throw this.isSignature(0,dr.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(yr);var br=yr;if(this.checkSignature(dr.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===fr.MAX_VALUE_16BITS||this.diskWithCentralDirStart===fr.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===fr.MAX_VALUE_16BITS||this.centralDirRecords===fr.MAX_VALUE_16BITS||this.centralDirSize===fr.MAX_VALUE_32BITS||this.centralDirOffset===fr.MAX_VALUE_32BITS){if(this.zip64=!0,(yr=this.reader.lastIndexOfSignature(dr.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(yr),this.checkSignature(dr.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,dr.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(dr.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(dr.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var Or=this.centralDirOffset+this.centralDirSize;this.zip64&&(Or+=20,Or+=12+this.zip64EndOfCentralSize);var _r=br-Or;if(0<_r)this.isSignature(br,dr.CENTRAL_FILE_HEADER)||(this.reader.zero=_r);else if(_r<0)throw new Error("Corrupted zip: missing "+Math.abs(_r)+" bytes.")},prepareReader:function(yr){this.reader=hr(yr)},load:function(yr){this.prepareReader(yr),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},cr.exports=gr},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(ar,cr,ur){var hr=ar("./reader/readerFor"),fr=ar("./utils"),dr=ar("./compressedObject"),pr=ar("./crc32"),mr=ar("./utf8"),gr=ar("./compressions"),yr=ar("./support");function br(Or,_r){this.options=Or,this.loadOptions=_r}br.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(Or){var _r,vr;if(Or.skip(22),this.fileNameLength=Or.readInt(2),vr=Or.readInt(2),this.fileName=Or.readData(this.fileNameLength),Or.skip(vr),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_r=function(xr){for(var wr in gr)if(Object.prototype.hasOwnProperty.call(gr,wr)&&gr[wr].magic===xr)return gr[wr];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+fr.pretty(this.compressionMethod)+" unknown (inner file : "+fr.transformTo("string",this.fileName)+")");this.decompressed=new dr(this.compressedSize,this.uncompressedSize,this.crc32,_r,Or.readData(this.compressedSize))},readCentralPart:function(Or){this.versionMadeBy=Or.readInt(2),Or.skip(2),this.bitFlag=Or.readInt(2),this.compressionMethod=Or.readString(2),this.date=Or.readDate(),this.crc32=Or.readInt(4),this.compressedSize=Or.readInt(4),this.uncompressedSize=Or.readInt(4);var _r=Or.readInt(2);if(this.extraFieldsLength=Or.readInt(2),this.fileCommentLength=Or.readInt(2),this.diskNumberStart=Or.readInt(2),this.internalFileAttributes=Or.readInt(2),this.externalFileAttributes=Or.readInt(4),this.localHeaderOffset=Or.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");Or.skip(_r),this.readExtraFields(Or),this.parseZIP64ExtraField(Or),this.fileComment=Or.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var Or=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),Or==0&&(this.dosPermissions=63&this.externalFileAttributes),Or==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var Or=hr(this.extraFields[1].value);this.uncompressedSize===fr.MAX_VALUE_32BITS&&(this.uncompressedSize=Or.readInt(8)),this.compressedSize===fr.MAX_VALUE_32BITS&&(this.compressedSize=Or.readInt(8)),this.localHeaderOffset===fr.MAX_VALUE_32BITS&&(this.localHeaderOffset=Or.readInt(8)),this.diskNumberStart===fr.MAX_VALUE_32BITS&&(this.diskNumberStart=Or.readInt(4))}},readExtraFields:function(Or){var _r,vr,xr,wr=Or.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});Or.index+4<wr;)_r=Or.readInt(2),vr=Or.readInt(2),xr=Or.readData(vr),this.extraFields[_r]={id:_r,length:vr,value:xr};Or.setIndex(wr)},handleUTF8:function(){var Or=yr.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=mr.utf8decode(this.fileName),this.fileCommentStr=mr.utf8decode(this.fileComment);else{var _r=this.findExtraFieldUnicodePath();if(_r!==null)this.fileNameStr=_r;else{var vr=fr.transformTo(Or,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(vr)}var xr=this.findExtraFieldUnicodeComment();if(xr!==null)this.fileCommentStr=xr;else{var wr=fr.transformTo(Or,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(wr)}}},findExtraFieldUnicodePath:function(){var Or=this.extraFields[28789];if(Or){var _r=hr(Or.value);return _r.readInt(1)!==1||pr(this.fileName)!==_r.readInt(4)?null:mr.utf8decode(_r.readData(Or.length-5))}return null},findExtraFieldUnicodeComment:function(){var Or=this.extraFields[25461];if(Or){var _r=hr(Or.value);return _r.readInt(1)!==1||pr(this.fileComment)!==_r.readInt(4)?null:mr.utf8decode(_r.readData(Or.length-5))}return null}},cr.exports=br},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(ar,cr,ur){function hr(_r,vr,xr){this.name=_r,this.dir=xr.dir,this.date=xr.date,this.comment=xr.comment,this.unixPermissions=xr.unixPermissions,this.dosPermissions=xr.dosPermissions,this._data=vr,this._dataBinary=xr.binary,this.options={compression:xr.compression,compressionOptions:xr.compressionOptions}}var fr=ar("./stream/StreamHelper"),dr=ar("./stream/DataWorker"),pr=ar("./utf8"),mr=ar("./compressedObject"),gr=ar("./stream/GenericWorker");hr.prototype={internalStream:function(_r){var vr=null,xr="string";try{if(!_r)throw new Error("No output type specified.");var wr=(xr=_r.toLowerCase())==="string"||xr==="text";xr!=="binarystring"&&xr!=="text"||(xr="string"),vr=this._decompressWorker();var kr=!this._dataBinary;kr&&!wr&&(vr=vr.pipe(new pr.Utf8EncodeWorker)),!kr&&wr&&(vr=vr.pipe(new pr.Utf8DecodeWorker))}catch(Cr){(vr=new gr("error")).error(Cr)}return new fr(vr,xr,"")},async:function(_r,vr){return this.internalStream(_r).accumulate(vr)},nodeStream:function(_r,vr){return this.internalStream(_r||"nodebuffer").toNodejsStream(vr)},_compressWorker:function(_r,vr){if(this._data instanceof mr&&this._data.compression.magic===_r.magic)return this._data.getCompressedWorker();var xr=this._decompressWorker();return this._dataBinary||(xr=xr.pipe(new pr.Utf8EncodeWorker)),mr.createWorkerFrom(xr,_r,vr)},_decompressWorker:function(){return this._data instanceof mr?this._data.getContentWorker():this._data instanceof gr?this._data:new dr(this._data)}};for(var yr=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],br=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Or=0;Or<yr.length;Or++)hr.prototype[yr[Or]]=br;cr.exports=hr},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(ar,cr,ur){(function(hr){var fr,dr,pr=hr.MutationObserver||hr.WebKitMutationObserver;if(pr){var mr=0,gr=new pr(_r),yr=hr.document.createTextNode("");gr.observe(yr,{characterData:!0}),fr=function(){yr.data=mr=++mr%2}}else if(hr.setImmediate||hr.MessageChannel===void 0)fr="document"in hr&&"onreadystatechange"in hr.document.createElement("script")?function(){var vr=hr.document.createElement("script");vr.onreadystatechange=function(){_r(),vr.onreadystatechange=null,vr.parentNode.removeChild(vr),vr=null},hr.document.documentElement.appendChild(vr)}:function(){setTimeout(_r,0)};else{var br=new hr.MessageChannel;br.port1.onmessage=_r,fr=function(){br.port2.postMessage(0)}}var Or=[];function _r(){var vr,xr;dr=!0;for(var wr=Or.length;wr;){for(xr=Or,Or=[],vr=-1;++vr<wr;)xr[vr]();wr=Or.length}dr=!1}cr.exports=function(vr){Or.push(vr)!==1||dr||fr()}}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(ar,cr,ur){var hr=ar("immediate");function fr(){}var dr={},pr=["REJECTED"],mr=["FULFILLED"],gr=["PENDING"];function yr(wr){if(typeof wr!="function")throw new TypeError("resolver must be a function");this.state=gr,this.queue=[],this.outcome=void 0,wr!==fr&&vr(this,wr)}function br(wr,kr,Cr){this.promise=wr,typeof kr=="function"&&(this.onFulfilled=kr,this.callFulfilled=this.otherCallFulfilled),typeof Cr=="function"&&(this.onRejected=Cr,this.callRejected=this.otherCallRejected)}function Or(wr,kr,Cr){hr(function(){var $r;try{$r=kr(Cr)}catch(Nr){return dr.reject(wr,Nr)}$r===wr?dr.reject(wr,new TypeError("Cannot resolve promise with itself")):dr.resolve(wr,$r)})}function _r(wr){var kr=wr&&wr.then;if(wr&&(typeof wr=="object"||typeof wr=="function")&&typeof kr=="function")return function(){kr.apply(wr,arguments)}}function vr(wr,kr){var Cr=!1;function $r(Fr){Cr||(Cr=!0,dr.reject(wr,Fr))}function Nr(Fr){Cr||(Cr=!0,dr.resolve(wr,Fr))}var Br=xr(function(){kr(Nr,$r)});Br.status==="error"&&$r(Br.value)}function xr(wr,kr){var Cr={};try{Cr.value=wr(kr),Cr.status="success"}catch($r){Cr.status="error",Cr.value=$r}return Cr}(cr.exports=yr).prototype.finally=function(wr){if(typeof wr!="function")return this;var kr=this.constructor;return this.then(function(Cr){return kr.resolve(wr()).then(function(){return Cr})},function(Cr){return kr.resolve(wr()).then(function(){throw Cr})})},yr.prototype.catch=function(wr){return this.then(null,wr)},yr.prototype.then=function(wr,kr){if(typeof wr!="function"&&this.state===mr||typeof kr!="function"&&this.state===pr)return this;var Cr=new this.constructor(fr);return this.state!==gr?Or(Cr,this.state===mr?wr:kr,this.outcome):this.queue.push(new br(Cr,wr,kr)),Cr},br.prototype.callFulfilled=function(wr){dr.resolve(this.promise,wr)},br.prototype.otherCallFulfilled=function(wr){Or(this.promise,this.onFulfilled,wr)},br.prototype.callRejected=function(wr){dr.reject(this.promise,wr)},br.prototype.otherCallRejected=function(wr){Or(this.promise,this.onRejected,wr)},dr.resolve=function(wr,kr){var Cr=xr(_r,kr);if(Cr.status==="error")return dr.reject(wr,Cr.value);var $r=Cr.value;if($r)vr(wr,$r);else{wr.state=mr,wr.outcome=kr;for(var Nr=-1,Br=wr.queue.length;++Nr<Br;)wr.queue[Nr].callFulfilled(kr)}return wr},dr.reject=function(wr,kr){wr.state=pr,wr.outcome=kr;for(var Cr=-1,$r=wr.queue.length;++Cr<$r;)wr.queue[Cr].callRejected(kr);return wr},yr.resolve=function(wr){return wr instanceof this?wr:dr.resolve(new this(fr),wr)},yr.reject=function(wr){var kr=new this(fr);return dr.reject(kr,wr)},yr.all=function(wr){var kr=this;if(Object.prototype.toString.call(wr)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Cr=wr.length,$r=!1;if(!Cr)return this.resolve([]);for(var Nr=new Array(Cr),Br=0,Fr=-1,Vr=new this(fr);++Fr<Cr;)Rr(wr[Fr],Fr);return Vr;function Rr(Gr,qr){kr.resolve(Gr).then(function(Ur){Nr[qr]=Ur,++Br!==Cr||$r||($r=!0,dr.resolve(Vr,Nr))},function(Ur){$r||($r=!0,dr.reject(Vr,Ur))})}},yr.race=function(wr){var kr=this;if(Object.prototype.toString.call(wr)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Cr=wr.length,$r=!1;if(!Cr)return this.resolve([]);for(var Nr=-1,Br=new this(fr);++Nr<Cr;)Fr=wr[Nr],kr.resolve(Fr).then(function(Vr){$r||($r=!0,dr.resolve(Br,Vr))},function(Vr){$r||($r=!0,dr.reject(Br,Vr))});var Fr;return Br}},{immediate:36}],38:[function(ar,cr,ur){var hr={};(0,ar("./lib/utils/common").assign)(hr,ar("./lib/deflate"),ar("./lib/inflate"),ar("./lib/zlib/constants")),cr.exports=hr},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(ar,cr,ur){var hr=ar("./zlib/deflate"),fr=ar("./utils/common"),dr=ar("./utils/strings"),pr=ar("./zlib/messages"),mr=ar("./zlib/zstream"),gr=Object.prototype.toString,yr=0,br=-1,Or=0,_r=8;function vr(wr){if(!(this instanceof vr))return new vr(wr);this.options=fr.assign({level:br,method:_r,chunkSize:16384,windowBits:15,memLevel:8,strategy:Or,to:""},wr||{});var kr=this.options;kr.raw&&0<kr.windowBits?kr.windowBits=-kr.windowBits:kr.gzip&&0<kr.windowBits&&kr.windowBits<16&&(kr.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new mr,this.strm.avail_out=0;var Cr=hr.deflateInit2(this.strm,kr.level,kr.method,kr.windowBits,kr.memLevel,kr.strategy);if(Cr!==yr)throw new Error(pr[Cr]);if(kr.header&&hr.deflateSetHeader(this.strm,kr.header),kr.dictionary){var $r;if($r=typeof kr.dictionary=="string"?dr.string2buf(kr.dictionary):gr.call(kr.dictionary)==="[object ArrayBuffer]"?new Uint8Array(kr.dictionary):kr.dictionary,(Cr=hr.deflateSetDictionary(this.strm,$r))!==yr)throw new Error(pr[Cr]);this._dict_set=!0}}function xr(wr,kr){var Cr=new vr(kr);if(Cr.push(wr,!0),Cr.err)throw Cr.msg||pr[Cr.err];return Cr.result}vr.prototype.push=function(wr,kr){var Cr,$r,Nr=this.strm,Br=this.options.chunkSize;if(this.ended)return!1;$r=kr===~~kr?kr:kr===!0?4:0,typeof wr=="string"?Nr.input=dr.string2buf(wr):gr.call(wr)==="[object ArrayBuffer]"?Nr.input=new Uint8Array(wr):Nr.input=wr,Nr.next_in=0,Nr.avail_in=Nr.input.length;do{if(Nr.avail_out===0&&(Nr.output=new fr.Buf8(Br),Nr.next_out=0,Nr.avail_out=Br),(Cr=hr.deflate(Nr,$r))!==1&&Cr!==yr)return this.onEnd(Cr),!(this.ended=!0);Nr.avail_out!==0&&(Nr.avail_in!==0||$r!==4&&$r!==2)||(this.options.to==="string"?this.onData(dr.buf2binstring(fr.shrinkBuf(Nr.output,Nr.next_out))):this.onData(fr.shrinkBuf(Nr.output,Nr.next_out)))}while((0<Nr.avail_in||Nr.avail_out===0)&&Cr!==1);return $r===4?(Cr=hr.deflateEnd(this.strm),this.onEnd(Cr),this.ended=!0,Cr===yr):$r!==2||(this.onEnd(yr),!(Nr.avail_out=0))},vr.prototype.onData=function(wr){this.chunks.push(wr)},vr.prototype.onEnd=function(wr){wr===yr&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fr.flattenChunks(this.chunks)),this.chunks=[],this.err=wr,this.msg=this.strm.msg},ur.Deflate=vr,ur.deflate=xr,ur.deflateRaw=function(wr,kr){return(kr=kr||{}).raw=!0,xr(wr,kr)},ur.gzip=function(wr,kr){return(kr=kr||{}).gzip=!0,xr(wr,kr)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(ar,cr,ur){var hr=ar("./zlib/inflate"),fr=ar("./utils/common"),dr=ar("./utils/strings"),pr=ar("./zlib/constants"),mr=ar("./zlib/messages"),gr=ar("./zlib/zstream"),yr=ar("./zlib/gzheader"),br=Object.prototype.toString;function Or(vr){if(!(this instanceof Or))return new Or(vr);this.options=fr.assign({chunkSize:16384,windowBits:0,to:""},vr||{});var xr=this.options;xr.raw&&0<=xr.windowBits&&xr.windowBits<16&&(xr.windowBits=-xr.windowBits,xr.windowBits===0&&(xr.windowBits=-15)),!(0<=xr.windowBits&&xr.windowBits<16)||vr&&vr.windowBits||(xr.windowBits+=32),15<xr.windowBits&&xr.windowBits<48&&!(15&xr.windowBits)&&(xr.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gr,this.strm.avail_out=0;var wr=hr.inflateInit2(this.strm,xr.windowBits);if(wr!==pr.Z_OK)throw new Error(mr[wr]);this.header=new yr,hr.inflateGetHeader(this.strm,this.header)}function _r(vr,xr){var wr=new Or(xr);if(wr.push(vr,!0),wr.err)throw wr.msg||mr[wr.err];return wr.result}Or.prototype.push=function(vr,xr){var wr,kr,Cr,$r,Nr,Br,Fr=this.strm,Vr=this.options.chunkSize,Rr=this.options.dictionary,Gr=!1;if(this.ended)return!1;kr=xr===~~xr?xr:xr===!0?pr.Z_FINISH:pr.Z_NO_FLUSH,typeof vr=="string"?Fr.input=dr.binstring2buf(vr):br.call(vr)==="[object ArrayBuffer]"?Fr.input=new Uint8Array(vr):Fr.input=vr,Fr.next_in=0,Fr.avail_in=Fr.input.length;do{if(Fr.avail_out===0&&(Fr.output=new fr.Buf8(Vr),Fr.next_out=0,Fr.avail_out=Vr),(wr=hr.inflate(Fr,pr.Z_NO_FLUSH))===pr.Z_NEED_DICT&&Rr&&(Br=typeof Rr=="string"?dr.string2buf(Rr):br.call(Rr)==="[object ArrayBuffer]"?new Uint8Array(Rr):Rr,wr=hr.inflateSetDictionary(this.strm,Br)),wr===pr.Z_BUF_ERROR&&Gr===!0&&(wr=pr.Z_OK,Gr=!1),wr!==pr.Z_STREAM_END&&wr!==pr.Z_OK)return this.onEnd(wr),!(this.ended=!0);Fr.next_out&&(Fr.avail_out!==0&&wr!==pr.Z_STREAM_END&&(Fr.avail_in!==0||kr!==pr.Z_FINISH&&kr!==pr.Z_SYNC_FLUSH)||(this.options.to==="string"?(Cr=dr.utf8border(Fr.output,Fr.next_out),$r=Fr.next_out-Cr,Nr=dr.buf2string(Fr.output,Cr),Fr.next_out=$r,Fr.avail_out=Vr-$r,$r&&fr.arraySet(Fr.output,Fr.output,Cr,$r,0),this.onData(Nr)):this.onData(fr.shrinkBuf(Fr.output,Fr.next_out)))),Fr.avail_in===0&&Fr.avail_out===0&&(Gr=!0)}while((0<Fr.avail_in||Fr.avail_out===0)&&wr!==pr.Z_STREAM_END);return wr===pr.Z_STREAM_END&&(kr=pr.Z_FINISH),kr===pr.Z_FINISH?(wr=hr.inflateEnd(this.strm),this.onEnd(wr),this.ended=!0,wr===pr.Z_OK):kr!==pr.Z_SYNC_FLUSH||(this.onEnd(pr.Z_OK),!(Fr.avail_out=0))},Or.prototype.onData=function(vr){this.chunks.push(vr)},Or.prototype.onEnd=function(vr){vr===pr.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fr.flattenChunks(this.chunks)),this.chunks=[],this.err=vr,this.msg=this.strm.msg},ur.Inflate=Or,ur.inflate=_r,ur.inflateRaw=function(vr,xr){return(xr=xr||{}).raw=!0,_r(vr,xr)},ur.ungzip=_r},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(ar,cr,ur){var hr=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";ur.assign=function(pr){for(var mr=Array.prototype.slice.call(arguments,1);mr.length;){var gr=mr.shift();if(gr){if(typeof gr!="object")throw new TypeError(gr+"must be non-object");for(var yr in gr)gr.hasOwnProperty(yr)&&(pr[yr]=gr[yr])}}return pr},ur.shrinkBuf=function(pr,mr){return pr.length===mr?pr:pr.subarray?pr.subarray(0,mr):(pr.length=mr,pr)};var fr={arraySet:function(pr,mr,gr,yr,br){if(mr.subarray&&pr.subarray)pr.set(mr.subarray(gr,gr+yr),br);else for(var Or=0;Or<yr;Or++)pr[br+Or]=mr[gr+Or]},flattenChunks:function(pr){var mr,gr,yr,br,Or,_r;for(mr=yr=0,gr=pr.length;mr<gr;mr++)yr+=pr[mr].length;for(_r=new Uint8Array(yr),mr=br=0,gr=pr.length;mr<gr;mr++)Or=pr[mr],_r.set(Or,br),br+=Or.length;return _r}},dr={arraySet:function(pr,mr,gr,yr,br){for(var Or=0;Or<yr;Or++)pr[br+Or]=mr[gr+Or]},flattenChunks:function(pr){return[].concat.apply([],pr)}};ur.setTyped=function(pr){pr?(ur.Buf8=Uint8Array,ur.Buf16=Uint16Array,ur.Buf32=Int32Array,ur.assign(ur,fr)):(ur.Buf8=Array,ur.Buf16=Array,ur.Buf32=Array,ur.assign(ur,dr))},ur.setTyped(hr)},{}],42:[function(ar,cr,ur){var hr=ar("./common"),fr=!0,dr=!0;try{String.fromCharCode.apply(null,[0])}catch{fr=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{dr=!1}for(var pr=new hr.Buf8(256),mr=0;mr<256;mr++)pr[mr]=252<=mr?6:248<=mr?5:240<=mr?4:224<=mr?3:192<=mr?2:1;function gr(yr,br){if(br<65537&&(yr.subarray&&dr||!yr.subarray&&fr))return String.fromCharCode.apply(null,hr.shrinkBuf(yr,br));for(var Or="",_r=0;_r<br;_r++)Or+=String.fromCharCode(yr[_r]);return Or}pr[254]=pr[254]=1,ur.string2buf=function(yr){var br,Or,_r,vr,xr,wr=yr.length,kr=0;for(vr=0;vr<wr;vr++)(64512&(Or=yr.charCodeAt(vr)))==55296&&vr+1<wr&&(64512&(_r=yr.charCodeAt(vr+1)))==56320&&(Or=65536+(Or-55296<<10)+(_r-56320),vr++),kr+=Or<128?1:Or<2048?2:Or<65536?3:4;for(br=new hr.Buf8(kr),vr=xr=0;xr<kr;vr++)(64512&(Or=yr.charCodeAt(vr)))==55296&&vr+1<wr&&(64512&(_r=yr.charCodeAt(vr+1)))==56320&&(Or=65536+(Or-55296<<10)+(_r-56320),vr++),Or<128?br[xr++]=Or:(Or<2048?br[xr++]=192|Or>>>6:(Or<65536?br[xr++]=224|Or>>>12:(br[xr++]=240|Or>>>18,br[xr++]=128|Or>>>12&63),br[xr++]=128|Or>>>6&63),br[xr++]=128|63&Or);return br},ur.buf2binstring=function(yr){return gr(yr,yr.length)},ur.binstring2buf=function(yr){for(var br=new hr.Buf8(yr.length),Or=0,_r=br.length;Or<_r;Or++)br[Or]=yr.charCodeAt(Or);return br},ur.buf2string=function(yr,br){var Or,_r,vr,xr,wr=br||yr.length,kr=new Array(2*wr);for(Or=_r=0;Or<wr;)if((vr=yr[Or++])<128)kr[_r++]=vr;else if(4<(xr=pr[vr]))kr[_r++]=65533,Or+=xr-1;else{for(vr&=xr===2?31:xr===3?15:7;1<xr&&Or<wr;)vr=vr<<6|63&yr[Or++],xr--;1<xr?kr[_r++]=65533:vr<65536?kr[_r++]=vr:(vr-=65536,kr[_r++]=55296|vr>>10&1023,kr[_r++]=56320|1023&vr)}return gr(kr,_r)},ur.utf8border=function(yr,br){var Or;for((br=br||yr.length)>yr.length&&(br=yr.length),Or=br-1;0<=Or&&(192&yr[Or])==128;)Or--;return Or<0||Or===0?br:Or+pr[yr[Or]]>br?Or:br}},{"./common":41}],43:[function(ar,cr,ur){cr.exports=function(hr,fr,dr,pr){for(var mr=65535&hr|0,gr=hr>>>16&65535|0,yr=0;dr!==0;){for(dr-=yr=2e3<dr?2e3:dr;gr=gr+(mr=mr+fr[pr++]|0)|0,--yr;);mr%=65521,gr%=65521}return mr|gr<<16|0}},{}],44:[function(ar,cr,ur){cr.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(ar,cr,ur){var hr=function(){for(var fr,dr=[],pr=0;pr<256;pr++){fr=pr;for(var mr=0;mr<8;mr++)fr=1&fr?3988292384^fr>>>1:fr>>>1;dr[pr]=fr}return dr}();cr.exports=function(fr,dr,pr,mr){var gr=hr,yr=mr+pr;fr^=-1;for(var br=mr;br<yr;br++)fr=fr>>>8^gr[255&(fr^dr[br])];return-1^fr}},{}],46:[function(ar,cr,ur){var hr,fr=ar("../utils/common"),dr=ar("./trees"),pr=ar("./adler32"),mr=ar("./crc32"),gr=ar("./messages"),yr=0,br=4,Or=0,_r=-2,vr=-1,xr=4,wr=2,kr=8,Cr=9,$r=286,Nr=30,Br=19,Fr=2*$r+1,Vr=15,Rr=3,Gr=258,qr=Gr+Rr+1,Ur=42,Yr=113,Dr=1,Jr=2,ai=3,Kr=4;function ui(Lr,oi){return Lr.msg=gr[oi],oi}function ii(Lr){return(Lr<<1)-(4<Lr?9:0)}function di(Lr){for(var oi=Lr.length;0<=--oi;)Lr[oi]=0}function ei(Lr){var oi=Lr.state,Tr=oi.pending;Tr>Lr.avail_out&&(Tr=Lr.avail_out),Tr!==0&&(fr.arraySet(Lr.output,oi.pending_buf,oi.pending_out,Tr,Lr.next_out),Lr.next_out+=Tr,oi.pending_out+=Tr,Lr.total_out+=Tr,Lr.avail_out-=Tr,oi.pending-=Tr,oi.pending===0&&(oi.pending_out=0))}function Wr(Lr,oi){dr._tr_flush_block(Lr,0<=Lr.block_start?Lr.block_start:-1,Lr.strstart-Lr.block_start,oi),Lr.block_start=Lr.strstart,ei(Lr.strm)}function ti(Lr,oi){Lr.pending_buf[Lr.pending++]=oi}function si(Lr,oi){Lr.pending_buf[Lr.pending++]=oi>>>8&255,Lr.pending_buf[Lr.pending++]=255&oi}function ci(Lr,oi){var Tr,Sr,Er=Lr.max_chain_length,Ir=Lr.strstart,Qr=Lr.prev_length,zr=Lr.nice_match,Hr=Lr.strstart>Lr.w_size-qr?Lr.strstart-(Lr.w_size-qr):0,li=Lr.window,pi=Lr.w_mask,hi=Lr.prev,fi=Lr.strstart+Gr,mi=li[Ir+Qr-1],gi=li[Ir+Qr];Lr.prev_length>=Lr.good_match&&(Er>>=2),zr>Lr.lookahead&&(zr=Lr.lookahead);do if(li[(Tr=oi)+Qr]===gi&&li[Tr+Qr-1]===mi&&li[Tr]===li[Ir]&&li[++Tr]===li[Ir+1]){Ir+=2,Tr++;do;while(li[++Ir]===li[++Tr]&&li[++Ir]===li[++Tr]&&li[++Ir]===li[++Tr]&&li[++Ir]===li[++Tr]&&li[++Ir]===li[++Tr]&&li[++Ir]===li[++Tr]&&li[++Ir]===li[++Tr]&&li[++Ir]===li[++Tr]&&Ir<fi);if(Sr=Gr-(fi-Ir),Ir=fi-Gr,Qr<Sr){if(Lr.match_start=oi,zr<=(Qr=Sr))break;mi=li[Ir+Qr-1],gi=li[Ir+Qr]}}while((oi=hi[oi&pi])>Hr&&--Er!=0);return Qr<=Lr.lookahead?Qr:Lr.lookahead}function ni(Lr){var oi,Tr,Sr,Er,Ir,Qr,zr,Hr,li,pi,hi=Lr.w_size;do{if(Er=Lr.window_size-Lr.lookahead-Lr.strstart,Lr.strstart>=hi+(hi-qr)){for(fr.arraySet(Lr.window,Lr.window,hi,hi,0),Lr.match_start-=hi,Lr.strstart-=hi,Lr.block_start-=hi,oi=Tr=Lr.hash_size;Sr=Lr.head[--oi],Lr.head[oi]=hi<=Sr?Sr-hi:0,--Tr;);for(oi=Tr=hi;Sr=Lr.prev[--oi],Lr.prev[oi]=hi<=Sr?Sr-hi:0,--Tr;);Er+=hi}if(Lr.strm.avail_in===0)break;if(Qr=Lr.strm,zr=Lr.window,Hr=Lr.strstart+Lr.lookahead,li=Er,pi=void 0,pi=Qr.avail_in,li<pi&&(pi=li),Tr=pi===0?0:(Qr.avail_in-=pi,fr.arraySet(zr,Qr.input,Qr.next_in,pi,Hr),Qr.state.wrap===1?Qr.adler=pr(Qr.adler,zr,pi,Hr):Qr.state.wrap===2&&(Qr.adler=mr(Qr.adler,zr,pi,Hr)),Qr.next_in+=pi,Qr.total_in+=pi,pi),Lr.lookahead+=Tr,Lr.lookahead+Lr.insert>=Rr)for(Ir=Lr.strstart-Lr.insert,Lr.ins_h=Lr.window[Ir],Lr.ins_h=(Lr.ins_h<<Lr.hash_shift^Lr.window[Ir+1])&Lr.hash_mask;Lr.insert&&(Lr.ins_h=(Lr.ins_h<<Lr.hash_shift^Lr.window[Ir+Rr-1])&Lr.hash_mask,Lr.prev[Ir&Lr.w_mask]=Lr.head[Lr.ins_h],Lr.head[Lr.ins_h]=Ir,Ir++,Lr.insert--,!(Lr.lookahead+Lr.insert<Rr)););}while(Lr.lookahead<qr&&Lr.strm.avail_in!==0)}function Pr(Lr,oi){for(var Tr,Sr;;){if(Lr.lookahead<qr){if(ni(Lr),Lr.lookahead<qr&&oi===yr)return Dr;if(Lr.lookahead===0)break}if(Tr=0,Lr.lookahead>=Rr&&(Lr.ins_h=(Lr.ins_h<<Lr.hash_shift^Lr.window[Lr.strstart+Rr-1])&Lr.hash_mask,Tr=Lr.prev[Lr.strstart&Lr.w_mask]=Lr.head[Lr.ins_h],Lr.head[Lr.ins_h]=Lr.strstart),Tr!==0&&Lr.strstart-Tr<=Lr.w_size-qr&&(Lr.match_length=ci(Lr,Tr)),Lr.match_length>=Rr)if(Sr=dr._tr_tally(Lr,Lr.strstart-Lr.match_start,Lr.match_length-Rr),Lr.lookahead-=Lr.match_length,Lr.match_length<=Lr.max_lazy_match&&Lr.lookahead>=Rr){for(Lr.match_length--;Lr.strstart++,Lr.ins_h=(Lr.ins_h<<Lr.hash_shift^Lr.window[Lr.strstart+Rr-1])&Lr.hash_mask,Tr=Lr.prev[Lr.strstart&Lr.w_mask]=Lr.head[Lr.ins_h],Lr.head[Lr.ins_h]=Lr.strstart,--Lr.match_length!=0;);Lr.strstart++}else Lr.strstart+=Lr.match_length,Lr.match_length=0,Lr.ins_h=Lr.window[Lr.strstart],Lr.ins_h=(Lr.ins_h<<Lr.hash_shift^Lr.window[Lr.strstart+1])&Lr.hash_mask;else Sr=dr._tr_tally(Lr,0,Lr.window[Lr.strstart]),Lr.lookahead--,Lr.strstart++;if(Sr&&(Wr(Lr,!1),Lr.strm.avail_out===0))return Dr}return Lr.insert=Lr.strstart<Rr-1?Lr.strstart:Rr-1,oi===br?(Wr(Lr,!0),Lr.strm.avail_out===0?ai:Kr):Lr.last_lit&&(Wr(Lr,!1),Lr.strm.avail_out===0)?Dr:Jr}function Ar(Lr,oi){for(var Tr,Sr,Er;;){if(Lr.lookahead<qr){if(ni(Lr),Lr.lookahead<qr&&oi===yr)return Dr;if(Lr.lookahead===0)break}if(Tr=0,Lr.lookahead>=Rr&&(Lr.ins_h=(Lr.ins_h<<Lr.hash_shift^Lr.window[Lr.strstart+Rr-1])&Lr.hash_mask,Tr=Lr.prev[Lr.strstart&Lr.w_mask]=Lr.head[Lr.ins_h],Lr.head[Lr.ins_h]=Lr.strstart),Lr.prev_length=Lr.match_length,Lr.prev_match=Lr.match_start,Lr.match_length=Rr-1,Tr!==0&&Lr.prev_length<Lr.max_lazy_match&&Lr.strstart-Tr<=Lr.w_size-qr&&(Lr.match_length=ci(Lr,Tr),Lr.match_length<=5&&(Lr.strategy===1||Lr.match_length===Rr&&4096<Lr.strstart-Lr.match_start)&&(Lr.match_length=Rr-1)),Lr.prev_length>=Rr&&Lr.match_length<=Lr.prev_length){for(Er=Lr.strstart+Lr.lookahead-Rr,Sr=dr._tr_tally(Lr,Lr.strstart-1-Lr.prev_match,Lr.prev_length-Rr),Lr.lookahead-=Lr.prev_length-1,Lr.prev_length-=2;++Lr.strstart<=Er&&(Lr.ins_h=(Lr.ins_h<<Lr.hash_shift^Lr.window[Lr.strstart+Rr-1])&Lr.hash_mask,Tr=Lr.prev[Lr.strstart&Lr.w_mask]=Lr.head[Lr.ins_h],Lr.head[Lr.ins_h]=Lr.strstart),--Lr.prev_length!=0;);if(Lr.match_available=0,Lr.match_length=Rr-1,Lr.strstart++,Sr&&(Wr(Lr,!1),Lr.strm.avail_out===0))return Dr}else if(Lr.match_available){if((Sr=dr._tr_tally(Lr,0,Lr.window[Lr.strstart-1]))&&Wr(Lr,!1),Lr.strstart++,Lr.lookahead--,Lr.strm.avail_out===0)return Dr}else Lr.match_available=1,Lr.strstart++,Lr.lookahead--}return Lr.match_available&&(Sr=dr._tr_tally(Lr,0,Lr.window[Lr.strstart-1]),Lr.match_available=0),Lr.insert=Lr.strstart<Rr-1?Lr.strstart:Rr-1,oi===br?(Wr(Lr,!0),Lr.strm.avail_out===0?ai:Kr):Lr.last_lit&&(Wr(Lr,!1),Lr.strm.avail_out===0)?Dr:Jr}function Zr(Lr,oi,Tr,Sr,Er){this.good_length=Lr,this.max_lazy=oi,this.nice_length=Tr,this.max_chain=Sr,this.func=Er}function Mr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=kr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new fr.Buf16(2*Fr),this.dyn_dtree=new fr.Buf16(2*(2*Nr+1)),this.bl_tree=new fr.Buf16(2*(2*Br+1)),di(this.dyn_ltree),di(this.dyn_dtree),di(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new fr.Buf16(Vr+1),this.heap=new fr.Buf16(2*$r+1),di(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new fr.Buf16(2*$r+1),di(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function jr(Lr){var oi;return Lr&&Lr.state?(Lr.total_in=Lr.total_out=0,Lr.data_type=wr,(oi=Lr.state).pending=0,oi.pending_out=0,oi.wrap<0&&(oi.wrap=-oi.wrap),oi.status=oi.wrap?Ur:Yr,Lr.adler=oi.wrap===2?0:1,oi.last_flush=yr,dr._tr_init(oi),Or):ui(Lr,_r)}function Xr(Lr){var oi=jr(Lr);return oi===Or&&function(Tr){Tr.window_size=2*Tr.w_size,di(Tr.head),Tr.max_lazy_match=hr[Tr.level].max_lazy,Tr.good_match=hr[Tr.level].good_length,Tr.nice_match=hr[Tr.level].nice_length,Tr.max_chain_length=hr[Tr.level].max_chain,Tr.strstart=0,Tr.block_start=0,Tr.lookahead=0,Tr.insert=0,Tr.match_length=Tr.prev_length=Rr-1,Tr.match_available=0,Tr.ins_h=0}(Lr.state),oi}function ri(Lr,oi,Tr,Sr,Er,Ir){if(!Lr)return _r;var Qr=1;if(oi===vr&&(oi=6),Sr<0?(Qr=0,Sr=-Sr):15<Sr&&(Qr=2,Sr-=16),Er<1||Cr<Er||Tr!==kr||Sr<8||15<Sr||oi<0||9<oi||Ir<0||xr<Ir)return ui(Lr,_r);Sr===8&&(Sr=9);var zr=new Mr;return(Lr.state=zr).strm=Lr,zr.wrap=Qr,zr.gzhead=null,zr.w_bits=Sr,zr.w_size=1<<zr.w_bits,zr.w_mask=zr.w_size-1,zr.hash_bits=Er+7,zr.hash_size=1<<zr.hash_bits,zr.hash_mask=zr.hash_size-1,zr.hash_shift=~~((zr.hash_bits+Rr-1)/Rr),zr.window=new fr.Buf8(2*zr.w_size),zr.head=new fr.Buf16(zr.hash_size),zr.prev=new fr.Buf16(zr.w_size),zr.lit_bufsize=1<<Er+6,zr.pending_buf_size=4*zr.lit_bufsize,zr.pending_buf=new fr.Buf8(zr.pending_buf_size),zr.d_buf=1*zr.lit_bufsize,zr.l_buf=3*zr.lit_bufsize,zr.level=oi,zr.strategy=Ir,zr.method=Tr,Xr(Lr)}hr=[new Zr(0,0,0,0,function(Lr,oi){var Tr=65535;for(Tr>Lr.pending_buf_size-5&&(Tr=Lr.pending_buf_size-5);;){if(Lr.lookahead<=1){if(ni(Lr),Lr.lookahead===0&&oi===yr)return Dr;if(Lr.lookahead===0)break}Lr.strstart+=Lr.lookahead,Lr.lookahead=0;var Sr=Lr.block_start+Tr;if((Lr.strstart===0||Lr.strstart>=Sr)&&(Lr.lookahead=Lr.strstart-Sr,Lr.strstart=Sr,Wr(Lr,!1),Lr.strm.avail_out===0)||Lr.strstart-Lr.block_start>=Lr.w_size-qr&&(Wr(Lr,!1),Lr.strm.avail_out===0))return Dr}return Lr.insert=0,oi===br?(Wr(Lr,!0),Lr.strm.avail_out===0?ai:Kr):(Lr.strstart>Lr.block_start&&(Wr(Lr,!1),Lr.strm.avail_out),Dr)}),new Zr(4,4,8,4,Pr),new Zr(4,5,16,8,Pr),new Zr(4,6,32,32,Pr),new Zr(4,4,16,16,Ar),new Zr(8,16,32,32,Ar),new Zr(8,16,128,128,Ar),new Zr(8,32,128,256,Ar),new Zr(32,128,258,1024,Ar),new Zr(32,258,258,4096,Ar)],ur.deflateInit=function(Lr,oi){return ri(Lr,oi,kr,15,8,0)},ur.deflateInit2=ri,ur.deflateReset=Xr,ur.deflateResetKeep=jr,ur.deflateSetHeader=function(Lr,oi){return Lr&&Lr.state?Lr.state.wrap!==2?_r:(Lr.state.gzhead=oi,Or):_r},ur.deflate=function(Lr,oi){var Tr,Sr,Er,Ir;if(!Lr||!Lr.state||5<oi||oi<0)return Lr?ui(Lr,_r):_r;if(Sr=Lr.state,!Lr.output||!Lr.input&&Lr.avail_in!==0||Sr.status===666&&oi!==br)return ui(Lr,Lr.avail_out===0?-5:_r);if(Sr.strm=Lr,Tr=Sr.last_flush,Sr.last_flush=oi,Sr.status===Ur)if(Sr.wrap===2)Lr.adler=0,ti(Sr,31),ti(Sr,139),ti(Sr,8),Sr.gzhead?(ti(Sr,(Sr.gzhead.text?1:0)+(Sr.gzhead.hcrc?2:0)+(Sr.gzhead.extra?4:0)+(Sr.gzhead.name?8:0)+(Sr.gzhead.comment?16:0)),ti(Sr,255&Sr.gzhead.time),ti(Sr,Sr.gzhead.time>>8&255),ti(Sr,Sr.gzhead.time>>16&255),ti(Sr,Sr.gzhead.time>>24&255),ti(Sr,Sr.level===9?2:2<=Sr.strategy||Sr.level<2?4:0),ti(Sr,255&Sr.gzhead.os),Sr.gzhead.extra&&Sr.gzhead.extra.length&&(ti(Sr,255&Sr.gzhead.extra.length),ti(Sr,Sr.gzhead.extra.length>>8&255)),Sr.gzhead.hcrc&&(Lr.adler=mr(Lr.adler,Sr.pending_buf,Sr.pending,0)),Sr.gzindex=0,Sr.status=69):(ti(Sr,0),ti(Sr,0),ti(Sr,0),ti(Sr,0),ti(Sr,0),ti(Sr,Sr.level===9?2:2<=Sr.strategy||Sr.level<2?4:0),ti(Sr,3),Sr.status=Yr);else{var Qr=kr+(Sr.w_bits-8<<4)<<8;Qr|=(2<=Sr.strategy||Sr.level<2?0:Sr.level<6?1:Sr.level===6?2:3)<<6,Sr.strstart!==0&&(Qr|=32),Qr+=31-Qr%31,Sr.status=Yr,si(Sr,Qr),Sr.strstart!==0&&(si(Sr,Lr.adler>>>16),si(Sr,65535&Lr.adler)),Lr.adler=1}if(Sr.status===69)if(Sr.gzhead.extra){for(Er=Sr.pending;Sr.gzindex<(65535&Sr.gzhead.extra.length)&&(Sr.pending!==Sr.pending_buf_size||(Sr.gzhead.hcrc&&Sr.pending>Er&&(Lr.adler=mr(Lr.adler,Sr.pending_buf,Sr.pending-Er,Er)),ei(Lr),Er=Sr.pending,Sr.pending!==Sr.pending_buf_size));)ti(Sr,255&Sr.gzhead.extra[Sr.gzindex]),Sr.gzindex++;Sr.gzhead.hcrc&&Sr.pending>Er&&(Lr.adler=mr(Lr.adler,Sr.pending_buf,Sr.pending-Er,Er)),Sr.gzindex===Sr.gzhead.extra.length&&(Sr.gzindex=0,Sr.status=73)}else Sr.status=73;if(Sr.status===73)if(Sr.gzhead.name){Er=Sr.pending;do{if(Sr.pending===Sr.pending_buf_size&&(Sr.gzhead.hcrc&&Sr.pending>Er&&(Lr.adler=mr(Lr.adler,Sr.pending_buf,Sr.pending-Er,Er)),ei(Lr),Er=Sr.pending,Sr.pending===Sr.pending_buf_size)){Ir=1;break}Ir=Sr.gzindex<Sr.gzhead.name.length?255&Sr.gzhead.name.charCodeAt(Sr.gzindex++):0,ti(Sr,Ir)}while(Ir!==0);Sr.gzhead.hcrc&&Sr.pending>Er&&(Lr.adler=mr(Lr.adler,Sr.pending_buf,Sr.pending-Er,Er)),Ir===0&&(Sr.gzindex=0,Sr.status=91)}else Sr.status=91;if(Sr.status===91)if(Sr.gzhead.comment){Er=Sr.pending;do{if(Sr.pending===Sr.pending_buf_size&&(Sr.gzhead.hcrc&&Sr.pending>Er&&(Lr.adler=mr(Lr.adler,Sr.pending_buf,Sr.pending-Er,Er)),ei(Lr),Er=Sr.pending,Sr.pending===Sr.pending_buf_size)){Ir=1;break}Ir=Sr.gzindex<Sr.gzhead.comment.length?255&Sr.gzhead.comment.charCodeAt(Sr.gzindex++):0,ti(Sr,Ir)}while(Ir!==0);Sr.gzhead.hcrc&&Sr.pending>Er&&(Lr.adler=mr(Lr.adler,Sr.pending_buf,Sr.pending-Er,Er)),Ir===0&&(Sr.status=103)}else Sr.status=103;if(Sr.status===103&&(Sr.gzhead.hcrc?(Sr.pending+2>Sr.pending_buf_size&&ei(Lr),Sr.pending+2<=Sr.pending_buf_size&&(ti(Sr,255&Lr.adler),ti(Sr,Lr.adler>>8&255),Lr.adler=0,Sr.status=Yr)):Sr.status=Yr),Sr.pending!==0){if(ei(Lr),Lr.avail_out===0)return Sr.last_flush=-1,Or}else if(Lr.avail_in===0&&ii(oi)<=ii(Tr)&&oi!==br)return ui(Lr,-5);if(Sr.status===666&&Lr.avail_in!==0)return ui(Lr,-5);if(Lr.avail_in!==0||Sr.lookahead!==0||oi!==yr&&Sr.status!==666){var zr=Sr.strategy===2?function(Hr,li){for(var pi;;){if(Hr.lookahead===0&&(ni(Hr),Hr.lookahead===0)){if(li===yr)return Dr;break}if(Hr.match_length=0,pi=dr._tr_tally(Hr,0,Hr.window[Hr.strstart]),Hr.lookahead--,Hr.strstart++,pi&&(Wr(Hr,!1),Hr.strm.avail_out===0))return Dr}return Hr.insert=0,li===br?(Wr(Hr,!0),Hr.strm.avail_out===0?ai:Kr):Hr.last_lit&&(Wr(Hr,!1),Hr.strm.avail_out===0)?Dr:Jr}(Sr,oi):Sr.strategy===3?function(Hr,li){for(var pi,hi,fi,mi,gi=Hr.window;;){if(Hr.lookahead<=Gr){if(ni(Hr),Hr.lookahead<=Gr&&li===yr)return Dr;if(Hr.lookahead===0)break}if(Hr.match_length=0,Hr.lookahead>=Rr&&0<Hr.strstart&&(hi=gi[fi=Hr.strstart-1])===gi[++fi]&&hi===gi[++fi]&&hi===gi[++fi]){mi=Hr.strstart+Gr;do;while(hi===gi[++fi]&&hi===gi[++fi]&&hi===gi[++fi]&&hi===gi[++fi]&&hi===gi[++fi]&&hi===gi[++fi]&&hi===gi[++fi]&&hi===gi[++fi]&&fi<mi);Hr.match_length=Gr-(mi-fi),Hr.match_length>Hr.lookahead&&(Hr.match_length=Hr.lookahead)}if(Hr.match_length>=Rr?(pi=dr._tr_tally(Hr,1,Hr.match_length-Rr),Hr.lookahead-=Hr.match_length,Hr.strstart+=Hr.match_length,Hr.match_length=0):(pi=dr._tr_tally(Hr,0,Hr.window[Hr.strstart]),Hr.lookahead--,Hr.strstart++),pi&&(Wr(Hr,!1),Hr.strm.avail_out===0))return Dr}return Hr.insert=0,li===br?(Wr(Hr,!0),Hr.strm.avail_out===0?ai:Kr):Hr.last_lit&&(Wr(Hr,!1),Hr.strm.avail_out===0)?Dr:Jr}(Sr,oi):hr[Sr.level].func(Sr,oi);if(zr!==ai&&zr!==Kr||(Sr.status=666),zr===Dr||zr===ai)return Lr.avail_out===0&&(Sr.last_flush=-1),Or;if(zr===Jr&&(oi===1?dr._tr_align(Sr):oi!==5&&(dr._tr_stored_block(Sr,0,0,!1),oi===3&&(di(Sr.head),Sr.lookahead===0&&(Sr.strstart=0,Sr.block_start=0,Sr.insert=0))),ei(Lr),Lr.avail_out===0))return Sr.last_flush=-1,Or}return oi!==br?Or:Sr.wrap<=0?1:(Sr.wrap===2?(ti(Sr,255&Lr.adler),ti(Sr,Lr.adler>>8&255),ti(Sr,Lr.adler>>16&255),ti(Sr,Lr.adler>>24&255),ti(Sr,255&Lr.total_in),ti(Sr,Lr.total_in>>8&255),ti(Sr,Lr.total_in>>16&255),ti(Sr,Lr.total_in>>24&255)):(si(Sr,Lr.adler>>>16),si(Sr,65535&Lr.adler)),ei(Lr),0<Sr.wrap&&(Sr.wrap=-Sr.wrap),Sr.pending!==0?Or:1)},ur.deflateEnd=function(Lr){var oi;return Lr&&Lr.state?(oi=Lr.state.status)!==Ur&&oi!==69&&oi!==73&&oi!==91&&oi!==103&&oi!==Yr&&oi!==666?ui(Lr,_r):(Lr.state=null,oi===Yr?ui(Lr,-3):Or):_r},ur.deflateSetDictionary=function(Lr,oi){var Tr,Sr,Er,Ir,Qr,zr,Hr,li,pi=oi.length;if(!Lr||!Lr.state||(Ir=(Tr=Lr.state).wrap)===2||Ir===1&&Tr.status!==Ur||Tr.lookahead)return _r;for(Ir===1&&(Lr.adler=pr(Lr.adler,oi,pi,0)),Tr.wrap=0,pi>=Tr.w_size&&(Ir===0&&(di(Tr.head),Tr.strstart=0,Tr.block_start=0,Tr.insert=0),li=new fr.Buf8(Tr.w_size),fr.arraySet(li,oi,pi-Tr.w_size,Tr.w_size,0),oi=li,pi=Tr.w_size),Qr=Lr.avail_in,zr=Lr.next_in,Hr=Lr.input,Lr.avail_in=pi,Lr.next_in=0,Lr.input=oi,ni(Tr);Tr.lookahead>=Rr;){for(Sr=Tr.strstart,Er=Tr.lookahead-(Rr-1);Tr.ins_h=(Tr.ins_h<<Tr.hash_shift^Tr.window[Sr+Rr-1])&Tr.hash_mask,Tr.prev[Sr&Tr.w_mask]=Tr.head[Tr.ins_h],Tr.head[Tr.ins_h]=Sr,Sr++,--Er;);Tr.strstart=Sr,Tr.lookahead=Rr-1,ni(Tr)}return Tr.strstart+=Tr.lookahead,Tr.block_start=Tr.strstart,Tr.insert=Tr.lookahead,Tr.lookahead=0,Tr.match_length=Tr.prev_length=Rr-1,Tr.match_available=0,Lr.next_in=zr,Lr.input=Hr,Lr.avail_in=Qr,Tr.wrap=Ir,Or},ur.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(ar,cr,ur){cr.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(ar,cr,ur){cr.exports=function(hr,fr){var dr,pr,mr,gr,yr,br,Or,_r,vr,xr,wr,kr,Cr,$r,Nr,Br,Fr,Vr,Rr,Gr,qr,Ur,Yr,Dr,Jr;dr=hr.state,pr=hr.next_in,Dr=hr.input,mr=pr+(hr.avail_in-5),gr=hr.next_out,Jr=hr.output,yr=gr-(fr-hr.avail_out),br=gr+(hr.avail_out-257),Or=dr.dmax,_r=dr.wsize,vr=dr.whave,xr=dr.wnext,wr=dr.window,kr=dr.hold,Cr=dr.bits,$r=dr.lencode,Nr=dr.distcode,Br=(1<<dr.lenbits)-1,Fr=(1<<dr.distbits)-1;e:do{Cr<15&&(kr+=Dr[pr++]<<Cr,Cr+=8,kr+=Dr[pr++]<<Cr,Cr+=8),Vr=$r[kr&Br];t:for(;;){if(kr>>>=Rr=Vr>>>24,Cr-=Rr,(Rr=Vr>>>16&255)===0)Jr[gr++]=65535&Vr;else{if(!(16&Rr)){if(!(64&Rr)){Vr=$r[(65535&Vr)+(kr&(1<<Rr)-1)];continue t}if(32&Rr){dr.mode=12;break e}hr.msg="invalid literal/length code",dr.mode=30;break e}Gr=65535&Vr,(Rr&=15)&&(Cr<Rr&&(kr+=Dr[pr++]<<Cr,Cr+=8),Gr+=kr&(1<<Rr)-1,kr>>>=Rr,Cr-=Rr),Cr<15&&(kr+=Dr[pr++]<<Cr,Cr+=8,kr+=Dr[pr++]<<Cr,Cr+=8),Vr=Nr[kr&Fr];n:for(;;){if(kr>>>=Rr=Vr>>>24,Cr-=Rr,!(16&(Rr=Vr>>>16&255))){if(!(64&Rr)){Vr=Nr[(65535&Vr)+(kr&(1<<Rr)-1)];continue n}hr.msg="invalid distance code",dr.mode=30;break e}if(qr=65535&Vr,Cr<(Rr&=15)&&(kr+=Dr[pr++]<<Cr,(Cr+=8)<Rr&&(kr+=Dr[pr++]<<Cr,Cr+=8)),Or<(qr+=kr&(1<<Rr)-1)){hr.msg="invalid distance too far back",dr.mode=30;break e}if(kr>>>=Rr,Cr-=Rr,(Rr=gr-yr)<qr){if(vr<(Rr=qr-Rr)&&dr.sane){hr.msg="invalid distance too far back",dr.mode=30;break e}if(Yr=wr,(Ur=0)===xr){if(Ur+=_r-Rr,Rr<Gr){for(Gr-=Rr;Jr[gr++]=wr[Ur++],--Rr;);Ur=gr-qr,Yr=Jr}}else if(xr<Rr){if(Ur+=_r+xr-Rr,(Rr-=xr)<Gr){for(Gr-=Rr;Jr[gr++]=wr[Ur++],--Rr;);if(Ur=0,xr<Gr){for(Gr-=Rr=xr;Jr[gr++]=wr[Ur++],--Rr;);Ur=gr-qr,Yr=Jr}}}else if(Ur+=xr-Rr,Rr<Gr){for(Gr-=Rr;Jr[gr++]=wr[Ur++],--Rr;);Ur=gr-qr,Yr=Jr}for(;2<Gr;)Jr[gr++]=Yr[Ur++],Jr[gr++]=Yr[Ur++],Jr[gr++]=Yr[Ur++],Gr-=3;Gr&&(Jr[gr++]=Yr[Ur++],1<Gr&&(Jr[gr++]=Yr[Ur++]))}else{for(Ur=gr-qr;Jr[gr++]=Jr[Ur++],Jr[gr++]=Jr[Ur++],Jr[gr++]=Jr[Ur++],2<(Gr-=3););Gr&&(Jr[gr++]=Jr[Ur++],1<Gr&&(Jr[gr++]=Jr[Ur++]))}break}}break}}while(pr<mr&&gr<br);pr-=Gr=Cr>>3,kr&=(1<<(Cr-=Gr<<3))-1,hr.next_in=pr,hr.next_out=gr,hr.avail_in=pr<mr?mr-pr+5:5-(pr-mr),hr.avail_out=gr<br?br-gr+257:257-(gr-br),dr.hold=kr,dr.bits=Cr}},{}],49:[function(ar,cr,ur){var hr=ar("../utils/common"),fr=ar("./adler32"),dr=ar("./crc32"),pr=ar("./inffast"),mr=ar("./inftrees"),gr=1,yr=2,br=0,Or=-2,_r=1,vr=852,xr=592;function wr(Ur){return(Ur>>>24&255)+(Ur>>>8&65280)+((65280&Ur)<<8)+((255&Ur)<<24)}function kr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new hr.Buf16(320),this.work=new hr.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Cr(Ur){var Yr;return Ur&&Ur.state?(Yr=Ur.state,Ur.total_in=Ur.total_out=Yr.total=0,Ur.msg="",Yr.wrap&&(Ur.adler=1&Yr.wrap),Yr.mode=_r,Yr.last=0,Yr.havedict=0,Yr.dmax=32768,Yr.head=null,Yr.hold=0,Yr.bits=0,Yr.lencode=Yr.lendyn=new hr.Buf32(vr),Yr.distcode=Yr.distdyn=new hr.Buf32(xr),Yr.sane=1,Yr.back=-1,br):Or}function $r(Ur){var Yr;return Ur&&Ur.state?((Yr=Ur.state).wsize=0,Yr.whave=0,Yr.wnext=0,Cr(Ur)):Or}function Nr(Ur,Yr){var Dr,Jr;return Ur&&Ur.state?(Jr=Ur.state,Yr<0?(Dr=0,Yr=-Yr):(Dr=1+(Yr>>4),Yr<48&&(Yr&=15)),Yr&&(Yr<8||15<Yr)?Or:(Jr.window!==null&&Jr.wbits!==Yr&&(Jr.window=null),Jr.wrap=Dr,Jr.wbits=Yr,$r(Ur))):Or}function Br(Ur,Yr){var Dr,Jr;return Ur?(Jr=new kr,(Ur.state=Jr).window=null,(Dr=Nr(Ur,Yr))!==br&&(Ur.state=null),Dr):Or}var Fr,Vr,Rr=!0;function Gr(Ur){if(Rr){var Yr;for(Fr=new hr.Buf32(512),Vr=new hr.Buf32(32),Yr=0;Yr<144;)Ur.lens[Yr++]=8;for(;Yr<256;)Ur.lens[Yr++]=9;for(;Yr<280;)Ur.lens[Yr++]=7;for(;Yr<288;)Ur.lens[Yr++]=8;for(mr(gr,Ur.lens,0,288,Fr,0,Ur.work,{bits:9}),Yr=0;Yr<32;)Ur.lens[Yr++]=5;mr(yr,Ur.lens,0,32,Vr,0,Ur.work,{bits:5}),Rr=!1}Ur.lencode=Fr,Ur.lenbits=9,Ur.distcode=Vr,Ur.distbits=5}function qr(Ur,Yr,Dr,Jr){var ai,Kr=Ur.state;return Kr.window===null&&(Kr.wsize=1<<Kr.wbits,Kr.wnext=0,Kr.whave=0,Kr.window=new hr.Buf8(Kr.wsize)),Jr>=Kr.wsize?(hr.arraySet(Kr.window,Yr,Dr-Kr.wsize,Kr.wsize,0),Kr.wnext=0,Kr.whave=Kr.wsize):(Jr<(ai=Kr.wsize-Kr.wnext)&&(ai=Jr),hr.arraySet(Kr.window,Yr,Dr-Jr,ai,Kr.wnext),(Jr-=ai)?(hr.arraySet(Kr.window,Yr,Dr-Jr,Jr,0),Kr.wnext=Jr,Kr.whave=Kr.wsize):(Kr.wnext+=ai,Kr.wnext===Kr.wsize&&(Kr.wnext=0),Kr.whave<Kr.wsize&&(Kr.whave+=ai))),0}ur.inflateReset=$r,ur.inflateReset2=Nr,ur.inflateResetKeep=Cr,ur.inflateInit=function(Ur){return Br(Ur,15)},ur.inflateInit2=Br,ur.inflate=function(Ur,Yr){var Dr,Jr,ai,Kr,ui,ii,di,ei,Wr,ti,si,ci,ni,Pr,Ar,Zr,Mr,jr,Xr,ri,Lr,oi,Tr,Sr,Er=0,Ir=new hr.Buf8(4),Qr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Ur||!Ur.state||!Ur.output||!Ur.input&&Ur.avail_in!==0)return Or;(Dr=Ur.state).mode===12&&(Dr.mode=13),ui=Ur.next_out,ai=Ur.output,di=Ur.avail_out,Kr=Ur.next_in,Jr=Ur.input,ii=Ur.avail_in,ei=Dr.hold,Wr=Dr.bits,ti=ii,si=di,oi=br;e:for(;;)switch(Dr.mode){case _r:if(Dr.wrap===0){Dr.mode=13;break}for(;Wr<16;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(2&Dr.wrap&&ei===35615){Ir[Dr.check=0]=255&ei,Ir[1]=ei>>>8&255,Dr.check=dr(Dr.check,Ir,2,0),Wr=ei=0,Dr.mode=2;break}if(Dr.flags=0,Dr.head&&(Dr.head.done=!1),!(1&Dr.wrap)||(((255&ei)<<8)+(ei>>8))%31){Ur.msg="incorrect header check",Dr.mode=30;break}if((15&ei)!=8){Ur.msg="unknown compression method",Dr.mode=30;break}if(Wr-=4,Lr=8+(15&(ei>>>=4)),Dr.wbits===0)Dr.wbits=Lr;else if(Lr>Dr.wbits){Ur.msg="invalid window size",Dr.mode=30;break}Dr.dmax=1<<Lr,Ur.adler=Dr.check=1,Dr.mode=512&ei?10:12,Wr=ei=0;break;case 2:for(;Wr<16;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(Dr.flags=ei,(255&Dr.flags)!=8){Ur.msg="unknown compression method",Dr.mode=30;break}if(57344&Dr.flags){Ur.msg="unknown header flags set",Dr.mode=30;break}Dr.head&&(Dr.head.text=ei>>8&1),512&Dr.flags&&(Ir[0]=255&ei,Ir[1]=ei>>>8&255,Dr.check=dr(Dr.check,Ir,2,0)),Wr=ei=0,Dr.mode=3;case 3:for(;Wr<32;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Dr.head&&(Dr.head.time=ei),512&Dr.flags&&(Ir[0]=255&ei,Ir[1]=ei>>>8&255,Ir[2]=ei>>>16&255,Ir[3]=ei>>>24&255,Dr.check=dr(Dr.check,Ir,4,0)),Wr=ei=0,Dr.mode=4;case 4:for(;Wr<16;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Dr.head&&(Dr.head.xflags=255&ei,Dr.head.os=ei>>8),512&Dr.flags&&(Ir[0]=255&ei,Ir[1]=ei>>>8&255,Dr.check=dr(Dr.check,Ir,2,0)),Wr=ei=0,Dr.mode=5;case 5:if(1024&Dr.flags){for(;Wr<16;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Dr.length=ei,Dr.head&&(Dr.head.extra_len=ei),512&Dr.flags&&(Ir[0]=255&ei,Ir[1]=ei>>>8&255,Dr.check=dr(Dr.check,Ir,2,0)),Wr=ei=0}else Dr.head&&(Dr.head.extra=null);Dr.mode=6;case 6:if(1024&Dr.flags&&(ii<(ci=Dr.length)&&(ci=ii),ci&&(Dr.head&&(Lr=Dr.head.extra_len-Dr.length,Dr.head.extra||(Dr.head.extra=new Array(Dr.head.extra_len)),hr.arraySet(Dr.head.extra,Jr,Kr,ci,Lr)),512&Dr.flags&&(Dr.check=dr(Dr.check,Jr,ci,Kr)),ii-=ci,Kr+=ci,Dr.length-=ci),Dr.length))break e;Dr.length=0,Dr.mode=7;case 7:if(2048&Dr.flags){if(ii===0)break e;for(ci=0;Lr=Jr[Kr+ci++],Dr.head&&Lr&&Dr.length<65536&&(Dr.head.name+=String.fromCharCode(Lr)),Lr&&ci<ii;);if(512&Dr.flags&&(Dr.check=dr(Dr.check,Jr,ci,Kr)),ii-=ci,Kr+=ci,Lr)break e}else Dr.head&&(Dr.head.name=null);Dr.length=0,Dr.mode=8;case 8:if(4096&Dr.flags){if(ii===0)break e;for(ci=0;Lr=Jr[Kr+ci++],Dr.head&&Lr&&Dr.length<65536&&(Dr.head.comment+=String.fromCharCode(Lr)),Lr&&ci<ii;);if(512&Dr.flags&&(Dr.check=dr(Dr.check,Jr,ci,Kr)),ii-=ci,Kr+=ci,Lr)break e}else Dr.head&&(Dr.head.comment=null);Dr.mode=9;case 9:if(512&Dr.flags){for(;Wr<16;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(ei!==(65535&Dr.check)){Ur.msg="header crc mismatch",Dr.mode=30;break}Wr=ei=0}Dr.head&&(Dr.head.hcrc=Dr.flags>>9&1,Dr.head.done=!0),Ur.adler=Dr.check=0,Dr.mode=12;break;case 10:for(;Wr<32;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Ur.adler=Dr.check=wr(ei),Wr=ei=0,Dr.mode=11;case 11:if(Dr.havedict===0)return Ur.next_out=ui,Ur.avail_out=di,Ur.next_in=Kr,Ur.avail_in=ii,Dr.hold=ei,Dr.bits=Wr,2;Ur.adler=Dr.check=1,Dr.mode=12;case 12:if(Yr===5||Yr===6)break e;case 13:if(Dr.last){ei>>>=7&Wr,Wr-=7&Wr,Dr.mode=27;break}for(;Wr<3;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}switch(Dr.last=1&ei,Wr-=1,3&(ei>>>=1)){case 0:Dr.mode=14;break;case 1:if(Gr(Dr),Dr.mode=20,Yr!==6)break;ei>>>=2,Wr-=2;break e;case 2:Dr.mode=17;break;case 3:Ur.msg="invalid block type",Dr.mode=30}ei>>>=2,Wr-=2;break;case 14:for(ei>>>=7&Wr,Wr-=7&Wr;Wr<32;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if((65535&ei)!=(ei>>>16^65535)){Ur.msg="invalid stored block lengths",Dr.mode=30;break}if(Dr.length=65535&ei,Wr=ei=0,Dr.mode=15,Yr===6)break e;case 15:Dr.mode=16;case 16:if(ci=Dr.length){if(ii<ci&&(ci=ii),di<ci&&(ci=di),ci===0)break e;hr.arraySet(ai,Jr,Kr,ci,ui),ii-=ci,Kr+=ci,di-=ci,ui+=ci,Dr.length-=ci;break}Dr.mode=12;break;case 17:for(;Wr<14;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(Dr.nlen=257+(31&ei),ei>>>=5,Wr-=5,Dr.ndist=1+(31&ei),ei>>>=5,Wr-=5,Dr.ncode=4+(15&ei),ei>>>=4,Wr-=4,286<Dr.nlen||30<Dr.ndist){Ur.msg="too many length or distance symbols",Dr.mode=30;break}Dr.have=0,Dr.mode=18;case 18:for(;Dr.have<Dr.ncode;){for(;Wr<3;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Dr.lens[Qr[Dr.have++]]=7&ei,ei>>>=3,Wr-=3}for(;Dr.have<19;)Dr.lens[Qr[Dr.have++]]=0;if(Dr.lencode=Dr.lendyn,Dr.lenbits=7,Tr={bits:Dr.lenbits},oi=mr(0,Dr.lens,0,19,Dr.lencode,0,Dr.work,Tr),Dr.lenbits=Tr.bits,oi){Ur.msg="invalid code lengths set",Dr.mode=30;break}Dr.have=0,Dr.mode=19;case 19:for(;Dr.have<Dr.nlen+Dr.ndist;){for(;Zr=(Er=Dr.lencode[ei&(1<<Dr.lenbits)-1])>>>16&255,Mr=65535&Er,!((Ar=Er>>>24)<=Wr);){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(Mr<16)ei>>>=Ar,Wr-=Ar,Dr.lens[Dr.have++]=Mr;else{if(Mr===16){for(Sr=Ar+2;Wr<Sr;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(ei>>>=Ar,Wr-=Ar,Dr.have===0){Ur.msg="invalid bit length repeat",Dr.mode=30;break}Lr=Dr.lens[Dr.have-1],ci=3+(3&ei),ei>>>=2,Wr-=2}else if(Mr===17){for(Sr=Ar+3;Wr<Sr;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Wr-=Ar,Lr=0,ci=3+(7&(ei>>>=Ar)),ei>>>=3,Wr-=3}else{for(Sr=Ar+7;Wr<Sr;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Wr-=Ar,Lr=0,ci=11+(127&(ei>>>=Ar)),ei>>>=7,Wr-=7}if(Dr.have+ci>Dr.nlen+Dr.ndist){Ur.msg="invalid bit length repeat",Dr.mode=30;break}for(;ci--;)Dr.lens[Dr.have++]=Lr}}if(Dr.mode===30)break;if(Dr.lens[256]===0){Ur.msg="invalid code -- missing end-of-block",Dr.mode=30;break}if(Dr.lenbits=9,Tr={bits:Dr.lenbits},oi=mr(gr,Dr.lens,0,Dr.nlen,Dr.lencode,0,Dr.work,Tr),Dr.lenbits=Tr.bits,oi){Ur.msg="invalid literal/lengths set",Dr.mode=30;break}if(Dr.distbits=6,Dr.distcode=Dr.distdyn,Tr={bits:Dr.distbits},oi=mr(yr,Dr.lens,Dr.nlen,Dr.ndist,Dr.distcode,0,Dr.work,Tr),Dr.distbits=Tr.bits,oi){Ur.msg="invalid distances set",Dr.mode=30;break}if(Dr.mode=20,Yr===6)break e;case 20:Dr.mode=21;case 21:if(6<=ii&&258<=di){Ur.next_out=ui,Ur.avail_out=di,Ur.next_in=Kr,Ur.avail_in=ii,Dr.hold=ei,Dr.bits=Wr,pr(Ur,si),ui=Ur.next_out,ai=Ur.output,di=Ur.avail_out,Kr=Ur.next_in,Jr=Ur.input,ii=Ur.avail_in,ei=Dr.hold,Wr=Dr.bits,Dr.mode===12&&(Dr.back=-1);break}for(Dr.back=0;Zr=(Er=Dr.lencode[ei&(1<<Dr.lenbits)-1])>>>16&255,Mr=65535&Er,!((Ar=Er>>>24)<=Wr);){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(Zr&&!(240&Zr)){for(jr=Ar,Xr=Zr,ri=Mr;Zr=(Er=Dr.lencode[ri+((ei&(1<<jr+Xr)-1)>>jr)])>>>16&255,Mr=65535&Er,!(jr+(Ar=Er>>>24)<=Wr);){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}ei>>>=jr,Wr-=jr,Dr.back+=jr}if(ei>>>=Ar,Wr-=Ar,Dr.back+=Ar,Dr.length=Mr,Zr===0){Dr.mode=26;break}if(32&Zr){Dr.back=-1,Dr.mode=12;break}if(64&Zr){Ur.msg="invalid literal/length code",Dr.mode=30;break}Dr.extra=15&Zr,Dr.mode=22;case 22:if(Dr.extra){for(Sr=Dr.extra;Wr<Sr;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Dr.length+=ei&(1<<Dr.extra)-1,ei>>>=Dr.extra,Wr-=Dr.extra,Dr.back+=Dr.extra}Dr.was=Dr.length,Dr.mode=23;case 23:for(;Zr=(Er=Dr.distcode[ei&(1<<Dr.distbits)-1])>>>16&255,Mr=65535&Er,!((Ar=Er>>>24)<=Wr);){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(!(240&Zr)){for(jr=Ar,Xr=Zr,ri=Mr;Zr=(Er=Dr.distcode[ri+((ei&(1<<jr+Xr)-1)>>jr)])>>>16&255,Mr=65535&Er,!(jr+(Ar=Er>>>24)<=Wr);){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}ei>>>=jr,Wr-=jr,Dr.back+=jr}if(ei>>>=Ar,Wr-=Ar,Dr.back+=Ar,64&Zr){Ur.msg="invalid distance code",Dr.mode=30;break}Dr.offset=Mr,Dr.extra=15&Zr,Dr.mode=24;case 24:if(Dr.extra){for(Sr=Dr.extra;Wr<Sr;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}Dr.offset+=ei&(1<<Dr.extra)-1,ei>>>=Dr.extra,Wr-=Dr.extra,Dr.back+=Dr.extra}if(Dr.offset>Dr.dmax){Ur.msg="invalid distance too far back",Dr.mode=30;break}Dr.mode=25;case 25:if(di===0)break e;if(ci=si-di,Dr.offset>ci){if((ci=Dr.offset-ci)>Dr.whave&&Dr.sane){Ur.msg="invalid distance too far back",Dr.mode=30;break}ni=ci>Dr.wnext?(ci-=Dr.wnext,Dr.wsize-ci):Dr.wnext-ci,ci>Dr.length&&(ci=Dr.length),Pr=Dr.window}else Pr=ai,ni=ui-Dr.offset,ci=Dr.length;for(di<ci&&(ci=di),di-=ci,Dr.length-=ci;ai[ui++]=Pr[ni++],--ci;);Dr.length===0&&(Dr.mode=21);break;case 26:if(di===0)break e;ai[ui++]=Dr.length,di--,Dr.mode=21;break;case 27:if(Dr.wrap){for(;Wr<32;){if(ii===0)break e;ii--,ei|=Jr[Kr++]<<Wr,Wr+=8}if(si-=di,Ur.total_out+=si,Dr.total+=si,si&&(Ur.adler=Dr.check=Dr.flags?dr(Dr.check,ai,si,ui-si):fr(Dr.check,ai,si,ui-si)),si=di,(Dr.flags?ei:wr(ei))!==Dr.check){Ur.msg="incorrect data check",Dr.mode=30;break}Wr=ei=0}Dr.mode=28;case 28:if(Dr.wrap&&Dr.flags){for(;Wr<32;){if(ii===0)break e;ii--,ei+=Jr[Kr++]<<Wr,Wr+=8}if(ei!==(4294967295&Dr.total)){Ur.msg="incorrect length check",Dr.mode=30;break}Wr=ei=0}Dr.mode=29;case 29:oi=1;break e;case 30:oi=-3;break e;case 31:return-4;case 32:default:return Or}return Ur.next_out=ui,Ur.avail_out=di,Ur.next_in=Kr,Ur.avail_in=ii,Dr.hold=ei,Dr.bits=Wr,(Dr.wsize||si!==Ur.avail_out&&Dr.mode<30&&(Dr.mode<27||Yr!==4))&&qr(Ur,Ur.output,Ur.next_out,si-Ur.avail_out)?(Dr.mode=31,-4):(ti-=Ur.avail_in,si-=Ur.avail_out,Ur.total_in+=ti,Ur.total_out+=si,Dr.total+=si,Dr.wrap&&si&&(Ur.adler=Dr.check=Dr.flags?dr(Dr.check,ai,si,Ur.next_out-si):fr(Dr.check,ai,si,Ur.next_out-si)),Ur.data_type=Dr.bits+(Dr.last?64:0)+(Dr.mode===12?128:0)+(Dr.mode===20||Dr.mode===15?256:0),(ti==0&&si===0||Yr===4)&&oi===br&&(oi=-5),oi)},ur.inflateEnd=function(Ur){if(!Ur||!Ur.state)return Or;var Yr=Ur.state;return Yr.window&&(Yr.window=null),Ur.state=null,br},ur.inflateGetHeader=function(Ur,Yr){var Dr;return Ur&&Ur.state&&2&(Dr=Ur.state).wrap?((Dr.head=Yr).done=!1,br):Or},ur.inflateSetDictionary=function(Ur,Yr){var Dr,Jr=Yr.length;return Ur&&Ur.state?(Dr=Ur.state).wrap!==0&&Dr.mode!==11?Or:Dr.mode===11&&fr(1,Yr,Jr,0)!==Dr.check?-3:qr(Ur,Yr,Jr,Jr)?(Dr.mode=31,-4):(Dr.havedict=1,br):Or},ur.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(ar,cr,ur){var hr=ar("../utils/common"),fr=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],dr=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],pr=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],mr=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];cr.exports=function(gr,yr,br,Or,_r,vr,xr,wr){var kr,Cr,$r,Nr,Br,Fr,Vr,Rr,Gr,qr=wr.bits,Ur=0,Yr=0,Dr=0,Jr=0,ai=0,Kr=0,ui=0,ii=0,di=0,ei=0,Wr=null,ti=0,si=new hr.Buf16(16),ci=new hr.Buf16(16),ni=null,Pr=0;for(Ur=0;Ur<=15;Ur++)si[Ur]=0;for(Yr=0;Yr<Or;Yr++)si[yr[br+Yr]]++;for(ai=qr,Jr=15;1<=Jr&&si[Jr]===0;Jr--);if(Jr<ai&&(ai=Jr),Jr===0)return _r[vr++]=20971520,_r[vr++]=20971520,wr.bits=1,0;for(Dr=1;Dr<Jr&&si[Dr]===0;Dr++);for(ai<Dr&&(ai=Dr),Ur=ii=1;Ur<=15;Ur++)if(ii<<=1,(ii-=si[Ur])<0)return-1;if(0<ii&&(gr===0||Jr!==1))return-1;for(ci[1]=0,Ur=1;Ur<15;Ur++)ci[Ur+1]=ci[Ur]+si[Ur];for(Yr=0;Yr<Or;Yr++)yr[br+Yr]!==0&&(xr[ci[yr[br+Yr]]++]=Yr);if(Fr=gr===0?(Wr=ni=xr,19):gr===1?(Wr=fr,ti-=257,ni=dr,Pr-=257,256):(Wr=pr,ni=mr,-1),Ur=Dr,Br=vr,ui=Yr=ei=0,$r=-1,Nr=(di=1<<(Kr=ai))-1,gr===1&&852<di||gr===2&&592<di)return 1;for(;;){for(Vr=Ur-ui,Gr=xr[Yr]<Fr?(Rr=0,xr[Yr]):xr[Yr]>Fr?(Rr=ni[Pr+xr[Yr]],Wr[ti+xr[Yr]]):(Rr=96,0),kr=1<<Ur-ui,Dr=Cr=1<<Kr;_r[Br+(ei>>ui)+(Cr-=kr)]=Vr<<24|Rr<<16|Gr|0,Cr!==0;);for(kr=1<<Ur-1;ei&kr;)kr>>=1;if(kr!==0?(ei&=kr-1,ei+=kr):ei=0,Yr++,--si[Ur]==0){if(Ur===Jr)break;Ur=yr[br+xr[Yr]]}if(ai<Ur&&(ei&Nr)!==$r){for(ui===0&&(ui=ai),Br+=Dr,ii=1<<(Kr=Ur-ui);Kr+ui<Jr&&!((ii-=si[Kr+ui])<=0);)Kr++,ii<<=1;if(di+=1<<Kr,gr===1&&852<di||gr===2&&592<di)return 1;_r[$r=ei&Nr]=ai<<24|Kr<<16|Br-vr|0}}return ei!==0&&(_r[Br+ei]=Ur-ui<<24|64<<16|0),wr.bits=ai,0}},{"../utils/common":41}],51:[function(ar,cr,ur){cr.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(ar,cr,ur){var hr=ar("../utils/common"),fr=0,dr=1;function pr(Er){for(var Ir=Er.length;0<=--Ir;)Er[Ir]=0}var mr=0,gr=29,yr=256,br=yr+1+gr,Or=30,_r=19,vr=2*br+1,xr=15,wr=16,kr=7,Cr=256,$r=16,Nr=17,Br=18,Fr=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Vr=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Rr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Gr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],qr=new Array(2*(br+2));pr(qr);var Ur=new Array(2*Or);pr(Ur);var Yr=new Array(512);pr(Yr);var Dr=new Array(256);pr(Dr);var Jr=new Array(gr);pr(Jr);var ai,Kr,ui,ii=new Array(Or);function di(Er,Ir,Qr,zr,Hr){this.static_tree=Er,this.extra_bits=Ir,this.extra_base=Qr,this.elems=zr,this.max_length=Hr,this.has_stree=Er&&Er.length}function ei(Er,Ir){this.dyn_tree=Er,this.max_code=0,this.stat_desc=Ir}function Wr(Er){return Er<256?Yr[Er]:Yr[256+(Er>>>7)]}function ti(Er,Ir){Er.pending_buf[Er.pending++]=255&Ir,Er.pending_buf[Er.pending++]=Ir>>>8&255}function si(Er,Ir,Qr){Er.bi_valid>wr-Qr?(Er.bi_buf|=Ir<<Er.bi_valid&65535,ti(Er,Er.bi_buf),Er.bi_buf=Ir>>wr-Er.bi_valid,Er.bi_valid+=Qr-wr):(Er.bi_buf|=Ir<<Er.bi_valid&65535,Er.bi_valid+=Qr)}function ci(Er,Ir,Qr){si(Er,Qr[2*Ir],Qr[2*Ir+1])}function ni(Er,Ir){for(var Qr=0;Qr|=1&Er,Er>>>=1,Qr<<=1,0<--Ir;);return Qr>>>1}function Pr(Er,Ir,Qr){var zr,Hr,li=new Array(xr+1),pi=0;for(zr=1;zr<=xr;zr++)li[zr]=pi=pi+Qr[zr-1]<<1;for(Hr=0;Hr<=Ir;Hr++){var hi=Er[2*Hr+1];hi!==0&&(Er[2*Hr]=ni(li[hi]++,hi))}}function Ar(Er){var Ir;for(Ir=0;Ir<br;Ir++)Er.dyn_ltree[2*Ir]=0;for(Ir=0;Ir<Or;Ir++)Er.dyn_dtree[2*Ir]=0;for(Ir=0;Ir<_r;Ir++)Er.bl_tree[2*Ir]=0;Er.dyn_ltree[2*Cr]=1,Er.opt_len=Er.static_len=0,Er.last_lit=Er.matches=0}function Zr(Er){8<Er.bi_valid?ti(Er,Er.bi_buf):0<Er.bi_valid&&(Er.pending_buf[Er.pending++]=Er.bi_buf),Er.bi_buf=0,Er.bi_valid=0}function Mr(Er,Ir,Qr,zr){var Hr=2*Ir,li=2*Qr;return Er[Hr]<Er[li]||Er[Hr]===Er[li]&&zr[Ir]<=zr[Qr]}function jr(Er,Ir,Qr){for(var zr=Er.heap[Qr],Hr=Qr<<1;Hr<=Er.heap_len&&(Hr<Er.heap_len&&Mr(Ir,Er.heap[Hr+1],Er.heap[Hr],Er.depth)&&Hr++,!Mr(Ir,zr,Er.heap[Hr],Er.depth));)Er.heap[Qr]=Er.heap[Hr],Qr=Hr,Hr<<=1;Er.heap[Qr]=zr}function Xr(Er,Ir,Qr){var zr,Hr,li,pi,hi=0;if(Er.last_lit!==0)for(;zr=Er.pending_buf[Er.d_buf+2*hi]<<8|Er.pending_buf[Er.d_buf+2*hi+1],Hr=Er.pending_buf[Er.l_buf+hi],hi++,zr===0?ci(Er,Hr,Ir):(ci(Er,(li=Dr[Hr])+yr+1,Ir),(pi=Fr[li])!==0&&si(Er,Hr-=Jr[li],pi),ci(Er,li=Wr(--zr),Qr),(pi=Vr[li])!==0&&si(Er,zr-=ii[li],pi)),hi<Er.last_lit;);ci(Er,Cr,Ir)}function ri(Er,Ir){var Qr,zr,Hr,li=Ir.dyn_tree,pi=Ir.stat_desc.static_tree,hi=Ir.stat_desc.has_stree,fi=Ir.stat_desc.elems,mi=-1;for(Er.heap_len=0,Er.heap_max=vr,Qr=0;Qr<fi;Qr++)li[2*Qr]!==0?(Er.heap[++Er.heap_len]=mi=Qr,Er.depth[Qr]=0):li[2*Qr+1]=0;for(;Er.heap_len<2;)li[2*(Hr=Er.heap[++Er.heap_len]=mi<2?++mi:0)]=1,Er.depth[Hr]=0,Er.opt_len--,hi&&(Er.static_len-=pi[2*Hr+1]);for(Ir.max_code=mi,Qr=Er.heap_len>>1;1<=Qr;Qr--)jr(Er,li,Qr);for(Hr=fi;Qr=Er.heap[1],Er.heap[1]=Er.heap[Er.heap_len--],jr(Er,li,1),zr=Er.heap[1],Er.heap[--Er.heap_max]=Qr,Er.heap[--Er.heap_max]=zr,li[2*Hr]=li[2*Qr]+li[2*zr],Er.depth[Hr]=(Er.depth[Qr]>=Er.depth[zr]?Er.depth[Qr]:Er.depth[zr])+1,li[2*Qr+1]=li[2*zr+1]=Hr,Er.heap[1]=Hr++,jr(Er,li,1),2<=Er.heap_len;);Er.heap[--Er.heap_max]=Er.heap[1],function(gi,_i){var yi,Oi,Ii,vi,Ti,Mi,ki=_i.dyn_tree,Bi=_i.max_code,Zi=_i.stat_desc.static_tree,Qi=_i.stat_desc.has_stree,$i=_i.stat_desc.extra_bits,Ui=_i.stat_desc.extra_base,Pi=_i.stat_desc.max_length,Li=0;for(vi=0;vi<=xr;vi++)gi.bl_count[vi]=0;for(ki[2*gi.heap[gi.heap_max]+1]=0,yi=gi.heap_max+1;yi<vr;yi++)Pi<(vi=ki[2*ki[2*(Oi=gi.heap[yi])+1]+1]+1)&&(vi=Pi,Li++),ki[2*Oi+1]=vi,Bi<Oi||(gi.bl_count[vi]++,Ti=0,Ui<=Oi&&(Ti=$i[Oi-Ui]),Mi=ki[2*Oi],gi.opt_len+=Mi*(vi+Ti),Qi&&(gi.static_len+=Mi*(Zi[2*Oi+1]+Ti)));if(Li!==0){do{for(vi=Pi-1;gi.bl_count[vi]===0;)vi--;gi.bl_count[vi]--,gi.bl_count[vi+1]+=2,gi.bl_count[Pi]--,Li-=2}while(0<Li);for(vi=Pi;vi!==0;vi--)for(Oi=gi.bl_count[vi];Oi!==0;)Bi<(Ii=gi.heap[--yi])||(ki[2*Ii+1]!==vi&&(gi.opt_len+=(vi-ki[2*Ii+1])*ki[2*Ii],ki[2*Ii+1]=vi),Oi--)}}(Er,Ir),Pr(li,mi,Er.bl_count)}function Lr(Er,Ir,Qr){var zr,Hr,li=-1,pi=Ir[1],hi=0,fi=7,mi=4;for(pi===0&&(fi=138,mi=3),Ir[2*(Qr+1)+1]=65535,zr=0;zr<=Qr;zr++)Hr=pi,pi=Ir[2*(zr+1)+1],++hi<fi&&Hr===pi||(hi<mi?Er.bl_tree[2*Hr]+=hi:Hr!==0?(Hr!==li&&Er.bl_tree[2*Hr]++,Er.bl_tree[2*$r]++):hi<=10?Er.bl_tree[2*Nr]++:Er.bl_tree[2*Br]++,li=Hr,mi=(hi=0)===pi?(fi=138,3):Hr===pi?(fi=6,3):(fi=7,4))}function oi(Er,Ir,Qr){var zr,Hr,li=-1,pi=Ir[1],hi=0,fi=7,mi=4;for(pi===0&&(fi=138,mi=3),zr=0;zr<=Qr;zr++)if(Hr=pi,pi=Ir[2*(zr+1)+1],!(++hi<fi&&Hr===pi)){if(hi<mi)for(;ci(Er,Hr,Er.bl_tree),--hi!=0;);else Hr!==0?(Hr!==li&&(ci(Er,Hr,Er.bl_tree),hi--),ci(Er,$r,Er.bl_tree),si(Er,hi-3,2)):hi<=10?(ci(Er,Nr,Er.bl_tree),si(Er,hi-3,3)):(ci(Er,Br,Er.bl_tree),si(Er,hi-11,7));li=Hr,mi=(hi=0)===pi?(fi=138,3):Hr===pi?(fi=6,3):(fi=7,4)}}pr(ii);var Tr=!1;function Sr(Er,Ir,Qr,zr){si(Er,(mr<<1)+(zr?1:0),3),function(Hr,li,pi,hi){Zr(Hr),hi&&(ti(Hr,pi),ti(Hr,~pi)),hr.arraySet(Hr.pending_buf,Hr.window,li,pi,Hr.pending),Hr.pending+=pi}(Er,Ir,Qr,!0)}ur._tr_init=function(Er){Tr||(function(){var Ir,Qr,zr,Hr,li,pi=new Array(xr+1);for(Hr=zr=0;Hr<gr-1;Hr++)for(Jr[Hr]=zr,Ir=0;Ir<1<<Fr[Hr];Ir++)Dr[zr++]=Hr;for(Dr[zr-1]=Hr,Hr=li=0;Hr<16;Hr++)for(ii[Hr]=li,Ir=0;Ir<1<<Vr[Hr];Ir++)Yr[li++]=Hr;for(li>>=7;Hr<Or;Hr++)for(ii[Hr]=li<<7,Ir=0;Ir<1<<Vr[Hr]-7;Ir++)Yr[256+li++]=Hr;for(Qr=0;Qr<=xr;Qr++)pi[Qr]=0;for(Ir=0;Ir<=143;)qr[2*Ir+1]=8,Ir++,pi[8]++;for(;Ir<=255;)qr[2*Ir+1]=9,Ir++,pi[9]++;for(;Ir<=279;)qr[2*Ir+1]=7,Ir++,pi[7]++;for(;Ir<=287;)qr[2*Ir+1]=8,Ir++,pi[8]++;for(Pr(qr,br+1,pi),Ir=0;Ir<Or;Ir++)Ur[2*Ir+1]=5,Ur[2*Ir]=ni(Ir,5);ai=new di(qr,Fr,yr+1,br,xr),Kr=new di(Ur,Vr,0,Or,xr),ui=new di(new Array(0),Rr,0,_r,kr)}(),Tr=!0),Er.l_desc=new ei(Er.dyn_ltree,ai),Er.d_desc=new ei(Er.dyn_dtree,Kr),Er.bl_desc=new ei(Er.bl_tree,ui),Er.bi_buf=0,Er.bi_valid=0,Ar(Er)},ur._tr_stored_block=Sr,ur._tr_flush_block=function(Er,Ir,Qr,zr){var Hr,li,pi=0;0<Er.level?(Er.strm.data_type===2&&(Er.strm.data_type=function(hi){var fi,mi=4093624447;for(fi=0;fi<=31;fi++,mi>>>=1)if(1&mi&&hi.dyn_ltree[2*fi]!==0)return fr;if(hi.dyn_ltree[18]!==0||hi.dyn_ltree[20]!==0||hi.dyn_ltree[26]!==0)return dr;for(fi=32;fi<yr;fi++)if(hi.dyn_ltree[2*fi]!==0)return dr;return fr}(Er)),ri(Er,Er.l_desc),ri(Er,Er.d_desc),pi=function(hi){var fi;for(Lr(hi,hi.dyn_ltree,hi.l_desc.max_code),Lr(hi,hi.dyn_dtree,hi.d_desc.max_code),ri(hi,hi.bl_desc),fi=_r-1;3<=fi&&hi.bl_tree[2*Gr[fi]+1]===0;fi--);return hi.opt_len+=3*(fi+1)+5+5+4,fi}(Er),Hr=Er.opt_len+3+7>>>3,(li=Er.static_len+3+7>>>3)<=Hr&&(Hr=li)):Hr=li=Qr+5,Qr+4<=Hr&&Ir!==-1?Sr(Er,Ir,Qr,zr):Er.strategy===4||li===Hr?(si(Er,2+(zr?1:0),3),Xr(Er,qr,Ur)):(si(Er,4+(zr?1:0),3),function(hi,fi,mi,gi){var _i;for(si(hi,fi-257,5),si(hi,mi-1,5),si(hi,gi-4,4),_i=0;_i<gi;_i++)si(hi,hi.bl_tree[2*Gr[_i]+1],3);oi(hi,hi.dyn_ltree,fi-1),oi(hi,hi.dyn_dtree,mi-1)}(Er,Er.l_desc.max_code+1,Er.d_desc.max_code+1,pi+1),Xr(Er,Er.dyn_ltree,Er.dyn_dtree)),Ar(Er),zr&&Zr(Er)},ur._tr_tally=function(Er,Ir,Qr){return Er.pending_buf[Er.d_buf+2*Er.last_lit]=Ir>>>8&255,Er.pending_buf[Er.d_buf+2*Er.last_lit+1]=255&Ir,Er.pending_buf[Er.l_buf+Er.last_lit]=255&Qr,Er.last_lit++,Ir===0?Er.dyn_ltree[2*Qr]++:(Er.matches++,Ir--,Er.dyn_ltree[2*(Dr[Qr]+yr+1)]++,Er.dyn_dtree[2*Wr(Ir)]++),Er.last_lit===Er.lit_bufsize-1},ur._tr_align=function(Er){si(Er,2,3),ci(Er,Cr,qr),function(Ir){Ir.bi_valid===16?(ti(Ir,Ir.bi_buf),Ir.bi_buf=0,Ir.bi_valid=0):8<=Ir.bi_valid&&(Ir.pending_buf[Ir.pending++]=255&Ir.bi_buf,Ir.bi_buf>>=8,Ir.bi_valid-=8)}(Er)}},{"../utils/common":41}],53:[function(ar,cr,ur){cr.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(ar,cr,ur){(function(hr){(function(fr,dr){if(!fr.setImmediate){var pr,mr,gr,yr,br=1,Or={},_r=!1,vr=fr.document,xr=Object.getPrototypeOf&&Object.getPrototypeOf(fr);xr=xr&&xr.setTimeout?xr:fr,pr={}.toString.call(fr.process)==="[object process]"?function($r){process$1$1.nextTick(function(){kr($r)})}:function(){if(fr.postMessage&&!fr.importScripts){var $r=!0,Nr=fr.onmessage;return fr.onmessage=function(){$r=!1},fr.postMessage("","*"),fr.onmessage=Nr,$r}}()?(yr="setImmediate$"+Math.random()+"$",fr.addEventListener?fr.addEventListener("message",Cr,!1):fr.attachEvent("onmessage",Cr),function($r){fr.postMessage(yr+$r,"*")}):fr.MessageChannel?((gr=new MessageChannel).port1.onmessage=function($r){kr($r.data)},function($r){gr.port2.postMessage($r)}):vr&&"onreadystatechange"in vr.createElement("script")?(mr=vr.documentElement,function($r){var Nr=vr.createElement("script");Nr.onreadystatechange=function(){kr($r),Nr.onreadystatechange=null,mr.removeChild(Nr),Nr=null},mr.appendChild(Nr)}):function($r){setTimeout(kr,0,$r)},xr.setImmediate=function($r){typeof $r!="function"&&($r=new Function(""+$r));for(var Nr=new Array(arguments.length-1),Br=0;Br<Nr.length;Br++)Nr[Br]=arguments[Br+1];var Fr={callback:$r,args:Nr};return Or[br]=Fr,pr(br),br++},xr.clearImmediate=wr}function wr($r){delete Or[$r]}function kr($r){if(_r)setTimeout(kr,0,$r);else{var Nr=Or[$r];if(Nr){_r=!0;try{(function(Br){var Fr=Br.callback,Vr=Br.args;switch(Vr.length){case 0:Fr();break;case 1:Fr(Vr[0]);break;case 2:Fr(Vr[0],Vr[1]);break;case 3:Fr(Vr[0],Vr[1],Vr[2]);break;default:Fr.apply(dr,Vr)}})(Nr)}finally{wr($r),_r=!1}}}}function Cr($r){$r.source===fr&&typeof $r.data=="string"&&$r.data.indexOf(yr)===0&&kr(+$r.data.slice(yr.length))}})(typeof self>"u"?hr===void 0?this:hr:self)}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(jszip_min);var jszip_minExports=jszip_min.exports;const JSZip=getDefaultExportFromCjs(jszip_minExports);var xml$2={exports:{}},XML_CHARACTER_MAP={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function escapeForXML$1(lr){return lr&&lr.replace?lr.replace(/([&"<>'])/g,function(or,ar){return XML_CHARACTER_MAP[ar]}):lr}var escapeForXML_1=escapeForXML$1,escapeForXML=escapeForXML_1,Stream=streamBrowserify.Stream,DEFAULT_INDENT="    ";function xml(lr,or){typeof or!="object"&&(or={indent:or});var ar=or.stream?new Stream:null,cr="",ur=!1,hr=or.indent?or.indent===!0?DEFAULT_INDENT:or.indent:"",fr=!0;function dr(br){fr?process$1$1.nextTick(br):br()}function pr(br,Or){if(Or!==void 0&&(cr+=Or),br&&!ur&&(ar=ar||new Stream,ur=!0),br&&ur){var _r=cr;dr(function(){ar.emit("data",_r)}),cr=""}}function mr(br,Or){format(pr,resolve(br,hr,hr?1:0),Or)}function gr(){if(ar){var br=cr;dr(function(){ar.emit("data",br),ar.emit("end"),ar.readable=!1,ar.emit("close")})}}function yr(br){var Or=br.encoding||"UTF-8",_r={version:"1.0",encoding:Or};br.standalone&&(_r.standalone=br.standalone),mr({"?xml":{_attr:_r}}),cr=cr.replace("/>","?>")}return dr(function(){fr=!1}),or.declaration&&yr(or.declaration),lr&&lr.forEach?lr.forEach(function(br,Or){var _r;Or+1===lr.length&&(_r=gr),mr(br,_r)}):mr(lr,gr),ar?(ar.readable=!0,ar):cr}function element(){var lr=Array.prototype.slice.call(arguments),or={_elem:resolve(lr)};return or.push=function(ar){if(!this.append)throw new Error("not assigned to a parent!");var cr=this,ur=this._elem.indent;format(this.append,resolve(ar,ur,this._elem.icount+(ur?1:0)),function(){cr.append(!0)})},or.close=function(ar){ar!==void 0&&this.push(ar),this.end&&this.end()},or}function create_indent(lr,or){return new Array(or||0).join(lr||"")}function resolve(lr,or,ar){ar=ar||0;var cr=create_indent(or,ar),ur,hr=lr,fr=!1;if(typeof lr=="object"){var dr=Object.keys(lr);if(ur=dr[0],hr=lr[ur],hr&&hr._elem)return hr._elem.name=ur,hr._elem.icount=ar,hr._elem.indent=or,hr._elem.indents=cr,hr._elem.interrupt=hr,hr._elem}var pr=[],mr=[],gr;function yr(br){var Or=Object.keys(br);Or.forEach(function(_r){pr.push(attribute(_r,br[_r]))})}switch(typeof hr){case"object":if(hr===null)break;hr._attr&&yr(hr._attr),hr._cdata&&mr.push(("<![CDATA["+hr._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),hr.forEach&&(gr=!1,mr.push(""),hr.forEach(function(br){if(typeof br=="object"){var Or=Object.keys(br)[0];Or=="_attr"?yr(br._attr):mr.push(resolve(br,or,ar+1))}else mr.pop(),gr=!0,mr.push(escapeForXML(br))}),gr||mr.push(""));break;default:mr.push(escapeForXML(hr))}return{name:ur,interrupt:fr,attributes:pr,content:mr,icount:ar,indents:cr,indent:or}}function format(lr,or,ar){if(typeof or!="object")return lr(!1,or);var cr=or.interrupt?1:or.content.length;function ur(){for(;or.content.length;){var fr=or.content.shift();if(fr!==void 0){if(hr(fr))return;format(lr,fr)}}lr(!1,(cr>1?or.indents:"")+(or.name?"</"+or.name+">":"")+(or.indent&&!ar?`
`:"")),ar&&ar()}function hr(fr){return fr.interrupt?(fr.interrupt.append=lr,fr.interrupt.end=ur,fr.interrupt=!1,lr(!0),!0):!1}if(lr(!1,or.indents+(or.name?"<"+or.name:"")+(or.attributes.length?" "+or.attributes.join(" "):"")+(cr?or.name?">":"":or.name?"/>":"")+(or.indent&&cr>1?`
`:"")),!cr)return lr(!1,or.indent?`
`:"");hr(or)||ur()}function attribute(lr,or){return lr+'="'+escapeForXML(or)+'"'}xml$2.exports=xml;xml$2.exports.element=xml$2.exports.Element=element;var xmlExports=xml$2.exports;const xml$1=getDefaultExportFromCjs(xmlExports);class Formatter{format(or,ar={stack:[]}){const cr=or.prepForXml(ar);if(cr)return cr;throw Error("XMLComponent did not format correctly")}}class ImageReplacer{replace(or,ar,cr){let ur=or;return ar.forEach((hr,fr)=>{ur=ur.replace(new RegExp(`{${hr.fileName}}`,"g"),(cr+fr).toString())}),ur}getMediaData(or,ar){return ar.Array.filter(cr=>or.search(`{${cr.fileName}}`)>0)}}class NumberingReplacer{replace(or,ar){let cr=or;for(const ur of ar)cr=cr.replace(new RegExp(`{${ur.reference}-${ur.instance}}`,"g"),ur.numId.toString());return cr}}class Compiler{constructor(){__publicField(this,"formatter"),__publicField(this,"imageReplacer"),__publicField(this,"numberingReplacer"),this.formatter=new Formatter,this.imageReplacer=new ImageReplacer,this.numberingReplacer=new NumberingReplacer}compile(or,ar){const cr=new JSZip,ur=this.xmlifyFile(or,ar),hr=new Map(Object.entries(ur));for(const[,fr]of hr)if(Array.isArray(fr))for(const dr of fr)cr.file(dr.path,dr.data);else cr.file(fr.path,fr.data);for(const{stream:fr,fileName:dr}of or.Media.Array)cr.file(`word/media/${dr}`,fr);return cr}xmlifyFile(or,ar){const cr=or.Document.Relationships.RelationshipCount+1,ur=xml$1(this.formatter.format(or.Document.View,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{standalone:"yes",encoding:"UTF-8"}}),hr=this.imageReplacer.getMediaData(ur,or.Media);return{Relationships:{data:(()=>(hr.forEach((fr,dr)=>{or.Document.Relationships.createRelationship(cr+dr,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${fr.fileName}`)}),xml$1(this.formatter.format(or.Document.Relationships,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}})))(),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const fr=this.imageReplacer.replace(ur,hr,cr);return this.numberingReplacer.replace(fr,or.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const fr=xml$1(this.formatter.format(or.Styles,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(fr,or.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:xml$1(this.formatter.format(or.CoreProperties,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:xml$1(this.formatter.format(or.Numbering,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:xml$1(this.formatter.format(or.FileRelationships,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:or.Headers.map((fr,dr)=>{const pr=xml$1(this.formatter.format(fr.View,{viewWrapper:fr,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(pr,or.Media).forEach((gr,yr)=>{fr.Relationships.createRelationship(yr,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${gr.fileName}`)}),{data:xml$1(this.formatter.format(fr.Relationships,{viewWrapper:fr,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${dr+1}.xml.rels`}}),FooterRelationships:or.Footers.map((fr,dr)=>{const pr=xml$1(this.formatter.format(fr.View,{viewWrapper:fr,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(pr,or.Media).forEach((gr,yr)=>{fr.Relationships.createRelationship(yr,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${gr.fileName}`)}),{data:xml$1(this.formatter.format(fr.Relationships,{viewWrapper:fr,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${dr+1}.xml.rels`}}),Headers:or.Headers.map((fr,dr)=>{const pr=xml$1(this.formatter.format(fr.View,{viewWrapper:fr,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}}),mr=this.imageReplacer.getMediaData(pr,or.Media),gr=this.imageReplacer.replace(pr,mr,0);return{data:this.numberingReplacer.replace(gr,or.Numbering.ConcreteNumbering),path:`word/header${dr+1}.xml`}}),Footers:or.Footers.map((fr,dr)=>{const pr=xml$1(this.formatter.format(fr.View,{viewWrapper:fr,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}}),mr=this.imageReplacer.getMediaData(pr,or.Media),gr=this.imageReplacer.replace(pr,mr,0);return{data:this.numberingReplacer.replace(gr,or.Numbering.ConcreteNumbering),path:`word/footer${dr+1}.xml`}}),ContentTypes:{data:xml$1(this.formatter.format(or.ContentTypes,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:xml$1(this.formatter.format(or.CustomProperties,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:xml$1(this.formatter.format(or.AppProperties,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:xml$1(this.formatter.format(or.FootNotes.View,{viewWrapper:or.FootNotes,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:xml$1(this.formatter.format(or.FootNotes.Relationships,{viewWrapper:or.FootNotes,file:or,stack:[]}),{indent:ar,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:xml$1(this.formatter.format(or.Settings,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:xml$1(this.formatter.format(or.Comments,{viewWrapper:or.Document,file:or,stack:[]}),{indent:ar,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/comments.xml"}}}}const convertPrettifyType=lr=>lr===!0?"  ":lr===!1?void 0:lr;class Packer{static async toString(or,ar){return await this.compiler.compile(or,convertPrettifyType(ar)).generateAsync({type:"string",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}static async toBuffer(or,ar){return await this.compiler.compile(or,convertPrettifyType(ar)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}static async toBase64String(or,ar){return await this.compiler.compile(or,convertPrettifyType(ar)).generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}static async toBlob(or,ar){return await this.compiler.compile(or,convertPrettifyType(ar)).generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}static toStream(or,ar){const cr=new streamBrowserify.Stream;return this.compiler.compile(or,convertPrettifyType(ar)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(hr=>{cr.emit("data",hr),cr.emit("end")}),cr}}__publicField(Packer,"compiler",new Compiler);const mimetype$2="application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension$2="docx",textNodesUnder=lr=>{for(var or,ar=[],cr=document.createTreeWalker(lr,NodeFilter.SHOW_TEXT);or=cr.nextNode();)ar.push(or);return ar},whitelist=["<b>","</b>","<i>","</i>","<u>","</u>"],inlineRenderer=()=>({html:lr=>whitelist.includes(lr.trim().toLowerCase())?lr.trim().toLowerCase():mangle(lr),paragraph:lr=>`${lr}`,strong:lr=>`<b>${lr}</b>`,em:lr=>`<i>${lr}</i>`,codespan:()=>"",code:()=>"",link:()=>""}),renderer$1=(lr,or)=>({html:ar=>whitelist.includes(ar.trim().toLowerCase())?ar.trim().toLowerCase():mangle(ar),paragraph:ar=>`<p>${ar}</p>`,strong:ar=>`<b>${ar}</b>`,em:ar=>`<i>${ar}</i>`,br:()=>"</p><p>",codespan:ar=>"",code:(ar,cr)=>"",link:(ar,cr,ur)=>{const hr=ar.replace("#","").trim(),fr=or.renameAnchor({key:hr,book:lr}),dr=lr.index.keys[hr],pr=dr===void 0?void 0:lr.index.chapters[dr];return`<mage-link to="${fr}">${encodeToHTML(or.renameLink({book:lr,text:ur.trim(),chapter:pr,title:pr==null?void 0:pr.title,key:pr==null?void 0:pr.key}),inlineRenderer())}</mage-link>`}}),encode$2=lr=>{const or=bookify(lr),ar=sanitizeProperties(or.index.properties),cr=ar.titleStyle=="inline",ur=[];or.index.title;for(const[fr,{content:dr}]of chaptersOf(or)){if(fr.flags.includes("noexport"))continue;const{renamedKey:pr,renamedTitle:mr}=renameKeyAndTitle(ar,or,fr),gr=document.createElement("p");gr.innerHTML=encodeToHTML(mr,inlineRenderer())||"";const yr=[];textNodesUnder(gr).forEach(xr=>{let wr=!1,kr=!1,Cr=!1,$r=xr.parentNode;for(;$r.tagName!=="P";){const Nr=$r.tagName;Nr==="B"&&(wr=!0),Nr==="I"&&(kr=!0),Nr==="U"&&(Cr=!0),$r=$r.parentNode}yr.push(new TextRun({bold:wr,italics:kr,underline:Cr?{color:"#000000"}:void 0,text:xr.nodeValue??""}))});const br=new Bookmark({id:`${pr}`,children:yr}),Or=document.createElement("div");Or.innerHTML=trimHTML(encodeToHTML(dr,renderer$1(or,ar)).replaceAll("<br>","</p><p>")||"<p></p>");const _r=[];cr||_r.push(new Paragraph({children:[br],alignment:AlignmentType.CENTER,heading:HeadingLevel.HEADING_3})),Or.childNodes.forEach((xr,wr)=>{const kr=[];textNodesUnder(xr).forEach($r=>{let Nr=!1,Br=!1,Fr=!1,Vr=$r.parentNode;for(;Vr.tagName!=="P";){const Rr=Vr.tagName;if(Rr==="MAGE-LINK"){const Gr=Vr.getAttribute("to");kr.push(new InternalHyperlink({children:[new TextRun({bold:Nr,italics:Br,text:$r.nodeValue??void 0,style:"Hyperlink",underline:Fr?void 0:{type:null,color:"#000000"}})],anchor:`${Gr}`}));return}Rr==="B"&&(Nr=!0),Rr==="I"&&(Br=!0),Rr==="U"&&(Fr=!0),Vr=Vr.parentNode}kr.push(new TextRun({bold:Nr,italics:Br,underline:Fr?{color:"#000000"}:void 0,text:$r.nodeValue??void 0}))});let Cr=AlignmentType.BOTH;_r.push(new Paragraph({children:[...cr&&wr===0?[br,new TextRun({text:" "})]:[],...kr],alignment:Cr}))}),_r.push(new Paragraph({children:[new TextRun("")]})),ur.push(..._r)}const hr=new File({styles:{paragraphStyles:[{id:"Normal",name:"Normal",next:"Normal",quickFormat:!1,run:{size:Math.floor(Number(ar.textFont.size.replace("pt",""))*2),font:ar.textFont.family},paragraph:{spacing:{line:Math.floor(Number(ar.textFont.spacing.replace("%",""))*2.4)}}},{id:"Heading3",name:"Heading 3",basedOn:"Normal",next:"Normal",quickFormat:!0,run:{size:Math.floor(Number(ar.titleFont.size.replace("pt",""))*2),font:ar.titleFont.family,bold:!1},paragraph:{spacing:{line:Math.floor(Number(ar.titleFont.spacing.replace("%",""))*2.4)}}}]},sections:[{headers:{default:void 0},properties:{page:{size:{width:`${parseFloat(ar.page.width)}cm`,height:`${parseFloat(ar.page.height)}cm`},margin:{top:`${parseFloat(ar.page.margins[0])}cm`,right:`${parseFloat(ar.page.margins[1])}cm`,bottom:`${parseFloat(ar.page.margins[2])}cm`,left:`${parseFloat(ar.page.margins[3])}cm`}}},children:ur}]});return{encodedBook:"",mimetype:mimetype$2,extension:extension$2,blob:Packer.toBlob(hr)}},docx=Object.freeze(Object.defineProperty({__proto__:null,encode:encode$2,extension:extension$2,mimetype:mimetype$2},Symbol.toStringTag,{value:"Module"})),mimetype$1="text/html",extension$1="html",template=(lr,or,ar,cr,ur)=>`<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width,initial-scale=1'>
  ${or!=null?`<meta name="author" content="${or}">`:""}

  ${lr!=null?`<title>${lr}</title>`:""}
  <style>
    body { margin: 30px calc(37vw - 100px); }
    body, html { font-family: ${ur.textFont.family}; font-size: ${ur.textFont.size};}
    h1 { text-align: center;}
    .text { margin-bottom: 5rem; text-align: justify;}
    .text > div.space  { margin: 6px 0; line-height: ${ur.textFont.spacing};  }
    h2 {
      page-break-before: always; page-break-after: never; padding-top: 1rem;
      font-family: ${ur.titleFont.family}; font-size: ${ur.titleFont.size}; line-height: ${ur.titleFont.spacing};
    }
  </style>
</head>
<body>
<p style="display:none">
${ar}
</p>

${lr!=null?`<h1>${lr}</h1>`:""}
${cr}
</body>
</html>`,renderer=(lr,or)=>({html:ar=>ar,paragraph:ar=>`${ar}<br><div class="space"></div>
`,strong:ar=>`<b>${ar}</b>`,em:ar=>`<i>${ar}</i>`,codespan:()=>"",code:()=>"",br:()=>'<br><div class="space"></div>',link:(ar,cr,ur)=>{const hr=ar.replace("#","").trim(),fr=or.renameAnchor({key:hr,book:lr}),dr=lr.index.keys[hr],pr=dr===void 0?void 0:lr.index.chapters[dr];return`<a href="#${fr}">${or.renameLink({book:lr,text:ur.trim(),chapter:pr,title:pr==null?void 0:pr.title,key:pr==null?void 0:pr.key})}</a>`}}),encode$1=lr=>{const or=bookify(lr),ar=sanitizeProperties(or.index.properties);let cr="",ur="";for(const[dr,{content:pr}]of chaptersOf(or)){if(dr.flags.includes("noexport"))continue;const{renamedKey:mr,renamedTitle:gr}=renameKeyAndTitle(ar,or,dr);cr+=`  <a href="#${mr}">${gr}</a>
`,ar.titleStyle=="inline"?ur+=`
<div class="text" for="${mr}"><span class="chapter title" id="${mr}">${gr}</span>
${encodeToHTML(pr,renderer(or,ar)).trim()}
<div><br></div><div><br></div></div>
`:(ur+=`

<h2 class="chapter title" id="${mr}">${gr}</h2>
`,ur+=`
<div class="text" for="${mr}">
${encodeToHTML(pr,renderer(or,ar)).trim()}
<div><br></div><div><br></div></div>
`)}const hr=document.createElement("p");return hr.innerHTML=ur,ur=hr.innerHTML,{encodedBook:template(or.index.properties.title??or.index.title,or.index.properties.author,cr,ur,ar),mimetype:mimetype$1,extension:extension$1}},html=Object.freeze(Object.defineProperty({__proto__:null,encode:encode$1,extension:extension$1,mimetype:mimetype$1},Symbol.toStringTag,{value:"Module"})),mimetype="text/json",extension="json",decode=lr=>{const{text:or,index:ar,content:cr}=JSON.parse(lr);return or},encode=lr=>{const{text:or,index:ar,content:cr}=bookify(lr);return{encodedBook:JSON.stringify({text:or,index:ar,content:cr},null,2),mimetype,extension}},json=Object.freeze(Object.defineProperty({__proto__:null,decode,encode,extension,mimetype},Symbol.toStringTag,{value:"Module"})),e$1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,t$3=Object.keys,n$2=Array.isArray;function r$1(lr,or){return typeof or!="object"||t$3(or).forEach(function(ar){lr[ar]=or[ar]}),lr}typeof Promise>"u"||e$1.Promise||(e$1.Promise=Promise);const s$1=Object.getPrototypeOf,i$1={}.hasOwnProperty;function o$3(lr,or){return i$1.call(lr,or)}function a(lr,or){typeof or=="function"&&(or=or(s$1(lr))),(typeof Reflect>"u"?t$3:Reflect.ownKeys)(or).forEach(ar=>{l$2(lr,ar,or[ar])})}const u=Object.defineProperty;function l$2(lr,or,ar,cr){u(lr,or,r$1(ar&&o$3(ar,"get")&&typeof ar.get=="function"?{get:ar.get,set:ar.set,configurable:!0}:{value:ar,configurable:!0,writable:!0},cr))}function c(lr){return{from:function(or){return lr.prototype=Object.create(or.prototype),l$2(lr.prototype,"constructor",lr),{extend:a.bind(null,lr.prototype)}}}}const h=Object.getOwnPropertyDescriptor;function d(lr,or){let ar;return h(lr,or)||(ar=s$1(lr))&&d(ar,or)}const f=[].slice;function p(lr,or,ar){return f.call(lr,or,ar)}function y(lr,or){return or(lr)}function m(lr){if(!lr)throw new Error("Assertion Failed")}function v(lr){e$1.setImmediate?setImmediate(lr):setTimeout(lr,0)}function g(lr,or){return lr.reduce((ar,cr,ur)=>{var hr=or(cr,ur);return hr&&(ar[hr[0]]=hr[1]),ar},{})}function b(lr,or){if(o$3(lr,or))return lr[or];if(!or)return lr;if(typeof or!="string"){for(var ar=[],cr=0,ur=or.length;cr<ur;++cr){var hr=b(lr,or[cr]);ar.push(hr)}return ar}var fr=or.indexOf(".");if(fr!==-1){var dr=lr[or.substr(0,fr)];return dr===void 0?void 0:b(dr,or.substr(fr+1))}}function _(lr,or,ar){if(lr&&or!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(lr)))if(typeof or!="string"&&"length"in or){m(typeof ar!="string"&&"length"in ar);for(var cr=0,ur=or.length;cr<ur;++cr)_(lr,or[cr],ar[cr])}else{var hr=or.indexOf(".");if(hr!==-1){var fr=or.substr(0,hr),dr=or.substr(hr+1);if(dr==="")ar===void 0?n$2(lr)&&!isNaN(parseInt(fr))?lr.splice(fr,1):delete lr[fr]:lr[fr]=ar;else{var pr=lr[fr];pr&&o$3(lr,fr)||(pr=lr[fr]={}),_(pr,dr,ar)}}else ar===void 0?n$2(lr)&&!isNaN(parseInt(or))?lr.splice(or,1):delete lr[or]:lr[or]=ar}}function w(lr){var or={};for(var ar in lr)o$3(lr,ar)&&(or[ar]=lr[ar]);return or}const x=[].concat;function k(lr){return x.apply([],lr)}const E="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(k([8,16,32,64].map(lr=>["Int","Uint","Float"].map(or=>or+lr+"Array")))).filter(lr=>e$1[lr]),P=E.map(lr=>e$1[lr]);g(E,lr=>[lr,!0]);let K=null;function O(lr){K=typeof WeakMap<"u"&&new WeakMap;const or=S(lr);return K=null,or}function S(lr){if(!lr||typeof lr!="object")return lr;let or=K&&K.get(lr);if(or)return or;if(n$2(lr)){or=[],K&&K.set(lr,or);for(var ar=0,cr=lr.length;ar<cr;++ar)or.push(S(lr[ar]))}else if(P.indexOf(lr.constructor)>=0)or=lr;else{const hr=s$1(lr);for(var ur in or=hr===Object.prototype?{}:Object.create(hr),K&&K.set(lr,or),lr)o$3(lr,ur)&&(or[ur]=S(lr[ur]))}return or}const{toString:A}={};function C(lr){return A.call(lr).slice(8,-1)}const j=typeof Symbol<"u"?Symbol.iterator:"@@iterator",D=typeof j=="symbol"?function(lr){var or;return lr!=null&&(or=lr[j])&&or.apply(lr)}:function(){return null},I={};function B(lr){var or,ar,cr,ur;if(arguments.length===1){if(n$2(lr))return lr.slice();if(this===I&&typeof lr=="string")return[lr];if(ur=D(lr)){for(ar=[];!(cr=ur.next()).done;)ar.push(cr.value);return ar}if(lr==null)return[lr];if(typeof(or=lr.length)=="number"){for(ar=new Array(or);or--;)ar[or]=lr[or];return ar}return[lr]}for(or=arguments.length,ar=new Array(or);or--;)ar[or]=arguments[or];return ar}const T=typeof Symbol<"u"?lr=>lr[Symbol.toStringTag]==="AsyncFunction":()=>!1;var R=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function F(lr,or){R=lr,M=or}var M=()=>!0;const N=!new Error("").stack;function q(){if(N)try{throw q.arguments,new Error}catch(lr){return lr}return new Error}function $(lr,or){var ar=lr.stack;return ar?(or=or||0,ar.indexOf(lr.name)===0&&(or+=(lr.name+lr.message).split(`
`).length),ar.split(`
`).slice(or).filter(M).map(cr=>`
`+cr).join("")):""}var U=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],L=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(U),V={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function W(lr,or){this._e=q(),this.name=lr,this.message=or}function Y(lr,or){return lr+". Errors: "+Object.keys(or).map(ar=>or[ar].toString()).filter((ar,cr,ur)=>ur.indexOf(ar)===cr).join(`
`)}function z(lr,or,ar,cr){this._e=q(),this.failures=or,this.failedKeys=cr,this.successCount=ar,this.message=Y(lr,or)}function G(lr,or){this._e=q(),this.name="BulkError",this.failures=Object.keys(or).map(ar=>or[ar]),this.failuresByPos=or,this.message=Y(lr,or)}c(W).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+$(this._e,2))}},toString:function(){return this.name+": "+this.message}}),c(z).from(W),c(G).from(W);var H=L.reduce((lr,or)=>(lr[or]=or+"Error",lr),{});const Q=W;var X=L.reduce((lr,or)=>{var ar=or+"Error";function cr(ur,hr){this._e=q(),this.name=ar,ur?typeof ur=="string"?(this.message=`${ur}${hr?`
 `+hr:""}`,this.inner=hr||null):typeof ur=="object"&&(this.message=`${ur.name} ${ur.message}`,this.inner=ur):(this.message=V[or]||ar,this.inner=null)}return c(cr).from(Q),lr[or]=cr,lr},{});X.Syntax=SyntaxError,X.Type=TypeError,X.Range=RangeError;var J=U.reduce((lr,or)=>(lr[or+"Error"]=X[or],lr),{}),Z=L.reduce((lr,or)=>(["Syntax","Type","Range"].indexOf(or)===-1&&(lr[or+"Error"]=X[or]),lr),{});function ee(){}function te(lr){return lr}function ne(lr,or){return lr==null||lr===te?or:function(ar){return or(lr(ar))}}function re(lr,or){return function(){lr.apply(this,arguments),or.apply(this,arguments)}}function se(lr,or){return lr===ee?or:function(){var ar=lr.apply(this,arguments);ar!==void 0&&(arguments[0]=ar);var cr=this.onsuccess,ur=this.onerror;this.onsuccess=null,this.onerror=null;var hr=or.apply(this,arguments);return cr&&(this.onsuccess=this.onsuccess?re(cr,this.onsuccess):cr),ur&&(this.onerror=this.onerror?re(ur,this.onerror):ur),hr!==void 0?hr:ar}}function ie(lr,or){return lr===ee?or:function(){lr.apply(this,arguments);var ar=this.onsuccess,cr=this.onerror;this.onsuccess=this.onerror=null,or.apply(this,arguments),ar&&(this.onsuccess=this.onsuccess?re(ar,this.onsuccess):ar),cr&&(this.onerror=this.onerror?re(cr,this.onerror):cr)}}function oe(lr,or){return lr===ee?or:function(ar){var cr=lr.apply(this,arguments);r$1(ar,cr);var ur=this.onsuccess,hr=this.onerror;this.onsuccess=null,this.onerror=null;var fr=or.apply(this,arguments);return ur&&(this.onsuccess=this.onsuccess?re(ur,this.onsuccess):ur),hr&&(this.onerror=this.onerror?re(hr,this.onerror):hr),cr===void 0?fr===void 0?void 0:fr:r$1(cr,fr)}}function ae(lr,or){return lr===ee?or:function(){return or.apply(this,arguments)!==!1&&lr.apply(this,arguments)}}function ue(lr,or){return lr===ee?or:function(){var ar=lr.apply(this,arguments);if(ar&&typeof ar.then=="function"){for(var cr=this,ur=arguments.length,hr=new Array(ur);ur--;)hr[ur]=arguments[ur];return ar.then(function(){return or.apply(cr,hr)})}return or.apply(this,arguments)}}Z.ModifyError=z,Z.DexieError=W,Z.BulkError=G;var le={};const ce=100,[he,de,fe]=typeof Promise>"u"?[]:(()=>{let lr=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[lr,s$1(lr),lr];const or=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[or,s$1(or),lr]})(),pe=de&&de.then,ye=he&&he.constructor,me=!!fe;var ve=!1,ge=fe?()=>{fe.then($e)}:e$1.setImmediate?setImmediate.bind(null,$e):e$1.MutationObserver?()=>{var lr=document.createElement("div");new MutationObserver(()=>{$e(),lr=null}).observe(lr,{attributes:!0}),lr.setAttribute("i","1")}:()=>{setTimeout($e,0)},be=function(lr,or){Se.push([lr,or]),we&&(ge(),we=!1)},_e=!0,we=!0,xe=[],ke=[],Ee=null,Pe=te,Ke={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:dt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(lr=>{try{dt(lr[0],lr[1])}catch{}})}},Oe=Ke,Se=[],Ae=0,Ce=[];function je(lr){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ee,this._lib=!1;var or=this._PSD=Oe;if(R&&(this._stackHolder=q(),this._prev=null,this._numPrev=0),typeof lr!="function"){if(lr!==le)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Te(this,this._value))}this._state=null,this._value=null,++or.ref,Be(this,lr)}const De={get:function(){var lr=Oe,or=Xe;function ar(cr,ur){var hr=!lr.global&&(lr!==Oe||or!==Xe);const fr=hr&&!tt();var dr=new je((pr,mr)=>{Fe(this,new Ie(lt(cr,lr,hr,fr),lt(ur,lr,hr,fr),pr,mr,lr))});return R&&qe(dr,this),dr}return ar.prototype=le,ar},set:function(lr){l$2(this,"then",lr&&lr.prototype===le?De:{get:function(){return lr},set:De.set})}};function Ie(lr,or,ar,cr,ur){this.onFulfilled=typeof lr=="function"?lr:null,this.onRejected=typeof or=="function"?or:null,this.resolve=ar,this.reject=cr,this.psd=ur}function Be(lr,or){try{or(ar=>{if(lr._state===null){if(ar===lr)throw new TypeError("A promise cannot be resolved with itself.");var cr=lr._lib&&Ue();ar&&typeof ar.then=="function"?Be(lr,(ur,hr)=>{ar instanceof je?ar._then(ur,hr):ar.then(ur,hr)}):(lr._state=!0,lr._value=ar,Re(lr)),cr&&Le()}},Te.bind(null,lr))}catch(ar){Te(lr,ar)}}function Te(lr,or){if(ke.push(or),lr._state===null){var ar=lr._lib&&Ue();or=Pe(or),lr._state=!1,lr._value=or,R&&or!==null&&typeof or=="object"&&!or._promise&&function(cr,ur,hr){try{cr.apply(null,hr)}catch(fr){ur&&ur(fr)}}(()=>{var cr=d(or,"stack");or._promise=lr,l$2(or,"stack",{get:()=>ve?cr&&(cr.get?cr.get.apply(or):cr.value):lr.stack})}),function(cr){xe.some(ur=>ur._value===cr._value)||xe.push(cr)}(lr),Re(lr),ar&&Le()}}function Re(lr){var or=lr._listeners;lr._listeners=[];for(var ar=0,cr=or.length;ar<cr;++ar)Fe(lr,or[ar]);var ur=lr._PSD;--ur.ref||ur.finalize(),Ae===0&&(++Ae,be(()=>{--Ae==0&&Ve()},[]))}function Fe(lr,or){if(lr._state!==null){var ar=lr._state?or.onFulfilled:or.onRejected;if(ar===null)return(lr._state?or.resolve:or.reject)(lr._value);++or.psd.ref,++Ae,be(Me,[ar,lr,or])}else lr._listeners.push(or)}function Me(lr,or,ar){try{Ee=or;var cr,ur=or._value;or._state?cr=lr(ur):(ke.length&&(ke=[]),cr=lr(ur),ke.indexOf(ur)===-1&&function(hr){for(var fr=xe.length;fr;)if(xe[--fr]._value===hr._value)return void xe.splice(fr,1)}(or)),ar.resolve(cr)}catch(hr){ar.reject(hr)}finally{Ee=null,--Ae==0&&Ve(),--ar.psd.ref||ar.psd.finalize()}}function Ne(lr,or,ar){if(or.length===ar)return or;var cr="";if(lr._state===!1){var ur,hr,fr=lr._value;fr!=null?(ur=fr.name||"Error",hr=fr.message||fr,cr=$(fr,0)):(ur=fr,hr=""),or.push(ur+(hr?": "+hr:"")+cr)}return R&&((cr=$(lr._stackHolder,2))&&or.indexOf(cr)===-1&&or.push(cr),lr._prev&&Ne(lr._prev,or,ar)),or}function qe(lr,or){var ar=or?or._numPrev+1:0;ar<100&&(lr._prev=or,lr._numPrev=ar)}function $e(){Ue()&&Le()}function Ue(){var lr=_e;return _e=!1,we=!1,lr}function Le(){var lr,or,ar;do for(;Se.length>0;)for(lr=Se,Se=[],ar=lr.length,or=0;or<ar;++or){var cr=lr[or];cr[0].apply(null,cr[1])}while(Se.length>0);_e=!0,we=!0}function Ve(){var lr=xe;xe=[],lr.forEach(cr=>{cr._PSD.onunhandled.call(null,cr._value,cr)});for(var or=Ce.slice(0),ar=or.length;ar;)or[--ar]()}function We(lr){return new je(le,!1,lr)}function Ye(lr,or){var ar=Oe;return function(){var cr=Ue(),ur=Oe;try{return it$1(ar,!0),lr.apply(this,arguments)}catch(hr){or&&or(hr)}finally{it$1(ur,!1),cr&&Le()}}}a(je.prototype,{then:De,_then:function(lr,or){Fe(this,new Ie(null,null,lr,or,Oe))},catch:function(lr){if(arguments.length===1)return this.then(null,lr);var or=arguments[0],ar=arguments[1];return typeof or=="function"?this.then(null,cr=>cr instanceof or?ar(cr):We(cr)):this.then(null,cr=>cr&&cr.name===or?ar(cr):We(cr))},finally:function(lr){return this.then(or=>(lr(),or),or=>(lr(),We(or)))},stack:{get:function(){if(this._stack)return this._stack;try{ve=!0;var lr=Ne(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=lr),lr}finally{ve=!1}}},timeout:function(lr,or){return lr<1/0?new je((ar,cr)=>{var ur=setTimeout(()=>cr(new X.Timeout(or)),lr);this.then(ar,cr).finally(clearTimeout.bind(null,ur))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&l$2(je.prototype,Symbol.toStringTag,"Dexie.Promise"),Ke.env=ot(),a(je,{all:function(){var lr=B.apply(null,arguments).map(nt);return new je(function(or,ar){lr.length===0&&or([]);var cr=lr.length;lr.forEach((ur,hr)=>je.resolve(ur).then(fr=>{lr[hr]=fr,--cr||or(lr)},ar))})},resolve:lr=>{if(lr instanceof je)return lr;if(lr&&typeof lr.then=="function")return new je((ar,cr)=>{lr.then(ar,cr)});var or=new je(le,!0,lr);return qe(or,Ee),or},reject:We,race:function(){var lr=B.apply(null,arguments).map(nt);return new je((or,ar)=>{lr.map(cr=>je.resolve(cr).then(or,ar))})},PSD:{get:()=>Oe,set:lr=>Oe=lr},totalEchoes:{get:()=>Xe},newPSD:Ze,usePSD:at,scheduler:{get:()=>be,set:lr=>{be=lr}},rejectionMapper:{get:()=>Pe,set:lr=>{Pe=lr}},follow:(lr,or)=>new je((ar,cr)=>Ze((ur,hr)=>{var fr=Oe;fr.unhandleds=[],fr.onunhandled=hr,fr.finalize=re(function(){(function(dr){function pr(){dr(),Ce.splice(Ce.indexOf(pr),1)}Ce.push(pr),++Ae,be(()=>{--Ae==0&&Ve()},[])})(()=>{this.unhandleds.length===0?ur():hr(this.unhandleds[0])})},fr.finalize),lr()},or,ar,cr))}),ye&&(ye.allSettled&&l$2(je,"allSettled",function(){const lr=B.apply(null,arguments).map(nt);return new je(or=>{lr.length===0&&or([]);let ar=lr.length;const cr=new Array(ar);lr.forEach((ur,hr)=>je.resolve(ur).then(fr=>cr[hr]={status:"fulfilled",value:fr},fr=>cr[hr]={status:"rejected",reason:fr}).then(()=>--ar||or(cr)))})}),ye.any&&typeof AggregateError<"u"&&l$2(je,"any",function(){const lr=B.apply(null,arguments).map(nt);return new je((or,ar)=>{lr.length===0&&ar(new AggregateError([]));let cr=lr.length;const ur=new Array(cr);lr.forEach((hr,fr)=>je.resolve(hr).then(dr=>or(dr),dr=>{ur[fr]=dr,--cr||ar(new AggregateError(ur))}))})}));const ze={awaits:0,echoes:0,id:0};var Ge=0,He=[],Qe=0,Xe=0,Je=0;function Ze(lr,or,ar,cr){var ur=Oe,hr=Object.create(ur);hr.parent=ur,hr.ref=0,hr.global=!1,hr.id=++Je;var fr=Ke.env;hr.env=me?{Promise:je,PromiseProp:{value:je,configurable:!0,writable:!0},all:je.all,race:je.race,allSettled:je.allSettled,any:je.any,resolve:je.resolve,reject:je.reject,nthen:ct(fr.nthen,hr),gthen:ct(fr.gthen,hr)}:{},or&&r$1(hr,or),++ur.ref,hr.finalize=function(){--this.parent.ref||this.parent.finalize()};var dr=at(hr,lr,ar,cr);return hr.ref===0&&hr.finalize(),dr}function et(){return ze.id||(ze.id=++Ge),++ze.awaits,ze.echoes+=ce,ze.id}function tt(){return!!ze.awaits&&(--ze.awaits==0&&(ze.id=0),ze.echoes=ze.awaits*ce,!0)}function nt(lr){return ze.echoes&&lr&&lr.constructor===ye?(et(),lr.then(or=>(tt(),or),or=>(tt(),ft(or)))):lr}function rt(lr){++Xe,ze.echoes&&--ze.echoes!=0||(ze.echoes=ze.id=0),He.push(Oe),it$1(lr,!0)}function st(){var lr=He[He.length-1];He.pop(),it$1(lr,!1)}function it$1(lr,or){var ar=Oe;if((or?!ze.echoes||Qe++&&lr===Oe:!Qe||--Qe&&lr===Oe)||ut(or?rt.bind(null,lr):st),lr!==Oe&&(Oe=lr,ar===Ke&&(Ke.env=ot()),me)){var cr=Ke.env.Promise,ur=lr.env;de.then=ur.nthen,cr.prototype.then=ur.gthen,(ar.global||lr.global)&&(Object.defineProperty(e$1,"Promise",ur.PromiseProp),cr.all=ur.all,cr.race=ur.race,cr.resolve=ur.resolve,cr.reject=ur.reject,ur.allSettled&&(cr.allSettled=ur.allSettled),ur.any&&(cr.any=ur.any))}}function ot(){var lr=e$1.Promise;return me?{Promise:lr,PromiseProp:Object.getOwnPropertyDescriptor(e$1,"Promise"),all:lr.all,race:lr.race,allSettled:lr.allSettled,any:lr.any,resolve:lr.resolve,reject:lr.reject,nthen:de.then,gthen:lr.prototype.then}:{}}function at(lr,or,ar,cr,ur){var hr=Oe;try{return it$1(lr,!0),or(ar,cr,ur)}finally{it$1(hr,!1)}}function ut(lr){pe.call(he,lr)}function lt(lr,or,ar,cr){return typeof lr!="function"?lr:function(){var ur=Oe;ar&&et(),it$1(or,!0);try{return lr.apply(this,arguments)}finally{it$1(ur,!1),cr&&ut(tt)}}}function ct(lr,or){return function(ar,cr){return lr.call(this,lt(ar,or),lt(cr,or))}}(""+pe).indexOf("[native code]")===-1&&(et=tt=ee);const ht="unhandledrejection";function dt(lr,or){var ar;try{ar=or.onuncatched(lr)}catch{}if(ar!==!1)try{var cr,ur={promise:or,reason:lr};if(e$1.document&&document.createEvent?((cr=document.createEvent("Event")).initEvent(ht,!0,!0),r$1(cr,ur)):e$1.CustomEvent&&r$1(cr=new CustomEvent(ht,{detail:ur}),ur),cr&&e$1.dispatchEvent&&(dispatchEvent(cr),!e$1.PromiseRejectionEvent&&e$1.onunhandledrejection))try{e$1.onunhandledrejection(cr)}catch{}R&&cr&&!cr.defaultPrevented&&console.warn(`Unhandled rejection: ${lr.stack||lr}`)}catch{}}var ft=je.reject;function pt(lr,or,ar,cr){if(lr.idbdb&&(lr._state.openComplete||Oe.letThrough||lr._vip)){var ur=lr._createTransaction(or,ar,lr._dbSchema);try{ur.create(),lr._state.PR1398_maxLoop=3}catch(hr){return hr.name===H.InvalidState&&lr.isOpen()&&--lr._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),lr._close(),lr.open().then(()=>pt(lr,or,ar,cr))):ft(hr)}return ur._promise(or,(hr,fr)=>Ze(()=>(Oe.trans=ur,cr(hr,fr,ur)))).then(hr=>ur._completion.then(()=>hr))}if(lr._state.openComplete)return ft(new X.DatabaseClosed(lr._state.dbOpenError));if(!lr._state.isBeingOpened){if(!lr._options.autoOpen)return ft(new X.DatabaseClosed);lr.open().catch(ee)}return lr._state.dbReadyPromise.then(()=>pt(lr,or,ar,cr))}const yt="3.2.4",mt=String.fromCharCode(65535),vt=-1/0,gt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",bt="String expected.",_t=[],wt=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),xt=wt,kt=wt,Et=lr=>!/(dexie\.js|dexie\.min\.js)/.test(lr),Pt="__dbnames",Kt="readonly",Ot="readwrite";function St(lr,or){return lr?or?function(){return lr.apply(this,arguments)&&or.apply(this,arguments)}:lr:or}const At={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ct(lr){return typeof lr!="string"||/\./.test(lr)?or=>or:or=>(or[lr]===void 0&&lr in or&&delete(or=O(or))[lr],or)}class jt{_trans(or,ar,cr){const ur=this._tx||Oe.trans,hr=this.name;function fr(pr,mr,gr){if(!gr.schema[hr])throw new X.NotFound("Table "+hr+" not part of transaction");return ar(gr.idbtrans,gr)}const dr=Ue();try{return ur&&ur.db===this.db?ur===Oe.trans?ur._promise(or,fr,cr):Ze(()=>ur._promise(or,fr,cr),{trans:ur,transless:Oe.transless||Oe}):pt(this.db,or,[this.name],fr)}finally{dr&&Le()}}get(or,ar){return or&&or.constructor===Object?this.where(or).first(ar):this._trans("readonly",cr=>this.core.get({trans:cr,key:or}).then(ur=>this.hook.reading.fire(ur))).then(ar)}where(or){if(typeof or=="string")return new this.db.WhereClause(this,or);if(n$2(or))return new this.db.WhereClause(this,`[${or.join("+")}]`);const ar=t$3(or);if(ar.length===1)return this.where(ar[0]).equals(or[ar[0]]);const cr=this.schema.indexes.concat(this.schema.primKey).filter(mr=>mr.compound&&ar.every(gr=>mr.keyPath.indexOf(gr)>=0)&&mr.keyPath.every(gr=>ar.indexOf(gr)>=0))[0];if(cr&&this.db._maxKey!==mt)return this.where(cr.name).equals(cr.keyPath.map(mr=>or[mr]));!cr&&R&&console.warn(`The query ${JSON.stringify(or)} on ${this.name} would benefit of a compound index [${ar.join("+")}]`);const{idxByName:ur}=this.schema,hr=this.db._deps.indexedDB;function fr(mr,gr){try{return hr.cmp(mr,gr)===0}catch{return!1}}const[dr,pr]=ar.reduce(([mr,gr],yr)=>{const br=ur[yr],Or=or[yr];return[mr||br,mr||!br?St(gr,br&&br.multi?_r=>{const vr=b(_r,yr);return n$2(vr)&&vr.some(xr=>fr(Or,xr))}:_r=>fr(Or,b(_r,yr))):gr]},[null,null]);return dr?this.where(dr.name).equals(or[dr.keyPath]).filter(pr):cr?this.filter(pr):this.where(ar).equals("")}filter(or){return this.toCollection().and(or)}count(or){return this.toCollection().count(or)}offset(or){return this.toCollection().offset(or)}limit(or){return this.toCollection().limit(or)}each(or){return this.toCollection().each(or)}toArray(or){return this.toCollection().toArray(or)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(or){return new this.db.Collection(new this.db.WhereClause(this,n$2(or)?`[${or.join("+")}]`:or))}reverse(){return this.toCollection().reverse()}mapToClass(or){this.schema.mappedClass=or;const ar=cr=>{if(!cr)return cr;const ur=Object.create(or.prototype);for(var hr in cr)if(o$3(cr,hr))try{ur[hr]=cr[hr]}catch{}return ur};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=ar,this.hook("reading",ar),or}defineClass(){return this.mapToClass(function(or){r$1(this,or)})}add(or,ar){const{auto:cr,keyPath:ur}=this.schema.primKey;let hr=or;return ur&&cr&&(hr=Ct(ur)(or)),this._trans("readwrite",fr=>this.core.mutate({trans:fr,type:"add",keys:ar!=null?[ar]:null,values:[hr]})).then(fr=>fr.numFailures?je.reject(fr.failures[0]):fr.lastResult).then(fr=>{if(ur)try{_(or,ur,fr)}catch{}return fr})}update(or,ar){if(typeof or!="object"||n$2(or))return this.where(":id").equals(or).modify(ar);{const cr=b(or,this.schema.primKey.keyPath);if(cr===void 0)return ft(new X.InvalidArgument("Given object does not contain its primary key"));try{typeof ar!="function"?t$3(ar).forEach(ur=>{_(or,ur,ar[ur])}):ar(or,{value:or,primKey:cr})}catch{}return this.where(":id").equals(cr).modify(ar)}}put(or,ar){const{auto:cr,keyPath:ur}=this.schema.primKey;let hr=or;return ur&&cr&&(hr=Ct(ur)(or)),this._trans("readwrite",fr=>this.core.mutate({trans:fr,type:"put",values:[hr],keys:ar!=null?[ar]:null})).then(fr=>fr.numFailures?je.reject(fr.failures[0]):fr.lastResult).then(fr=>{if(ur)try{_(or,ur,fr)}catch{}return fr})}delete(or){return this._trans("readwrite",ar=>this.core.mutate({trans:ar,type:"delete",keys:[or]})).then(ar=>ar.numFailures?je.reject(ar.failures[0]):void 0)}clear(){return this._trans("readwrite",or=>this.core.mutate({trans:or,type:"deleteRange",range:At})).then(or=>or.numFailures?je.reject(or.failures[0]):void 0)}bulkGet(or){return this._trans("readonly",ar=>this.core.getMany({keys:or,trans:ar}).then(cr=>cr.map(ur=>this.hook.reading.fire(ur))))}bulkAdd(or,ar,cr){const ur=Array.isArray(ar)?ar:void 0,hr=(cr=cr||(ur?void 0:ar))?cr.allKeys:void 0;return this._trans("readwrite",fr=>{const{auto:dr,keyPath:pr}=this.schema.primKey;if(pr&&ur)throw new X.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(ur&&ur.length!==or.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");const mr=or.length;let gr=pr&&dr?or.map(Ct(pr)):or;return this.core.mutate({trans:fr,type:"add",keys:ur,values:gr,wantResults:hr}).then(({numFailures:yr,results:br,lastResult:Or,failures:_r})=>{if(yr===0)return hr?br:Or;throw new G(`${this.name}.bulkAdd(): ${yr} of ${mr} operations failed`,_r)})})}bulkPut(or,ar,cr){const ur=Array.isArray(ar)?ar:void 0,hr=(cr=cr||(ur?void 0:ar))?cr.allKeys:void 0;return this._trans("readwrite",fr=>{const{auto:dr,keyPath:pr}=this.schema.primKey;if(pr&&ur)throw new X.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(ur&&ur.length!==or.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");const mr=or.length;let gr=pr&&dr?or.map(Ct(pr)):or;return this.core.mutate({trans:fr,type:"put",keys:ur,values:gr,wantResults:hr}).then(({numFailures:yr,results:br,lastResult:Or,failures:_r})=>{if(yr===0)return hr?br:Or;throw new G(`${this.name}.bulkPut(): ${yr} of ${mr} operations failed`,_r)})})}bulkDelete(or){const ar=or.length;return this._trans("readwrite",cr=>this.core.mutate({trans:cr,type:"delete",keys:or})).then(({numFailures:cr,lastResult:ur,failures:hr})=>{if(cr===0)return ur;throw new G(`${this.name}.bulkDelete(): ${cr} of ${ar} operations failed`,hr)})}}function Dt(lr){var or={},ar=function(fr,dr){if(dr){for(var pr=arguments.length,mr=new Array(pr-1);--pr;)mr[pr-1]=arguments[pr];return or[fr].subscribe.apply(null,mr),lr}if(typeof fr=="string")return or[fr]};ar.addEventType=hr;for(var cr=1,ur=arguments.length;cr<ur;++cr)hr(arguments[cr]);return ar;function hr(fr,dr,pr){if(typeof fr!="object"){var mr;dr||(dr=ae),pr||(pr=ee);var gr={subscribers:[],fire:pr,subscribe:function(yr){gr.subscribers.indexOf(yr)===-1&&(gr.subscribers.push(yr),gr.fire=dr(gr.fire,yr))},unsubscribe:function(yr){gr.subscribers=gr.subscribers.filter(function(br){return br!==yr}),gr.fire=gr.subscribers.reduce(dr,pr)}};return or[fr]=ar[fr]=gr,gr}t$3(mr=fr).forEach(function(yr){var br=mr[yr];if(n$2(br))hr(yr,mr[yr][0],mr[yr][1]);else{if(br!=="asap")throw new X.InvalidArgument("Invalid event config");var Or=hr(yr,te,function(){for(var _r=arguments.length,vr=new Array(_r);_r--;)vr[_r]=arguments[_r];Or.subscribers.forEach(function(xr){v(function(){xr.apply(null,vr)})})})}})}}function It(lr,or){return c(or).from({prototype:lr}),or}function Bt(lr,or){return!(lr.filter||lr.algorithm||lr.or)&&(or?lr.justLimit:!lr.replayFilter)}function Tt(lr,or){lr.filter=St(lr.filter,or)}function Rt(lr,or,ar){var cr=lr.replayFilter;lr.replayFilter=cr?()=>St(cr(),or()):or,lr.justLimit=ar&&!cr}function Ft(lr,or){if(lr.isPrimKey)return or.primaryKey;const ar=or.getIndexByKeyPath(lr.index);if(!ar)throw new X.Schema("KeyPath "+lr.index+" on object store "+or.name+" is not indexed");return ar}function Mt(lr,or,ar){const cr=Ft(lr,or.schema);return or.openCursor({trans:ar,values:!lr.keysOnly,reverse:lr.dir==="prev",unique:!!lr.unique,query:{index:cr,range:lr.range}})}function Nt(lr,or,ar,cr){const ur=lr.replayFilter?St(lr.filter,lr.replayFilter()):lr.filter;if(lr.or){const hr={},fr=(dr,pr,mr)=>{if(!ur||ur(pr,mr,br=>pr.stop(br),br=>pr.fail(br))){var gr=pr.primaryKey,yr=""+gr;yr==="[object ArrayBuffer]"&&(yr=""+new Uint8Array(gr)),o$3(hr,yr)||(hr[yr]=!0,or(dr,pr,mr))}};return Promise.all([lr.or._iterate(fr,ar),qt(Mt(lr,cr,ar),lr.algorithm,fr,!lr.keysOnly&&lr.valueMapper)])}return qt(Mt(lr,cr,ar),St(lr.algorithm,ur),or,!lr.keysOnly&&lr.valueMapper)}function qt(lr,or,ar,cr){var ur=Ye(cr?(hr,fr,dr)=>ar(cr(hr),fr,dr):ar);return lr.then(hr=>{if(hr)return hr.start(()=>{var fr=()=>hr.continue();or&&!or(hr,dr=>fr=dr,dr=>{hr.stop(dr),fr=ee},dr=>{hr.fail(dr),fr=ee})||ur(hr.value,hr,dr=>fr=dr),fr()})})}function $t(lr,or){try{const ar=Ut(lr),cr=Ut(or);if(ar!==cr)return ar==="Array"?1:cr==="Array"?-1:ar==="binary"?1:cr==="binary"?-1:ar==="string"?1:cr==="string"?-1:ar==="Date"?1:cr!=="Date"?NaN:-1;switch(ar){case"number":case"Date":case"string":return lr>or?1:lr<or?-1:0;case"binary":return function(ur,hr){const fr=ur.length,dr=hr.length,pr=fr<dr?fr:dr;for(let mr=0;mr<pr;++mr)if(ur[mr]!==hr[mr])return ur[mr]<hr[mr]?-1:1;return fr===dr?0:fr<dr?-1:1}(Lt(lr),Lt(or));case"Array":return function(ur,hr){const fr=ur.length,dr=hr.length,pr=fr<dr?fr:dr;for(let mr=0;mr<pr;++mr){const gr=$t(ur[mr],hr[mr]);if(gr!==0)return gr}return fr===dr?0:fr<dr?-1:1}(lr,or)}}catch{}return NaN}function Ut(lr){const or=typeof lr;if(or!=="object")return or;if(ArrayBuffer.isView(lr))return"binary";const ar=C(lr);return ar==="ArrayBuffer"?"binary":ar}function Lt(lr){return lr instanceof Uint8Array?lr:ArrayBuffer.isView(lr)?new Uint8Array(lr.buffer,lr.byteOffset,lr.byteLength):new Uint8Array(lr)}class Vt{_read(or,ar){var cr=this._ctx;return cr.error?cr.table._trans(null,ft.bind(null,cr.error)):cr.table._trans("readonly",or).then(ar)}_write(or){var ar=this._ctx;return ar.error?ar.table._trans(null,ft.bind(null,ar.error)):ar.table._trans("readwrite",or,"locked")}_addAlgorithm(or){var ar=this._ctx;ar.algorithm=St(ar.algorithm,or)}_iterate(or,ar){return Nt(this._ctx,or,ar,this._ctx.table.core)}clone(or){var ar=Object.create(this.constructor.prototype),cr=Object.create(this._ctx);return or&&r$1(cr,or),ar._ctx=cr,ar}raw(){return this._ctx.valueMapper=null,this}each(or){var ar=this._ctx;return this._read(cr=>Nt(ar,or,cr,ar.table.core))}count(or){return this._read(ar=>{const cr=this._ctx,ur=cr.table.core;if(Bt(cr,!0))return ur.count({trans:ar,query:{index:Ft(cr,ur.schema),range:cr.range}}).then(fr=>Math.min(fr,cr.limit));var hr=0;return Nt(cr,()=>(++hr,!1),ar,ur).then(()=>hr)}).then(or)}sortBy(or,ar){const cr=or.split(".").reverse(),ur=cr[0],hr=cr.length-1;function fr(mr,gr){return gr?fr(mr[cr[gr]],gr-1):mr[ur]}var dr=this._ctx.dir==="next"?1:-1;function pr(mr,gr){var yr=fr(mr,hr),br=fr(gr,hr);return yr<br?-dr:yr>br?dr:0}return this.toArray(function(mr){return mr.sort(pr)}).then(ar)}toArray(or){return this._read(ar=>{var cr=this._ctx;if(cr.dir==="next"&&Bt(cr,!0)&&cr.limit>0){const{valueMapper:ur}=cr,hr=Ft(cr,cr.table.core.schema);return cr.table.core.query({trans:ar,limit:cr.limit,values:!0,query:{index:hr,range:cr.range}}).then(({result:fr})=>ur?fr.map(ur):fr)}{const ur=[];return Nt(cr,hr=>ur.push(hr),ar,cr.table.core).then(()=>ur)}},or)}offset(or){var ar=this._ctx;return or<=0||(ar.offset+=or,Bt(ar)?Rt(ar,()=>{var cr=or;return(ur,hr)=>cr===0||(cr===1?(--cr,!1):(hr(()=>{ur.advance(cr),cr=0}),!1))}):Rt(ar,()=>{var cr=or;return()=>--cr<0})),this}limit(or){return this._ctx.limit=Math.min(this._ctx.limit,or),Rt(this._ctx,()=>{var ar=or;return function(cr,ur,hr){return--ar<=0&&ur(hr),ar>=0}},!0),this}until(or,ar){return Tt(this._ctx,function(cr,ur,hr){return!or(cr.value)||(ur(hr),ar)}),this}first(or){return this.limit(1).toArray(function(ar){return ar[0]}).then(or)}last(or){return this.reverse().first(or)}filter(or){var ar,cr;return Tt(this._ctx,function(ur){return or(ur.value)}),ar=this._ctx,cr=or,ar.isMatch=St(ar.isMatch,cr),this}and(or){return this.filter(or)}or(or){return new this.db.WhereClause(this._ctx.table,or,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(or){var ar=this._ctx;return ar.keysOnly=!ar.isMatch,this.each(function(cr,ur){or(ur.key,ur)})}eachUniqueKey(or){return this._ctx.unique="unique",this.eachKey(or)}eachPrimaryKey(or){var ar=this._ctx;return ar.keysOnly=!ar.isMatch,this.each(function(cr,ur){or(ur.primaryKey,ur)})}keys(or){var ar=this._ctx;ar.keysOnly=!ar.isMatch;var cr=[];return this.each(function(ur,hr){cr.push(hr.key)}).then(function(){return cr}).then(or)}primaryKeys(or){var ar=this._ctx;if(ar.dir==="next"&&Bt(ar,!0)&&ar.limit>0)return this._read(ur=>{var hr=Ft(ar,ar.table.core.schema);return ar.table.core.query({trans:ur,values:!1,limit:ar.limit,query:{index:hr,range:ar.range}})}).then(({result:ur})=>ur).then(or);ar.keysOnly=!ar.isMatch;var cr=[];return this.each(function(ur,hr){cr.push(hr.primaryKey)}).then(function(){return cr}).then(or)}uniqueKeys(or){return this._ctx.unique="unique",this.keys(or)}firstKey(or){return this.limit(1).keys(function(ar){return ar[0]}).then(or)}lastKey(or){return this.reverse().firstKey(or)}distinct(){var or=this._ctx,ar=or.index&&or.table.schema.idxByName[or.index];if(!ar||!ar.multi)return this;var cr={};return Tt(this._ctx,function(ur){var hr=ur.primaryKey.toString(),fr=o$3(cr,hr);return cr[hr]=!0,!fr}),this}modify(or){var ar=this._ctx;return this._write(cr=>{var ur;if(typeof or=="function")ur=or;else{var hr=t$3(or),fr=hr.length;ur=function(vr){for(var xr=!1,wr=0;wr<fr;++wr){var kr=hr[wr],Cr=or[kr];b(vr,kr)!==Cr&&(_(vr,kr,Cr),xr=!0)}return xr}}const dr=ar.table.core,{outbound:pr,extractKey:mr}=dr.schema.primaryKey,gr=this.db._options.modifyChunkSize||200,yr=[];let br=0;const Or=[],_r=(vr,xr)=>{const{failures:wr,numFailures:kr}=xr;br+=vr-kr;for(let Cr of t$3(wr))yr.push(wr[Cr])};return this.clone().primaryKeys().then(vr=>{const xr=wr=>{const kr=Math.min(gr,vr.length-wr);return dr.getMany({trans:cr,keys:vr.slice(wr,wr+kr),cache:"immutable"}).then(Cr=>{const $r=[],Nr=[],Br=pr?[]:null,Fr=[];for(let Rr=0;Rr<kr;++Rr){const Gr=Cr[Rr],qr={value:O(Gr),primKey:vr[wr+Rr]};ur.call(qr,qr.value,qr)!==!1&&(qr.value==null?Fr.push(vr[wr+Rr]):pr||$t(mr(Gr),mr(qr.value))===0?(Nr.push(qr.value),pr&&Br.push(vr[wr+Rr])):(Fr.push(vr[wr+Rr]),$r.push(qr.value)))}const Vr=Bt(ar)&&ar.limit===1/0&&(typeof or!="function"||or===Wt)&&{index:ar.index,range:ar.range};return Promise.resolve($r.length>0&&dr.mutate({trans:cr,type:"add",values:$r}).then(Rr=>{for(let Gr in Rr.failures)Fr.splice(parseInt(Gr),1);_r($r.length,Rr)})).then(()=>(Nr.length>0||Vr&&typeof or=="object")&&dr.mutate({trans:cr,type:"put",keys:Br,values:Nr,criteria:Vr,changeSpec:typeof or!="function"&&or}).then(Rr=>_r(Nr.length,Rr))).then(()=>(Fr.length>0||Vr&&or===Wt)&&dr.mutate({trans:cr,type:"delete",keys:Fr,criteria:Vr}).then(Rr=>_r(Fr.length,Rr))).then(()=>vr.length>wr+kr&&xr(wr+gr))})};return xr(0).then(()=>{if(yr.length>0)throw new z("Error modifying one or more objects",yr,br,Or);return vr.length})})})}delete(){var or=this._ctx,ar=or.range;return Bt(or)&&(or.isPrimKey&&!kt||ar.type===3)?this._write(cr=>{const{primaryKey:ur}=or.table.core.schema,hr=ar;return or.table.core.count({trans:cr,query:{index:ur,range:hr}}).then(fr=>or.table.core.mutate({trans:cr,type:"deleteRange",range:hr}).then(({failures:dr,lastResult:pr,results:mr,numFailures:gr})=>{if(gr)throw new z("Could not delete some values",Object.keys(dr).map(yr=>dr[yr]),fr-gr);return fr-gr}))}):this.modify(Wt)}}const Wt=(lr,or)=>or.value=null;function Yt(lr,or){return lr<or?-1:lr===or?0:1}function zt(lr,or){return lr>or?-1:lr===or?0:1}function Gt(lr,or,ar){var cr=lr instanceof en$1?new lr.Collection(lr):lr;return cr._ctx.error=ar?new ar(or):new TypeError(or),cr}function Ht(lr){return new lr.Collection(lr,()=>Zt("")).limit(0)}function Qt(lr,or,ar,cr,ur,hr){for(var fr=Math.min(lr.length,cr.length),dr=-1,pr=0;pr<fr;++pr){var mr=or[pr];if(mr!==cr[pr])return ur(lr[pr],ar[pr])<0?lr.substr(0,pr)+ar[pr]+ar.substr(pr+1):ur(lr[pr],cr[pr])<0?lr.substr(0,pr)+cr[pr]+ar.substr(pr+1):dr>=0?lr.substr(0,dr)+or[dr]+ar.substr(dr+1):null;ur(lr[pr],mr)<0&&(dr=pr)}return fr<cr.length&&hr==="next"?lr+ar.substr(lr.length):fr<lr.length&&hr==="prev"?lr.substr(0,ar.length):dr<0?null:lr.substr(0,dr)+cr[dr]+ar.substr(dr+1)}function Xt(lr,or,ar,cr){var ur,hr,fr,dr,pr,mr,gr,yr=ar.length;if(!ar.every(vr=>typeof vr=="string"))return Gt(lr,bt);function br(vr){ur=function(wr){return wr==="next"?kr=>kr.toUpperCase():kr=>kr.toLowerCase()}(vr),hr=function(wr){return wr==="next"?kr=>kr.toLowerCase():kr=>kr.toUpperCase()}(vr),fr=vr==="next"?Yt:zt;var xr=ar.map(function(wr){return{lower:hr(wr),upper:ur(wr)}}).sort(function(wr,kr){return fr(wr.lower,kr.lower)});dr=xr.map(function(wr){return wr.upper}),pr=xr.map(function(wr){return wr.lower}),mr=vr,gr=vr==="next"?"":cr}br("next");var Or=new lr.Collection(lr,()=>Jt(dr[0],pr[yr-1]+cr));Or._ondirectionchange=function(vr){br(vr)};var _r=0;return Or._addAlgorithm(function(vr,xr,wr){var kr=vr.key;if(typeof kr!="string")return!1;var Cr=hr(kr);if(or(Cr,pr,_r))return!0;for(var $r=null,Nr=_r;Nr<yr;++Nr){var Br=Qt(kr,Cr,dr[Nr],pr[Nr],fr,mr);Br===null&&$r===null?_r=Nr+1:($r===null||fr($r,Br)>0)&&($r=Br)}return xr($r!==null?function(){vr.continue($r+gr)}:wr),!1}),Or}function Jt(lr,or,ar,cr){return{type:2,lower:lr,upper:or,lowerOpen:ar,upperOpen:cr}}function Zt(lr){return{type:1,lower:lr,upper:lr}}let en$1=class{get Collection(){return this._ctx.table.db.Collection}between(or,ar,cr,ur){cr=cr!==!1,ur=ur===!0;try{return this._cmp(or,ar)>0||this._cmp(or,ar)===0&&(cr||ur)&&(!cr||!ur)?Ht(this):new this.Collection(this,()=>Jt(or,ar,!cr,!ur))}catch{return Gt(this,gt)}}equals(or){return or==null?Gt(this,gt):new this.Collection(this,()=>Zt(or))}above(or){return or==null?Gt(this,gt):new this.Collection(this,()=>Jt(or,void 0,!0))}aboveOrEqual(or){return or==null?Gt(this,gt):new this.Collection(this,()=>Jt(or,void 0,!1))}below(or){return or==null?Gt(this,gt):new this.Collection(this,()=>Jt(void 0,or,!1,!0))}belowOrEqual(or){return or==null?Gt(this,gt):new this.Collection(this,()=>Jt(void 0,or))}startsWith(or){return typeof or!="string"?Gt(this,bt):this.between(or,or+mt,!0,!0)}startsWithIgnoreCase(or){return or===""?this.startsWith(or):Xt(this,(ar,cr)=>ar.indexOf(cr[0])===0,[or],mt)}equalsIgnoreCase(or){return Xt(this,(ar,cr)=>ar===cr[0],[or],"")}anyOfIgnoreCase(){var or=B.apply(I,arguments);return or.length===0?Ht(this):Xt(this,(ar,cr)=>cr.indexOf(ar)!==-1,or,"")}startsWithAnyOfIgnoreCase(){var or=B.apply(I,arguments);return or.length===0?Ht(this):Xt(this,(ar,cr)=>cr.some(ur=>ar.indexOf(ur)===0),or,mt)}anyOf(){const or=B.apply(I,arguments);let ar=this._cmp;try{or.sort(ar)}catch{return Gt(this,gt)}if(or.length===0)return Ht(this);const cr=new this.Collection(this,()=>Jt(or[0],or[or.length-1]));cr._ondirectionchange=hr=>{ar=hr==="next"?this._ascending:this._descending,or.sort(ar)};let ur=0;return cr._addAlgorithm((hr,fr,dr)=>{const pr=hr.key;for(;ar(pr,or[ur])>0;)if(++ur,ur===or.length)return fr(dr),!1;return ar(pr,or[ur])===0||(fr(()=>{hr.continue(or[ur])}),!1)}),cr}notEqual(or){return this.inAnyRange([[vt,or],[or,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const or=B.apply(I,arguments);if(or.length===0)return new this.Collection(this);try{or.sort(this._ascending)}catch{return Gt(this,gt)}const ar=or.reduce((cr,ur)=>cr?cr.concat([[cr[cr.length-1][1],ur]]):[[vt,ur]],null);return ar.push([or[or.length-1],this.db._maxKey]),this.inAnyRange(ar,{includeLowers:!1,includeUppers:!1})}inAnyRange(or,ar){const cr=this._cmp,ur=this._ascending,hr=this._descending,fr=this._min,dr=this._max;if(or.length===0)return Ht(this);if(!or.every(kr=>kr[0]!==void 0&&kr[1]!==void 0&&ur(kr[0],kr[1])<=0))return Gt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",X.InvalidArgument);const pr=!ar||ar.includeLowers!==!1,mr=ar&&ar.includeUppers===!0;let gr,yr=ur;function br(kr,Cr){return yr(kr[0],Cr[0])}try{gr=or.reduce(function(kr,Cr){let $r=0,Nr=kr.length;for(;$r<Nr;++$r){const Br=kr[$r];if(cr(Cr[0],Br[1])<0&&cr(Cr[1],Br[0])>0){Br[0]=fr(Br[0],Cr[0]),Br[1]=dr(Br[1],Cr[1]);break}}return $r===Nr&&kr.push(Cr),kr},[]),gr.sort(br)}catch{return Gt(this,gt)}let Or=0;const _r=mr?kr=>ur(kr,gr[Or][1])>0:kr=>ur(kr,gr[Or][1])>=0,vr=pr?kr=>hr(kr,gr[Or][0])>0:kr=>hr(kr,gr[Or][0])>=0;let xr=_r;const wr=new this.Collection(this,()=>Jt(gr[0][0],gr[gr.length-1][1],!pr,!mr));return wr._ondirectionchange=kr=>{kr==="next"?(xr=_r,yr=ur):(xr=vr,yr=hr),gr.sort(br)},wr._addAlgorithm((kr,Cr,$r)=>{for(var Nr=kr.key;xr(Nr);)if(++Or,Or===gr.length)return Cr($r),!1;return!!function(Br){return!_r(Br)&&!vr(Br)}(Nr)||(this._cmp(Nr,gr[Or][1])===0||this._cmp(Nr,gr[Or][0])===0||Cr(()=>{yr===ur?kr.continue(gr[Or][0]):kr.continue(gr[Or][1])}),!1)}),wr}startsWithAnyOf(){const or=B.apply(I,arguments);return or.every(ar=>typeof ar=="string")?or.length===0?Ht(this):this.inAnyRange(or.map(ar=>[ar,ar+mt])):Gt(this,"startsWithAnyOf() only works with strings")}};function tn(lr){return Ye(function(or){return nn(or),lr(or.target.error),!1})}function nn(lr){lr.stopPropagation&&lr.stopPropagation(),lr.preventDefault&&lr.preventDefault()}const rn="storagemutated",sn="x-storagemutated-1",on=Dt(null,rn);class an{_lock(){return m(!Oe.global),++this._reculock,this._reculock!==1||Oe.global||(Oe.lockOwnerFor=this),this}_unlock(){if(m(!Oe.global),--this._reculock==0)for(Oe.global||(Oe.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var or=this._blockedFuncs.shift();try{at(or[1],or[0])}catch{}}return this}_locked(){return this._reculock&&Oe.lockOwnerFor!==this}create(or){if(!this.mode)return this;const ar=this.db.idbdb,cr=this.db._state.dbOpenError;if(m(!this.idbtrans),!or&&!ar)switch(cr&&cr.name){case"DatabaseClosedError":throw new X.DatabaseClosed(cr);case"MissingAPIError":throw new X.MissingAPI(cr.message,cr);default:throw new X.OpenFailed(cr)}if(!this.active)throw new X.TransactionInactive;return m(this._completion._state===null),(or=this.idbtrans=or||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):ar.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ye(ur=>{nn(ur),this._reject(or.error)}),or.onabort=Ye(ur=>{nn(ur),this.active&&this._reject(new X.Abort(or.error)),this.active=!1,this.on("abort").fire(ur)}),or.oncomplete=Ye(()=>{this.active=!1,this._resolve(),"mutatedParts"in or&&on.storagemutated.fire(or.mutatedParts)}),this}_promise(or,ar,cr){if(or==="readwrite"&&this.mode!=="readwrite")return ft(new X.ReadOnly("Transaction is readonly"));if(!this.active)return ft(new X.TransactionInactive);if(this._locked())return new je((hr,fr)=>{this._blockedFuncs.push([()=>{this._promise(or,ar,cr).then(hr,fr)},Oe])});if(cr)return Ze(()=>{var hr=new je((fr,dr)=>{this._lock();const pr=ar(fr,dr,this);pr&&pr.then&&pr.then(fr,dr)});return hr.finally(()=>this._unlock()),hr._lib=!0,hr});var ur=new je((hr,fr)=>{var dr=ar(hr,fr,this);dr&&dr.then&&dr.then(hr,fr)});return ur._lib=!0,ur}_root(){return this.parent?this.parent._root():this}waitFor(or){var ar=this._root();const cr=je.resolve(or);if(ar._waitingFor)ar._waitingFor=ar._waitingFor.then(()=>cr);else{ar._waitingFor=cr,ar._waitingQueue=[];var ur=ar.idbtrans.objectStore(ar.storeNames[0]);(function fr(){for(++ar._spinCount;ar._waitingQueue.length;)ar._waitingQueue.shift()();ar._waitingFor&&(ur.get(-1/0).onsuccess=fr)})()}var hr=ar._waitingFor;return new je((fr,dr)=>{cr.then(pr=>ar._waitingQueue.push(Ye(fr.bind(null,pr))),pr=>ar._waitingQueue.push(Ye(dr.bind(null,pr)))).finally(()=>{ar._waitingFor===hr&&(ar._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new X.Abort))}table(or){const ar=this._memoizedTables||(this._memoizedTables={});if(o$3(ar,or))return ar[or];const cr=this.schema[or];if(!cr)throw new X.NotFound("Table "+or+" not part of transaction");const ur=new this.db.Table(or,cr,this);return ur.core=this.db.core.table(or),ar[or]=ur,ur}}function un(lr,or,ar,cr,ur,hr,fr){return{name:lr,keyPath:or,unique:ar,multi:cr,auto:ur,compound:hr,src:(ar&&!fr?"&":"")+(cr?"*":"")+(ur?"++":"")+ln(or)}}function ln(lr){return typeof lr=="string"?lr:lr?"["+[].join.call(lr,"+")+"]":""}function cn(lr,or,ar){return{name:lr,primKey:or,indexes:ar,mappedClass:null,idxByName:g(ar,cr=>[cr.name,cr])}}let hn=lr=>{try{return lr.only([[]]),hn=()=>[[]],[[]]}catch{return hn=()=>mt,mt}};function dn(lr){return lr==null?()=>{}:typeof lr=="string"?function(or){return or.split(".").length===1?cr=>cr[or]:cr=>b(cr,or)}(lr):or=>b(or,lr)}function fn(lr){return[].slice.call(lr)}let pn=0;function yn(lr){return lr==null?":id":typeof lr=="string"?lr:`[${lr.join("+")}]`}function mn(lr,or,ar){function cr(pr){if(pr.type===3)return null;if(pr.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:mr,upper:gr,lowerOpen:yr,upperOpen:br}=pr;return mr===void 0?gr===void 0?null:or.upperBound(gr,!!br):gr===void 0?or.lowerBound(mr,!!yr):or.bound(mr,gr,!!yr,!!br)}const{schema:ur,hasGetAll:hr}=function(pr,mr){const gr=fn(pr.objectStoreNames);return{schema:{name:pr.name,tables:gr.map(yr=>mr.objectStore(yr)).map(yr=>{const{keyPath:br,autoIncrement:Or}=yr,_r=n$2(br),vr=br==null,xr={},wr={name:yr.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:vr,compound:_r,keyPath:br,autoIncrement:Or,unique:!0,extractKey:dn(br)},indexes:fn(yr.indexNames).map(kr=>yr.index(kr)).map(kr=>{const{name:Cr,unique:$r,multiEntry:Nr,keyPath:Br}=kr,Fr={name:Cr,compound:n$2(Br),keyPath:Br,unique:$r,multiEntry:Nr,extractKey:dn(Br)};return xr[yn(Br)]=Fr,Fr}),getIndexByKeyPath:kr=>xr[yn(kr)]};return xr[":id"]=wr.primaryKey,br!=null&&(xr[yn(br)]=wr.primaryKey),wr})},hasGetAll:gr.length>0&&"getAll"in mr.objectStore(gr[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(lr,ar),fr=ur.tables.map(pr=>function(mr){const gr=mr.name;return{name:gr,schema:mr,mutate:function({trans:yr,type:br,keys:Or,values:_r,range:vr}){return new Promise((xr,wr)=>{xr=Ye(xr);const kr=yr.objectStore(gr),Cr=kr.keyPath==null,$r=br==="put"||br==="add";if(!$r&&br!=="delete"&&br!=="deleteRange")throw new Error("Invalid operation type: "+br);const{length:Nr}=Or||_r||{length:1};if(Or&&_r&&Or.length!==_r.length)throw new Error("Given keys array must have same length as given values array.");if(Nr===0)return xr({numFailures:0,failures:{},results:[],lastResult:void 0});let Br;const Fr=[],Vr=[];let Rr=0;const Gr=Ur=>{++Rr,nn(Ur)};if(br==="deleteRange"){if(vr.type===4)return xr({numFailures:Rr,failures:Vr,results:[],lastResult:void 0});vr.type===3?Fr.push(Br=kr.clear()):Fr.push(Br=kr.delete(cr(vr)))}else{const[Ur,Yr]=$r?Cr?[_r,Or]:[_r,null]:[Or,null];if($r)for(let Dr=0;Dr<Nr;++Dr)Fr.push(Br=Yr&&Yr[Dr]!==void 0?kr[br](Ur[Dr],Yr[Dr]):kr[br](Ur[Dr])),Br.onerror=Gr;else for(let Dr=0;Dr<Nr;++Dr)Fr.push(Br=kr[br](Ur[Dr])),Br.onerror=Gr}const qr=Ur=>{const Yr=Ur.target.result;Fr.forEach((Dr,Jr)=>Dr.error!=null&&(Vr[Jr]=Dr.error)),xr({numFailures:Rr,failures:Vr,results:br==="delete"?Or:Fr.map(Dr=>Dr.result),lastResult:Yr})};Br.onerror=Ur=>{Gr(Ur),qr(Ur)},Br.onsuccess=qr})},getMany:({trans:yr,keys:br})=>new Promise((Or,_r)=>{Or=Ye(Or);const vr=yr.objectStore(gr),xr=br.length,wr=new Array(xr);let kr,Cr=0,$r=0;const Nr=Fr=>{const Vr=Fr.target;wr[Vr._pos]=Vr.result,++$r===Cr&&Or(wr)},Br=tn(_r);for(let Fr=0;Fr<xr;++Fr)br[Fr]!=null&&(kr=vr.get(br[Fr]),kr._pos=Fr,kr.onsuccess=Nr,kr.onerror=Br,++Cr);Cr===0&&Or(wr)}),get:({trans:yr,key:br})=>new Promise((Or,_r)=>{Or=Ye(Or);const vr=yr.objectStore(gr).get(br);vr.onsuccess=xr=>Or(xr.target.result),vr.onerror=tn(_r)}),query:function(yr){return br=>new Promise((Or,_r)=>{Or=Ye(Or);const{trans:vr,values:xr,limit:wr,query:kr}=br,Cr=wr===1/0?void 0:wr,{index:$r,range:Nr}=kr,Br=vr.objectStore(gr),Fr=$r.isPrimaryKey?Br:Br.index($r.name),Vr=cr(Nr);if(wr===0)return Or({result:[]});if(yr){const Rr=xr?Fr.getAll(Vr,Cr):Fr.getAllKeys(Vr,Cr);Rr.onsuccess=Gr=>Or({result:Gr.target.result}),Rr.onerror=tn(_r)}else{let Rr=0;const Gr=xr||!("openKeyCursor"in Fr)?Fr.openCursor(Vr):Fr.openKeyCursor(Vr),qr=[];Gr.onsuccess=Ur=>{const Yr=Gr.result;return Yr?(qr.push(xr?Yr.value:Yr.primaryKey),++Rr===wr?Or({result:qr}):void Yr.continue()):Or({result:qr})},Gr.onerror=tn(_r)}})}(hr),openCursor:function({trans:yr,values:br,query:Or,reverse:_r,unique:vr}){return new Promise((xr,wr)=>{xr=Ye(xr);const{index:kr,range:Cr}=Or,$r=yr.objectStore(gr),Nr=kr.isPrimaryKey?$r:$r.index(kr.name),Br=_r?vr?"prevunique":"prev":vr?"nextunique":"next",Fr=br||!("openKeyCursor"in Nr)?Nr.openCursor(cr(Cr),Br):Nr.openKeyCursor(cr(Cr),Br);Fr.onerror=tn(wr),Fr.onsuccess=Ye(Vr=>{const Rr=Fr.result;if(!Rr)return void xr(null);Rr.___id=++pn,Rr.done=!1;const Gr=Rr.continue.bind(Rr);let qr=Rr.continuePrimaryKey;qr&&(qr=qr.bind(Rr));const Ur=Rr.advance.bind(Rr),Yr=()=>{throw new Error("Cursor not stopped")};Rr.trans=yr,Rr.stop=Rr.continue=Rr.continuePrimaryKey=Rr.advance=()=>{throw new Error("Cursor not started")},Rr.fail=Ye(wr),Rr.next=function(){let Dr=1;return this.start(()=>Dr--?this.continue():this.stop()).then(()=>this)},Rr.start=Dr=>{const Jr=new Promise((Kr,ui)=>{Kr=Ye(Kr),Fr.onerror=tn(ui),Rr.fail=ui,Rr.stop=ii=>{Rr.stop=Rr.continue=Rr.continuePrimaryKey=Rr.advance=Yr,Kr(ii)}}),ai=()=>{if(Fr.result)try{Dr()}catch(Kr){Rr.fail(Kr)}else Rr.done=!0,Rr.start=()=>{throw new Error("Cursor behind last entry")},Rr.stop()};return Fr.onsuccess=Ye(Kr=>{Fr.onsuccess=ai,ai()}),Rr.continue=Gr,Rr.continuePrimaryKey=qr,Rr.advance=Ur,ai(),Jr},xr(Rr)},wr)})},count({query:yr,trans:br}){const{index:Or,range:_r}=yr;return new Promise((vr,xr)=>{const wr=br.objectStore(gr),kr=Or.isPrimaryKey?wr:wr.index(Or.name),Cr=cr(_r),$r=Cr?kr.count(Cr):kr.count();$r.onsuccess=Ye(Nr=>vr(Nr.target.result)),$r.onerror=tn(xr)})}}}(pr)),dr={};return fr.forEach(pr=>dr[pr.name]=pr),{stack:"dbcore",transaction:lr.transaction.bind(lr),table(pr){if(!dr[pr])throw new Error(`Table '${pr}' not found`);return dr[pr]},MIN_KEY:-1/0,MAX_KEY:hn(or),schema:ur}}function vn({_novip:lr},or){const ar=or.db,cr=function(ur,hr,{IDBKeyRange:fr,indexedDB:dr},pr){return{dbcore:function(gr,yr){return yr.reduce((br,{create:Or})=>({...br,...Or(br)}),gr)}(mn(hr,fr,pr),ur.dbcore)}}(lr._middlewares,ar,lr._deps,or);lr.core=cr.dbcore,lr.tables.forEach(ur=>{const hr=ur.name;lr.core.schema.tables.some(fr=>fr.name===hr)&&(ur.core=lr.core.table(hr),lr[hr]instanceof lr.Table&&(lr[hr].core=ur.core))})}function gn({_novip:lr},or,ar,cr){ar.forEach(ur=>{const hr=cr[ur];or.forEach(fr=>{const dr=d(fr,ur);(!dr||"value"in dr&&dr.value===void 0)&&(fr===lr.Transaction.prototype||fr instanceof lr.Transaction?l$2(fr,ur,{get(){return this.table(ur)},set(pr){u(this,ur,{value:pr,writable:!0,configurable:!0,enumerable:!0})}}):fr[ur]=new lr.Table(ur,hr))})})}function bn({_novip:lr},or){or.forEach(ar=>{for(let cr in ar)ar[cr]instanceof lr.Table&&delete ar[cr]})}function _n(lr,or){return lr._cfg.version-or._cfg.version}function wn(lr,or,ar,cr){const ur=lr._dbSchema,hr=lr._createTransaction("readwrite",lr._storeNames,ur);hr.create(ar),hr._completion.catch(cr);const fr=hr._reject.bind(hr),dr=Oe.transless||Oe;Ze(()=>{Oe.trans=hr,Oe.transless=dr,or===0?(t$3(ur).forEach(pr=>{kn(ar,pr,ur[pr].primKey,ur[pr].indexes)}),vn(lr,ar),je.follow(()=>lr.on.populate.fire(hr)).catch(fr)):function({_novip:pr},mr,gr,yr){const br=[],Or=pr._versions;let _r=pr._dbSchema=Pn(pr,pr.idbdb,yr),vr=!1;const xr=Or.filter(kr=>kr._cfg.version>=mr);function wr(){return br.length?je.resolve(br.shift()(gr.idbtrans)).then(wr):je.resolve()}return xr.forEach(kr=>{br.push(()=>{const Cr=_r,$r=kr._cfg.dbschema;Kn(pr,Cr,yr),Kn(pr,$r,yr),_r=pr._dbSchema=$r;const Nr=xn(Cr,$r);Nr.add.forEach(Fr=>{kn(yr,Fr[0],Fr[1].primKey,Fr[1].indexes)}),Nr.change.forEach(Fr=>{if(Fr.recreate)throw new X.Upgrade("Not yet support for changing primary key");{const Vr=yr.objectStore(Fr.name);Fr.add.forEach(Rr=>En(Vr,Rr)),Fr.change.forEach(Rr=>{Vr.deleteIndex(Rr.name),En(Vr,Rr)}),Fr.del.forEach(Rr=>Vr.deleteIndex(Rr))}});const Br=kr._cfg.contentUpgrade;if(Br&&kr._cfg.version>mr){vn(pr,yr),gr._memoizedTables={},vr=!0;let Fr=w($r);Nr.del.forEach(qr=>{Fr[qr]=Cr[qr]}),bn(pr,[pr.Transaction.prototype]),gn(pr,[pr.Transaction.prototype],t$3(Fr),Fr),gr.schema=Fr;const Vr=T(Br);let Rr;Vr&&et();const Gr=je.follow(()=>{if(Rr=Br(gr),Rr&&Vr){var qr=tt.bind(null,null);Rr.then(qr,qr)}});return Rr&&typeof Rr.then=="function"?je.resolve(Rr):Gr.then(()=>Rr)}}),br.push(Cr=>{(!vr||!xt)&&function($r,Nr){[].slice.call(Nr.db.objectStoreNames).forEach(Br=>$r[Br]==null&&Nr.db.deleteObjectStore(Br))}(kr._cfg.dbschema,Cr),bn(pr,[pr.Transaction.prototype]),gn(pr,[pr.Transaction.prototype],pr._storeNames,pr._dbSchema),gr.schema=pr._dbSchema})}),wr().then(()=>{var kr,Cr;Cr=yr,t$3(kr=_r).forEach($r=>{Cr.db.objectStoreNames.contains($r)||kn(Cr,$r,kr[$r].primKey,kr[$r].indexes)})})}(lr,or,hr,ar).catch(fr)})}function xn(lr,or){const ar={del:[],add:[],change:[]};let cr;for(cr in lr)or[cr]||ar.del.push(cr);for(cr in or){const ur=lr[cr],hr=or[cr];if(ur){const fr={name:cr,def:hr,recreate:!1,del:[],add:[],change:[]};if(""+(ur.primKey.keyPath||"")!=""+(hr.primKey.keyPath||"")||ur.primKey.auto!==hr.primKey.auto&&!wt)fr.recreate=!0,ar.change.push(fr);else{const dr=ur.idxByName,pr=hr.idxByName;let mr;for(mr in dr)pr[mr]||fr.del.push(mr);for(mr in pr){const gr=dr[mr],yr=pr[mr];gr?gr.src!==yr.src&&fr.change.push(yr):fr.add.push(yr)}(fr.del.length>0||fr.add.length>0||fr.change.length>0)&&ar.change.push(fr)}}else ar.add.push([cr,hr])}return ar}function kn(lr,or,ar,cr){const ur=lr.db.createObjectStore(or,ar.keyPath?{keyPath:ar.keyPath,autoIncrement:ar.auto}:{autoIncrement:ar.auto});return cr.forEach(hr=>En(ur,hr)),ur}function En(lr,or){lr.createIndex(or.name,or.keyPath,{unique:or.unique,multiEntry:or.multi})}function Pn(lr,or,ar){const cr={};return p(or.objectStoreNames,0).forEach(ur=>{const hr=ar.objectStore(ur);let fr=hr.keyPath;const dr=un(ln(fr),fr||"",!1,!1,!!hr.autoIncrement,fr&&typeof fr!="string",!0),pr=[];for(let gr=0;gr<hr.indexNames.length;++gr){const yr=hr.index(hr.indexNames[gr]);fr=yr.keyPath;var mr=un(yr.name,fr,!!yr.unique,!!yr.multiEntry,!1,fr&&typeof fr!="string",!1);pr.push(mr)}cr[ur]=cn(ur,dr,pr)}),cr}function Kn({_novip:lr},or,ar){const cr=ar.db.objectStoreNames;for(let ur=0;ur<cr.length;++ur){const hr=cr[ur],fr=ar.objectStore(hr);lr._hasGetAll="getAll"in fr;for(let dr=0;dr<fr.indexNames.length;++dr){const pr=fr.indexNames[dr],mr=fr.index(pr).keyPath,gr=typeof mr=="string"?mr:"["+p(mr).join("+")+"]";if(or[hr]){const yr=or[hr].idxByName[gr];yr&&(yr.name=pr,delete or[hr].idxByName[gr],or[hr].idxByName[pr]=yr)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&e$1.WorkerGlobalScope&&e$1 instanceof e$1.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(lr._hasGetAll=!1)}class On{_parseStoresSpec(or,ar){t$3(or).forEach(cr=>{if(or[cr]!==null){var ur=or[cr].split(",").map((fr,dr)=>{const pr=(fr=fr.trim()).replace(/([&*]|\+\+)/g,""),mr=/^\[/.test(pr)?pr.match(/^\[(.*)\]$/)[1].split("+"):pr;return un(pr,mr||null,/\&/.test(fr),/\*/.test(fr),/\+\+/.test(fr),n$2(mr),dr===0)}),hr=ur.shift();if(hr.multi)throw new X.Schema("Primary key cannot be multi-valued");ur.forEach(fr=>{if(fr.auto)throw new X.Schema("Only primary key can be marked as autoIncrement (++)");if(!fr.keyPath)throw new X.Schema("Index must have a name and cannot be an empty string")}),ar[cr]=cn(cr,hr,ur)}})}stores(or){const ar=this.db;this._cfg.storesSource=this._cfg.storesSource?r$1(this._cfg.storesSource,or):or;const cr=ar._versions,ur={};let hr={};return cr.forEach(fr=>{r$1(ur,fr._cfg.storesSource),hr=fr._cfg.dbschema={},fr._parseStoresSpec(ur,hr)}),ar._dbSchema=hr,bn(ar,[ar._allTables,ar,ar.Transaction.prototype]),gn(ar,[ar._allTables,ar,ar.Transaction.prototype,this._cfg.tables],t$3(hr),hr),ar._storeNames=t$3(hr),this}upgrade(or){return this._cfg.contentUpgrade=ue(this._cfg.contentUpgrade||ee,or),this}}function Sn(lr,or){let ar=lr._dbNamesDB;return ar||(ar=lr._dbNamesDB=new Xn(Pt,{addons:[],indexedDB:lr,IDBKeyRange:or}),ar.version(1).stores({dbnames:"name"})),ar.table("dbnames")}function An(lr){return lr&&typeof lr.databases=="function"}function Cn(lr){return Ze(function(){return Oe.letThrough=!0,lr()})}function jn(){var lr;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(or){var ar=function(){return indexedDB.databases().finally(or)};lr=setInterval(ar,100),ar()}).finally(function(){return clearInterval(lr)}):Promise.resolve()}function Dn(lr){const or=lr._state,{indexedDB:ar}=lr._deps;if(or.isBeingOpened||lr.idbdb)return or.dbReadyPromise.then(()=>or.dbOpenError?ft(or.dbOpenError):lr);R&&(or.openCanceller._stackHolder=q()),or.isBeingOpened=!0,or.dbOpenError=null,or.openComplete=!1;const cr=or.openCanceller;function ur(){if(or.openCanceller!==cr)throw new X.DatabaseClosed("db.open() was cancelled")}let hr=or.dbReadyResolve,fr=null,dr=!1;return je.race([cr,(typeof navigator>"u"?je.resolve():jn()).then(()=>new je((pr,mr)=>{if(ur(),!ar)throw new X.MissingAPI;const gr=lr.name,yr=or.autoSchema?ar.open(gr):ar.open(gr,Math.round(10*lr.verno));if(!yr)throw new X.MissingAPI;yr.onerror=tn(mr),yr.onblocked=Ye(lr._fireOnBlocked),yr.onupgradeneeded=Ye(br=>{if(fr=yr.transaction,or.autoSchema&&!lr._options.allowEmptyDB){yr.onerror=nn,fr.abort(),yr.result.close();const _r=ar.deleteDatabase(gr);_r.onsuccess=_r.onerror=Ye(()=>{mr(new X.NoSuchDatabase(`Database ${gr} doesnt exist`))})}else{fr.onerror=tn(mr);var Or=br.oldVersion>Math.pow(2,62)?0:br.oldVersion;dr=Or<1,lr._novip.idbdb=yr.result,wn(lr,Or/10,fr,mr)}},mr),yr.onsuccess=Ye(()=>{fr=null;const br=lr._novip.idbdb=yr.result,Or=p(br.objectStoreNames);if(Or.length>0)try{const vr=br.transaction((_r=Or).length===1?_r[0]:_r,"readonly");or.autoSchema?function({_novip:xr},wr,kr){xr.verno=wr.version/10;const Cr=xr._dbSchema=Pn(0,wr,kr);xr._storeNames=p(wr.objectStoreNames,0),gn(xr,[xr._allTables],t$3(Cr),Cr)}(lr,br,vr):(Kn(lr,lr._dbSchema,vr),function(xr,wr){const kr=xn(Pn(0,xr.idbdb,wr),xr._dbSchema);return!(kr.add.length||kr.change.some(Cr=>Cr.add.length||Cr.change.length))}(lr,vr)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),vn(lr,vr)}catch{}var _r;_t.push(lr),br.onversionchange=Ye(vr=>{or.vcFired=!0,lr.on("versionchange").fire(vr)}),br.onclose=Ye(vr=>{lr.on("close").fire(vr)}),dr&&function({indexedDB:vr,IDBKeyRange:xr},wr){!An(vr)&&wr!==Pt&&Sn(vr,xr).put({name:wr}).catch(ee)}(lr._deps,gr),pr()},mr)}))]).then(()=>(ur(),or.onReadyBeingFired=[],je.resolve(Cn(()=>lr.on.ready.fire(lr.vip))).then(function pr(){if(or.onReadyBeingFired.length>0){let mr=or.onReadyBeingFired.reduce(ue,ee);return or.onReadyBeingFired=[],je.resolve(Cn(()=>mr(lr.vip))).then(pr)}}))).finally(()=>{or.onReadyBeingFired=null,or.isBeingOpened=!1}).then(()=>lr).catch(pr=>{or.dbOpenError=pr;try{fr&&fr.abort()}catch{}return cr===or.openCanceller&&lr._close(),ft(pr)}).finally(()=>{or.openComplete=!0,hr()})}function In(lr){var or=hr=>lr.next(hr),ar=ur(or),cr=ur(hr=>lr.throw(hr));function ur(hr){return fr=>{var dr=hr(fr),pr=dr.value;return dr.done?pr:pr&&typeof pr.then=="function"?pr.then(ar,cr):n$2(pr)?Promise.all(pr).then(ar,cr):ar(pr)}}return ur(or)()}function Bn(lr,or,ar){var cr=arguments.length;if(cr<2)throw new X.InvalidArgument("Too few arguments");for(var ur=new Array(cr-1);--cr;)ur[cr-1]=arguments[cr];return ar=ur.pop(),[lr,k(ur),ar]}function Tn(lr,or,ar,cr,ur){return je.resolve().then(()=>{const hr=Oe.transless||Oe,fr=lr._createTransaction(or,ar,lr._dbSchema,cr),dr={trans:fr,transless:hr};if(cr)fr.idbtrans=cr.idbtrans;else try{fr.create(),lr._state.PR1398_maxLoop=3}catch(yr){return yr.name===H.InvalidState&&lr.isOpen()&&--lr._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),lr._close(),lr.open().then(()=>Tn(lr,or,ar,null,ur))):ft(yr)}const pr=T(ur);let mr;pr&&et();const gr=je.follow(()=>{if(mr=ur.call(fr,fr),mr)if(pr){var yr=tt.bind(null,null);mr.then(yr,yr)}else typeof mr.next=="function"&&typeof mr.throw=="function"&&(mr=In(mr))},dr);return(mr&&typeof mr.then=="function"?je.resolve(mr).then(yr=>fr.active?yr:ft(new X.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):gr.then(()=>mr)).then(yr=>(cr&&fr._resolve(),fr._completion.then(()=>yr))).catch(yr=>(fr._reject(yr),ft(yr)))})}function Rn(lr,or,ar){const cr=n$2(lr)?lr.slice():[lr];for(let ur=0;ur<ar;++ur)cr.push(or);return cr}const Fn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(lr){return{...lr,table(or){const ar=lr.table(or),{schema:cr}=ar,ur={},hr=[];function fr(gr,yr,br){const Or=yn(gr),_r=ur[Or]=ur[Or]||[],vr=gr==null?0:typeof gr=="string"?1:gr.length,xr=yr>0,wr={...br,isVirtual:xr,keyTail:yr,keyLength:vr,extractKey:dn(gr),unique:!xr&&br.unique};return _r.push(wr),wr.isPrimaryKey||hr.push(wr),vr>1&&fr(vr===2?gr[0]:gr.slice(0,vr-1),yr+1,br),_r.sort((kr,Cr)=>kr.keyTail-Cr.keyTail),wr}const dr=fr(cr.primaryKey.keyPath,0,cr.primaryKey);ur[":id"]=[dr];for(const gr of cr.indexes)fr(gr.keyPath,0,gr);function pr(gr){const yr=gr.query.index;return yr.isVirtual?{...gr,query:{index:yr,range:(br=gr.query.range,Or=yr.keyTail,{type:br.type===1?2:br.type,lower:Rn(br.lower,br.lowerOpen?lr.MAX_KEY:lr.MIN_KEY,Or),lowerOpen:!0,upper:Rn(br.upper,br.upperOpen?lr.MIN_KEY:lr.MAX_KEY,Or),upperOpen:!0})}}:gr;var br,Or}return{...ar,schema:{...cr,primaryKey:dr,indexes:hr,getIndexByKeyPath:function(gr){const yr=ur[yn(gr)];return yr&&yr[0]}},count:gr=>ar.count(pr(gr)),query:gr=>ar.query(pr(gr)),openCursor(gr){const{keyTail:yr,isVirtual:br,keyLength:Or}=gr.query.index;return br?ar.openCursor(pr(gr)).then(_r=>_r&&function(vr){return Object.create(vr,{continue:{value:function(wr){wr!=null?vr.continue(Rn(wr,gr.reverse?lr.MAX_KEY:lr.MIN_KEY,yr)):gr.unique?vr.continue(vr.key.slice(0,Or).concat(gr.reverse?lr.MIN_KEY:lr.MAX_KEY,yr)):vr.continue()}},continuePrimaryKey:{value(wr,kr){vr.continuePrimaryKey(Rn(wr,lr.MAX_KEY,yr),kr)}},primaryKey:{get:()=>vr.primaryKey},key:{get(){const wr=vr.key;return Or===1?wr[0]:wr.slice(0,Or)}},value:{get:()=>vr.value}})}(_r)):ar.openCursor(gr)}}}}}};function Mn(lr,or,ar,cr){return ar=ar||{},cr=cr||"",t$3(lr).forEach(ur=>{if(o$3(or,ur)){var hr=lr[ur],fr=or[ur];if(typeof hr=="object"&&typeof fr=="object"&&hr&&fr){const dr=C(hr);dr!==C(fr)?ar[cr+ur]=or[ur]:dr==="Object"?Mn(hr,fr,ar,cr+ur+"."):hr!==fr&&(ar[cr+ur]=or[ur])}else hr!==fr&&(ar[cr+ur]=or[ur])}else ar[cr+ur]=void 0}),t$3(or).forEach(ur=>{o$3(lr,ur)||(ar[cr+ur]=or[ur])}),ar}const Nn={stack:"dbcore",name:"HooksMiddleware",level:2,create:lr=>({...lr,table(or){const ar=lr.table(or),{primaryKey:cr}=ar.schema;return{...ar,mutate(hr){const fr=Oe.trans,{deleting:dr,creating:pr,updating:mr}=fr.table(or).hook;switch(hr.type){case"add":if(pr.fire===ee)break;return fr._promise("readwrite",()=>gr(hr),!0);case"put":if(pr.fire===ee&&mr.fire===ee)break;return fr._promise("readwrite",()=>gr(hr),!0);case"delete":if(dr.fire===ee)break;return fr._promise("readwrite",()=>gr(hr),!0);case"deleteRange":if(dr.fire===ee)break;return fr._promise("readwrite",()=>function(br){return yr(br.trans,br.range,1e4)}(hr),!0)}return ar.mutate(hr);function gr(br){const Or=Oe.trans,_r=br.keys||function(vr,xr){return xr.type==="delete"?xr.keys:xr.keys||xr.values.map(vr.extractKey)}(cr,br);if(!_r)throw new Error("Keys missing");return(br=br.type==="add"||br.type==="put"?{...br,keys:_r}:{...br}).type!=="delete"&&(br.values=[...br.values]),br.keys&&(br.keys=[...br.keys]),function(vr,xr,wr){return xr.type==="add"?Promise.resolve([]):vr.getMany({trans:xr.trans,keys:wr,cache:"immutable"})}(ar,br,_r).then(vr=>{const xr=_r.map((wr,kr)=>{const Cr=vr[kr],$r={onerror:null,onsuccess:null};if(br.type==="delete")dr.fire.call($r,wr,Cr,Or);else if(br.type==="add"||Cr===void 0){const Nr=pr.fire.call($r,wr,br.values[kr],Or);wr==null&&Nr!=null&&(wr=Nr,br.keys[kr]=wr,cr.outbound||_(br.values[kr],cr.keyPath,wr))}else{const Nr=Mn(Cr,br.values[kr]),Br=mr.fire.call($r,Nr,wr,Cr,Or);if(Br){const Fr=br.values[kr];Object.keys(Br).forEach(Vr=>{o$3(Fr,Vr)?Fr[Vr]=Br[Vr]:_(Fr,Vr,Br[Vr])})}}return $r});return ar.mutate(br).then(({failures:wr,results:kr,numFailures:Cr,lastResult:$r})=>{for(let Nr=0;Nr<_r.length;++Nr){const Br=kr?kr[Nr]:_r[Nr],Fr=xr[Nr];Br==null?Fr.onerror&&Fr.onerror(wr[Nr]):Fr.onsuccess&&Fr.onsuccess(br.type==="put"&&vr[Nr]?br.values[Nr]:Br)}return{failures:wr,results:kr,numFailures:Cr,lastResult:$r}}).catch(wr=>(xr.forEach(kr=>kr.onerror&&kr.onerror(wr)),Promise.reject(wr)))})}function yr(br,Or,_r){return ar.query({trans:br,values:!1,query:{index:cr,range:Or},limit:_r}).then(({result:vr})=>gr({type:"delete",keys:vr,trans:br}).then(xr=>xr.numFailures>0?Promise.reject(xr.failures[0]):vr.length<_r?{failures:[],numFailures:0,lastResult:void 0}:yr(br,{...Or,lower:vr[vr.length-1],lowerOpen:!0},_r)))}}}}})};function qn(lr,or,ar){try{if(!or||or.keys.length<lr.length)return null;const cr=[];for(let ur=0,hr=0;ur<or.keys.length&&hr<lr.length;++ur)$t(or.keys[ur],lr[hr])===0&&(cr.push(ar?O(or.values[ur]):or.values[ur]),++hr);return cr.length===lr.length?cr:null}catch{return null}}const $n={stack:"dbcore",level:-1,create:lr=>({table:or=>{const ar=lr.table(or);return{...ar,getMany:cr=>{if(!cr.cache)return ar.getMany(cr);const ur=qn(cr.keys,cr.trans._cache,cr.cache==="clone");return ur?je.resolve(ur):ar.getMany(cr).then(hr=>(cr.trans._cache={keys:cr.keys,values:cr.cache==="clone"?O(hr):hr},hr))},mutate:cr=>(cr.type!=="add"&&(cr.trans._cache=null),ar.mutate(cr))}}})};function Un(lr){return!("from"in lr)}const Ln=function(lr,or){if(!this){const ar=new Ln;return lr&&"d"in lr&&r$1(ar,lr),ar}r$1(this,arguments.length?{d:1,from:lr,to:arguments.length>1?or:lr}:{d:0})};function Vn(lr,or,ar){const cr=$t(or,ar);if(isNaN(cr))return;if(cr>0)throw RangeError();if(Un(lr))return r$1(lr,{from:or,to:ar,d:1});const ur=lr.l,hr=lr.r;if($t(ar,lr.from)<0)return ur?Vn(ur,or,ar):lr.l={from:or,to:ar,d:1,l:null,r:null},Gn(lr);if($t(or,lr.to)>0)return hr?Vn(hr,or,ar):lr.r={from:or,to:ar,d:1,l:null,r:null},Gn(lr);$t(or,lr.from)<0&&(lr.from=or,lr.l=null,lr.d=hr?hr.d+1:1),$t(ar,lr.to)>0&&(lr.to=ar,lr.r=null,lr.d=lr.l?lr.l.d+1:1);const fr=!lr.r;ur&&!lr.l&&Wn(lr,ur),hr&&fr&&Wn(lr,hr)}function Wn(lr,or){Un(or)||function ar(cr,{from:ur,to:hr,l:fr,r:dr}){Vn(cr,ur,hr),fr&&ar(cr,fr),dr&&ar(cr,dr)}(lr,or)}function Yn(lr,or){const ar=zn(or);let cr=ar.next();if(cr.done)return!1;let ur=cr.value;const hr=zn(lr);let fr=hr.next(ur.from),dr=fr.value;for(;!cr.done&&!fr.done;){if($t(dr.from,ur.to)<=0&&$t(dr.to,ur.from)>=0)return!0;$t(ur.from,dr.from)<0?ur=(cr=ar.next(dr.from)).value:dr=(fr=hr.next(ur.from)).value}return!1}function zn(lr){let or=Un(lr)?null:{s:0,n:lr};return{next(ar){const cr=arguments.length>0;for(;or;)switch(or.s){case 0:if(or.s=1,cr)for(;or.n.l&&$t(ar,or.n.from)<0;)or={up:or,n:or.n.l,s:1};else for(;or.n.l;)or={up:or,n:or.n.l,s:1};case 1:if(or.s=2,!cr||$t(ar,or.n.to)<=0)return{value:or.n,done:!1};case 2:if(or.n.r){or.s=3,or={up:or,n:or.n.r,s:0};continue}case 3:or=or.up}return{done:!0}}}}function Gn(lr){var or,ar;const cr=(((or=lr.r)===null||or===void 0?void 0:or.d)||0)-(((ar=lr.l)===null||ar===void 0?void 0:ar.d)||0),ur=cr>1?"r":cr<-1?"l":"";if(ur){const hr=ur==="r"?"l":"r",fr={...lr},dr=lr[ur];lr.from=dr.from,lr.to=dr.to,lr[ur]=dr[ur],fr[ur]=dr[hr],lr[hr]=fr,fr.d=Hn(fr)}lr.d=Hn(lr)}function Hn({r:lr,l:or}){return(lr?or?Math.max(lr.d,or.d):lr.d:or?or.d:0)+1}a(Ln.prototype,{add(lr){return Wn(this,lr),this},addKey(lr){return Vn(this,lr,lr),this},addKeys(lr){return lr.forEach(or=>Vn(this,or,or)),this},[j](){return zn(this)}});const Qn={stack:"dbcore",level:0,create:lr=>{const or=lr.schema.name,ar=new Ln(lr.MIN_KEY,lr.MAX_KEY);return{...lr,table:cr=>{const ur=lr.table(cr),{schema:hr}=ur,{primaryKey:fr}=hr,{extractKey:dr,outbound:pr}=fr,mr={...ur,mutate:br=>{const Or=br.trans,_r=Or.mutatedParts||(Or.mutatedParts={}),vr=Br=>{const Fr=`idb://${or}/${cr}/${Br}`;return _r[Fr]||(_r[Fr]=new Ln)},xr=vr(""),wr=vr(":dels"),{type:kr}=br;let[Cr,$r]=br.type==="deleteRange"?[br.range]:br.type==="delete"?[br.keys]:br.values.length<50?[[],br.values]:[];const Nr=br.trans._cache;return ur.mutate(br).then(Br=>{if(n$2(Cr)){kr!=="delete"&&(Cr=Br.results),xr.addKeys(Cr);const Fr=qn(Cr,Nr);Fr||kr==="add"||wr.addKeys(Cr),(Fr||$r)&&function(Vr,Rr,Gr,qr){function Ur(Yr){const Dr=Vr(Yr.name||"");function Jr(Kr){return Kr!=null?Yr.extractKey(Kr):null}const ai=Kr=>Yr.multiEntry&&n$2(Kr)?Kr.forEach(ui=>Dr.addKey(ui)):Dr.addKey(Kr);(Gr||qr).forEach((Kr,ui)=>{const ii=Gr&&Jr(Gr[ui]),di=qr&&Jr(qr[ui]);$t(ii,di)!==0&&(ii!=null&&ai(ii),di!=null&&ai(di))})}Rr.indexes.forEach(Ur)}(vr,hr,Fr,$r)}else if(Cr){const Fr={from:Cr.lower,to:Cr.upper};wr.add(Fr),xr.add(Fr)}else xr.add(ar),wr.add(ar),hr.indexes.forEach(Fr=>vr(Fr.name).add(ar));return Br})}},gr=({query:{index:br,range:Or}})=>{var _r,vr;return[br,new Ln((_r=Or.lower)!==null&&_r!==void 0?_r:lr.MIN_KEY,(vr=Or.upper)!==null&&vr!==void 0?vr:lr.MAX_KEY)]},yr={get:br=>[fr,new Ln(br.key)],getMany:br=>[fr,new Ln().addKeys(br.keys)],count:gr,query:gr,openCursor:gr};return t$3(yr).forEach(br=>{mr[br]=function(Or){const{subscr:_r}=Oe;if(_r){const vr=$r=>{const Nr=`idb://${or}/${cr}/${$r}`;return _r[Nr]||(_r[Nr]=new Ln)},xr=vr(""),wr=vr(":dels"),[kr,Cr]=yr[br](Or);if(vr(kr.name||"").add(Cr),!kr.isPrimaryKey){if(br!=="count"){const $r=br==="query"&&pr&&Or.values&&ur.query({...Or,values:!1});return ur[br].apply(this,arguments).then(Nr=>{if(br==="query"){if(pr&&Or.values)return $r.then(({result:Fr})=>(xr.addKeys(Fr),Nr));const Br=Or.values?Nr.result.map(dr):Nr.result;Or.values?xr.addKeys(Br):wr.addKeys(Br)}else if(br==="openCursor"){const Br=Nr,Fr=Or.values;return Br&&Object.create(Br,{key:{get:()=>(wr.addKey(Br.primaryKey),Br.key)},primaryKey:{get(){const Vr=Br.primaryKey;return wr.addKey(Vr),Vr}},value:{get:()=>(Fr&&xr.addKey(Br.primaryKey),Br.value)}})}return Nr})}wr.add(ar)}}return ur[br].apply(this,arguments)}}),mr}}}};class Xn{constructor(or,ar){this._middlewares={},this.verno=0;const cr=Xn.dependencies;this._options=ar={addons:Xn.addons,autoOpen:!0,indexedDB:cr.indexedDB,IDBKeyRange:cr.IDBKeyRange,...ar},this._deps={indexedDB:ar.indexedDB,IDBKeyRange:ar.IDBKeyRange};const{addons:ur}=ar;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const hr={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ee,dbReadyPromise:null,cancelOpen:ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var fr;hr.dbReadyPromise=new je(dr=>{hr.dbReadyResolve=dr}),hr.openCanceller=new je((dr,pr)=>{hr.cancelOpen=pr}),this._state=hr,this.name=or,this.on=Dt(this,"populate","blocked","versionchange","close",{ready:[ue,ee]}),this.on.ready.subscribe=y(this.on.ready.subscribe,dr=>(pr,mr)=>{Xn.vip(()=>{const gr=this._state;if(gr.openComplete)gr.dbOpenError||je.resolve().then(pr),mr&&dr(pr);else if(gr.onReadyBeingFired)gr.onReadyBeingFired.push(pr),mr&&dr(pr);else{dr(pr);const yr=this;mr||dr(function br(){yr.on.ready.unsubscribe(pr),yr.on.ready.unsubscribe(br)})}})}),this.Collection=(fr=this,It(Vt.prototype,function(dr,pr){this.db=fr;let mr=At,gr=null;if(pr)try{mr=pr()}catch(_r){gr=_r}const yr=dr._ctx,br=yr.table,Or=br.hook.reading.fire;this._ctx={table:br,index:yr.index,isPrimKey:!yr.index||br.schema.primKey.keyPath&&yr.index===br.schema.primKey.name,range:mr,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:gr,or:yr.or,valueMapper:Or!==te?Or:null}})),this.Table=function(dr){return It(jt.prototype,function(pr,mr,gr){this.db=dr,this._tx=gr,this.name=pr,this.schema=mr,this.hook=dr._allTables[pr]?dr._allTables[pr].hook:Dt(null,{creating:[se,ee],reading:[ne,te],updating:[oe,ee],deleting:[ie,ee]})})}(this),this.Transaction=function(dr){return It(an.prototype,function(pr,mr,gr,yr,br){this.db=dr,this.mode=pr,this.storeNames=mr,this.schema=gr,this.chromeTransactionDurability=yr,this.idbtrans=null,this.on=Dt(this,"complete","error","abort"),this.parent=br||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new je((Or,_r)=>{this._resolve=Or,this._reject=_r}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},Or=>{var _r=this.active;return this.active=!1,this.on.error.fire(Or),this.parent?this.parent._reject(Or):_r&&this.idbtrans&&this.idbtrans.abort(),ft(Or)})})}(this),this.Version=function(dr){return It(On.prototype,function(pr){this.db=dr,this._cfg={version:pr,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(dr){return It(en$1.prototype,function(pr,mr,gr){this.db=dr,this._ctx={table:pr,index:mr===":id"?null:mr,or:gr};const yr=dr._deps.indexedDB;if(!yr)throw new X.MissingAPI;this._cmp=this._ascending=yr.cmp.bind(yr),this._descending=(br,Or)=>yr.cmp(Or,br),this._max=(br,Or)=>yr.cmp(br,Or)>0?br:Or,this._min=(br,Or)=>yr.cmp(br,Or)<0?br:Or,this._IDBKeyRange=dr._deps.IDBKeyRange})}(this),this.on("versionchange",dr=>{dr.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",dr=>{!dr.newVersion||dr.newVersion<dr.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${dr.oldVersion/10}`)}),this._maxKey=hn(ar.IDBKeyRange),this._createTransaction=(dr,pr,mr,gr)=>new this.Transaction(dr,pr,mr,this._options.chromeTransactionDurability,gr),this._fireOnBlocked=dr=>{this.on("blocked").fire(dr),_t.filter(pr=>pr.name===this.name&&pr!==this&&!pr._state.vcFired).map(pr=>pr.on("versionchange").fire(dr))},this.use(Fn),this.use(Nn),this.use(Qn),this.use($n),this.vip=Object.create(this,{_vip:{value:!0}}),ur.forEach(dr=>dr(this))}version(or){if(isNaN(or)||or<.1)throw new X.Type("Given version is not a positive number");if(or=Math.round(10*or)/10,this.idbdb||this._state.isBeingOpened)throw new X.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,or);const ar=this._versions;var cr=ar.filter(ur=>ur._cfg.version===or)[0];return cr||(cr=new this.Version(or),ar.push(cr),ar.sort(_n),cr.stores({}),this._state.autoSchema=!1,cr)}_whenReady(or){return this.idbdb&&(this._state.openComplete||Oe.letThrough||this._vip)?or():new je((ar,cr)=>{if(this._state.openComplete)return cr(new X.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void cr(new X.DatabaseClosed);this.open().catch(ee)}this._state.dbReadyPromise.then(ar,cr)}).then(or)}use({stack:or,create:ar,level:cr,name:ur}){ur&&this.unuse({stack:or,name:ur});const hr=this._middlewares[or]||(this._middlewares[or]=[]);return hr.push({stack:or,create:ar,level:cr??10,name:ur}),hr.sort((fr,dr)=>fr.level-dr.level),this}unuse({stack:or,name:ar,create:cr}){return or&&this._middlewares[or]&&(this._middlewares[or]=this._middlewares[or].filter(ur=>cr?ur.create!==cr:!!ar&&ur.name!==ar)),this}open(){return Dn(this)}_close(){const or=this._state,ar=_t.indexOf(this);if(ar>=0&&_t.splice(ar,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}or.dbReadyPromise=new je(cr=>{or.dbReadyResolve=cr}),or.openCanceller=new je((cr,ur)=>{or.cancelOpen=ur})}close(){this._close();const or=this._state;this._options.autoOpen=!1,or.dbOpenError=new X.DatabaseClosed,or.isBeingOpened&&or.cancelOpen(or.dbOpenError)}delete(){const or=arguments.length>0,ar=this._state;return new je((cr,ur)=>{const hr=()=>{this.close();var fr=this._deps.indexedDB.deleteDatabase(this.name);fr.onsuccess=Ye(()=>{(function({indexedDB:dr,IDBKeyRange:pr},mr){!An(dr)&&mr!==Pt&&Sn(dr,pr).delete(mr).catch(ee)})(this._deps,this.name),cr()}),fr.onerror=tn(ur),fr.onblocked=this._fireOnBlocked};if(or)throw new X.InvalidArgument("Arguments not allowed in db.delete()");ar.isBeingOpened?ar.dbReadyPromise.then(hr):hr()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const or=this._state.dbOpenError;return or&&or.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return t$3(this._allTables).map(or=>this._allTables[or])}transaction(){const or=Bn.apply(this,arguments);return this._transaction.apply(this,or)}_transaction(or,ar,cr){let ur=Oe.trans;ur&&ur.db===this&&or.indexOf("!")===-1||(ur=null);const hr=or.indexOf("?")!==-1;let fr,dr;or=or.replace("!","").replace("?","");try{if(dr=ar.map(mr=>{var gr=mr instanceof this.Table?mr.name:mr;if(typeof gr!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return gr}),or=="r"||or===Kt)fr=Kt;else{if(or!="rw"&&or!=Ot)throw new X.InvalidArgument("Invalid transaction mode: "+or);fr=Ot}if(ur){if(ur.mode===Kt&&fr===Ot){if(!hr)throw new X.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");ur=null}ur&&dr.forEach(mr=>{if(ur&&ur.storeNames.indexOf(mr)===-1){if(!hr)throw new X.SubTransaction("Table "+mr+" not included in parent transaction.");ur=null}}),hr&&ur&&!ur.active&&(ur=null)}}catch(mr){return ur?ur._promise(null,(gr,yr)=>{yr(mr)}):ft(mr)}const pr=Tn.bind(null,this,fr,dr,ur,cr);return ur?ur._promise(fr,pr,"lock"):Oe.trans?at(Oe.transless,()=>this._whenReady(pr)):this._whenReady(pr)}table(or){if(!o$3(this._allTables,or))throw new X.InvalidTable(`Table ${or} does not exist`);return this._allTables[or]}}const Jn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Zn{constructor(or){this._subscribe=or}subscribe(or,ar,cr){return this._subscribe(or&&typeof or!="function"?or:{next:or,error:ar,complete:cr})}[Jn](){return this}}function er(lr,or){return t$3(or).forEach(ar=>{Wn(lr[ar]||(lr[ar]=new Ln),or[ar])}),lr}function tr(lr){let or,ar=!1;const cr=new Zn(ur=>{const hr=T(lr);let fr=!1,dr={},pr={};const mr={get closed(){return fr},unsubscribe:()=>{fr=!0,on.storagemutated.unsubscribe(Or)}};ur.start&&ur.start(mr);let gr=!1,yr=!1;function br(){return t$3(pr).some(vr=>dr[vr]&&Yn(dr[vr],pr[vr]))}const Or=vr=>{er(dr,vr),br()&&_r()},_r=()=>{if(gr||fr)return;dr={};const vr={},xr=function(wr){hr&&et();const kr=()=>Ze(lr,{subscr:wr,trans:null}),Cr=Oe.trans?at(Oe.transless,kr):kr();return hr&&Cr.then(tt,tt),Cr}(vr);yr||(on(rn,Or),yr=!0),gr=!0,Promise.resolve(xr).then(wr=>{ar=!0,or=wr,gr=!1,fr||(br()?_r():(dr={},pr=vr,ur.next&&ur.next(wr)))},wr=>{gr=!1,ar=!1,ur.error&&ur.error(wr),mr.unsubscribe()})};return _r(),mr});return cr.hasValue=()=>ar,cr.getValue=()=>or,cr}let nr;try{nr={indexedDB:e$1.indexedDB||e$1.mozIndexedDB||e$1.webkitIndexedDB||e$1.msIndexedDB,IDBKeyRange:e$1.IDBKeyRange||e$1.webkitIDBKeyRange}}catch{nr={indexedDB:null,IDBKeyRange:null}}const rr=Xn;function sr(lr){let or=ir;try{ir=!0,on.storagemutated.fire(lr)}finally{ir=or}}a(rr,{...Z,delete:lr=>new rr(lr,{addons:[]}).delete(),exists:lr=>new rr(lr,{addons:[]}).open().then(or=>(or.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(lr){try{return function({indexedDB:or,IDBKeyRange:ar}){return An(or)?Promise.resolve(or.databases()).then(cr=>cr.map(ur=>ur.name).filter(ur=>ur!==Pt)):Sn(or,ar).toCollection().primaryKeys()}(rr.dependencies).then(lr)}catch{return ft(new X.MissingAPI)}},defineClass:()=>function(lr){r$1(this,lr)},ignoreTransaction:lr=>Oe.trans?at(Oe.transless,lr):lr(),vip:Cn,async:function(lr){return function(){try{var or=In(lr.apply(this,arguments));return or&&typeof or.then=="function"?or:je.resolve(or)}catch(ar){return ft(ar)}}},spawn:function(lr,or,ar){try{var cr=In(lr.apply(ar,or||[]));return cr&&typeof cr.then=="function"?cr:je.resolve(cr)}catch(ur){return ft(ur)}},currentTransaction:{get:()=>Oe.trans||null},waitFor:function(lr,or){const ar=je.resolve(typeof lr=="function"?rr.ignoreTransaction(lr):lr).timeout(or||6e4);return Oe.trans?Oe.trans.waitFor(ar):ar},Promise:je,debug:{get:()=>R,set:lr=>{F(lr,lr==="dexie"?()=>!0:Et)}},derive:c,extend:r$1,props:a,override:y,Events:Dt,on,liveQuery:tr,extendObservabilitySet:er,getByKeyPath:b,setByKeyPath:_,delByKeyPath:function(lr,or){typeof or=="string"?_(lr,or,void 0):"length"in or&&[].map.call(or,function(ar){_(lr,ar,void 0)})},shallowClone:w,deepClone:O,getObjectDiff:Mn,cmp:$t,asap:v,minKey:vt,addons:[],connections:_t,errnames:H,dependencies:nr,semVer:yt,version:yt.split(".").map(lr=>parseInt(lr)).reduce((lr,or,ar)=>lr+or/Math.pow(10,2*ar))}),rr.maxKey=hn(rr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(on(rn,lr=>{if(!ir){let or;wt?(or=document.createEvent("CustomEvent"),or.initCustomEvent(sn,!0,!0,lr)):or=new CustomEvent(sn,{detail:lr}),ir=!0,dispatchEvent(or),ir=!1}}),addEventListener(sn,({detail:lr})=>{ir||sr(lr)}));let ir=!1;if(typeof BroadcastChannel<"u"){const lr=new BroadcastChannel(sn);typeof lr.unref=="function"&&lr.unref(),on(rn,or=>{ir||lr.postMessage(or)}),lr.onmessage=or=>{or.data&&sr(or.data)}}else if(typeof self<"u"&&typeof navigator<"u"){on(rn,or=>{try{ir||(typeof localStorage<"u"&&localStorage.setItem(sn,JSON.stringify({trig:Math.random(),changedParts:or})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(ar=>ar.postMessage({type:sn,changedParts:or})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",or=>{if(or.key===sn){const ar=JSON.parse(or.newValue);ar&&sr(ar.changedParts)}});const lr=self.document&&navigator.serviceWorker;lr&&lr.addEventListener("message",function({data:or}){or&&or.type===sn&&sr(or.changedParts)})}je.rejectionMapper=function(lr,or){if(!lr||lr instanceof W||lr instanceof TypeError||lr instanceof SyntaxError||!lr.name||!J[lr.name])return lr;var ar=new J[lr.name](or||lr.message,lr);return"stack"in lr&&l$2(ar,"stack",{get:function(){return this.inner.stack}}),ar},F(R,Et);const firebaseSessionsKey="mage-firebase-lastsessions",db=new Xn("magebook2");db.version(1).stores({sessions:"&id, time, preview",fireSessions:"&id, time, preview"});const isFirebase=writable(!1),previews=async()=>(await db.table("sessions").orderBy("preview").keys()).reverse().map(lr=>({time:new Date(Number(lr.substring(0,30))),id:lr.substring(31,20+31),name:lr.substring(52,30+52)})),session=(()=>{const lr={};let or;const cr=randomString(20),ur=gr=>{const yr=(gr.data.title||"no title").padEnd(30,"").substring(0,30);return`${String(gr.time).padStart(30,"0")}-${gr.id}-${yr}`},hr=50,fr=async()=>{const gr="time",yr=(await db.table("sessions").orderBy(gr).keys()).reverse();if(yr.length>hr){const br=yr[hr];await db.table("sessions").where("time").below(br).modify(function(){delete this.value})}};let dr=!1;const pr=async()=>{if(urlParams.get("fsession")){isFirebase.set(!0);const Or=urlParam("fsession");Or.change(()=>location.reload()),initEditorFirebase(JSON.parse(decode$3(decodeURIComponent(Or.value)))),store.then(({book:_r})=>{const vr=JSON.parse(localStorage[firebaseSessionsKey]||"{}");vr[Or.value]={name:_r.index.title,time:new Date().getTime()},localStorage[firebaseSessionsKey]=JSON.stringify(vr)});return}if(dr){console.error("Session loaded twice!");return}dr=!0;const gr=localStorage.getItem("mage-session-last"),yr=urlParam("msession");console.log(yr.value),yr.set(await(async()=>{if(!gr)return randomString(20);if(yr.value){if(yr.value==gr)return yr.value;try{if(await db.table("sessions").get(yr.value))return yr.value}catch{}}return gr||randomString(20)})()),yr.change(()=>window.location.reload()),localStorage.setItem("mage-session-last",yr.value),localStorage.setItem(`mage-lock-${yr.value}`,cr);let br;if(gr==yr.value)br=JSON.parse(localStorage.getItem("mage-session-last-data"));else try{console.log("session",yr.value),br=await db.table("sessions").get(yr.value),console.log(br)}catch(Or){console.error(Or)}br=br??{data:{book:get_store_value($format)("books.local"),cursor:{row:0,column:0}}},initEditorLocal(br.data),store.then(({book:Or})=>{or=derived([Or,cursorPosition],([_r,vr])=>({book:_r.text,cursor:vr,title:_r.index.title})),or.subscribe(async _r=>{if(localStorage.getItem(`mage-lock-${yr.value}`)!=cr){lockStore.set({lock:!0,session:lr});return}localStorage.setItem("mage-session-last",yr.value);const vr={id:yr.value,data:_r,time:new Date().getTime()};localStorage.setItem("mage-session-last-data",JSON.stringify(vr));try{await db.table("sessions").put({preview:ur(vr),...vr})}catch(xr){console.log(xr)}}),window.onbeforeunload=_r=>{delete _r.returnValue},fr()})},mr=async gr=>{window.onbeforeunload=()=>{};const yr=randomString(20);localStorage.setItem("mage-session-last",yr);const br={id:yr,file:{name:"New"},time:new Date().getTime(),...gr};localStorage.setItem("mage-session-last-data",JSON.stringify(br));try{await db.table("sessions").put(br)}catch{}location.assign(`#msession=${br.id}`)};return lr.duplicate=async gr=>{mr({data:get_store_value(or),...gr})},lr.lock=()=>{const gr=urlParam("msession");localStorage.setItem(`mage-lock-${gr.value}`,cr),lockStore.set({lock:!1,session:null})},Object.assign(lr,{load:pr,open:mr}),lr})(),defaultFormats={md,fodt,html,json,docx,xlgc},open$1=lr=>{if(lr.files===null)return;const or=lr.files[0],ar=or.name,cr=new FileReader;cr.onload=async()=>{const ur={...defaultFormats,...get_store_value(bookFormats)};let hr=ar.substring(ar.lastIndexOf(".")+1);if(hr=="magebook"&&(hr="md"),ur[hr]===void 0||ur[hr].decode===void 0){console.error("Unsupported format");return}const fr=cr.result,dr=ur[hr].decode(fr),pr=await Promise.resolve(dr);session.open({data:{book:pr,cursor:{row:0,column:0}}}),lr.value=""},cr.readAsText(or)},download=async(lr,or)=>{var yr,br;const ar=bookify(or),ur={...defaultFormats,...get_store_value(bookFormats)}[lr];if(ur===void 0||ur.encode===void 0)throw"Unsopported format";disableShortLinks(((br=(yr=ar.index.properties)==null?void 0:yr.disableShortLinks)==null?void 0:br.trim())=="true");const{encodedBook:hr,mimetype:fr,extension:dr,blob:pr=null}=await Promise.resolve(ur.encode(ar)),mr=`-${dateFormat.asString(get_store_value(s$2.dateFormat),new Date)}.${dr}`,gr=`${ar.index.title||"magebook"}${mr}`;if(hr){if(isVSCode){vscode.postMessage({type:"saveFile",suffix:mr,data:hr});return}const Or=document.createElement("a");Or.setAttribute("href",`data:${fr};charset=utf-8,${encodeURIComponent(hr)}`),Or.setAttribute("download",gr),Or.style.display="none",document.body.appendChild(Or),Or.click(),document.body.removeChild(Or);return}pr&&pr.then(Or=>{if(isVSCode){let _r=new FileReader;_r.onload=function(){vscode.postMessage({type:"saveFile",suffix:mr,blob:_r.result})},_r.readAsDataURL(Or);return}saveAs(Or,gr)})},file=Object.freeze(Object.defineProperty({__proto__:null,download,open:open$1},Symbol.toStringTag,{value:"Module"})),name="magebook",version="1.2.19",author="Luca Fabbian",email="luca.fabbian.1999@gmail.com",description="Interactive fiction editor",type="module",license="MIT",homepage="https://librogamesland.github.io/magebook",repository={type:"git",url:"https://github.com/librogamesland/magebook.git"},keywords=["lgl","librogamesland","librogame","gamebook","editor","rollup-plugin","vite-plugin"],types="index.d.ts",main="./index.js",module="./index.js",bin="./bin.js",peerDependencies={bun:"^1.0.1"},dependencies={jsdom:"^22.1.0"},manifest={name,version,author,email,description,type,license,homepage,repository,keywords,types,main,module,bin,peerDependencies,dependencies},logo=""+new URL("logo-d06f15d3.png",import.meta.url).href,About_svelte_svelte_type_style_lang="";function create_fragment$g(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr=lr[1]("about.text")+"",yr,br,Or=lr[1]("about.contact")+"",_r,vr,xr,wr,kr,Cr=lr[1]("dialogs.ok")+"",$r,Nr,Br;return{c(){or=element$1("div"),ar=element$1("h3"),ar.textContent=`Magebook - v. ${manifest.version}`,cr=space$3(),ur=element$1("img"),fr=space$3(),dr=element$1("br"),pr=space$3(),mr=element$1("p"),yr=space$3(),br=element$1("p"),_r=text(Or),vr=text(": "),xr=element$1("a"),xr.textContent="luca.fabbian.1999@gmail.com",wr=space$3(),kr=element$1("button"),$r=text(Cr),attr(ur,"class","mx-auto svelte-1qabtlc"),src_url_equal(ur.src,hr=logo)||attr(ur,"src",hr),attr(ur,"alt","Magebook logo"),attr(mr,"class","svelte-1qabtlc"),attr(xr,"target","_blank"),attr(xr,"rel","noopener"),attr(xr,"href","mailto:luca.fabbian.1999@gmail.com?subject=Magebook%20-%20Segnalazione"),attr(br,"class","svelte-1qabtlc"),attr(kr,"class","ok svelte-1qabtlc"),attr(or,"class","dialog svelte-1qabtlc")},m(Fr,Vr){insert$1(Fr,or,Vr),append(or,ar),append(or,cr),append(or,ur),append(or,fr),append(or,dr),append(or,pr),append(or,mr),mr.innerHTML=gr,append(or,yr),append(or,br),append(br,_r),append(br,vr),append(br,xr),append(or,wr),append(or,kr),append(kr,$r),Nr||(Br=listen(kr,"click",lr[3]),Nr=!0)},p(Fr,[Vr]){Vr&2&&gr!==(gr=Fr[1]("about.text")+"")&&(mr.innerHTML=gr),Vr&2&&Or!==(Or=Fr[1]("about.contact")+"")&&set_data(_r,Or),Vr&2&&Cr!==(Cr=Fr[1]("dialogs.ok")+"")&&set_data($r,Cr)},i:noop$2,o:noop$2,d(Fr){Fr&&detach(or),Nr=!1,Br()}}}function instance$g(lr,or,ar){let cr;component_subscribe(lr,$format,dr=>ar(1,cr=dr));let{params:ur}=or,{callback:hr}=or;const fr=()=>hr(!0);return lr.$$set=dr=>{"params"in dr&&ar(2,ur=dr.params),"callback"in dr&&ar(0,hr=dr.callback)},[hr,cr,ur,fr]}class About extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$g,create_fragment$g,safe_not_equal,{params:2,callback:0})}}function create_if_block$b(lr){let or,ar=lr[6]("dialogs.shuffle.savecopy")+"",cr,ur,hr;return{c(){or=element$1("button"),cr=text(ar),attr(or,"class","cancel")},m(fr,dr){insert$1(fr,or,dr),append(or,cr),ur||(hr=listen(or,"click",lr[10]),ur=!0)},p(fr,dr){dr&64&&ar!==(ar=fr[6]("dialogs.shuffle.savecopy")+"")&&set_data(cr,ar)},d(fr){fr&&detach(or),ur=!1,hr()}}}function create_fragment$f(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr=lr[6]("dialogs.ok")+"",gr,yr,br,Or,_r=lr[6]("dialogs.cancel")+"",vr,xr,wr,kr=lr[2]&&create_if_block$b(lr);return{c(){or=element$1("div"),ar=element$1("h3"),cr=text(lr[4]),ur=space$3(),hr=element$1("p"),fr=text(lr[3]),dr=space$3(),pr=element$1("button"),gr=text(mr),yr=space$3(),kr&&kr.c(),br=space$3(),Or=element$1("button"),vr=text(_r),attr(pr,"class","ok"),attr(Or,"class","cancel"),attr(or,"class","dialog")},m(Cr,$r){insert$1(Cr,or,$r),append(or,ar),append(ar,cr),append(or,ur),append(or,hr),append(hr,fr),append(or,dr),append(or,pr),append(pr,gr),append(or,yr),kr&&kr.m(or,null),append(or,br),append(or,Or),append(Or,vr),xr||(wr=[listen(pr,"click",lr[9]),listen(Or,"click",lr[11])],xr=!0)},p(Cr,[$r]){$r&16&&set_data(cr,Cr[4]),$r&8&&set_data(fr,Cr[3]),$r&64&&mr!==(mr=Cr[6]("dialogs.ok")+"")&&set_data(gr,mr),Cr[2]?kr?kr.p(Cr,$r):(kr=create_if_block$b(Cr),kr.c(),kr.m(or,br)):kr&&(kr.d(1),kr=null),$r&64&&_r!==(_r=Cr[6]("dialogs.cancel")+"")&&set_data(vr,_r)},i:noop$2,o:noop$2,d(Cr){Cr&&detach(or),kr&&kr.d(),xr=!1,run_all(wr)}}}function instance$f(lr,or,ar){let cr,ur,hr,fr,dr,pr=noop$2,mr=()=>(pr(),pr=subscribe(br,wr=>ar(7,dr=wr)),br),gr,yr;component_subscribe(lr,nullUntilLoaded,wr=>ar(8,gr=wr)),component_subscribe(lr,$format,wr=>ar(6,yr=wr)),lr.$$.on_destroy.push(()=>pr());let{params:br}=or;mr();let{callback:Or}=or;const _r=()=>Or(!0),vr=()=>download("md",cr),xr=()=>Or(!1);return lr.$$set=wr=>{"params"in wr&&mr(ar(0,br=wr.params)),"callback"in wr&&ar(1,Or=wr.callback)},lr.$$.update=()=>{lr.$$.dirty&256&&ar(5,{book:cr}=gr,cr),lr.$$.dirty&128&&ar(4,[ur,hr,fr]=dr,ur,(ar(3,hr),ar(7,dr)),(ar(2,fr),ar(7,dr)))},[br,Or,fr,hr,ur,cr,yr,dr,gr,_r,vr,xr]}class Confirm extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$f,create_fragment$f,safe_not_equal,{params:0,callback:1})}}const Graph_svelte_svelte_type_style_lang="";function create_if_block_2$4(lr){let or,ar,cr=lr[5]("dialogs.graph.loading")+"",ur,hr,fr;return{c(){or=element$1("div"),ar=element$1("p"),ur=text(cr),hr=space$3(),fr=element$1("div"),attr(fr,"class","spinner-1"),attr(or,"class","dialog"),set_style(or,"text-align","center")},m(dr,pr){insert$1(dr,or,pr),append(or,ar),append(ar,ur),append(or,hr),append(or,fr)},p(dr,pr){pr&32&&cr!==(cr=dr[5]("dialogs.graph.loading")+"")&&set_data(ur,cr)},d(dr){dr&&detach(or)}}}function create_if_block$a(lr){let or,ar,cr,ur,hr,fr;function dr(gr,yr){return isVSCode?create_if_block_1$4:create_else_block$2}let mr=dr()(lr);return{c(){or=element$1("div"),ar=element$1("div"),cr=space$3(),ur=element$1("div"),mr.c(),attr(ar,"role","button"),attr(ar,"tabindex","-1"),set_style(ar,"max-width","90vw"),set_style(ar,"max-height","80vh"),set_style(ar,"overflow","auto"),attr(or,"class","imgbox svelte-1r8lujl"),attr(or,"role","button"),attr(or,"tabindex","-1")},m(gr,yr){insert$1(gr,or,yr),append(or,ar),ar.innerHTML=lr[3],append(or,cr),append(or,ur),mr.m(ur,null),hr||(fr=[listen(ar,"click",stop_propagation(click_handler)),listen(or,"click",lr[11])],hr=!0)},p(gr,yr){yr&8&&(ar.innerHTML=gr[3]),mr.p(gr,yr)},d(gr){gr&&detach(or),mr.d(),hr=!1,run_all(fr)}}}function create_else_block$2(lr){let or,ar=lr[5]("dialogs.graph.open")+"",cr,ur,hr,fr=lr[5]("dialogs.graph.download")+"",dr,pr,mr;return{c(){or=element$1("button"),cr=text(ar),ur=space$3(),hr=element$1("button"),dr=text(fr),attr(or,"class","ok"),attr(hr,"class","error")},m(gr,yr){insert$1(gr,or,yr),append(or,cr),insert$1(gr,ur,yr),insert$1(gr,hr,yr),append(hr,dr),pr||(mr=[listen(or,"click",lr[9]),listen(hr,"click",lr[10])],pr=!0)},p(gr,yr){yr&32&&ar!==(ar=gr[5]("dialogs.graph.open")+"")&&set_data(cr,ar),yr&32&&fr!==(fr=gr[5]("dialogs.graph.download")+"")&&set_data(dr,fr)},d(gr){gr&&(detach(or),detach(ur),detach(hr)),pr=!1,run_all(mr)}}}function create_if_block_1$4(lr){let or,ar=lr[5]("dialogs.graph.download")+"",cr,ur,hr;return{c(){or=element$1("button"),cr=text(ar),attr(or,"class","error")},m(fr,dr){insert$1(fr,or,dr),append(or,cr),ur||(hr=listen(or,"click",lr[8]),ur=!0)},p(fr,dr){dr&32&&ar!==(ar=fr[5]("dialogs.graph.download")+"")&&set_data(cr,ar)},d(fr){fr&&detach(or),ur=!1,hr()}}}function create_fragment$e(lr){let or;function ar(hr,fr){if(hr[1])return create_if_block$a;if(hr[2])return create_if_block_2$4}let cr=ar(lr),ur=cr&&cr(lr);return{c(){ur&&ur.c(),or=empty$1()},m(hr,fr){ur&&ur.m(hr,fr),insert$1(hr,or,fr)},p(hr,[fr]){cr===(cr=ar(hr))&&ur?ur.p(hr,fr):(ur&&ur.d(1),ur=cr&&cr(hr),ur&&(ur.c(),ur.m(or.parentNode,or)))},i:noop$2,o:noop$2,d(hr){hr&&detach(or),ur&&ur.d(hr)}}}const click_handler=()=>{};function instance$e(lr,or,ar){let cr,ur,hr;component_subscribe(lr,nullUntilLoaded,xr=>ar(7,ur=xr)),component_subscribe(lr,$format,xr=>ar(5,hr=xr));let{params:fr}=or,{callback:dr}=or,pr=!1,mr=!1,gr="";const yr=fr.subscribe(async xr=>{ar(1,pr=!1),ar(2,mr=!0),await tick(),setTimeout(async()=>{ar(3,gr=(await Promise.resolve(xr[0]())).outerHTML),ar(1,pr=!0)},100)});onDestroy(yr);const br=()=>{const xr=`-${dateFormat.asString(get_store_value(s$2.dateFormat),new Date)}.svg`;vscode.postMessage({type:"saveFile",suffix:xr,blob:`data:image/svg+xml;base64,${encode$6(gr)}`})},Or=()=>{const xr=new window.Blob([gr],{type:"image/svg+xml"}),wr=URL.createObjectURL(xr),kr=window.open(wr);kr!=null&&(kr.onload=()=>URL.revokeObjectURL(wr))},_r=()=>{var wr;const xr=document.createElement("a");xr.setAttribute("href",`data:image/svg+xml;base64,${encode$6(gr)}`),xr.setAttribute("download",(((wr=cr.index)==null?void 0:wr.title)||"graph")+".svg"),xr.style.display="none",document.body.appendChild(xr),xr.click(),document.body.removeChild(xr)},vr=async()=>{ar(3,gr=""),await tick(),dr(!1)};return lr.$$set=xr=>{"params"in xr&&ar(6,fr=xr.params),"callback"in xr&&ar(0,dr=xr.callback)},lr.$$.update=()=>{lr.$$.dirty&128&&ar(4,{book:cr}=ur,cr)},[dr,pr,mr,gr,cr,hr,fr,ur,br,Or,_r,vr]}class Graph extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$e,create_fragment$e,safe_not_equal,{params:6,callback:0})}}const Remap_svelte_svelte_type_style_lang="";function get_each_context$5(lr,or,ar){const cr=lr.slice();return cr[21]=or[ar],cr}function get_each_context_1$5(lr,or,ar){const cr=lr.slice();return cr[24]=or[ar],cr}function create_each_block_1$5(lr){let or,ar=lr[24]+"",cr,ur;return{c(){or=element$1("option"),cr=text(ar),or.__value=ur=lr[24],set_input_value(or,or.__value)},m(hr,fr){insert$1(hr,or,fr),append(or,cr)},p(hr,fr){fr&128&&ar!==(ar=hr[24]+"")&&set_data(cr,ar),fr&128&&ur!==(ur=hr[24])&&(or.__value=ur,set_input_value(or,or.__value))},d(hr){hr&&detach(or)}}}function create_each_block$5(lr){let or,ar,cr,ur,hr,fr;function dr(){return lr[16](lr[21])}return{c(){or=element$1("button"),ar=element$1("img"),ur=space$3(),attr(ar,"class","inline-block w-6 h-6 mx-auto"),attr(ar,"alt",lr[21]),src_url_equal(ar.src,cr=lr[9][lr[21]])||attr(ar,"src",cr),attr(or,"class","svelte-17mv2g1"),toggle_class(or,"selected",lr[5][lr[21]])},m(pr,mr){insert$1(pr,or,mr),append(or,ar),append(or,ur),hr||(fr=listen(or,"click",dr),hr=!0)},p(pr,mr){lr=pr,mr&32&&toggle_class(or,"selected",lr[5][lr[21]])},d(pr){pr&&detach(or),hr=!1,fr()}}}function create_fragment$d(lr){let or,ar,cr=lr[8](`dialogs.remap.${lr[6]}.title`)+"",ur,hr,fr,dr=lr[8](`dialogs.remap.${lr[6]}.hint`)+"",pr,mr,gr,yr=lr[8]("dialogs.remap.group")+"",br,Or,_r,vr,xr,wr,kr,Cr,$r,Nr=lr[8]("sidemenu.allgroup")+"",Br,Fr,Vr,Rr=lr[8]("dialogs.remap.flags")+"",Gr,qr,Ur,Yr,Dr,Jr,ai=lr[8]("dialogs.ok")+"",Kr,ui,ii,di=lr[8]("dialogs.remap.savecopy")+"",ei,Wr,ti,si=lr[8]("dialogs.cancel")+"",ci,ni,Pr,Ar=ensure_array_like(lr[7]),Zr=[];for(let Xr=0;Xr<Ar.length;Xr+=1)Zr[Xr]=create_each_block_1$5(get_each_context_1$5(lr,Ar,Xr));let Mr=ensure_array_like(["fixed","noexport","final","death"]),jr=[];for(let Xr=0;Xr<4;Xr+=1)jr[Xr]=create_each_block$5(get_each_context$5(lr,Mr,Xr));return{c(){or=element$1("div"),ar=element$1("h3"),ur=text(cr),hr=space$3(),fr=element$1("p"),pr=text(dr),mr=space$3(),gr=element$1("h4"),br=text(yr),Or=text(":"),_r=space$3(),vr=element$1("div"),xr=element$1("input"),wr=space$3(),kr=element$1("span"),Cr=element$1("select"),$r=element$1("option"),Br=text(Nr);for(let Xr=0;Xr<Zr.length;Xr+=1)Zr[Xr].c();Fr=space$3(),Vr=element$1("h4"),Gr=text(Rr),qr=text(":"),Ur=space$3(),Yr=element$1("div");for(let Xr=0;Xr<4;Xr+=1)jr[Xr].c();Dr=space$3(),Jr=element$1("button"),Kr=text(ai),ui=space$3(),ii=element$1("button"),ei=text(di),Wr=space$3(),ti=element$1("button"),ci=text(si),attr(gr,"class","svelte-17mv2g1"),attr(xr,"type","text"),attr(xr,"class","svelte-17mv2g1"),$r.__value="allgroupidtag",set_input_value($r,$r.__value),lr[2]===void 0&&add_render_callback(()=>lr[15].call(Cr)),attr(kr,"class","select-dropdown svelte-17mv2g1"),set_style(kr,"margin-left","5px"),attr(vr,"class","input svelte-17mv2g1"),attr(Vr,"class","svelte-17mv2g1"),attr(Yr,"class","flags svelte-17mv2g1"),attr(Jr,"class","ok"),attr(ii,"class","cancel"),attr(ti,"class","cancel"),attr(or,"class","dialog svelte-17mv2g1")},m(Xr,ri){insert$1(Xr,or,ri),append(or,ar),append(ar,ur),append(or,hr),append(or,fr),append(fr,pr),append(or,mr),append(or,gr),append(gr,br),append(gr,Or),append(or,_r),append(or,vr),append(vr,xr),set_input_value(xr,lr[4]),append(vr,wr),append(vr,kr),append(kr,Cr),append(Cr,$r),append($r,Br);for(let Lr=0;Lr<Zr.length;Lr+=1)Zr[Lr]&&Zr[Lr].m(Cr,null);select_option(Cr,lr[2],!0),append(or,Fr),append(or,Vr),append(Vr,Gr),append(Vr,qr),append(or,Ur),append(or,Yr);for(let Lr=0;Lr<4;Lr+=1)jr[Lr]&&jr[Lr].m(Yr,null);append(or,Dr),append(or,Jr),append(Jr,Kr),append(or,ui),append(or,ii),append(ii,ei),append(or,Wr),append(or,ti),append(ti,ci),ni||(Pr=[listen(xr,"input",lr[14]),listen(Cr,"change",lr[15]),listen(Jr,"click",lr[10]),listen(ii,"click",lr[17]),listen(ti,"click",lr[18])],ni=!0)},p(Xr,[ri]){if(ri&320&&cr!==(cr=Xr[8](`dialogs.remap.${Xr[6]}.title`)+"")&&set_data(ur,cr),ri&320&&dr!==(dr=Xr[8](`dialogs.remap.${Xr[6]}.hint`)+"")&&set_data(pr,dr),ri&256&&yr!==(yr=Xr[8]("dialogs.remap.group")+"")&&set_data(br,yr),ri&16&&xr.value!==Xr[4]&&set_input_value(xr,Xr[4]),ri&256&&Nr!==(Nr=Xr[8]("sidemenu.allgroup")+"")&&set_data(Br,Nr),ri&128){Ar=ensure_array_like(Xr[7]);let Lr;for(Lr=0;Lr<Ar.length;Lr+=1){const oi=get_each_context_1$5(Xr,Ar,Lr);Zr[Lr]?Zr[Lr].p(oi,ri):(Zr[Lr]=create_each_block_1$5(oi),Zr[Lr].c(),Zr[Lr].m(Cr,null))}for(;Lr<Zr.length;Lr+=1)Zr[Lr].d(1);Zr.length=Ar.length}if(ri&132&&select_option(Cr,Xr[2]),ri&256&&Rr!==(Rr=Xr[8]("dialogs.remap.flags")+"")&&set_data(Gr,Rr),ri&544){Mr=ensure_array_like(["fixed","noexport","final","death"]);let Lr;for(Lr=0;Lr<4;Lr+=1){const oi=get_each_context$5(Xr,Mr,Lr);jr[Lr]?jr[Lr].p(oi,ri):(jr[Lr]=create_each_block$5(oi),jr[Lr].c(),jr[Lr].m(Yr,null))}for(;Lr<4;Lr+=1)jr[Lr].d(1)}ri&256&&ai!==(ai=Xr[8]("dialogs.ok")+"")&&set_data(Kr,ai),ri&256&&di!==(di=Xr[8]("dialogs.remap.savecopy")+"")&&set_data(ei,di),ri&256&&si!==(si=Xr[8]("dialogs.cancel")+"")&&set_data(ci,si)},i:noop$2,o:noop$2,d(Xr){Xr&&detach(or),destroy_each(Zr,Xr),destroy_each(jr,Xr),ni=!1,run_all(Pr)}}}function instance$d(lr,or,ar){let cr,ur,hr,fr,dr,pr,mr=noop$2,gr=()=>(mr(),mr=subscribe(cr,Ur=>ar(11,pr=Ur)),cr),yr,br=noop$2,Or=()=>(br(),br=subscribe(wr,Ur=>ar(12,yr=Ur)),wr),_r,vr;component_subscribe(lr,isFirebase,Ur=>ar(20,dr=Ur)),component_subscribe(lr,nullUntilLoaded,Ur=>ar(13,_r=Ur)),component_subscribe(lr,$format,Ur=>ar(8,vr=Ur)),lr.$$.on_destroy.push(()=>mr()),lr.$$.on_destroy.push(()=>br());let xr={fixed,noexport,death,final},{params:wr}=or;Or();let{callback:kr}=or,Cr="",$r={fixed:!0,noexport:!1,final:!1,death:!1},Nr="allgroupidtag";const Br=()=>{const Ur=Object.keys($r).filter(ai=>$r[ai]),Yr=Cr.split(",").map(ai=>ai.trim()).filter(ai=>ai),Jr={shuffle:()=>shuffleBook(cr,{selectedFlags:Ur,groupsFilter:Yr}),sort:()=>sortBook(cr,{selectedFlags:Ur,groupsFilter:Yr}),compact:()=>compactBook(cr,{selectedFlags:Ur,groupsFilter:Yr})}[hr]();if(dr||isVSCode||hr!=="shuffle"){cr.set(Jr),kr(!1);return}session.open({data:{book:Jr,cursor:{row:0,column:0},title:cr.index.title}})};function Fr(){Cr=this.value,ar(4,Cr),ar(2,Nr)}function Vr(){Nr=select_value(this),ar(2,Nr),ar(4,Cr),ar(7,fr),ar(3,cr),ar(11,pr),ar(13,_r)}const Rr=Ur=>ar(5,$r[Ur]=!$r[Ur],$r),Gr=()=>download("md",cr),qr=()=>kr(!1);return lr.$$set=Ur=>{"params"in Ur&&Or(ar(0,wr=Ur.params)),"callback"in Ur&&ar(1,kr=Ur.callback)},lr.$$.update=()=>{lr.$$.dirty&8192&&gr(ar(3,{book:cr,editor:ur}=_r,cr)),lr.$$.dirty&4096&&ar(6,[hr]=yr,hr),lr.$$.dirty&2056&&ar(7,fr=cr?[...Object.keys(pr.index.chaptersWith.group)]:[]),lr.$$.dirty&20&&Nr!="allgroupidtag"&&(ar(4,Cr+=Nr+", "),tick().then(()=>{ar(2,Nr="allgroupidtag")}))},[wr,kr,Nr,cr,Cr,$r,hr,fr,vr,xr,Br,pr,yr,_r,Fr,Vr,Rr,Gr,qr]}class Remap extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$d,create_fragment$d,safe_not_equal,{params:0,callback:1})}}function create_fragment$c(lr){let or,ar,cr=lr[1]("dialogs.newbook.new")+"",ur,hr,fr,dr=lr[1]("dialogs.newbook.hint")+"",pr,mr,gr=lr[1]("dialogs.ok")+"",yr,br,Or,_r=lr[1]("dialogs.cancel")+"",vr,xr,wr;return{c(){or=element$1("div"),ar=element$1("h3"),ur=text(cr),hr=space$3(),fr=element$1("p"),pr=space$3(),mr=element$1("button"),yr=text(gr),br=space$3(),Or=element$1("button"),vr=text(_r),set_style(fr,"margin","1rem 0"),attr(mr,"class","ok"),attr(Or,"class","cancel"),attr(or,"class","dialog")},m(kr,Cr){insert$1(kr,or,Cr),append(or,ar),append(ar,ur),append(or,hr),append(or,fr),fr.innerHTML=dr,append(or,pr),append(or,mr),append(mr,yr),append(or,br),append(or,Or),append(Or,vr),xr||(wr=[listen(mr,"click",lr[4]),listen(Or,"click",lr[5])],xr=!0)},p(kr,[Cr]){Cr&2&&cr!==(cr=kr[1]("dialogs.newbook.new")+"")&&set_data(ur,cr),Cr&2&&dr!==(dr=kr[1]("dialogs.newbook.hint")+"")&&(fr.innerHTML=dr),Cr&2&&gr!==(gr=kr[1]("dialogs.ok")+"")&&set_data(yr,gr),Cr&2&&_r!==(_r=kr[1]("dialogs.cancel")+"")&&set_data(vr,_r)},i:noop$2,o:noop$2,d(kr){kr&&detach(or),xr=!1,run_all(wr)}}}function instance$c(lr,or,ar){let cr;component_subscribe(lr,$format,mr=>ar(1,cr=mr));let{params:ur}=or,{callback:hr}=or;const fr=()=>session.open({data:{book:cr("books.local"),cursor:{row:0,column:0}}}),dr=()=>fr(),pr=()=>hr(!1);return lr.$$set=mr=>{"params"in mr&&ar(3,ur=mr.params),"callback"in mr&&ar(0,hr=mr.callback)},[hr,cr,fr,ur,dr,pr]}class NewBook extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$c,create_fragment$c,safe_not_equal,{params:3,callback:0})}}const NewFirebook_svelte_svelte_type_style_lang="";function create_fragment$b(lr){let or,ar,cr,ur=lr[4]("dialogs.newfirebook.new")+"",hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,xr,wr,kr,Cr=lr[4]("dialogs.newfirebook.book")+"",$r,Nr,Br,Fr,Vr,Rr,Gr=lr[4]("dialogs.newfirebook.getStarted")+"",qr,Ur,Yr=lr[4]("dialogs.ok")+"",Dr,Jr,ai,Kr,ui=lr[4]("dialogs.cancel")+"",ii,di,ei;return{c(){or=element$1("div"),ar=element$1("form"),cr=element$1("h3"),hr=text(ur),fr=space$3(),dr=element$1("div"),pr=element$1("span"),pr.textContent="apiKey:",mr=space$3(),gr=element$1("input"),yr=space$3(),br=element$1("div"),Or=element$1("span"),Or.textContent="databaseURL:",_r=space$3(),vr=element$1("input"),xr=space$3(),wr=element$1("div"),kr=element$1("span"),$r=text(Cr),Nr=text(":"),Br=space$3(),Fr=element$1("input"),Vr=space$3(),Rr=element$1("p"),qr=space$3(),Ur=element$1("button"),Dr=text(Yr),ai=space$3(),Kr=element$1("button"),ii=text(ui),attr(pr,"class","svelte-d2z8hg"),attr(gr,"name","password"),attr(gr,"type","password"),attr(gr,"class","svelte-d2z8hg"),attr(dr,"class","input svelte-d2z8hg"),attr(Or,"class","svelte-d2z8hg"),attr(vr,"name","user"),attr(vr,"type","text"),attr(vr,"class","svelte-d2z8hg"),attr(br,"class","input svelte-d2z8hg"),attr(kr,"class","svelte-d2z8hg"),attr(Fr,"type","text"),attr(Fr,"class","svelte-d2z8hg"),attr(wr,"class","input svelte-d2z8hg"),attr(Rr,"class","getstarted"),set_style(Rr,"margin","1rem 0"),Ur.disabled=Jr=!lr[3]||!lr[1]||!lr[2],attr(Ur,"class","ok"),attr(Kr,"class","cancel"),attr(ar,"method","post"),attr(ar,"action","/signin"),attr(or,"class","dialog svelte-d2z8hg")},m(Wr,ti){insert$1(Wr,or,ti),append(or,ar),append(ar,cr),append(cr,hr),append(ar,fr),append(ar,dr),append(dr,pr),append(dr,mr),append(dr,gr),set_input_value(gr,lr[1]),append(ar,yr),append(ar,br),append(br,Or),append(br,_r),append(br,vr),set_input_value(vr,lr[2]),append(ar,xr),append(ar,wr),append(wr,kr),append(kr,$r),append(kr,Nr),append(wr,Br),append(wr,Fr),set_input_value(Fr,lr[3]),append(ar,Vr),append(ar,Rr),Rr.innerHTML=Gr,append(ar,qr),append(ar,Ur),append(Ur,Dr),append(ar,ai),append(ar,Kr),append(Kr,ii),di||(ei=[listen(gr,"input",lr[8]),listen(vr,"input",lr[9]),listen(Fr,"input",lr[10]),listen(Ur,"click",lr[11]),listen(Kr,"click",lr[12]),listen(ar,"submit",prevent_default(lr[7]))],di=!0)},p(Wr,[ti]){ti&16&&ur!==(ur=Wr[4]("dialogs.newfirebook.new")+"")&&set_data(hr,ur),ti&2&&gr.value!==Wr[1]&&set_input_value(gr,Wr[1]),ti&4&&vr.value!==Wr[2]&&set_input_value(vr,Wr[2]),ti&16&&Cr!==(Cr=Wr[4]("dialogs.newfirebook.book")+"")&&set_data($r,Cr),ti&8&&Fr.value!==Wr[3]&&set_input_value(Fr,Wr[3]),ti&16&&Gr!==(Gr=Wr[4]("dialogs.newfirebook.getStarted")+"")&&(Rr.innerHTML=Gr),ti&16&&Yr!==(Yr=Wr[4]("dialogs.ok")+"")&&set_data(Dr,Yr),ti&14&&Jr!==(Jr=!Wr[3]||!Wr[1]||!Wr[2])&&(Ur.disabled=Jr),ti&16&&ui!==(ui=Wr[4]("dialogs.cancel")+"")&&set_data(ii,ui)},i:noop$2,o:noop$2,d(Wr){Wr&&detach(or),di=!1,run_all(ei)}}}function instance$b(lr,or,ar){let cr;component_subscribe(lr,$format,xr=>ar(4,cr=xr));let{params:ur}=or,{callback:hr}=or,fr="",dr="",pr="";const mr=()=>{const xr={apiKey:fr.replaceAll('",',"").replaceAll('"',"").replaceAll("apiKey:","").trim(),databaseURL:dr.replaceAll('",',"").replaceAll('"',"").replaceAll("databaseURL:","").trim(),book:pr},wr=encodeURIComponent(encode$6(JSON.stringify(xr)));location.assign(`#fsession=${wr}`),location.reload()};function gr(xr){bubble.call(this,lr,xr)}function yr(){fr=this.value,ar(1,fr)}function br(){dr=this.value,ar(2,dr)}function Or(){pr=this.value,ar(3,pr)}const _r=()=>mr(),vr=()=>hr(!1);return lr.$$set=xr=>{"params"in xr&&ar(6,ur=xr.params),"callback"in xr&&ar(0,hr=xr.callback)},[hr,fr,dr,pr,cr,mr,ur,gr,yr,br,Or,_r,vr]}class NewFirebook extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$b,create_fragment$b,safe_not_equal,{params:6,callback:0})}}const Recover_svelte_svelte_type_style_lang="";function get_each_context$4(lr,or,ar){const cr=lr.slice();return cr[4]=or[ar][0],cr[5]=or[ar][1],cr}function get_each_context_1$4(lr,or,ar){const cr=lr.slice();return cr[5]=or[ar],cr}function create_catch_block$1(lr){return{c:noop$2,m:noop$2,d:noop$2}}function create_then_block$1(lr){let or,ar=ensure_array_like(lr[8]),cr=[];for(let ur=0;ur<ar.length;ur+=1)cr[ur]=create_each_block_1$4(get_each_context_1$4(lr,ar,ur));return{c(){or=element$1("ul");for(let ur=0;ur<cr.length;ur+=1)cr[ur].c();attr(or,"class","svelte-5d1vqe")},m(ur,hr){insert$1(ur,or,hr);for(let fr=0;fr<cr.length;fr+=1)cr[fr]&&cr[fr].m(or,null)},d(ur){ur&&detach(or),destroy_each(cr,ur)}}}function create_each_block_1$4(lr){let or,ar,cr=lr[5].name+"",ur,hr,fr;return{c(){or=element$1("li"),ar=element$1("a"),ur=text(cr),hr=space$3(),fr=element$1("span"),fr.textContent=`${lr[5].time.toLocaleDateString()} ${lr[5].time.toLocaleTimeString()}`,attr(fr,"class","svelte-5d1vqe"),attr(ar,"href","#msession="+lr[5].id),attr(ar,"class","svelte-5d1vqe"),attr(or,"class","svelte-5d1vqe")},m(dr,pr){insert$1(dr,or,pr),append(or,ar),append(ar,ur),append(ar,hr),append(ar,fr)},p:noop$2,d(dr){dr&&detach(or)}}}function create_pending_block$1(lr){let or;return{c(){or=text("Loading...")},m(ar,cr){insert$1(ar,or,cr)},d(ar){ar&&detach(or)}}}function create_if_block$9(lr){let or,ar=lr[1]("navbar.file.recoverFire")+"",cr,ur,hr,fr=ensure_array_like(Object.entries(JSON.parse(localStorage[firebaseSessionsKey])).sort(func)),dr=[];for(let pr=0;pr<fr.length;pr+=1)dr[pr]=create_each_block$4(get_each_context$4(lr,fr,pr));return{c(){or=element$1("h3"),cr=text(ar),ur=space$3(),hr=element$1("ul");for(let pr=0;pr<dr.length;pr+=1)dr[pr].c();attr(or,"class","svelte-5d1vqe"),attr(hr,"class","svelte-5d1vqe")},m(pr,mr){insert$1(pr,or,mr),append(or,cr),insert$1(pr,ur,mr),insert$1(pr,hr,mr);for(let gr=0;gr<dr.length;gr+=1)dr[gr]&&dr[gr].m(hr,null)},p(pr,mr){if(mr&2&&ar!==(ar=pr[1]("navbar.file.recoverFire")+"")&&set_data(cr,ar),mr&0){fr=ensure_array_like(Object.entries(JSON.parse(localStorage[firebaseSessionsKey])).sort(func));let gr;for(gr=0;gr<fr.length;gr+=1){const yr=get_each_context$4(pr,fr,gr);dr[gr]?dr[gr].p(yr,mr):(dr[gr]=create_each_block$4(yr),dr[gr].c(),dr[gr].m(hr,null))}for(;gr<dr.length;gr+=1)dr[gr].d(1);dr.length=fr.length}},d(pr){pr&&(detach(or),detach(ur),detach(hr)),destroy_each(dr,pr)}}}function create_each_block$4(lr){let or,ar,cr=lr[5].name+"",ur,hr,fr;return{c(){or=element$1("li"),ar=element$1("a"),ur=text(cr),hr=space$3(),fr=element$1("span"),fr.textContent=`${new Date(lr[5].time).toLocaleDateString()} ${new Date(lr[5].time).toLocaleTimeString()}`,attr(fr,"class","svelte-5d1vqe"),attr(ar,"href","#fsession="+lr[4]),attr(ar,"class","svelte-5d1vqe"),attr(or,"class","svelte-5d1vqe")},m(dr,pr){insert$1(dr,or,pr),append(or,ar),append(ar,ur),append(ar,hr),append(ar,fr)},p:noop$2,d(dr){dr&&detach(or)}}}function create_fragment$a(lr){let or,ar,cr=lr[1]("navbar.file.recover")+"",ur,hr,fr,dr,pr,mr=lr[1]("dialogs.cancel")+"",gr,yr,br,Or={ctx:lr,current:null,token:null,hasCatch:!1,pending:create_pending_block$1,then:create_then_block$1,catch:create_catch_block$1,value:8};handle_promise(previews(),Or);let _r=localStorage[firebaseSessionsKey]&&create_if_block$9(lr);return{c(){or=element$1("div"),ar=element$1("h3"),ur=text(cr),hr=space$3(),Or.block.c(),fr=space$3(),_r&&_r.c(),dr=space$3(),pr=element$1("button"),gr=text(mr),attr(ar,"class","svelte-5d1vqe"),attr(pr,"class","cancel"),attr(or,"class","dialog recover")},m(vr,xr){insert$1(vr,or,xr),append(or,ar),append(ar,ur),append(or,hr),Or.block.m(or,Or.anchor=null),Or.mount=()=>or,Or.anchor=fr,append(or,fr),_r&&_r.m(or,null),append(or,dr),append(or,pr),append(pr,gr),yr||(br=listen(pr,"click",lr[3]),yr=!0)},p(vr,[xr]){lr=vr,xr&2&&cr!==(cr=lr[1]("navbar.file.recover")+"")&&set_data(ur,cr),localStorage[firebaseSessionsKey]&&_r.p(lr,xr),xr&2&&mr!==(mr=lr[1]("dialogs.cancel")+"")&&set_data(gr,mr)},i:noop$2,o:noop$2,d(vr){vr&&detach(or),Or.block.d(),Or.token=null,Or=null,_r&&_r.d(),yr=!1,br()}}}const func=([lr,or],[ar,cr])=>cr.time-or.time;function instance$a(lr,or,ar){let cr;component_subscribe(lr,$format,dr=>ar(1,cr=dr));let{params:ur}=or,{callback:hr}=or;const fr=()=>hr(!1);return lr.$$set=dr=>{"params"in dr&&ar(2,ur=dr.params),"callback"in dr&&ar(0,hr=dr.callback)},[hr,cr,ur,fr]}class Recover extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$a,create_fragment$a,safe_not_equal,{params:2,callback:0})}}const Settings_svelte_svelte_type_style_lang="",{Boolean:Boolean_1}=globals;function get_each_context$3(lr,or,ar){const cr=lr.slice();return cr[43]=or[ar][0],cr[44]=or[ar][1],cr[45]=or,cr[46]=ar,cr}function get_each_context_1$3(lr,or,ar){const cr=lr.slice();return cr[27]=or[ar],cr}function create_catch_block(lr){return{c:noop$2,m:noop$2,p:noop$2,d:noop$2}}function create_then_block(lr){let or,ar=ensure_array_like(lr[47]),cr=[];for(let ur=0;ur<ar.length;ur+=1)cr[ur]=create_each_block_1$3(get_each_context_1$3(lr,ar,ur));return{c(){for(let ur=0;ur<cr.length;ur+=1)cr[ur].c();or=empty$1()},m(ur,hr){for(let fr=0;fr<cr.length;fr+=1)cr[fr]&&cr[fr].m(ur,hr);insert$1(ur,or,hr)},p(ur,hr){if(hr[0]&67108864){ar=ensure_array_like(ur[47]);let fr;for(fr=0;fr<ar.length;fr+=1){const dr=get_each_context_1$3(ur,ar,fr);cr[fr]?cr[fr].p(dr,hr):(cr[fr]=create_each_block_1$3(dr),cr[fr].c(),cr[fr].m(or.parentNode,or))}for(;fr<cr.length;fr+=1)cr[fr].d(1);cr.length=ar.length}},d(ur){ur&&detach(or),destroy_each(cr,ur)}}}function create_each_block_1$3(lr){let or;return{c(){or=element$1("option"),or.__value=lr[27],set_input_value(or,or.__value)},m(ar,cr){insert$1(ar,or,cr)},p:noop$2,d(ar){ar&&detach(or)}}}function create_pending_block(lr){return{c:noop$2,m:noop$2,p:noop$2,d:noop$2}}function create_if_block$8(lr){let or,ar,cr,ur,hr;function fr(mr){lr[40](mr,lr[43])}var dr=lr[44];function pr(mr,gr){let yr={};return mr[1][mr[43]]!==void 0&&(yr.callback=mr[1][mr[43]]),{props:yr}}return dr&&(or=construct_svelte_component(dr,pr(lr)),binding_callbacks.push(()=>bind(or,"callback",fr))),{c(){or&&create_component(or.$$.fragment),cr=space$3(),ur=element$1("tr"),set_style(ur,"height","15px")},m(mr,gr){or&&mount_component(or,mr,gr),insert$1(mr,cr,gr),insert$1(mr,ur,gr),hr=!0},p(mr,gr){if(lr=mr,gr[0]&16384&&dr!==(dr=lr[44])){if(or){group_outros();const yr=or;transition_out(yr.$$.fragment,1,0,()=>{destroy_component(yr,1)}),check_outros()}dr?(or=construct_svelte_component(dr,pr(lr)),binding_callbacks.push(()=>bind(or,"callback",fr)),create_component(or.$$.fragment),transition_in(or.$$.fragment,1),mount_component(or,cr.parentNode,cr)):or=null}else if(dr){const yr={};!ar&&gr[0]&16386&&(ar=!0,yr.callback=lr[1][lr[43]],add_flush_callback(()=>ar=!1)),or.$set(yr)}},i(mr){hr||(or&&transition_in(or.$$.fragment,mr),hr=!0)},o(mr){or&&transition_out(or.$$.fragment,mr),hr=!1},d(mr){mr&&(detach(cr),detach(ur)),or&&destroy_component(or,mr)}}}function create_each_block$3(lr){let or,ar,cr=lr[44]&&create_if_block$8(lr);return{c(){cr&&cr.c(),or=empty$1()},m(ur,hr){cr&&cr.m(ur,hr),insert$1(ur,or,hr),ar=!0},p(ur,hr){ur[44]?cr?(cr.p(ur,hr),hr[0]&16384&&transition_in(cr,1)):(cr=create_if_block$8(ur),cr.c(),transition_in(cr,1),cr.m(or.parentNode,or)):cr&&(group_outros(),transition_out(cr,1,1,()=>{cr=null}),check_outros())},i(ur){ar||(transition_in(cr),ar=!0)},o(ur){transition_out(cr),ar=!1},d(ur){ur&&detach(or),cr&&cr.d(ur)}}}function create_fragment$9(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,xr,wr,kr,Cr,$r,Nr,Br,Fr,Vr,Rr,Gr,qr,Ur,Yr,Dr,Jr,ai,Kr,ui,ii,di,ei,Wr,ti,si,ci,ni,Pr,Ar,Zr,Mr,jr,Xr,ri,Lr,oi,Tr,Sr,Er,Ir,Qr,zr,Hr,li,pi,hi,fi,mi,gi,_i,yi,Oi,Ii,vi,Ti,Mi,ki,Bi,Zi,Qi,$i,Ui,Pi,Li,ns,Hi,Wi,Vi=lr[15]("dialogs.ok")+"",Gi,ji,qi,rs,Ai={ctx:lr,current:null,token:null,hasCatch:!1,pending:create_pending_block,then:create_then_block,catch:create_catch_block,value:47};handle_promise(lr[26],Ai);let Di=ensure_array_like(lr[14].entries()),Si=[];for(let xi=0;xi<Di.length;xi+=1)Si[xi]=create_each_block$3(get_each_context$3(lr,Di,xi));const ls=xi=>transition_out(Si[xi],1,1,()=>{Si[xi]=null});return{c(){or=element$1("div"),ar=element$1("h3"),ar.textContent="Settings",cr=space$3(),ur=element$1("div"),hr=element$1("table"),fr=element$1("tr"),dr=element$1("th"),dr.textContent="single-chapter-mode:",pr=space$3(),mr=element$1("td"),gr=element$1("input"),yr=space$3(),br=element$1("tr"),Or=element$1("th"),Or.textContent="count-chars:",_r=space$3(),vr=element$1("td"),xr=element$1("input"),wr=space$3(),kr=element$1("tr"),Cr=element$1("th"),Cr.textContent="font-family:",$r=space$3(),Nr=element$1("td"),Br=element$1("input"),Fr=space$3(),Vr=element$1("datalist"),Ai.block.c(),Rr=space$3(),Gr=element$1("tr"),qr=element$1("th"),qr.textContent="font-size (pt):",Ur=space$3(),Yr=element$1("td"),Dr=element$1("input"),Jr=space$3(),ai=element$1("tr"),Kr=space$3(),ui=element$1("tr"),ii=element$1("th"),ii.textContent="page-width (mm):",di=space$3(),ei=element$1("td"),Wr=element$1("input"),ti=space$3(),si=element$1("tr"),ci=element$1("th"),ci.textContent="page-zoom (%):",ni=space$3(),Pr=element$1("td"),Ar=element$1("input"),Zr=space$3(),Mr=element$1("tr"),jr=space$3(),Xr=element$1("tr"),ri=element$1("th"),ri.textContent="line-spacing:",Lr=space$3(),oi=element$1("td"),Tr=element$1("input"),Sr=space$3(),Er=element$1("tr"),Ir=element$1("th"),Ir.textContent="line-margin:",Qr=space$3(),zr=element$1("td"),Hr=element$1("input"),li=space$3(),pi=element$1("tr"),hi=element$1("th"),hi.textContent="title-highlight:",fi=space$3(),mi=element$1("td"),gi=element$1("input"),_i=space$3(),yi=element$1("tr"),Oi=element$1("th"),Oi.textContent="justify-text:",Ii=space$3(),vi=element$1("td"),Ti=element$1("input"),Mi=space$3(),ki=element$1("tr"),Bi=element$1("th"),Bi.textContent="date-format:",Zi=space$3(),Qi=element$1("td"),$i=element$1("input"),Ui=space$3(),Pi=element$1("tr"),Li=space$3();for(let xi=0;xi<Si.length;xi+=1)Si[xi].c();ns=space$3(),Hi=element$1("div"),Wi=element$1("button"),Gi=text(Vi),attr(gr,"type","range"),attr(gr,"min","1"),attr(gr,"max","2"),attr(xr,"type","range"),attr(xr,"min","1"),attr(xr,"max","2"),attr(Br,"type","text"),attr(Br,"list","fonts"),attr(Vr,"id","fonts"),attr(Dr,"type","number"),attr(Dr,"min","2"),attr(Dr,"max","50"),set_style(ai,"height","15px"),attr(Wr,"type","number"),attr(Wr,"min","1"),attr(Wr,"max","400"),attr(Ar,"type","number"),attr(Ar,"min","10"),attr(Ar,"max","400"),set_style(Mr,"height","15px"),attr(Tr,"type","text"),attr(Hr,"type","number"),attr(Hr,"min","0"),attr(Hr,"max","15"),attr(gi,"type","range"),attr(gi,"min","1"),attr(gi,"max","2"),attr(Ti,"type","range"),attr(Ti,"min","1"),attr(Ti,"max","2"),attr($i,"type","text"),set_style(Pi,"height","15px"),attr(hr,"class","min-w-[300px] overflow-x-auto svelte-1kulz2v"),attr(ur,"class","settings flex-1 svelte-1kulz2v"),attr(Wi,"class","ok svelte-1kulz2v"),attr(or,"class","dialog w-[600px] h-[600px] max-h-[90vh] flex flex-col svelte-1kulz2v")},m(xi,wi){insert$1(xi,or,wi),append(or,ar),append(or,cr),append(or,ur),append(ur,hr),append(hr,fr),append(fr,dr),append(fr,pr),append(fr,mr),append(mr,gr),set_input_value(gr,lr[3]),append(hr,yr),append(hr,br),append(br,Or),append(br,_r),append(br,vr),append(vr,xr),set_input_value(xr,lr[4]),append(hr,wr),append(hr,kr),append(kr,Cr),append(kr,$r),append(kr,Nr),append(Nr,Br),set_input_value(Br,lr[5]),append(Nr,Fr),append(Nr,Vr),Ai.block.m(Vr,Ai.anchor=null),Ai.mount=()=>Vr,Ai.anchor=null,append(hr,Rr),append(hr,Gr),append(Gr,qr),append(Gr,Ur),append(Gr,Yr),append(Yr,Dr),set_input_value(Dr,lr[6]),append(hr,Jr),append(hr,ai),append(hr,Kr),append(hr,ui),append(ui,ii),append(ui,di),append(ui,ei),append(ei,Wr),set_input_value(Wr,lr[7]),append(hr,ti),append(hr,si),append(si,ci),append(si,ni),append(si,Pr),append(Pr,Ar),set_input_value(Ar,lr[8]),append(hr,Zr),append(hr,Mr),append(hr,jr),append(hr,Xr),append(Xr,ri),append(Xr,Lr),append(Xr,oi),append(oi,Tr),set_input_value(Tr,lr[9]),append(hr,Sr),append(hr,Er),append(Er,Ir),append(Er,Qr),append(Er,zr),append(zr,Hr),set_input_value(Hr,lr[10]),append(hr,li),append(hr,pi),append(pi,hi),append(pi,fi),append(pi,mi),append(mi,gi),set_input_value(gi,lr[11]),append(hr,_i),append(hr,yi),append(yi,Oi),append(yi,Ii),append(yi,vi),append(vi,Ti),set_input_value(Ti,lr[12]),append(hr,Mi),append(hr,ki),append(ki,Bi),append(ki,Zi),append(ki,Qi),append(Qi,$i),set_input_value($i,lr[13]),append(hr,Ui),append(hr,Pi),append(hr,Li);for(let Ei=0;Ei<Si.length;Ei+=1)Si[Ei]&&Si[Ei].m(hr,null);append(or,ns),append(or,Hi),append(Hi,Wi),append(Wi,Gi),ji=!0,qi||(rs=[listen(gr,"change",lr[29]),listen(gr,"input",lr[29]),listen(xr,"change",lr[30]),listen(xr,"input",lr[30]),listen(Br,"input",lr[31]),listen(Dr,"input",lr[32]),listen(Wr,"input",lr[33]),listen(Ar,"input",lr[34]),listen(Tr,"input",lr[35]),listen(Hr,"input",lr[36]),listen(gi,"change",lr[37]),listen(gi,"input",lr[37]),listen(Ti,"change",lr[38]),listen(Ti,"input",lr[38]),listen($i,"input",lr[39]),listen(Wi,"click",lr[41])],qi=!0)},p(xi,wi){if(lr=xi,wi[0]&8&&set_input_value(gr,lr[3]),wi[0]&16&&set_input_value(xr,lr[4]),wi[0]&32&&Br.value!==lr[5]&&set_input_value(Br,lr[5]),update_await_block_branch(Ai,lr,wi),wi[0]&64&&to_number(Dr.value)!==lr[6]&&set_input_value(Dr,lr[6]),wi[0]&128&&to_number(Wr.value)!==lr[7]&&set_input_value(Wr,lr[7]),wi[0]&256&&to_number(Ar.value)!==lr[8]&&set_input_value(Ar,lr[8]),wi[0]&512&&Tr.value!==lr[9]&&set_input_value(Tr,lr[9]),wi[0]&1024&&to_number(Hr.value)!==lr[10]&&set_input_value(Hr,lr[10]),wi[0]&2048&&set_input_value(gi,lr[11]),wi[0]&4096&&set_input_value(Ti,lr[12]),wi[0]&8192&&$i.value!==lr[13]&&set_input_value($i,lr[13]),wi[0]&16386){Di=ensure_array_like(lr[14].entries());let Ei;for(Ei=0;Ei<Di.length;Ei+=1){const is=get_each_context$3(lr,Di,Ei);Si[Ei]?(Si[Ei].p(is,wi),transition_in(Si[Ei],1)):(Si[Ei]=create_each_block$3(is),Si[Ei].c(),transition_in(Si[Ei],1),Si[Ei].m(hr,null))}for(group_outros(),Ei=Di.length;Ei<Si.length;Ei+=1)ls(Ei);check_outros()}(!ji||wi[0]&32768)&&Vi!==(Vi=lr[15]("dialogs.ok")+"")&&set_data(Gi,Vi)},i(xi){if(!ji){for(let wi=0;wi<Di.length;wi+=1)transition_in(Si[wi]);ji=!0}},o(xi){Si=Si.filter(Boolean_1);for(let wi=0;wi<Si.length;wi+=1)transition_out(Si[wi]);ji=!1},d(xi){xi&&detach(or),Ai.block.d(),Ai.token=null,Ai=null,destroy_each(Si,xi),qi=!1,run_all(rs)}}}function instance$9(lr,or,ar){let cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,xr;component_subscribe(lr,settingsDialog,Mr=>ar(14,vr=Mr)),component_subscribe(lr,$format,Mr=>ar(15,xr=Mr));const{font:wr,fontSize:kr,pageWidth:Cr,pageZoom:$r,titleHighlight:Nr,justifyText:Br,lineMargin:Fr,lineSpacing:Vr,dateFormat:Rr,singleChapterMode:Gr,countChars:qr}=s$2;component_subscribe(lr,wr,Mr=>ar(5,fr=Mr)),component_subscribe(lr,kr,Mr=>ar(6,dr=Mr)),component_subscribe(lr,Cr,Mr=>ar(7,pr=Mr)),component_subscribe(lr,$r,Mr=>ar(8,mr=Mr)),component_subscribe(lr,Nr,Mr=>ar(11,br=Mr)),component_subscribe(lr,Br,Mr=>ar(12,Or=Mr)),component_subscribe(lr,Fr,Mr=>ar(10,yr=Mr)),component_subscribe(lr,Vr,Mr=>ar(9,gr=Mr)),component_subscribe(lr,Rr,Mr=>ar(13,_r=Mr)),component_subscribe(lr,Gr,Mr=>ar(3,ur=Mr)),component_subscribe(lr,qr,Mr=>ar(4,hr=Mr));let{params:Ur}=or,{callback:Yr}=or,Dr=[];const Jr=new Set(["EB Garamond","Garamond","Roboto","Arial","Arial Black","Bahnschrift","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Ebrima","Franklin Gothic Medium","Gabriola","Gadugi","Georgia","HoloLens MDL2 Assets","Impact","Ink Free","Javanese Text","Leelawadee UI","Lucida Console","Lucida Sans Unicode","Malgun Gothic","Marlett","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei","Microsoft Yi Baiti","MingLiU-ExtB","Mongolian Baiti","MS Gothic","MV Boli","Myanmar Text","Nirmala UI","Palatino Linotype","Segoe MDL2 Assets","Segoe Print","Segoe Script","Segoe UI","Segoe UI Historic","Segoe UI Emoji","Segoe UI Symbol","SimSun","Sitka","Sylfaen","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Yu Gothic","American Typewriter","Andale Mono","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Avenir","Avenir Next","Avenir Next Condensed","Baskerville","Big Caslon","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Cochin","Comic Sans MS","Copperplate","Courier","Courier New","Didot","DIN Alternate","DIN Condensed","Futura","Geneva","Georgia","Gill Sans","Helvetica","Helvetica Neue","Herculanum","Hoefler Text","Impact","Lucida Grande","Luminari","Marker Felt","Menlo","Microsoft Sans Serif","Monaco","Noteworthy","Optima","Palatino","Papyrus","Phosphate","Rockwell","Savoye LET","SignPainter","Skia","Snell Roundhand","Tahoma","Times","Times New Roman","Trattatello","Trebuchet MS","Verdana","Zapfino"].sort()),ai=new Promise(Mr=>setTimeout(()=>{const jr=new Set;for(let Xr of Jr.values())window.document.fonts.check(`12px "${Xr}"`)&&jr.add(Xr);Mr([...jr.values()])}));function Kr(){ur=to_number(this.value),Gr.set(ur)}function ui(){hr=to_number(this.value),qr.set(hr)}function ii(){fr=this.value,wr.set(fr)}function di(){dr=to_number(this.value),kr.set(dr)}function ei(){pr=to_number(this.value),Cr.set(pr)}function Wr(){mr=to_number(this.value),$r.set(mr)}function ti(){gr=this.value,Vr.set(gr)}function si(){yr=to_number(this.value),Fr.set(yr)}function ci(){br=to_number(this.value),Nr.set(br)}function ni(){Or=to_number(this.value),Br.set(Or)}function Pr(){_r=this.value,Rr.set(_r)}function Ar(Mr,jr){lr.$$.not_equal(Dr[jr],Mr)&&(Dr[jr]=Mr,ar(1,Dr))}const Zr=()=>{Object.values(cr).forEach(Mr=>Mr(!0)),Yr(!0)};return lr.$$set=Mr=>{"params"in Mr&&ar(28,Ur=Mr.params),"callback"in Mr&&ar(0,Yr=Mr.callback)},lr.$$.update=()=>{lr.$$.dirty[0]&2&&ar(2,cr=Dr.filter(Boolean))},[Yr,Dr,cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,xr,kr,Cr,$r,Nr,Br,Fr,Vr,Rr,Gr,qr,ai,wr,Ur,Kr,ui,ii,di,ei,Wr,ti,si,ci,ni,Pr,Ar,Zr]}class Settings extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$9,create_fragment$9,safe_not_equal,{params:28,callback:0},null,[-1,-1])}}const shortcutsList={},ctrlShortcuts=lr=>Object.assign(shortcutsList,lr),handleShortcuts=function(lr){if(lr.ctrlKey){const or=String.fromCharCode(lr.keyCode).toUpperCase();or in shortcutsList&&(shortcutsList[or](),lr.stopPropagation(),lr.stopImmediatePropagation(),lr.preventDefault())}},EditorButtons_svelte_svelte_type_style_lang="";function create_if_block$7(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr;return{c(){or=element$1("button"),ar=element$1("span"),ur=space$3(),hr=element$1("button"),fr=element$1("span"),attr(ar,"class","icon-ccw"),attr(or,"class","nav-element svelte-1udvyqe"),attr(or,"title",cr=lr[3]("editor.buttons.undo")),attr(fr,"class","icon-cw"),attr(hr,"class","nav-element svelte-1udvyqe"),attr(hr,"title",dr=lr[3]("editor.buttons.redo"))},m(gr,yr){insert$1(gr,or,yr),append(or,ar),insert$1(gr,ur,yr),insert$1(gr,hr,yr),append(hr,fr),pr||(mr=[listen(or,"click",lr[8]),listen(hr,"click",lr[9])],pr=!0)},p(gr,yr){yr&8&&cr!==(cr=gr[3]("editor.buttons.undo"))&&attr(or,"title",cr),yr&8&&dr!==(dr=gr[3]("editor.buttons.redo"))&&attr(hr,"title",dr)},d(gr){gr&&(detach(or),detach(ur),detach(hr)),pr=!1,run_all(mr)}}}function create_fragment$8(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr=!isVSCode&&create_if_block$7(lr);return{c(){or=element$1("button"),ar=element$1("span"),ur=space$3(),vr&&vr.c(),hr=space$3(),fr=element$1("button"),dr=element$1("span"),dr.innerHTML='[<span class="icon-flash svelte-1udvyqe"></span>]',mr=space$3(),gr=element$1("button"),yr=text("[L]"),attr(ar,"class","icon-search"),attr(or,"class","nav-element svelte-1udvyqe"),attr(or,"title",cr=lr[3]("editor.buttons.find")),attr(dr,"class","link"),attr(fr,"class","nav-element svelte-1udvyqe"),attr(fr,"title",pr=lr[3]("editor.buttons.quicklink")),attr(gr,"class","nav-element svelte-1udvyqe"),attr(gr,"title",br=lr[3]("editor.buttons.link"))},m(xr,wr){insert$1(xr,or,wr),append(or,ar),insert$1(xr,ur,wr),vr&&vr.m(xr,wr),insert$1(xr,hr,wr),insert$1(xr,fr,wr),append(fr,dr),insert$1(xr,mr,wr),insert$1(xr,gr,wr),append(gr,yr),Or||(_r=[listen(or,"click",lr[7]),listen(fr,"click",lr[5]),listen(gr,"click",lr[4])],Or=!0)},p(xr,[wr]){wr&8&&cr!==(cr=xr[3]("editor.buttons.find"))&&attr(or,"title",cr),isVSCode||vr.p(xr,wr),wr&8&&pr!==(pr=xr[3]("editor.buttons.quicklink"))&&attr(fr,"title",pr),wr&8&&br!==(br=xr[3]("editor.buttons.link"))&&attr(gr,"title",br)},i:noop$2,o:noop$2,d(xr){xr&&(detach(or),detach(ur),detach(hr),detach(fr),detach(mr),detach(gr)),vr&&vr.d(xr),Or=!1,run_all(_r)}}}function instance$8(lr,or,ar){let cr,ur,hr,fr,dr,pr=noop$2,mr=()=>(pr(),pr=subscribe(hr,Nr=>ar(11,dr=Nr)),hr),gr,yr=noop$2,br=()=>(yr(),yr=subscribe(ur,Nr=>ar(12,gr=Nr)),ur),Or,_r,vr;component_subscribe(lr,cursorPosition,Nr=>ar(13,Or=Nr)),component_subscribe(lr,nullUntilLoaded,Nr=>ar(6,_r=Nr)),component_subscribe(lr,$format,Nr=>ar(3,vr=Nr)),lr.$$.on_destroy.push(()=>pr()),lr.$$.on_destroy.push(()=>yr());const xr=()=>{const{from:Nr,to:Br}=Or,Fr=cr.index.properties.disableShortLinks=="true";fr.dispatch({changes:{from:Br,to:Br,insert:Fr?"[](#)":"[]"}}),fr.dispatch({selection:{anchor:Br+(Fr?4:1)},effects:[EditorView.scrollIntoView(Br)]}),fr.focus()},wr=()=>{let{to:Nr}=Or;const Br=gr,Fr=firstAvaiableKey(cr),[Vr,Rr]=addChapter(cr,{key:Fr},gr);Vr<=Br&&(Nr+=Rr.length);const Gr=cr.index.properties.disableShortLinks=="true"?`[](#${Fr})`:`[${Fr}]`;dr.lines.textStart!=fr.state.doc.lineAt(Nr).number-1?(fr.dispatch({changes:{from:Nr,to:Nr,insert:Gr}}),Nr+=Gr.length):(fr.dispatch({changes:{from:Nr,to:Nr,insert:`
`+Gr}}),Nr+=Gr.length+1),fr.dispatch({selection:{anchor:Nr}}),fr.focus()};ctrlShortcuts({K:()=>wr(),L:()=>xr()});const kr=async()=>{openSearchPanel(fr)},Cr=async()=>{undo(fr)},$r=async()=>{redo(fr)};return lr.$$.update=()=>{lr.$$.dirty&64&&br(ar(2,{book:cr,selectedChapterIndex:ur,selectedChapter:hr,editor:fr}=_r,ur,mr(ar(1,hr)),(ar(0,fr),ar(6,_r))))},[fr,hr,ur,vr,xr,wr,_r,kr,Cr,$r]}class EditorButtons extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$8,create_fragment$8,safe_not_equal,{})}}window.mageapi={graph,bookUtils,store:store$1,file,svelte:{navigator:navigator$1,writable,readable,get:get_store_value,tick},dialogs:{dialog,About,Confirm,Graph,Remap,NewBook,NewFirebook,Recover,Settings,EditorButtons}};const runEval=code=>eval(code);addMessages("en",en$2);addMessages("it",it$2);defaultBookProperties.extend({});window.addEventListener("message",lr=>{lr.data.action==="eval"&&runEval(lr.data.code)});pluginPanel.extend({tabs:[{id:"templateplugin.tabs.1",icon:`<img src="${logo$1}" alt="Template logo" style="width: 27px;">`}],widget:Widget});settingsDialog.extend(Settings$2);function create_fragment$7(lr){let or,ar,cr,ur,hr,fr,dr,pr=lr[4]("dialogs.ok")+"",mr,gr,yr;return{c(){or=element$1("div"),ar=element$1("h3"),cr=text(lr[2]),ur=space$3(),hr=element$1("p"),fr=space$3(),dr=element$1("button"),mr=text(pr),attr(dr,"class","ok"),attr(or,"class","dialog")},m(br,Or){insert$1(br,or,Or),append(or,ar),append(ar,cr),append(or,ur),append(or,hr),hr.innerHTML=lr[3],append(or,fr),append(or,dr),append(dr,mr),gr||(yr=listen(dr,"click",lr[6]),gr=!0)},p(br,[Or]){Or&4&&set_data(cr,br[2]),Or&8&&(hr.innerHTML=br[3]),Or&16&&pr!==(pr=br[4]("dialogs.ok")+"")&&set_data(mr,pr)},i:noop$2,o:noop$2,d(br){br&&detach(or),gr=!1,yr()}}}function instance$7(lr,or,ar){let cr,ur=noop$2,hr=()=>(ur(),ur=subscribe(dr,br=>ar(5,cr=br)),dr),fr;component_subscribe(lr,$format,br=>ar(4,fr=br)),lr.$$.on_destroy.push(()=>ur());let{params:dr}=or;hr();let{callback:pr}=or,mr,gr;const yr=()=>pr(!0);return lr.$$set=br=>{"params"in br&&hr(ar(0,dr=br.params)),"callback"in br&&ar(1,pr=br.callback)},lr.$$.update=()=>{lr.$$.dirty&32&&ar(2,[mr,gr]=cr,mr,(ar(3,gr),ar(5,cr)))},[dr,pr,mr,gr,fr,cr,yr]}class Alert extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$7,create_fragment$7,safe_not_equal,{params:0,callback:1})}}const Navbar_svelte_svelte_type_style_lang="";function create_if_block_4(lr){let or,ar,cr=lr[3]("navbar.file.title")+"",ur,hr,fr,dr,pr=lr[3]("navbar.file.new")+"",mr,gr,yr,br,Or,_r=lr[3]("navbar.file.newFire")+"",vr,xr,wr,kr,Cr,$r,Nr,Br=lr[3]("navbar.file.open")+"",Fr,Vr,Rr,Gr,qr=lr[3]("navbar.file.recover")+"",Ur,Yr,Dr,Jr=lr[1]&&create_if_block_5(lr);return{c(){or=element$1("div"),ar=element$1("h1"),ur=text(cr),hr=space$3(),fr=element$1("div"),dr=element$1("p"),mr=text(pr),gr=space$3(),yr=element$1("hr"),br=space$3(),Or=element$1("p"),vr=text(_r),xr=space$3(),wr=element$1("hr"),kr=space$3(),Cr=element$1("input"),$r=space$3(),Nr=element$1("label"),Fr=text(Br),Vr=space$3(),Jr&&Jr.c(),Rr=space$3(),Gr=element$1("p"),Ur=text(qr),attr(ar,"class","nav-element"),attr(dr,"class","svelte-1m0ulfa"),attr(yr,"class","svelte-1m0ulfa"),attr(Or,"class","svelte-1m0ulfa"),attr(wr,"class","svelte-1m0ulfa"),attr(Cr,"type","file"),attr(Cr,"name","open"),attr(Cr,"id","open"),attr(Cr,"accept",".xlgc,.md, .magebook"),attr(Cr,"class","svelte-1m0ulfa"),attr(Nr,"for","open"),attr(Nr,"class","svelte-1m0ulfa"),attr(Gr,"class","svelte-1m0ulfa"),attr(fr,"class","content svelte-1m0ulfa"),attr(or,"class","svelte-1m0ulfa")},m(ai,Kr){insert$1(ai,or,Kr),append(or,ar),append(ar,ur),append(or,hr),append(or,fr),append(fr,dr),append(dr,mr),append(fr,gr),append(fr,yr),append(fr,br),append(fr,Or),append(Or,vr),append(fr,xr),append(fr,wr),append(fr,kr),append(fr,Cr),append(fr,$r),append(fr,Nr),append(Nr,Fr),append(fr,Vr),Jr&&Jr.m(fr,null),append(fr,Rr),append(fr,Gr),append(Gr,Ur),Yr||(Dr=[listen(dr,"click",lr[7]),listen(Or,"click",lr[8]),listen(Cr,"change",lr[9]),listen(Gr,"click",lr[11])],Yr=!0)},p(ai,Kr){Kr&8&&cr!==(cr=ai[3]("navbar.file.title")+"")&&set_data(ur,cr),Kr&8&&pr!==(pr=ai[3]("navbar.file.new")+"")&&set_data(mr,pr),Kr&8&&_r!==(_r=ai[3]("navbar.file.newFire")+"")&&set_data(vr,_r),Kr&8&&Br!==(Br=ai[3]("navbar.file.open")+"")&&set_data(Fr,Br),ai[1]?Jr?Jr.p(ai,Kr):(Jr=create_if_block_5(ai),Jr.c(),Jr.m(fr,Rr)):Jr&&(Jr.d(1),Jr=null),Kr&8&&qr!==(qr=ai[3]("navbar.file.recover")+"")&&set_data(Ur,qr)},d(ai){ai&&detach(or),Jr&&Jr.d(),Yr=!1,run_all(Dr)}}}function create_if_block_5(lr){let or,ar=lr[3]("navbar.file.save")+"",cr,ur,hr;return{c(){or=element$1("p"),cr=text(ar),attr(or,"class","svelte-1m0ulfa")},m(fr,dr){insert$1(fr,or,dr),append(or,cr),ur||(hr=listen(or,"click",lr[10]),ur=!0)},p(fr,dr){dr&8&&ar!==(ar=fr[3]("navbar.file.save")+"")&&set_data(cr,ar)},d(fr){fr&&detach(or),ur=!1,hr()}}}function create_if_block_2$3(lr){let or,ar,cr=lr[3]("navbar.book.title")+"",ur,hr,fr,dr,pr=lr[3]("navbar.book.graph")+"",mr,gr,yr,br=lr[3]("navbar.book.shuffle")+"",Or,_r,vr,xr=lr[3]("navbar.book.sort")+"",wr,kr,Cr,$r=lr[3]("navbar.book.compact")+"",Nr,Br,Fr,Vr,Rr,Gr=lr[3]("navbar.export.title")+"",qr,Ur,Yr,Dr,Jr=lr[3]("navbar.export.docx")+"",ai,Kr,ui,ii=lr[3]("navbar.export.fodt")+"",di,ei,Wr,ti=lr[3]("navbar.export.html")+"",si,ci,ni,Pr=lr[3]("navbar.export.json")+"",Ar,Zr,Mr,jr=lr[3]("navbar.export.xlgc")+"",Xr,ri,Lr,oi,Tr,Sr=lr[3]("navbar.export.others")+"",Er,Ir,Qr,zr,Hr,li,pi=lr[3]("navbar.export.settings")+"",hi,fi,mi,gi,_i=isVSCode&&create_if_block_3$2();return{c(){or=element$1("div"),ar=element$1("h1"),ur=text(cr),hr=space$3(),fr=element$1("div"),dr=element$1("p"),mr=text(pr),gr=space$3(),yr=element$1("p"),Or=text(br),_r=space$3(),vr=element$1("p"),wr=text(xr),kr=space$3(),Cr=element$1("p"),Nr=text($r),Br=space$3(),_i&&_i.c(),Fr=space$3(),Vr=element$1("div"),Rr=element$1("h1"),qr=text(Gr),Ur=space$3(),Yr=element$1("div"),Dr=element$1("p"),ai=text(Jr),Kr=space$3(),ui=element$1("p"),di=text(ii),ei=space$3(),Wr=element$1("p"),si=text(ti),ci=space$3(),ni=element$1("p"),Ar=text(Pr),Zr=space$3(),Mr=element$1("p"),Xr=text(jr),ri=space$3(),Lr=element$1("hr"),oi=space$3(),Tr=element$1("a"),Er=text(Sr),Qr=space$3(),zr=element$1("hr"),Hr=space$3(),li=element$1("a"),hi=text(pi),attr(ar,"class","nav-element"),attr(dr,"class","svelte-1m0ulfa"),attr(yr,"class","svelte-1m0ulfa"),attr(vr,"class","svelte-1m0ulfa"),attr(Cr,"class","svelte-1m0ulfa"),attr(fr,"class","content svelte-1m0ulfa"),attr(or,"class","svelte-1m0ulfa"),attr(Rr,"class","nav-element"),attr(Dr,"class","svelte-1m0ulfa"),attr(ui,"class","svelte-1m0ulfa"),attr(Wr,"class","svelte-1m0ulfa"),attr(ni,"class","svelte-1m0ulfa"),attr(Mr,"class","svelte-1m0ulfa"),attr(Lr,"class","svelte-1m0ulfa"),attr(Tr,"href",Ir=lr[3]("navbar.export.otherslink")),attr(Tr,"target","_blank"),attr(Tr,"rel","noreferrer"),attr(Tr,"class","svelte-1m0ulfa"),attr(zr,"class","svelte-1m0ulfa"),attr(li,"href",fi=lr[3]("navbar.export.settingslink")),attr(li,"target","_blank"),attr(li,"rel","noreferrer"),attr(li,"class","svelte-1m0ulfa"),attr(Yr,"class","content svelte-1m0ulfa"),attr(Vr,"class","svelte-1m0ulfa")},m(yi,Oi){insert$1(yi,or,Oi),append(or,ar),append(ar,ur),append(or,hr),append(or,fr),append(fr,dr),append(dr,mr),append(fr,gr),append(fr,yr),append(yr,Or),append(fr,_r),append(fr,vr),append(vr,wr),append(fr,kr),append(fr,Cr),append(Cr,Nr),append(fr,Br),_i&&_i.m(fr,null),insert$1(yi,Fr,Oi),insert$1(yi,Vr,Oi),append(Vr,Rr),append(Rr,qr),append(Vr,Ur),append(Vr,Yr),append(Yr,Dr),append(Dr,ai),append(Yr,Kr),append(Yr,ui),append(ui,di),append(Yr,ei),append(Yr,Wr),append(Wr,si),append(Yr,ci),append(Yr,ni),append(ni,Ar),append(Yr,Zr),append(Yr,Mr),append(Mr,Xr),append(Yr,ri),append(Yr,Lr),append(Yr,oi),append(Yr,Tr),append(Tr,Er),append(Yr,Qr),append(Yr,zr),append(Yr,Hr),append(Yr,li),append(li,hi),mi||(gi=[listen(dr,"click",lr[12]),listen(yr,"click",lr[13]),listen(vr,"click",lr[14]),listen(Cr,"click",lr[15]),listen(Dr,"click",lr[16]),listen(ui,"click",lr[17]),listen(Wr,"click",lr[18]),listen(ni,"click",lr[19]),listen(Mr,"click",lr[20])],mi=!0)},p(yi,Oi){Oi&8&&cr!==(cr=yi[3]("navbar.book.title")+"")&&set_data(ur,cr),Oi&8&&pr!==(pr=yi[3]("navbar.book.graph")+"")&&set_data(mr,pr),Oi&8&&br!==(br=yi[3]("navbar.book.shuffle")+"")&&set_data(Or,br),Oi&8&&xr!==(xr=yi[3]("navbar.book.sort")+"")&&set_data(wr,xr),Oi&8&&$r!==($r=yi[3]("navbar.book.compact")+"")&&set_data(Nr,$r),Oi&8&&Gr!==(Gr=yi[3]("navbar.export.title")+"")&&set_data(qr,Gr),Oi&8&&Jr!==(Jr=yi[3]("navbar.export.docx")+"")&&set_data(ai,Jr),Oi&8&&ii!==(ii=yi[3]("navbar.export.fodt")+"")&&set_data(di,ii),Oi&8&&ti!==(ti=yi[3]("navbar.export.html")+"")&&set_data(si,ti),Oi&8&&Pr!==(Pr=yi[3]("navbar.export.json")+"")&&set_data(Ar,Pr),Oi&8&&jr!==(jr=yi[3]("navbar.export.xlgc")+"")&&set_data(Xr,jr),Oi&8&&Sr!==(Sr=yi[3]("navbar.export.others")+"")&&set_data(Er,Sr),Oi&8&&Ir!==(Ir=yi[3]("navbar.export.otherslink"))&&attr(Tr,"href",Ir),Oi&8&&pi!==(pi=yi[3]("navbar.export.settings")+"")&&set_data(hi,pi),Oi&8&&fi!==(fi=yi[3]("navbar.export.settingslink"))&&attr(li,"href",fi)},d(yi){yi&&(detach(or),detach(Fr),detach(Vr)),_i&&_i.d(),mi=!1,run_all(gi)}}}function create_if_block_3$2(lr){return{c:noop$2,m:noop$2,d:noop$2}}function create_if_block_1$3(lr){let or,ar,cr,ur;return cr=new EditorButtons({}),{c(){or=element$1("div"),ar=space$3(),create_component(cr.$$.fragment),attr(or,"class","margin svelte-1m0ulfa")},m(hr,fr){insert$1(hr,or,fr),insert$1(hr,ar,fr),mount_component(cr,hr,fr),ur=!0},i(hr){ur||(transition_in(cr.$$.fragment,hr),ur=!0)},o(hr){transition_out(cr.$$.fragment,hr),ur=!1},d(hr){hr&&(detach(or),detach(ar)),destroy_component(cr,hr)}}}function create_if_block$6(lr){let or,ar,cr,ur,hr,fr,dr;return{c(){or=element$1("div"),ar=element$1("span"),attr(ar,"aria-label",cr=lr[3]("navbar.buttons.fullscreen")),attr(ar,"class",ur=null_to_empty("dropbtn "+(lr[0]?"icon-resize-small":"icon-resize-full"))+" svelte-1m0ulfa"),attr(or,"title",hr=lr[3]("navbar.buttons.fullscreen")),attr(or,"class","svelte-1m0ulfa")},m(pr,mr){insert$1(pr,or,mr),append(or,ar),fr||(dr=listen(ar,"click",lr[22]),fr=!0)},p(pr,mr){mr&8&&cr!==(cr=pr[3]("navbar.buttons.fullscreen"))&&attr(ar,"aria-label",cr),mr&1&&ur!==(ur=null_to_empty("dropbtn "+(pr[0]?"icon-resize-small":"icon-resize-full"))+" svelte-1m0ulfa")&&attr(ar,"class",ur),mr&8&&hr!==(hr=pr[3]("navbar.buttons.fullscreen"))&&attr(or,"title",hr)},d(pr){pr&&detach(or),fr=!1,dr()}}}function create_fragment$6(lr){let or,ar,cr,ur,hr,fr=lr[3]("navbar.help.title")+"",dr,pr,mr,gr,yr=lr[3]("navbar.help.guide")+"",br,Or,_r,vr,xr=lr[3]("navbar.help.forum")+"",wr,kr,Cr,$r=lr[3]("navbar.help.report")+"",Nr,Br,Fr,Vr=lr[3]("navbar.help.about")+"",Rr,Gr,qr,Ur,Yr,Dr,Jr,ai,Kr,ui,ii,di,ei,Wr,ti,si,ci,ni,Pr,Ar,Zr,Mr,jr,Xr,ri,Lr,oi,Tr=!isVSCode&&create_if_block_4(lr),Sr=lr[1]&&create_if_block_2$3(lr),Er=isVSCode&&create_if_block_1$3(),Ir=!isVSCode&&create_if_block$6(lr);return{c(){or=element$1("nav"),Tr&&Tr.c(),ar=space$3(),Sr&&Sr.c(),cr=space$3(),ur=element$1("div"),hr=element$1("h1"),dr=text(fr),pr=space$3(),mr=element$1("div"),gr=element$1("a"),br=text(yr),_r=space$3(),vr=element$1("a"),wr=text(xr),kr=space$3(),Cr=element$1("a"),Nr=text($r),Br=space$3(),Fr=element$1("p"),Rr=text(Vr),Gr=space$3(),Er&&Er.c(),qr=space$3(),Ur=element$1("div"),Yr=space$3(),Dr=element$1("span"),Ir&&Ir.c(),Jr=space$3(),ai=element$1("div"),Kr=element$1("span"),ei=space$3(),Wr=element$1("div"),ti=element$1("span"),Pr=space$3(),Ar=element$1("div"),Zr=element$1("span"),attr(hr,"class","nav-element"),attr(gr,"target","_blank"),attr(gr,"rel","noreferrer"),attr(gr,"href",Or=lr[3]("navbar.help.guidefile")),attr(gr,"class","svelte-1m0ulfa"),attr(vr,"target","_blank"),attr(vr,"rel","noreferrer"),attr(vr,"href","https://www.librogame.net/index.php/forum/topic?id=5182&p=1#p148583"),attr(vr,"class","svelte-1m0ulfa"),attr(Cr,"target","_blank"),attr(Cr,"rel","noreferrer"),attr(Cr,"href","https://docs.google.com/document/d/1BlAlzgdoFxTNodg501R4kDVG0I7JeBJjPuJsMSP47sg/edit?usp=sharing"),attr(Cr,"class","svelte-1m0ulfa"),attr(Fr,"class","svelte-1m0ulfa"),attr(mr,"class","content svelte-1m0ulfa"),attr(ur,"class","svelte-1m0ulfa"),attr(Ur,"class","flex-grow-1 w-full svelte-1m0ulfa"),attr(Kr,"aria-label",ui=lr[3]("navbar.buttons.darktheme")),attr(Kr,"class",ii=null_to_empty("dropbtn "+(lr[4]=="light"?"icon-moon":"icon-sun"))+" svelte-1m0ulfa"),attr(ai,"title",di=lr[3]("navbar.buttons.darktheme")),attr(ai,"class","svelte-1m0ulfa"),attr(ti,"aria-label",si=lr[3]("navbar.buttons.settings")),attr(ti,"class",null_to_empty("dropbtn icon-cog")+" svelte-1m0ulfa"),attr(Wr,"title",ci=lr[3]("navbar.buttons.settings")),attr(Wr,"class","svelte-1m0ulfa"),attr(Dr,"class",ni=null_to_empty("nav-buttons "+(lr[2]?"buttons-display":"buttons-hidden"))+" svelte-1m0ulfa"),attr(Zr,"aria-label",Mr=lr[3]("sidemenu.toggle")),attr(Zr,"class","dropbtn icon-menu svelte-1m0ulfa"),attr(Ar,"title",jr=lr[3]("sidemenu.toggle")),attr(Ar,"class","nav-button sidemenu svelte-1m0ulfa"),attr(or,"class",Xr=null_to_empty(`select-none flex flex-row box-border text-white bg-zinc-800 ${lr[2],"display"}`)+" svelte-1m0ulfa"),set_style(or,"grid-area","navbar")},m(Qr,zr){insert$1(Qr,or,zr),Tr&&Tr.m(or,null),append(or,ar),Sr&&Sr.m(or,null),append(or,cr),append(or,ur),append(ur,hr),append(hr,dr),append(ur,pr),append(ur,mr),append(mr,gr),append(gr,br),append(mr,_r),append(mr,vr),append(vr,wr),append(mr,kr),append(mr,Cr),append(Cr,Nr),append(mr,Br),append(mr,Fr),append(Fr,Rr),append(or,Gr),Er&&Er.m(or,null),append(or,qr),append(or,Ur),append(or,Yr),append(or,Dr),Ir&&Ir.m(Dr,null),append(Dr,Jr),append(Dr,ai),append(ai,Kr),append(Dr,ei),append(Dr,Wr),append(Wr,ti),append(or,Pr),append(or,Ar),append(Ar,Zr),ri=!0,Lr||(oi=[listen(Fr,"click",lr[21]),listen(Kr,"click",lr[23]),listen(ti,"click",lr[24]),listen(Zr,"click",lr[25])],Lr=!0)},p(Qr,[zr]){isVSCode||Tr.p(Qr,zr),Qr[1]?Sr?Sr.p(Qr,zr):(Sr=create_if_block_2$3(Qr),Sr.c(),Sr.m(or,cr)):Sr&&(Sr.d(1),Sr=null),(!ri||zr&8)&&fr!==(fr=Qr[3]("navbar.help.title")+"")&&set_data(dr,fr),(!ri||zr&8)&&yr!==(yr=Qr[3]("navbar.help.guide")+"")&&set_data(br,yr),(!ri||zr&8&&Or!==(Or=Qr[3]("navbar.help.guidefile")))&&attr(gr,"href",Or),(!ri||zr&8)&&xr!==(xr=Qr[3]("navbar.help.forum")+"")&&set_data(wr,xr),(!ri||zr&8)&&$r!==($r=Qr[3]("navbar.help.report")+"")&&set_data(Nr,$r),(!ri||zr&8)&&Vr!==(Vr=Qr[3]("navbar.help.about")+"")&&set_data(Rr,Vr),isVSCode||Ir.p(Qr,zr),(!ri||zr&8&&ui!==(ui=Qr[3]("navbar.buttons.darktheme")))&&attr(Kr,"aria-label",ui),(!ri||zr&16&&ii!==(ii=null_to_empty("dropbtn "+(Qr[4]=="light"?"icon-moon":"icon-sun"))+" svelte-1m0ulfa"))&&attr(Kr,"class",ii),(!ri||zr&8&&di!==(di=Qr[3]("navbar.buttons.darktheme")))&&attr(ai,"title",di),(!ri||zr&8&&si!==(si=Qr[3]("navbar.buttons.settings")))&&attr(ti,"aria-label",si),(!ri||zr&8&&ci!==(ci=Qr[3]("navbar.buttons.settings")))&&attr(Wr,"title",ci),(!ri||zr&4&&ni!==(ni=null_to_empty("nav-buttons "+(Qr[2]?"buttons-display":"buttons-hidden"))+" svelte-1m0ulfa"))&&attr(Dr,"class",ni),(!ri||zr&8&&Mr!==(Mr=Qr[3]("sidemenu.toggle")))&&attr(Zr,"aria-label",Mr),(!ri||zr&8&&jr!==(jr=Qr[3]("sidemenu.toggle")))&&attr(Ar,"title",jr),(!ri||zr&4&&Xr!==(Xr=null_to_empty(`select-none flex flex-row box-border text-white bg-zinc-800 ${Qr[2],"display"}`)+" svelte-1m0ulfa"))&&attr(or,"class",Xr)},i(Qr){ri||(transition_in(Er),ri=!0)},o(Qr){transition_out(Er),ri=!1},d(Qr){Qr&&detach(or),Tr&&Tr.d(),Sr&&Sr.d(),Er&&Er.d(),Ir&&Ir.d(),Lr=!1,run_all(oi)}}}function instance$6(lr,or,ar){let cr,ur,hr,fr,dr;component_subscribe(lr,nullUntilLoaded,Yr=>ar(6,ur=Yr)),component_subscribe(lr,showSidemenu,Yr=>ar(2,hr=Yr)),component_subscribe(lr,$format,Yr=>ar(3,fr=Yr));const{theme:pr}=s$2;component_subscribe(lr,pr,Yr=>ar(4,dr=Yr)),isVSCode||ctrlShortcuts({S:()=>download("md",cr),O:()=>{var Yr;return(Yr=document.getElementById("open"))==null?void 0:Yr.click()}});let mr=!!window.document.fullscreenElement;document.onfullscreenchange=()=>{ar(0,mr=!!window.document.fullscreenElement)};const gr=()=>dialog(NewBook),yr=()=>dialog(NewFirebook),br=Yr=>open$1(asAny(Yr.target)),Or=()=>download("md",cr),_r=()=>dialog(Recover),vr=()=>dialog(Graph,()=>graphToImg(cr)),xr=()=>dialog(Remap,"shuffle"),wr=()=>dialog(Remap,"sort"),kr=()=>dialog(Remap,"compact"),Cr=()=>download("docx",cr),$r=()=>download("fodt",cr),Nr=()=>download("html",cr),Br=()=>download("json",cr),Fr=()=>download("xlgc",cr),Vr=()=>dialog(About),Rr=()=>{window.document.fullscreenElement?window.document.exitFullscreen():window.document.body.requestFullscreen()},Gr=()=>set_store_value(pr,dr=dr=="light"?"dark":"light",dr),qr=()=>dialog(Settings),Ur=()=>set_store_value(showSidemenu,hr=!hr,hr);return lr.$$.update=()=>{lr.$$.dirty&64&&ar(1,{book:cr}=ur,cr)},[mr,cr,hr,fr,dr,pr,ur,gr,yr,br,Or,_r,vr,xr,wr,kr,Cr,$r,Nr,Br,Fr,Vr,Rr,Gr,qr,Ur]}class Navbar extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$6,create_fragment$6,safe_not_equal,{})}}const Editor_svelte_svelte_type_style_lang="";function create_if_block_3$1(lr){let or,ar,cr=(lr[11]??"")+"",ur,hr,fr,dr,pr,mr,gr;return dr=new EditorButtons({}),{c(){or=element$1("div"),ar=element$1("h1"),ur=text(cr),fr=space$3(),create_component(dr.$$.fragment),attr(ar,"class","only-desktop svelte-1t2rxtp"),attr(ar,"title",hr=lr[0]&&lr[11]),attr(or,"class","toolbar svelte-1t2rxtp")},m(yr,br){insert$1(yr,or,br),append(or,ar),append(ar,ur),append(or,fr),mount_component(dr,or,null),pr=!0,mr||(gr=listen(ar,"click",lr[26]),mr=!0)},p(yr,br){(!pr||br&2048)&&cr!==(cr=(yr[11]??"")+"")&&set_data(ur,cr),(!pr||br&2049&&hr!==(hr=yr[0]&&yr[11]))&&attr(ar,"title",hr)},i(yr){pr||(transition_in(dr.$$.fragment,yr),pr=!0)},o(yr){transition_out(dr.$$.fragment,yr),pr=!1},d(yr){yr&&detach(or),destroy_component(dr),mr=!1,gr()}}}function create_if_block_2$2(lr){let or,ar=(lr[13].text||"").length+" "+lr[14]("editor.chars"),cr;return{c(){or=element$1("span"),cr=text(ar),attr(or,"class","chars-count svelte-1t2rxtp")},m(ur,hr){insert$1(ur,or,hr),append(or,cr)},p(ur,hr){hr&24576&&ar!==(ar=(ur[13].text||"").length+" "+ur[14]("editor.chars"))&&set_data(cr,ar)},d(ur){ur&&detach(or)}}}function create_if_block_1$2(lr){let or;return{c(){or=element$1("div"),or.innerHTML='<i class="icon-arrows-cw animate-spin svelte-1t2rxtp" style="width: fit-content;"></i>'},m(ar,cr){insert$1(ar,or,cr)},d(ar){ar&&detach(or)}}}function create_if_block$5(lr){let or;return{c(){or=element$1("i"),attr(or,"class","icon-ok svelte-1t2rxtp"),set_style(or,"color","green")},m(ar,cr){insert$1(ar,or,cr)},d(ar){ar&&detach(or)}}}function create_fragment$5(lr){let or,ar,cr,ur,hr,fr=lr[1]&&String(lr[12])==="2",dr,pr,mr,gr=!isVSCode&&create_if_block_3$1(lr),yr=fr&&create_if_block_2$2(lr);function br(vr,xr){if(vr[15]===!0)return create_if_block$5;if(vr[15]===!1)return create_if_block_1$2}let Or=br(lr),_r=Or&&Or(lr);return{c(){or=element$1("main"),gr&&gr.c(),ar=space$3(),cr=element$1("div"),cr.innerHTML="",ur=space$3(),hr=element$1("div"),yr&&yr.c(),dr=space$3(),_r&&_r.c(),attr(cr,"class","textarea svelte-1t2rxtp"),attr(cr,"id",editorComponentID),attr(hr,"class","margin svelte-1t2rxtp"),attr(or,"class","editor svelte-1t2rxtp"),attr(or,"style",pr=`--mage-settings-font: ${lr[2].trim()};
 --mage-settings-fontsize: ${Number(String(lr[3]).trim())*Number(lr[4])/100}pt;
 --mage-settings-pagewidth: ${Number(String(lr[5]).trim())*2.85*Number(lr[4])/100}pt;
 --mage-settings-linemargin: ${String(lr[6]).trim()}px;
 --mage-settings-linespacing: ${String(lr[7]).trim()};
 --mage-settings-textalign: ${lr[8]=="1"?"left":"justify"};
 ${lr[9]=="1"?"--mage-settings-titlehighlight: transparent;":""}`)},m(vr,xr){insert$1(vr,or,xr),gr&&gr.m(or,null),append(or,ar),append(or,cr),append(or,ur),append(or,hr),yr&&yr.m(hr,null),append(hr,dr),_r&&_r.m(hr,null),mr=!0},p(vr,[xr]){isVSCode||gr.p(vr,xr),xr&4098&&(fr=vr[1]&&String(vr[12])==="2"),fr?yr?yr.p(vr,xr):(yr=create_if_block_2$2(vr),yr.c(),yr.m(hr,dr)):yr&&(yr.d(1),yr=null),Or!==(Or=br(vr))&&(_r&&_r.d(1),_r=Or&&Or(vr),_r&&(_r.c(),_r.m(hr,null))),(!mr||xr&1020&&pr!==(pr=`--mage-settings-font: ${vr[2].trim()};
 --mage-settings-fontsize: ${Number(String(vr[3]).trim())*Number(vr[4])/100}pt;
 --mage-settings-pagewidth: ${Number(String(vr[5]).trim())*2.85*Number(vr[4])/100}pt;
 --mage-settings-linemargin: ${String(vr[6]).trim()}px;
 --mage-settings-linespacing: ${String(vr[7]).trim()};
 --mage-settings-textalign: ${vr[8]=="1"?"left":"justify"};
 ${vr[9]=="1"?"--mage-settings-titlehighlight: transparent;":""}`))&&attr(or,"style",pr)},i(vr){mr||(transition_in(gr),mr=!0)},o(vr){transition_out(gr),mr=!1},d(vr){vr&&detach(or),gr&&gr.d(),yr&&yr.d(),_r&&_r.d()}}}function instance$5(lr,or,ar){let cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,xr=noop$2,wr=()=>(xr(),xr=subscribe(ur,ui=>ar(11,vr=ui)),ur),kr,Cr,$r=noop$2,Nr=()=>($r(),$r=subscribe(cr,ui=>ar(13,Cr=ui)),cr),Br,Fr;component_subscribe(lr,nullUntilLoaded,ui=>ar(25,hr=ui)),component_subscribe(lr,showSidemenu,ui=>ar(10,_r=ui)),component_subscribe(lr,$format,ui=>ar(14,Br=ui)),component_subscribe(lr,isSynced,ui=>ar(15,Fr=ui)),lr.$$.on_destroy.push(()=>xr()),lr.$$.on_destroy.push(()=>$r());const{font:Vr,fontSize:Rr,pageWidth:Gr,pageZoom:qr,titleHighlight:Ur,justifyText:Yr,lineMargin:Dr,lineSpacing:Jr,countChars:ai}=s$2;component_subscribe(lr,Vr,ui=>ar(2,fr=ui)),component_subscribe(lr,Rr,ui=>ar(3,dr=ui)),component_subscribe(lr,Gr,ui=>ar(5,mr=ui)),component_subscribe(lr,qr,ui=>ar(4,pr=ui)),component_subscribe(lr,Ur,ui=>ar(9,Or=ui)),component_subscribe(lr,Yr,ui=>ar(8,br=ui)),component_subscribe(lr,Dr,ui=>ar(6,gr=ui)),component_subscribe(lr,Jr,ui=>ar(7,yr=ui)),component_subscribe(lr,ai,ui=>ar(12,kr=ui)),onMount(()=>{isVSCode?loadVSSession():session.load()});const Kr=()=>set_store_value(showSidemenu,_r=!_r,_r);return lr.$$.update=()=>{lr.$$.dirty&33554432&&Nr(ar(1,{book:cr,selectedChapterFullTitle:ur}=hr,cr,wr(ar(0,ur))))},[ur,cr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,kr,Cr,Br,Fr,Vr,Rr,Gr,qr,Ur,Yr,Dr,Jr,ai,hr,Kr]}class Editor extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$5,create_fragment$5,safe_not_equal,{})}}const t$2=lr=>typeof lr=="object"&&lr!=null&&lr.nodeType===1,e=(lr,or)=>(!or||lr!=="hidden")&&lr!=="visible"&&lr!=="clip",n$1=(lr,or)=>{if(lr.clientHeight<lr.scrollHeight||lr.clientWidth<lr.scrollWidth){const ar=getComputedStyle(lr,null);return e(ar.overflowY,or)||e(ar.overflowX,or)||(cr=>{const ur=(hr=>{if(!hr.ownerDocument||!hr.ownerDocument.defaultView)return null;try{return hr.ownerDocument.defaultView.frameElement}catch{return null}})(cr);return!!ur&&(ur.clientHeight<cr.scrollHeight||ur.clientWidth<cr.scrollWidth)})(lr)}return!1},o$2=(lr,or,ar,cr,ur,hr,fr,dr)=>hr<lr&&fr>or||hr>lr&&fr<or?0:hr<=lr&&dr<=ar||fr>=or&&dr>=ar?hr-lr-cr:fr>or&&dr<ar||hr<lr&&dr>ar?fr-or+ur:0,i=lr=>{const or=lr.parentElement;return or??(lr.getRootNode().host||null)},l$1=(lr,or)=>{var ar,cr,ur,hr;if(typeof document>"u")return[];const{scrollMode:fr,block:dr,inline:pr,boundary:mr,skipOverflowHiddenElements:gr}=or,yr=typeof mr=="function"?mr:Ur=>Ur!==mr;if(!t$2(lr))throw new TypeError("Invalid target");const br=document.scrollingElement||document.documentElement,Or=[];let _r=lr;for(;t$2(_r)&&yr(_r);){if(_r=i(_r),_r===br){Or.push(_r);break}_r!=null&&_r===document.body&&n$1(_r)&&!n$1(document.documentElement)||_r!=null&&n$1(_r,gr)&&Or.push(_r)}const vr=(cr=(ar=window.visualViewport)==null?void 0:ar.width)!=null?cr:innerWidth,xr=(hr=(ur=window.visualViewport)==null?void 0:ur.height)!=null?hr:innerHeight,{scrollX:wr,scrollY:kr}=window,{height:Cr,width:$r,top:Nr,right:Br,bottom:Fr,left:Vr}=lr.getBoundingClientRect();let Rr=dr==="start"||dr==="nearest"?Nr:dr==="end"?Fr:Nr+Cr/2,Gr=pr==="center"?Vr+$r/2:pr==="end"?Br:Vr;const qr=[];for(let Ur=0;Ur<Or.length;Ur++){const Yr=Or[Ur],{height:Dr,width:Jr,top:ai,right:Kr,bottom:ui,left:ii}=Yr.getBoundingClientRect();if(fr==="if-needed"&&Nr>=0&&Vr>=0&&Fr<=xr&&Br<=vr&&Nr>=ai&&Fr<=ui&&Vr>=ii&&Br<=Kr)return qr;const di=getComputedStyle(Yr),ei=parseInt(di.borderLeftWidth,10),Wr=parseInt(di.borderTopWidth,10),ti=parseInt(di.borderRightWidth,10),si=parseInt(di.borderBottomWidth,10);let ci=0,ni=0;const Pr="offsetWidth"in Yr?Yr.offsetWidth-Yr.clientWidth-ei-ti:0,Ar="offsetHeight"in Yr?Yr.offsetHeight-Yr.clientHeight-Wr-si:0,Zr="offsetWidth"in Yr?Yr.offsetWidth===0?0:Jr/Yr.offsetWidth:0,Mr="offsetHeight"in Yr?Yr.offsetHeight===0?0:Dr/Yr.offsetHeight:0;if(br===Yr)ci=dr==="start"?Rr:dr==="end"?Rr-xr:dr==="nearest"?o$2(kr,kr+xr,xr,Wr,si,kr+Rr,kr+Rr+Cr,Cr):Rr-xr/2,ni=pr==="start"?Gr:pr==="center"?Gr-vr/2:pr==="end"?Gr-vr:o$2(wr,wr+vr,vr,ei,ti,wr+Gr,wr+Gr+$r,$r),ci=Math.max(0,ci+kr),ni=Math.max(0,ni+wr);else{ci=dr==="start"?Rr-ai-Wr:dr==="end"?Rr-ui+si+Ar:dr==="nearest"?o$2(ai,ui,Dr,Wr,si+Ar,Rr,Rr+Cr,Cr):Rr-(ai+Dr/2)+Ar/2,ni=pr==="start"?Gr-ii-ei:pr==="center"?Gr-(ii+Jr/2)+Pr/2:pr==="end"?Gr-Kr+ti+Pr:o$2(ii,Kr,Jr,ei,ti+Pr,Gr,Gr+$r,$r);const{scrollLeft:jr,scrollTop:Xr}=Yr;ci=Math.max(0,Math.min(Xr+ci/Mr,Yr.scrollHeight-Dr/Mr+Ar)),ni=Math.max(0,Math.min(jr+ni/Zr,Yr.scrollWidth-Jr/Zr+Pr)),Rr+=Xr-ci,Gr+=jr-ni}qr.push({el:Yr,top:ci,left:ni})}return qr},o$1=lr=>lr===!1?{block:"end",inline:"nearest"}:(or=>or===Object(or)&&Object.keys(or).length!==0)(lr)?lr:{block:"start",inline:"nearest"};function t$1(lr,or){if(!lr.isConnected||!(cr=>{let ur=cr;for(;ur&&ur.parentNode;){if(ur.parentNode===document)return!0;ur=ur.parentNode instanceof ShadowRoot?ur.parentNode.host:ur.parentNode}return!1})(lr))return;if((cr=>typeof cr=="object"&&typeof cr.behavior=="function")(or))return or.behavior(l$1(lr,or));const ar=typeof or=="boolean"||or==null?void 0:or.behavior;for(const{el:cr,top:ur,left:hr}of l$1(lr,o$1(or)))cr.scroll({top:ur,left:hr,behavior:ar})}let o;const t=()=>(o||(o="performance"in window?performance.now.bind(performance):Date.now),o());function l(lr){const or=t(),ar=Math.min((or-lr.startTime)/lr.duration,1),cr=lr.ease(ar),ur=lr.startX+(lr.x-lr.startX)*cr,hr=lr.startY+(lr.y-lr.startY)*cr;lr.method(ur,hr,ar,cr),ur!==lr.x||hr!==lr.y?requestAnimationFrame(()=>l(lr)):lr.cb()}function n(lr,or,ar){let cr=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,ur=arguments.length>4&&arguments[4]!==void 0?arguments[4]:gr=>1+--gr*gr*gr*gr*gr,hr=arguments.length>5?arguments[5]:void 0,fr=arguments.length>6?arguments[6]:void 0;const dr=lr,pr=lr.scrollLeft,mr=lr.scrollTop;l({scrollable:dr,method:(gr,yr,br,Or)=>{const _r=Math.ceil(gr),vr=Math.ceil(yr);lr.scrollLeft=_r,lr.scrollTop=vr,fr==null||fr({target:lr,elapsed:br,value:Or,left:_r,top:vr})},startTime:t(),startX:pr,startY:mr,x:or,y:ar,duration:cr,ease:ur,cb:hr})}const r=lr=>lr&&!lr.behavior||lr.behavior==="smooth",s=function(lr,or){const ar=or||{};return r(ar)?t$1(lr,{block:ar.block,inline:ar.inline,scrollMode:ar.scrollMode,boundary:ar.boundary,skipOverflowHiddenElements:ar.skipOverflowHiddenElements,behavior:cr=>Promise.all(cr.reduce((ur,hr)=>{let{el:fr,left:dr,top:pr}=hr;const mr=fr.scrollLeft,gr=fr.scrollTop;return mr===dr&&gr===pr?ur:[...ur,new Promise(yr=>n(fr,dr,pr,ar.duration,ar.ease,()=>yr({el:fr,left:[mr,dr],top:[gr,pr]}),ar.onScrollChange))]},[]))}):Promise.resolve(t$1(lr,or))},Chapter_svelte_svelte_type_style_lang="";function get_each_context$2(lr,or,ar){const cr=lr.slice();return cr[27]=or[ar],cr}function get_each_context_1$2(lr,or,ar){const cr=lr.slice();return cr[4]=or[ar],cr}function create_if_block$4(lr){let or,ar=ensure_array_like(Object.keys(lr[3].index.chaptersWith.group)),cr=[];for(let ur=0;ur<ar.length;ur+=1)cr[ur]=create_each_block_1$2(get_each_context_1$2(lr,ar,ur));return{c(){for(let ur=0;ur<cr.length;ur+=1)cr[ur].c();or=empty$1()},m(ur,hr){for(let fr=0;fr<cr.length;fr+=1)cr[fr]&&cr[fr].m(ur,hr);insert$1(ur,or,hr)},p(ur,hr){if(hr[0]&8){ar=ensure_array_like(Object.keys(ur[3].index.chaptersWith.group));let fr;for(fr=0;fr<ar.length;fr+=1){const dr=get_each_context_1$2(ur,ar,fr);cr[fr]?cr[fr].p(dr,hr):(cr[fr]=create_each_block_1$2(dr),cr[fr].c(),cr[fr].m(or.parentNode,or))}for(;fr<cr.length;fr+=1)cr[fr].d(1);cr.length=ar.length}},d(ur){ur&&detach(or),destroy_each(cr,ur)}}}function create_each_block_1$2(lr){let or,ar=lr[4]+"",cr,ur;return{c(){or=element$1("option"),cr=text(ar),or.__value=ur=lr[4],set_input_value(or,or.__value)},m(hr,fr){insert$1(hr,or,fr),append(or,cr)},p(hr,fr){fr[0]&8&&ar!==(ar=hr[4]+"")&&set_data(cr,ar),fr[0]&8&&ur!==(ur=hr[4])&&(or.__value=ur,set_input_value(or,or.__value))},d(hr){hr&&detach(or)}}}function create_each_block$2(lr){let or,ar,cr,ur,hr,fr;function dr(){return lr[22](lr[27])}return{c(){or=element$1("button"),ar=element$1("img"),ur=space$3(),attr(ar,"class","inline-block w-6 h-6 mx-auto"),attr(ar,"alt",lr[27]),src_url_equal(ar.src,cr=lr[14][lr[27]])||attr(ar,"src",cr),attr(or,"class","svelte-1flehcu"),toggle_class(or,"selected",lr[8][lr[27]])},m(pr,mr){insert$1(pr,or,mr),append(or,ar),append(or,ur),hr||(fr=listen(or,"click",dr),hr=!0)},p(pr,mr){lr=pr,mr[0]&256&&toggle_class(or,"selected",lr[8][lr[27]])},d(pr){pr&&detach(or),hr=!1,fr()}}}function create_fragment$4(lr){let or,ar,cr,ur,hr,fr,dr=lr[13]("dialogs.chapter.name")+"",pr,mr,gr,yr,br,Or,_r=lr[13]("dialogs.chapter.title")+"",vr,xr,wr,kr,Cr,$r,Nr=lr[13]("dialogs.chapter.group")+"",Br,Fr,Vr,Rr,Gr,qr,Ur,Yr,Dr,Jr,ai,Kr,ui,ii,di=lr[13]("dialogs.chapter.warnings.duplicate")+"",ei,Wr,ti,si,ci=lr[13]("dialogs.chapter.warnings.invalidkey")+"",ni,Pr,Ar,Zr,Mr=lr[13]("dialogs.chapter.warnings.invalidgroup")+"",jr,Xr,ri,Lr=lr[13]("dialogs.ok")+"",oi,Tr,Sr,Er,Ir=lr[13]("dialogs.cancel")+"",Qr,zr,Hr,li=lr[2]&&create_if_block$4(lr),pi=ensure_array_like(["fixed","noexport","final","death"]),hi=[];for(let fi=0;fi<4;fi+=1)hi[fi]=create_each_block$2(get_each_context$2(lr,pi,fi));return{c(){or=element$1("div"),ar=element$1("h3"),cr=text(lr[5]),ur=space$3(),hr=element$1("div"),fr=element$1("span"),pr=text(dr),mr=space$3(),gr=element$1("input"),yr=space$3(),br=element$1("div"),Or=element$1("span"),vr=text(_r),xr=space$3(),wr=element$1("input"),kr=space$3(),Cr=element$1("div"),$r=element$1("span"),Br=text(Nr),Fr=space$3(),Vr=element$1("input"),Rr=space$3(),Gr=element$1("datalist"),li&&li.c(),qr=space$3(),Ur=element$1("div");for(let fi=0;fi<4;fi+=1)hi[fi].c();Yr=space$3(),Dr=element$1("div"),Jr=element$1("textarea"),Kr=space$3(),ui=element$1("p"),ii=element$1("i"),ei=text(di),Wr=space$3(),ti=element$1("p"),si=element$1("i"),ni=text(ci),Pr=space$3(),Ar=element$1("p"),Zr=element$1("i"),jr=text(Mr),Xr=space$3(),ri=element$1("button"),oi=text(Lr),Sr=space$3(),Er=element$1("button"),Qr=text(Ir),attr(fr,"class","svelte-1flehcu"),attr(gr,"type","text"),attr(gr,"class","svelte-1flehcu"),toggle_class(gr,"error",lr[12]||!lr[11]),attr(hr,"class","input svelte-1flehcu"),attr(Or,"class","svelte-1flehcu"),attr(wr,"type","text"),attr(wr,"class","svelte-1flehcu"),attr(br,"class","input svelte-1flehcu"),attr($r,"class","svelte-1flehcu"),attr(Vr,"type","text"),attr(Vr,"list","chapters-groups"),attr(Vr,"class","svelte-1flehcu"),toggle_class(Vr,"error",!lr[10]),attr(Gr,"id","chapters-groups"),attr(Cr,"class","input svelte-1flehcu"),attr(Ur,"class","flags svelte-1flehcu"),attr(Jr,"placeholder",ai=lr[13]("dialogs.chapter.genericFlags")),attr(Jr,"class","svelte-1flehcu"),attr(Dr,"class","flags-generic svelte-1flehcu"),attr(ii,"class","icon-warning svelte-1flehcu"),set_style(ui,"font-size","85%"),attr(ui,"class","svelte-1flehcu"),toggle_class(ui,"hide",!lr[12]),attr(si,"class","icon-warning svelte-1flehcu"),set_style(ti,"font-size","85%"),attr(ti,"class","svelte-1flehcu"),toggle_class(ti,"hide",lr[11]),attr(Zr,"class","icon-warning svelte-1flehcu"),set_style(Ar,"font-size","85%"),attr(Ar,"class","svelte-1flehcu"),toggle_class(Ar,"hide",lr[10]),ri.disabled=Tr=!!(lr[12]||!lr[11]||!lr[10]),attr(ri,"class","ok"),attr(Er,"class","cancel"),attr(or,"class","dialog svelte-1flehcu")},m(fi,mi){insert$1(fi,or,mi),append(or,ar),append(ar,cr),append(or,ur),append(or,hr),append(hr,fr),append(fr,pr),append(hr,mr),append(hr,gr),set_input_value(gr,lr[1]),append(or,yr),append(or,br),append(br,Or),append(Or,vr),append(br,xr),append(br,wr),set_input_value(wr,lr[7]),append(or,kr),append(or,Cr),append(Cr,$r),append($r,Br),append(Cr,Fr),append(Cr,Vr),set_input_value(Vr,lr[4]),append(Cr,Rr),append(Cr,Gr),li&&li.m(Gr,null),append(or,qr),append(or,Ur);for(let gi=0;gi<4;gi+=1)hi[gi]&&hi[gi].m(Ur,null);append(or,Yr),append(or,Dr),append(Dr,Jr),set_input_value(Jr,lr[9]),append(or,Kr),append(or,ui),append(ui,ii),append(ui,ei),append(or,Wr),append(or,ti),append(ti,si),append(ti,ni),append(or,Pr),append(or,Ar),append(Ar,Zr),append(Ar,jr),append(or,Xr),append(or,ri),append(ri,oi),append(or,Sr),append(or,Er),append(Er,Qr),zr||(Hr=[listen(gr,"input",lr[19]),listen(wr,"input",lr[20]),listen(Vr,"input",lr[21]),listen(Jr,"input",lr[23]),listen(ri,"click",lr[24]),listen(Er,"click",lr[25])],zr=!0)},p(fi,mi){if(mi[0]&32&&set_data(cr,fi[5]),mi[0]&8192&&dr!==(dr=fi[13]("dialogs.chapter.name")+"")&&set_data(pr,dr),mi[0]&2&&gr.value!==fi[1]&&set_input_value(gr,fi[1]),mi[0]&6144&&toggle_class(gr,"error",fi[12]||!fi[11]),mi[0]&8192&&_r!==(_r=fi[13]("dialogs.chapter.title")+"")&&set_data(vr,_r),mi[0]&128&&wr.value!==fi[7]&&set_input_value(wr,fi[7]),mi[0]&8192&&Nr!==(Nr=fi[13]("dialogs.chapter.group")+"")&&set_data(Br,Nr),mi[0]&16&&Vr.value!==fi[4]&&set_input_value(Vr,fi[4]),mi[0]&1024&&toggle_class(Vr,"error",!fi[10]),fi[2]?li?li.p(fi,mi):(li=create_if_block$4(fi),li.c(),li.m(Gr,null)):li&&(li.d(1),li=null),mi[0]&16640){pi=ensure_array_like(["fixed","noexport","final","death"]);let gi;for(gi=0;gi<4;gi+=1){const _i=get_each_context$2(fi,pi,gi);hi[gi]?hi[gi].p(_i,mi):(hi[gi]=create_each_block$2(_i),hi[gi].c(),hi[gi].m(Ur,null))}for(;gi<4;gi+=1)hi[gi].d(1)}mi[0]&8192&&ai!==(ai=fi[13]("dialogs.chapter.genericFlags"))&&attr(Jr,"placeholder",ai),mi[0]&512&&set_input_value(Jr,fi[9]),mi[0]&8192&&di!==(di=fi[13]("dialogs.chapter.warnings.duplicate")+"")&&set_data(ei,di),mi[0]&4096&&toggle_class(ui,"hide",!fi[12]),mi[0]&8192&&ci!==(ci=fi[13]("dialogs.chapter.warnings.invalidkey")+"")&&set_data(ni,ci),mi[0]&2048&&toggle_class(ti,"hide",fi[11]),mi[0]&8192&&Mr!==(Mr=fi[13]("dialogs.chapter.warnings.invalidgroup")+"")&&set_data(jr,Mr),mi[0]&1024&&toggle_class(Ar,"hide",fi[10]),mi[0]&8192&&Lr!==(Lr=fi[13]("dialogs.ok")+"")&&set_data(oi,Lr),mi[0]&7168&&Tr!==(Tr=!!(fi[12]||!fi[11]||!fi[10]))&&(ri.disabled=Tr),mi[0]&8192&&Ir!==(Ir=fi[13]("dialogs.cancel")+"")&&set_data(Qr,Ir)},i:noop$2,o:noop$2,d(fi){fi&&detach(or),li&&li.d(),destroy_each(hi,fi),zr=!1,run_all(Hr)}}}function instance$4(lr,or,ar){let cr,ur,hr,fr,dr,pr=noop$2,mr=()=>(pr(),pr=subscribe(cr,ai=>ar(3,dr=ai)),cr),gr,yr;component_subscribe(lr,nullUntilLoaded,ai=>ar(18,gr=ai)),component_subscribe(lr,$format,ai=>ar(13,yr=ai)),lr.$$.on_destroy.push(()=>pr());let br={fixed,noexport,death,final},{params:Or}=or,{callback:_r}=or,vr,xr,wr,kr,Cr,$r,Nr,Br;const Fr=()=>Object.keys(Cr).filter(ai=>Cr[ai]).concat(Br.split(`
`).map(ai=>ai.trim()).filter(ai=>ai.length>0)),Vr=Or.subscribe(ai=>{ar(5,[vr,xr,wr]=ai,vr,ar(1,xr),ar(6,wr)),ar(17,Nr=xr),ar(7,{title:kr="",group:$r=""}=wr,kr,ar(4,$r));const Kr=wr.flags||[];ar(8,Cr={fixed:Kr.includes("fixed"),noexport:Kr.includes("noexport"),final:Kr.includes("final"),death:Kr.includes("death")}),ar(9,Br=Kr.filter(ui=>!Object.keys(br).includes(ui)).join(`
`))});onDestroy(Vr);function Rr(){xr=this.value,ar(1,xr)}function Gr(){kr=this.value,ar(7,kr)}function qr(){$r=this.value,ar(4,$r)}const Ur=ai=>ar(8,Cr[ai]=!Cr[ai],Cr);function Yr(){Br=this.value,ar(9,Br)}const Dr=()=>_r({key:xr,value:{...wr,title:kr,group:$r,flags:Fr()}}),Jr=()=>_r(!1);return lr.$$set=ai=>{"params"in ai&&ar(16,Or=ai.params),"callback"in ai&&ar(0,_r=ai.callback)},lr.$$.update=()=>{lr.$$.dirty[0]&262144&&mr(ar(2,{book:cr}=gr,cr)),lr.$$.dirty[0]&131086&&ar(12,ur=!!(xr!==Nr&&cr&&dr.index.keys[xr])),lr.$$.dirty[0]&2&&ar(11,hr=xr===sanitizeKey(xr)),lr.$$.dirty[0]&16&&ar(10,fr=$r===sanitizeKey($r))},[_r,xr,cr,dr,$r,vr,wr,kr,Cr,Br,fr,hr,ur,yr,br,Fr,Or,Nr,gr,Rr,Gr,qr,Ur,Yr,Dr,Jr]}class Chapter extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$4,create_fragment$4,safe_not_equal,{params:16,callback:0},null,[-1,-1])}}const SidebarButtons_svelte_svelte_type_style_lang="";function create_else_block$1(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,xr,wr,kr;return{c(){or=element$1("div"),ar=element$1("button"),hr=space$3(),fr=element$1("button"),pr=space$3(),mr=element$1("div"),gr=element$1("button"),Or=space$3(),_r=element$1("button"),attr(ar,"class","icon-back !py-2 svelte-djqv92"),attr(ar,"title",cr=lr[4]("sidemenu.actions.goback")),ar.disabled=ur=!lr[6],attr(fr,"class","icon-plus !py-2 svelte-djqv92"),attr(fr,"title",dr=lr[4]("sidemenu.actions.add")),attr(or,"class","buttons !border-b-0 svelte-djqv92"),attr(gr,"class","icon-pencil !pt-0 !pb-2 svelte-djqv92"),attr(gr,"title",yr=lr[4]("sidemenu.actions.edit")),gr.disabled=br=lr[5]===-1,attr(_r,"class","icon-trash !pt-0 !pb-2 svelte-djqv92"),attr(_r,"title",vr=lr[4]("sidemenu.actions.delete")),_r.disabled=xr=lr[5]===-1,attr(mr,"class","buttons !border-t-0 svelte-djqv92")},m(Cr,$r){insert$1(Cr,or,$r),append(or,ar),append(or,hr),append(or,fr),insert$1(Cr,pr,$r),insert$1(Cr,mr,$r),append(mr,gr),append(mr,Or),append(mr,_r),wr||(kr=[listen(ar,"click",goBack),listen(fr,"click",lr[7]),listen(gr,"click",lr[8]),listen(_r,"click",lr[9])],wr=!0)},p(Cr,$r){$r&16&&cr!==(cr=Cr[4]("sidemenu.actions.goback"))&&attr(ar,"title",cr),$r&64&&ur!==(ur=!Cr[6])&&(ar.disabled=ur),$r&16&&dr!==(dr=Cr[4]("sidemenu.actions.add"))&&attr(fr,"title",dr),$r&16&&yr!==(yr=Cr[4]("sidemenu.actions.edit"))&&attr(gr,"title",yr),$r&32&&br!==(br=Cr[5]===-1)&&(gr.disabled=br),$r&16&&vr!==(vr=Cr[4]("sidemenu.actions.delete"))&&attr(_r,"title",vr),$r&32&&xr!==(xr=Cr[5]===-1)&&(_r.disabled=xr)},d(Cr){Cr&&(detach(or),detach(pr),detach(mr)),wr=!1,run_all(kr)}}}function create_if_block$3(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,xr,wr;return{c(){or=element$1("div"),ar=element$1("button"),hr=space$3(),fr=element$1("button"),pr=space$3(),mr=element$1("button"),br=space$3(),Or=element$1("button"),attr(ar,"class","icon-back svelte-djqv92"),attr(ar,"title",cr=lr[4]("sidemenu.actions.goback")),ar.disabled=ur=!lr[6],attr(fr,"class","icon-plus svelte-djqv92"),attr(fr,"title",dr=lr[4]("sidemenu.actions.add")),attr(mr,"class","icon-pencil svelte-djqv92"),attr(mr,"title",gr=lr[4]("sidemenu.actions.edit")),mr.disabled=yr=lr[5]===-1,attr(Or,"class","icon-trash svelte-djqv92"),attr(Or,"title",_r=lr[4]("sidemenu.actions.delete")),Or.disabled=vr=lr[5]===-1,attr(or,"class","buttons svelte-djqv92")},m(kr,Cr){insert$1(kr,or,Cr),append(or,ar),append(or,hr),append(or,fr),append(or,pr),append(or,mr),append(or,br),append(or,Or),xr||(wr=[listen(ar,"click",goBack),listen(fr,"click",lr[7]),listen(mr,"click",lr[8]),listen(Or,"click",lr[9])],xr=!0)},p(kr,Cr){Cr&16&&cr!==(cr=kr[4]("sidemenu.actions.goback"))&&attr(ar,"title",cr),Cr&64&&ur!==(ur=!kr[6])&&(ar.disabled=ur),Cr&16&&dr!==(dr=kr[4]("sidemenu.actions.add"))&&attr(fr,"title",dr),Cr&16&&gr!==(gr=kr[4]("sidemenu.actions.edit"))&&attr(mr,"title",gr),Cr&32&&yr!==(yr=kr[5]===-1)&&(mr.disabled=yr),Cr&16&&_r!==(_r=kr[4]("sidemenu.actions.delete"))&&attr(Or,"title",_r),Cr&32&&vr!==(vr=kr[5]===-1)&&(Or.disabled=vr)},d(kr){kr&&detach(or),xr=!1,run_all(wr)}}}function create_fragment$3(lr){let or;function ar(hr,fr){return hr[1]>200||hr[0]<680?create_if_block$3:create_else_block$1}let cr=ar(lr),ur=cr(lr);return{c(){ur.c(),or=empty$1()},m(hr,fr){ur.m(hr,fr),insert$1(hr,or,fr)},p(hr,[fr]){cr===(cr=ar(hr))&&ur?ur.p(hr,fr):(ur.d(1),ur=cr(hr),ur&&(ur.c(),ur.m(or.parentNode,or)))},i:noop$2,o:noop$2,d(hr){hr&&detach(or),ur.d(hr)}}}function instance$3(lr,or,ar){let cr,ur,hr,fr,dr,pr,mr,gr=noop$2,yr=()=>(gr(),gr=subscribe(ur,Br=>ar(14,mr=Br)),ur),br,Or=noop$2,_r=()=>(Or(),Or=subscribe(hr,Br=>ar(5,br=Br)),hr),vr,xr;component_subscribe(lr,showSidemenu,Br=>ar(13,dr=Br)),component_subscribe(lr,$format,Br=>ar(4,pr=Br)),component_subscribe(lr,nullUntilLoaded,Br=>ar(10,vr=Br)),component_subscribe(lr,historyCanGoBack,Br=>ar(6,xr=Br)),lr.$$.on_destroy.push(()=>gr()),lr.$$.on_destroy.push(()=>Or());let{windowW:wr}=or,{w:kr}=or;const Cr=async()=>{const Br=await dialog(Chapter,pr("dialogs.chapter.add"),firstAvaiableKey(cr),{title:"",group:(mr==null?void 0:mr.group)??"",flags:[],text:""});if(!Br)return;let{key:Fr,value:Vr}=Br;if(Fr=sanitizeKey(Fr),Vr.group=sanitizeKey(Vr.group||""),!Fr)return;const[Rr]=addChapter(cr,{key:Fr,title:Vr.title??"",group:Vr.group,flags:Vr.flags??[]},br);goToChapter(Rr)},$r=async()=>{if(br===-1)return;const Br=br,Fr=cr.index.chapters[Br],Vr=await dialog(Chapter,pr("dialogs.chapter.add"),Fr.key,{title:Fr.title,group:Fr.group,flags:Fr.flags,text:""});if(!Vr)return;let{key:Rr,value:Gr}=Vr;Rr=sanitizeKey(Rr),Gr.group=sanitizeKey(Gr.group||""),Rr&&(editChapter(cr,Br,{key:Rr,title:Gr.title??"",group:Gr.group,flags:Gr.flags??[]},br),goToChapter(Br,!1),set_store_value(showSidemenu,dr=!1,dr))},Nr=async()=>{const Br=br,Fr=mr.key;Fr!=""&&await dialog(Confirm,pr("dialogs.confirm"),pr("dialogs.chapter.delete").replace("%1",Fr))&&(deleteChapter(cr,Br),set_store_value(showSidemenu,dr=!1,dr),fr.focus())};return ctrlShortcuts({R:()=>Cr(),E:()=>$r(),D:()=>Nr()}),lr.$$set=Br=>{"windowW"in Br&&ar(0,wr=Br.windowW),"w"in Br&&ar(1,kr=Br.w)},lr.$$.update=()=>{lr.$$.dirty&1024&&yr(ar(3,{book:cr,selectedChapter:ur,selectedChapterIndex:hr,editor:fr}=vr,ur,_r(ar(2,hr))))},[wr,kr,hr,ur,pr,br,xr,Cr,$r,Nr,vr]}class SidebarButtons extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$3,create_fragment$3,safe_not_equal,{windowW:0,w:1})}}const Sidebar_svelte_svelte_type_style_lang="",{window:window_1$1}=globals;function get_each_context$1(lr,or,ar){const cr=lr.slice();return cr[26]=or[ar],cr}function get_each_context_1$1(lr,or,ar){const cr=lr.slice();return cr[29]=or[ar],cr}function get_each_context_2$1(lr,or,ar){const cr=lr.slice();return cr[26]=or[ar][0],cr[32]=or[ar][1],cr}function get_each_context_3(lr,or,ar){const cr=lr.slice();return cr[29]=or[ar],cr}function get_each_context_4(lr,or,ar){const cr=lr.slice();return cr[37]=or[ar],cr}function create_if_block$2(lr){let or,ar,cr,ur,hr=lr[10]("sidemenu.allgroup")+"",fr,dr,pr=lr[10]("sidemenu.allgrouperrors")+"",mr,gr,yr=lr[10]("sidemenu.allgrouporphanlinks")+"",br,Or,_r,vr,xr,wr,kr,Cr,$r,Nr,Br=ensure_array_like(Object.keys(lr[3].index.chaptersWith.group)),Fr=[];for(let qr=0;qr<Br.length;qr+=1)Fr[qr]=create_each_block_4(get_each_context_4(lr,Br,qr));_r=new SidebarButtons({props:{windowW:lr[5],w:lr[0]}});let Vr=ensure_array_like(lr[6]),Rr=[];for(let qr=0;qr<Vr.length;qr+=1)Rr[qr]=create_each_block_2$1(get_each_context_2$1(lr,Vr,qr));let Gr=lr[4]!=-1&&create_if_block_1$1(lr);return{c(){or=element$1("h1"),ar=element$1("span"),cr=element$1("select"),ur=element$1("option"),fr=text(hr),dr=element$1("option"),mr=text(pr),gr=element$1("option"),br=text(yr);for(let qr=0;qr<Fr.length;qr+=1)Fr[qr].c();Or=space$3(),create_component(_r.$$.fragment),vr=space$3(),xr=element$1("ul");for(let qr=0;qr<Rr.length;qr+=1)Rr[qr].c();wr=space$3(),Gr&&Gr.c(),kr=empty$1(),ur.__value="allgroupidtag",set_input_value(ur,ur.__value),dr.__value="allgrouperrorsidtag",set_input_value(dr,dr.__value),gr.__value="allgrouporphanlinksidtag",set_input_value(gr,gr.__value),attr(cr,"class","w-full rounded-sm svelte-10jh7e0"),lr[1]===void 0&&add_render_callback(()=>lr[19].call(cr)),attr(ar,"class","select-dropdown w-full svelte-10jh7e0"),attr(or,"class","!pl-0 svelte-10jh7e0"),attr(xr,"class","chapters svelte-10jh7e0")},m(qr,Ur){insert$1(qr,or,Ur),append(or,ar),append(ar,cr),append(cr,ur),append(ur,fr),append(cr,dr),append(dr,mr),append(cr,gr),append(gr,br);for(let Yr=0;Yr<Fr.length;Yr+=1)Fr[Yr]&&Fr[Yr].m(cr,null);select_option(cr,lr[1],!0),insert$1(qr,Or,Ur),mount_component(_r,qr,Ur),insert$1(qr,vr,Ur),insert$1(qr,xr,Ur);for(let Yr=0;Yr<Rr.length;Yr+=1)Rr[Yr]&&Rr[Yr].m(xr,null);insert$1(qr,wr,Ur),Gr&&Gr.m(qr,Ur),insert$1(qr,kr,Ur),Cr=!0,$r||(Nr=listen(cr,"change",lr[19]),$r=!0)},p(qr,Ur){if((!Cr||Ur[0]&1024)&&hr!==(hr=qr[10]("sidemenu.allgroup")+"")&&set_data(fr,hr),(!Cr||Ur[0]&1024)&&pr!==(pr=qr[10]("sidemenu.allgrouperrors")+"")&&set_data(mr,pr),(!Cr||Ur[0]&1024)&&yr!==(yr=qr[10]("sidemenu.allgrouporphanlinks")+"")&&set_data(br,yr),Ur[0]&8){Br=ensure_array_like(Object.keys(qr[3].index.chaptersWith.group));let Dr;for(Dr=0;Dr<Br.length;Dr+=1){const Jr=get_each_context_4(qr,Br,Dr);Fr[Dr]?Fr[Dr].p(Jr,Ur):(Fr[Dr]=create_each_block_4(Jr),Fr[Dr].c(),Fr[Dr].m(cr,null))}for(;Dr<Fr.length;Dr+=1)Fr[Dr].d(1);Fr.length=Br.length}Ur[0]&10&&select_option(cr,qr[1]);const Yr={};if(Ur[0]&32&&(Yr.windowW=qr[5]),Ur[0]&1&&(Yr.w=qr[0]),_r.$set(Yr),Ur[0]&24701){Vr=ensure_array_like(qr[6]);let Dr;for(Dr=0;Dr<Vr.length;Dr+=1){const Jr=get_each_context_2$1(qr,Vr,Dr);Rr[Dr]?Rr[Dr].p(Jr,Ur):(Rr[Dr]=create_each_block_2$1(Jr),Rr[Dr].c(),Rr[Dr].m(xr,null))}for(;Dr<Rr.length;Dr+=1)Rr[Dr].d(1);Rr.length=Vr.length}qr[4]!=-1?Gr?Gr.p(qr,Ur):(Gr=create_if_block_1$1(qr),Gr.c(),Gr.m(kr.parentNode,kr)):Gr&&(Gr.d(1),Gr=null)},i(qr){Cr||(transition_in(_r.$$.fragment,qr),Cr=!0)},o(qr){transition_out(_r.$$.fragment,qr),Cr=!1},d(qr){qr&&(detach(or),detach(Or),detach(vr),detach(xr),detach(wr),detach(kr)),destroy_each(Fr,qr),destroy_component(_r,qr),destroy_each(Rr,qr),Gr&&Gr.d(qr),$r=!1,Nr()}}}function create_each_block_4(lr){let or,ar=lr[37]+"",cr,ur;return{c(){or=element$1("option"),cr=text(ar),or.__value=ur=lr[37],set_input_value(or,or.__value)},m(hr,fr){insert$1(hr,or,fr),append(or,cr)},p(hr,fr){fr[0]&8&&ar!==(ar=hr[37]+"")&&set_data(cr,ar),fr[0]&8&&ur!==(ur=hr[37])&&(or.__value=ur,set_input_value(or,or.__value))},d(hr){hr&&detach(or)}}}function create_else_block_1(lr){let or,ar=lr[32].key+"",cr;return{c(){or=element$1("div"),cr=text(ar),attr(or,"class","text-center w-full mx-auto")},m(ur,hr){insert$1(ur,or,hr),append(or,cr)},p(ur,hr){hr[0]&64&&ar!==(ar=ur[32].key+"")&&set_data(cr,ar)},d(ur){ur&&detach(or)}}}function create_if_block_3(lr){let or=lr[32].key+"",ar,cr,ur,hr=(lr[32].title||"")+"",fr,dr,pr,mr,gr=lr[13](lr[32])+"",yr,br,Or=lr[14](lr[32])+"",_r=ensure_array_like(lr[32].flags||[]),vr=[];for(let xr=0;xr<_r.length;xr+=1)vr[xr]=create_each_block_3(get_each_context_3(lr,_r,xr));return{c(){ar=text(or),cr=space$3(),ur=element$1("b"),fr=text(hr),dr=space$3();for(let xr=0;xr<vr.length;xr+=1)vr[xr].c();pr=space$3(),mr=element$1("span"),yr=space$3(),br=element$1("span"),attr(ur,"class","svelte-10jh7e0"),attr(mr,"class","errors svelte-10jh7e0"),attr(br,"class","errors svelte-10jh7e0")},m(xr,wr){insert$1(xr,ar,wr),insert$1(xr,cr,wr),insert$1(xr,ur,wr),append(ur,fr),insert$1(xr,dr,wr);for(let kr=0;kr<vr.length;kr+=1)vr[kr]&&vr[kr].m(xr,wr);insert$1(xr,pr,wr),insert$1(xr,mr,wr),mr.innerHTML=gr,insert$1(xr,yr,wr),insert$1(xr,br,wr),br.innerHTML=Or},p(xr,wr){if(wr[0]&64&&or!==(or=xr[32].key+"")&&set_data(ar,or),wr[0]&64&&hr!==(hr=(xr[32].title||"")+"")&&set_data(fr,hr),wr[0]&68){_r=ensure_array_like(xr[32].flags||[]);let kr;for(kr=0;kr<_r.length;kr+=1){const Cr=get_each_context_3(xr,_r,kr);vr[kr]?vr[kr].p(Cr,wr):(vr[kr]=create_each_block_3(Cr),vr[kr].c(),vr[kr].m(pr.parentNode,pr))}for(;kr<vr.length;kr+=1)vr[kr].d(1);vr.length=_r.length}wr[0]&64&&gr!==(gr=xr[13](xr[32])+"")&&(mr.innerHTML=gr),wr[0]&64&&Or!==(Or=xr[14](xr[32])+"")&&(br.innerHTML=Or)},d(xr){xr&&(detach(ar),detach(cr),detach(ur),detach(dr),detach(pr),detach(mr),detach(yr),detach(br)),destroy_each(vr,xr)}}}function create_each_block_3(lr){let or,ar,cr;return{c(){or=element$1("img"),attr(or,"class","inline-block w-6 h-6"),src_url_equal(or.src,ar=flagURL(lr[29],lr[2]))||attr(or,"src",ar),attr(or,"alt",cr=lr[29])},m(ur,hr){insert$1(ur,or,hr)},p(ur,hr){hr[0]&68&&!src_url_equal(or.src,ar=flagURL(ur[29],ur[2]))&&attr(or,"src",ar),hr[0]&64&&cr!==(cr=ur[29])&&attr(or,"alt",cr)},d(ur){ur&&detach(or)}}}function create_each_block_2$1(lr){let or,ar,cr,ur,hr;function fr(gr,yr){return gr[0]>200||gr[5]<680?create_if_block_3:create_else_block_1}let dr=fr(lr),pr=dr(lr);function mr(){return lr[20](lr[26])}return{c(){or=element$1("a"),pr.c(),ar=space$3(),attr(or,"href",cr=urlOfChapterKey(lr[3].index.chapters[lr[26]].key)),attr(or,"class","svelte-10jh7e0"),toggle_class(or,"selected",lr[26]===lr[4])},m(gr,yr){insert$1(gr,or,yr),pr.m(or,null),append(or,ar),ur||(hr=listen(or,"click",prevent_default(mr)),ur=!0)},p(gr,yr){lr=gr,dr===(dr=fr(lr))&&pr?pr.p(lr,yr):(pr.d(1),pr=dr(lr),pr&&(pr.c(),pr.m(or,ar))),yr[0]&72&&cr!==(cr=urlOfChapterKey(lr[3].index.chapters[lr[26]].key))&&attr(or,"href",cr),yr[0]&80&&toggle_class(or,"selected",lr[26]===lr[4])},d(gr){gr&&detach(or),pr.d(),ur=!1,hr()}}}function create_if_block_1$1(lr){let or,ar=lr[10]("sidemenu.linkshere")+"",cr,ur,hr=lr[11].key+"",fr,dr,pr,mr,gr=ensure_array_like(lr[11]==null?[]:lr[11].linkedFrom),yr=[];for(let br=0;br<gr.length;br+=1)yr[br]=create_each_block$1(get_each_context$1(lr,gr,br));return{c(){or=element$1("h1"),cr=text(ar),ur=space$3(),fr=text(hr),dr=text(":"),pr=space$3(),mr=element$1("ul");for(let br=0;br<yr.length;br+=1)yr[br].c();attr(or,"class","svelte-10jh7e0"),attr(mr,"class","links-here svelte-10jh7e0")},m(br,Or){insert$1(br,or,Or),append(or,cr),append(or,ur),append(or,fr),append(or,dr),insert$1(br,pr,Or),insert$1(br,mr,Or);for(let _r=0;_r<yr.length;_r+=1)yr[_r]&&yr[_r].m(mr,null)},p(br,Or){if(Or[0]&1024&&ar!==(ar=br[10]("sidemenu.linkshere")+"")&&set_data(cr,ar),Or[0]&2048&&hr!==(hr=br[11].key+"")&&set_data(fr,hr),Or[0]&2109){gr=ensure_array_like(br[11]==null?[]:br[11].linkedFrom);let _r;for(_r=0;_r<gr.length;_r+=1){const vr=get_each_context$1(br,gr,_r);yr[_r]?yr[_r].p(vr,Or):(yr[_r]=create_each_block$1(vr),yr[_r].c(),yr[_r].m(mr,null))}for(;_r<yr.length;_r+=1)yr[_r].d(1);yr.length=gr.length}},d(br){br&&(detach(or),detach(pr),detach(mr)),destroy_each(yr,br)}}}function create_else_block(lr){let or,ar=lr[3].index.chapters[lr[26]].key+"",cr;return{c(){or=element$1("div"),cr=text(ar),attr(or,"class","text-center w-full mx-auto")},m(ur,hr){insert$1(ur,or,hr),append(or,cr)},p(ur,hr){hr[0]&2056&&ar!==(ar=ur[3].index.chapters[ur[26]].key+"")&&set_data(cr,ar)},d(ur){ur&&detach(or)}}}function create_if_block_2$1(lr){let or=lr[3].index.chapters[lr[26]].key+"",ar,cr,ur,hr=(lr[3].index.chapters[lr[26]].title||"")+"",fr,dr,pr,mr=ensure_array_like(lr[3].index.chapters[lr[26]].flags||[]),gr=[];for(let yr=0;yr<mr.length;yr+=1)gr[yr]=create_each_block_1$1(get_each_context_1$1(lr,mr,yr));return{c(){ar=text(or),cr=space$3(),ur=element$1("b"),fr=text(hr),dr=space$3();for(let yr=0;yr<gr.length;yr+=1)gr[yr].c();pr=empty$1(),attr(ur,"class","svelte-10jh7e0")},m(yr,br){insert$1(yr,ar,br),insert$1(yr,cr,br),insert$1(yr,ur,br),append(ur,fr),insert$1(yr,dr,br);for(let Or=0;Or<gr.length;Or+=1)gr[Or]&&gr[Or].m(yr,br);insert$1(yr,pr,br)},p(yr,br){if(br[0]&2056&&or!==(or=yr[3].index.chapters[yr[26]].key+"")&&set_data(ar,or),br[0]&2056&&hr!==(hr=(yr[3].index.chapters[yr[26]].title||"")+"")&&set_data(fr,hr),br[0]&2060){mr=ensure_array_like(yr[3].index.chapters[yr[26]].flags||[]);let Or;for(Or=0;Or<mr.length;Or+=1){const _r=get_each_context_1$1(yr,mr,Or);gr[Or]?gr[Or].p(_r,br):(gr[Or]=create_each_block_1$1(_r),gr[Or].c(),gr[Or].m(pr.parentNode,pr))}for(;Or<gr.length;Or+=1)gr[Or].d(1);gr.length=mr.length}},d(yr){yr&&(detach(ar),detach(cr),detach(ur),detach(dr),detach(pr)),destroy_each(gr,yr)}}}function create_each_block_1$1(lr){let or,ar,cr;return{c(){or=element$1("img"),attr(or,"class","inline-block w-6 h-6"),src_url_equal(or.src,ar=flagURL(lr[29],lr[2]))||attr(or,"src",ar),attr(or,"alt",cr=lr[29])},m(ur,hr){insert$1(ur,or,hr)},p(ur,hr){hr[0]&2060&&!src_url_equal(or.src,ar=flagURL(ur[29],ur[2]))&&attr(or,"src",ar),hr[0]&2056&&cr!==(cr=ur[29])&&attr(or,"alt",cr)},d(ur){ur&&detach(or)}}}function create_each_block$1(lr){let or,ar,cr,ur,hr;function fr(gr,yr){return gr[0]>200||gr[5]<680?create_if_block_2$1:create_else_block}let dr=fr(lr),pr=dr(lr);function mr(){return lr[21](lr[26])}return{c(){or=element$1("a"),pr.c(),ar=space$3(),attr(or,"href",cr=urlOfChapterKey(lr[3].index.chapters[lr[26]].key)),attr(or,"class","svelte-10jh7e0"),toggle_class(or,"selected",lr[26]===lr[4])},m(gr,yr){insert$1(gr,or,yr),pr.m(or,null),append(or,ar),ur||(hr=listen(or,"click",prevent_default(mr)),ur=!0)},p(gr,yr){lr=gr,dr===(dr=fr(lr))&&pr?pr.p(lr,yr):(pr.d(1),pr=dr(lr),pr&&(pr.c(),pr.m(or,ar))),yr[0]&2056&&cr!==(cr=urlOfChapterKey(lr[3].index.chapters[lr[26]].key))&&attr(or,"href",cr),yr[0]&2064&&toggle_class(or,"selected",lr[26]===lr[4])},d(gr){gr&&detach(or),pr.d(),ur=!1,hr()}}}function create_fragment$2(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or;add_render_callback(lr[17]);let _r=lr[2]&&(lr[0]>100||lr[5]<680)&&create_if_block$2(lr);return{c(){or=element$1("div"),cr=space$3(),ur=element$1("aside"),hr=element$1("div"),hr.innerHTML="",fr=space$3(),dr=element$1("div"),_r&&_r.c(),attr(or,"role","button"),attr(or,"tabindex","0"),attr(or,"class",ar=null_to_empty(`mask ${lr[9]?"foreground":""}`)+" svelte-10jh7e0"),attr(hr,"role","button"),attr(hr,"tabindex","-1"),attr(hr,"class","sidebar-resizer bg-[#ccc] hover:bg-zinc-500 dark:bg-[#272727] hover:dark:bg-[#505050] border-l-2 boder-[#ccc] dark:border-[#272727] flex-initial w-[6px] min-w-[6px] flex-shrink-0 h-full cursor-col-resize svelte-10jh7e0"),attr(dr,"class",pr=null_to_empty("max-w-[400px] pb-5 mx-auto h-full flex flex-col w-full overflow-hidden "+(lr[0]>150||lr[5]<680?"px-8":"px-3"))+" svelte-10jh7e0"),attr(ur,"class",mr=null_to_empty((lr[9]?"foreground":"")+" flex flex-row")+" svelte-10jh7e0"),attr(ur,"style",gr=`width: ${lr[0]}px`)},m(vr,xr){insert$1(vr,or,xr),insert$1(vr,cr,xr),insert$1(vr,ur,xr),append(ur,hr),append(ur,fr),append(ur,dr),_r&&_r.m(dr,null),yr=!0,br||(Or=[listen(window_1$1,"resize",lr[17]),listen(or,"click",lr[18]),listen(hr,"touchstart",stop_propagation(prevent_default(lr[12]))),listen(hr,"mousedown",stop_propagation(prevent_default(lr[12])))],br=!0)},p(vr,xr){(!yr||xr[0]&512&&ar!==(ar=null_to_empty(`mask ${vr[9]?"foreground":""}`)+" svelte-10jh7e0"))&&attr(or,"class",ar),vr[2]&&(vr[0]>100||vr[5]<680)?_r?(_r.p(vr,xr),xr[0]&37&&transition_in(_r,1)):(_r=create_if_block$2(vr),_r.c(),transition_in(_r,1),_r.m(dr,null)):_r&&(group_outros(),transition_out(_r,1,1,()=>{_r=null}),check_outros()),(!yr||xr[0]&33&&pr!==(pr=null_to_empty("max-w-[400px] pb-5 mx-auto h-full flex flex-col w-full overflow-hidden "+(vr[0]>150||vr[5]<680?"px-8":"px-3"))+" svelte-10jh7e0"))&&attr(dr,"class",pr),(!yr||xr[0]&512&&mr!==(mr=null_to_empty((vr[9]?"foreground":"")+" flex flex-row")+" svelte-10jh7e0"))&&attr(ur,"class",mr),(!yr||xr[0]&1&&gr!==(gr=`width: ${vr[0]}px`))&&attr(ur,"style",gr)},i(vr){yr||(transition_in(_r),yr=!0)},o(vr){transition_out(_r),yr=!1},d(vr){vr&&(detach(or),detach(cr),detach(ur)),_r&&_r.d(),br=!1,run_all(Or)}}}function instance$2(lr,or,ar){let cr,ur,hr,fr,dr,pr=noop$2,mr=()=>(pr(),pr=subscribe(cr,ii=>ar(3,dr=ii)),cr),gr,yr=noop$2,br=()=>(yr(),yr=subscribe(ur,ii=>ar(4,gr=ii)),ur),Or,_r,vr,xr,wr=noop$2,kr=()=>(wr(),wr=subscribe(hr,ii=>ar(11,xr=ii)),hr);component_subscribe(lr,nullUntilLoaded,ii=>ar(16,Or=ii)),component_subscribe(lr,showSidemenu,ii=>ar(9,_r=ii)),component_subscribe(lr,$format,ii=>ar(10,vr=ii)),lr.$$.on_destroy.push(()=>pr()),lr.$$.on_destroy.push(()=>yr()),lr.$$.on_destroy.push(()=>wr());let Cr=0,$r=localStorage["mage-sidebar-width"]?parseInt(localStorage["mage-sidebar-width"]):400,Nr=localStorage["mage-sidebar-preferredwidth"]?parseInt(localStorage["mage-sidebar-preferredwidth"]):400,Br=Nr,Fr=0;const Vr=ii=>{const di="touches"in ii?ii.changedTouches[0].pageX:ii.x;Br=ar(0,$r=Math.min(Math.max(Fr-di,0),window.innerWidth*.45))},Rr=()=>{$r<100?ar(0,$r=10):ar(15,Nr=Br)},Gr=ii=>{Fr=("touches"in ii?ii.changedTouches[0].pageX:ii.x)+$r,"touches"in ii?(document.addEventListener("touchmove",Vr,!1),document.addEventListener("touchend",()=>{Rr(),document.removeEventListener("touchmove",Vr,!1)},{once:!0})):(document.addEventListener("mousemove",Vr,!1),document.addEventListener("mouseup",()=>{Rr(),document.removeEventListener("mousemove",Vr,!1)},{once:!0}))};let qr="allgroupidtag";const Ur=ii=>{const di=ii.linkedFrom.length>0,ei=ii.links.length>0||ii.flags.length>0;return(di?"":'<i class="icon-help"></i>')+(di&&ei?"":'<i class="icon-right"></i>')+(ei?"":'<i class="icon-help"></i>')},Yr=ii=>ii.links.some(ei=>!dr.index.keys[ei])?'<b>[</b><i class="icon-help"></i><b>]</b>':"";function Dr(){ar(5,Cr=window_1$1.innerWidth)}const Jr=()=>set_store_value(showSidemenu,_r=!1,_r);function ai(){qr=select_value(this),ar(1,qr),ar(2,cr),ar(3,dr),ar(16,Or)}const Kr=ii=>goToChapter(ii),ui=ii=>goToChapter(ii);return lr.$$.update=()=>{lr.$$.dirty[0]&65536&&mr(ar(2,{book:cr,selectedChapterIndex:ur,selectedChapter:hr}=Or,cr,br(ar(8,ur)),kr(ar(7,hr)))),lr.$$.dirty[0]&32769&&(localStorage["mage-sidebar-width"]=$r,localStorage["mage-sidebar-preferredwidth"]=Nr),lr.$$.dirty[0]&16&&(gr!=-1?(async()=>{await tick();try{s(document.querySelector("aside ul.chapters a.selected"),{behavior:"smooth",scrollMode:"if-needed"})}catch{}})():(async()=>{await tick();try{s(document.querySelector("aside ul.chapters a"),{behavior:"smooth",scrollMode:"if-needed"})}catch{}})()),lr.$$.dirty[0]&14&&cr!==null&&([...Object.keys(dr.index.chaptersWith.group),"allgroupidtag","allgrouperrorsidtag","allgrouporphanlinksidtag"].includes(qr)||ar(1,qr="allgroupidtag")),lr.$$.dirty[0]&14&&ar(6,fr=cr===null?[]:Array.from(dr.index.chapters.entries()).filter(([ii,di])=>{if(!qr||qr=="allgroupidtag")return!0;if(qr=="allgrouperrorsidtag"){const Wr=di.linkedFrom.length>0,ti=di.links.length>0||di.flags.length>0;return!Wr||!ti}if(qr=="allgrouporphanlinksidtag")return di.links.some(ti=>!dr.index.keys[ti]);const ei=di.group;return ei&&ei==qr}))},[$r,qr,cr,dr,gr,Cr,fr,hr,ur,_r,vr,xr,Gr,Ur,Yr,Nr,Or,Dr,Jr,ai,Kr,ui]}class Sidebar extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$2,create_fragment$2,safe_not_equal,{},null,[-1,-1])}}const portraitChecker=window.matchMedia("(orientation: portrait)"),portrait=writable(portraitChecker.matches);portraitChecker.addEventListener("change",lr=>{portrait.set(lr.matches)});const PluginPanel_svelte_svelte_type_style_lang="";function get_each_context(lr,or,ar){const cr=lr.slice();return cr[17]=or[ar],cr}function get_each_context_1(lr,or,ar){const cr=lr.slice();return cr[20]=or[ar],cr}function get_each_context_2(lr,or,ar){const cr=lr.slice();return cr[17]=or[ar],cr}function create_if_block_2(lr){let or,ar,cr;var ur=lr[17].widget;function hr(fr,dr){return{props:{store,w:fr[0],tab:fr[2],isResizing:fr[3]}}}return ur&&(or=construct_svelte_component(ur,hr(lr))),{c(){or&&create_component(or.$$.fragment),ar=empty$1()},m(fr,dr){or&&mount_component(or,fr,dr),insert$1(fr,ar,dr),cr=!0},p(fr,dr){if(dr&16&&ur!==(ur=fr[17].widget)){if(or){group_outros();const pr=or;transition_out(pr.$$.fragment,1,0,()=>{destroy_component(pr,1)}),check_outros()}ur?(or=construct_svelte_component(ur,hr(fr)),create_component(or.$$.fragment),transition_in(or.$$.fragment,1),mount_component(or,ar.parentNode,ar)):or=null}else if(ur){const pr={};dr&1&&(pr.w=fr[0]),dr&4&&(pr.tab=fr[2]),dr&8&&(pr.isResizing=fr[3]),or.$set(pr)}},i(fr){cr||(or&&transition_in(or.$$.fragment,fr),cr=!0)},o(fr){or&&transition_out(or.$$.fragment,fr),cr=!1},d(fr){fr&&detach(ar),or&&destroy_component(or,fr)}}}function create_each_block_2(lr){let or,ar,cr=lr[17].widget&&create_if_block_2(lr);return{c(){cr&&cr.c(),or=empty$1()},m(ur,hr){cr&&cr.m(ur,hr),insert$1(ur,or,hr),ar=!0},p(ur,hr){ur[17].widget?cr?(cr.p(ur,hr),hr&16&&transition_in(cr,1)):(cr=create_if_block_2(ur),cr.c(),transition_in(cr,1),cr.m(or.parentNode,or)):cr&&(group_outros(),transition_out(cr,1,1,()=>{cr=null}),check_outros())},i(ur){ar||(transition_in(cr),ar=!0)},o(ur){transition_out(cr),ar=!1},d(ur){ur&&detach(or),cr&&cr.d(ur)}}}function create_if_block_1(lr){let or,ar=lr[20].icon+"",cr;return{c(){or=new HtmlTag(!1),cr=empty$1(),or.a=cr},m(ur,hr){or.m(ar,ur,hr),insert$1(ur,cr,hr)},p(ur,hr){hr&16&&ar!==(ar=ur[20].icon+"")&&or.p(ar)},d(ur){ur&&(detach(cr),or.d())}}}function create_if_block$1(lr){let or,ar=lr[6](lr[20].label)+"";return{c(){or=element$1("span"),attr(or,"class","text-slate-300 text-xs font-bold")},m(cr,ur){insert$1(cr,or,ur),or.innerHTML=ar},p(cr,ur){ur&80&&ar!==(ar=cr[6](cr[20].label)+"")&&(or.innerHTML=ar)},d(cr){cr&&detach(or)}}}function create_each_block_1(lr){let or,ar,cr,ur,hr,fr,dr,pr=lr[20].icon&&create_if_block_1(lr),mr=lr[20].label&&create_if_block$1(lr);function gr(){return lr[8](lr[20])}return{c(){or=element$1("button"),ar=element$1("div"),pr&&pr.c(),cr=space$3(),mr&&mr.c(),ur=space$3(),attr(ar,"class","text-center"),attr(or,"class",hr=null_to_empty("h-[60px] w-[60px] m-2 py-1 rounded-md bg-slate-600 hover:shadow-md shadow-black cursor-pointer hover:scale-105 transition-all flex justify-center items-center "+(lr[20].id==lr[2]?"bg-slate-800":""))+" svelte-wqci3p")},m(yr,br){insert$1(yr,or,br),append(or,ar),pr&&pr.m(ar,null),append(ar,cr),mr&&mr.m(ar,null),append(or,ur),fr||(dr=listen(or,"click",gr),fr=!0)},p(yr,br){lr=yr,lr[20].icon?pr?pr.p(lr,br):(pr=create_if_block_1(lr),pr.c(),pr.m(ar,cr)):pr&&(pr.d(1),pr=null),lr[20].label?mr?mr.p(lr,br):(mr=create_if_block$1(lr),mr.c(),mr.m(ar,null)):mr&&(mr.d(1),mr=null),br&20&&hr!==(hr=null_to_empty("h-[60px] w-[60px] m-2 py-1 rounded-md bg-slate-600 hover:shadow-md shadow-black cursor-pointer hover:scale-105 transition-all flex justify-center items-center "+(lr[20].id==lr[2]?"bg-slate-800":""))+" svelte-wqci3p")&&attr(or,"class",hr)},d(yr){yr&&detach(or),pr&&pr.d(),mr&&mr.d(),fr=!1,dr()}}}function create_each_block(lr){let or,ar=ensure_array_like(lr[17].tabs),cr=[];for(let ur=0;ur<ar.length;ur+=1)cr[ur]=create_each_block_1(get_each_context_1(lr,ar,ur));return{c(){for(let ur=0;ur<cr.length;ur+=1)cr[ur].c();or=empty$1()},m(ur,hr){for(let fr=0;fr<cr.length;fr+=1)cr[fr]&&cr[fr].m(ur,hr);insert$1(ur,or,hr)},p(ur,hr){if(hr&87){ar=ensure_array_like(ur[17].tabs);let fr;for(fr=0;fr<ar.length;fr+=1){const dr=get_each_context_1(ur,ar,fr);cr[fr]?cr[fr].p(dr,hr):(cr[fr]=create_each_block_1(dr),cr[fr].c(),cr[fr].m(or.parentNode,or))}for(;fr<cr.length;fr+=1)cr[fr].d(1);cr.length=ar.length}},d(ur){ur&&detach(or),destroy_each(cr,ur)}}}function create_fragment$1(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr,yr,br=ensure_array_like(lr[4]),Or=[];for(let wr=0;wr<br.length;wr+=1)Or[wr]=create_each_block_2(get_each_context_2(lr,br,wr));const _r=wr=>transition_out(Or[wr],1,1,()=>{Or[wr]=null});let vr=ensure_array_like(lr[4]),xr=[];for(let wr=0;wr<vr.length;wr+=1)xr[wr]=create_each_block(get_each_context(lr,vr,wr));return{c(){or=element$1("div"),ar=element$1("div"),cr=element$1("div"),cr.innerHTML="",ur=space$3();for(let wr=0;wr<Or.length;wr+=1)Or[wr].c();fr=space$3(),dr=element$1("div");for(let wr=0;wr<xr.length;wr+=1)xr[wr].c();attr(cr,"class","bg-zinc-400 absolute l-0 hover:bg-zinc-500 border-l-0 border-zinc-500 flex-initial flex-shrink-0 w-[8px] h-full cursor-col-resize"),attr(cr,"role","button"),attr(cr,"tabindex","-1"),attr(ar,"class","overflow-y-auto relative"),attr(ar,"style",hr=`width: calc(${lr[0]}px)`),attr(dr,"class","bg-slate-500 select-none"),attr(or,"class",pr=null_to_empty("plugin-panel bg-zinc-400 flex "+(lr[5]&&lr[2]!=null?"":"hidden"))+" svelte-wqci3p"),set_style(or,"grid-area","pluginpanel")},m(wr,kr){insert$1(wr,or,kr),append(or,ar),append(ar,cr),append(ar,ur);for(let Cr=0;Cr<Or.length;Cr+=1)Or[Cr]&&Or[Cr].m(ar,null);append(or,fr),append(or,dr);for(let Cr=0;Cr<xr.length;Cr+=1)xr[Cr]&&xr[Cr].m(dr,null);mr=!0,gr||(yr=[listen(cr,"touchstart",stop_propagation(prevent_default(lr[7]))),listen(cr,"mousedown",stop_propagation(prevent_default(lr[7])))],gr=!0)},p(wr,[kr]){if(kr&29){br=ensure_array_like(wr[4]);let Cr;for(Cr=0;Cr<br.length;Cr+=1){const $r=get_each_context_2(wr,br,Cr);Or[Cr]?(Or[Cr].p($r,kr),transition_in(Or[Cr],1)):(Or[Cr]=create_each_block_2($r),Or[Cr].c(),transition_in(Or[Cr],1),Or[Cr].m(ar,null))}for(group_outros(),Cr=br.length;Cr<Or.length;Cr+=1)_r(Cr);check_outros()}if((!mr||kr&1&&hr!==(hr=`width: calc(${wr[0]}px)`))&&attr(ar,"style",hr),kr&87){vr=ensure_array_like(wr[4]);let Cr;for(Cr=0;Cr<vr.length;Cr+=1){const $r=get_each_context(wr,vr,Cr);xr[Cr]?xr[Cr].p($r,kr):(xr[Cr]=create_each_block($r),xr[Cr].c(),xr[Cr].m(dr,null))}for(;Cr<xr.length;Cr+=1)xr[Cr].d(1);xr.length=vr.length}(!mr||kr&36&&pr!==(pr=null_to_empty("plugin-panel bg-zinc-400 flex "+(wr[5]&&wr[2]!=null?"":"hidden"))+" svelte-wqci3p"))&&attr(or,"class",pr)},i(wr){if(!mr){for(let kr=0;kr<br.length;kr+=1)transition_in(Or[kr]);mr=!0}},o(wr){Or=Or.filter(Boolean);for(let kr=0;kr<Or.length;kr+=1)transition_out(Or[kr]);mr=!1},d(wr){wr&&detach(or),destroy_each(Or,wr),destroy_each(xr,wr),gr=!1,run_all(yr)}}}const minW=8;function instance$1(lr,or,ar){let cr,ur,hr,fr;component_subscribe(lr,portrait,$r=>ar(13,cr=$r)),component_subscribe(lr,pluginPanel,$r=>ar(4,ur=$r)),component_subscribe(lr,showPluginPanel,$r=>ar(5,hr=$r)),component_subscribe(lr,$format,$r=>ar(6,fr=$r)),ur.length>0&&showPluginPanel.set(!0);let pr=(()=>{for(const $r of ur)if($r.tabs&&$r.tabs[0])return $r.tabs[0].id;return null})(),mr=localStorage["mage-pluginpanel-width"]?parseInt(localStorage["mage-pluginpanel-width"]):minW,gr=250,yr=!1,br=localStorage["mage-pluginpanel-preferredwidth"]?parseInt(localStorage["mage-pluginpanel-preferredwidth"]):500,Or=br,_r=0,vr=0;const xr=$r=>{if(cr){const Nr="touches"in $r?$r.changedTouches[0].pageY:$r.y;gr=Math.min(vr+Nr,0)}else{const Nr="touches"in $r?$r.changedTouches[0].pageX:$r.x;Or=ar(0,mr=Math.min(Math.max(_r-Nr,minW),window.innerWidth*.45))}},wr=()=>{ar(3,yr=!1),mr<30?ar(0,mr=minW):ar(1,br=Or)},kr=$r=>{cr?vr=("touches"in $r?$r.changedTouches[0].pageY:$r.y)+gr:_r=("touches"in $r?$r.changedTouches[0].pageX:$r.x)+mr,ar(3,yr=!0),"touches"in $r?(document.addEventListener("touchmove",xr,!1),document.addEventListener("touchend",()=>{wr(),document.removeEventListener("touchmove",xr,!1)},{once:!0})):(document.addEventListener("mousemove",xr,!1),document.addEventListener("mouseup",()=>{wr(),document.removeEventListener("mousemove",xr,!1)},{once:!0}))},Cr=$r=>{if(pr===$r.id){ar(0,mr=mr<10?br:minW);return}ar(2,pr=$r.id),mr<10&&ar(0,mr=br)};return lr.$$.update=()=>{lr.$$.dirty&3&&(localStorage["mage-pluginpanel-width"]=mr,localStorage["mage-pluginpanel-preferredwidth"]=br)},[mr,br,pr,yr,ur,hr,fr,kr,Cr]}class PluginPanel extends SvelteComponent{constructor(or){super(),init$1(this,or,instance$1,create_fragment$1,safe_not_equal,{})}}const App_svelte_svelte_type_style_lang="",{document:document_1,window:window_1}=globals;function create_if_block(lr){let or;return{c(){or=element$1("div"),or.innerHTML='<div class="dialog" style="text-align: center; margin-top: 10vh"><div class="spinner-1"></div></div>',attr(or,"class","loading-mask svelte-y6niz7")},m(ar,cr){insert$1(ar,or,cr)},d(ar){ar&&detach(or)}}}function create_fragment(lr){let or,ar,cr,ur,hr,fr,dr,pr,mr,gr,yr,br,Or,_r,vr,xr,wr,kr,Cr=!lr[0]&&create_if_block();return hr=new Dialogs({}),dr=new Navbar({}),mr=new Sidebar({}),yr=new PluginPanel({}),Or=new Editor({}),vr=new SvelteToast({}),{c(){or=new HtmlTag(!1),ar=empty$1(),cr=space$3(),Cr&&Cr.c(),ur=space$3(),create_component(hr.$$.fragment),fr=space$3(),create_component(dr.$$.fragment),pr=space$3(),create_component(mr.$$.fragment),gr=space$3(),create_component(yr.$$.fragment),br=space$3(),create_component(Or.$$.fragment),_r=space$3(),create_component(vr.$$.fragment),or.a=ar},m($r,Nr){or.m(lr[1],document_1.head),append(document_1.head,ar),insert$1($r,cr,Nr),Cr&&Cr.m($r,Nr),insert$1($r,ur,Nr),mount_component(hr,$r,Nr),insert$1($r,fr,Nr),mount_component(dr,$r,Nr),insert$1($r,pr,Nr),mount_component(mr,$r,Nr),insert$1($r,gr,Nr),mount_component(yr,$r,Nr),insert$1($r,br,Nr),mount_component(Or,$r,Nr),insert$1($r,_r,Nr),mount_component(vr,$r,Nr),xr=!0,wr||(kr=listen(window_1,"keydown",handleShortcuts),wr=!0)},p($r,[Nr]){(!xr||Nr&2)&&or.p($r[1]),$r[0]?Cr&&(Cr.d(1),Cr=null):Cr||(Cr=create_if_block(),Cr.c(),Cr.m(ur.parentNode,ur))},i($r){xr||(transition_in(hr.$$.fragment,$r),transition_in(dr.$$.fragment,$r),transition_in(mr.$$.fragment,$r),transition_in(yr.$$.fragment,$r),transition_in(Or.$$.fragment,$r),transition_in(vr.$$.fragment,$r),xr=!0)},o($r){transition_out(hr.$$.fragment,$r),transition_out(dr.$$.fragment,$r),transition_out(mr.$$.fragment,$r),transition_out(yr.$$.fragment,$r),transition_out(Or.$$.fragment,$r),transition_out(vr.$$.fragment,$r),xr=!1},d($r){$r&&(or.d(),detach(cr),detach(ur),detach(fr),detach(pr),detach(gr),detach(br),detach(_r)),detach(ar),Cr&&Cr.d($r),destroy_component(hr,$r),destroy_component(dr,$r),destroy_component(mr,$r),destroy_component(yr,$r),destroy_component(Or,$r),destroy_component(vr,$r),wr=!1,kr()}}}const key="mage-version";function instance(lr,or,ar){let cr,ur,hr,fr,dr=noop$2,pr=()=>(dr(),dr=subscribe(cr,Or=>ar(3,fr=Or)),cr),mr,gr;component_subscribe(lr,$format,Or=>ar(6,hr=Or)),component_subscribe(lr,nullUntilLoaded,Or=>ar(5,gr=Or)),lr.$$.on_destroy.push(()=>dr());const{theme:yr}=s$2;component_subscribe(lr,yr,Or=>ar(4,mr=Or)),isVSCode&&window.document.body.classList.add("vscode"),localStorage[key]||(localStorage[key]=manifest.version);const br=localStorage[key];try{const[Or,_r,vr]=br.split("."),[xr,wr]=manifest.version.split(".");console.log("Checking migration from: ",br," to:",manifest.version),Or!==xr||_r!==wr?dialog(Alert,hr("dialogs.version.title")+manifest.version,hr("dialogs.version."+xr+"."+wr)+"<br><br>"+hr("dialogs.version.text")).then(()=>localStorage[key]=manifest.version):localStorage[key]=manifest.version}catch{}return store.then(async Or=>{Object.assign(window,Or),nullUntilLoaded.set(Or),await wait(500),urlParam("c").subscribe(vr=>{console.log(vr),vr&&(goToKey(vr),closeDialog(!1),urlParam("c").set(null))})}),lr.$$.update=()=>{if(lr.$$.dirty&32&&pr(ar(0,{book:cr}=gr,cr)),lr.$$.dirty&16){const Or=window.document.body;Or.className.split(" ").forEach(_r=>{_r.startsWith("mage-theme-")&&Or.classList.remove(_r)}),Or.classList.add("mage-theme-"+mr)}lr.$$.dirty&16&&ar(1,ur=`<style>
  :root {
    color-scheme: ${mr=="dark"?"dark":"light"};
  }
  </style>`),lr.$$.dirty&9&&(/bot|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex/i.test(navigator.userAgent)||cr&&fr.index.title&&(document.title=fr.index.title+" - Magebook"))},[cr,ur,yr,fr,mr,gr]}class App extends SvelteComponent{constructor(or){super(),init$1(this,or,instance,create_fragment,safe_not_equal,{})}}const dialogs$1={confirm:"Confirm?",error:"Error",ok:"Ok",cancel:"Cancel",chapter:{add:"Add chapter",edit:"Edit chapter",delete:"Chapter “%1” will be deleted",exists:"Chapter already exists",name:"Key",title:"Title",group:"Group",genericFlags:"Type here any other flag you need, one per line",warnings:{duplicate:"Another key with same name exists",invalidkey:"Key should contain only alphanumeric characters (a-z,A-Z,0-9)",invalidgroup:"Group should contain only alphanumeric characters (a-z,A-Z,0-9)"}},newbook:{new:"Create a New Book",title:"Title",author:"Author",hint:"You can recover the previous book with <b>File -> Recent sessions</b>"},newfirebook:{new:"Create or load a New Book",book:"Book name",getStarted:`This feature lets you link Magebook with your Google account. After that, you will be able to work on shared documents, like the Google Docs' ones.<br>Get start by linking Magebook to your account. <a target="_blank" href="https://librogamesland.github.io/magebook/index.html#/?id=collaborative-projects">More on the user guide here</a>.`},remap:{group:"Group filter",flags:"Exclude flags",savecopy:"Save a copy",shuffle:{title:"Shuffle",hint:"Shuffle chapters with numeric key. You may choose to shuffle only chapters belonging to some groups, or to exclude chapters based on their flags. You should save a copy of your book before shuffling."},sort:{title:"Sort",hint:"Move numeric keys so that the lower come first. This will change the book structure permanently. You should save a copy of your book before sorting."},compact:{title:"Compact",hint:"Rename chapters so that no number will be missing in the middle. This will change the book structure permanently. You should save a copy of your book before compacting."}},lock:{title:"Warning",text:"Another tab has written changes on this local session. If you overwrite, those changes will be lost. You can open a new session instead, and recover the other session with the <br><b>File -> Recent sessions</b> tool.",new:"Open in new session",overwrite:"Overwrite"},graph:{loading:"Loading graph...",open:"Open in new tab",download:"Download (as .svg)"},version:{title:"New version - ",text:'Discover more on the <a target="_blank" href="https://librogamesland.github.io/magebook/#/?id=changelog">user guide page</a>.',"1.0":"Initial release.","1.1":"Added short links format [number] and 'disableShortLinks: true'.<br>Links to orphan chapters are highlighted in the sidemenu.<br>General restyle.<br>New Website export.<br>Bug fixes.","1.2":"Major internal rewrite.<br>The editor is now powered by Codemirror6 instead of Ace. It should be prettier and more mobile friendly.<br>New setting and export properties such as renameLink, page, textFont,...<br>Now 'Latest sessions' keeps a record of collaborative projects too."}},navbar$1={file:{title:"File",new:"New",newFire:"New collaborative",share:"Share",open:"Open/import LGC...",save:"Save",recover:"Latest sessions",recoverFire:"Collaborative sessions"},book:{title:"Book",graph:"View graph",shuffle:"Shuffle",sort:"Sort chapters",compact:"Compact chapters"},export:{title:"Export",docx:"Word (.docx)",html:"Website (.html)",fodt:"Libreoffice (.fodt)",xlgc:"LibroGameCreator 3",json:"Json",advanced:"Advanced webapp",others:"Others (ebook, Android app, ...)",otherslink:"https://librogamesland.github.io/magebook/index.html#/?id=other-formats",settings:"Export properties",settingslink:"https://librogamesland.github.io/magebook/index.html#/?id=properties"},help:{title:"Help",guide:"User guide",guidefile:"https://librogamesland.github.io/magebook",forum:"Lgl forum",report:"Report bug/suggest feature",about:"About"},buttons:{fullscreen:"Fullscreen",darktheme:"Toggle dark/light theme"}},sidemenu$1={toggle:"Toggle sidemenu",chapters:"Chapters",allgroup:"All chapters",allgrouperrors:"Without links from/to",allgrouporphanlinks:"With orphan links",linkshere:"Links to",actions:{goback:"Go back",add:"Add entity (ctrl+R)",edit:"Edit entity (ctrl+E)",delete:"Delete entity (ctrl+D)"}},editor$1={buttons:{find:"Find (ctrl+F)",undo:"Undo last change (ctrl+Z)",redo:"Redo last change (ctrl+shift+Z)",quicklink:"Link to the first avaiable chapter (ctrl+K)",link:"Add link (ctrl+L)"},chars:"characters"},about$1={contact:"Contact me",text:"Magebook is a gamebook web editor developed by <b>Luca Fabbian</b> with support of Lgl community."},books$1={local:`# Book title
author: Name and Surname


### 1
Chapter example. You may edit this chapter thanks to the buttons on the right sidemenu.
This is a link going to [2]. Links may also look like [Text](#chapter).


### Chapter with a long title {#2}
This is the second chapter. Chapters may include *italic* or **bold** text. <b>Bold</b>, <i>italic</i>, and <u>underline</u> are fine as well. You may add meta text with \` \` like \`TODO: edit this chapter\`.
`,fire:`# %1
author: Name and Surname


### 1
This is a collaborative book stored on your Google account. Many people may edit this book at the same time. Save this page in your browser's bookmarks or share the page url with others - you'll see the book changing in real time.
`},app$1={openlocal:"Create or open local file",openfire:"Create or access collaborative book",chooseother:"Choose another book"},en={dialogs:dialogs$1,navbar:navbar$1,sidemenu:sidemenu$1,editor:editor$1,about:about$1,books:books$1,app:app$1},dialogs={confirm:"Confermi?",error:"Errore",ok:"Ok",cancel:"Annulla",chapter:{add:"Aggiungi paragrafo",edit:"Modifica paragrafo",delete:"Il paragrafo “%1” verrà eliminato",exist:"Questo paragrafo esiste già",name:"Key",title:"Titolo",group:"Gruppo",genericFlags:"Inserisci qui altri indicatori di cui hai bisogno, uno per riga",warnings:{duplicate:"Esiste un'altro paragrafo con la stessa key!",invalidkey:"Key dovrebbe contenere solo caratteri alfanumerici (a-z, A-Z, 0-9)",invalidgroup:"Gruppo dovrebbe contenere solo caratteri alfanumerici (a-z, A-Z, 0-9)"}},newbook:{new:"Crea un nuovo Libro",title:"Titolo",author:"Autore",hint:"Puoi recuperare il libro precedente da <b>File -> Sessioni recenti</b>"},newfirebook:{new:"Crea o accedi a un Libro Collaborativo",book:"Nome libro",getStarted:'Con questa funzione puoi collegare Magebook al tuo account Google, così da creare libri che si possono modificare in simultanea, proprio come i Documenti Google.<br>Prima di iniziare, dovrai collegare Magebook al tuo account <a target="_blank" href="https://librogamesland.github.io/magebook/#/?id=progetti-collaborativi">seguendo questa guida</a>.'},remap:{group:"Filtro gruppi",flags:"Escludi simboli",savecopy:"Salva una copia",shuffle:{title:"Rimescola",hint:"Rimescola i paragrafi con chiave numerica. Puoi scegliere di mescolare solo i paragrafi che fanno parte di alcuni gruppi, o di escludere i paragrafi con determinati simboli. Per sicurezza, dovresti salvare una copia del libro prima di mescolare."},sort:{title:"Riordina",hint:"I paragrafi saranno spostati così da rispettare l'ordine di numero."},compact:{title:"Compatta",hint:"I paragrafi verranno rinominati in modo da avere numeri consecutivi, senza buchi in mezzo."}},lock:{title:"Attenzione",text:"Un'altra tab ha modificato i dati di questa sessione. Se sovrascrivi, quei cambiamenti verranno persi. Se vuoi mantenere entrambe le versioni, puoi creare una nuova sessione e recuperare quella vecchia con <br><b>File -> Sessioni recenti</b>.",new:"Apri nuova sessione",overwrite:"Sovrascrivi"},graph:{loading:"Caricamento grafo...",open:"Apri un una nuova pagina",download:"Download (immagine .svg)"},version:{title:"Nuova versione - ",text:'Scopri di più nella <a ref="_blank" href="https://librogamesland.github.io/magebook/#/?id=versioni">guida</a>.',"1.0":"Versione iniziale.","1.1":"Aggiunto formato link corto [numero] e opzione 'disableShortLinks: true'.<br>I link a paragrafi inesistenti vengono segnalati nel menu laterale.<br>Restyle dell'interfaccia.<br>Aggiunta esportazione sito web.<br>Correzioni varie.","1.2":"Ristrutturazione massiccia del codice interno.<br>L'editor adesso è basato su Codemirror6 anziché Ace. Dovrebbe risultare più veloce, bello e più mobile friendly.<br>Nuove impostazioni e Opzioni esportazione come renameLink, page, textFont, ...<br>Adesso 'Sessioni recenti' tiene traccia anche dei progetti collaborativi."}},navbar={file:{title:"File",new:"Nuovo",newFire:"Nuovo collaborativo",share:"Condividi",open:"Apri/importa LGC...",save:"Salva",recover:"Sessioni recenti",recoverFire:"Sessioni collaborative"},book:{title:"Libro",graph:"Visualizza grafico",shuffle:"Rimescola",sort:"Riordina paragrafi",compact:"Compatta paragrafi"},export:{title:"Esporta",docx:"Word (.docx)",fodt:"Libreoffice (.fodt)",html:"Sito web (.html)",xlgc:"LibroGameCreator 3",json:"Json",advanced:"Webapp avanzata",others:"Altri (ebook, app Android, ...)",otherslink:"https://librogamesland.github.io/magebook/index.html#/?id=altri-formati",settings:"Opzioni esportazione",settingslink:"https://librogamesland.github.io/magebook/index.html#/?id=opzioni"},help:{title:"Aiuto",guide:"Guida",guidefile:"https://librogamesland.github.io/magebook",forum:"Forum Lgl",report:"Segnala bug/suggerisci feature",about:"Info"},buttons:{fullscreen:"Schermo intero",darktheme:"Cambia tema scuro/chiaro"}},sidemenu={toggle:"Apri menu laterale",chapters:"Paragrafi",allgroup:"Tutti i paragrafi",allgrouperrors:"Senza entrata/uscita",allgrouporphanlinks:"Con link errati",linkshere:"Link al par.",actions:{goback:"Vai indietro",add:"Aggiungi entità (ctrl+R)",edit:"Modifica entità (ctrl+E)",delete:"Elimina entità (ctrl+D)"}},editor={buttons:{find:"Cerca (ctrl+F)",undo:"Annulla ultimo cambiamento (ctrl+Z)",redo:"Ripristina ultimo cambiamento (ctrl+shift+Z)",quicklink:"Link al primo paragrafo disponibile (ctrl+K)",link:"Aggiungi link (ctrl+L)"},chars:"caratteri"},about={contact:"Contattami",text:"Magebook è un editor di librogame sviluppato da <b>Luca Fabbian</b> con il supporto della community di Lgl."},books={local:`# Titolo
author: Nome e Cognome


### 1
Esempio di paragrafo. Puoi modificarlo sfruttando i tasti a destra.
Questo è un link verso il paragrafo [2]. I link possono essere anche nel formato esteso [Testo](#paragrafo), dove Testo è opzionale.


### Paragrafo con titolo {#2}
Questo è il secondo paragrafo. I paragrafi possono contenere anche testo in *corsivo* o **grassetto**.  Puoi anche usare <b>grassetto</b>, <i>corsivo</i>, o <u>sottolineato</u>. Aggiungi commenti con \` \`, ad esempio \`NOTA: devo rivedere questo paragrafo\`.
`,fire:`# %1
author: Nome e Cognome


### 1
Questo è un libro collaborativo memorizzato sul tuo account Google e che può essere modificato da più persone contemporaneamente. Salva questa pagina fra i segnalibri del tuo browser e inviala a chi vuoi, vedrai le modifiche sincronizzate in tempo reale.
`},app={openlocal:"Crea o apri file",openfire:"Crea o accedi a un libro collaborativo",chooseother:"Apri un altro"},it={dialogs,navbar,sidemenu,editor,about,books,app};addMessages("en",en);addMessages("it",it);const locale=getLocaleFromNavigator().split("-")[0];init({fallbackLocale:"en",initialLocale:locale});"serviceWorker"in navigator&&!isVSCode&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js")});new App({target:document.body});
